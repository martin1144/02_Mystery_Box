var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_notifications_start"),(window.suiteux_shell_webpackJsonp_main=window.suiteux_shell_webpackJsonp_main||[]).push([["notifications"],{283:function(e,t,i){"use strict";i.r(t);var n=i(2),o=i(27),a=i(12),s=i(3),r=i(1),c=i(25),l=i(17),d=i(179),p=i(0),u=i(46),f=i(54),m=i(9),h=i(16),b=i(5),g=i(31),S=i(153),I=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.getUnseenItemsCount=function(){var e=this,t=0;return null!=this.props.notifications&&this.props.notifications.length>0&&this.props.notifications.forEach((function(i){if((e.props.includeUnseenMailInCount||i.providerType!==S.a.NewMailNotification)&&i.providerType!==S.a.ChatNotification)if(i.providerType===S.a.NewAppNotification&&i.payload){var n=i.payload;t+=n.UnseenCount}else 0!==i.toastState&&1!==i.toastState||t++})),t},t.prototype.componentDidMount=function(){this.getUnseenItemsCount()>0&&this.props.setAriaLabelId&&this.props.setAriaLabelId(this.props.bellAriaLabelID)},t.prototype.componentDidUpdate=function(){this.getUnseenItemsCount()>0&&this.props.setAriaLabelId&&this.props.setAriaLabelId(this.props.bellAriaLabelID)},t.prototype.render=function(){var e=this.getUnseenItemsCount(),t=Object(s.I)(b.a.UnreadBadge_Title,e.toString(),b.a.Bell_Title);return n.createElement(s.r,{unseenItemCount:e,isParentHovered:this.props.isParentHovered,badgeStyles:this.props.badgeStyles},n.createElement("label",{htmlFor:this.props.bellAriaID,id:this.props.bellAriaLabelID,className:s.P.visuallyHidden},t))},t}(n.Component),y=Object(a.b)((function(e,t){return{notifications:e.notificationState.notifications,includeUnseenMailInCount:!Object(g.c)(e.shellInitDataState.clientData.WorkloadId),isParentHovered:t.isParentHovered,badgeStyles:t.badgeStyles}}))(I),A=function(e){function t(t){var i=e.call(this,t)||this;return i.setBellAriaLabel=function(e){i.setState({bellAriaLabel:e})},i.state={isHovered:!1,bellAriaLabel:null},i}return Object(p.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isAvailable&&Object(r.e)().perfMarker("BellTimeToInteractive")},t.prototype.render=function(){var e=this,t=!0;this.props.notifications&&this.props.notifications.some((function(e){return 3!==e.toastState}))&&(t=!1);var i=t&&this.props.isActive?b.a.Notification_Title+", "+b.a.NoNewNotifications+", "+b.a.NoNewCheckLaterNote:b.a.Notification_Title,o={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:null==this.state.bellAriaLabel?i:null,ariaLabelledBy:this.state.bellAriaLabel,affordanceMenuItemText:b.a.Notifications,iconID:"Ringer",iconFontSize:m.f.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onHoverStateChanged:function(t){e.setState({isHovered:t})},onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?n.createElement(u.b,Object(p.__assign)({},o),n.createElement(y,{isParentHovered:this.state&&this.state.isHovered,bellAriaID:l.h,bellAriaLabelID:"BellAriaLabel",setAriaLabelId:this.setBellAriaLabel,badgeStyles:h.headerButtonBadgePosition})):n.createElement(u.a,Object(p.__assign)({},o),n.createElement(y,{isParentHovered:this.state&&this.state.isHovered,bellAriaID:l.h,bellAriaLabelID:"BellAriaLabel",setAriaLabelId:this.setBellAriaLabel,badgeStyles:f.affordanceContextMenuItemBadgePosition}))},t}(n.Component),v=Object(a.b)((function(e,t){return{isAvailable:!!e.notificationState&&e.notificationState.notificationsEnabled,id:t&&t.id,isActive:e.flexPaneState&&"Notifications"===e.flexPaneState.activeProviderKey,notifications:e.notificationState.notifications,controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,i){t.stopPropagation(),Object(r.e)().click("Notifications","NotificationsPane",null,null,"Active state: "+i.isActive+", Render context: "+i.renderContext),i.onClick&&i.onClick(t),e(Object(s.eb)(t.currentTarget&&t.currentTarget.id)),e(Object(c.f)("Notifications"))}}}),(function(e,t,i){var n=Object(p.__assign)(Object(p.__assign)({},i),e);return Object(p.__assign)(Object(p.__assign)(Object(p.__assign)({},n),t),{onClick:function(e){return t.onClick(e,n)}})}))(A),N=i(160),x=i(460),O=i(298),C=i(536),T=i(10),w=i(299),E=function(e){function t(t){var i=e.call(this,t)||this;return i.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),Object(r.e)().click("Close","NotificationToast",S.a[i.props.notification.providerType]),i.props.isInFlexPane||i.props.onToastClose(i.props.notification.payload.id),i.props.dismiss(i.props.notification.payload.id)},i.onMailClick=function(e){e.preventDefault(),e.stopPropagation();var t=i.props.notification.navigationUrl;null!=t&&""!==t&&(Object(r.e)().click("NotificationClick",i.props.isInFlexPane?"NotificationsPane":"NotificationToast",S.a[i.props.notification.providerType],"Mail"),i.props.notification.isCondensed?Object(g.c)(i.props.notificationConfiguration.workloadID)||null!=i.props.notificationConfiguration&&null!=i.props.notificationConfiguration.owaLaunchUrl&&window.open(i.props.notificationConfiguration.owaLaunchUrl,"Mail","toolbar=0,status=0,width=1000,height=325"):Object(x.a)(t),i.props.dismiss(i.props.notification.payload.id)),i.props.isInFlexPane||i.props.onToastClose(i.props.notification.payload.id)},i.handleKeyDown=function(e){13===e.keyCode&&i.onMailClick(e)},i.setEmailState=function(e,t){if(e.stopPropagation(),e.preventDefault(),i.setState({isHover:t}),!i.props.isInFlexPane){var n=i.props.notification.payload.id;t?i.props.clearTimer(n):i.props.setTimer(n)}},i.handleOnError=function(){Object(r.e)().tag("NewMailNotification_MePhoto_LoadError",4)},i.handleOnFocus=function(){i.setState({isHover:!0})},i.handleOnBlur=function(){i.setState({isHover:!1})},i.handleOnMouseEnter=function(e){i.setEmailState(e,!0)},i.handleOnMouseLeave=function(e){i.setEmailState(e,!1)},i.state={isHover:!1},i}return Object(p.__extends)(t,e),t.prototype.componentDidMount=function(){null!=this.props.setTimer&&this.props.setTimer(this.props.notification.payload.id),null!=this.props.notification&&this.props.alertImpressionLogEnabled&&Object(r.e)().impression(S.a[this.props.notification.providerType],this.props.isInFlexPane?"FlexPane":"NotificationToast")},t.prototype.componentWillUnmount=function(){null!=this.props.clearTimer&&this.props.clearTimer(this.props.notification.payload.id)},t.prototype.render=function(){var e,t=this.props.notification.payload,i=null,o="",a=Object(T.a)();if(!this.props.isInFlexPane&&this.props.notification.isCondensed){var r=Object(s.I)(b.a.CondensedNewMailMessage,this.props.notification.condensedCount.toString());o=r,i=n.createElement("div",{className:Object(s.y)(C.condensed)},n.createElement(s.g,{className:Object(s.y)(O.icon,C.condensedIcon),fontIconCss:"ms-Icon--Mail"}),n.createElement("span",{className:Object(s.y)(C.condensedMailText,a.neutral.dark.font)},r))}else{o=t.PreviewText.length<70?t.Sender+" "+t.Subject+" "+t.PreviewText:t.Sender+" "+t.Subject+" "+t.PreviewText.substring(0,70);var c=Object(T.a)();i=n.createElement("div",{className:Object(s.y)(C.itemContent)},n.createElement("div",{className:Object(s.y)(s.P.table,s.P.maxWidth,s.P.maxHeight)},n.createElement("div",{className:Object(s.y)(C.newMailPersonaImage,s.P.tableCellMiddle)},n.createElement(N.a,{photoSize:32,upn:t.SenderSmtpEmailAddress,displayName:t.Sender,onError:this.handleOnError})),n.createElement("div",{className:s.P.tableCellMiddle},n.createElement("span",{className:Object(s.y)(C.mailText,C.sender,O.notificationTitle,c.neutral.dark.font)},t.Sender),n.createElement("div",null,n.createElement("div",{className:C.mailIcon},n.createElement(s.g,{className:Object(s.y)(O.icon,c.neutral.dark.font),fontIconCss:"ms-Icon--Mail",fontSize:"10px",isAriaHidden:!0})),n.createElement("span",{className:Object(s.y)(s.P.maxWidth,C.mailText,C.mailSubject,c.neutral.tertiary.font)},t.Subject)))),n.createElement("span",{className:Object(s.y)(C.mailText,C.bodyPreviewText,c.neutral.secondary.font)},t.PreviewText))}return n.createElement("div",{id:"NewMailItemId",role:"group","aria-label":o,className:Object(s.y)(C.newMailLink),onContextMenu:w.f,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onMouseEnter:this.handleOnMouseEnter,onMouseLeave:this.handleOnMouseLeave,tabIndex:0,onClick:this.onMailClick,onKeyDown:this.handleKeyDown},n.createElement("button",{type:"button",onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,className:Object(s.y)((e={},e[s.P.visuallyHidden]=!this.state.isHover&&this.props.isInFlexPane,e),O.closeButton,a.neutral.secondary.font,a.neutral.lightAlt.hover.background),onClick:this.onCloseButtonClick,"aria-label":b.a.DismissNotification,title:b.a.DismissNotification},n.createElement(s.g,{className:O.icon,fontIconCss:"ms-Icon--ChromeClose",fontSize:"10px"})),n.createElement("div",{className:Object(s.y)(C.newMailPopupButton)},n.createElement("div",{className:Object(s.y)(C.newMailPopupButtonCell)},i)))},t}(n.Component),j=i(538),_=function(e){function t(t){var i=e.call(this,t)||this;return i.onClick=function(e){e.preventDefault(),e.stopPropagation();var t=i.props.notification.payload.systemAlert,n=t.ActionUrl;if(Object(r.e)().click("NotificationClick",i.props.isInFlexPane?"NotificationsPane":"NotificationToast",S.a[i.props.notification.providerType],null,i.props.notification.subType),t.ActionCallback&&t.ActionCallback(),null!=n&&""!==n){var o=t.ActionTarget||"_self";window.open(n,o)}i.props.onToastClose&&i.props.onToastClose(i.props.notification.payload.id)},i.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),Object(r.e)().click("Close","NotificationToast",S.a[i.props.notification.providerType],null,i.props.notification.subType),i.props.onToastClose&&i.props.onToastClose(i.props.notification.payload.id),i.props.dismiss(i.props.notification.payload.id)},i.handleKeyDown=function(e){13===e.keyCode&&i.onClick(e)},i.setReminderState=function(e,t){e.stopPropagation(),e.preventDefault(),i.setState({isHover:t})},i.handleOnFocus=function(){i.setState({isHover:!0})},i.handleOnBlur=function(){i.setState({isHover:!1})},i.handleOnMouseEnter=function(e){i.setReminderState(e,!0)},i.handleOnMouseLeave=function(e){i.setReminderState(e,!1)},i.state={isHover:!1},i}return Object(p.__extends)(t,e),t.prototype.componentDidMount=function(){if(this.props.isInFlexPane||0!==this.props.notification.toastType||this.props.setTimer(this.props.notification.payload.id),null!=this.props.notification&&this.props.alertImpressionLogEnabled){var e=S.a[this.props.notification.providerType];this.props.notification.subType&&(e=e+":"+this.props.notification.subType),Object(r.e)().impression(e,this.props.isInFlexPane?"FlexPane":"NotificationToast")}},t.prototype.componentWillUnmount=function(){this.props.isInFlexPane||0!==this.props.notification.toastType||this.props.clearTimer(this.props.notification.payload.id)},t.prototype.render=function(){var e,t,i,o=this.props.notification.payload.systemAlert,a=Object(T.a)();return n.createElement("div",{id:"SystemAlert"+(this.props.isInFlexPane?"_pane":"")+o.Id,role:"group",tabIndex:0,onClick:this.onClick,onKeyDown:this.handleKeyDown,className:Object(s.y)(j.container,a.neutral.light.border),onContextMenu:w.f,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onMouseEnter:this.handleOnMouseEnter,onMouseLeave:this.handleOnMouseLeave,"aria-label":o.Title+" "+o.Message},n.createElement("button",{type:"button",onClick:this.onCloseButtonClick,className:Object(s.y)((e={},e[s.P.visuallyHidden]=!this.state.isHover,e),j.systemClose,O.closeButton,a.neutral.secondary.font,a.neutral.lightAlt.hover.background),"aria-label":b.a.DismissNotification,title:b.a.DismissNotification},n.createElement(s.g,{className:O.icon,fontIconCss:"ms-Icon--ChromeClose",fontSize:"10px"})),n.createElement("div",null,n.createElement(s.g,{className:Object(s.y)(s.P.tableCellMiddle,s.P.floatLeft,a.neutral.dark.font,(t={},t[j.alertIcon]=!this.props.isInFlexPane,t),(i={},i[j.alertPaneIcon]=this.props.isInFlexPane,i)),fontIconCss:"ms-Icon--Warning",isAriaHidden:!0}),n.createElement("span",{className:Object(s.y)(j.title,a.neutral.dark.font)}," ",o.Title),n.createElement("span",{className:Object(s.y)(j.message,O.notificationBodyText,a.neutral.secondary.font)},o.Message)),n.createElement("div",{"aria-label":o.ActionText,className:Object(s.y)(O.actionBar,a.neutral.accent.font,a.neutral.light.border)},n.createElement("a",{tabIndex:0,role:"button",onClick:this.onClick,onKeyDown:this.handleKeyDown,"aria-label":o.ActionText,className:Object(s.y)(O.notificationLink,a.neutral.accent.link)},n.createElement("span",{className:O.itemLink,role:"link","aria-label":o.ActionText},o.ActionText),n.createElement(s.g,{className:Object(s.y)(O.icon,O.actionArrow),fontIconCss:"ms-Icon--Forward"}))))},t}(n.Component),D=i(398),P=i(400),M=i(540),R=function(e){function t(t){var i=e.call(this,t)||this;return i.dismiss=function(e){e.preventDefault(),e.stopPropagation(),Object(r.e)().click("Dismiss",i.props.isInFlexPane?"NotificationsPane":"NotificationToast",S.a[S.a.ReminderNotification]),null!=i.props.reminderItem?i.props.onDismiss(i.props.reminderItem.payload.id,i.props.reminderItem.payload.reminder.ReminderItemDataModel.ItemId):Object(r.e)().tag("Notifications_DismissReminder_EmptySelectedReminder",6)},i.setStateWhenBlur=function(){i.state.isIconFocus||null!=i.props.snoozeReminderId||window.setTimeout((function(){i.setState({isReminderFocus:!1}),i.props.onSelectedItem(null)}),500)},i.setReminderState=function(e,t){e.preventDefault(),e.stopPropagation(),i.props.snoozeReminderId||i.setState({isHover:t})},i.handleKeyDown=function(e){13===e.keyCode&&i.onClick(e)},i.onClick=function(e){e.preventDefault(),e.stopPropagation();var t=i.props.reminderItem.payload.reminder;i.props.snoozeReminderId===t.ReminderItemDataModel.ItemId?i.props.onSnoozeClose():(i.props.onClick(t.ReminderItemDataModel.ItemId),null!=i.props.config&&null!=i.props.config.workloadID&&(t.OpenItem(i.props.config.workloadID,i.props.config.owaLaunchUrl),i.props.onDismiss(i.props.reminderItem.payload.id,i.props.reminderItem.payload.reminder.ReminderItemDataModel.ItemId)))},i.onSnoozeClick=function(e){e.preventDefault(),e.stopPropagation();var t=i.props.reminderItem.payload.reminder.ReminderItemDataModel.ItemId;i.props.snoozeReminderId?i.props.onSnoozeClose():t&&i.props.onSnoozeClick(t,document.activeElement)},i.handleOnSnoozeFocus=function(){i.setState({isIconFocus:!0,isReminderFocus:!0})},i.handleOnReminderFocus=function(){i.setState({isReminderFocus:!0})},i.handleSnoozeButtonOnBlur=function(){i.setState({isIconFocus:!1})},i.handleCloseButtonOnBlur=function(){i.setState({isIconFocus:!1,isReminderFocus:!1})},i.handleOnClick=function(e){i.dismiss(e)},i.handleOnMouseEnter=function(e){i.setReminderState(e,!0)},i.handleOnMouseLeave=function(e){i.setReminderState(e,!1)},i.state={isHover:!1,isIconFocus:!1,isReminderFocus:!1},i}return Object(p.__extends)(t,e),t.prototype.componentDidMount=function(){null!=this.props.reminderItem.payload.reminder&&this.props.alertImpressionLogEnabled&&Object(r.e)().impression(S.a[this.props.reminderItem.providerType],this.props.isInFlexPane?"FlexPane":"NotificationToast")},t.prototype.componentWillReceiveProps=function(e){if(this.props.LastUpdatedTime!==e.LastUpdatedTime){var t=this.props.reminderItem.payload.reminder;t.UpdateReferenceTime(this.props.LastUpdatedTime),P.a.isVisibleReminderOverdue(t.ReminderItemDataModel.EndDate)||this.props.removeReminder(this.props.reminderItem.payload.id)}},t.prototype.render=function(){var e,t,i,o,a=Object(T.a)(),r=this.props.reminderItem.payload.reminder;r.UpdateReferenceTime(this.props.LastUpdatedTime);var c=this.props.order,l=Object(s.y)(M.remindersRemain,s.P.tableCellMiddle,M.remindersRightColumn,((e={})[a.neutral.darkRed.font]=r.IsReminderOverdue,e[a.neutral.dark.font]=!r.IsReminderOverdue,e)),d=n.createElement("div",{id:"rmdcontext"+c,"aria-labelledby":"rmdSubject"+c+" rmdBody"+c,className:Object(s.y)(O.overflowHidden,s.P.table,s.P.maxWidth,s.P.maxHeight)},n.createElement("div",{className:Object(s.y)(s.P.tableCellMiddle)},n.createElement(s.g,{className:Object(s.y)(M.reminderIcon,a.neutral.dark.font),fontIconCss:"ms-Icon--Event",isAriaHidden:!0})),n.createElement("div",{"aria-label":r.ReminderItemDataModel.Subject,className:Object(s.y)(s.P.tableCellMiddle,s.P.maxWidth,O.notificationTitle,a.neutral.dark.font)},n.createElement("span",{className:Object(s.y)(M.remindersTitle)},r.ReminderItemDataModel.Subject)),n.createElement("div",{id:"rmdBody"+c,"aria-label":Object(s.I)("{0} {1} {2}",r.TimeToItemStartValue,r.TimeToItemStartUnit,b.a.ReminderOverDue),className:l},n.createElement("div",{className:Object(s.y)((t={},t[s.P.visuallyHidden]=this.state.isHover||this.state.isReminderFocus||this.state.isIconFocus,t)),"aria-hidden":"true"},n.createElement("span",{className:Object(s.y)(M.toastRemindersTimeToStartValue)},r.TimeToItemStartValue),n.createElement("span",{className:Object(s.y)(M.remindersTimeToStartUnit)},r.TimeToItemStartUnit),n.createElement("span",{className:Object(s.y)(a.neutral.darkRed.font,(i={},i[s.P.visuallyHidden]=!r.IsReminderOverdue,i))},b.a.ReminderOverDue)),n.createElement("div",{className:Object(s.y)((o={},o[s.P.visuallyHidden]=!this.state.isHover&&!this.state.isReminderFocus&&!this.state.isIconFocus,o))},n.createElement("button",{id:"reminderSnoozeButton"+c,tabIndex:0,title:b.a.ReminderSnooze_Title,onFocus:this.handleOnSnoozeFocus,onBlur:this.handleSnoozeButtonOnBlur,"aria-label":b.a.ReminderSnooze_Aria_Text,role:"button",className:Object(s.y)(M.alarmButton,O.notificationLink,a.neutral.accent.font,a.neutral.light.hover.background),onClick:this.onSnoozeClick},n.createElement(s.g,{className:Object(s.y)(O.icon),fontIconCss:"ms-Icon--AlarmClock"})),n.createElement("button",{id:"reminderCloseButton"+c,type:"button",tabIndex:0,onFocus:this.handleOnSnoozeFocus,onBlur:this.handleCloseButtonOnBlur,className:Object(s.y)(O.closeButton,M.reminderCloseButton,a.neutral.secondary.font,a.neutral.light.hover.background),"aria-label":b.a.DismissNotification,role:"button",title:b.a.Dismiss,onClick:this.handleOnClick},n.createElement(s.g,{className:O.icon,fontIconCss:"ms-Icon--ChromeClose"}))))),p=n.createElement("div",{className:Object(s.y)(M.remindersDescription,a.neutral.secondary.font)},n.createElement("div",null,r.TimeLabel),""!==r.ReminderItemDataModel.Location&&n.createElement("div",null,r.ReminderItemDataModel.Location)),u=this.props.selectedReminderId===r.ReminderItemDataModel.ItemId;return n.createElement("div",{id:this.props.id,role:"group",tabIndex:0,className:Object(s.y)(O.toastControl),"aria-labelledby":"rmdRow"+c+" rmdDesc"+c,ref:function(e){u&&e&&e.focus()},onContextMenu:w.f,onClick:this.onClick,onKeyDown:this.handleKeyDown,onFocus:this.handleOnReminderFocus,onBlur:this.setStateWhenBlur,onMouseEnter:this.handleOnMouseEnter,onMouseLeave:this.handleOnMouseLeave},n.createElement("div",{className:Object(s.y)(M.remindersContainer)},n.createElement("div",{id:"rmdRow"+c,"aria-labelledby":"rmdcontext"+c,className:Object(s.y)(M.remindersRow)},d),n.createElement("div",{id:"rmdDesc"+c,"aria-label":r.ReminderItemDataModel.Location,className:Object(s.y)(M.remindersRow)},p)))},t}(n.Component),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){var e="";switch(this.props.title){case b.a.Alert_Title:e=b.a.DismissAllAlerts;break;case b.a.Mail:e=b.a.DismissAllMails;break;case b.a.Reminder_Title:e=b.a.DismissAllReminders}var t=Object(T.a)();return n.createElement("div",{className:Object(s.y)(O.dismissContain)},n.createElement("button",{id:"DismissAll",type:"button",onClick:this.props.onDismissAll,className:Object(s.y)(O.dismissAll,O.itemLink,t.neutral.accent.font),"aria-label":e,role:"button",tabIndex:0,title:e},n.createElement("span",null,b.a.DismissAll)))},t}(n.Component),L=function(){function e(){}return e.prototype.getSnoozeOptions=function(){return[-15,-5,0,5,10,15,30,60,120,240,480,720,1440,2880,4320,5760,10080,20160]},e.prototype.getSnoozeDisplayText=function(e){var t="";switch(e){case-15:t=Object(s.I)(b.a.ReminderSnoozeOption_MinutesBeforeStart_Text,"15");break;case-10:t=Object(s.I)(b.a.ReminderSnoozeOption_MinutesBeforeStart_Text,"10");break;case-5:t=Object(s.I)(b.a.ReminderSnoozeOption_MinutesBeforeStart_Text,"5");break;case 0:t=b.a.ReminderSnoozeOption_AtStart_Text;break;case 5:t=Object(s.I)(b.a.ReminderSnoozeOption_Minutes_Text,"5");break;case 10:t=Object(s.I)(b.a.ReminderSnoozeOption_Minutes_Text,"10");break;case 15:t=Object(s.I)(b.a.ReminderSnoozeOption_Minutes_Text,"15");break;case 30:t=Object(s.I)(b.a.ReminderSnoozeOption_Minutes_Text,"30");break;case 60:t=b.a.ReminderSnoozeOption_Hour_Text;break;case 120:t=Object(s.I)(b.a.ReminderSnoozeOption_Hours_Text,"2");break;case 240:t=Object(s.I)(b.a.ReminderSnoozeOption_Hours_Text,"4");break;case 480:t=Object(s.I)(b.a.ReminderSnoozeOption_Hours_Text,"8");break;case 720:t=Object(s.I)(b.a.ReminderSnoozeOption_Day_Text,"0.5");break;case 1440:t=Object(s.I)(b.a.ReminderSnoozeOption_Day_Text,"1");break;case 2880:t=Object(s.I)(b.a.ReminderSnoozeOption_Days_Text,"2");break;case 4320:t=Object(s.I)(b.a.ReminderSnoozeOption_Days_Text,"3");break;case 5760:t=Object(s.I)(b.a.ReminderSnoozeOption_Days_Text,"4");break;case 10080:t=b.a.ReminderSnoozeOption_OneWeek_Text;break;case 20160:t=b.a.ReminderSnoozeOption_TwoWeeks_Text}return t},e}(),U=i(463),F=i(543),z=function(e){function t(t){var i=e.call(this,t)||this;return i.onClick=function(e){i.snoozeOptionChanged(e.currentTarget&&e.currentTarget.id)},i.onShowOrHideMoreItems=function(e){Object(r.e)().click(i.state.ShowMoreRemindersExpanded?"SeeLess":"SeeMore","NotificationsPane",S.a[S.a.ReminderNotification]),i.setState({ShowMoreRemindersExpanded:!i.state.ShowMoreRemindersExpanded})},i.snoozeOptionChanged=function(e){i.onSnoozeClose();var t=Object(w.b)(i.props.notifications,i.state.SnoozeReminderId,!0);if(t.length>0){var n=parseInt(e),o=void 0;o=n<0?t[0].payload.reminder.ReminderItemDataModel.StartDate.addMinutes(n):0===n?t[0].payload.reminder.ReminderItemDataModel.StartDate:D.c.Now.addMinutes(n);var a=D.c.generateISO8601DateTimeMsStringWithOffset(o);i.props.removeReminder(t[0].payload.id),i.props.snoozeReminders(t.map((function(e){return e.payload.reminder.ReminderItemDataModel.ItemId})),a)}},i.dismissAll=function(){Object(r.e)().click("DismissAll","NotificationToast",S.a[S.a.ReminderNotification]);var e=i.props.notifications.map((function(e){return e.payload.reminder.ReminderItemDataModel.ItemId}));i.props.dismissAll(S.a.ReminderNotification,e)},i.onSelectedItem=function(e){i.setState({SelectedReminderId:e})},i.onSnoozeClose=function(){i.setState(Object(p.__assign)(Object(p.__assign)({},i.state),{SnoozeReminderId:null}))},i.onSnoozeClick=function(e,t){Object(r.e)().click("Snooze","NotificationToast",S.a[S.a.ReminderNotification]),i.setState({SnoozeReminderId:e,SnoozeElement:t})},i.onReminderContainerClick=function(e){e.stopPropagation()},i.onReminderItemClick=function(e){Object(r.e)().click("NotificationClick","NotificationToast",S.a[S.a.ReminderNotification]),i.setState(Object(p.__assign)(Object(p.__assign)({},i.state),{SelectedReminderId:e}))},i.handleKeydown=function(e){if(e instanceof KeyboardEvent&&"keydown"===e.type&&[38,40,35,36].indexOf(e.which)>-1){var t={index:i.state.CurrentIndex,selectedReminderId:i.state.SelectedReminderId};if(!Object(w.e)(i.props.notifications,e.which,t))return;null!=t.selectedReminderId&&t.index>-1&&i.setState({SelectedReminderId:t.selectedReminderId,CurrentIndex:t.index})}},i.state={SelectedReminderId:null,CurrentIndex:-1,SnoozeReminderId:null,SnoozeElement:null,ShowMoreRemindersExpanded:!1,LastUpdatedTime:D.c.now},i.aggregatedId=i.props.isInFlexPane?"Flexpane_Reminders_Id":"Aggregated_Reminders_Id",i}return Object(p.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=D.c.Now,i=D.b-1e3*t.second-t.millisecond;setTimeout((function(){e.timeInterval=window.setInterval((function(){return e.setState({LastUpdatedTime:D.c.now})}),6e4)}),i),Object(s.t)([this.aggregatedId],s.f.KEYDOWN,this.handleKeydown);var n=new L,o=n.getSnoozeOptions();this.dropdownItems=o.map((function(e){return{id:e.toString(),text:n.getSnoozeDisplayText(e)}}))},t.prototype.componentWillUnmount=function(){window.clearInterval(this.timeInterval),Object(s.T)([this.aggregatedId],s.f.KEYDOWN,this.handleKeydown)},t.prototype.render=function(){var e,t=this,i=this.props.notifications,o=i.length;this.props.isInFlexPane&&!this.state.ShowMoreRemindersExpanded&&o>3&&(i=i.slice(0,3));var a=Object(T.a)();e=this.props.isInFlexPane?Object(s.y)(O.notificationItem,O.itemContent,a.neutral.foreground.background,a.neutral.lighter.border,a.neutral.foregroundAlt.hover.background):Object(s.y)(U.reminderBox,a.neutral.lighter.border,a.neutral.lighter.hover.background);var r,c,l=0,d=i.map((function(i){var o=i.payload.reminder.ReminderItemDataModel.ItemId===t.state.SelectedReminderId,a=t.aggregatedId+l;return l++,n.createElement("div",{id:"rmdContainer"+l,"aria-labelledby":"rmdcontext"+l,key:a,"aria-selected":o,role:"option",className:e},n.createElement(R,{id:a,order:l,reminderItem:i,isInFlexPane:!1,selectedReminderId:t.state.SelectedReminderId,config:t.props.notificationConfiguration,LastUpdatedTime:t.state.LastUpdatedTime,onClick:t.onReminderItemClick,snoozeReminderId:t.state.SnoozeReminderId,onSnoozeClick:t.onSnoozeClick,onSnoozeClose:t.onSnoozeClose,onSelectedItem:t.onSelectedItem,onDismiss:t.props.dismiss,removeReminder:t.props.dismiss,alertImpressionLogEnabled:t.props.alertImpressionLogEnabled}))}));this.props.isInFlexPane?r=o>0&&n.createElement("div",{className:Object(s.y)(O.header,s.P.maxWidth,s.P.maxHeight,a.neutral.light.border),"aria-hidden":!0},n.createElement("div",{className:Object(s.y)(s.P.tableCellMiddle,O.label)},n.createElement("h3",{className:Object(s.y)(O.headerText,a.neutral.dark.font),"aria-label":b.a.Reminder_Title},b.a.Reminder_Title)),n.createElement("div",{className:s.P.tableCellMiddle},n.createElement(k,{onDismissAll:this.dismissAll,title:b.a.Reminder_Title})),n.createElement("div",{className:O.clearStyle})):c=n.createElement("div",{id:"ReminderHeader",className:Object(s.y)(s.P.maxWidth,s.P.maxHeight,U.header,a.neutral.light.border),"aria-hidden":!0},n.createElement("div",{className:Object(s.y)(s.P.tableCellMiddle,U.label)},n.createElement("span",{"aria-label":b.a.Reminder_Title,className:Object(s.y)(O.headerText,a.neutral.dark.font)},b.a.Reminder_Title)),n.createElement("div",{className:Object(s.y)(s.P.tableCellMiddle,U.label)},n.createElement(k,{onDismissAll:this.dismissAll,title:b.a.Reminder_Title})));var u=this.props.isInFlexPane?Object(s.y)(O.toastControl,O.headingBar):Object(s.y)(s.P.table,s.P.maxWidth,s.P.maxHeight),f=this.state.SnoozeElement?this.state.SnoozeElement.getBoundingClientRect():null,m=f?{left:f.left-147,top:f.top+32}:{margin:0},h=this.props.isInFlexPane?O.notificationContainer:U.toastScrollRegion;return n.createElement("div",{onClick:this.onReminderContainerClick,className:u,role:"group"},r,this.state.SnoozeReminderId&&n.createElement(s.c,{className:F.dropDrown,popupPosition:m,ariaLabel:b.a.ReminderSnooze_Aria_Text,onDismiss:this.onSnoozeClose,isScrollHidden:!0,scrollContainerId:this.props.isInFlexPane?"flexPaneScrollRegion":"Aggregated_Reminders_Id"},this.dropdownItems.map((function(e){return n.createElement(s.d,Object(p.__assign)({className:Object(s.y)(F.snoozeContextMenuItem,a.neutral.dark.font,a.neutral.foreground.background,a.neutral.light.hover.background),displayText:e.text,key:e.id,itemId:e.id,onclick:t.onClick},e,{role:"button"}))}))),c,n.createElement("div",{id:this.aggregatedId,role:"listbox","aria-multiselectable":"true",tabIndex:-1,className:Object(s.y)(h),"aria-label":b.a.Reminder_Title},d),o>3&&this.props.isInFlexPane&&n.createElement("button",{type:"button",onClick:this.onShowOrHideMoreItems,className:Object(s.y)(O.footer,O.itemLink),"aria-label":this.state.ShowMoreRemindersExpanded?b.a.ShowLess:b.a.ShowMore},n.createElement("span",{className:Object(s.y)(O.showMoreLink,a.neutral.accent.font)},this.state.ShowMoreRemindersExpanded?b.a.ShowLess:b.a.ShowMore)))},t}(n.Component),B=i(158),H=i(545),G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onToastActionClick=function(e){switch(e.preventDefault(),e.stopPropagation(),Object(r.e)().click("NotificationClick","NotificationToast",S.a[t.props.notification.providerType],null,t.props.notification.subType),t.props.notificationPayload.type){case B.a.message:case B.a.call:try{t.props.notificationPayload.actionLink.action()}catch(e){Object(r.e)().exception("ChatNotification_AcceptError",6,e)}break;case B.a.summary:t.props.onRecentsOpen(!0)}t.props.onToastClose&&t.props.onToastClose(t.props.notification.payload.id)},t.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),Object(r.e)().click("Close","NotificationToast",S.a[t.props.notification.providerType],null,t.props.notification.subType);try{t.props.notificationPayload.cancelLink.action()}catch(e){Object(r.e)().exception("ChatNotification_CancelError",6,e)}t.props.onToastClose&&t.props.onToastClose(t.props.notification.payload.id)},t.handleOnError=function(){Object(r.e)().tag("ChatNotification_MePhoto_LoadError",4)},t}return Object(p.__extends)(t,e),t.prototype.componentDidMount=function(){null!=this.props.setTimer&&this.props.setTimer(this.props.notification.payload.id)},t.prototype.componentWillUnmount=function(){null!=this.props.clearTimer&&this.props.clearTimer(this.props.notification.payload.id)},t.prototype.render=function(){if(null==this.props.notificationPayload)return null;var e=null,t=Object(T.a)();switch(this.props.notificationPayload.type){case B.a.message:e=n.createElement("div",{className:Object(s.y)(H.chatContent),onClick:this.onToastActionClick,role:"group"},n.createElement("div",{className:Object(s.y)(s.P.table,s.P.maxWidth,s.P.maxHeight)},n.createElement("div",{className:Object(s.y)(H.PersonaImage,s.P.tableCellMiddle)},n.createElement(N.a,{photoSize:32,photoUrl:this.props.notificationPayload.image,upn:this.props.notificationPayload.sender,displayName:this.props.notificationPayload.title,onError:this.handleOnError})),n.createElement("div",{className:s.P.tableCellMiddle},n.createElement("span",{className:Object(s.y)(H.chatTitle,H.chatText,O.notificationTitle,t.neutral.dark.font)},this.props.notificationPayload.title),n.createElement("div",null,n.createElement("div",{className:H.chatIcon},n.createElement(s.g,{className:Object(s.y)(O.icon),fontIconCss:"ms-Icon--OfficeChat",fontSize:"10px"})),n.createElement("span",{className:Object(s.y)(s.P.maxWidth,H.chatText,H.chatPreview,t.neutral.tertiary.font)},this.props.notificationPayload.description)))));break;case B.a.call:e=n.createElement("div",null,n.createElement("div",{className:Object(s.y)(H.chatContent)},n.createElement("div",{className:Object(s.y)(s.P.table,s.P.maxWidth,s.P.maxHeight)},n.createElement("div",{className:Object(s.y)(H.PersonaImage,s.P.tableCellMiddle)},n.createElement(N.a,{photoSize:32,photoUrl:this.props.notificationPayload.image,upn:this.props.notificationPayload.sender,displayName:this.props.notificationPayload.title,onError:this.handleOnError})),n.createElement("div",{className:s.P.tableCellMiddle},n.createElement("span",{className:Object(s.y)(H.chatTitle,H.chatText,O.notificationTitle,t.neutral.dark.font)},this.props.notificationPayload.title),n.createElement("div",null,n.createElement("div",{className:H.chatIcon},n.createElement(s.g,{className:Object(s.y)(O.icon),fontIconCss:"ms-Icon--OfficeChat",fontSize:"10px"})),n.createElement("span",{className:Object(s.y)(s.P.maxWidth,H.chatText,H.chatPreview,t.neutral.tertiary.font)},this.props.notificationPayload.description))))),n.createElement("div",{className:Object(s.y)(O.actionBar,t.neutral.accent.font,t.neutral.light.border)},n.createElement("button",{type:"button",onClick:this.onToastActionClick,className:Object(s.y)(t.neutral.foreground.background,t.neutral.light.border,t.neutral.accent.font,t.neutral.accent.hover.background,t.neutral.foreground.hover.font)},b.a.Accept),n.createElement("button",{type:"button",onClick:this.onCloseButtonClick,className:Object(s.y)(t.neutral.foreground.background,t.neutral.light.border,t.neutral.accent.font,t.neutral.accent.hover.background,t.neutral.foreground.hover.font)},b.a.Ignore)));break;default:e=n.createElement("div",{className:Object(s.y)(H.condensed),onClick:this.onToastActionClick,role:"group"},n.createElement(s.g,{className:Object(s.y)(O.icon,H.condensedIcon),fontIconCss:"ms-Icon--OfficeChat"}),n.createElement("span",{className:Object(s.y)(H.condensedText,t.neutral.dark.font)},this.props.notificationPayload.description))}return n.createElement("div",{onContextMenu:w.f},n.createElement("button",{type:"button",className:Object(s.y)(O.closeButton,t.neutral.secondary.font,t.neutral.lightAlt.hover.background),onClick:this.onCloseButtonClick,"aria-label":b.a.DismissNotification},n.createElement(s.g,{className:O.icon,fontIconCss:"ms-Icon--ChromeClose",fontSize:"10px"})),n.createElement("div",{className:Object(s.y)(H.toastContent),id:this.props.notificationPayload.id},e))},t}(n.Component),W=i(121),Z=Object(a.b)(null,(function(e){return{onRecentsOpen:function(t){e(Object(W.c)(t))}}}))(G),Q=i(547),K=function(e){function t(t){var i=e.call(this,t)||this;return i.clearTimer=function(e){if(null!=i.state.timers[e]){var t=i.state.timers;t[e]=clearTimeout(t[e])}},i.setTimer=function(e){var t=i.state.timers;t[e]=setTimeout((function(){return i.props.onClose(e)}),4e3),i.setState({timers:t})},i.state={timers:[],top:50},Object(r.b)().subscribe("ShyHeaderActivated",(function(e){i.setState({top:e?8:50})}),!0),i}return Object(p.__extends)(t,e),t.prototype.render=function(){var e,t=this,i=null!=this.props.notifications&&this.props.notifications.filter((function(e){return 0===e.toastState}));if(!i||0===i.length||!this.props.isNotificationsEnabled&&!this.props.chatEnabled)return null;if(this.props.areToastsMuted)return i.forEach((function(e){e&&e.providerType!==S.a.ReminderNotification&&e.providerType!==S.a.SystemAlert&&e.payload&&e.payload.id&&window.setTimeout((function(){return t.props.onClose(e.payload.id)}),0)})),null;if(document.hidden&&i.filter((function(e){return 0===e.toastType})).length>0)return null;var o=i.filter((function(e){return e.providerType===S.a.ReminderNotification})),a=i.filter((function(e){return e.providerType!==S.a.ReminderNotification})).slice(0,w.g),r=this.props,c={dismiss:this.props.dismiss,onToastClose:this.props.onClose,snoozeReminders:this.props.snoozeReminders,setTimer:this.setTimer,clearTimer:this.clearTimer,notificationConfiguration:r,notificationSetting:this.props.notificationPreferencesData,dismissAll:this.props.dismissAll,removeReminder:this.props.removeReminder,alertImpressionLogEnabled:this.props.alertImpressionLogEnabled};return o.length>0&&r.notificationPreferencesData.EnableReminders&&(e=n.createElement(z,Object(p.__assign)({},c,{notifications:o}))),r.notificationPreferencesData&&(a.length>0||o.length>0)&&i.length>0&&n.createElement(s.i,{className:Object(s.y)(Q.popupControl),focusTrapSelector:"a[href],button",noFocusOnRender:!0,isPersistant:!0,popupPosition:this.props.isRtl?{top:this.state.top,left:0}:{top:this.state.top,right:0}},n.createElement("div",{className:Object(s.y)(Q.toastContainer),id:"popupContent","aria-label":i.length>1?b.a.NotificationsPopup:b.a.NotificationPopup,role:"region","aria-live":"polite","aria-relevant":"additions"},o.length>0&&this.getToast(e,o[0],!1),a.length>0&&a.map((function(i){return e=null,i.providerType===S.a.NewMailNotification&&r.notificationPreferencesData.EnableNewItemNotify?e=n.createElement(E,Object(p.__assign)({notification:i},c,{notificationConfiguration:r})):i.providerType===S.a.SystemAlert?e=n.createElement(_,Object(p.__assign)({notification:i},c)):t.props.chatEnabled&&i.providerType===S.a.ChatNotification&&(r.notificationPreferencesData.EnableChat||r.notificationPreferencesData.EnableCalling)&&(e=n.createElement(Z,Object(p.__assign)({notification:i},c,{notificationPayload:i.payload}))),null!=e&&t.getToast(e,i,i.subType===B.a.call)}))))},t.prototype.getToast=function(e,t,i){if(null==e)return null;var o=Object(w.c)(t,this.props),a=Object(T.a)();return n.createElement("div",{key:t.payload.id,className:Object(s.y)(U.toastSlot,O.notificationToast,a.neutral.light.border,a.neutral.foreground.background)},e,""!==o&&n.createElement(s.a,{source:o,id:t.payload.id,loop:i,type:"audio/mpeg"}))},t}(n.Component),Y=i(293),J=Object(a.b)((function(e){return{notifications:e.notificationState.notifications,chatEnabled:e.chatState&&e.chatState.chatEnabled,isRtl:e.userState&&e.userState.isRtl,isNotificationsEnabled:null!=e.notificationState&&null!=e.notificationState.notificationsEnabled&&e.notificationState.notificationsEnabled,areToastsMuted:null!=e.notificationState&&e.notificationState.toastsMuted,isSystemNotificationsDisabled:null!=e.notificationState&&null!=e.notificationState.systemNotificationsDisabled&&e.notificationState.systemNotificationsDisabled,owaLaunchUrl:Object(s.J)(e.appsDataState.apps),mailNotificationAudioUrl:e.shellInitDataState.clientData.MailNotificationAudioUrl,systemNotificationAudioUrl:e.shellInitDataState.clientData.SystemNotificationAudioUrl,calendarNotificationAudioUrl:e.shellInitDataState.clientData.CalendarNotificationAudioUrl,callNotificationAudioUrl:e.shellInitDataState.clientData.CallNotificationAudioUrl,chatNotificationAudioUrl:e.shellInitDataState.clientData.ChatNotificationAudioUrl,workloadID:e.shellInitDataState.clientData.WorkloadId,notificationPreferencesData:e.notificationState.notificationPreferencesData,alertImpressionLogEnabled:e.shellInitDataState.clientData.AlertImpressionLogEnabled,isGallatinLegalAlertEnabled:e.shellInitDataState.clientData.GallatinLegalAlertEnabled}}),(function(e){return{setToastStatus:function(t,i,n,o){e(Object(Y.h)(t,i,n,o))},onClose:function(t){e(Object(Y.h)([t],1))},dismissAll:function(t,i){void 0===i&&(i=[]),e(Object(Y.d)(t,i))},dismiss:function(t,i){e(Object(Y.e)(t,i))},removeReminder:function(t){e(Object(Y.m)(!0,null,t))},snoozeReminders:function(t,i){e(Object(Y.j)(t,i))}}}))(K),V=i(320),X=i(401),q=i(91),$=i(35),ee=i(549),te=function(e){function t(t){var i=e.call(this,t)||this;return i.handleOnFocus=function(){i.setState({isHover:!0})},i.handleOnBlur=function(){i.setState({isHover:!1})},i.handleOnMouseEnter=function(e){i.setNewAppState(e,!0)},i.handleOnMouseLeave=function(e){i.setNewAppState(e,!1)},i.handleKeyDown=function(e){13===e.keyCode&&i.onClick(e)},i.onClick=function(e){e.preventDefault(),e.stopPropagation();var t=i.props.notification.payload,n=t.LaunchFullUrl;if(null!=n||""!==n){window.open(n,"_blank");var o=$.d(t.ItemID,t.CollectorID);"NewAppNotification"===o&&(o="OfficeDotCom"),Object(r.e)().click("NotificationClick","NotificationsPane",S.a[i.props.notification.providerType],o)}},i.setNewAppState=function(e,t){e.stopPropagation(),e.preventDefault(),i.setState({isHover:t})},i.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),i.props.dismissAll(e)},i.state={isHover:!1},i}return Object(p.__extends)(t,e),t.prototype.componentDidMount=function(){var e=null!=this.props.notification?this.props.notification.payload:null;null!=e&&e.AllNewAppIDs.length>0&&Object(r.e)().impression(S.a[this.props.notification.providerType],"FlexPane",e.AllAppTileIDs.length,e.AllAppTileIDs)},t.prototype.render=function(){var e,t=this.props.notification.payload,i=Object(T.a)();return n.createElement("div",{id:"NewAppId",tabIndex:0,onContextMenu:w.f,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onMouseEnter:this.handleOnMouseEnter,onMouseLeave:this.handleOnMouseLeave,"aria-label":t.Title+" "+t.Message},n.createElement("button",{id:"newAppCloseButton",type:"button",tabIndex:0,className:Object(s.y)((e={},e[s.P.visuallyHidden]=!this.state.isHover,e),O.closeButton,i.neutral.secondary.font,i.neutral.lightAlt.hover.background),"aria-label":b.a.DismissNotification,title:b.a.DismissNotification,onClick:this.onCloseButtonClick},n.createElement(s.g,{className:O.icon,fontIconCss:"ms-Icon--ChromeClose",isAriaHidden:!0})),n.createElement("div",{id:t.ID,className:Object(s.y)(ee.newAppPopupButton),onClick:this.onClick,role:"group"},n.createElement("div",{className:Object(s.y)(ee.newAppPopupButtonCell,i.neutral.light.border)},n.createElement("div",null,n.createElement("span",{className:Object(s.y)(s.H.segoeSemibold,ee.notificationText,O.notificationTitle,i.neutral.dark.font)},t.Title),n.createElement("span",{className:Object(s.y)(s.H.segoeRegular,ee.notificationText,O.notificationBodyText,i.neutral.secondary.font)},t.Message)),n.createElement("div",{className:Object(s.y)(O.actionBar,i.neutral.accent.font,i.neutral.light.border)},n.createElement("a",{tabIndex:0,onClick:this.onClick,onKeyDown:this.handleKeyDown,"aria-label":t.ActionText,className:Object(s.y)(O.notificationLink,i.neutral.accent.link),role:"link"},n.createElement("span",{className:O.itemLink},t.ActionText),n.createElement(s.g,{className:Object(s.y)(O.icon,O.actionArrow),fontIconCss:"ms-Icon--Forward"}))))))},t}(n.Component),ie=i(419),ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onDismissAll=function(){Object(r.e)().click("DismissAll","NotificationsPane",S.a[S.a.NewAppNotification]);var e=t.props.notification&&t.props.notification.payload;e&&ie.a.dismiss(e.AllNewAppIDs),t.props.dismissAll(S.a.NewAppNotification)},t}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=Object(T.a)();return this.props.notification&&this.props.notification.payload?n.createElement("div",{className:Object(s.y)(O.toastControl,O.headingBar)},n.createElement("div",{className:Object(s.y)(O.header,s.P.maxWidth,e.neutral.light.border),"aria-hidden":!0},n.createElement("div",{className:Object(s.y)(O.label,s.P.floatLeft)},n.createElement("h3",{className:Object(s.y)(O.headerText,e.neutral.dark.font),"aria-label":b.a.NotificationMyAppsTitle},b.a.NotificationMyAppsTitle)),this.props.notification&&n.createElement(k,{onDismissAll:this.onDismissAll,title:b.a.NewAppTitle}),n.createElement("div",{className:O.clearStyle})),n.createElement("div",{className:Object(s.y)(O.content)},n.createElement("div",{className:Object(s.y)(O.notificationItem,O.itemContent,e.neutral.foreground.background,e.neutral.lighter.border,e.neutral.foregroundAlt.hover.background)},n.createElement(te,{dismissAll:this.onDismissAll,notification:this.props.notification})))):null},t}(n.Component),oe=function(e){function t(t){var i=e.call(this,t)||this;return i.setShowMoreMailNotifications=function(){i.state.ShowMoreMailNotifications?Object(r.e)().click("SeeLess","NotificationsPane",S.a[S.a.NewMailNotification]):Object(r.e)().click("SeeMore","NotificationsPane",S.a[S.a.NewMailNotification]),i.setState({ShowMoreMailNotifications:!i.state.ShowMoreMailNotifications})},i.onDismissAll=function(e){Object(r.e)().click("DismissAll","NotificationsPane",S.a[S.a.NewMailNotification]),i.props.dismissAll(S.a.NewMailNotification),i.setState(i.getDefaultState())},i.state=i.getDefaultState(),i}return Object(p.__extends)(t,e),t.prototype.getDefaultState=function(){return{ShowMoreMailNotifications:!1,isLessButtonHovered:!1,isMoreButtonHovered:!1}},t.prototype.render=function(){var e=this,t=this.props.notifications.filter((function(e){return e.providerType===S.a.NewMailNotification})).reverse(),i=t.length;t=!this.state.ShowMoreMailNotifications&&i>3?t.slice(0,3):t;var o=Object(T.a)();return i>0&&n.createElement("div",{className:Object(s.y)(O.toastControl,O.headingBar)},n.createElement("div",{className:Object(s.y)(O.header,s.P.maxWidth,s.P.maxHeight,o.neutral.light.border),"aria-hidden":!0},n.createElement("div",{className:Object(s.y)(O.label,s.P.floatLeft)},n.createElement("h3",{className:Object(s.y)(O.headerText,o.neutral.dark.font),"aria-label":b.a.Mail},b.a.Mail)),i>1&&n.createElement(k,{onDismissAll:this.onDismissAll,title:b.a.Mail}),n.createElement("div",{className:O.clearStyle})),n.createElement("div",{className:Object(s.y)(O.content)},t.map((function(t){return n.createElement("div",{key:t.payload.id,className:Object(s.y)(O.notificationItem,O.itemContent,o.neutral.foreground.background,o.neutral.lighter.border,o.neutral.foregroundAlt.hover.background)},n.createElement(E,{notification:t,dismiss:e.props.dismiss,isInFlexPane:!0,notificationConfiguration:e.props.notificationConfiguration}))})),i>3&&n.createElement("button",{type:"button",onClick:this.setShowMoreMailNotifications,className:Object(s.y)(O.footer,O.itemLink),"aria-label":this.state.ShowMoreMailNotifications?b.a.SeeLessAriaText:b.a.ShowMoreAriaText},n.createElement("span",{className:Object(s.y)(O.showMoreLink,o.neutral.accent.font)},this.state.ShowMoreMailNotifications?b.a.ShowLess:b.a.ShowMore))))},t}(n.Component),ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onDismissAll=function(e){Object(r.e)().click("DismissAll","NotificationsPane",S.a[S.a.SystemAlert]),t.props.dismissAll&&t.props.dismissAll(S.a.SystemAlert)},t}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props.notifications?this.props.notifications.filter((function(e){return e.providerType===S.a.SystemAlert&&(0===e.toastState||1===e.toastState)})):[],i=this.props.notifications?this.props.notifications.filter((function(e){return e.providerType===S.a.SystemAlert&&2===e.toastState})):[],o=i.length+t.length,a=Object(T.a)();return t.length>0||i.length>0?n.createElement("div",{className:Object(s.y)(O.content,O.paddingTop)},n.createElement("div",{className:Object(s.y)(O.header,s.P.maxWidth,s.P.maxHeight,a.neutral.light.border),"aria-hidden":!0},n.createElement("div",{className:Object(s.y)(s.P.tableCellMiddle,O.label)},n.createElement("h3",{className:Object(s.y)(O.headerText,a.neutral.dark.font),"aria-label":b.a.Alert_Title},b.a.Alert_Title)),o>1?n.createElement(k,{onDismissAll:this.onDismissAll,title:b.a.Alert_Title}):null),t.concat(i).map((function(t){return n.createElement("div",{key:t.payload.systemAlert.Id,className:Object(s.y)(O.notificationItem,a.neutral.foreground.background,a.neutral.lighter.border,a.neutral.foregroundAlt.hover.background)},n.createElement(_,{dismiss:e.props.dismiss?e.props.dismiss:null,notification:t,isInFlexPane:!0}))}))):null},t}(n.Component),se=i(551),re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.focusRoot=null,t.refocus=!1,t.showSettingsPane=function(){Object(r.e)().click("Notifications_CustomizeSettings","NotificationsPane","NotificationSettings"),t.props.showSettings(!0)},t.backButtonClicked=function(){t.props.showSettings(!1),t.refocus=!0},t.componentDidUpdate=function(i,n){e.prototype.componentDidUpdate.call(t,i,n),t.refocus&&(t.focusRoot.focus(),t.refocus=!1)},t.dismissAll=function(e){t.props.dismissAll(e),t.focusRoot.focus()},t.handleKeyDown=function(e){13!==e.keyCode&&32!==e.keyCode||t.showSettingsPane()},t}return Object(p.__extends)(t,e),t.prototype.onComponentVisible=function(){e.prototype.onComponentVisible.call(this),this.props.setSeenInFlexPane()},t.prototype.render=function(){var e=this,t=null,i=[],o=[],a=[],r=[],l=!0;this.props.notifications.forEach((function(e){if(3!==e.toastState)switch(e.providerType){case S.a.NewMailNotification:a.push(e),l=!1;break;case S.a.ReminderNotification:i.push(e),l=!1;break;case S.a.SystemAlert:o.push(e),l=!1;break;case S.a.NewAppNotification:r.push(e),l=!1}}));var d=r.length>0?r[0]:null,u=o.length>0||r.length>0||Object(q.b)(this.props.chatFeatureEnabled,this.props.notificationPreferencesData),f=Object(T.a)();if(this.props.shouldShowSettings&&this.props.notificationPreferencesData)t=n.createElement("div",{id:"NotificationsPane",className:se.settingsContainer},n.createElement(X.a,{hostId:"NotificationsPane",chatFeatureEnabled:this.props.chatFeatureEnabled,notificationPreferences:this.props.notificationPreferencesData,onToggleNotification:this.props.setNotificationSetting,onToggleAllowNotifications:this.props.toggleAllowNotifications}));else if(!u&&this.props.notificationPreferencesData)t=n.createElement("div",{id:"NotificationsPane",className:Object(s.y)(se.section,se.notificationsDisabled,f.neutral.dark.font)},b.a.NotificationsDisabled);else if(null==this.props||!this.props.isNotificationsEnabled||null==this.props.notifications||0===this.props.notifications.length||l)t=n.createElement("div",{id:"NotificationsPane",className:Object(s.y)(se.section,se.notificationsMessage,se.emptyState,f.neutral.dark.font)},n.createElement("div",{id:"EmptyStateImageId",className:se.imgEmptyState}),n.createElement("span",{className:s.H.segoeSemibold,"aria-label":b.a.NoNewNotifications},b.a.NoNewNotifications),n.createElement("span",{"aria-label":b.a.NoNewCheckLaterNote},b.a.NoNewCheckLaterNote));else{var m={dismissAll:this.dismissAll,dismiss:this.props.dismiss,snoozeReminders:this.props.snoozeReminders,notificationConfiguration:this.props,removeReminder:this.props.removeReminder};t=n.createElement("div",{id:"NotificationsPane"},o.length>0?n.createElement("div",{tabIndex:-1,className:Object(s.y)(se.section),role:"region","aria-label":b.a.Alert_Title},n.createElement(ae,Object(p.__assign)({notifications:o},m))):null,i?n.createElement("div",{tabIndex:-1,className:Object(s.y)(se.section),role:"region","aria-label":b.a.Reminder_Title},n.createElement(z,Object(p.__assign)({notifications:i,isInFlexPane:!0},m))):null,this.props.showNewMailNotificationHistory&&a.length>0?n.createElement("div",{tabIndex:-1,className:Object(s.y)(se.section),role:"region","aria-label":b.a.Mail},n.createElement(oe,Object(p.__assign)({notifications:a},m))):null,d?n.createElement("div",{tabIndex:-1,className:Object(s.y)(se.section),role:"region","aria-label":b.a.NotificationMyAppsTitle},n.createElement(ne,Object(p.__assign)({notification:d},m))):null)}return n.createElement("div",{className:se.mainContainer},n.createElement(c.c,{className:Object(s.y)(se.container,f.neutral.lighterAlt.background),isActive:this.props.isActive,title:b.a.Notifications,flexPaneProviderID:this.props.flexPaneProviderID,showBackButton:this.props.shouldShowSettings,onBackButtonClicked:this.backButtonClicked},t),!this.props.shouldShowSettings&&this.props.notificationPreferencesData&&n.createElement("div",{className:se.customizeLinkContainer},n.createElement("div",{id:"NotificationSettingsLink",role:"button",ref:function(t){return e.focusRoot=t},className:Object(s.y)(se.customizeSettingsLink,f.neutral.accent.font),"aria-label":b.a.NotificationSettings,tabIndex:0,onClick:this.showSettingsPane,onKeyDown:this.handleKeyDown},b.a.NotificationSettings)))},t}(c.a),ce=Object(a.b)((function(e,t){return{isActive:t.isActive,shouldShowSettings:e.notificationState.showSettings,notifications:e.notificationState.notifications,setSeenInFlexPane:t.setSeenInFlexPane,showNewMailNotificationHistory:!Object(g.c)(e.shellInitDataState.clientData.WorkloadId),chatFeatureEnabled:e.chatState.chatEnabled,isNotificationsEnabled:e.notificationState.notificationsEnabled,owaLaunchUrl:Object(s.J)(e.appsDataState.apps),workloadID:e.shellInitDataState.clientData.WorkloadId,portalUrl:e.shellInitDataState.clientData.PortalUrl,isConsumerShell:e.shellInitDataState.clientData.IsConsumerShell,hasEXOLicense:e.shellInitDataState.clientData.HasEXOLicense,isAdmin:null!=e.shellInitDataState.navBarData.AdminLink,isOnPremShell:e.shellInitDataState.clientData.IsOnPremShell,upn:e.userState.upn,myAppsUrl:e.shellInitDataState.clientData.MyAppsUrl,notificationPreferencesData:e.notificationState.notificationPreferencesData}}),(function(e){return{setSeenInFlexPane:function(){e(Object(Y.f)())},dismissAll:function(t,i){void 0===i&&(i=[]),e(Object(Y.d)(t,i))},dismiss:function(t,i){e(Object(Y.e)(t,i))},showSettings:function(t){e(Object(Y.i)(t))},onUpdateReminders:function(t){e(Object(Y.a)(t))},removeReminder:function(t){e(Object(Y.m)(!0,null,t))},toggleAllowNotifications:function(t,i){e(Object(V.g)(t,i))},setNotificationSetting:function(t,i,n){e(Object(V.f)(t,i,n))},snoozeReminders:function(t,i){e(Object(Y.j)(t,i))}}}))(re),le=i(553),de=function(e){function t(t){var i=e.call(this,t)||this;return i.setSimpleBellAriaLabel=function(e){i.setState({simpleBellAriaLabel:e})},i.onMouseChange=function(e){return i.setState({isHovered:e})},i.state={isHovered:!1,simpleBellAriaLabel:null},i}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=Object(T.a)();return this.props.isAvailable&&n.createElement("button",{type:"button",onMouseEnter:this.onMouseChange.bind(this,!0),onMouseLeave:this.onMouseChange.bind(this,!1),onFocus:this.onMouseChange.bind(this,!0),onBlur:this.onMouseChange.bind(this,!1),id:l.h,className:Object(s.y)(h.button,e.headerButton,e.highContrastButton),role:"button","aria-disabled":"false","aria-label":null==this.state.simpleBellAriaLabel?b.a.Notification_Title:null,"aria-labelledby":this.state.simpleBellAriaLabel},n.createElement(s.g,{fontIconCss:"ms-Icon--Ringer",fontSize:m.f.toString(),className:Object(s.y)(le.icon),isAriaHidden:!0}),n.createElement(y,{isParentHovered:this.state.isHovered,bellAriaID:l.h,bellAriaLabelID:"SimpleBellAriaLabel",setAriaLabelId:this.setSimpleBellAriaLabel,badgeStyles:h.headerButtonBadgePosition}))},t.prototype.componentDidMount=function(){this.props.isAvailable&&this.props.registerNotificationsFlexPane()},t.prototype.componentDidUpdate=function(e){e.isAvailable!==this.props.isAvailable&&this.props.isAvailable&&this.props.registerNotificationsFlexPane()},t}(n.Component),pe=Object(a.b)((function(e,t){return{isAvailable:!!e.notificationState&&e.notificationState.notificationsEnabled,registerNotificationsFlexPane:t.registerNotificationsFlexPane}}))(de),ue=i(475),fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isNotificationsEnabled&&(this.props.isSubscriptionReady||this.subscribe(this.props))},t.prototype.componentWillReceiveProps=function(e){this.isNotificationSettingUpdate(this.props,e)&&this.props.isSubscriptionReady&&(ue.a.config.notificationPreferencesData=e.notificationPreferencesData)},t.prototype.componentDidUpdate=function(e){this.props.isNotificationsEnabled!==e.isNotificationsEnabled&&this.props.isNotificationsEnabled&&!this.props.isSubscriptionReady&&this.subscribe(this.props)},t.prototype.render=function(){return null},t.prototype.isNotificationSettingUpdate=function(e,t){if(e&&t&&e.notificationPreferencesData&&t.notificationPreferencesData){var i=e.notificationPreferencesData,n=t.notificationPreferencesData;return i.EnableNewItemNotify!==n.EnableNewItemNotify||i.EnableReminders!==n.EnableReminders}return!1},t.prototype.subscribe=function(e){e.isNotificationsEnabled&&e.hasEXOLicense&&this.props.subscribe(e)},t}(n.Component),me=Object(a.b)((function(e){return{isSubscriptionReady:e.notificationState.isSubscriptionReady,isNotificationsEnabled:e.notificationState.notificationsEnabled&&e.notificationState.bellHeaderButtonInLayout,isConsumerShell:e.shellInitDataState.clientData.IsConsumerShell,notificationPreferencesData:e.notificationState.notificationPreferencesData,owaLaunchUrl:Object(s.J)(e.appsDataState.apps),isSystemNotificationsDisabled:e.notificationState.systemNotificationsDisabled,doNotFetchSystemAlertsFromPortal:e.shellInitDataState.clientData.DoNotFetchSystemAlertsFromPortal,upn:e.userState.upn,workloadID:e.shellInitDataState.clientData.WorkloadId,portalUrl:e.shellInitDataState.clientData.PortalUrl,hasEXOLicense:e.shellInitDataState.clientData.HasEXOLicense,isAdmin:null!=e.shellInitDataState.navBarData.AdminLink,isOnPremShell:e.shellInitDataState.clientData.IsOnPremShell,myAppsUrl:e.shellInitDataState.clientData.MyAppsUrl,isGallatinLegalAlertEnabled:e.shellInitDataState.clientData.GallatinLegalAlertEnabled}}),(function(e){return{updateNotificationPreferences:function(t){e(Object(s.gb)(t))},subscribe:function(t){return e(Object(Y.k)(t))}}}))(fe),he=i(462),be=i(44),ge=i(461),Se=[S.a.NewAppNotification];function Ie(e,t,i){var n=e.notificationPreferencesData,o=e.notificationsEnabled,a=e.systemNotificationsDisabled;t&&(o=!!t.NotificationsEnabled&&t.NotificationsEnabled,a=null==t.SystemNotificationsDisabled||t.SystemNotificationsDisabled);var r=e.bellHeaderButtonInLayout;return null!=i&&i.centerCustomizationRegion&&(r=null!=Object(s.E)("NotificationBellIcon",i.centerCustomizationRegion.children)),Object(p.__assign)(Object(p.__assign)({},e),{notificationsEnabled:o,bellHeaderButtonInLayout:r,systemNotificationsDisabled:a,notificationPreferencesData:n})}function ye(e,t){var i=e.notifications.slice(0);return t.providerType===S.a.NewAppNotification&&(i=i.filter((function(e){return Se.indexOf(e.providerType)<0}))),i.push(t),Object(p.__assign)(Object(p.__assign)({},e),{notifications:i})}function Ae(e,t,i,n){if(e.providerType===S.a.NewAppNotification){var o=e.payload;null!=o&&(o.UnseenCount=0,e.toastState=t)}e.toastState=t,null!=i&&(e.isCondensed=i),null!=n&&(e.condensedCount=n)}var ve={notificationState:function(e,t){if(!e){var i=t.shellInitData.shellInitDataState;e=Ie(s.Q,i.clientData||{},i.layout)}var n=e;switch(t.type){case s.k:return Ie(e,t.shellClientData);case s.l:return Ie(e,void 0,t.shellLayout);case s.q:return function(e,t){return Object(p.__assign)(Object(p.__assign)({},e),{notificationPreferencesData:t.notificationPreferenceData})}(e,t);case he.a:return function(e,t){if(void 0===t.payload)return e;if(void 0!==t.payload.providerType)e=ye(e,t.payload);else if("string"==typeof t.payload&&null!=t.payload){var i=JSON.parse(t.payload);i.providerType===S.a.ReminderNotification&&function(e){var t=e.payload.reminder.ReminderItemDataModel;t.ReminderTime=be.a.parseISO8601DateTime(t.ReminderTime.toString()),t.StartDate=be.a.parseISO8601DateTime(t.StartDate.toString()),t.EndDate=be.a.parseISO8601DateTime(t.EndDate.toString());var i=new ge.a(t);e.payload.reminder=i}(i),e=ye(e,i)}return function(e){var t=e.notifications.slice(0),i=t.filter((function(e){return 0===e.toastState&&e.providerType===S.a.NewMailNotification}));if(i.length>w.g)return t.forEach((function(e){e===i[0]?Ae(e,0,!0,i.length):i.slice(1).indexOf(e)>-1&&(e.toastState=1)})),Object(p.__assign)(Object(p.__assign)({},e),{notifications:t});return e}(e)}(e,t);case he.l:return function(e,t){var i=e.notifications.slice(0);if(t.isRemoved)return i=i.filter((function(e){return e.payload.id!==t.id})),Object(p.__assign)(Object(p.__assign)({},e),{notifications:i});if(null!==t.reminder)return i.forEach((function(e){e.payload.id===t.id&&(e.payload.reminder=t.reminder)})),Object(p.__assign)(Object(p.__assign)({},e),{notifications:i});return e}(e,t);case he.h:return function(e,t){for(var i=e.notifications.slice(0),n=0,o=i;n<o.length;n++){var a=o[n];if(t.ids.indexOf(a.payload.id)>-1){Ae(a,t.toastStatus,t.isCondensed,t.condensedCount);break}}return Object(p.__assign)(Object(p.__assign)({},e),{notifications:i})}(e,t);case he.f:return function(e,t){for(var i=e.notifications.slice(0),n=0,o=i;n<o.length;n++){var a=o[n];0!==a.toastState&&1!==a.toastState||Ae(a,2)}return Object(p.__assign)(Object(p.__assign)({},e),{notifications:i})}(e);case he.d:return function(e,t){for(var i=e.notifications.slice(0),n=0,o=i;n<o.length;n++){var a=o[n];a.providerType===t.providerType&&Ae(a,3)}return Object(p.__assign)(Object(p.__assign)({},e),{notifications:i})}(e,t);case he.e:return function(e,t){for(var i=e.notifications.slice(0),n=0,o=i;n<o.length;n++){var a=o[n];t.id===a.payload.id&&Ae(a,3)}return Object(p.__assign)(Object(p.__assign)({},e),{notifications:i})}(e,t);case he.b:return function(e,t){if(null===t.notifications)return e;var i=e.notifications.slice(0);return t.notifications.forEach((function(e){i.push(e)})),Object(p.__assign)(Object(p.__assign)({},e),{notifications:i})}(e,t);case he.c:return function(e,t){var i=e.notifications.slice(0);return i.push({providerType:S.a.SystemAlert,payload:{systemAlert:t.alertData,id:t.alertData.Id},toastType:t.alertData.NotificationToastShouldPersist?1:0,toastState:0,navigationUrl:t.alertData.ActionUrl}),Object(p.__assign)(Object(p.__assign)({},e),{notifications:i})}(e,t);case he.i:n=function(e,t){return Object(p.__assign)(Object(p.__assign)({},e),{showSettings:t.shouldShowSettings})}(e,t);break;case he.j:n=function(e,t){return Object(p.__assign)(Object(p.__assign)({},e),{futureReminders:t.futureReminders})}(e,t);break;case he.k:n=function(e,t){return Object(p.__assign)(Object(p.__assign)({},e),{isSubscriptionReady:t.isReady})}(e,t);break;case he.g:n=function(e,t){return Object(p.__assign)(Object(p.__assign)({},e),{toastsMuted:t.muted})}(e,t)}return n}},Ne=i(322),xe=function(){function e(){}return e.prototype.AddSystemNotification=function(e,t,i,n,o,a,r){null==e||null==t||null==i||null==n||null==a||null===r&&null==o||Object(s.L)().dispatch(Object(Y.c)({Title:e,Message:t,ActionUrl:i,ActionText:n,ActionTarget:o,Id:a,ActionCallback:r,NotificationToastShouldPersist:!0}))},e.prototype.AddNotification=function(e){Object(s.L)().dispatch(Object(Y.a)(e))},e.prototype.MuteToasts=function(){Object(s.L)().dispatch(Object(Y.g)(!0))},e.prototype.UnmuteToasts=function(){Object(s.L)().dispatch(Object(Y.g)(!1))},e.prototype.RegisterSystemNotificationsOpenedCallback=function(e){Object(Ne.a)("O365Shell.Notifications.RegisterSystemNotificationsOpenedCallback","This API is no longer supported. Please remove it or reach out for further instruction.")},e}();var Oe,Ce;s.bb.register(ve),Oe=new xe,Ce=window.O365Shell.Notifications,window.O365Shell.Notifications=Oe,Ce.applyCalls(Oe);var Te=!1,we=!1,Ee=Object(s.L)(),je=Object(r.f)(),_e={component:ce,key:"Notifications",width:c.b},De=Object(r.b)();if(De.subscribe("ShellDataUpdated",(function(){!function(){if(we)return;var e=document.createElement("div");o.render(n.createElement(a.a,{store:Ee},n.createElement(me,null)),e),we=!0}()}),!0),je.layout)je.layout.centerCustomizationRegion&&Object(s.E)("NotificationBellIcon",je.layout.centerCustomizationRegion.children)&&(Me(),De.invoke("LazyComponentLoaded",d.b,v),_e.nativeControlID="NotificationBellIcon",Ee.dispatch(Object(c.e)(_e)));else{var Pe=document.getElementById("O365_MainLink_Bell_Container");if(Pe){Me();o.render(n.createElement(a.a,{store:Ee},n.createElement(pe,{registerNotificationsFlexPane:function(){_e.btnId=l.h,Ee.dispatch(Object(c.e)(_e))}})),Pe)}}function Me(){var e=Object(r.f)();if(!(Te||e&&e.disableToasts)){var t=document.getElementById(l.e);if(t){var i=document.createElement("div");i.id="NotificationToastContainer",t.appendChild(i),s.s.isMobileClient()||(o.render(n.createElement(a.a,{store:Ee},n.createElement(J,null)),i),Te=!0)}}}Object(r.b)().subscribe("ShellDataUpdated",(function(e,t){Me()}),!0)},293:function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"m",(function(){return p})),i.d(t,"h",(function(){return u})),i.d(t,"f",(function(){return f})),i.d(t,"d",(function(){return m})),i.d(t,"e",(function(){return h})),i.d(t,"b",(function(){return b})),i.d(t,"c",(function(){return g})),i.d(t,"i",(function(){return S})),i.d(t,"l",(function(){return I})),i.d(t,"g",(function(){return y})),i.d(t,"j",(function(){return A})),i.d(t,"k",(function(){return v}));var n=i(4),o=i(44),a=i(419),s=i(316),r=i(153),c=i(475),l=i(462);function d(e){return function(t,i){t({type:l.a,payload:e}),s.a.Add(i().notificationState.notifications)}}function p(e,t,i){return function(n,o){n({type:l.l,isRemoved:e,reminder:t,id:i}),s.a.Add(o().notificationState.notifications)}}function u(e,t,i,n){return function(o,a){o({type:l.h,ids:e,toastStatus:t,isCondensed:i,condensedCount:n}),s.a.Add(a().notificationState.notifications)}}function f(){return function(e,t){e({type:l.f});var i=t().notificationState.notifications,n=t().notificationState.notifications.filter((function(e){return 3!==e.toastState&&e.providerType===r.a.NewAppNotification&&null!=e.payload}));s.a.Add(i),n.length>0&&a.a.setSeen(n[0].payload.AllNewAppIDs)}}function m(e,t){return function(i,a,r){i({type:l.d,providerType:e}),r.then((function(e){s.a.Add(a().notificationState.notifications),e.Calendar.dismissReminders(t,o.a.timeZone).catch((function(e){n.i.genericServiceExceptionLog("Notifications_DismissAllNotificationsForProvider_Failed",6,e)}))}))}}function h(e,t){return function(i,a,r){i({type:l.e,id:e}),r.then((function(e){null!=t&&e.Calendar.dismissReminders([t],o.a.timeZone).catch((function(e){n.i.genericServiceExceptionLog("Notifications_DismissNotification_Failed",6,e)})),s.a.Add(a().notificationState.notifications)}))}}function b(e){return{type:l.b,notifications:e}}function g(e){return function(t,i){t({type:l.c,alertData:e}),s.a.Add(i().notificationState.notifications)}}function S(e){return{type:l.i,shouldShowSettings:e}}function I(e){return{type:l.j,futureReminders:e}}function y(e){return{type:l.g,muted:e}}function A(e,t){return function(i,a,s){s.then((function(i){i.Calendar.snoozeReminders(e,t,o.a.timeZone).catch((function(e){n.i.genericServiceExceptionLog("Notifications_SnoozeReminders_Failed",6,e)}))}))}}function v(e){return function(t,i,n){n.then((function(){c.a.SubscribeAllProviders(e).then((function(){t({type:l.k,isReady:!0})})).catch((function(){}))}))}}},298:function(e,t,i){var n=i(535);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},299:function(e,t,i){"use strict";i.d(t,"g",(function(){return a})),i.d(t,"e",(function(){return s})),i.d(t,"d",(function(){return r})),i.d(t,"c",(function(){return c})),i.d(t,"b",(function(){return l})),i.d(t,"a",(function(){return d})),i.d(t,"f",(function(){return p}));var n=i(153),o=i(158),a=2;function s(e,t,i){if(!e||0===e.length)return!1;switch(t){case 40:i.index++;break;case 38:i.index--;break;case 35:i.index=e.length;break;case 36:i.index=0;break;default:return!1}return i.index=i.index%e.length,i.index=i.index<0?0:i.index,i.selectedReminderId=e[i.index].payload.reminder.ReminderItemDataModel.ItemId,!0}function r(){var e=new Date;return e.getUTCFullYear().toString()+e.getUTCMonth().toString()+e.getUTCDate().toString()+e.getUTCHours().toString()+e.getUTCMinutes().toString()+e.getUTCSeconds().toString()+e.getUTCMilliseconds().toString()}function c(e,t){if(null==t||null==t.notificationPreferencesData||!t.notificationPreferencesData.EnableNewItemSoundNotify&&!t.notificationPreferencesData.EnableReminderSound&&!t.notificationPreferencesData.EnableChatSound&&!t.notificationPreferencesData.EnableCallingSound)return"";switch(e.providerType){case n.a.NewMailNotification:return null!=t.mailNotificationAudioUrl&&t.notificationPreferencesData.EnableNewItemSoundNotify?t.mailNotificationAudioUrl:"";case n.a.SystemAlert:return null!=t.systemNotificationAudioUrl?t.systemNotificationAudioUrl:"";case n.a.ReminderNotification:return null!=t.calendarNotificationAudioUrl&&t.notificationPreferencesData.EnableReminderSound?t.calendarNotificationAudioUrl:"";case n.a.ChatNotification:return e.subType===o.a.call?null!=t.callNotificationAudioUrl&&t.notificationPreferencesData.EnableCallingSound?t.callNotificationAudioUrl:"":null!=t.chatNotificationAudioUrl&&t.notificationPreferencesData.EnableChatSound?t.chatNotificationAudioUrl:"";default:return""}}function l(e,t,i){return e.filter((function(e){return i?e.payload.reminder.ReminderItemDataModel.ItemId===t:e.payload.reminder.ReminderItemDataModel.ItemId!==t}))}function d(e,t){var i=e.filter((function(e){return e.providerType===n.a.ReminderNotification}));return t?i.filter((function(e){return 3===e.toastState})):i.filter((function(e){return 3!==e.toastState}))}function p(e){e.preventDefault()}},305:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i(0),o=i(2),a=i(3),s=i(10),r=i(332),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.render=function(){var e,t=this,i=Object(s.a)();return o.createElement("button",{id:this.props.id,className:Object(a.y)(r.toggleBackground,this.props.on?r.toggleOn+" "+i.neutral.accent.font+" "+i.neutral.accent.background:r.toggleOff+" "+i.neutral.dark.border+" "+i.neutral.dark.font+" "+i.neutral.lighterAlt.background+" "),tabIndex:0,title:this.props.ariaLabel,"aria-label":this.props.ariaLabel,role:"switch","aria-checked":this.props.on,onClick:function(){return t.props.onToggled(!t.props.on)}},o.createElement(a.g,{fontIconCss:Object(a.y)("ms-Icon--ToggleThumb",(e={},e[i.neutral.lighterAlt.font]=this.props.on,e))}))},t}(o.Component)},316:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i(4),o=i(1),a=i(31),s=i(3),r=i(43),c=i(398),l=i(69),d=i(138),p=i(153),u=i(400),f=i(293),m=i(6),h="User",b=n.k.SuiteScope,g=function(){function e(){}return e.LoadItemsFromSessionStorageToState=function(t){var i=[];e.GetNoticationsFromSessionStorage(t).then((function(e){if(null!=e&&e.length>0){var n=e.filter((function(e){return e.providerType!==p.a.ReminderNotification||(u.a.isVisibleReminderOverdue(e.payload.reminder.ReminderItemDataModel.EndDate)&&i.push(e.payload.reminder),!1)}));Object(s.L)().dispatch(Object(f.b)(n))}t.notificationPreferencesData.EnableReminders&&(0===i.length&&u.a.GetRemindersFromServer(),u.a.OnGetRemindersSucceeded(i))})).catch((function(){}))},e.GetNoticationsFromSessionStorage=function(t){return new Promise((function(i,n){var s=new l.d;s.requestRead(e.notificationsStorageKey),Object(o.b)().subscribe("SuiteAPILoaded",(function(){r.b.Instance.Storage.submitStorageRequestToSessionStorage(s).then((function(n){if(null!=n&&null!=n.value&&n.hasKey(e.notificationsStorageKey)){var o=n.value(e.notificationsStorageKey);null!==o&&o.length>0&&(Object(a.c)(t.workloadID)||t.notificationPreferencesData.EnableNewItemNotify?i(e.loadNonMailNotificationFromStorage(o)):i(o))}i(null)})).catch((function(e){n(e)}))}),!0)}))},e.Add=function(t){var i=new l.d,n=[];t.forEach((function(e){3!==e.toastState&&n.push(e)})),null!=n&&n.length>0&&(i.requestWrite(n,e.notificationsStorageKey),Object(o.b)().subscribe("SuiteAPILoaded",(function(e){e.Storage.submitStorageRequestToSessionStorage(i).catch((function(){}))}),!0))},e.RemoveItems=function(t,i){var n=new l.d;n.requestRead(e.notificationsStorageKey),r.b.Instance.Storage.submitStorageRequestToSessionStorage(n).then((function(t){if(null!=t&&null!=t.value&&t.hasKey(e.notificationsStorageKey)){var o=t.value(e.notificationsStorageKey),a=void 0;null!=o&&(a=o.filter((function(e){return e.subType!==i}))).length>0&&(n.requestWrite(a,e.notificationsStorageKey),r.b.Instance.Storage.submitStorageRequestToSessionStorage(n).catch((function(){})))}})).catch((function(){}))},e.RetrieveSystemAlertsSessionStorage=function(t,i,n){return new Promise((function(a,s){var d=new l.c(b,h,i),u=new l.c(b,h,t),f=new l.d;f.requestRead(d,u),Object(o.b)().subscribe("SuiteAPILoaded",(function(){r.b.Instance.Storage.submitStorageRequestToSessionStorage(f).then((function(t){if(null!=t&&null!=t.value&&t.hasKey(d)){var i=t.value(d);null!=i&&c.c.UTCNow.compare(c.c.parseISO8601DateTime(i))<c.a&&t.hasKey(u)?a(t.value(u)):(e.RemoveItems(p.a.SystemAlert,n),a([]))}else a([])})).catch((function(e){s(e)}))}),!0)}))},e.StoreSystemAlertToCache=function(e,t,i){if(null!=e){var n=new l.c(b,h,i),a=new l.c(b,h,t),s=new l.d;s.requestWrite(c.c.UTCNow.getNativeDateTime(),n),s.requestWrite(e,a),Object(o.b)().subscribe("SuiteAPILoaded",(function(){r.b.Instance.Storage.submitStorageRequestToSessionStorage(s).catch((function(){}))}),!0)}},e.GetSystemAlertsLastViewedTime=function(){var e=this;return new Promise((function(t,i){var a=new l.d,s=new l.c(b,h,"SystemAlertsLastRefreshDate"),c=null;a.requestRead(s),Object(o.b)().subscribe("SuiteAPILoaded",(function(){r.b.Instance.Storage.submitStorageRequestToSessionStorage(a).then((function(i){if(null!=i&&null!=i.value&&i.hasKey(s)){var n=i.value(s);null!=n&&(c=new Date(n))}else e.GetSystemAlertsLastViewedFromStorage().then((function(e){c=e})).catch((function(){}));t(c)})).catch((function(e){n.i.genericServiceRejection("Notifications_GetSystemAlertsLastViewedTime_Failed",4,e,i)}))}),!0)}))},e.SetSystemAlertsLastViewedToSessionStorage=function(e){var t=new l.d,i=new l.c(b,h,"SystemAlertsLastRefreshDate");t.requestWrite(e,i),r.b.Instance.Storage.submitStorageRequestToSessionStorage(t).catch((function(e){n.i.isCallsBlockedException(e)||n.i.genericServiceExceptionLog("Notifications_SetSystemAlertsLastViewedToSessionStorage_Failed",4,e)}))},e.GetSystemAlertsLastViewedFromStorage=function(){return e.GetAlertLastViewedFromStorage("SystemAlertsLastRefreshDate")},e.SetSystemAlertsLastViewedToStorage=function(){var e=this,t=(new Date).getTime();r.b.Instance.WebShellStorage.writeStorage(d.b.User,d.a.SystemMetadata,"SystemAlertsLastRefreshDate",t).then((function(i){e.SetSystemAlertsLastViewedToSessionStorage(t)})).catch((function(e){n.i.genericServiceExceptionLog("Notifications_SetSystemAlertsLastViewedToStorage_Failed",6,e)}))},e.loadNonMailNotificationFromStorage=function(t){return new Promise((function(i,n){var a=new l.d,s=t.filter((function(e){return e.providerType!==p.a.NewMailNotification}));a.requestRemove(e.notificationsStorageKey),Object(o.b)().subscribe("SuiteAPILoaded",(function(){r.b.Instance.Storage.submitStorageRequestToSessionStorage(a).then((function(t){a.requestWrite(s,e.notificationsStorageKey),r.b.Instance.Storage.submitStorageRequestToSessionStorage(a).catch((function(){})),i(s)})).catch((function(e){n(e)}))}),!0)}))},e.GetLegalAlertLastViewedFromLocalStorage=function(){return new Promise((function(e,t){var i=window.localStorage,o=null;try{if(null!=i){var a=i.getItem("GallatinLegalAlertTimestamp"),s=i.getItem("GallatinLegalAlertLastFetchedTimestamp");if(!Object(m.isNullOrEmptyString)(a)&&!Object(m.isNullOrEmptyString)(s))(new Date).getTime()-new Date(parseInt(s)).getTime()<c.a&&e(o=new Date(parseInt(a)))}e(o)}catch(e){n.i.genericServiceRejection("Notifications_Error_ReadingGallatinAlertTimeStamp_FromLocalStorage",6,e,t)}}))},e.SetLegalAlertLastViewedToLocalStorage=function(e){var t=new Date,i=window.localStorage;try{null!=i&&(null!=e&&i.setItem("GallatinLegalAlertTimestamp",e.getTime().toString()),i.setItem("GallatinLegalAlertLastFetchedTimestamp",t.getTime().toString()))}catch(e){n.i.genericServiceExceptionLog("Notifications_Error_WritingGallatinAlertTimeStamp_ToLocalStorage",6,e)}},e.GetLegalAlertLastViewedFromStorage=function(){return e.GetAlertLastViewedFromStorage("GallatinLegalAlertTimestamp")},e.SetLegalAlertLastViewedToStorage=function(){var e=this,t=new Date;r.b.Instance.WebShellStorage.writeStorage(d.b.User,d.a.SystemMetadata,"GallatinLegalAlertTimestamp",t.getTime()).then((function(i){e.SetLegalAlertLastViewedToLocalStorage(t)})).catch((function(e){n.i.genericServiceExceptionLog("Notifications_SetLegalAlertsLastViewedToStorage_Failed",6,e)}))},e.GetAlertLastViewedFromStorage=function(e){return new Promise((function(t,i){Object(o.b)().subscribe("SuiteAPILoaded",(function(){r.b.Instance.WebShellStorage.readStorage(d.b.User,d.a.SystemMetadata,e).then((function(e){var i=null;null!=e.value&&(i=new Date(e.value)),t(i)})).catch((function(t){n.i.genericServiceRejection("Notifications_GetAlertLastViewedFromStorage_"+e+"_Failed",6,t,i)}))}),!0)}))},e.notificationsStorageKey=new l.c(b,h,"NotificationsHistory"),e}()},320:function(e,t,i){"use strict";var n=i(3),o=i(1),a=i(91),s=i(4),r="Chat Settings Instance not available",c=function(){function e(){}return e.getNotificationForChatSetting=function(e){return new Promise((function(t,i){if(a.a){var n=null;a.a.getChatNotificationSettings().then((function(i){n=Object(a.e)(i,e),t(n)})).catch((function(e){Object(o.e)().exception("Settings_GetNotificationPreferencesForChatFromChatApi_Failed",6,e),i(e)}))}else i(new s.a(r))}))},e.getNotificationForCallingSetting=function(e){return new Promise((function(t,i){if(a.a){var n=null;a.a.getCallNotificationSettings().then((function(i){n=Object(a.d)(i,e),t(n)})).catch((function(e){Object(o.e)().exception("Settings_GetNotificationPreferencesForCallingFromChatApi_Failed",6,e),i(e)}))}else i(new s.a(r))}))},e.setChatNotificationPreferences=function(e){var t={Enabled:e.EnableChat,SoundEnabled:e.EnableChatSound};return a.a?a.a.setChatNotificationSettings(t):Promise.reject(new s.a(r))},e.setCallingNotificationPreferences=function(e){var t={Enabled:e.EnableCalling,SoundEnabled:e.EnableCallingSound};return a.a?a.a.setCallNotificationSettings(t):Promise.reject(new s.a(r))},e}(),l=function(){function e(){}return e.setNotificationSetting=function(e,t,i,n){"newItemNotification"!==t&&"newItemSoundNotification"!==t&&"reminderNotification"!==t&&"reminderSoundNotification"!==t||e.Settings.setNotificationPreferences(n).catch((function(e){Object(o.e)().exception("Settings_setNotificationPreferences_Failed",6,e)})),!0===i&&("chatNotification"!==t&&"chatSoundNotification"!==t||c.setChatNotificationPreferences(n).catch((function(e){Object(o.e)().exception("Settings_setChatNotificationPreferences_Failed",6,e)})),"callingNotification"!==t&&"callingSoundNotification"!==t||c.setCallingNotificationPreferences(n).catch((function(e){Object(o.e)().exception("Settings_setCallingNotificationPreferences_Failed",6,e)})))},e.setToggleAllowNotifications=function(e,t,i){e.Settings.setNotificationPreferences(i).catch((function(e){Object(o.e)().exception("Settings_setNotificationPreferences_Failed",6,e)})),t&&(c.setChatNotificationPreferences(i).catch((function(e){Object(o.e)().exception("Settings_setChatNotificationPreferences_Failed",6,e)})),c.setCallingNotificationPreferences(i).catch((function(e){Object(o.e)().exception("Settings_setCallingNotificationPreferences_Failed",6,e)})))},e}(),d=i(115);function p(e){return function(t,i,n){n.then((function(i){i.Settings.getLanguageChoices().then((function(i){t(Object(d.g)(i)),t(function(e){return function(t,i,n){n.then((function(i){i.Settings.getLanguageAndTimeZone().then((function(n){if(t(Object(d.f)(n.CurrentCultureName)),e)i.Settings.getTimeZoneChoices().then((function(e){t(Object(d.r)(e)),t(Object(d.q)(n.CurrentTimeZone,n.CurrentDateFormat,n.CurrentTimeFormat));var i={locale:n.CurrentCultureName,timezone:n.CurrentTimeZone,dateformat:n.CurrentDateFormat,timeformat:n.CurrentTimeFormat};Object(o.e)().impression("LanguageAndRegionCard_InitialValues","SettingsCard",0,void 0,JSON.stringify(i))})).catch((function(e){return Object(o.e)().exception("Settings_getTimeZoneChoices_Failed",6,e)}));else{var a={locale:n.CurrentCultureName};Object(o.e)().impression("LanguageAndRegionCard_InitialValues","SettingsCard",0,void 0,JSON.stringify(a))}})).catch((function(e){Object(o.e)().exception("Settings_getLanguageAndTimeZone_Failed",6,e)}))}))}}(e))})).catch((function(e){return Object(o.e)().exception("Settings_getLanguageChoices_Failed",6,e)}))}))}}function u(e){return function(t,i,n){return new Promise((function(i,o){n.then((function(n){n.Settings.setLanguageAndTimeZone(e).then((function(){t(Object(d.j)()),i()})).catch(o)}))}))}}function f(e,t,i){return function(n,a,s){s.then((function(a){a.Settings.getDateTimeFormats(e).then((function(e){n(Object(d.c)(e.DateFormats)),n(Object(d.p)(e.TimeFormats));var o=e.DateFormats.some((function(e){return e===t})),a=e.TimeFormats.some((function(e){return e===i}));o||""===t||n(Object(d.k)(e.DateFormats[0])),a||""===i||n(Object(d.m)(e.TimeFormats[0]))})).catch((function(e){Object(o.e)().exception("Settings_getDateTimeFormats_Failed",6,e)}))}))}}function m(){return function(e,t,i){i.then((function(t){t.Settings.loadUserThemeChoices().then((function(t){e(Object(n.db)(t))})).catch((function(e){Object(o.e)().exception("Settings_loadUserThemeChoices_Failed",6,e)}))}))}}function h(e,t){return function(i,a,s){s.then((function(a){a.Settings.getNotificationPreferences(e).then((function(e){t?c.getNotificationForChatSetting(e).then((function(e){c.getNotificationForCallingSetting(e).then((function(e){Object(o.e)().impression("NotificationsCard_InitialValue","SettingsCard",0,void 0,JSON.stringify(e)),i(Object(n.gb)(e))}))})):i(Object(n.gb)(e))}))}))}}function b(e,t){return function(i,o,a){a.then((function(o){i(Object(n.gb)(t)),l.setToggleAllowNotifications(o,e,t)}))}}function g(e,t,i){return function(o,a,s){s.then((function(a){o(Object(n.gb)(i)),l.setNotificationSetting(a,e,t,i)}))}}i.d(t,"a",(function(){return p})),i.d(t,"e",(function(){return u})),i.d(t,"b",(function(){return f})),i.d(t,"d",(function(){return m})),i.d(t,"c",(function(){return h})),i.d(t,"g",(function(){return b})),i.d(t,"f",(function(){return g}))},322:function(e,t,i){"use strict";function n(e,t,i){var n="Warning: Deprecated Shell API ("+e+") usage detected.  "+t;i&&(n+="More info: "+i),console;try{throw new Error(n)}catch(e){}}i.d(t,"a",(function(){return n}))},332:function(e,t,i){var n=i(333);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},333:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,".o365cs-base ._2lREKuUz91b85NmkHsf87t{min-width:0;position:relative;font-size:20px;width:44px;height:20px;display:flex;cursor:pointer;padding:0 5px 2px;border-radius:20px;border:1px solid transparent;line-height:12px;float:right;opacity:.8}.o365cs-base ._2lREKuUz91b85NmkHsf87t:focus,.o365cs-base ._2lREKuUz91b85NmkHsf87t:hover{opacity:1}.o365cs-base ._2QAWCmvvmQ7D-Za9LXtjR9{justify-content:flex-end}.o365cs-base ._2QAWCmvvmQ7D-Za9LXtjR9 div{padding-top:3px;line-height:14px;font-size:12px}.o365cs-base ._105zViX4v31YpkMlBKDYqd{justify-content:flex-start;border:1px solid}.o365cs-base ._105zViX4v31YpkMlBKDYqd div{padding-top:3px;line-height:12px;font-size:12px}",""]),t.locals={toggleBackground:"_2lREKuUz91b85NmkHsf87t",toggleOn:"_2QAWCmvvmQ7D-Za9LXtjR9",toggleOff:"_105zViX4v31YpkMlBKDYqd"}},398:function(e,t,i){"use strict";var n=i(44);i.d(t,"c",(function(){return n.a}));i(399);var o=i(62);i.d(t,"a",(function(){return o.a})),i.d(t,"b",(function(){return o.c}))},399:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return l}));var n,o=i(62),a=i(75),s=i(181),r=7*o.a,c=((n={}).default=!0,n.en=!0,n["am-ET"]=!0,n["bg-BG"]=!0,n["bn-IN"]=!0,n["ca-ES"]=!0,n["cz-CZ"]=!0,n["cy-GB"]=!0,n["da-DK"]=!0,n["de-DE"]=!0,n["el-GR"]=!0,n["en-029"]=!0,n["en-AU"]=!0,n["en-BZ"]=!0,n["en-CA"]=!0,n["en-GB"]=!0,n["en-IE"]=!0,n["en-IN"]=!0,n["en-JM"]=!0,n["en-MY"]=!0,n["en-NZ"]=!0,n["en-PH"]=!0,n["en-SG"]=!0,n["en-TT"]=!0,n["en-US"]=!0,n["en-ZA"]=!0,n["en-ZW"]=!0,n["es-ES"]=!0,n["es-MX"]=!0,n["et-EE"]=!0,n["eu-ES"]=!0,n["fi-FI"]=!0,n["fr-BE"]=!0,n["fr-CA"]=!0,n["fr-CH"]=!0,n["fr-FR"]=!0,n["fr-LU"]=!0,n["fr-MC"]=!0,n["gl-ES"]=!0,n["gu-IN"]=!0,n["hi-IN"]=!0,n["hr-HR"]=!0,n["hu-HU"]=!0,n["id-ID"]=!0,n["is-IS"]=!0,n["it-IT"]=!0,n["kk-KZ"]=!0,n["kn-IN"]=!0,n["lt-LT"]=!0,n["lv-LV"]=!0,n["ms-MY"]=!0,n["nb-NO"]=!0,n["nl-NL"]=!0,n["pl-PL"]=!0,n["pt-BR"]=!0,n["pt-PT"]=!0,n["ro-RO"]=!0,n["ru-RU"]=!0,n["sk-SK"]=!0,n["sl-SI"]=!0,n["sv-SE"]=!0,n["ta-IN"]=!0,n["te-IN"]=!0,n["tr-TR"]=!0,n["uk-UA"]=!0,n["vi-VN"]=!0,n),l=function(){function e(){}return e.ConvertToDateTime=function(e){var t=new Date(e.year,e.month,e.date,e.hour).getTimezoneOffset()*o.c,i=e.GetMilliseconds()+t;return new Date(i)},e.GetShortTime=function(t){var i=null,n=null;a.a.Instance.is24HourFormat?n="H":(n="h",i=c[a.a.Instance.userCulture]?"t":"tt",i="t");var o=a.a.Instance.timeFormat,r=e.ConvertToDateTime(t),l=s(r,n);l=l+e.GetTimeSeparator(o)+s(r,"MM");var d=null==i?"":s(r,i);return 0===o.indexOf("tt")?d+l:l+d},e.GetTimeSeparator=function(e){var t=null;if(-1!==e.indexOf("'h'"))return"'h'".replace("/'+/g","");if(-1!==e.indexOf("' h '"))return"' h '".replace("/'+/g","");var i=e.split(new RegExp("[hH]+"));return null!=i&&i.forEach((function(e){e.length>1&&(t=e.substring(0,1))})),t},e}()},400:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n,o,a=i(4),s=i(1),r=i(3),c=i(62),l=i(44),d=i(107),p=i(461),u=i(293),f=i(299),m=i(153),h=8*c.b,b=function(){function e(){}return e.handleNotification=function(e,t){if(null!==e){e&&e.shouldGetReminders&&this.GetRemindersFromServer()}},e.GetReminderNotificationItem=function(e){var t=null;if(e&&e.length>0){var i=e.filter((function(e){return e.providerType===m.a.ReminderNotification}));null!=i&&i.length>0&&(t=i[0])}return t},e.GetRemindersFromServer=function(){o&&window.clearInterval(o),Object(s.b)().subscribe("SuiteAPILoaded",(function(){d.a.Instance.Calendar.getReminders(null,l.a.UTCNow.addDays(10).getNativeDateTime(),!0,l.a.timeZone).then((function(t){e.OnGetRemindersFromServerSucceeded(t)})).catch((function(e){!1===a.i.isCallsBlockedException(e)&&Object(s.e)().exception("Notifications_GetRemindersFromServer_Failed",6,e)}))}),!0)},e.OnGetRemindersFromServerSucceeded=function(t){var i=this,n=Object(r.L)(),a=n.getState().notificationState.notifications.slice(0),s=Object(f.a)(a,!0);if(s.length>0)n.dispatch(Object(u.m)(!0,null,s[0].payload.id));else{if(null!=t){var c,l=[];t.forEach((function(t){i.isVisibleReminderOverdue(t.EndDate)&&(c=e.CreateReminderItem(t,0),l.push(c))})),e.OnGetRemindersSucceeded(l)}o=window.setTimeout((function(){i.GetRemindersFromServer()}),h)}},e.CreateReminderItem=function(e,t){var i={Subject:e.Subject,Location:e.Location,ReminderTime:l.a.parseISO8601DateTime(e.ReminderTime),StartDate:l.a.parseISO8601DateTime(e.StartDate),EndDate:l.a.parseISO8601DateTime(e.EndDate),ItemId:e.ItemId,RecurringMasterItemId:e.RecurringMasterItemId,ReminderGroup:e.ReminderGroup||0,ReminderGroups:e.ReminderGroupTypes,JoinOnlineMeetingUrl:e.JoinOnlineMeetingUrl,displayState:t};return new p.a(i)},e.initalReminderNotification=function(e){return{providerType:m.a.ReminderNotification,payload:{id:m.a[m.a.ReminderNotification]+Object(f.d)()+Math.floor(1e3*Math.random()),reminder:e},toastState:0,toastType:1,navigationUrl:null}},e.OnGetRemindersSucceeded=function(t){var i=this,n=Object(r.L)(),o=Object(f.a)(n.getState().notificationState.notifications.slice(0),!1),a=[],s=t.sort((function(e,t){return e.ReminderItemDataModel.StartDate.compare(t.ReminderItemDataModel.StartDate)})).map((function(e){return i.initalReminderNotification(e)})),c=l.a.UTCNow,d=0;if(s.forEach((function(e){e.payload.reminder.ReminderItemDataModel.ReminderTime.toUTC().compare(c)>0?a.push(e.payload.reminder):(o.length>d?n.dispatch(Object(u.m)(!1,e.payload.reminder,o[d].payload.id)):n.dispatch(Object(u.a)(e)),d++)})),o.length>d)for(var p=d;p<o.length;p++)n.dispatch(Object(u.m)(!0,null,o[p].payload.id));n.dispatch(Object(u.l)(a)),e.RefreshNextReminderTimer(n,c,a)},e.RefreshNextReminderTimer=function(e,t,i){var o=this;window.clearInterval(n),i.sort((function(e,t){return e.ReminderItemDataModel.ReminderTime.compare(t.ReminderItemDataModel.ReminderTime)}));var a=i.length>0?i[0]:null;a&&(n=window.setTimeout((function(){o.ActivateReminders(e,l.a.UTCNow,i)}),a.ReminderItemDataModel.ReminderTime.toUTC().Subtract(t)))},e.ActivateReminders=function(t,i,n){var o,a=this;n=n.filter((function(e){return!(e.ReminderItemDataModel.ReminderTime.toUTC().compare(i)<=0)||(o=a.initalReminderNotification(e),t.dispatch(Object(u.a)(o)),!1)})),null!=o&&t.dispatch(Object(u.l)(n)),e.RefreshNextReminderTimer(t,i,n)},e.isVisibleReminderOverdue=function(e){return("string"==typeof e?l.a.parseISO8601DateTime(e):e).toUTC().addMinutes(15).compare(l.a.UTCNow)>=0},e}()},401:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i(0),o=i(2),a=i(3),s=i(1),r=i(305),c=i(5),l=i(91),d=i(402),p=i(10),u=function(e){function t(t){var i=e.call(this,t)||this;return Object(s.e)().impression("NotificationSettings","NotificationsSettingsPane"),i.state={allowNotifications:Object(l.b)(i.props.chatFeatureEnabled,i.props.notificationPreferences)},i}return Object(n.__extends)(t,e),t.prototype.componentDidMount=function(){var e=document.getElementById("FlexpaneBackButton");e||(e=document.getElementById("O365fp_firstFocusable")),window.setTimeout((function(){return e.focus()}),100)},t.prototype.toggleNotification=function(e){if("allowNotifications"!==e){var t=this.props.notificationPreferences;this.mapKeyToPreferenceKey(e,t,!0),this.setState({allowNotifications:Object(l.b)(this.props.chatFeatureEnabled,t)}),this.logNotificationChange(e,t),this.props.onToggleNotification(e,this.props.chatFeatureEnabled,t)}else this.toggleAllowNotifications()},t.prototype.toggleAllowNotifications=function(){var e=!this.state.allowNotifications,t=Object(n.__assign)(Object(n.__assign)({},this.props.notificationPreferences),{EnableNewItemNotify:e,EnableNewItemSoundNotify:e,EnableReminders:e,EnableReminderSound:e});this.props.chatFeatureEnabled&&(t=Object(n.__assign)(Object(n.__assign)({},t),{EnableChat:e,EnableChatSound:e,EnableCalling:e,EnableCallingSound:e})),this.setState({allowNotifications:e}),this.logNotificationChange("allowNotifications",t),this.props.onToggleAllowNotifications(this.props.chatFeatureEnabled,t)},t.prototype.render=function(){var e=this.state.allowNotifications?null:d.hidden,t=this.props.notificationPreferences,i=Object(p.a)();return t&&o.createElement("div",{id:"NotificationsPreferencePanel",className:d.notificationsSubPanel},o.createElement("div",{className:Object(a.y)(d.settingHeader,i.neutral.dark.font)},c.a.NotificationSettings),this.buildNotificationSettingControl(Object(a.y)(d.notification),c.a.AllowNotifications,"allowNotifications",this.state.allowNotifications),o.createElement("div",{className:Object(a.y)(d.horizRule,i.neutral.light.background)}),this.props.chatFeatureEnabled&&o.createElement("div",null,this.buildNotificationSettingControl(Object(a.y)(e,t.EnableChat?null:d.lastNotificationSetting),c.a.ChatNotificationSetting,"chatNotification",t.EnableChat,c.a.ChatNotificationSettingLabel),this.buildNotificationSettingControl(Object(a.y)(e,d.lastNotificationSetting,t.EnableChat?null:d.hidden),c.a.ChatSoundNotificationSetting,"chatSoundNotification",t.EnableChatSound),this.buildNotificationSettingControl(Object(a.y)(e,t.EnableCalling?null:d.lastNotificationSetting),c.a.CallingNotificationSetting,"callingNotification",t.EnableCalling),this.buildNotificationSettingControl(Object(a.y)(e,d.lastNotificationSetting,t.EnableCalling?null:d.hidden),c.a.CallingSoundNotificationSetting,"callingSoundNotification",t.EnableCallingSound)),this.buildNotificationSettingControl(Object(a.y)(e,t.EnableNewItemNotify?null:d.lastNotificationSetting),c.a.NewMailNotificationSetting,"newItemNotification",t.EnableNewItemNotify,c.a.NewMailNotificationSettingLabel),this.buildNotificationSettingControl(Object(a.y)(e,d.lastNotificationSetting,t.EnableNewItemNotify?null:d.hidden),c.a.NewMailSoundNotificationSetting,"newItemSoundNotification",t.EnableNewItemSoundNotify),this.buildNotificationSettingControl(e,c.a.RemindersNotificationSetting,"reminderNotification",t.EnableReminders),this.buildNotificationSettingControl(Object(a.y)(e,d.lastNotificationSetting,t.EnableReminders?null:d.hidden),c.a.RemindersSoundNotificationSetting,"reminderSoundNotification",t.EnableReminderSound))},t.prototype.buildNotificationSettingControl=function(e,t,i,n,s){var c=this,l=Object(p.a)();return o.createElement("div",{className:Object(a.y)(d.notification,e),tabIndex:-1},o.createElement("div",{"aria-hidden":"true",className:Object(a.y)(d.notificationName,l.neutral.dark.font)},t),o.createElement(r.a,{id:i,ariaLabel:s||t,on:n,onToggled:function(){return c.toggleNotification(i)}}))},t.prototype.logNotificationChange=function(e,t){var i=this.mapKeyToPreferenceKey(e,t,!1);Object(s.e)().click(e,this.props.hostId,"NotificationSettings",null,i.toString())},t.prototype.mapKeyToPreferenceKey=function(e,t,i){var n={status:!1};switch(e){case"allowNotifications":case"newItemNotification":t.EnableNewItemNotify=this.changedItem(i,t.EnableNewItemNotify,n);break;case"newItemSoundNotification":t.EnableNewItemSoundNotify=this.changedItem(i,t.EnableNewItemSoundNotify,n);break;case"reminderNotification":t.EnableReminders=this.changedItem(i,t.EnableReminders,n);break;case"reminderSoundNotification":t.EnableReminderSound=this.changedItem(i,t.EnableReminderSound,n);break;case"chatNotification":t.EnableChat=this.changedItem(i,t.EnableChat,n);break;case"chatSoundNotification":t.EnableChatSound=this.changedItem(i,t.EnableChatSound,n);break;case"callingNotification":t.EnableCalling=this.changedItem(i,t.EnableCalling,n);break;case"callingSoundNotification":t.EnableCallingSound=this.changedItem(i,t.EnableCallingSound,n)}return n.status},t.prototype.changedItem=function(e,t,i){return i.status=e?!t:t,i.status},t}(o.Component)},402:function(e,t,i){var n=i(403);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},403:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,'.o365cs-base ._1CCgMmR6ZCinxS_3IXPRY8{font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-size:16px;font-weight:600;margin-bottom:8px}.o365cs-base .M5HA_IWR7qEj17DM-sAj0{margin-bottom:8px}.o365cs-base ._2QffGCcZa8uPn5vxGvj5Iy{display:flex;margin-bottom:12px}.o365cs-base ._1VPfOUt1YTMsrNhP02-EiI{margin-bottom:36px}.o365cs-base ._2e16goUQbriLwHUO1mx6oT{font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;line-height:20px;width:100%}.o365cs-base ._1CdlLk-dqLGR0EqatJeeWo{display:none!important}.o365cs-base ._1qCP2AU1U2z-EOMUW6A-x3{height:2px;margin-top:24px;margin-bottom:24px}',""]),t.locals={settingHeader:"_1CCgMmR6ZCinxS_3IXPRY8",notificationsSubPanel:"M5HA_IWR7qEj17DM-sAj0",notification:"_2QffGCcZa8uPn5vxGvj5Iy",lastNotificationSetting:"_1VPfOUt1YTMsrNhP02-EiI",notificationName:"_2e16goUQbriLwHUO1mx6oT",hidden:"_1CdlLk-dqLGR0EqatJeeWo",horizRule:"_1qCP2AU1U2z-EOMUW6A-x3"}},419:function(e,t,i){"use strict";var n,o=i(0),a=i(3),s=i(1),r=i(293),c=i(35),l=i(4);!function(e){e.New="New",e.Seen="Seen",e.Dismissed="Dismissed"}(n||(n={}));var d=i(153),p=i(5);i.d(t,"a",(function(){return u}));var u=function(){function e(){}return e.getNewAppNotification=function(){Object(a.L)().dispatch(f(l.b.GET))},e.dismiss=function(e){Object(a.L)().dispatch(f(l.b.POST,e,n.Dismissed))},e.setSeen=function(e){Object(a.L)().dispatch(f(l.b.POST,e,n.Seen))},e.myAppsUrl="",e}();function f(e,t,i){return function(f,m,h){var b=t?{Status:i,IDs:t}:"";h.then((function(t){(function(e,t,i){return new Promise((function(n,o){e.Service.callWebClientShellServiceFunction("/api/notifications",t,null,i).then((function(e){n(e)})).catch((function(e){l.i.isCallsBlockedException(e)||Object(s.e)().exception("NewAppProvider_CallNewAppNotificationAPI_Failed",6,e),o(e)}))}))})(t,e,b).then((function(e){var t=function(e,t){if(!e)return null;var i=e.Notifications,s=null;if(i&&i.length>0){var r=i.filter((function(e){return"NewApp"===e.Type}));r.length>0&&(s=function(e,t){var i=null,s=null,r=null,l=null,f=0;if(e.length>0&&null!=t&&t.length>0){var m,h=[];e.forEach((function(e){(m=function(e,t){if(t){var i=e.filter((function(e){return!!e.Id&&e.Id.substring(e.Id.indexOf("Shell")<0?0:5)===t.Payload}));if(i.length>0)return Object(o.__assign)(Object(o.__assign)({},t),{LaunchFullUrl:i[0].LaunchFullUrl,Title:i[0].Title,CollectorID:i[0].CollectorId})}return null}(t,e))&&(h.push(m),e.Status===n.New&&f++)}));var b=h.length;if(0===b)return null;1===b?(i=Object(a.I)(p.a.SingleNewAppTitle,h[0].Title),s=Object(a.I)(p.a.SingleNewAllMessage,h[0].Title),r=p.a.SingleNewAppAction,l=h[0].LaunchFullUrl?h[0].LaunchFullUrl:""):(i=p.a.MultipleNewAppTitle,h[0].Title&&h[1].Title&&(s=b<=3?Object(a.I)(2===b?p.a.MultipleTwoNewAppsMessage:p.a.MultipleThreeNewAppsMessage,h[0].Title,h[1].Title):Object(a.I)(p.a.MultipleFourNewAppsMessage,h[0].Title,h[1].Title,(b-2).toString())),r=p.a.MultipleNewAppAction,l=u.myAppsUrl);var g={ID:"NewAppNotification",Title:i,Message:s,Type:d.a.NewAppNotification,LaunchFullUrl:l,ActionText:r,UnseenCount:f,AllNewAppIDs:h.map((function(e){return e.ID})),ItemID:1===b?h[0].ID:"NewAppNotification",CollectorID:1===b?h[0].CollectorID:"",AllAppTileIDs:h.map((function(e){return c.c(e.ID,e.CollectorID)}))};return{providerType:d.a.NewAppNotification,payload:g,toastState:0,toastType:3,navigationUrl:l}}return null}(r,t))}return s}(e,m().appsDataState.apps);null!=t&&f(Object(r.a)(t))})).catch((function(){}))}))}}},460:function(e,t,i){"use strict";function n(e){window.open(e,"_blank","width=1000,height=600,top=150,left=150,menubar=no,resizable=yes,status=no,scrollbars=yes,titlebar=no,toolbar=no")}i.d(t,"a",(function(){return n}))},461:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i(31),o=i(62),a=i(44),s=i(399),r=i(43),c=i(1),l=i(11),d=i(153),p=i(460),u=i(5),f=function(){function e(t){this.reminderItemDataModel=null,this.isReminderOverdue=!1,this.reminderItemDataModel=t,this.referenceDateTime=e.GetReferenceTimeFromNow(),this.UpdateTimeToStartFromReferenceTime(),0!==this.reminderItemDataModel.ReminderGroup&&1!==this.reminderItemDataModel.ReminderGroup&&Object(r.a)(Object(l.b)("Invalid value {0} for reminder group",this.reminderItemDataModel.ReminderGroup))}return Object.defineProperty(e.prototype,"ReminderItemDataModel",{get:function(){return this.reminderItemDataModel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsReminderOverdue",{get:function(){return this.isReminderOverdue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeToItemStartValue",{get:function(){return this.timeToStartValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeToItemStartUnit",{get:function(){return this.timeToStartUnit},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeLabel",{get:function(){var t="";return 0===this.reminderItemDataModel.ReminderGroup?t=a.a.areDatePartsEqual(this.reminderItemDataModel.StartDate,this.referenceDateTime)&&a.a.areDatePartsEqual(this.reminderItemDataModel.StartDate,this.reminderItemDataModel.EndDate)?Object(l.b)("{0} - {1}",s.a.GetShortTime(this.reminderItemDataModel.StartDate),s.a.GetShortTime(this.reminderItemDataModel.EndDate)):e.GetLongDateTimeString(this.reminderItemDataModel.StartDate):1===this.reminderItemDataModel.ReminderGroup&&(t=s.a.GetShortTime(this.reminderItemDataModel.ReminderTime)),t},enumerable:!0,configurable:!0}),e.prototype.UpdateReferenceTimeFromNow=function(){this.referenceDateTime=e.GetReferenceTimeFromNow(),this.UpdateTimeToStartFromReferenceTime()},e.prototype.UpdateReferenceTime=function(t){this.referenceDateTime=e.GetReferenceTime(t),this.UpdateTimeToStartFromReferenceTime()},e.GetLongDateTimeString=function(t){var i=s.a.GetShortTime(t),n=e.daysOfTheWeek[s.a.ConvertToDateTime(t).getDay()],o=e.monthsOfTheYear[t.month],a=t.date.toString(),r=t.year.toString();return Object(l.b)("{0} {1}, {2} {3}, {4}",i,n,o,a,r)},e.prototype.UpdateTimeToStartFromReferenceTime=function(){var e=this.GetTimeToStartInMillis(),t=this.GetDurationInfo(Math.abs(e));this.isReminderOverdue=Math.floor(e/o.c)<0,this.timeToStartValue=t[0],this.timeToStartUnit=t[1]},e.prototype.GetTimeToStartInMillis=function(){var e=null;return 0===this.reminderItemDataModel.ReminderGroup?e=this.reminderItemDataModel.StartDate:1===this.reminderItemDataModel.ReminderGroup&&(e=this.reminderItemDataModel.ReminderTime),e.Subtract(this.referenceDateTime)},e.prototype.GetTimeToEndInMillis=function(){var e=null;if(0===this.reminderItemDataModel.ReminderGroup)e=this.reminderItemDataModel.EndDate;else{if(1!==this.reminderItemDataModel.ReminderGroup)return 0;e=this.reminderItemDataModel.ReminderTime}return e.Subtract(this.referenceDateTime)},e.prototype.OpenItem=function(e,t){Object(c.e)().click("NotificationClick","NotificationToast",d.a[d.a.ReminderNotification]);var i="",o=null,a=t.indexOf("?")>-1?"&":"?",s=this.reminderItemDataModel.ReminderGroups;1==(1&s)?o=4==(4&s)?"IBirthdayFactory":"ICalendarItemDetailsViewModelFactory":2==(2&s)&&(o="TaskReadingPaneViewModelPopOutFactory");i=Object(n.c)(e)?Object(l.b)("{0}{1}path=/owa&viewmodel={2}&ispopout=1&ItemID={3}",t,a,o,encodeURIComponent(this.reminderItemDataModel.ItemId.Id)):Object(l.b)("{0}{1}path=/owa&ItemID={2}",t,a,encodeURIComponent(this.reminderItemDataModel.ItemId.Id)),Object(p.a)(i)},e.prototype.GetDurationInfo=function(e){var t=0,i=u.a.Now_Title;return e>=s.b?i=1===(t=Math.floor(e/s.b))?u.a.Week_Title:u.a.Weeks_Title:e>=o.a?i=1===(t=Math.floor(e/o.a))?u.a.Day_Title:u.a.Days_Title:e>=o.b?i=1===(t=Math.floor(e/o.b))?u.a.Hour_Title:u.a.Hours_Title:e>=o.c&&(i=1===(t=Math.floor(e/o.c))?u.a.Min_Title:u.a.Mins_Title),[t>0?t.toString():"",i]},e.GetReferenceTimeFromNow=function(){var t=a.a.Now;return e.GetReferenceTime(t)},e.GetReferenceTime=function(e){return new a.a(e.year,e.month,e.date,e.hour,e.minute,0,0,0)},e.daysOfTheWeek=[u.a.Sunday_Title,u.a.Monday_Title,u.a.Tuesday_Title,u.a.Wednesday_Title,u.a.Thursday_Title,u.a.Friday_Title,u.a.Saturday_Title],e.monthsOfTheYear=[u.a.January_Title,u.a.February_Title,u.a.March_Title,u.a.April_Title,u.a.May_Title,u.a.June_Title,u.a.July_Title,u.a.August_Title,u.a.September_Title,u.a.October_Title,u.a.November_Title,u.a.December_Title],e}()},462:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"l",(function(){return o})),i.d(t,"h",(function(){return a})),i.d(t,"f",(function(){return s})),i.d(t,"d",(function(){return r})),i.d(t,"e",(function(){return c})),i.d(t,"b",(function(){return l})),i.d(t,"c",(function(){return d})),i.d(t,"i",(function(){return p})),i.d(t,"j",(function(){return u})),i.d(t,"k",(function(){return f})),i.d(t,"g",(function(){return m}));var n="suiteux-notification.ADD_NOTIFICATION",o="suiteux-notification.UPDATE_NOTIFICATION",a="suiteux-notification.SET_TOAST_STATUS",s="suiteux-notifications.SET_SEEN_IN_FLEXPANE",r="suiteux-notifications.DISMISS_ALL_NOTIFICATIONS_FOR_PROVIDER",c="suiteux-notifications.DISMISS_NOTIFICATION_FOR_PROVIDER",l="suiteux-notification.ADD_NOTIFICATIONS_FROM_SESSIONSTORAGE",d="suiteux-notification.ADD_SYSTEM_NOTIFICATION",p="suiteux-notification.SHOW_SETTINGS_ACTION",u="suiteux-notification.UPDATE_FUTUREREMINDERS_ACTION",f="suiteux-notification.UPDATE_IS_SUBSCRIPTION_READY_ACTION",m="suiteux-notification.SET_TOASTMUTEDSTATE_ACTION"},463:function(e,t,i){var n=i(542);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},475:function(e,t,i){"use strict";var n=i(31),o=i(3),a=i(91),s=i(1),r=i(43),c=i(398),l=i(316),d=function(){function e(){this.OnGetSystemAlertsSucceeded=function(e){l.a.SetSystemAlertsLastViewedToStorage()}}return e.prototype.GetSystemAlerts=function(){var e=this;r.b.Instance.Calendar.IsInitialized&&l.a.GetSystemAlertsLastViewedTime().then((function(t){var i=new Date;(null==t||i.getTime()-t.getTime()>c.a)&&r.b.Instance.Notification.getSystemAlertsFromAdmin().then(e.OnGetSystemAlertsSucceeded).catch((function(){}))})).catch((function(t){r.b.Instance.Notification.getSystemAlertsFromAdmin().then(e.OnGetSystemAlertsSucceeded).catch((function(){}))}))},e}(),p=i(4),u=i(35),f=i(5),m=i(293),h=i(153),b=function(){function e(e){var t=this;this.launchFullUrl=e,this.retryCount=0,this.OnGetOofAlertSucceeded=function(e){var i=t.CreateOofSystemAlertArray(e);null!=i&&(l.a.StoreSystemAlertToCache(i,"OofAlert","OofAlertFetchTime"),Object(o.L)().dispatch(Object(m.a)(i)))},this.OnGetOofAlertFailed=function(e){!1===p.i.isCallsBlockedException(e)&&(e.message=u.g(e.message),Object(s.e)().exception("Notifications_Error_GettingOOFAlerts",6,e),t.retryCount<2&&(t.retryCount++,t.GetOofAlert()))}}return e.prototype.GetOofAlert=function(){var e=this;r.b.Instance.Calendar.IsInitialized&&l.a.RetrieveSystemAlertsSessionStorage("OofAlert","OofAlertFetchTime","OofAlert").then((function(t){null!=t&&0!==t.length||r.b.Instance.User.getOwaUserOofSettings().then(e.OnGetOofAlertSucceeded).catch(e.OnGetOofAlertFailed)})).catch((function(t){!1===p.i.isCallsBlockedException(t)&&Object(s.e)().exception("Notifications_Error_ReadingOOFAlertFromStorage",4,t),r.b.Instance.User.getOwaUserOofSettings().then(e.OnGetOofAlertSucceeded).catch(e.OnGetOofAlertFailed)}))},e.prototype.CreateOofSystemAlertArray=function(e){var t=null;if(null!=e&&e.IsOofOn){var i=this.launchFullUrl.indexOf("/mail/"),n=this.launchFullUrl.indexOf("/owa/"),o="";if(-1!==i)o=this.launchFullUrl.substring(0,i)+"?#path=/options/automaticreplies";else{if(-1===n)return null;o=this.launchFullUrl.substring(0,n)+"?#path=/options/automaticreplies"}var a={Title:f.a.AutomaticReplies_Title,Message:f.a.AutomaticRepliesOn_Text,ActionText:f.a.AutomaticRepliesOff_Text,ActionTarget:"_self",Id:"OofAlert",ActionUrl:o};t={providerType:h.a.SystemAlert,subType:"OofAlert",payload:{systemAlert:a,id:a.Id},toastType:1,toastState:0,navigationUrl:o}}return t},e}(),g=function(){function e(){}return e.CreateAlert=function(){var e=null,t=Object(o.L)().getState(),i=Object(o.J)(t.appsDataState.apps);if("AdminPortal"!==t.shellInitDataState.clientData.WorkloadId){var n={Title:f.a.TimeZoneAlertTitle,Message:f.a.TimeZoneAlertText,ActionText:f.a.TimeZoneAlertActionText,ActionTarget:"_self",Id:"TimeZoneAlert",ActionUrl:i||""};e={providerType:h.a.SystemAlert,subType:"TimeZoneAlert",payload:{systemAlert:n,id:n.Id},toastType:1,toastState:0,navigationUrl:n.ActionUrl},Object(o.L)().dispatch(Object(m.a)(e))}},e}(),S=i(299),I=function(){function e(){}return e.handle=function(e,t,i,n){if(null!==e){var a=e;if("Reload"!==a.EventType){var s=Object(o.L)(),r=(null===a.SenderSmtpEmailAddress?"":a.SenderSmtpEmailAddress.trim().toLowerCase())!==(null!=n?n.trim().toLowerCase():""),c=t.UserOptions.IsFocusedInboxEnabled||"Other"!==a.InferenceClassification;if(r&&c){var l={providerType:h.a.NewMailNotification,payload:a,toastType:0,toastState:0,navigationUrl:Object(o.I)("{0}?path=/owa&ispopout=1&ItemID={1}",i,encodeURIComponent(a.ItemId))},d=Object(S.d)();l.payload.id=h.a[h.a.NewMailNotification]+d,s.dispatch(Object(m.a)(l))}}}},e}(),y=i(419),A=i(400),v=function(){function e(){var e=this;this.retryCount=0,this.OnGetPasswordExpiryAlertSucceeded=function(t){var i=e.CreatePasswordExpirySystemAlert(t);null!=i&&(l.a.StoreSystemAlertToCache(i,"PasswordExpiryAlert","PasswordExpiryAlertFetchTime"),Object(o.L)().dispatch(Object(m.a)(i)))},this.OnGetPasswordExpiryAlertFailedFromOWA=function(t){!1===p.i.isCallsBlockedException(t)&&(Object(s.e)().exception("Notifications_GetPasswordExpiryAlertFromOWA",4,t),e.retryCount<2&&(e.retryCount++,e.GetPasswordExpiryAlertFromOWA(e.actionUrl,e.isConsumerShell)))},this.OnGetPasswordExpiryAlertFailedFromWCSS=function(t,i){!1===p.i.isCallsBlockedException(t)&&(Object(s.e)().exception("Notifications_GetPasswordExpiryAlertFromWCSS",4,t),e.retryCount<2&&(e.retryCount++,e.GetPasswordExpiryAlertFromWCSS(i)))}}return e.prototype.GetPasswordExpiryAlertFromOWA=function(e,t){var i=this;this.actionUrl=e,this.isConsumerShell=t,r.b.Instance.Calendar.IsInitialized&&l.a.RetrieveSystemAlertsSessionStorage("PasswordExpiryAlert","PasswordExpiryAlertFetchTime","PasswordExpiryAlert").then((function(e){null!==e&&0!==e.length||r.b.Instance.User.getDaysUntilPasswordExpiration().then(i.OnGetPasswordExpiryAlertSucceeded).catch(i.OnGetPasswordExpiryAlertFailedFromOWA)})).catch((function(e){!1===p.i.isCallsBlockedException(e)&&Object(s.e)().exception("Notifications_GetPasswordExpiryAlertFromOWA",4,e),r.b.Instance.User.getDaysUntilPasswordExpiration().then(i.OnGetPasswordExpiryAlertSucceeded).catch(i.OnGetPasswordExpiryAlertFailedFromOWA)}))},e.prototype.GetPasswordExpiryAlertFromWCSS=function(e){var t=this;this.actionUrl=e,l.a.RetrieveSystemAlertsSessionStorage("PasswordExpiryAlert","PasswordExpiryAlertFetchTime","PasswordExpiryAlert").then((function(i){null!=i&&0!==i.length||r.b.Instance.Service.callWebClientShellServiceFunction("/api/alerts/iw/passwordexpiry","GET",null,null).then(t.OnGetPasswordExpiryAlertSucceeded).catch((function(i){return t.OnGetPasswordExpiryAlertFailedFromWCSS(i,e)}))})).catch((function(i){r.b.Instance.Service.callWebClientShellServiceFunction("/api/alerts/iw/passwordexpiry","GET",null,null).then(t.OnGetPasswordExpiryAlertSucceeded).catch((function(i){return t.OnGetPasswordExpiryAlertFailedFromWCSS(i,e)}))}))},e.prototype.CreatePasswordExpirySystemAlert=function(e){var t=null;if(0<=e&&e<100){var i="";1<e?i=Object(o.I)(f.a.PasswordExpiration_Text,e.toString()):1===e?i=Object(o.I)(f.a.PasswordExpiration_IsOne_Text,e.toString()):0===e&&(i=f.a.PasswordExpirationZero_Text);var n="",a={ActionTarget:"_self",ActionUrl:n=this.isConsumerShell?"https://account.live.com/password/Change":this.actionUrl+"/ChangePassword.aspx",ActionText:f.a.ChangePassword_Link,Title:f.a.ChangePassword_Title,Id:"PasswordExpiryAlert",Message:i};t={providerType:h.a.SystemAlert,subType:"PasswordExpiryAlert",payload:{systemAlert:a,id:a.Id},toastType:1,toastState:0,navigationUrl:n}}return t},e}(),N=function(){function e(){}return e.prototype.GetGallatinLegalAlert=function(){var e=this;l.a.GetLegalAlertLastViewedFromLocalStorage().then((function(t){null!==t?e.OnGetAlertLastViewedSucceeded(t):l.a.GetLegalAlertLastViewedFromStorage().then((function(t){e.OnGetAlertLastViewedSucceeded(t)}))}))},e.prototype.OnGetAlertLastViewedSucceeded=function(t){var i=new Date;(null==t||e.ShouldShowTheAlert(i,t))&&this.CreateLegalAlert(),l.a.SetLegalAlertLastViewedToLocalStorage(t)},e.ShouldShowTheAlert=function(e,t){var i=new Date(Date.UTC(e.getFullYear(),0,1,0,0,0,1)),n=new Date(Date.UTC(e.getFullYear(),6,1,0,0,0,1)),o=i.getTime()-e.getTime(),a=n.getTime()-e.getTime();return(a>0?o:Math.max(a,o))>t.getTime()-e.getTime()},e.prototype.CreateLegalAlert=function(){var e={Id:"GallatinLegalAlert",Title:f.a.GallatinLegalAlert_Title,Message:f.a.GallatinLegalAlert_Text,ActionText:f.a.GallatinLegalAlertAction_Text,ActionUrl:"https://www.21vbluecloud.com/office365/O365-VAT/",ActionTarget:"_blank",ActionCallback:function(){l.a.SetLegalAlertLastViewedToStorage()}},t={providerType:h.a.SystemAlert,subType:"GallatinLegalAlert",payload:{systemAlert:e,id:e.Id},toastType:1,toastState:0,navigationUrl:e.ActionUrl};Object(o.L)().dispatch(Object(m.a)(t))},e}();i.d(t,"a",(function(){return x}));var x=function(){function e(){}return e.SubscribeAllProviders=function(t){e.config=t;var i=e.config;return i.isSystemNotificationsDisabled||e.subscribeSystemNotification(),i.isConsumerShell||(y.a.myAppsUrl=i.myAppsUrl,y.a.getNewAppNotification()),new Promise((function(t,n){r.b.Instance.User.getOwaUserConfiguration().then((function(n){if(null!=n){e.owaUserConfiguration=n;var r=Object(a.f)(n,i.notificationPreferencesData);if(i.notificationPreferencesData=r,e.subscribeNewMailNotification(),e.subscribeReminderNotification(),l.a.LoadItemsFromSessionStorageToState(i),r)Object(o.L)().dispatch(Object(o.gb)(r));Object(s.e)().perfMarker("NotificationSubscriptionComplete"),t(!0)}})).catch((function(e){e&&e.message&&e.message.indexOf&&e.message.indexOf("OwaInvalidUserLanguageException")>-1?(g.CreateAlert(),t(!0)):(Object(s.e)().exception("Notifications_GetOwaUserConfiguration_Failed",6,e),n(e))}))}))},e.subscribeNewMailNotification=function(){var t=e.config,i={subscriptionId:h.a[h.a.NewMailNotification],requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:h.a[h.a.NewMailNotification]}};r.b.Instance.Notification.subscribe(i,(function(i){t.isNotificationsEnabled&&t.notificationPreferencesData&&t.notificationPreferencesData.EnableNewItemNotify&&null!==i&&I.handle(i,e.owaUserConfiguration,t.owaLaunchUrl,t.upn)}))},e.subscribeReminderNotification=function(){var t=e.config,i={subscriptionId:h.a[h.a.ReminderNotification],requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:h.a[h.a.ReminderNotification]}};r.b.Instance.Notification.subscribe(i,(function(i){t.isNotificationsEnabled&&t.notificationPreferencesData&&t.notificationPreferencesData.EnableReminders&&null!==i&&A.a.handleNotification(i,e.owaUserConfiguration)}))},e.subscribeSystemNotification=function(){var t=e.config;t.isConsumerShell||t.isOnPremShell||t.doNotFetchSystemAlertsFromPortal||(new d).GetSystemAlerts();r.b.Instance.Calendar.IsInitialized&&Object(n.c)(t.workloadID)&&new b(t.owaLaunchUrl).GetOofAlert();var i=new v;(t.isConsumerShell||t.isOnPremShell?i.GetPasswordExpiryAlertFromOWA(t.portalUrl,t.isConsumerShell):i.GetPasswordExpiryAlertFromWCSS(t.portalUrl),t.isGallatinLegalAlertEnabled)&&(new N).GetGallatinLegalAlert()},e.owaUserConfiguration=null,e}()},535:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,'.o365cs-base ._7eWXfzeyoqJNaged2Hwi_{border-width:1px;border-style:solid;box-shadow:0 2px 4px -.8px rgba(0,0,0,.08);-webkit-box-shadow:0 2px 4px -.8px rgba(0,0,0,.08);margin:0 16px 10px;display:block}.o365cs-base ._7eWXfzeyoqJNaged2Hwi_:hover{box-shadow:0 8px 10px -2px rgba(0,0,0,.08);-webkit-box-shadow:0 8px 10px -2px rgba(0,0,0,.08);transition:border-color .1s linear,box-shadow .1s linear}.o365cs-base ._3GMVzQCMgArnHkZtBBR49{box-shadow:0 16px 18px -4px rgba(0,0,0,.08);-webkit-box-shadow:0 16px 18px -4px rgba(0,0,0,.08);transition:border-color .1s linear,box-shadow .1s linear;border-width:1px;border-style:solid}.o365cs-base ._1Rec7gsPm52G6CGj237lRG{display:block}.o365cs-base ._1oDzOEriikitRqdiWGj2Z5{display:table-cell;height:auto;padding:8px 16px;line-height:16px;text-align:center;vertical-align:middle;opacity:1%;border-radius:2px;font:400 14px;border-width:1px;border-style:solid}.o365cs-base ._2DuABgOwXqnMqWqDzScNza{font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._1tf5tdMjVmm-v4Fear7KjH{display:table-cell}.o365cs-base ._1tf5tdMjVmm-v4Fear7KjH,.o365cs-base ._1tf5tdMjVmm-v4Fear7KjH div,.o365cs-base ._1tf5tdMjVmm-v4Fear7KjH span{font:12px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._1tf5tdMjVmm-v4Fear7KjH div,.o365cs-base ._1tf5tdMjVmm-v4Fear7KjH span{display:inline-block}.o365cs-base ._2sW15Fuoy2F51UEOY1Sr0Q{margin:0 auto 1px;display:inline-block;font-size:12px}.o365cs-base .L9uD9XzqffQmMx2hQBANl{min-width:0;position:absolute;right:14px;border-width:0;background-color:transparent;cursor:pointer;z-index:999;width:32px;height:32px;margin:4px 8px 0 0;box-sizing:border-box;text-align:center}.o365cs-base .L9uD9XzqffQmMx2hQBANl span{font-size:12px}.o365cs-base .irEniQLbDRsOBEgM2cWn8{background-color:transparent;border-width:0;height:22px;display:inline-block;white-space:nowrap;min-width:0;font-size:12px;line-height:16px;padding:0 16px 0 0}.o365cs-base .irEniQLbDRsOBEgM2cWn8 span{cursor:pointer;font:600 12px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._3_a1FahMV3DLaZYdmcTavt{width:100%;text-align:right;display:block}.o365cs-base ._3_a1FahMV3DLaZYdmcTavt button,.o365cs-base ._3_a1FahMV3DLaZYdmcTavt div,.o365cs-base ._3_a1FahMV3DLaZYdmcTavt span{text-align:right}.o365cs-base .Emy7v53NoF60ygK55eFKp{line-height:19px;padding-left:0;font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .Emy7v53NoF60ygK55eFKp div{display:inline-block}.o365cs-base ._3uLDgpDfoajyx3UTCtu_2Q{display:none}.o365cs-base ._2tmdtUHaVnGARAS2TEnRsP{border-top-width:1px;border-top-style:solid;padding-top:8px;margin-top:16px;display:block;width:100%}.o365cs-base ._2tmdtUHaVnGARAS2TEnRsP a{line-height:20px;padding:0 0 10px}.o365cs-base ._2tmdtUHaVnGARAS2TEnRsP button{width:72px;height:32px;border-radius:2px;border-style:solid;border-width:1px;margin-right:10px}.o365cs-base ._1HjnMQoxnJjezQSaI97G7b{padding-left:5px;vertical-align:middle;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}.o365cs-base ._7fCNGI4d0VyULOmaFfqwK{padding-right:8px}.o365cs-base ._1tJXleOBxXbOufc-p0dFUD{display:block}.o365cs-base ._3299hoXmCyACepZBzdou2E{clear:"both"}.o365cs-base ._1XeP5br23jJtrZHtxG0HQ1{line-height:21px;display:table-cell;font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;padding:0 0 0 16px;max-height:40px}.o365cs-base ._2O7DdjItOhnRZi2Wj5NK28{overflow:hidden}.o365cs-base ._3KP6P2tBerKtM2tZA3DLrC{text-decoration:none}.o365cs-base ._3KP6P2tBerKtM2tZA3DLrC:hover{text-decoration:underline}.o365cs-base ._3c6xxZA3mziWMn4FtBLFg7{font-size:10px}.o365cs-base ._1D9KnFt_F-fCwV5UIvQMvC{text-align:left;overflow:hidden;box-sizing:content-box;width:100%;padding:0}.o365cs-base ._3qlKxNCdNKfdgsMlYli5e9{display:table;padding:0;height:auto;background-color:transparent;margin-bottom:12px;border:none}.o365cs-base ._24xpAaT22IdONJN2_qt3Iu{display:table-cell}.o365cs-base ._3WXeYF4AaaDeazzLPvGsIs{margin-top:10px;box-sizing:content-box;width:100%;padding-bottom:16px}.o365cs-base ._2qGYxW41fQQlwQwd9RW5ZT{display:block;height:100%;min-height:64px}.o365cs-base ._3yZJXftAog7Fuo-OZW4fu9:hover{text-decoration:underline}.o365cs-base ._2lWUGbT5kKTEmIRHBSJz5q{padding:0 10px 0 16px;text-align:left;width:100%;height:auto;border-width:0;background:transparent}.o365cs-base ._2lWUGbT5kKTEmIRHBSJz5q span{cursor:pointer;font:400 14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._1sYgcCEvKzKx69GjENgqHF{padding-top:10px}',""]),t.locals={notificationItem:"_7eWXfzeyoqJNaged2Hwi_",notificationToast:"_3GMVzQCMgArnHkZtBBR49",notificationContainer:"_1Rec7gsPm52G6CGj237lRG",notificationButton:"_1oDzOEriikitRqdiWGj2Z5",notificationBodyText:"_2DuABgOwXqnMqWqDzScNza",notificationLink:"_1tf5tdMjVmm-v4Fear7KjH",icon:"_2sW15Fuoy2F51UEOY1Sr0Q",closeButton:"L9uD9XzqffQmMx2hQBANl",dismissAll:"irEniQLbDRsOBEgM2cWn8",dismissContain:"_3_a1FahMV3DLaZYdmcTavt",notificationTitle:"Emy7v53NoF60ygK55eFKp",hidden:"_3uLDgpDfoajyx3UTCtu_2Q",actionBar:"_2tmdtUHaVnGARAS2TEnRsP",actionArrow:"_1HjnMQoxnJjezQSaI97G7b",paddingRight:"_7fCNGI4d0VyULOmaFfqwK",displayBlock:"_1tJXleOBxXbOufc-p0dFUD",clearStyle:"_3299hoXmCyACepZBzdou2E",headerText:"_1XeP5br23jJtrZHtxG0HQ1",overflowHidden:"_2O7DdjItOhnRZi2Wj5NK28",itemLink:"_3KP6P2tBerKtM2tZA3DLrC",headingBar:"_3c6xxZA3mziWMn4FtBLFg7",toastControl:"_1D9KnFt_F-fCwV5UIvQMvC",header:"_3qlKxNCdNKfdgsMlYli5e9",label:"_24xpAaT22IdONJN2_qt3Iu",content:"_3WXeYF4AaaDeazzLPvGsIs",itemContent:"_2qGYxW41fQQlwQwd9RW5ZT",showMoreLink:"_3yZJXftAog7Fuo-OZW4fu9",footer:"_2lWUGbT5kKTEmIRHBSJz5q",paddingTop:"_1sYgcCEvKzKx69GjENgqHF"}},536:function(e,t,i){var n=i(537);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},537:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,'.o365cs-base ._3QSRf0Z93asQsSUg8FNBJp{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.o365cs-base ._1AYkzLSDWmZouFLr0HB8-{padding-left:10px;max-width:198px;width:198px;font-size:14px}.o365cs-base ._2eiL0wdb_5Blsqn3ZR2mzB{line-height:16px;max-width:180px;width:180px;font-size:14px;padding-top:2px;display:table-cell;vertical-align:bottom}.o365cs-base ._3qy97OoIIEk4KqTZdg6s4i{font-size:14px;padding:0 8px 0 10px;display:table-cell;line-height:12px;vertical-align:bottom}.o365cs-base ._1RYzmMt6ppE0VFFHhHtAgV{line-height:18px;padding:4px 0 0;width:250px;font-size:14px}.o365cs-base ._2Hze4lFFggjvHTZH9AoOGw{text-align:left;overflow:hidden;padding:14px;margin:0;cursor:pointer;display:block;height:auto;box-sizing:border-box}.o365cs-base .Wm8RnXkb3nsnJjkDSBvK3{display:table-cell;vertical-align:middle}.o365cs-base ._2SuKPTK-lA7Mpb8I4a_hSS{width:auto;font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._3ky8LdubzvCHUd3PtH6MxA{margin-top:5px;top:auto}.o365cs-base ._3jnSLos3ny_7jVQziflVjD{margin-top:20px}.o365cs-base .-LP1776BQbI7DCPaj3Zj9 a{min-height:64px;position:relative;text-decoration:none}.o365cs-base ._2k9KA_LfNQnpQvN6xSQnK3{font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;height:19px;padding:6px 0;min-height:34px}.o365cs-base ._2k9KA_LfNQnpQvN6xSQnK3 div,.o365cs-base ._2k9KA_LfNQnpQvN6xSQnK3 span{display:table-cell;vertical-align:top}.o365cs-base ._33RxKz5Sa_VpVgn3IMpN0w{font-size:24px;padding:0 16px 0 6px;margin-top:-2px}.o365cs-base ._1A0-4X2hHwZG1fkR5ohCN0{width:155px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;padding-top:0;margin-top:-2px}',""]),t.locals={mailText:"_3QSRf0Z93asQsSUg8FNBJp",sender:"_1AYkzLSDWmZouFLr0HB8-",mailSubject:"_2eiL0wdb_5Blsqn3ZR2mzB",mailIcon:"_3qy97OoIIEk4KqTZdg6s4i",bodyPreviewText:"_1RYzmMt6ppE0VFFHhHtAgV",newMailPopupButton:"_2Hze4lFFggjvHTZH9AoOGw",newMailPopupButtonCell:"Wm8RnXkb3nsnJjkDSBvK3",itemContent:"_2SuKPTK-lA7Mpb8I4a_hSS",newMailPersonaImage:"_3ky8LdubzvCHUd3PtH6MxA",newFlexPaneNewMailNotification:"_3jnSLos3ny_7jVQziflVjD",newMailLink:"-LP1776BQbI7DCPaj3Zj9",condensed:"_2k9KA_LfNQnpQvN6xSQnK3",condensedIcon:"_33RxKz5Sa_VpVgn3IMpN0w",condensedMailText:"_1A0-4X2hHwZG1fkR5ohCN0"}},538:function(e,t,i){var n=i(539);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},539:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,'.o365cs-base ._2QFBe6B-zL4GwcV2U3SSWT{border-left:0;border-right:0;max-height:none;height:auto!important;display:block;text-align:left;min-height:auto;padding:12px 14px 0;cursor:pointer;text-decoration:none!important;white-space:normal;font:12px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._3LTUxKW1yr2Ko9a1pwWeBc{margin:6px 18px 0 6px;font-size:24px}.o365cs-base .xSu2ns8faHX05BEgLhx8l{margin:3px 8px 0 0;font-size:14px}.o365cs-base ._1hpV45cv9srE3A7FL90Xc7{display:block;font-size:14px}.o365cs-base ._1tQw3EgQwtINGQ5w-kPWog{padding-right:0;padding-top:2px;display:block;box-sizing:content-box;white-space:normal}.o365cs-base ._1tQw3EgQwtINGQ5w-kPWog span{font:12px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .pWn3LUqY_omNAp9lw86HV{box-sizing:content-box;white-space:normal;font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._3e_2JI9fjrvz6CpqB3stj_{padding-right:5px;padding-bottom:24px;font-size:11px;box-sizing:content-box;white-space:normal}.o365cs-base ._1oDhqmBUHVyQ0b_aM1AM01{margin-top:-9px}',""]),t.locals={container:"_2QFBe6B-zL4GwcV2U3SSWT",alertIcon:"_3LTUxKW1yr2Ko9a1pwWeBc",alertPaneIcon:"xSu2ns8faHX05BEgLhx8l",text:"_1hpV45cv9srE3A7FL90Xc7",message:"_1tQw3EgQwtINGQ5w-kPWog",title:"pWn3LUqY_omNAp9lw86HV",actionText:"_3e_2JI9fjrvz6CpqB3stj_",systemClose:"_1oDhqmBUHVyQ0b_aM1AM01"}},540:function(e,t,i){var n=i(541);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},541:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,'.o365cs-base ._3aZdQ4y9sEg1IEAqK4LPxO{position:relative;height:auto;padding:12px 14px;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;font:12px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;touch-action:pan-x pan-y pinch-zoom manipulation;-ms-touch-action:pan-x pan-y pinch-zoom manipulation}.o365cs-base ._3aZdQ4y9sEg1IEAqK4LPxO:first-child{border-top:none}.o365cs-base ._1ZBejb9Mvx_eY_Ad-sCsJJ{width:245px}.o365cs-base ._3c9XqcHM0O6jm43E8P7TMr{width:140px}.o365cs-base .udKasYTaOsA-BDzfTTeml,.o365cs-base ._3c9XqcHM0O6jm43E8P7TMr{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:inline-block;height:19px;text-align:left}.o365cs-base .udKasYTaOsA-BDzfTTeml{width:125px}.o365cs-base .udKasYTaOsA-BDzfTTeml span{line-height:19px;height:19px}.o365cs-base ._3U9g7HRnjKcNCiC338M42u{text-align:right;display:block;width:100%}.o365cs-base ._3xNJMQJFTkLm6r3GFnNxw7{display:inline-block;padding-right:1px}.o365cs-base ._3EzssVEKmCkjV33WzHSoNo{display:inline-block;line-height:19px;padding:0 3px}.o365cs-base .ej7fiicVoaCuXg3W1D-dl{height:50%;width:100%;display:block}.o365cs-base ._2XtdJhreEc4etBEHQMlTJF{max-width:210px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.o365cs-base ._2XtdJhreEc4etBEHQMlTJF div{font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;height:19px}.o365cs-base ._2SLsLk8jY3h-gpioGI1HhT{margin:1px 8px 0 0}.o365cs-base ._3TtpAss3u57rH8sPlxBM_I{min-width:0;position:absolute;right:36px;border-width:0;margin-top:-8px;padding-top:8px;background-color:transparent;cursor:pointer;z-index:999;width:32px;height:32px;line-height:12px;box-sizing:border-box}.o365cs-base ._3TtpAss3u57rH8sPlxBM_I span{font-size:14px}.o365cs-base ._3TtpAss3u57rH8sPlxBM_I:hover{text-decoration:none}.o365cs-base ._1iavEbI1lufGHXlKgo3hGK{margin:-8px 0 0;right:4px;padding-top:10px}',""]),t.locals={remindersContainer:"_3aZdQ4y9sEg1IEAqK4LPxO",remindersLeftColumn:"_1ZBejb9Mvx_eY_Ad-sCsJJ",remindersTitle:"_3c9XqcHM0O6jm43E8P7TMr",remindersRemain:"udKasYTaOsA-BDzfTTeml",remindersRightColumn:"_3U9g7HRnjKcNCiC338M42u",toastRemindersTimeToStartValue:"_3xNJMQJFTkLm6r3GFnNxw7",remindersTimeToStartUnit:"_3EzssVEKmCkjV33WzHSoNo",remindersRow:"ej7fiicVoaCuXg3W1D-dl",remindersDescription:"_2XtdJhreEc4etBEHQMlTJF",reminderIcon:"_2SLsLk8jY3h-gpioGI1HhT",alarmButton:"_3TtpAss3u57rH8sPlxBM_I",reminderCloseButton:"_1iavEbI1lufGHXlKgo3hGK"}},542:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,".o365cs-base ._34JlzlZEd3D400LKJTFOYT a:active,.o365cs-base ._34JlzlZEd3D400LKJTFOYT a:hover,.o365cs-base ._34JlzlZEd3D400LKJTFOYT a:link,.o365cs-base ._34JlzlZEd3D400LKJTFOYT a:visited{text-decoration:none}.o365cs-base ._34JlzlZEd3D400LKJTFOYT .systemNotification *{white-space:normal}.o365cs-base ._1hwxO2qLS69Zckg2AdGUT-{overflow:hidden;margin-bottom:10px;line-height:normal}.o365cs-base .VL_4jnTchz6vQXV4rFoDC{display:table;height:40px;box-sizing:content-box;margin:0;border-bottom-width:1px;border-bottom-style:solid}.o365cs-base ._249ZPfzQXectOzor0Yn1eH{display:inline-block;width:20px}.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU{-ms-flex:1;flex:1;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch;min-width:125px;max-height:230px}.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU::-webkit-scrollbar{width:6px}.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU::-webkit-scrollbar-button,.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU::-webkit-scrollbar-corner,.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU::-webkit-scrollbar-track{background-color:transparent}.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU::-webkit-scrollbar-button{background-repeat:no-repeat;cursor:pointer}.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU::-webkit-scrollbar-button:vertical{background-position:50%;width:18px;height:18px}.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU::-webkit-scrollbar-button:vertical:increment{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAUUlEQVQ4T6XLMQ6AMAwEwfz/bXRIfOeQCxckK8iKYgqvfCPJLxgNjAZGA6OB0VjCcV55M/8/jkbDMv+VJbSdccHYvsYFo4HRwGhgNDAaGPdl3LNlBnofQ4+bAAAAAElFTkSuQmCC)}.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU::-webkit-scrollbar-button:vertical:increment:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAUklEQVQ4T6XLsQ2AMAwF0ey/A1swAnt95MIFyQlyoniFT/4jyS8YDYwGRgOjgdFYwnFeeTP/P45GwzL/lSW0nXHB2L7GBaOB0cBoYDQwGhj3Zdx8sf7rjOGQqwAAAABJRU5ErkJggg==)}.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU::-webkit-scrollbar-button:vertical:decrement{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAVUlEQVQ4T6XMMQoAIQxEUe9/NrsFrzOSIqDxgzu7xSv8ZGySfsHowOjA6MDowOjAmPozFGpfYQw5vn2CsY5TvQtHoOGq3m+PLzA6MDowOjA6ML6nNgFW+wZ6kTk6FAAAAABJRU5ErkJggg==)}.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU::-webkit-scrollbar-button:vertical:decrement:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAVklEQVQ4T6XMwQ3AIAwEQfrvgS5SAn0d8sMSmJXIJY95sPLRJP2C0YHRgdGB0YHRgTH1ZyjUvsIYcnz7BGMdp3oXjkDDVb3fHl9gdGB0YHRgdGB8T20CB+X+675uLU0AAAAASUVORK5CYII=)}.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU::-webkit-scrollbar-thumb{border-radius:9px;border:none;background-color:#ccd3d6}.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU::-webkit-scrollbar-thumb:vertical{min-height:50px}.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU::-webkit-scrollbar-thumb:hover{background-color:#9db4c4}.o365cs-base ._3ZnSCH3EBrwZLxwi0k21oU:not(:-webkit-any-link){box-sizing:border-box}.o365cs-base ._21lrwLBxdNgYbrNTcPuW_h{padding-top:5px;padding-left:10px;text-align:left;height:25px;width:100%}.o365cs-base ._1YlYJ_zGqtBH5z6lyeZ6W{margin-top:10px}.o365cs-base ._1wa7_3g2Dt8v0HGlUj-Dri{display:table-cell}.o365cs-base ._3B0CjFhQ3OhqX9uEihv6MK{border-bottom-width:1px;border-bottom-style:solid}.o365cs-base .PeboNxLkiq5d6wIlfRNW{position:relative;right:5px;margin:0;padding-top:5px}",""]),t.locals={o365cs:"_34JlzlZEd3D400LKJTFOYT",toastSlot:"_1hwxO2qLS69Zckg2AdGUT-",header:"VL_4jnTchz6vQXV4rFoDC",chevronDiv:"_249ZPfzQXectOzor0Yn1eH",toastScrollRegion:"_3ZnSCH3EBrwZLxwi0k21oU",footer:"_21lrwLBxdNgYbrNTcPuW_h",notificationsContent:"_1YlYJ_zGqtBH5z6lyeZ6W",label:"_1wa7_3g2Dt8v0HGlUj-Dri",reminderBox:"_3B0CjFhQ3OhqX9uEihv6MK",headerCloseButton:"PeboNxLkiq5d6wIlfRNW"}},543:function(e,t,i){var n=i(544);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},544:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,'.LIawkGIQntQC1h9xy51hG{width:170px;height:335px;display:block;position:fixed;overflow:hidden;box-sizing:border-box;z-index:1000101}.o365cs-base ._1-cDkFmrx0b6FIwCyL8E2L{width:190px;padding:7px 0 0 18px;line-height:0;height:35px;font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-weight:400;position:relative}',""]),t.locals={dropDrown:"LIawkGIQntQC1h9xy51hG",snoozeContextMenuItem:"_1-cDkFmrx0b6FIwCyL8E2L"}},545:function(e,t,i){var n=i(546);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},546:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,'.o365cs-base ._1ikmr0PpPMghhXWaG_F1_9{font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;min-height:34px}.o365cs-base ._1ikmr0PpPMghhXWaG_F1_9 div,.o365cs-base ._1ikmr0PpPMghhXWaG_F1_9 span{display:table-cell}.o365cs-base ._GIGLvoxVqcahuc-6OLX{font-size:24px;padding:6px 16px 0 6px}.o365cs-base ._2ZcjGWhcQ6Fmgh7wq0OhbI{width:180px;text-overflow:ellipsis;overflow:hidden;vertical-align:middle}.o365cs-base ._1cDeE4GBjO23QZ7qPYrZIL{text-align:left;overflow:hidden;padding:14px;margin:0;cursor:pointer;display:block;height:auto;box-sizing:border-box}.o365cs-base ._2XwYIarS4MShtReMcoJHyx{width:auto;font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._1o7XVu4PZuxporNXOzVFht{margin-top:5px;top:auto}.o365cs-base ._3Ee0jG9HWGr1XWeknfNMfE{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.o365cs-base .Fj-wa6ckwoQIRYSlUMchD{padding-left:10px;max-width:198px;width:198px;font-size:14px}.o365cs-base ._37_8TFL_q1J3X_NsR9d83O{font-size:14px;padding:0 8px 0 10px;display:table-cell;line-height:15px;vertical-align:bottom}.o365cs-base ._3Ue2JEXx7WSxdx8Ce6amT8{max-width:180px;width:180px;font-size:14px;padding-top:2px;display:table-cell;vertical-align:bottom}',""]),t.locals={condensed:"_1ikmr0PpPMghhXWaG_F1_9",condensedIcon:"_GIGLvoxVqcahuc-6OLX",condensedText:"_2ZcjGWhcQ6Fmgh7wq0OhbI",toastContent:"_1cDeE4GBjO23QZ7qPYrZIL",chatContent:"_2XwYIarS4MShtReMcoJHyx",PersonaImage:"_1o7XVu4PZuxporNXOzVFht",chatText:"_3Ee0jG9HWGr1XWeknfNMfE",chatTitle:"Fj-wa6ckwoQIRYSlUMchD",chatIcon:"_37_8TFL_q1J3X_NsR9d83O",chatPreview:"_3Ue2JEXx7WSxdx8Ce6amT8"}},547:function(e,t,i){var n=i(548);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},548:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,".gHOeSZuAX3PGA1RB_C2ju{position:absolute;z-index:1000000;background-color:#fff;width:320px;box-sizing:border-box;outline:none;overflow-y:auto;visibility:visible;pointer-events:auto;background:transparent;min-width:320px;max-width:320px;width:324px;height:auto;outline:0;display:block;overflow-y:hidden;z-index:1000100;box-shadow:none}.gHOeSZuAX3PGA1RB_C2ju:focus{box-shadow:none!important}.o365cs-base ._2e6Jr4XQ3rylcOpRs_4y3I{margin:12px 16px 16px}.o365cs-base ._2nkuYrBmjuEb0aEicHImDY{min-height:800px}",""]),t.locals={popupControl:"gHOeSZuAX3PGA1RB_C2ju",toastContainer:"_2e6Jr4XQ3rylcOpRs_4y3I",toastContainerHeight:"_2nkuYrBmjuEb0aEicHImDY"}},549:function(e,t,i){var n=i(550);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},550:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,".o365cs-base ._2x23JK3_gg78UWeh_33NJm{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;max-width:260px;line-height:19px;padding-top:2px}.o365cs-base ._2AUJy6HZLgUsK1c5h1HluO{text-align:left;overflow:hidden;padding:12px 14px 0;cursor:pointer;display:block;min-height:96px;height:100%}.o365cs-base ._1Ybf6gC-P2-JRMbAcvc412{vertical-align:middle;font-size:14px}",""]),t.locals={notificationText:"_2x23JK3_gg78UWeh_33NJm",newAppPopupButton:"_2AUJy6HZLgUsK1c5h1HluO",newAppPopupButtonCell:"_1Ybf6gC-P2-JRMbAcvc412"}},551:function(e,t,i){var n=i(552);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},552:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,'.o365cs-base ._38RjNmsY7Fwfr3oJiGlvjY{display:flex;flex-direction:column;height:100%}.o365cs-base ._2MFEmDEoL5UDzJ8w6wQUqz{margin-left:-16px;margin-right:-16px;text-overflow:ellipsis}.o365cs-base ._2MFEmDEoL5UDzJ8w6wQUqz a,.o365cs-base ._2MFEmDEoL5UDzJ8w6wQUqz button{font:600 12px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .pv_X9iOaZmT7vhTuHet6H{flex:1;position:relative;display:inline-block;margin-left:16px;margin-bottom:12px}.o365cs-base ._3WtRJJeQiTBsMytsr4czjc{font:600 12px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;position:absolute;bottom:0;cursor:pointer}.o365cs-base ._3WtRJJeQiTBsMytsr4czjc:hover{text-decoration:underline}.o365cs-base ._2bb-j-ezAEPvcrES3gd1zO{margin:0 16px}.o365cs-base ._1G9lOnlxj-MlHlwkhBdSZB{font-size:medium;margin-top:36px}.o365cs-base ._2Pav6WUnlm57VjKGvtv-dO{text-overflow:ellipsis;border-width:0;margin:18px 0}.o365cs-base ._3zPugrijYm-Me7bVVPdgzT{width:auto;line-height:21px;font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-size:14px;white-space:normal;padding-bottom:8pt;padding-left:16px}.o365cs-base ._3BTJEej7Os9gRgqNSe3nBC{font:600 16px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;margin-left:16px}.o365cs-base ._1Q75rlCnLjM9ZxeuUAnX5r{padding-left:2px}.o365cs-base ._3bW-Wrr3L2f9MvMmmieQb3{text-align:center;display:block;padding-top:16px;font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._3bW-Wrr3L2f9MvMmmieQb3 span{padding-bottom:6px;display:block}.o365cs-base ._1aLv09BJClMHPqtr2gxYOt{display:inline-block;margin-bottom:30px;width:85px;height:85px;background:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxjaXJjbGUgaWQ9ImEiIGN4PSI0NC41NTciIGN5PSI0NC41NTciIHI9IjMuMDM4Ii8+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01LjA2MyAtNS4wNjMpIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDc2IDcuMDg5KSI+PHBhdGggZD0iTTM5Ljk5MSAwQzE5LjA0NCAwIDIuMDI1IDE3LjAyIDIuMDI1IDM3Ljk3YzAgMjAuOTQyIDE3LjAyIDM3Ljk4IDM3Ljk2NiAzNy45OCAyMC45NDggMCAzNy45ODQtMTcuMDM4IDM3Ljk4NC0zNy45OEM3Ny45NzUgMTcuMDIgNjAuOTM5IDAgMzkuOTkgMG0wIDY1LjIxOWMtMTcuMDE5IDAtMzAuODI0LTEzLjc5LTMwLjgyNC0zMC44MjFDOS4xNjcgMTcuMzYgMjIuOTcyIDMuNTcgMzkuOTkxIDMuNTdjMTcuMDM3IDAgMzAuODI1IDEzLjc5IDMwLjgyNSAzMC44MjcgMCAxNy4wMzItMTMuNzg4IDMwLjgyLTMwLjgyNSAzMC44MiIgZmlsbD0iI0E2QTZBNiIvPjxjaXJjbGUgZmlsbD0iI0ZGRiIgY3g9IjM3LjQ2OCIgY3k9IjM2LjQ1NiIgcj0iMzMuNDE4Ii8+PGNpcmNsZSBmaWxsPSIjRkZGIiBjeD0iMzMuNDE4IiBjeT0iMzYuNDU2IiByPSIzMy40MTgiLz48cGF0aCBkPSJNMTUuMTkgMTMuNzA2YzUuODA3LTUuMzU2IDEzLjY1OC04LjY0MyAyMi4zLTguNjQzIDE3Ljg4NSAwIDMyLjM4MyAxNC4wNzYgMzIuMzgzIDMxLjQ0IDAgOC42ODItMy42MjQgMTYuNTQyLTkuNDg0IDIyLjIzMSIgZmlsbD0iI0Y4RjhGOCIvPjwvZz48cmVjdCBzdHJva2U9IiM5Nzk3OTciIHRyYW5zZm9ybT0icm90YXRlKC0yMSA0MC44NzMgMzQuMTM1KSIgeD0iNDAuMzY3IiB5PSIyMy40NTEiIHdpZHRoPSIxIiBoZWlnaHQ9IjIxLjM2NyIgcng9Ii41Ii8+PHJlY3Qgc3Ryb2tlPSIjOTc5Nzk3IiB0cmFuc2Zvcm09InJvdGF0ZSg5MCA1Mi40NjYgNDQuMTA2KSIgeD0iNTEuOTU5IiB5PSIzNS45NTQiIHdpZHRoPSIxIiBoZWlnaHQ9IjE2LjMwNCIgcng9Ii41Ii8+PGcgc3Ryb2tlPSIjOTc5Nzk3Ij48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMi4xNTIgMTIuMTUyKSI+PHJlY3QgdHJhbnNmb3JtPSJtYXRyaXgoLTEgMCAwIDEgNjMuNzk3IDApIiB4PSIzMS44OTIiIHk9Ii41IiB3aWR0aD0iMSIgaGVpZ2h0PSI2LjA4OSIgcng9Ii41Ii8+PHJlY3QgdHJhbnNmb3JtPSJtYXRyaXgoLTEgMCAwIDEgNjMuNzk3IDApIiB4PSIzMS44OTIiIHk9IjU3LjIwOSIgd2lkdGg9IjEiIGhlaWdodD0iNi4wODkiIHJ4PSIuNSIvPjxnIHRyYW5zZm9ybT0icm90YXRlKDkwIDE2LjIwMyA0Ny41OTUpIj48cmVjdCB0cmFuc2Zvcm09Im1hdHJpeCgtMSAwIDAgMSAxLjAxMyAwKSIgeD0iLjUiIHk9Ii41IiB3aWR0aD0iMSIgaGVpZ2h0PSI2LjA4OSIgcng9Ii41Ii8+PHJlY3QgdHJhbnNmb3JtPSJtYXRyaXgoLTEgMCAwIDEgMS4wMTMgMCkiIHg9Ii41IiB5PSI1Ny4yMDkiIHdpZHRoPSIxIiBoZWlnaHQ9IjYuMDg5IiByeD0iLjUiLz48L2c+PC9nPjxnIHRyYW5zZm9ybT0icm90YXRlKC0zMCA2MC42NSAxNS4yOTkpIj48cmVjdCB0cmFuc2Zvcm09Im1hdHJpeCgtMSAwIDAgMSA2My43OTcgMCkiIHg9IjMxLjg5MiIgeT0iLjUiIHdpZHRoPSIxIiBoZWlnaHQ9IjYuMDg5IiByeD0iLjUiLz48cmVjdCB0cmFuc2Zvcm09Im1hdHJpeCgtMSAwIDAgMSA2My43OTcgMCkiIHg9IjMxLjg5MiIgeT0iNTcuMjA5IiB3aWR0aD0iMSIgaGVpZ2h0PSI2LjA4OSIgcng9Ii41Ii8+PGcgdHJhbnNmb3JtPSJyb3RhdGUoOTAgMTYuMjAzIDQ3LjU5NSkiPjxyZWN0IHRyYW5zZm9ybT0ibWF0cml4KC0xIDAgMCAxIDEuMDEzIDApIiB4PSIuNSIgeT0iLjUiIHdpZHRoPSIxIiBoZWlnaHQ9IjYuMDg5IiByeD0iLjUiLz48cmVjdCB0cmFuc2Zvcm09Im1hdHJpeCgtMSAwIDAgMSAxLjAxMyAwKSIgeD0iLjUiIHk9IjU3LjIwOSIgd2lkdGg9IjEiIGhlaWdodD0iNi4wODkiIHJ4PSIuNSIvPjwvZz48L2c+PGcgdHJhbnNmb3JtPSJyb3RhdGUoLTYwIDQ4LjQ5OSAyNy40NSkiPjxyZWN0IHRyYW5zZm9ybT0ibWF0cml4KC0xIDAgMCAxIDYzLjc5NyAwKSIgeD0iMzEuODkyIiB5PSIuNSIgd2lkdGg9IjEiIGhlaWdodD0iNi4wODkiIHJ4PSIuNSIvPjxyZWN0IHRyYW5zZm9ybT0ibWF0cml4KC0xIDAgMCAxIDYzLjc5NyAwKSIgeD0iMzEuODkyIiB5PSI1Ny4yMDkiIHdpZHRoPSIxIiBoZWlnaHQ9IjYuMDg5IiByeD0iLjUiLz48ZyB0cmFuc2Zvcm09InJvdGF0ZSg5MCAxNi4yMDMgNDcuNTk1KSI+PHJlY3QgdHJhbnNmb3JtPSJtYXRyaXgoLTEgMCAwIDEgMS4wMTMgMCkiIHg9Ii41IiB5PSIuNSIgd2lkdGg9IjEiIGhlaWdodD0iNi4wODkiIHJ4PSIuNSIvPjxyZWN0IHRyYW5zZm9ybT0ibWF0cml4KC0xIDAgMCAxIDEuMDEzIDApIiB4PSIuNSIgeT0iNTcuMjA5IiB3aWR0aD0iMSIgaGVpZ2h0PSI2LjA4OSIgcng9Ii41Ii8+PC9nPjwvZz48L2c+PHBhdGggZD0iTTQ0LjA0MiA2LjA3NmMtMjAuOTQ3IDAtMzcuOTY2IDE3LjAzNC0zNy45NjYgMzcuOTc4IDAgMjAuOTM4IDE3LjAxOSAzNy45NzEgMzcuOTY2IDM3Ljk3MSAyMC45NDcgMCAzNy45ODMtMTcuMDMzIDM3Ljk4My0zNy45NzEgMC0yMC45NDQtMTcuMDM2LTM3Ljk3OC0zNy45ODMtMzcuOTc4bTAgNjguNzkyYy0xNy4wMiAwLTMwLjgyNC0xMy43ODYtMzAuODI0LTMwLjgxNCAwLTE3LjAzNCAxMy44MDUtMzAuODIgMzAuODI0LTMwLjgyIDE3LjAzNyAwIDMwLjgyNCAxMy43ODYgMzAuODI0IDMwLjgyIDAgMTcuMDI4LTEzLjc4NyAzMC44MTQtMzAuODI0IDMwLjgxNCIgZmlsbD0iI0M4QzhDOCIvPjx1c2UgZmlsbD0iI0E2QTZBNiIgeGxpbms6aHJlZj0iI2EiLz48Y2lyY2xlIHN0cm9rZT0iI0E2QTZBNiIgY3g9IjQ0LjU1NyIgY3k9IjQ0LjU1NyIgcj0iMi41MzgiLz48cmVjdCBzdHJva2U9IiM3RjdGN0YiIHRyYW5zZm9ybT0icm90YXRlKC0xMzEgMzUuOTUgNTEuNjQ2KSIgeD0iMzUuOTQzIiB5PSIzNS45NDMiIHdpZHRoPSIxIiBoZWlnaHQ9IjMxLjQwNSIgcng9Ii41Ii8+PC9nPjwvc3ZnPg==");background-repeat:no-repeat;background-size:cover}',""]),t.locals={mainContainer:"_38RjNmsY7Fwfr3oJiGlvjY",container:"_2MFEmDEoL5UDzJ8w6wQUqz",customizeLinkContainer:"pv_X9iOaZmT7vhTuHet6H",customizeSettingsLink:"_3WtRJJeQiTBsMytsr4czjc",settingsContainer:"_2bb-j-ezAEPvcrES3gd1zO",notificationTitle:"_1G9lOnlxj-MlHlwkhBdSZB",section:"_2Pav6WUnlm57VjKGvtv-dO",notificationsMessage:"_3zPugrijYm-Me7bVVPdgzT",notificationsDisabled:"_3BTJEej7Os9gRgqNSe3nBC",countLabel:"_1Q75rlCnLjM9ZxeuUAnX5r",emptyState:"_3bW-Wrr3L2f9MvMmmieQb3",imgEmptyState:"_1aLv09BJClMHPqtr2gxYOt"}},553:function(e,t,i){var n=i(554);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},554:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,'.o365cs-base ._2e1Nb05SSaoOLYsNgNyvkr{display:inline-block;font-size:19px;vertical-align:middle}.o365cs-base ._3EXbI6-RQXkRBx3ChCTan3{color:inherit}.o365cs-base ._1-i71S3yABrA-lsgPfeufs{position:absolute;bottom:43px;left:22px}.o365cs-base ._2npTQvXU4TaQYgOCgJta0_{font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-size:10px;position:absolute;width:18px;height:18px;line-height:16px!important;border-radius:.8em;box-sizing:border-box}.o365cs-base ._2ry35HjlMHxQyPiZBm_dHW{border:1px solid}.o365cs-base ._3VIcV_t4AxoY2iIpCgtqYN{width:26px!important}',""]),t.locals={icon:"_2e1Nb05SSaoOLYsNgNyvkr",button:"_3EXbI6-RQXkRBx3ChCTan3",unseenitems:"_1-i71S3yABrA-lsgPfeufs",unseenCount:"_2npTQvXU4TaQYgOCgJta0_",unseenCountBorder:"_2ry35HjlMHxQyPiZBm_dHW",unseenCountOval:"_3VIcV_t4AxoY2iIpCgtqYN"}},575:function(e,t,i){var n=i(576);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},576:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,"._2hea-t0AOC_WUB9Z4pwXEU{bottom:0;right:0;padding-right:20px;position:absolute;display:flex;z-index:1000001;align-items:flex-end;max-width:calc(100% - 320px);-webkit-box-align:end}._2hea-t0AOC_WUB9Z4pwXEU .conversation{display:initial}._2hea-t0AOC_WUB9Z4pwXEU iframe{margin-right:10px}",""]),t.locals={wrapperStyle:"_2hea-t0AOC_WUB9Z4pwXEU"}},577:function(e,t,i){var n=i(578);"string"==typeof n&&(n=[[e.i,n,""]]);i(23)(n,{});n.locals&&(e.exports=n.locals)},578:function(e,t,i){(t=e.exports=i(22)(!1)).push([e.i,"._3ZzcWNupDp9AEba2exblKu{position:absolute;z-index:1000000;background-color:#fff;width:320px;box-sizing:border-box;outline:none;overflow-y:auto;visibility:visible;pointer-events:auto;box-shadow:0 2px 4px 0 rgba(0,0,0,.22);overflow-y:hidden;min-width:320px;max-width:320px;top:50px;height:450px;outline:0;display:block;visibility:hidden;z-index:1000001;-webkit-transform-origin:top;-ms-transform-origin:top;transform-origin:top;-webkit-animation-duration:.18s;animation-duration:.18s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-timing-function:ease;animation-timing-function:ease}._21mJn7WyVRXuNo88VnTGOG{-webkit-animation-name:slideInFrames;animation-name:slideInFrames;visibility:visible}@-webkit-keyframes slideInFrames{0%{opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@keyframes slideInFrames{0%{opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}._2mCAzNjus9SQPe-2FCg_VN{box-shadow:0 2px 4px 0 rgba(0,0,0,.22);overflow-y:hidden}.qoFEtglZRx1nGO-Gc9_BP{height:450px;width:320px}",""]),t.locals={chatWindowWidth:"320",chatPopup:"_3ZzcWNupDp9AEba2exblKu",popupSlideIn:"_21mJn7WyVRXuNo88VnTGOG",callout:"_2mCAzNjus9SQPe-2FCg_VN",recentsWrapper:"qoFEtglZRx1nGO-Gc9_BP"}},652:function(e,t,i){"use strict";i.r(t);var n=i(12),o=i(3),a=i(33),s=i(293),r=i(0),c=i(2),l=i(137),d=i(1),p=i(17),u=i(183),f=i(193),m=i(9),h=i(51),b=i(575);var g,S,I,y,A,v=function(){var e=Object(m.b)(Object(o.y)(h.a.ChatWrapper,b.wrapperStyle),"chat_wrapper_pane");return document.body.appendChild(e),e},N=i(10),x=i(5),O=i(73),C=i(577),T=function(e){function t(t){var i=e.call(this,t)||this;return i.populateRecentsContent=function(e){e&&(i.props.isChatRecentsPaneInitialized?Object(O.g)(e,i.props.isTeamsChatActivated):i.initializeRecents(e))},i.initializeRecents=function(e){i.props.isChatAPIInitialized?Object(O.a)(e,i.props.onRecentsReady,i.props.isTeamsChatActivated):window.addEventListener(h.b.ChatAPIReady,(function(){i.onChatAPIReady(e)}))},i.onChatAPIReady=function(e){window.removeEventListener(h.b.ChatAPIReady,(function(){i.onChatAPIReady(e)})),Object(O.a)(e,i.props.onRecentsReady,i.props.isTeamsChatActivated)},i.onAnimationEnd=function(){i.chatPopUp&&i.chatPopUp.focus()},i.handleKeydown=function(e){switch(e.keyCode){case 27:e.stopPropagation(),e.preventDefault(),i.props.onDismiss(e),i.chatHeaderButton.focus()}},i.state={popupPosition:null},i}return Object(r.__extends)(t,e),t.prototype.calculatePopupPosition=function(){var e,t=parseInt(C.chatWindowWidth),i=this.chatHeaderButton&&this.chatHeaderButton.getBoundingClientRect();if(i&&0!==i.x||(this.chatHeaderButton=document.getElementById(p.a),i=this.chatHeaderButton&&this.chatHeaderButton.getBoundingClientRect()),i&&i.x>0){var n=i.left+.5*i.width-t/2;e=n+t>this.chatHeaderButton.offsetParent.clientWidth+this.chatHeaderButton.offsetWidth?{right:10}:n<0?{left:10}:{left:n}}else e=this.props.isRtl?{left:10}:{right:10};this.props.isThinHeader&&(e=Object(r.__assign)(Object(r.__assign)({},e),{top:this.props.isThinHeader?48:50})),this.setState({popupPosition:e})},t.prototype.render=function(){var e,t=Object(N.a)();return c.createElement(o.i,{onDismiss:this.props.onDismiss,ariaLabel:x.a.ChatOpened,role:"region",className:Object(o.y)(C.chatPopup,(e={},e[C.popupSlideIn]=this.props.isChatRecentsPaneOpen,e)),popupPosition:this.state.popupPosition,id:"chat_popup",onAnimationEnd:this.onAnimationEnd,isVisible:this.props.isChatRecentsPaneOpen,isPersistant:!0},c.createElement("div",{"data-style":"o365shell",className:Object(o.y)(h.a.ChatRecents,C.recentsWrapper,t.neutral.lighterAlt.background),ref:this.populateRecentsContent,id:"chat_recent_pane"}))},t.prototype.componentDidUpdate=function(e){!e.isChatRecentsPaneOpen&&this.props.isChatRecentsPaneOpen&&this.calculatePopupPosition()},t.prototype.componentDidMount=function(){window.addEventListener(o.f.RESIZE,this.props.onDismiss),window.addEventListener(o.f.SCROLL,this.props.onDismiss),this.chatPopUp||(this.chatPopUp=document.getElementById("chat_popup"),this.chatPopUp.addEventListener(o.f.KEYDOWN,this.handleKeydown))},t.prototype.componentWillUnmount=function(){window.removeEventListener(o.f.RESIZE,this.props.onDismiss),window.removeEventListener(o.f.SCROLL,this.props.onDismiss),this.chatPopUp.removeEventListener(o.f.KEYDOWN,this.handleKeydown)},t}(c.Component),w=i(121),E=Object(n.b)((function(e){return{isChatAPIInitialized:e.chatState.isChatAPIInitialized,isChatRecentsPaneInitialized:e.chatState.isChatRecentsPaneInitialized,isChatRecentsPaneOpen:e.chatState.isChatRecentsPaneOpen,isThinHeader:Object(d.f)().isThinHeader,isTeamsChatActivated:e.chatState.isTeamsChatActivated,isRtl:e.userState&&e.userState.isRtl}}),(function(e){return{onRecentsReady:function(){e(Object(w.b)(!0))},onDismiss:function(t){var i=document.getElementById(p.a);t instanceof MouseEvent&&t.target&&i&&i.contains(t.target)||e(Object(w.c)(!1))}}}))(T),j=i(192),_=document.getElementById(p.b),D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.myPresenceStatusUpdate=function(e){if(t.props.userPresenceStatusItems){var i=Object(l.b)(e,t.props.userPresenceStatusItems);t.props.userPresenceStatusUpdate(i)}t.presenceStatusKey=e},t.onPresenceStatusChanged=function(e){var i=t.props.presenceStatus,n=Object(l.b)(e,t.props.userPresenceStatusItems);Object(O.j)(n,(function(){Object(d.e)().exception("Chat API setUserPresenceStatus failed",6,null),t.props.userPresenceStatusUpdate(i)}))},t.onChatClickHandler=function(e){var i=e instanceof MouseEvent;if(e instanceof KeyboardEvent)switch(e.which){case 40:i=e.altKey;break;case 13:case 32:e.preventDefault(),i=!0}i&&t.chatClicked(e)},t.onNotificationReceived=function(e){var i=e;if(i){var n=t.props.chatNotificationsEnabled&&(i.type===u.a.message||i.type===u.a.summary);if(t.props.callingNotificationsEnabled&&i.type===u.a.call||n){var o={type:i.type,title:i.title,description:i.description,actionLink:i.actions.length>0?i.actions[0]:null,cancelLink:i.actions.length>1?i.actions[1]:null,image:i.avatarUrl,sender:i.sender,id:i.id},a={providerType:u.b.ChatNotification,subType:i.type,payload:o,toastType:i.type===u.a.call?1:0,toastState:0};t.props.onNotificationReceived(a),Object(d.e)().impression(i.type,"Chat")}}},t.onStartChat=function(){t.props.onRecentsOpen(!1,p.a),Object(d.e)().impression("ChatWindowOpened","Chat")},t.onChatNotificationSettingsUpdated=function(e){var i=e;if(i){var n=Object(O.e)(i.value);switch(i.name){case h.e.NewMessage:t.updateChatSettings(n);break;case h.e.IncomingCall:t.updateCallSettings(n)}}},t}return Object(r.__extends)(t,e),t.prototype.render=function(){return this.props.chatEnabled&&this.props.isChatAPIInitialized?c.createElement(E,null):null},t.prototype.componentDidMount=function(){this.props.chatEnabled&&!this.props.isChatAPIInitialized&&this.beginChatInitialization()},t.prototype.componentDidUpdate=function(){this.props.chatEnabled&&!this.props.isChatAPIInitialized&&this.beginChatInitialization()},t.prototype.beginChatInitialization=function(){var e=this;this.props.isConsumerShell?(g=function(){e.onChatCoreReady()},window.addEventListener(h.b.ChatCoreReady,g),S=function(){e.onChatAPIReady()},window.addEventListener(h.b.ChatAPIReady,S),this.appendChatAPIDownloadScript()):(I=function(){e.props.onTeamsChatActivated(!0),e.onChatCoreReady(),window.removeEventListener(j.b.TeamsChatAPIReady,I)},window.addEventListener(j.b.TeamsChatAPIReady,I),this.appendTeamsChatDownloadScript())},t.prototype.onChatCoreReady=function(){var e=this,t=this.getInitParams();!this.props.isTeamsChatActivated&&swc&&t?(window.removeEventListener(h.b.ChatCoreReady,g),swc.init(null,t).catch((function(t){window.removeEventListener(h.b.ChatAPIReady,S),e.handleAPIInitializationError(t)}))):TeamsClient?TeamsClient.SDK.create({chatsParentElement:v(),hostCtx:this.props.workloadId}).then((function(t){TeamsClient.client=t,t.notifications.get().then((function(t){t.subscribe((function(t){t.type===j.a.UnreadCounterUpdate&&e.props.onUnreadConversationUpdate(t.data)}))})),e.onChatAPIInitialized(!0)})).catch((function(t){e.handleAPIInitializationError(t)})):(window.removeEventListener(h.b.ChatAPIReady,S),this.handleAPIInitializationError())},t.prototype.onChatAPIReady=function(){window.removeEventListener(h.b.ChatAPIReady,S),this.initializeChat()},t.prototype.initializeChat=function(){var e=this;try{this.props.disableToasts||(swc.API.registerEvent(h.b.ApiReceivedNotification,this.onNotificationReceived),swc.API.registerEvent(h.b.ApiHideNotification,this.props.onNotificationDismissed)),swc.API.registerEvent(h.b.ApiUnreadConversationUpdate,this.props.onUnreadConversationUpdate),swc.API.registerEvent(h.b.ApiStartChat,this.onStartChat),swc.API.registerEvent(h.b.ApiOnCallStart,(function(){Object(d.e)().impression("CallStart","Chat")})),swc.API.registerEvent(h.b.ApiOnRecentItemSelected,(function(){Object(d.e)().click("ChatRecentItem","Chat")})),swc.API.registerEvent(h.b.ApiRecentsShown,this.startChatLoadingTime),swc.API.registerEvent(h.b.ApiRecentItemsLoaded,this.logChatLoadingTime),swc.API.registerEvent(h.b.ApiSettingsChanged,this.onChatNotificationSettingsUpdated),swc.create(h.c.Messaging,O.f,v()),swc.getPresence().then((function(t){t.subscribeToMyStatus(e.myPresenceStatusUpdate),t.getStatusList().then((function(t){Object(o.hb)(t)?(e.props.onUserPresenceStatusListUpdate(t),e.presenceStatusKey&&(e.myPresenceStatusUpdate(e.presenceStatusKey),e.presenceStatusKey=void 0)):Object(d.e)().tag("Presence_API_getStatusList_Invalid",6)})).catch((function(e){Object(d.e)().exception("Presence_API_getStatusList_Failed",6,e)}))})).catch((function(e){Object(d.e)().exception("Presence_API_Initialization_Failed",6,e)})),swc.getKeyboard&&swc.getKeyboard().then((function(t){t.onKeyDown((function(t){"Escape"===t.key&&e.props.isChatRecentsPaneOpen&&e.dismissChatRecentsPane()}))})).catch((function(e){Object(d.e)().exception("get_keyboard_API_Failed",6,e)})),Object(d.e)().impression("Chat_Button","Chat",0,void 0,"successful"),this.onChatAPIInitialized(!0)}catch(e){this.handleAPIInitializationError(e)}},t.prototype.handleAPIInitializationError=function(e){Object(d.e)().exception("Chat_API_Initialization_Failed",6,e),this.onChatAPIInitialized(!1),this.props.responsiveEnabled||_&&this.props.isConsumerShell&&(_.style.display="block")},t.prototype.getInitParams=function(){return{toLoadUnreadConversationsCount:!0,locale:this.props.locale,correlationId:this.props.correlationId,loginHint:this.props.upn}},t.prototype.onChatAPIInitialized=function(e){var t=this;if(this.props.onChatAPIInitialized(e),e&&!this.props.responsiveEnabled){var i=document.getElementById(p.a);i&&(Object(o.T)(i,o.f.CLICK+" "+o.f.KEYDOWN,f.b),Object(o.t)(i,o.f.CLICK+" "+o.f.KEYDOWN,this.onChatClickHandler),_.style.display="block")}var n=Object(d.b)();n.subscribe("ThemeChanged",(function(){var e=Object(d.g)().state.isDarkMode?"dark":Object(d.g)().getCurrentThemeId();t.props.isTeamsChatActivated||swc.setTheme(e)}),!0),n.subscribe("PresenceStatusChanged",this.onPresenceStatusChanged,!1),this.updateNotificationSettings(),this.showCurrentPresence()},t.prototype.showCurrentPresence=function(){var e=this;!this.props.isTeamsChatActivated&&swc&&swc.getPresence().then((function(t){t.getMyStatus().then((function(t){t?e.myPresenceStatusUpdate(t):Object(d.e)().tag("Presence_API_getMyStatus_Undefined",6)})).catch((function(e){Object(d.e)().exception("Presence_API_getMyStatus_Failed",6,e)}))})).catch((function(e){Object(d.e)().exception("Presence_API_Initialization_Failed",6,e)}))},t.prototype.chatClicked=function(e){e.preventDefault(),Object(d.e)().click("ChatButton","Chat",null,null,"Chat recents list open "+!this.props.isChatRecentsPaneOpen),this.props.onRecentsOpen(!this.props.isChatRecentsPaneOpen,p.a)},t.prototype.dismissChatRecentsPane=function(){this.props.onRecentsOpen(!1,p.a);var e=document.getElementById(p.a);e&&e.focus()},t.prototype.appendChatAPIDownloadScript=function(){var e=this;y=function(){e.onChatAPIDownloadScriptFailed()};var t=document.createElement("script");t.type="text/javascript",t.setAttribute("data-style","o365shell"),t.setAttribute("data-disable-autostart","true"),t.setAttribute("data-platform-id",this.props.workloadId),t.setAttribute("data-auth-type",this.props.isConsumerShell?"msa":"aad"),t.src=this.props.chatSDKUrl,t.onerror=y,document.head.appendChild(t)},t.prototype.appendTeamsChatDownloadScript=function(){var e=document.createElement("script"),t=null;window.URLSearchParams&&(t=new URLSearchParams(window.location.search)),e.src=t&&t.has("teams-embed-sdk-url")?t.get("teams-embed-sdk-url"):"https://teams.microsoft.com/embed-client/loader.js",document.body.appendChild(e)},t.prototype.onChatAPIDownloadScriptFailed=function(){Object(d.e)().exception("Chat API download script failed",6,null),this.props.onChatAPIInitialized(!1),this.props.responsiveEnabled||this.props.isConsumerShell&&(_.style.display="block")},t.prototype.startChatLoadingTime=function(){A=Date.now()},t.prototype.logChatLoadingTime=function(){A&&(Object(d.e)().timer("Chat_FirstTimeChatListShown",Date.now()-A),swc.API.unregisterEvent(h.b.ApiRecentItemsLoaded,this.logChatLoadingTime),swc.API.unregisterEvent(h.b.ApiRecentsShown,this.startChatLoadingTime))},t.prototype.updateNotificationSettings=function(){var e=this;Object(O.d)().then((function(t){e.updateChatSettings(t)})).catch((function(){})),Object(O.c)().then((function(t){e.updateCallSettings(t)})).catch((function(){}))},t.prototype.updateChatSettings=function(e){var t=Object(r.__assign)(Object(r.__assign)({},this.props.notificationPreferences),{EnableChat:e.Enabled,EnableChatSound:e.SoundEnabled});this.props.onNotificationPreferencesUpdated(t)},t.prototype.updateCallSettings=function(e){var t=Object(r.__assign)(Object(r.__assign)({},this.props.notificationPreferences),{EnableCalling:e.Enabled,EnableCallingSound:e.SoundEnabled});this.props.onNotificationPreferencesUpdated(t)},t}(c.Component);i.d(t,"mapStateToProps",(function(){return P})),i.d(t,"ChatBaseControlConnector",(function(){return M}));var P=function(e){var t=e.shellInitDataState;return{disableToasts:t.renderSettings.disableToasts,locale:e.shellInitDataState.navBarData.CultureName,notificationsEnabled:e.shellInitDataState.clientData.NotificationsEnabled,isConsumerShell:e.shellInitDataState.clientData.IsConsumerShell,correlationId:e.shellInitDataState.clientData.SHSID,responsiveEnabled:null!=e.shellInitDataState.layout,chatEnabled:e.chatState.chatEnabled,chatSDKUrl:e.chatState.webChatSDKUrl,isChatAPIInitialized:e.chatState.isChatAPIInitialized,isChatRecentsPaneOpen:e.chatState.isChatRecentsPaneOpen,isTeamsChatActivated:e.chatState.isTeamsChatActivated,chatNotificationsEnabled:!(!e.notificationState||!e.notificationState.notificationPreferencesData)&&e.notificationState.notificationPreferencesData.EnableChat,callingNotificationsEnabled:!(!e.notificationState||!e.notificationState.notificationPreferencesData)&&e.notificationState.notificationPreferencesData.EnableCalling,workloadId:t.clientData.WorkloadId,presenceStatus:e.meControlState.userPresenceStatus,userPresenceStatusItems:e.meControlState.userPresenceStatusItems,notificationPreferences:e.notificationState&&e.notificationState.notificationPreferencesData||null,upn:e.userState&&e.userState.upn}},M=Object(n.b)(P,(function(e){return{onChatAPIInitialized:function(t){e(Object(w.a)(t))},onRecentsOpen:function(t,i){e(Object(w.c)(t)),e(Object(o.eb)(i))},onNotificationDismissed:function(t){e(Object(s.e)(t))},onNotificationReceived:function(t){e(Object(s.a)(t))},onUnreadConversationUpdate:function(t){e(Object(w.e)(t))},userPresenceStatusUpdate:function(t){e(Object(a.h)(t))},onUserPresenceStatusListUpdate:function(t){e(Object(a.i)(t))},onNotificationPreferencesUpdated:function(t){e(Object(o.gb)(t))},onTeamsChatActivated:function(t){e(Object(w.d)(t))}}}))(D)}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_notifications_end"),shellPerformance.measure("shell_notifications","shell_notifications_start","shell_notifications_end"));
//# sourceMappingURL=https://oneshellprcorp.blob.core.windows.net/oneshellpr/20200525.1/notifications.map