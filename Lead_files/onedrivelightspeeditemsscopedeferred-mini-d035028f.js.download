define("aO1",["require","exports","f","qd","KR","kw","bv","pw","pW","BU","nB","wQ","bv","gs","di","aO2","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";m=m.SocialBar_2;Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=n.useState(!0),i=t[0],c=t[1],h=function(){return c(!1)};return n.createElement(l.WithItemCache,null,function(t){var c,p=t.itemCache,y=p.demandItemFacet(o.analyticsItemFacet,e.itemKey),b=y&&y.itemKey,w=p.demandItemFacet(u.likeCountFacet,b);return n.createElement(f.Panel,{className:m.socialBarPanel,closeButtonAriaLabel:v.default.panelCloseAriaLabel,customWidth:"320px",isOpen:i,onDismiss:h,isBlocking:!0,isLightDismiss:!0,focusTrapZoneProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0},type:f.PanelType.custom,onDismissed:e.resolve,headerText:""+(c=Number(w),d.format(d.getLocalizedCountValue(v.default.panelLikesHeaderText,v.default.panelLikesHeaderTextInterval,c)||"",c))},(function(e){return n.createElement(l.WithItemCache,null,function(t){var i=t.itemCache,u=i.demandItemFacet(o.likedByItemFacet,e.itemKey),f=i.demandItemFacet(o.likedByPeopleFacet,u&&u.likedByItemKey),l=f&&f.personKeys;return n.createElement("div",{className:s.css(m.socialBarPanelContent)},l&&l.length>0&&(function(e){return n.createElement(r.FocusZone,{direction:r.FocusZoneDirection.vertical},n.createElement(a.List,{className:m.socialBarList,items:e&&e.map(function(e){return{key:e}}),onRenderCell:g}))})(l))})})(e))})};function g(e,t,r){return e&&n.createElement(l.WithItemCache,null,function(r){var s=r.itemCache,o=e&&e.key,u=s.demandItemFacet(c.userHoverCardControl,o),a=s.demandItemFacet(h.displayNameFacet,o),f=s.demandItemFacet(p.emailFacet,o),l=c.userHoverCardControl.evaluate(u)(s,{personKey:o}).userHoverCard,d=n.createElement(i.ActivityItem,{className:m.socialBarPanelPersona,activityPersonas:[{imageUrl:f,imageAlt:a}],activityDescription:n.createElement("div",{className:m.socialBarPanelPersonaDescription},a)});return l?n.createElement(l,{personKey:o,key:t},d):d})}});
define("aO3",["require","exports","mU","f","HN","nB","P","cm","C1","F2","i6","aO4","bv","Eo","i1","Es","bo"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=m.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["Jw"],t,n)})];case 1:return[2,t.sent().CheckInDialog]}})})}),y=l.implementOperationWithProgress({operationTypeFacet:i.updateCheckoutStateOperation,progressKeyFacet:i.checkoutProgressKeyFacet,initializeBatch:function(){return c.checkoutProgressAddon}});function b(e){var t=e.dispatch,n=e.itemKeys,i=e.itemSetKey;r.useEffect(function(){t(y({items:o.makeObject(n,function(){return{checkInOutType:"checkOut"}})})).then(function(){var e;i&&t(v.refreshItemsInSet({items:(e={},e[i]=o.makeObject(n,function(){return{}}),e)}))})},[]);return null}t.CheckOutItemExecutor=b;var w=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,i=t.reject,l=t.resolve,c=t.itemKeys,m=t.checkInOutType,w=t.enableMinorVersions,E=t.itemSetKey,S=function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){i(new u.CancelError);return[2]})})};return r.createElement(s.WithItemCache,null,function(t){var i,s=t.dispatch,u=t.itemCache;if(1===(c&&c.length)){var x=c[0],T=u.demandItemFacet(h.displayNameFacet,x),N=p.getVersion(u,{itemKey:x}),C=N.minor;i={major:N.major,minor:C,displayName:T,moderationStatusType:u.demandItemFacet(d.moderationStatusTypeFacet,x)}}var k=function(t){return n.__awaiter(e,void 0,void 0,function(){var e;return n.__generator(this,function(n){switch(n.label){case 0:l();e={checkInOutType:m,checkInText:t&&t.comment||"",checkInVersionType:t&&t.checkInVersionType};return[4,s(y({items:o.makeObject(c,function(){return e})})).then(function(){var e;E&&s(v.refreshItemsInSet({items:(e={},e[E]=o.makeObject(c,function(){return{}}),e)}))})];case 1:n.sent();return[2]}})})};return"undoCheckOut"===m?r.createElement(a.ConfirmationDialog,{onConfirm:k,onCancel:S,title:f.default.DiscardCheckoutTitle,prompt:f.default.DiscardCheckoutText}):"checkIn"===m?r.createElement(g,{onContinue:k,onCancel:S,itemCount:c&&c.length,itemInfo:i,enableMinorVersions:w}):"checkOut"===m?r.createElement(b,{dispatch:s,itemKeys:c,itemSetKey:E}):r.createElement(r.Fragment,null)})};return t})(r.PureComponent);t.CheckOutItemWizard=w});
define("aO4",["require","exports","mU","di","F2","HN","iX","e3","oC","i6","cu","ct"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h,p,d;Object.defineProperty(t,"__esModule",{value:!0});var v=((h={})[c.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkoutStartedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},h[c.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkoutCompletedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},h[c.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkoutFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},h[c.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkoutFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},h),m=((p={})[c.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.undoCheckoutStartedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},p[c.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.undoCheckoutCompletedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},p[c.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.undoCheckoutFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},p[c.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.undoCheckoutFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},p),g=((d={})[c.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkinStartedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},d[c.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkinCompletedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},d[c.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkinFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},d[c.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkinFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},d);t.checkoutProgressAddon=o.createAddon(function(){return function(e){e(u.registerControlHandler(s.checkoutProgressKeyFacet,a.progressControl)(u.createControlHandler()(y)))}});function y(){return function(e){return b}}function b(e,t){var r=t.itemKey,i=f.getOverallSimpleProgressBreakdown(e,t),o=i.phase,u=i.count,a=v,c=e.demandItemFacet(l.childItemsFacet,r),h=c&&c.itemKeys;if(h&&h.length>0){var p=e.demandItemFacet(s.updateCheckoutStateOperation,h[0]),d=p&&p.checkInOutType;"checkIn"===d?a=g:"undoCheckOut"===d&&(a=m)}var y=a[o](u);return n.__assign({},y&&"item"!==t.format?{title:y}:{})}});
define("aO5",["require","exports","mU","f","iU","i1","gH","f2","iT","cL","fa","ff","aO6","cy"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateListItemExecutor=f.createItemCacheComponent(function(e,t){var f,d=t.itemKey,v=t.contentTypeId,m=e.demandItemFacet(i.spItemKeyFacet,d),g="";if(m){var y=i.spListKeyFacet.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl}),b=e.demandItemFacet(s.listFormUrlsFacet,y);if(v){var w=i.spListContentTypeKeyFacet.serialize({listKey:{webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl},contentTypeId:v}),E=e.demandItemFacet(s.spListContentTypeFacet,w);if(E&&E.templateUrl){var S=new a.ItemUrlHelperBasic({context:{webAbsoluteUrl:m.webAbsoluteUrl,listUrl:m.listFullUrl}}).getUrlParts({path:E.templateUrl});S.fullItemUrl&&(g=S.fullItemUrl)}}g||(g=b&&b.newFormUrl||"");g&&(g=u.getListItemFormUrl(g,m.rootFolder||new o.default(m.listFullUrl).path,void 0,v));var x=v;if(!x){var T=e.demandItemFacet(s.contentTypeKeysFacet,y);if(T&&T.length){var N=e.demandItemFacet(s.spListContentTypeFacet,T[0]);N&&(x=N.contentTypeId)}}var C=e.demandItemFacet(h.createListItemActionControl,t.itemKey);f=h.createListItemActionControl.evaluate(C)(e,{itemKey:t.itemKey,formUrl:g,contentTypeId:x}).action}return f?p.renderAction(f):r.createElement(l.Action,n.__assign({onExecute:(function(e){var t=this;return function(){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){e&&(t=window.open(e,"_blank"))&&t.focus();return[2]})})}})(g)},c.getItemActionEngagement(e,{itemKey:d,engagement:{name:"CreateItem",isIntentional:!0}})))})});
define("aO6",["require","exports","aU"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createListItemActionControl=new n.ControlFacet("createListItemActionControl")});
define("aO7",["require","exports","mU","f","cH","zN","nB","i1","Gj","Ge","bt"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=i.asAutoAction()(a.CreateListItemAction),h=i.asAutoAction()(s.NewItemInOfficeClientAction),p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onComplete=function(){n.setState({isCompleted:!0});n.props.resolve()};n.state={isCompleted:!1};return n}t.prototype.render=function(){var e=this,t=this.props,n=t.contentTypeId,i=t.openInClient,s=t.contentTypeKey,a=t.pageContext,p=this.state.isCompleted;return n&&!p?r.createElement(o.WithItemCache,null,function(t){var o=t.itemCache.demandItemFacet(u.spListContentTypeFacet,s);if(o){var p=a&&!l.getKillSwitch(a).isActivated("E38C27E3-F930-424A-AE58-5E53C46F25DA","11/01/2019","Always open in client if appMap property exists except for infopath")&&!("ms-infopath"===o.appMap&&!i),d=o.templateUrl.indexOf("CreateNewDocument.aspx?id=")>-1,v=o.appMap&&f.getOfficeStringMap(o.appMap);if(i&&(d||v)||p&&o.appMap)return r.createElement(h,{contentTypeKey:s,onComplete:e._onComplete})}return r.createElement(c,{contentTypeId:n,onComplete:e._onComplete})}):null};return t})(r.Component);t.ContentTypeNavigationCreator=p});
define("aO8",["require","exports","mU","f","HO","Hq","F5","B6","CK","cm","rc","aO9","i6","cv","cu","Hq"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.editPinnedItemWithProgress=h.implementOperationWithProgress({operationTypeFacet:i.editPinnedItemOperation,progressKeyFacet:i.editPinnedItemProgressKeyFacet,initializeBatch:function(){return c.editPinnedItemProgressAddon}});var m=(function(e){n.__extends(i,e);function i(t){var n=e.call(this,t)||this;n.state={editPinnedItemError:void 0};return n}i.prototype.componentDidMount=function(){var e,n,r=this,i=this.props,o=i.itemCacheDispatch,u=i.pinnedItemSetKey,a=i.itemKey,f=i.editType,c=i.resolve,h=i.itemsScopeItemKey,m=i.editPinnedItem,g=void 0===m?t.editPinnedItemWithProgress:m;if(u){var y=o(p.readItems(function(e){return e.demandItem({pinnedItems:d.childItemsFacet},u)})).pinnedItems;if(0===f&&y&&y.itemKeys&&y.itemKeys.length>=v.MAX_PINNED_ITEM_COUNT)this.setState({editPinnedItemError:new s.EditPinnedItemError({resultType:3})});else{o(g({items:(e={},e[u]={itemEditTypeMap:(n={},n[a]={editType:f},n)},e)})).then(function(){c()},function(e){r.setState({editPinnedItemError:e})});1===f&&o(l.selectItems({itemsScopeItemKey:h,selectedItemKeys:[],currentSelectionKey:void 0}))}}else this.props.reject(new Error("No pinned item set to modify."))};i.prototype.render=function(){var e=this.props,t=e.editType,i=e.reject,s=this.state.editPinnedItemError;if(s){var l=(function(e,t,n){var r,i,s=e.resultType,a=3===t||2===t;if(1===s){r=a?o.default.errorMoveItemMissingTitle:0===t?o.default.errorPinItemMissingTitle:o.default.errorUnpinItemMissingTitle;i=o.default.errorFolderMissingBody}else if(2===s){if(0!==t)return;r=a?o.default.errorMoveItemMissingTitle:o.default.errorPinItemMissingTitle;i=o.default.errorItemMissingBody}else if(3===s){r=a?o.default.errorMoveGenericTitle:o.default.errorPinnedItemsFullTitle;i=o.default.errorPinnedItemsFullBody}else{if(4===s)return;r=a?o.default.errorMoveGenericTitle:0===t?o.default.errorPinGenericTitle:o.default.errorUnpinGenericTitle;i=o.default.errorGenericErrorBody}return{title:r,prompt:i,cancelText:u.default.cancelActionText,onCancel:function(){n(new f.CancelError)}}})(s,t,i);if(l)return r.createElement(a.WarningDialog,n.__assign({},l))}return null};return i})(r.PureComponent);t.EditPinnedItemExecutor=m});
define("aO9",["require","exports","mU","di","F5","iX","e3","oC","i6","cu","ct","HO","bv","oB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";var d,v,m,g;Object.defineProperty(t,"__esModule",{value:!0});var y=((d={})[l.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.pinItemStartedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.pinItemCompletedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.pinItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.pinItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},d),b=((v={})[l.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.unpinItemStartedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},v[l.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.unpinItemCompletedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},v[l.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.unpinItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},v[l.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.unpinItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},v),w=((m={})[l.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveLeftItemStartedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},m[l.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveLeftItemCompletedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},m[l.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveLeftItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},m[l.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveLeftItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},m),E=((g={})[l.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveRightItemStartedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},g[l.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveRightItemCompletedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},g[l.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveRightItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},g[l.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveRightItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},g);t.editPinnedItemProgressAddon=s.createAddon(function(){return function(e){e(o.registerControlHandler(c.editPinnedItemProgressKeyFacet,u.progressControl)(o.createControlHandler()(S)));e(o.registerControlHandler(c.editPinnedItemProgressKeyFacet,p.progressCommandSummaryControl)(o.createControlHandler()(x)))}});function S(){return function(e){return function(e,t){var r,i=t.itemKey,s=t.format,o=a.getOverallSimpleProgressBreakdown(e,t),u=o.phase,l=o.count,p=void 0,d=e.demandItemFacet(f.childItemsFacet,i),v=d&&d.itemKeys,m=0;if(v&&v.length>0){var g=e.demandItemFacet(c.editPinnedItemOperation,v[0]);if(g&&g.itemEditTypeMap){var S=g.itemEditTypeMap;for(var x in S)if(x&&S[x]){m=S[x].editType;break}}switch(m){case 0:p=y;break;case 1:p=b;break;case 3:p=w;break;case 2:p=E}r=p&&p[u](l)}else if("item"===s){var T=e.demandItemFacet(c.editPinnedItemProgressKeyFacet,i),N=T&&T.taskKey;if(N){var C=e.demandItemFacet(c.editPinnedItemProgressItemKeyFacet,N),k=C&&C.itemKey;if(k){r=e.demandItemFacet(h.displayNameFacet,k)}}}return n.__assign({},r&&"item"!==t.format?{title:r}:{})}}}function x(){return function(){return function(){return{reportMode:"pin"}}}}});
define("aPa",["require","exports","mU","HL","cL","fa","iW","bv","ff"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemUpdateLikesExectuor=i.connectToItemCache(function(e,t){var i=t.itemKey,s=e.demandItemFacet(u.likesCountFacet,i)||0,f=e.demandItemFacet(u.hasUserLikedFacet,i)||!1,l=f?s-1:s+1,c=e.dispatch;return n.__assign(n.__assign({isAvailable:!0},a.getItemActionEngagement(e,{itemKey:i,engagement:{name:"UpdateLikes",isIntentional:!0}})),{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(s){switch(s.label){case 0:c(o.resolveItems({items:(e={},e[i]=n.__assign(n.__assign({},u.likesCountFacet.pack(l)),u.hasUserLikedFacet.pack(!f)),e)}));return[4,c(r.updateItemLikes({items:(t={},t[i]={liked:!f},t)}))];case 1:s.sent();return[2]}})})}})})(s.Action)});
define("aPb",["require","exports","mU","f","fa","cu","nB","cy","ff","es","rf","ar","iU","i1","kI","iW","ex","fq"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y={ODB:1877},b={ODB:1391},w=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKey;return r.createElement(o.WithItemCache,null,function(o){var w=o.itemCache,E=o.dispatch,S=a.getItemActionEngagement(w,{itemKey:t,engagement:{name:"ExitQuickEdit",isIntentional:!0}}),x=w.demandItem({deserizalizeKey:h.spFolderItemSetKeyFacet},t).deserizalizeKey,T=x&&h.spGridInitInfoKeyFacet.serialize({listKey:{webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl},viewKey:x.viewKey}),N=w.demandItem({completeExitingQuickEditSignal:p.completeExitingQuickEditSignalFacet},T).completeExitingQuickEditSignal,C=x&&x.viewKey&&h.spViewKeyFacet.serialize(x.viewKey),k=m.getPageContextFromItemCache(w,t),L=g.isFeatureEnabled(w,{feature:y,pageContext:k}),A=g.isFeatureEnabled(w,{feature:b,pageContext:k}),O=L&&A;return r.createElement(u.WithAction,{action:r.createElement(l.SwitchLayoutAction,{layoutType:c.detailsLayoutType})},function(o){var u=o.execute;return r.createElement(i.Action,n.__assign({isAvailable:!0,onExecute:function(r){return n.__awaiter(e,void 0,void 0,function(){var e,i=this;return n.__generator(this,function(o){switch(o.label){case 0:d.EventGroup.raise(document,"startExitingQuickEdit");return N?[4,N.promise.then(function(){return n.__awaiter(i,void 0,void 0,function(){var e;return n.__generator(this,function(n){E(f.invalidateItems({items:(e={},e[t]=[s.childItemsFacet],e)}));return[2]})})})]:[3,2];case 1:o.sent();o.label=2;case 2:O&&C&&E(v.resolveItems({items:(e={},e[C]=n.__assign(n.__assign({},p.viewTypeFacet.pack("HTML")),p.showViewModifiedIndicatorFacet.pack(!0)),e)}));return[4,u(r)];case 3:o.sent();return[2]}})})}},S))})})};return t})(r.PureComponent);t.ExitQuickEditActionExecutor=w});
define("aPc",["require","exports","mU","f","i1","iU","cL","fa","B","bu"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ExportListActionExecutor=o.createItemCacheComponent(function(e,t){var o=t.itemKey,l=e.demandItemFacet(s.spFolderItemSetKeyFacet,o),c="";if(l&&l.viewKey&&l.viewKey.viewId){var h="",p=s.spListKeyFacet.serialize({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl}),d=e.demandItemFacet(i.listFacet,p);d&&(h=d.id);if(h){c=l.webAbsoluteUrl+"/_vti_bin/owssvr.dll?";c+=a.serializeQuery({CS:65001,Using:"_layouts/15/query.iqy",List:h,View:f.default.normalizeUpper(l.viewKey.viewId),RootFolder:l.rootFolder,CacheControl:1})}}return r.createElement(u.Action,{isAvailable:!0,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){window.open(c);return[2]})})}})})});
define("aPd",["require","exports","mU","HM","cL","fa","ff"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemUpdateRatingExecutor=i.connectToItemCache(function(e,t){var i=t.itemKey,s=t.currentRating,u=e.dispatch;return n.__assign({onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,u(r.updateItemRating({items:(e={},e[i]={userNewRating:s},e)}))];case 1:t.sent();return[2]}})})},isAvailable:!0},o.getItemActionEngagement(e,{itemKey:i,engagement:{name:"UpdateRating",isIntentional:!0}}))})(s.Action)});
define("aPe",["require","exports","mU","f","iU","fa","iW","cu","i1","nB","cy","nF","ff","hH","ft","an"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,m=t.sortFieldKey,g=t.itemSetKey,y=t.isAscending;return r.createElement(f.WithItemCache,null,function(t){var f=t.itemCache,b=t.dispatch,w=f.demandItemFacet(i.spFolderItemSetKeyFacet,g);if(!w)return r.createElement(l.WithAction,null);var E=i.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},w),{sortFieldKey:m,sortAscending:y})),S=i.spItemKeyFacet.serialize(w),x=w.viewKey&&i.spViewKeyFacet.serialize(w.viewKey),T=f.demandItemFacet(a.listFacet,i.spListKeyFacet.serialize({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl})),N=f.demandItemFacet(a.spPageContextFacet,i.spPageContextKeyFacet.serialize({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl})),C=h.getItemActionEngagement(f,{itemKey:g,engagement:{name:"Sort",isIntentional:!0}});return r.createElement(l.WithAction,{action:r.createElement(c.ItemOpenAction,{itemKey:E})},function(t){var f=t.execute;return r.createElement(s.Action,n.__assign({onExecute:function(t){return n.__awaiter(e,void 0,void 0,function(){var e,r;return n.__generator(this,function(s){switch(s.label){case 0:b((function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c;return n.__generator(this,function(n){switch(n.label){case 0:t=e.sortField,i=e.isAscending,s=e.webAbsoluteUrl,o=e.listFullUrl,u=e.pageContext,a=e.templateType;f=a===v.ListTemplateType.mySiteDocumentLibrary;if(!(u&&u.isSiteAdmin)||!f)return[3,2];l=p.getListApiUrl({webAbsoluteUrl:s,listFullUrl:o}).segment("DefaultView").segment("SetViewXml");c=i?"TRUE":"FALSE";return[4,r(d.getData({webAbsoluteUrl:s,listFullUrl:o,url:l.toString(),method:"POST",qosName:"SetDefaultView",noRedirect:!0,body:JSON.stringify({viewXml:'<View><Query><OrderBy><FieldRef Name="'+t+'" Ascending="'+c+'" /></OrderBy></Query></View>'})}))];case 1:return[2,n.sent()];case 2:return[4,Promise.resolve(void 0)];case 3:return[2,n.sent()]}})})}})({sortField:this.props.sortFieldKey,isAscending:this.props.isAscending,webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl,pageContext:N,templateType:T&&T.templateType}));b(o.resolveItems({items:n.__assign((e={},e[E]=n.__assign(n.__assign({},u.parentItemFacet.pack({itemKey:S})),u.sortFacet.pack({columnKey:i.spFieldKeyFacet.serialize({internalName:this.props.sortFieldKey}),isAscending:this.props.isAscending})),e),x?(r={},r[x]=n.__assign({},a.showViewModifiedIndicatorFacet.pack(!0)),r):{})}));return[4,f(t)];case 1:s.sent();return[2]}})})}},C))})})};return t})(r.PureComponent);t.SortActionExecutor=m});
define("aPf",["require","exports","mU","f","B8","n4","aPn","di","Cs","amI","OneDriveLightspeedItemsScopeDeferred_mini_css","aPg","fc","cL","xU","X","fb","ls","cn"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";l=l.SyncDialog_6;Object.defineProperty(t,"__esModule",{value:!0});function b(){return{button:{zIndex:100}}}function w(e){var t=e.clientDownloadUrl,n=e.resolve,h=e.reject,p=e.protocolCallback,d=e.getSyncInfo,v=e.isTenantAdmin,m=r.useState(),w=m[0],E=m[1],S=r.useState(),x=S[0],T=S[1],N=r.useState(),C=N[0],k=N[1],L=r.useState(),A=L[0],O=L[1];r.useEffect(function(){d().then(function(e){E(e)},function(e){T(e)})},[d]);r.useEffect(function(){v().then(function(e){k(e)},function(e){O(e)})},[v]);var M=w&&w.protocolUrl;r.useEffect(function(){p&&M&&p(M)},[p,M]);var _=g.useEventHandler(function(){var e=w&&w.syncConfigParams||"";f.copyToClipboard(e)}),D=g.useEventHandler(function(){x?h(x):A?h(A):w?n():h(new y.CancelError)}),P=r.createElement(r.Fragment,null,u.formatToArray(o.default.NGSCSyncDialogBody3Format,r.createElement("a",{className:l.pointerText,href:t,target:"_blank"},o.default.NGSCSyncDialogGetOneDriveButton))),H=C?r.createElement(r.Fragment,null,r.createElement("div",{className:l.adminContentContainer},r.createElement(a.Label,null,o.default.NGSCSyncDialogBody1,r.createElement(s.ActionButton,{className:l.copyLibraryId,onClick:_},o.default.NGSCSyncDialogBody4a),o.default.NGSCSyncDialogBody4b)),r.createElement("div",{className:l.separator},r.createElement(c.Separator,null)),r.createElement(a.Label,{className:l.footNote},P)):r.createElement("div",{className:l.contentContainer},o.default.NGSCSyncDialogBody1,P),B=r.createElement(i.Dialog,{hidden:!1,onDismiss:D,containerClassName:l.syncDialog,dialogContentProps:{styles:b}},r.createElement("div",{className:l.syncDialogContent},r.createElement("img",{className:l.syncImg,src:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/sync_to_device_illustration.svg",alt:o.default.syncImgAlt}),r.createElement("h2",{className:l.syncTitle},o.default.NGSCSyncDialogTitle),H));return r.createElement(r.Fragment,null,B,M&&!p?r.createElement("div",{style:{display:"none"}},r.createElement("iframe",{hidden:!0,src:M})):null)}t.SyncDialog=p.createItemCacheComponent(function(e,t){var i=t.itemKey,s=e.dispatch,o=e.demandItemFacet(d.itemSyncDialogControl,i),u=d.itemSyncDialogControl.evaluate(o)(e,{itemKey:i,clientDownloadUrl:"",userLoginName:""}),a=u.clientDownloadUrl,f=u.userLoginName,l=u.getSyncInfo,c=u.isTenantAdmin,p=h.getTelemetry(e).telemetry;if(!l)return r.createElement(E,n.__assign({},t,{message:"Missing sync info callback"}));if(!a)return r.createElement(E,n.__assign({},t,{message:"Missing client download URL"}));if(!f)return r.createElement(E,n.__assign({},t,{message:"Missing user login name"}));return r.createElement(w,n.__assign({},t,{telemetry:p,getSyncInfo:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:e=new(p(v.Qos))({name:"SyncDialog.getSyncInfo"});n.label=1;case 1:n.trys.push([1,3,4,5]);return[4,s(l({}))];case 2:return[2,n.sent()];case 3:t=n.sent();e.end(m.getQosEndSchemaFromError(t));throw t;case 4:e.end({resultType:v.ResultTypeEnum.Success});return[7];case 5:return[2]}})})},clientDownloadUrl:a,userLoginName:f,isTenantAdmin:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:if(!c)return[2,!1];e=new(p(v.Qos))({name:"SyncDialog.isTenantAdmin"});n.label=1;case 1:n.trys.push([1,3,4,5]);return[4,s(c({}))];case 2:return[2,n.sent()];case 3:t=n.sent();e.end(m.getQosEndSchemaFromError(t));throw t;case 4:e.end({resultType:v.ResultTypeEnum.Success});return[7];case 5:return[2]}})})}}))});function E(e){var t=e.reject,n=e.message;r.useEffect(function(){var e=setTimeout(function(){t(new Error(n))},6e4);return function(){clearTimeout(e)}},[n,t]);return null}});
define("aPg",["require","exports","mU","aPh"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("aPh",["require","exports","mU","aPi"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("aPi",["require","exports","mU","aPl","aPj"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("aPl",["require","exports","f","k9"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.classNamesFunction();t.SeparatorBase=function(e){var t=e.styles,r=e.theme,s=e.className,o=e.vertical,u=e.alignContent,a=i(t,{theme:r,className:s,alignContent:u,vertical:o});return n.createElement("div",{className:a.root},n.createElement("div",{className:a.content,role:"separator","aria-orientation":o?"vertical":"horizontal"},e.children))}});
define("aPj",["require","exports","k9","aPk","aPl"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Separator=n.styled(i.SeparatorBase,r.getStyles,void 0,{scope:"Separator"})});
define("aPk",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){var t=e.theme,n=e.alignContent,r=e.vertical,i=e.className,s="start"===n,o="center"===n,u="end"===n;return{root:[t.fonts.medium,{position:"relative"},n&&{textAlign:n},!n&&{textAlign:"center"},r&&(o||!n)&&{verticalAlign:"middle"},r&&s&&{verticalAlign:"top"},r&&u&&{verticalAlign:"bottom"},r&&{padding:"0 4px",height:"inherit",display:"table-cell",zIndex:1,selectors:{":after":{backgroundColor:t.palette.neutralLighter,width:"1px",content:'""',position:"absolute",top:"0",bottom:"0",left:"50%",right:"0",zIndex:-1}}},!r&&{padding:"4px 0",selectors:{":before":{backgroundColor:t.palette.neutralLighter,height:"1px",content:'""',display:"block",position:"absolute",top:"50%",bottom:"0",left:"0",right:"0"}}},i],content:[{position:"relative",display:"inline-block",padding:"0 12px",color:t.semanticColors.bodyText,background:t.semanticColors.bodyBackground},r&&{padding:"12px 0"}]}}});
define("aPo",["require","exports","iU","iT","gH","i1","e3","GJ"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolderDialogControlHandler=o.createControlHandler()(function(){return function(e){return function(e,t){var o,a=t.itemKey,f=e.demandItemFacet(n.spItemKeyFacet,a),l=u.nameValidator;if(f&&a){var c=f.rootFolder||new i.SimpleUri(f.listFullUrl).path,h=new r.ItemUrlHelperBasic({context:{webAbsoluteUrl:f.webAbsoluteUrl,listUrl:f.listFullUrl}}).getUrlParts({path:c});h.fullItemUrl&&(o=400-h.fullItemUrl.length);var p=f&&e.demandItemFacet(s.spPageContextFacet,n.spPageContextKeyFacet.serialize({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl}));!p||p.supportPoundStorePath&&p.supportPercentStorePath||(l=u.nameValidatorWithoutPoundPercent)}return{validator:l,maxLength:o}}}})});
define("aPp",["require","exports","e3","aPq","ex"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemDocumentCreatorControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey,s=i.getPageContextFromItemCache(e,n),o=!(!s||!s.isAnonymousGuestUser);return{validator:r.nameValidator.bind(void 0,!!s&&!!s.supportPoundStorePath),askForFileName:o}}}})});
define("aPq",["require","exports","Dy","aPr"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.nameValidator=function(e,t){return n.checkFilename(t,r.default,e)}});
define("aPs",["require","exports","mU","ft","hH"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getListRootFolder=function(e){var t=this,s=e.webAbsoluteUrl,o=e.listFullUrl,u=e.qosName;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:t=i.getListApiUrl({webAbsoluteUrl:s,listFullUrl:o}).segment("RootFolder");return[4,e(r.getDataWithCache({url:t.toString(),method:"GET",webAbsoluteUrl:s,listFullUrl:o,qosName:"rootFolder."+u,noRedirect:!0}))];case 1:return[2,n.sent()]}})})}}});
define("aPt",["require","exports","iX","e3","iU","aPE","aPu"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointAddonAutoRefresh=n.createAddon(function(){return function(e){e(r.registerControlHandler(i.spFolderItemSetKeyFacet,s.itemAutoRefreshControl)(o.itemAutoRefreshControlHandler))}})});
define("aPE",["require","exports","aU"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemAutoRefreshControl=new n.ControlFacet("itemAutoRefreshControl")});
define("aPu",["require","exports","mU","f","fv","e3","cs","aPD","DE","DH","c4","gB","aPC","aPz","an","bt","fT","fq","i1","iU","ft","aPy","aPw","aPv","cM","ev","aS","F","rg","z0","ci"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var M={ODB:860},_={ODB:818},D=new k.KeyFacet("itemAutoRefreshHelper",{itemsScopeItemKey:k.stringPart(),spPageContextKey:k.stringPart()}),P=N.asOnceOnly(function(e){return{}});function H(e){var t=T.useItemCacheDispatch();r.useLayoutEffect(function(){var n,r,s,o,f,l,c,d,m,g;return t((r=(n=e).spPageContextKey,s=n.pageContext,o=n.listId,f=n.webAbsoluteUrl,l=n.listFullUrl,c=n.isTAB,d=n.itemKey,m=n.driveUrl,g=n.itemsScopeItemKey,function(e){var t=e(P),n=D.serialize({itemsScopeItemKey:g,spPageContextKey:r}),y=t[n];if(!y){var b,w,E=void 0;if(s&&!v.getKillSwitch(s).isActivated("1280C2A6-E41F-4140-9BBD-AD7F6BC4C604","10/31/2019","Use socketIo api for list subscriptions")){var T=e(a.getDataRequestor).dataRequestor;E=new h.default({listId:o,webAbsoluteUrl:f},{dataRequestor:T})}else E=new x.default({dispatch:e,webAbsoluteUrl:f,listFullUrl:l,listId:o});b=new p.default({disableWebSockets:!0},{subscriptionService:E});w=new S.default({pushChannelService:b,subscriptionService:E,webAbsoluteUrl:f,listFullUrl:l,itemSetKey:d});y=t[n]=new u.default({id:n,isTestMode:c,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},driveUrl:m,dispatch:e,template:w,itemsScopeItemKey:g,pushChannelService:b,logQoS:function(t){var n=e(i.logQoS(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete t[n]}})}return y})).subscribe()},[]);return null}function B(e){var t=T.useItemCacheDispatch();r.useLayoutEffect(function(){return t((function(e){var t=this,r=e.spPageContextKey,s=e.webAbsoluteUrl,o=e.listFullUrl,l=e.isTAB,c=e.driveAccessToken,d=e.pageContext,m=e.driveUrl,g=e.endpoint,y=e.itemsScopeItemKey;return function(e){var S=e(P),x=D.serialize({itemsScopeItemKey:y,spPageContextKey:r}),T=S[x];if(!T){var N,C,k=e(a.getDataRequestor).dataRequestor;C=new E.default({dataRequestor:k,rootItemKey:b.spItemKeyFacet.serialize({webAbsoluteUrl:s,listFullUrl:o,rootFolder:""})});N=new p.default({disableWebSockets:!0},{subscriptionService:new h.default({},{dataRequestor:k}),sessionTokenFetcher:function(){return n.__awaiter(t,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:if(!d||!v.getKillSwitch(d).isActivated("60D2CD4A-EAEC-4EBC-94E9-B0FB14B7CBB5","01/23/2020","Use Graph auth for auto-refresh"))return[3,4];if(!l)return[3,1];t=c;return[3,3];case 1:return[4,e(w.getAuthToken({url:m,disallowCookies:!0}))];case 2:t=n.sent();n.label=3;case 3:return[3,7];case 4:return(i=g)?[4,e(f.getSessionToken(g,m))]:[3,6];case 5:i=n.sent();n.label=6;case 6:t=(r=i)&&r.accessToken;n.label=7;case 7:if(!t)throw new O.ApiError({code:"authFailure"});return[2,{accessToken:t,tokenUrl:m}]}})})}});T=S[x]=new u.default({id:x,isTestMode:l,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},driveUrl:m,dispatch:e,itemsScopeItemKey:y,template:C,pushChannelService:N,logQoS:function(t){var n=e(i.logQoS(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete S[x]}})}return T}})(e)).subscribe()},[]);return null}t.itemAutoRefreshControlHandler=s.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey;if(!n)return{};var i=e.demandItem({key:b.spFolderItemSetKeyFacet},n).key;if(!i||!i.webAbsoluteUrl||!i.listFullUrl)return{};var s=i.webAbsoluteUrl,u=i.listFullUrl,a=b.spPageContextKeyFacet.serialize({webAbsoluteUrl:s,listFullUrl:u}),f=e.demandItemFacet(y.spPageContextFacet,a);if(!g.isFeatureEnabled(e,{feature:M,pageContext:f})||!g.isFeatureEnabled(e,{feature:_,pageContext:f}))return{};var h=b.spListKeyFacet.serialize({webAbsoluteUrl:s,listFullUrl:u}),p=e.demandItem({listFacets:y.listFacet,listMediaTransformSchema:m.listMediaTransformFacet},h),v=p.listFacets,w=p.listMediaTransformSchema;if(!v||void 0===v.id||void 0===v.templateType)return{};var E=v.isDocumentLibrary,S=d.isGenericList(v.templateType);if(!E&&!S)return{};var x,T=o.getConfiguration(e,{isTAB:l.isTestMode}).isTAB,N=w&&w[".driveUrl"],k=N&&c.getUrlParts(N),O=k&&k.endpoint,D=C.getItemsScope(e).itemsScopeItemKey||"itemsSCopeItemKey";if(E&&!N)return{};var P=L.getCurrentLayout(e,{itemsScopeItemKey:D});if(P&&P.id===A.quickEditLayoutType.id)return{};if(E){if(!w)return{};if(!N)return{};if(T){var j=w[".driveAccessToken"];x=j&&j.replace("access_token=","")}if(!k)return{};var F=k.driveId;return O&&F?{isAvailable:!0,itemSubscriber:r.createElement(B,{spPageContextKey:a,driveUrl:N,isTAB:T,listFullUrl:u,endpoint:O,driveAccessToken:x,webAbsoluteUrl:s,pageContext:f,itemsScopeItemKey:D})}:{}}return{isAvailable:!0,itemSubscriber:r.createElement(H,{spPageContextKey:a,isTAB:T,itemKey:n,listFullUrl:u,webAbsoluteUrl:s,listId:v.id,pageContext:f,driveUrl:N,itemsScopeItemKey:D})}}}})});
define("aPD",["require","exports","mU","cu","bv","hS","bn","dL","gB","aPB","DK","W","aPx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p={ODB:819,ODC:"EnablePushChannelLogging"},d={ODB:459},v=(function(){function e(e){var t=this;this.subscribe=function(){t._log("Subscribe");if(0===t._subscribers){t._async=new o.default;var e=t._async.debounce(function(){return t._onNotification()},1e4,{leading:!0,maxWait:1e4});t._pushChannelService.setupNotificationHandler({source:f.NotificationSource.WebhookSubscription},function(){t._log("PushChannelMessageSource",f.NotificationSource.WebhookSubscription);e()});t._pushChannelService.setupNotificationHandler({source:f.NotificationSource.EventHub},function(){t._log("PushChannelMessageSource",f.NotificationSource.EventHub);e()});t._pushChannelService.addConnectionHandler(t._id,function(e){return t._onPushChannelConnection(e)})}t._subscribers++;t._pushChannelService.isConnected()||t._pushChannelService.connect(void 0,{methodInvoker:"ItemAutoRefreshHelper.subscribe"});return t._unsubscribe.bind(t)};this._id=e.id;this._driveUrlParts=e.driveUrl?a.getUrlParts(e.driveUrl):void 0;this._dispatch=e.dispatch;this._template=e.template;this._itemScopeItemKey=e.itemsScopeItemKey||"";this._pushChannelService=e.pushChannelService;this._onUnsubscribe=e.onUnsubscribe;this._isTestMode=e.isTestMode;this._onPushChannelConnected=e.onPushChannelConnected;this._subscribers=0;this._syncToken="latest";this._getChangesAttempts=0}e.prototype._unsubscribe=function(){this._log("Unsubscribe");this._subscribers--;this._template.onUnsubscribe(this._subscribers);if(0===this._subscribers){if(this._async){this._async.dispose();this._async=void 0;this._refreshSubscriptionTimeoutId=void 0}this._pushChannelService.setupNotificationHandler({source:f.NotificationSource.WebhookSubscription},function(){});this._pushChannelService.removeConnectionHandler(this._id);this._pushChannelService.disconnect()}this._onUnsubscribe(this._subscribers);return this._subscribers};e.prototype._onPushChannelConnection=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i=this;return n.__generator(this,function(n){switch(n.label){case 0:if(!e){this._log("Disconnected");this._clearRefreshSubscriptionTimeout();return[2]}this._log("Connected");this._isTestMode&&this._onPushChannelConnected&&this._onPushChannelConnected();if("latest"!==this._syncToken)return[3,4];n.label=1;case 1:n.trys.push([1,3,,4]);return[4,this._getChangeMessages()];case 2:n.sent();return[3,4];case 3:t=n.sent();this._getChangesAttempts++;if(this._getChangesAttempts>10)return[2];r=!1;if(l.isGraphError(t))switch(t.status){case 404:case 410:r=!0;this._syncToken="latest"}r&&this._async&&this._async.setTimeout(function(){return i._onPushChannelConnection(i._pushChannelService.isConnected())},500+Math.pow(2,this._getChangesAttempts));return[2];case 4:this._refreshSubscriptionHandler();return[2]}})})};e.prototype._refreshSubscriptionHandler=function(){var e=this;if(this._async){var t=this._pushChannelService.getSocketIoSubscription();if(t){var r=105001*Math.random()+15e3,i=Date.parse(t.expirationDateTime),s=Date.now(),o=i-s-r;if(o<12e4){if(u.default.isFeatureEnabled(d)){var a={refreshDelay:o,subscriptionExpirationDateTime:i,dateTimeNow:s,recreateBufferRandom:r};new c.default({name:"ItemAutoRefreshHelper.refreshSubscription",extraData:a}).end({resultType:c.ResultTypeEnum.Failure,extraData:a})}o=12e4}this._clearRefreshSubscriptionTimeout();this._refreshSubscriptionTimeoutId=this._async.setTimeout(function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:this._log("Refreshing subscription");this._refreshSubscriptionTimeoutId=void 0;return[4,this._pushChannelService.refreshSubscription()];case 1:!0===e.sent()&&this._refreshSubscriptionHandler();return[2]}})})},o)}}};e.prototype._clearRefreshSubscriptionTimeout=function(){if(this._async&&void 0!==this._refreshSubscriptionTimeoutId){this._async.clearTimeout(this._refreshSubscriptionTimeoutId);this._refreshSubscriptionTimeoutId=void 0}};e.prototype._getChangeMessages=function(){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,this._template.getChangeMessages(this._dispatch,this._syncToken,this._driveUrlParts)];case 1:e=t.sent();this._syncToken=e.syncToken?e.syncToken:"latest";this._getChangesAttempts=0;return[2,e]}})})};e.prototype._onNotification=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t,o,u,a,f,l,c,p,d;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);e=new s.ItemResolver;return[4,this._getChangeMessages()];case 1:t=n.sent();this._log("Change messages",t);o=this._processMessages(t.messages);this._log("Changes",o);e.merge(t.itemResolver);for(u=0,a=o;u<a.length;u++)switch((f=a[u]).type){case h.ItemAutoRefreshChangeType.New:e.invalidateItems({items:(c={},c[f.invalidateKey]=[r.defaultChildItemSetFacet],c)});break;case h.ItemAutoRefreshChangeType.Update:f.hasSelection&&this._itemScopeItemKey?this._updateItems(f.invalidateKey):e.invalidateItems({items:(p={},p[f.invalidateKey]=[f.invalidateFacet],p)});break;case h.ItemAutoRefreshChangeType.Delete:e.invalidateItems({items:(d={},d[f.invalidateKey]=[i.deletedFacet],d)})}this._dispatch(e.execute());return[3,3];case 2:l=n.sent();this._log("onNotification error",l);return[3,3];case 3:return[2]}})})};e.prototype._processMessages=function(e){var t=[];e.sort(function(e,t){return e.parentItemKey?0:1});for(var n=0;n<e.length;n++){var r=e[n],i=this._template.processMessage(this._dispatch,r,this._itemScopeItemKey);if(void 0!==i){this._log("Change",i.invalidateKey,i.reason);t.push(i)}else if(r.parentItemKey)for(var s=n+1;s<e.length;s++){if(e[s].itemKey===r.parentItemKey){e.splice(s,1);break}}}return t};e.prototype._updateItems=function(e){this._template.updateItems(this._dispatch,e)};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];u.default.isFeatureEnabled(p)&&console.log.apply(console,n.__spreadArrays(["ItemAutoRefreshHelper"],e))};return e})();t.default=v});
define("aPB",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.WebhookSubscription=0]="WebhookSubscription";e[e.Meta=1]="Meta";e[e.EventHub=2]="EventHub"})(t.NotificationSource||(t.NotificationSource={}));(function(e){e[e.Zip=0]="Zip"})(t.NotificationScenario||(t.NotificationScenario={}))});
define("aPx",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.New=0]="New";e[e.Update=1]="Update";e[e.Delete=2]="Delete"})(t.ItemAutoRefreshChangeType||(t.ItemAutoRefreshChangeType={}))});
define("aPC",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t){this._dataRequestor=t.dataRequestor;this._listId=e.listId;this._webAbsoluteUrl=e.webAbsoluteUrl}e.prototype.getSocketIoSubscription=function(e){var t,n;if(this._listId&&this._webAbsoluteUrl){t=this._webAbsoluteUrl+"/_api/v2.0/sites/root/lists/"+this._listId;n=!1}else{if(!e.sessionToken)throw new Error("Invalid session token");t="/drive/root";n=!0}return this._dataRequestor.send({path:t+"/subscriptions/socketIo",apiName:"GetSocketIo",requestType:"GET",accessToken:e.sessionToken,useAuthorizationHeaders:n}).then(function(e){return e})};return e})();t.default=n});
define("aPz",["require","exports","mU","bn","dL","W","aPB","DK","aPA","bt"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={ODB:819,ODC:"EnablePushChannelLogging"},c={ODB:459},h={ODB:!f.Killswitch.isActivated("390e1b6a-fe67-475a-a86e-07591cb0ebd5","04/01/2020","Log qos event for pushChannelService.Connect")},p=["Due to organizational policies, you can't access these resources from this network location","One of the provided arguments is not acceptable","Session has been revoked","The access token has expired","The caller does not have permission to perform the action","The caller is not authenticated","The request is malformed or incorrect","There has been an error authenticating the request"],d=(function(){function e(e,t){this._firedConnectQoSEvent=!1;this._getSubscriptionAttempts=0;this._socketIoReconnectAttempts=0;this._notificationHandlers={};this._connectionHandlers={};this._disableWebSockets=e.disableWebSockets;this._subscriptionService=t.subscriptionService;this._sessionTokenFetcher=t.sessionTokenFetcher;this._async=new r.default;this._socketIoReconnectAttempts=0}e.prototype.isConnected=function(){return!!this._socketIo&&this._socketIo.connected};e.prototype.getSocketIoSubscription=function(){return this._subscription};e.prototype.addConnectionHandler=function(e,t){this._connectionHandlers[e]=t};e.prototype.removeConnectionHandler=function(e){delete this._connectionHandlers[e]};e.prototype.setupNotificationHandler=function(e,t){var n=e.source,r=e.scenarios,i=e.id,s=void 0===i?"":i,u=o.NotificationSource[n];if(u){if(r&&r.length)for(var a=0,f=r;a<f.length;a++){var l=f[a];this._notificationHandlers[u.toLowerCase()+o.NotificationScenario[l].toLowerCase()+s]=t}else this._notificationHandlers[u.toLowerCase()+s]=t;return!0}return!1};e.prototype.connect=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,u,f,l,c=this;return n.__generator(this,function(p){switch(p.label){case 0:this.disconnect();if(void 0!==e)return[3,2];r=this;return[4,this._getSubscription("PushChannelService.Connect")];case 1:r._subscription=p.sent();return[3,3];case 2:this._subscription=e;p.label=3;case 3:this._log("Connecting to subscription",this._subscription);if(void 0===this._subscription){this._log("Invalid subscription");return[2,!1]}if(!this._firedConnectQoSEvent||i.default.isFeatureEnabled(h)){this._firedConnectQoSEvent=!0;u=new s.default({name:"PushChannelService.Connect",extraData:n.__assign({notificationUrl:this._subscription.notificationUrl},t||{})})}f={reconnectionAttempts:20};this._disableWebSockets&&(f.transports=["polling"]);l=this._socketIo=a.connect(this._subscription.notificationUrl,f);this._socketIo.on("connect",function(){if(l===c._socketIo){c._log("Connected");u&&u.end({resultType:s.ResultTypeEnum.Success,extraData:n.__assign({notificationUrl:c._subscription.notificationUrl},t||{})});c._executeConnectionHandlers(!0)}else l.disconnect()});this._socketIo.on("disconnect",function(){if(l===c._socketIo){c._log("Disconnected");c._executeConnectionHandlers(!1)}});this._socketIo.on("reconnect_failed",function(){c._log("Reconnect failed");u&&u.end({resultType:s.ResultTypeEnum.Failure,extraData:n.__assign({notificationUrl:c._subscription.notificationUrl},t||{})});c._subscription=void 0;c._socketIoReconnectAttempts++;c._socketIoReconnectAttempts>3?c._log("Exceeded max reconnect attempts"):c._async.setTimeout(function(){c.connect(void 0,{methodInvoker:"reconnect_failed"})},0)});this._socketIo.on("notification",function(e){c._log("Notification",e);var t;try{t=JSON.parse(e)}catch(e){return}var n=t.source,r=t.scenario?t.scenario.toLowerCase():"";n||(n=o.NotificationSource[o.NotificationSource.WebhookSubscription]);n=n.toLowerCase();var i=!1;i=c._handleMessage(t,n);var s=n+r;for(var u in c._notificationHandlers)-1!==u.indexOf(s)&&u!==n&&(i=c._handleMessage(t,u,s)||i);i||c._log("Notification - missing handler for message")});return[2,!0]}})})};e.prototype.disconnect=function(){if(this._socketIo){this._socketIo.disconnect();this._socketIo=void 0}if(this._async){this._async.dispose();this._async=new r.default}this._subscription=void 0};e.prototype.refreshSubscription=function(){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,this._getSubscription("PushChannelService.refreshSubscription")];case 1:if(void 0===(e=t.sent()))return[2,void 0];if(this.isConnected()&&this._subscription&&this._subscription.notificationUrl!==e.notificationUrl){this._log("Notification url changed. Reconnecting...");this.connect(e,{methodInvoker:"PushChannelService.refreshSubscription"});return[2,!1]}this._subscription=e;return[2,!0]}})})};e.prototype._getSubscription=function(e){void 0===e&&(e="unknown");return n.__awaiter(this,void 0,void 0,function(){var t,r,o,a,f,l,h,d,v=this;return n.__generator(this,function(n){switch(n.label){case 0:r=void 0;i.default.isFeatureEnabled(c)&&(r=new s.default({name:"PushChannelService.getSubscription",extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}}));n.label=1;case 1:n.trys.push([1,6,,7]);a=(o=this._subscriptionService).getSocketIoSubscription;f={};return this._sessionTokenFetcher?[4,this._sessionTokenFetcher()]:[3,3];case 2:l=n.sent();return[3,4];case 3:l=void 0;n.label=4;case 4:return[4,a.apply(o,[(f.sessionToken=l,f.existingSubscription=this._subscription,f)])];case 5:t=n.sent();r&&r.end({resultType:s.ResultTypeEnum.Success,extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}});return[3,7];case 6:h=n.sent();this._log("Failed to get socketIo subscription",h);d=!1;u.isGraphError(h)&&(403===h.status?d=!0:h.error&&h.error.message&&(d=p.some(function(e){return 0===h.error.message.indexOf(e)})));r&&r.end({resultType:s.ResultTypeEnum.Success,extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}});if(d)return[2,void 0];this._getSubscriptionAttempts++;return this._getSubscriptionAttempts>10?[2,void 0]:[2,new Promise(function(e){var t=500*Math.pow(2,v._getSubscriptionAttempts);v._log("Retrying in "+t+" milliseconds");v._async.setTimeout(function(){return e(v._getSubscription("Retry_getSubscription"))},t)})];case 7:return[2,t]}})})};e.prototype._handleMessage=function(e,t,n){void 0===n&&(n=t);var r=this._notificationHandlers[t];if(r){r(e.payload?e.payload:e.value);return!0}return!1};e.prototype._executeConnectionHandlers=function(e){for(var t=0,n=Object.keys(this._connectionHandlers);t<n.length;t++){var r=n[t];this._connectionHandlers[r](e)}};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.default.isFeatureEnabled(l)&&console.log.apply(console,n.__spreadArrays(["PushChannelService"],e))};return e})();t.default=d});
!(function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("aPA",[],t):"object"==typeof exports?exports.io=t():e.io=t()})(this,function(){return(function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)})([function(e,t,n){"use strict";function r(e,t){"object"===(void 0===e?"undefined":i(e))&&(t=e,e=void 0),t=t||{};var n,r=s(e),o=r.source,l=r.id,c=r.path,h=f[l]&&c in f[l].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||h?(a("ignoring socket cache for %s",o),n=u(o,t)):(f[l]||(a("new io instance for %s",o),f[l]=u(o,t)),n=f[l]),r.query&&!t.query&&(t.query=r.query),n.socket(r.path,t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(1),o=n(7),u=n(13),a=n(3)("aPA");e.exports=t=r;var f=t.managers={};t.protocol=o.protocol,t.connect=r,t.Manager=n(13),t.Socket=n(39)},function(e,t,n){(function(t){"use strict";var r=n(2),i=n(3)("socket.io-client:url");e.exports=function(e,n){var s=e;n=n||t.location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==n?n.protocol+"//"+e:"https://"+e),i("parse %s",e),s=r(e)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";var o=-1!==s.host.indexOf(":")?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+o+":"+s.port,s.href=s.protocol+"://"+o+(n&&n.port===s.port?"":":"+s.port),s}}).call(t,(function(){return this})())},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),s=e.indexOf("]");-1!=i&&-1!=s&&(e=e.substring(0,i)+e.substring(i,s).replace(/:/g,";")+e.substring(s,e.length));for(var o=n.exec(e||""),u={},a=14;a--;)u[r[a]]=o[a]||"";return-1!=i&&-1!=s&&(u.source=t,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),u}},function(e,t,n){(function(r){function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=n(5)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,s=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(s=i))}),e.splice(s,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:(function(){try{return window.localStorage}catch(e){}})(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(t,n(4))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(f===setTimeout)return setTimeout(e,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function s(){d&&h&&(d=!1,h.length?p=h.concat(p):v=-1,p.length&&o())}function o(){if(!d){var e=i(s);d=!0;for(var t=p.length;t;){for(h=p,p=[];++v<t;)h&&h[v].run();v=-1,t=p.length}h=null,d=!1,(function(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}})(e)}}function u(e,t){this.fun=e,this.array=t}function a(){}var f,l,c=e.exports={};!(function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(e){f=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}})();var h,p=[],d=!1,v=-1;c.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new u(e,t)),1!==p.length||d||i(o)},u.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=a,c.addListener=a,c.once=a,c.off=a,c.removeListener=a,c.removeAllListeners=a,c.emit=a,c.prependListener=a,c.prependOnceListener=a,c.listeners=function(e){return[]},c.binding=function(e){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(e){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},function(e,t,n){function r(e){function n(){if(n.enabled){var e=n,r=+new Date,s=r-(i||r);e.diff=s,e.prev=i,e.curr=r,i=r;for(var o=new Array(arguments.length),u=0;u<o.length;u++)o[u]=arguments[u];o[0]=t.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var a=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;a++;var i=t.formatters[r];if("function"==typeof i){var s=o[a];n=i.call(e,s),o.splice(a,1),a--}return n}),t.formatArgs.call(e,o);var f=n.log||t.log||console.log.bind(console);f.apply(e,o)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=(function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]})(e),"function"==typeof t.init&&t.init(n),n}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(e=n[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(6),t.names=[],t.skips=[],t.formatters={};var i},function(e,t){function n(e){return r(e,u,"day")||r(e,o,"hour")||r(e,s,"minute")||r(e,i,"second")||e+" ms"}function r(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var i=1e3,s=60*i,o=60*s,u=24*o,a=365.25*u;e.exports=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return(function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*a;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*o;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}})(e);if("number"===r&&!1===isNaN(e))return t.long?n(e):(function(e){return e>=u?Math.round(e/u)+"d":e>=o?Math.round(e/o)+"h":e>=s?Math.round(e/s)+"m":e>=i?Math.round(e/i)+"s":e+"ms"})(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){function r(){}function i(e){var n=""+e.type;return t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data&&(n+=JSON.stringify(e.data)),f("encoded %j as %s",e,n),n}function s(){this.reconstructor=null}function o(e){var n=0,r={type:Number(e.charAt(0))};if(null==t.types[r.type])return a();if(t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type){for(var i="";"-"!==e.charAt(++n)&&(i+=e.charAt(n),n!=e.length););if(i!=Number(i)||"-"!==e.charAt(n))throw new Error("Illegal attachments");r.attachments=Number(i)}if("/"===e.charAt(n+1))for(r.nsp="";++n;){if(","===(o=e.charAt(n)))break;if(r.nsp+=o,n===e.length)break}else r.nsp="/";var s=e.charAt(n+1);if(""!==s&&Number(s)==s){for(r.id="";++n;){var o;if(null==(o=e.charAt(n))||Number(o)!=o){--n;break}if(r.id+=e.charAt(n),n===e.length)break}r.id=Number(r.id)}return e.charAt(++n)&&(r=(function(e,t){try{e.data=JSON.parse(t)}catch(e){return a()}return e})(r,e.substr(n))),f("decoded %s as %j",e,r),r}function u(e){this.reconPack=e,this.buffers=[]}function a(){return{type:t.ERROR,data:"parser error"}}var f=n(3)("socket.io-parser"),l=n(8),c=n(9),h=n(11),p=n(12);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=r,t.Decoder=s,r.prototype.encode=function(e,n){if(e.type!==t.EVENT&&e.type!==t.ACK||!c(e.data)||(e.type=e.type===t.EVENT?t.BINARY_EVENT:t.BINARY_ACK),f("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)(function(e,t){h.removeBlobs(e,function(e){var n=h.deconstructPacket(e),r=i(n.packet),s=n.buffers;s.unshift(r),t(s)})})(e,n);else{n([i(e)])}},l(s.prototype),s.prototype.add=function(e){var n;if("string"==typeof e)n=o(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new u(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!p(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},u.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=h.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},u.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){function r(e){if(e)return(function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e})(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){(function(t){var r=n(10),i=Object.prototype.toString,s="function"==typeof t.Blob||"[object BlobConstructor]"===i.call(t.Blob),o="function"==typeof t.File||"[object FileConstructor]"===i.call(t.File);e.exports=function e(n){if(!n||"object"!=typeof n)return!1;if(r(n)){for(var i=0,u=n.length;i<u;i++)if(e(n[i]))return!0;return!1}if("function"==typeof t.Buffer&&t.Buffer.isBuffer&&t.Buffer.isBuffer(n)||"function"==typeof t.ArrayBuffer&&n instanceof ArrayBuffer||s&&n instanceof Blob||o&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return e(n.toJSON(),!0);for(var a in n)if(Object.prototype.hasOwnProperty.call(n,a)&&e(n[a]))return!0;return!1}}).call(t,(function(){return this})())},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(e){var r=n(10),i=n(12),s=Object.prototype.toString,o="function"==typeof e.Blob||"[object BlobConstructor]"===s.call(e.Blob),u="function"==typeof e.File||"[object FileConstructor]"===s.call(e.File);t.deconstructPacket=function(e){var t=[],n=e.data,s=e;return s.data=(function e(t,n){if(!t)return t;if(i(t)){var s={_placeholder:!0,num:n.length};return n.push(t),s}if(r(t)){for(var o=new Array(t.length),u=0;u<t.length;u++)o[u]=e(t[u],n);return o}if("object"==typeof t&&!(t instanceof Date)){o={};for(var a in t)o[a]=e(t[a],n);return o}return t})(n,t),s.attachments=t.length,{packet:s,buffers:t}},t.reconstructPacket=function(e,t){return e.data=(function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(r(t))for(var i=0;i<t.length;i++)t[i]=e(t[i],n);else if("object"==typeof t)for(var s in t)t[s]=e(t[s],n);return t})(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,s=e;(function e(a,f,l){if(!a)return a;if(o&&a instanceof Blob||u&&a instanceof File){n++;var c=new FileReader;c.onload=function(){l?l[f]=this.result:s=this.result,--n||t(s)},c.readAsArrayBuffer(a)}else if(r(a))for(var h=0;h<a.length;h++)e(a[h],h,a);else if("object"==typeof a&&!i(a))for(var p in a)e(a[p],p,a)})(s),n||t(s)}}).call(t,(function(){return this})())},function(e,t){(function(t){e.exports=function(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}}).call(t,(function(){return this})())},function(e,t,n){"use strict";function r(e,t){if(!(this instanceof r))return new r(e,t);e&&"object"===(void 0===e?"undefined":i(e))&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new p({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||a;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(14),o=n(39),u=n(8),a=n(7),f=n(41),l=n(42),c=n(3)("socket.io-client:manager"),h=n(37),p=n(43),d=Object.prototype.hasOwnProperty;e.exports=r,r.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)d.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},r.prototype.updateSocketIds=function(){for(var e in this.nsps)d.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},r.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},u(r.prototype),r.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},r.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},r.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},r.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},r.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},r.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},r.prototype.open=r.prototype.connect=function(e,t){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=s(this.uri,this.opts);var n=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var i=f(n,"open",function(){r.onopen(),e&&e()}),o=f(n,"error",function(t){if(c("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var u=this._timeout;c("connect attempt will timeout after %d",u);var a=setTimeout(function(){c("connect attempt timed out after %d",u),i.destroy(),n.close(),n.emit("error","timeout"),r.emitAll("connect_timeout",u)},u);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(i),this.subs.push(o),this},r.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(f(e,"data",l(this,"ondata"))),this.subs.push(f(e,"ping",l(this,"onping"))),this.subs.push(f(e,"pong",l(this,"onpong"))),this.subs.push(f(e,"error",l(this,"onerror"))),this.subs.push(f(e,"close",l(this,"onclose"))),this.subs.push(f(this.decoder,"decoded",l(this,"ondecoded")))},r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},r.prototype.ondata=function(e){this.decoder.add(e)},r.prototype.ondecoded=function(e){this.emit("packet",e)},r.prototype.onerror=function(e){c("error",e),this.emitAll("error",e)},r.prototype.socket=function(e,t){function n(){~h(i.connecting,r)||i.connecting.push(r)}var r=this.nsps[e];if(!r){r=new o(this,e,t),this.nsps[e]=r;var i=this;r.on("connecting",n),r.on("connect",function(){r.id=i.generateId(e)}),this.autoConnect&&n()}return r},r.prototype.destroy=function(e){var t=h(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},r.prototype.packet=function(e){c("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},r.prototype.cleanup=function(){c("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},r.prototype.close=r.prototype.disconnect=function(){c("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},r.prototype.onclose=function(e){c("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();c("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(c("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(c("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(c("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},r.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){e.exports=n(15)},function(e,t,n){e.exports=n(16),e.exports.parser=n(23)},function(e,t,n){(function(t){function r(e,n){if(!(this instanceof r))return new r(e,n);n=n||{},e&&"object"==typeof e&&(n=e,e=null),e?(e=f(e),n.hostname=e.host,n.secure="https"===e.protocol||"wss"===e.protocol,n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=f(n.host).host),this.secure=null!=n.secure?n.secure:t.location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.agent=n.agent||!1,this.hostname=n.hostname||(t.location?location.hostname:"localhost"),this.port=n.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=n.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==n.upgrade,this.path=(n.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!n.forceJSONP,this.jsonp=!1!==n.jsonp,this.forceBase64=!!n.forceBase64,this.enablesXDR=!!n.enablesXDR,this.timestampParam=n.timestampParam||"t",this.timestampRequests=n.timestampRequests,this.transports=n.transports||["polling","websocket"],this.transportOptions=n.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=n.policyPort||843,this.rememberUpgrade=n.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=n.onlyBinaryUpgrades,this.perMessageDeflate=!1!==n.perMessageDeflate&&(n.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=n.pfx||null,this.key=n.key||null,this.passphrase=n.passphrase||null,this.cert=n.cert||null,this.ca=n.ca||null,this.ciphers=n.ciphers||null,this.rejectUnauthorized=void 0===n.rejectUnauthorized||n.rejectUnauthorized,this.forceNode=!!n.forceNode;var i="object"==typeof t&&t;i.global===i&&(n.extraHeaders&&Object.keys(n.extraHeaders).length>0&&(this.extraHeaders=n.extraHeaders),n.localAddress&&(this.localAddress=n.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}var i=n(17),s=n(8),o=n(3)("engine.io-client:socket"),u=n(37),a=n(23),f=n(2),l=n(38),c=n(31);e.exports=r,r.priorWebsocketSuccess=!1,s(r.prototype),r.protocol=a.protocol,r.Socket=r,r.Transport=n(22),r.transports=n(17),r.parser=n(23),r.prototype.createTransport=function(e){o('creating transport "%s"',e);var t=(function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t})(this.query);t.EIO=a.protocol,t.transport=e;var n=this.transportOptions[e]||{};this.id&&(t.sid=this.id);return new i[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0})},r.prototype.open=function(){var e;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},r.prototype.setTransport=function(e){o("setting transport %s",e.name);var t=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},r.prototype.probe=function(e){function t(){if(h.onlyBinaryUpgrades){var t=!this.supportsBinary&&h.transport.supportsBinary;c=c||t}c||(o('probe transport "%s" opened',e),l.send([{type:"ping",data:"probe"}]),l.once("packet",function(t){if(!c)if("pong"===t.type&&"probe"===t.data){if(o('probe transport "%s" pong',e),h.upgrading=!0,h.emit("upgrading",l),!l)return;r.priorWebsocketSuccess="websocket"===l.name,o('pausing current transport "%s"',h.transport.name),h.transport.pause(function(){c||"closed"!==h.readyState&&(o("changing transport and sending upgrade packet"),f(),h.setTransport(l),l.send([{type:"upgrade"}]),h.emit("upgrade",l),l=null,h.upgrading=!1,h.flush())})}else{o('probe transport "%s" failed',e);var n=new Error("probe error");n.transport=l.name,h.emit("upgradeError",n)}}))}function n(){c||(c=!0,f(),l.close(),l=null)}function i(t){var r=new Error("probe error: "+t);r.transport=l.name,n(),o('probe transport "%s" failed because of error: %s',e,t),h.emit("upgradeError",r)}function s(){i("transport closed")}function u(){i("socket closed")}function a(e){l&&e.name!==l.name&&(o('"%s" works - aborting "%s"',e.name,l.name),n())}function f(){l.removeListener("open",t),l.removeListener("error",i),l.removeListener("close",s),h.removeListener("close",u),h.removeListener("upgrading",a)}o('probing transport "%s"',e);var l=this.createTransport(e,{probe:1}),c=!1,h=this;r.priorWebsocketSuccess=!1,l.once("open",t),l.once("error",i),l.once("close",s),this.once("close",u),this.once("upgrading",a),l.open()},r.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},r.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(l(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else o('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},r.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){o("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},r.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},r.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},r.prototype.close=function(){function e(){r.onClose("forced close"),o("socket closing - telling transport to close"),r.transport.close()}function t(){r.removeListener("upgrade",t),r.removeListener("upgradeError",t),e()}function n(){r.once("upgrade",t),r.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},r.prototype.onError=function(e){o("socket error %j",e),r.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},r.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},r.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~u(this.transports,e[n])&&t.push(e[n]);return t}}).call(t,(function(){return this})())},function(e,t,n){(function(e){var r=n(18),i=n(20),s=n(34),o=n(35);t.polling=function(t){var n=!1,o=!1,u=!1!==t.jsonp;if(e.location){var a="https:"===location.protocol,f=location.port;f||(f=a?443:80),n=t.hostname!==location.hostname||f!==t.port,o=t.secure!==a}if(t.xdomain=n,t.xscheme=o,"open"in new r(t)&&!t.forceJSONP)return new i(t);if(!u)throw new Error("JSONP disabled");return new s(t)},t.websocket=o}).call(t,(function(){return this})())},function(e,t,n){(function(t){var r=n(19);e.exports=function(e){var n=e.xdomain,i=e.xscheme,s=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!n||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!i&&s)return new XDomainRequest}catch(e){}if(!n)try{return new(t[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}}).call(t,(function(){return this})())},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){(function(t){function r(){}function i(e){if(a.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,t.location){var n="https:"===location.protocol,r=location.port;r||(r=n?443:80),this.xd=e.hostname!==t.location.hostname||r!==e.port,this.xs=e.secure!==n}}function s(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function o(){for(var e in s.requests)s.requests.hasOwnProperty(e)&&s.requests[e].abort()}var u=n(18),a=n(21),f=n(8),l=n(32),c=n(3)("engine.io-client:polling-xhr");e.exports=i,e.exports.Request=s,l(i,a),i.prototype.supportsBinary=!0,i.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new s(e)},i.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),i=this;r.on("success",t),r.on("error",function(e){i.onError("xhr post error",e)}),this.sendXhr=r},i.prototype.doPoll=function(){c("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},f(s.prototype),s.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var n=this.xhr=new u(e),r=this;try{c("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,this.async);try{if(this.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(var i in this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this.extraHeaders[i])}}catch(e){}if("POST"===this.method)try{this.isBinary?n.setRequestHeader("Content-type","application/octet-stream"):n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in n&&(n.withCredentials=!0),this.requestTimeout&&(n.timeout=this.requestTimeout),this.hasXDR()?(n.onload=function(){r.onLoad()},n.onerror=function(){r.onError(n.responseText)}):n.onreadystatechange=function(){if(2===n.readyState){var e;try{e=n.getResponseHeader("Content-Type")}catch(e){}"application/octet-stream"===e&&(n.responseType="arraybuffer")}4===n.readyState&&(200===n.status||1223===n.status?r.onLoad():setTimeout(function(){r.onError(n.status)},0))},c("xhr data %s",this.data),n.send(this.data)}catch(e){return void setTimeout(function(){r.onError(e)},0)}t.document&&(this.index=s.requestsCount++,s.requests[this.index]=this)},s.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},s.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},s.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},s.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,e)try{this.xhr.abort()}catch(e){}t.document&&delete s.requests[this.index],this.xhr=null}},s.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},s.prototype.hasXDR=function(){return void 0!==t.XDomainRequest&&!this.xs&&this.enablesXDR},s.prototype.abort=function(){this.cleanup()},s.requestsCount=0,s.requests={},t.document&&(t.attachEvent?t.attachEvent("onunload",o):t.addEventListener&&t.addEventListener("beforeunload",o,!1))}).call(t,(function(){return this})())},function(e,t,n){function r(e){var t=e&&e.forceBase64;l&&!t||(this.supportsBinary=!1),i.call(this,e)}var i=n(22),s=n(31),o=n(23),u=n(32),a=n(33),f=n(3)("engine.io-client:polling");e.exports=r;var l=null!=new(n(18))({xdomain:!1}).responseType;u(r,i),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(e){function t(){f("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(f("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){f("pre-pause polling complete"),--r||t()})),this.writable||(f("we are currently writing - waiting to pause"),r++,this.once("drain",function(){f("pre-pause writing complete"),--r||t()}))}else t()},r.prototype.poll=function(){f("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(e){var t=this;f("polling got data %s",e);o.decodePayload(e,this.socket.binaryType,function(e,n,r){return"opening"===t.readyState&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():f('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function e(){f("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(f("transport open - closing"),e()):(f("transport not open - deferring close"),this.once("open",e))},r.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};o.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";!1!==this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||e.sid||(e.b64=1),e=s.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e);return t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){function r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var i=n(23),s=n(8);e.exports=r,s(r.prototype),r.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},r.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(e){var t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)},r.prototype.onPacket=function(e){this.emit("packet",e)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){(function(e){function r(e,n){return n("b"+t.packets[e.type]+e.data.data)}function i(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=e.data,s=new Uint8Array(i),o=new Uint8Array(1+i.byteLength);o[0]=m[e.type];for(var u=0;u<s.length;u++)o[u+1]=s[u];return r(o.buffer)}function s(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(v)return(function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=new FileReader;return i.onload=function(){e.data=i.result,t.encodePacket(e,n,!0,r)},i.readAsArrayBuffer(e.data)})(e,n,r);var i=new Uint8Array(1);i[0]=m[e.type];return r(new b([i.buffer,e.data]))}function o(e,t,n){for(var r=new Array(e.length),i=c(e.length,n),s=function(e,n,i){t(n,function(t,n){r[e]=n,i(t,r)})},o=0;o<e.length;o++)s(o,e[o],i)}var u,a=n(24),f=n(9),l=n(25),c=n(26),h=n(27);e&&e.ArrayBuffer&&(u=n(29));var p="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),d="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),v=p||d;t.protocol=3;var m=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},g=a(m),y={type:"error",data:"parser error"},b=n(30);t.encodePacket=function(t,n,o,u){"function"==typeof n&&(u=n,n=!1),"function"==typeof o&&(u=o,o=null);var a=void 0===t.data?void 0:t.data.buffer||t.data;if(e.ArrayBuffer&&a instanceof ArrayBuffer)return i(t,n,u);if(b&&a instanceof e.Blob)return s(t,n,u);if(a&&a.base64)return r(t,u);var f=m[t.type];return void 0!==t.data&&(f+=o?h.encode(String(t.data),{strict:!1}):String(t.data)),u(""+f)},t.encodeBase64Packet=function(n,r){var i,s="b"+t.packets[n.type];if(b&&n.data instanceof e.Blob){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];r(s+e)},o.readAsDataURL(n.data)}try{i=String.fromCharCode.apply(null,new Uint8Array(n.data))}catch(e){for(var u=new Uint8Array(n.data),a=new Array(u.length),f=0;f<u.length;f++)a[f]=u[f];i=String.fromCharCode.apply(null,a)}return s+=e.btoa(i),r(s)},t.decodePacket=function(e,n,r){if(void 0===e)return y;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=(function(e){try{e=h.decode(e,{strict:!1})}catch(e){return!1}return e})(e)))return y;var i=e.charAt(0);return Number(i)==i&&g[i]?e.length>1?{type:g[i],data:e.substring(1)}:{type:g[i]}:y}i=new Uint8Array(e)[0];var s=l(e,1);return b&&"blob"===n&&(s=new b([s])),{type:g[i],data:s}},t.decodeBase64Packet=function(e,t){var n=g[e.charAt(0)];if(!u)return{type:n,data:{base64:!0,data:e.substr(1)}};var r=u.decode(e.substr(1));return"blob"===t&&b&&(r=new b([r])),{type:n,data:r}},t.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var i=f(e);return n&&i?b&&!v?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void o(e,function(e,r){t.encodePacket(e,!!i&&n,!1,function(e){r(null,(function(e){return e.length+":"+e})(e))})},function(e,t){return r(t.join(""))}):r("0:")},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);"function"==typeof n&&(r=n,n=null);var i;if(""===e)return r(y,0,1);for(var s,o,u="",a=0,f=e.length;a<f;a++){var l=e.charAt(a);if(":"===l){if(""===u||u!=(s=Number(u)))return r(y,0,1);if(u!=(o=e.substr(a+1,s)).length)return r(y,0,1);if(o.length){if(i=t.decodePacket(o,n,!1),y.type===i.type&&y.data===i.data)return r(y,0,1);if(!1===r(i,a+s,f))return}a+=s,u=""}else u+=l}return""!==u?r(y,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){return e.length?void o(e,function(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})},function(e,t){var r=t.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0),i=new Uint8Array(r),s=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);n=r.buffer}i[s++]=t?0:1;var u=n.byteLength.toString();for(o=0;o<u.length;o++)i[s++]=parseInt(u[o]);i[s++]=255;for(r=new Uint8Array(n),o=0;o<r.length;o++)i[s++]=r[o]}),n(i.buffer)}):n(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,n){o(e,function(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);e=r.buffer,t[0]=0}var s=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),o=new Uint8Array(s.length+1);for(i=0;i<s.length;i++)o[i]=parseInt(s[i]);if(o[s.length]=255,b){var u=new b([t.buffer,o.buffer,e]);n(null,u)}})},function(e,t){return n(new b(t))})},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var i=e,s=[];i.byteLength>0;){for(var o=new Uint8Array(i),u=0===o[0],a="",f=1;255!==o[f];f++){if(a.length>310)return r(y,0,1);a+=o[f]}i=l(i,2+a.length),a=parseInt(a);var c=l(i,0,a);if(u)try{c=String.fromCharCode.apply(null,new Uint8Array(c))}catch(e){var h=new Uint8Array(c);c="";for(f=0;f<h.length;f++)c+=String.fromCharCode(h[f])}s.push(c),i=l(i,a)}var p=s.length;s.forEach(function(e,i){r(t.decodePacket(e,n,!0),i,p)})}}).call(t,(function(){return this})())},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(e),s=new Uint8Array(n-t),o=t,u=0;o<n;o++,u++)s[u]=i[o];return s.buffer}},function(e,t){function n(){}e.exports=function(e,t,r){function i(e,n){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(s=!0,t(e),t=r):0!==i.count||s||t(null,n)}var s=!1;return r=r||n,i.count=e,0===e?t():i}},function(e,t,n){var r;(function(e,i){!(function(s){function o(e){for(var t,n,r=[],i=0,s=e.length;i<s;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<s?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function u(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function a(e,t){return m(e>>t&63|128)}function f(e,t){if(0==(4294967168&e))return m(e);var n="";return 0==(4294965248&e)?n=m(e>>6&31|192):0==(4294901760&e)?(u(e,t)||(e=65533),n=m(e>>12&15|224),n+=a(e,6)):0==(4292870144&e)&&(n=m(e>>18&7|240),n+=a(e,12),n+=a(e,6)),n+m(63&e|128)}function l(){if(v>=d)throw Error("Invalid byte index");var e=255&p[v];if(v++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function c(e){var t,n;if(v>d)throw Error("Invalid byte index");if(v==d)return!1;if(t=255&p[v],v++,0==(128&t))return t;if(192==(224&t)){if((n=(31&t)<<6|l())>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if((n=(15&t)<<12|l()<<6|l())>=2048)return u(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&((n=(7&t)<<18|l()<<12|l()<<6|l())>=65536&&n<=1114111))return n;throw Error("Invalid UTF-8 detected")}var h=("object"==typeof e&&e&&e.exports,"object"==typeof i&&i);h.global!==h&&h.window!==h||h;var p,d,v,m=String.fromCharCode,g={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=o(e),i=r.length,s=-1,u="";++s<i;)u+=f(r[s],n);return u},decode:function(e,t){var n=!1!==(t=t||{}).strict;p=o(e),d=p.length,v=0;for(var r,i=[];!1!==(r=c(n));)i.push(r);return(function(e){for(var t,n=e.length,r=-1,i="";++r<n;)(t=e[r])>65535&&(i+=m((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=m(t);return i})(i)}};void 0===(r=function(){return g}.call(t,n,t,e))||(e.exports=r)})()}).call(t,n(28)(e),(function(){return this})())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){!(function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<e.length;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),i=r.length,s="";for(n=0;n<i;n+=3)s+=e[r[n]>>2],s+=e[(3&r[n])<<4|r[n+1]>>4],s+=e[(15&r[n+1])<<2|r[n+2]>>6],s+=e[63&r[n+2]];return i%3==2?s=s.substring(0,s.length-1)+"=":i%3==1&&(s=s.substring(0,s.length-2)+"=="),s},t.decode=function(e){var t,r,i,s,o,u=.75*e.length,a=e.length,f=0;"="===e[e.length-1]&&(u--,"="===e[e.length-2]&&u--);var l=new ArrayBuffer(u),c=new Uint8Array(l);for(t=0;t<a;t+=4)r=n[e.charCodeAt(t)],i=n[e.charCodeAt(t+1)],s=n[e.charCodeAt(t+2)],o=n[e.charCodeAt(t+3)],c[f++]=r<<2|i>>4,c[f++]=(15&i)<<4|s>>2,c[f++]=(3&s)<<6|63&o;return l}})()},function(e,t){(function(t){function n(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var i=new Uint8Array(n.byteLength);i.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=i.buffer}e[t]=r}}}function r(e,t){t=t||{};var r=new s;n(e);for(var i=0;i<e.length;i++)r.append(e[i]);return t.type?r.getBlob(t.type):r.getBlob()}function i(e,t){return n(e),new Blob(e,t||{})}var s=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,o=(function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}})(),u=o&&(function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}})(),a=s&&s.prototype.append&&s.prototype.getBlob;e.exports=o?u?t.Blob:i:a?r:void 0}).call(t,(function(){return this})())},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var s=n[r].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){"use strict";function n(e){var t="";do{t=s[e%o]+t,e=Math.floor(e/o)}while(e>0);return t}function r(){var e=n(+new Date);return e!==i?(a=0,i=e):e+"."+n(a++)}for(var i,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,u={},a=0,f=0;f<o;f++)u[s[f]]=f;r.encode=n,r.decode=function(e){var t=0;for(f=0;f<e.length;f++)t=t*o+u[e.charAt(f)];return t},e.exports=r},function(e,t,n){(function(t){function r(){}function i(e){s.call(this,e),this.query=this.query||{},u||(t.___eio||(t.___eio=[]),u=t.___eio),this.index=u.length;var n=this;u.push(function(e){n.onData(e)}),this.query.j=this.index,t.document&&t.addEventListener&&t.addEventListener("beforeunload",function(){n.script&&(n.script.onerror=r)},!1)}var s=n(21),o=n(32);e.exports=i;var u,a=/\n/g,f=/\\n/g;o(i,s),i.prototype.supportsBinary=!1,i.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),s.prototype.doClose.call(this)},i.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},i.prototype.doWrite=function(e,t){function n(){r(),t()}function r(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(e){i.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+i.iframeId+'">';s=document.createElement(e)}catch(e){(s=document.createElement("iframe")).name=i.iframeId,s.src="javascript:0"}s.id=i.iframeId,i.form.appendChild(s),i.iframe=s}var i=this;if(!this.form){var s,o=document.createElement("form"),u=document.createElement("textarea"),l=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=l,o.method="POST",o.setAttribute("accept-charset","utf-8"),u.name="d",o.appendChild(u),document.body.appendChild(o),this.form=o,this.area=u}this.form.action=this.uri(),r(),e=e.replace(f,"\\\n"),this.area.value=e.replace(a,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===i.iframe.readyState&&n()}:this.iframe.onload=n}}).call(t,(function(){return this})())},function(e,t,n){(function(t){function r(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=c&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(h=i),s.call(this,e)}var i,s=n(22),o=n(23),u=n(31),a=n(32),f=n(33),l=n(3)("engine.io-client:websocket"),c=t.WebSocket||t.MozWebSocket;if("undefined"==typeof window)try{i=n(36)}catch(e){}var h=c;h||"undefined"!=typeof window||(h=i),e.exports=r,a(r,s),r.prototype.name="websocket",r.prototype.supportsBinary=!0,r.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?t?new h(e,t):new h(e):new h(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},r.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},r.prototype.write=function(e){var n=this;this.writable=!1;for(var r=e.length,i=0,s=r;i<s;i++)!(function(e){o.encodePacket(e,n.supportsBinary,function(i){if(!n.usingBrowserWebSocket){var s={};if(e.options&&(s.compress=e.options.compress),n.perMessageDeflate){("string"==typeof i?t.Buffer.byteLength(i):i.length)<n.perMessageDeflate.threshold&&(s.compress=!1)}}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,s)}catch(e){l("websocket closed before onclose event")}--r||(n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0))})})(e[i])},r.prototype.onClose=function(){s.prototype.onClose.call(this)},r.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=f()),this.supportsBinary||(e.b64=1),(e=u.encode(e)).length&&(e="?"+e);return t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},r.prototype.check=function(){return!(!h||"__initialize"in h&&this.name===r.prototype.name)}}).call(t,(function(){return this})())},function(e,t){},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t){(function(t){var n=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,s=/(?:^|:|,)(?:\s*\[)+/g,o=/^\s+/,u=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(o,"").replace(u,""),t.JSON&&JSON.parse?JSON.parse(e):n.test(e.replace(r,"@").replace(i,"]").replace(s,""))?new Function("return "+e)():void 0):null}}).call(t,(function(){return this})())},function(e,t,n){"use strict";function r(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(7),o=n(8),u=n(40),a=n(41),f=n(42),l=n(3)("socket.io-client:socket"),c=n(31);e.exports=r;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=o.prototype.emit;o(r.prototype),r.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[a(e,"open",f(this,"onopen")),a(e,"packet",f(this,"onpacket")),a(e,"close",f(this,"onclose"))]}},r.prototype.open=r.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},r.prototype.send=function(){var e=u(arguments);return e.unshift("message"),this.emit.apply(this,e),this},r.prototype.emit=function(e){if(h.hasOwnProperty(e))return p.apply(this,arguments),this;var t=u(arguments),n={type:s.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),delete this.flags,this},r.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},r.prototype.onopen=function(){if(l("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===i(this.query)?c.encode(this.query):this.query;l("sending connect packet with query %s",e),this.packet({type:s.CONNECT,query:e})}else this.packet({type:s.CONNECT})},r.prototype.onclose=function(e){l("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},r.prototype.onpacket=function(e){if(e.nsp===this.nsp)switch(e.type){case s.CONNECT:this.onconnect();break;case s.EVENT:case s.BINARY_EVENT:this.onevent(e);break;case s.ACK:case s.BINARY_ACK:this.onack(e);break;case s.DISCONNECT:this.ondisconnect();break;case s.ERROR:this.emit("error",e.data)}},r.prototype.onevent=function(e){var t=e.data||[];l("emitting event %j",t),null!=e.id&&(l("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},r.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var r=u(arguments);l("sending ack %j",r),t.packet({type:s.ACK,id:e,data:r})}}},r.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(l("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):l("bad ack %s",e.id)},r.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},r.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},r.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},r.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},r.prototype.close=r.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:s.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}},function(e,t){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},function(e,t){"use strict";e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}}])});
define("aPy",["require","exports","mU","cd","cv","bv","hS","cc","aPx","c2","gA","c4","eD","fT","iU","ft","DH","i1","bt","ci"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(){function e(e){this._dataRequestor=e.dataRequestor;this._rootItemKey=e.rootItemKey}e.prototype.onUnsubscribe=function(e){};e.prototype.getChangeMessages=function(e,t,s){return n.__awaiter(this,void 0,void 0,function(){var a,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V=this;return n.__generator(this,function(n){switch(n.label){case 0:if(void 0===s||void 0===s.endpoint||void 0===s.driveId)throw"Invalid drive url parts";a=s.endpoint+"/drives/"+s.driveId;w=e(u.readConfiguration({isTAB:c.isTestMode})).isTAB;E=e(i.readItems(function(e){var t=e.demandItemFacet(d.spItemKeyFacet,V._rootItemKey);return{spItem:t,pageContext:t&&e.demandItemFacet(g.spPageContextFacet,d.spPageContextKeyFacet.serialize(t))}})),S=E.spItem;if(!(x=E.pageContext)||!y.getKillSwitch(x).isActivated("60D2CD4A-EAEC-4EBC-94E9-B0FB14B7CBB5","01/23/2020","Use Graph auth for auto-refresh"))return[3,4];if(!w)return[3,1];T=e(i.readItems(function(e){var t=S&&d.spListKeyFacet.serialize(S),n=e.demandItemFacet(p.listMediaTransformFacet,t),r=n&&n[".driveAccessToken"];return r&&r.replace("access_token=","")}));return[3,3];case 1:return[4,e(v.getAuthToken({url:a,disallowCookies:!0}))];case 2:T=n.sent();n.label=3;case 3:return[3,7];case 4:return(C=s.endpoint)?[4,e(m.getSessionToken(s.endpoint,a))]:[3,6];case 5:C=n.sent();n.label=6;case 6:T=(N=C)&&N.accessToken;n.label=7;case 7:if(void 0===T)throw new b.ApiError({code:"authFailure"});k=x&&y.getKillSwitch(x).isActivated("C827C03F-4B57-4B6A-8BAB-3AE30D6AB56B","01/23/2020","including drive endpoint in the path")?"/drive/root/view.delta?token="+encodeURIComponent(t):a+"/root/view.delta?token="+encodeURIComponent(t);return[4,this._dataRequestor.send({apiName:"viewDelta",path:k,accessToken:{accessToken:T,tokenUrl:a},useAuthorizationHeaders:!0,headers:{"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions"}})];case 8:L=n.sent();A=[];O=new o.ItemResolver;if(L&&L.value)for(M=0,_=L.value;M<_.length;M++){D=_[M];P=void 0;H={endpoint:s.endpoint,driveId:s.driveId,itemId:D.id};if(D.root){q=l.getEndpointVersionKeyAliases(H);for(B=0,j=q;B<j.length;B++){z=j[B];O.mapKeys({mappings:(W={},W[z]=this._rootItemKey,W)})}}else if(D.webUrl&&(F=h.getDecodedUrl(D.webUrl))){I=d.spItemFullUrlKeyFacet.serialize({itemFullUrl:F});if(e(r.readItem({spItemKey:d.spItemKeyFacet},I)).spItemKey){q=l.getEndpointVersionKeyAliases(H);for(R=0,U=q;R<U.length;R++){z=U[R];O.mapKeys({mappings:(X={},X[z]=I,X)})}}}if(!D.root){D.parentReference&&(P=D.parentReference.id);A.push({itemKey:f.driveItemKeyFacet.serialize(H),parentItemKey:P&&f.driveItemKeyFacet.serialize({endpoint:s.endpoint,driveId:s.driveId,itemId:P}),isDeleted:!!D.deleted,isShared:!!D.shared,name:D.name,dateModified:D.lastModifiedDateTime,eTag:D.eTag})}}return[2,{syncToken:L["@delta.token"],messages:A,itemResolver:O}]}})})};e.prototype.updateItems=function(e,t,n){};e.prototype.processMessage=function(e,t,n){if(t.isDeleted){if(e(r.readItem({deleted:s.deletedFacet},t.itemKey)).deleted)return;return{type:a.ItemAutoRefreshChangeType.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(r.readItem({spItemKey:d.spItemKeyFacet,mediaTransformSchema:p.itemMediaTransformFacet,displayName:s.displayNameFacet},t.itemKey)),o=i.spItemKey,u=i.mediaTransformSchema,f=i.displayName;if(void 0===o){if(!t.parentItemKey)return;return{type:a.ItemAutoRefreshChangeType.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(u&&t.eTag){var l=u[".etag"];if(l&&t.eTag&&t.eTag!==l)return{type:a.ItemAutoRefreshChangeType.Update,invalidateKey:t.itemKey,invalidateFacet:p.itemMediaTransformFacet,reason:"eTag changed from "+l+" to "+t.eTag}}if(void 0!==t.name&&f!==t.name)return{type:a.ItemAutoRefreshChangeType.Update,invalidateKey:t.itemKey,invalidateFacet:s.displayNameFacet,reason:"Name changed from "+f+" to "+t.name}};return e})();t.default=w});
define("aPw",["require","exports","mU","cd","cv","bv","cu","hS","aPx","eV","eW","fU","fO","i1","iU","aPv","gC","ex","fn","fF","gI","bt"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(){function e(e){this._pushChannelService=e.pushChannelService;this._subscriptionService=e.subscriptionService;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._itemSetKey=e.itemSetKey;this._serverResponse=void 0}e.prototype.onUnsubscribe=function(e){if(0===e&&this._subscriptionService instanceof v.default){var t=this._pushChannelService.getSocketIoSubscription();t&&this._subscriptionService.deleteSocketIoSubscription(t)}};e.prototype.getChangeMessages=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var r,s,o,a,h,p,v,y,b,w,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W=this;return n.__generator(this,function(X){switch(X.label){case 0:if(o=!!t&&"SPO_LIST,"===t.substr(0,9)){a=t.split(",");h=a[1];p=a[2];v='<Eq><FieldRef Name="Modified" />';v+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+p+"</Value></Eq>";y='<Gt><FieldRef Name="ID" /><Value Type="Number">'+h+"</Value></Gt>";r=f.combineFilters([v,y],l.CamlTags.and);b='<Gt><FieldRef Name="Modified" />';b+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+p+"</Value>";b+="</Gt>";r=f.combineFilters([r,b],l.CamlTags.or);s=["ID","FileRef","Modified","Title"];w=this._getListColumns(e);for(S=0,x=w;S<x.length;S++)"ID"!==(T=x[S]).internalName&&"FileRef"!==T.internalName&&"Modified"!==T.internalName&&"Title"!==T.internalName&&s.push(T.internalName)}else s=["ID","FileRef","Modified"];"ID";N=o;C=o?200:1;k=new c.default("<View></View>");r&&k.addFilters([r]);s&&k.replaceFields(s);k.updateSort({fieldName:"ID",isAscending:N});k.updateRowLimit({rowLimit:C,isPerPage:!1});L=e(i.readItems(function(e){return g.getPageContextFromItemCache(e,d.spItemKeyFacet.serialize({webAbsoluteUrl:W._webAbsoluteUrl,listFullUrl:W._listFullUrl}))}));this._requestDatesInUtc=!L||E.getKillSwitch(L).isActivated("3599C6B2-C5C1-42F2-A5E1-CA0C352D20AB","01/09/2020","Do not request dates in UTC for autorefresh");return[4,e(m.getServerData({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,qosName:"ItemAutoRefreshGenericList.GetChanges",viewXml:k.getEffectiveViewXml(),postDataContext:{requestDatesInUtc:this._requestDatesInUtc,needsSchema:!0},currentPageContext:L}))];case 1:A=X.sent();this._serverResponse=A;O=A.ListData;M=O&&O.Row||[];_=[];D=this._getLastIdInList(M);P=o?this._getLastModifiedTimeInList(M,L):(new Date).toISOString();for(H=0,B=M;H<B.length;H++)if(void 0!==(j=B[H]).FileRef){F={};I=Object.keys(j);for(q=0,R=I;q<R.length;q++){U=R[q];z=0===U.indexOf("OData_")?U.substr(6):U;F[z]=j[U]}_.push(n.__assign(n.__assign({itemKey:d.spItemKeyFacet.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,itemId:j.ID}),parentItemKey:d.spItemKeyFacet.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1,name:j.Title||""},j.Modified?{dateModified:""+j.Modified}:{}),{fields:F}))}0===_.length&&_.push({itemKey:d.spItemKeyFacet.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1});return[2,{syncToken:"SPO_LIST,"+D+","+P,messages:_,itemResolver:new u.ItemResolver}]}})})};e.prototype.updateItems=function(e,t){if(t&&d.spFolderItemSetKeyFacet.matches(this._itemSetKey)&&this._serverResponse){var n=d.spFolderItemSetKeyFacet.deserialize(this._itemSetKey),r={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,rootFolder:n.rootFolder||""},i=e(w.getContentTypes({itemSetKey:r})),s=e(w.constructGetItemContext(n,i,"getSPItem")),o=e(b.processResponse({serverData:this._serverResponse,itemSetKey:r,contentTypes:i,currentPageContext:s.currentPageContext,isItemSetRequest:!1})).itemResolver;e(o.execute())}this._serverResponse=void 0};e.prototype.processMessage=function(e,t,n){if(void 0===t.parentItemKey)return{type:a.ItemAutoRefreshChangeType.New,invalidateKey:t.itemKey,reason:"Deleted an unknown item"};if(t.isDeleted){if(e(r.readItem({deleted:s.deletedFacet},t.itemKey)).deleted)return;return{type:a.ItemAutoRefreshChangeType.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var o=e(i.readItems(function(e){return e.isItemFacetResolved(d.spItemKeyFacet,t.itemKey)?{rowData:e.demandItemFacet(p.rowDataFacet,t.itemKey),spItemKey:e.demandItemFacet(d.spItemKeyFacet,t.itemKey),title:e.demandItemFacet(p.titleFacet,t.itemKey),selectedItemKeys:y.getSelectedItemKeys(e,{itemsScopeItemKey:n})}:{rowData:void 0,spItemKey:void 0,title:void 0,selectedItemKeys:void 0}})),u=o.rowData,f=o.spItemKey,l=o.title,c=o.selectedItemKeys,h=c&&c.length>0;if(void 0===f||void 0===u){if(!t.parentItemKey)return;if(void 0===e(r.readItem({spParentItemKey:d.spItemKeyFacet},t.parentItemKey)).spParentItemKey)return;return h?void 0:{type:a.ItemAutoRefreshChangeType.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(void 0!==l&&void 0!==t.name&&l!==t.name)return{type:a.ItemAutoRefreshChangeType.Update,invalidateKey:t.itemKey,invalidateFacet:p.titleFacet,reason:'Item title changed from "'+l+'" to '+t.name+")"};if(t.fields){h||(this._serverResponse=void 0);for(var v=this._getListColumns(e),m=function(e){for(var n=e.internalName,r=p.getFieldFacet(e.internalName,e.fieldType),i=0,s=Object.keys(t.fields).filter(function(e){return e!==n+".COUNT"&&0===e.indexOf(n)});i<s.length;i++){var o=s[i],f=u&&u[o],l=t.fields[o];try{"object"==typeof f&&(f=JSON.stringify(f));"object"==typeof l&&(l=JSON.stringify(l));if(g._requestDatesInUtc&&"DateTime"===e.fieldType){var c=Date.parse(f),d=Date.parse(l);if(!isNaN(c)&&!isNaN(d)){f=c;l=d}}}catch(e){continue}if(f!==l)return{value:{type:a.ItemAutoRefreshChangeType.Update,invalidateKey:t.itemKey,invalidateFacet:r,hasSelection:h,reason:'Item field "'+n+'" changed from "'+f+'" ('+typeof f+') to "'+l+'" ('+typeof l+")"}}}},g=this,b=0,w=v;b<w.length;b++){var E=m(w[b]);if("object"==typeof E)return E.value}}};e.prototype._getLastIdInList=function(e){return e&&e.length>0?Math.max.apply(Math,e.map(function(e){return parseInt(e.ID,10)})):0};e.prototype._getLastModifiedTimeInList=function(e,t){var n=(new Date).toISOString();if(e&&e.length>0)for(var r=void 0,i=0,s=e;i<s.length;i++){var o=s[i];if(this._requestDatesInUtc){var u=o.Modified;if(u){f=new Date(u);if(void 0===r||r<f){r=f;n=""+u}}}else{var a=o["Modified."];if(a){var f=new Date(a),l=t&&t.webTimeZoneData?t.webTimeZoneData.Bias-f.getTimezoneOffset():0;l&&f.setTime(f.getTime()+6e4*l);if(void 0===r||r<f){r=f;n=f.toISOString()}}}}return n};e.prototype._getListColumns=function(e){var t=[],n=e(r.readItem({schema:o.schemaFacet},this._itemSetKey)).schema,i=n&&n.columnKeys;if(i)for(var s=0,u=i;s<u.length;s++){var a=u[s],f=e(r.readItem({internalName:p.internalNameFacet,fieldType:p.fieldTypeFacet,mappedFieldType:p.mappedColumnFieldTypeFacet},a)),l=f.internalName,c=f.fieldType,d=f.mappedFieldType;void 0!==l&&void 0!==c&&void 0!==d&&d!==h.default.Title&&t.push({internalName:l,fieldType:c,mappedFieldType:d})}return t};return e})();t.default=S});
define("aPv",["require","exports","mU","fv","if","cc","c4","DJ","bu","dJ","ft","hH"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:819,ODC:"EnablePushChannelLogging"},p=(function(){function e(e){this._dispatch=e.dispatch;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._listId=e.listId}e.prototype.getSocketIoSubscription=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,p,d,v,m,g,y,b,w,E,S,x,T,N,C;return n.__generator(this,function(n){switch(n.label){case 0:if(e.existingSubscription)return[3,5];p=c.getStaticApiUrl({webAbsoluteUrl:this._webAbsoluteUrl}).segments("microservicemanager","getserviceurls").parameter("service","push");return[4,this._dispatch(l.getData({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:p.toString(),method:"GET",qosName:"GetServiceUrls",noRedirect:!0})).catch(function(e){f.default.isFeatureEnabled(h)&&console.log("Error getting service url: ",e)})];case 1:d=n.sent();v=this._dispatch(s.readConfiguration({isTest:o.isTestMode})).isTest;if(!(m=d&&d.d&&d.d.GetServiceUrls&&d.d.GetServiceUrls.results&&d.d.GetServiceUrls.results[0])&&!v)throw new Error("Unable to retrieve PushChannel base url");v&&(m="https://northcentralus0-pushs.svc.ms");g=m+"/notifications/register";y=a.default.generate();b=this._dispatch(r.logQoS({name:"SubscriptionServiceGenericList.Register"}));w={correlationId:y};n.label=2;case 2:n.trys.push([2,4,,5]);return[4,u.default.start({url:g,method:"GET",headers:{"X-Correlation-Id":y},requestTimeoutInMS:1e4})];case 3:(E=n.sent())&&E.responseText&&E.responseText.length>0&&(S=JSON.parse(E.responseText))&&S.serverUrl&&S.webhookUrl&&(t=S.webhookUrl);if(void 0===t)throw new Error("Unable to retireve PushChannel notification url");this._dispatch(b({resultType:i.ResultType.success,extraData:w}));return[3,5];case 4:x=n.sent();this._dispatch(b({resultType:i.ResultType.failure,extraData:w}));throw x;case 5:T=c.getWebApiUrl({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId);if(e.existingSubscription){T=T.method("Subscriptions",{guid:e.existingSubscription.id}).segment("Update");t=e.existingSubscription.notificationUrl}else T=T.segments("Subscriptions","Add");N={parameters:{resource:this._listId,notificationUrl:t,expirationDateTime:new Date(Date.now()+3e5).toISOString(),clientState:""}};return[4,this._dispatch(l.getData({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:T.toString(),body:JSON.stringify(N),qosName:"SubscriptionServiceGenericList.getSocketIoSubscription",method:"POST",noRedirect:!0}))];case 6:if((C=n.sent())&&C.d){delete C.d.__metadata;if(e.existingSubscription){C.d.id=e.existingSubscription.id;C.d.notificationUrl=e.existingSubscription.notificationUrl;C.d.expirationDateTime=N.parameters.expirationDateTime}return[2,C.d]}throw new Error("Invalid subscription object")}})})};e.prototype.deleteSocketIoSubscription=function(e){var t=c.getWebApiUrl({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId).method("Subscriptions",e.id);return this._dispatch(l.getData({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:t.toString(),qosName:"SubscriptionServiceGenericList.deleteSocketIoSubscription",method:"DELETE",noRedirect:!0}))};return e})();t.default=p});
define("aPF",["require","exports","mU","iX","e3","iU","zV","aPI","aPG"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(a,t);t.sharePointAddonQuickEdit=r.createAddon(function(){return function(e){e(i.registerControlHandler(s.spFolderItemSetKeyFacet,o.itemSetQuickEditListControl)(u.itemSetQuickEditListControlHandler))}})});
define("aPI",["require","exports","f","aPJ","e3"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetQuickEditListControlHandler=i.createControlHandler()(s);function s(){return function(e){return function(e,t){return{quickEditLayout:n.createElement(r.QuickEditLayout,null)}}}}t.getItemSetQuickEditListControlHandler=s});
define("aPJ",["require","exports","mU","bo","fl","tf","cL","z0","xG"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=r.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aPK"],t,n)})];case 1:return[2,t.sent().ItemSetQuickEditList]}})})}),l=s.asLayout(u.quickEditLayoutType)(f);t.QuickEditLayout=i.withCurrentItemSet()(o.connectToItemCache(function(e,t){return{isAvailable:a.getIsQuickEditLayoutAvailable(e,t),allowEmptyFolder:!1,allowPinnedItems:!1}})(l))});
define("aPG",["require","exports","mU","f","fa","nB","cy","ff","rf","z0","iU","i1","cq","iW","bt","aPH","ex","fq"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=d.Killswitch.isActivated("8755e60f-68f8-4103-aa9e-be030b248b24","11/12/2019","Use rum one logging in quick edit."),b={ODB:1877},w={ODB:1391},E=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKey;return r.createElement(s.WithItemCache,null,function(s){var d=s.itemCache,E=s.dispatch,S=u.getItemActionEngagement(d,{itemKey:t,engagement:{name:"QuickEdit",isIntentional:!0}}),x=d.demandItem({deserizalizeKey:l.spFolderItemSetKeyFacet},t).deserizalizeKey,T=x&&l.spGridInitInfoKeyFacet.serialize({listKey:{webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl},viewKey:x.viewKey}),N=x&&x.viewKey&&l.spViewKeyFacet.serialize(x.viewKey),C=m.getPageContextFromItemCache(d,t),k=g.isFeatureEnabled(d,{feature:b,pageContext:C}),L=g.isFeatureEnabled(d,{feature:w,pageContext:C}),A=k&&L;return r.createElement(o.WithAction,{action:r.createElement(a.SwitchLayoutAction,{layoutType:f.quickEditLayoutType})},function(t){var s=t.execute;return r.createElement(i.Action,n.__assign({isAvailable:!0,onExecute:function(t){return n.__awaiter(e,void 0,void 0,function(){var e,r;return n.__generator(this,function(i){switch(i.label){case 0:if(!y){v.resetRumOneMarker();v.addRumOneMarker("quickEdit.layoutManager.start")}T&&E(p.resolveItems({items:n.__assign((e={},e[T]=n.__assign({},c.completeExitingQuickEditSignalFacet.pack(new h.Signal)),e),A&&N?(r={},r[N]=n.__assign(n.__assign({},c.viewTypeFacet.pack("GRID")),c.showViewModifiedIndicatorFacet.pack(!0)),r):{})}));return[4,s(t)];case 1:i.sent();y||v.addRumOneMarker("quickEdit.layoutManager.end");return[2]}})})}},S))})})};return t})(r.PureComponent);t.QuickEditActionExecutor=E});
define("aPH",["require","exports","dn","dv","hf"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addRumOneMarker=function(e){n.default.getRUMOneLogger().mark(e)};t.resetRumOneMarker=function(){var e=n.default.getRUMOneLogger();e.isRunning()||e.resetLogger()};t.writeRumOneData=function(){var e=n.default.getRUMOneLogger();if(e&&e.isRunning()){e.addExpectedControl("QuickEdit");e.writeScenarioId("QuickEdit");e.writePageTransitionType(r.default.none);e.collectW3CPerfTimings();var t=e.getMarkerTime("quickEditommand.click"),u=e.getMarkerTime("quickEdit.pltafterlayoutswitch.start"),a=e.getMarkerTime("quickEdit.plt.end");if(u&&a&&t){var f={},l=e.getMarkerTime("quickEdit.layoutManager.start"),c=e.getMarkerTime("quickEdit.layoutManager.end");l&&c&&s(l,c,"QuickEditLayoutManagerDuration",f);c&&u&&s(c,u,"QuickEditItemsViewCacheDuration",f);var h=e.getMarkerTime("quickEdit.loadExternalFiles.start"),p=e.getMarkerTime("quickEdit.loadExternalFiles.end");h&&p&&s(h,p,"QuickEditExternalJsLoadDuration",f);var d=e.getMarkerTime("quickEdit.serialization.start"),v=e.getMarkerTime("quickEdit.serialization.end");d&&v&&s(d,v,"QuickEditGridSerializationDuration",f);var m=e.getMarkerTime("quickEdit.gridrender.start"),g=e.getMarkerTime("quickEdit.gridrender.end");m&&g&&s(m,g,"QuickEditGridRenderDuration",f);s(t,a,"QuickEditPLTRenderDuration",f);s(u,a,"QuickEditPLTAfterLayoutSwitchDuration",f);if(window._spPageContextInfo){e.writeServerCorrelationId(window._spPageContextInfo.CorrelationId);e.collectSPClientFlights(window._spPageContextInfo)}e.writeControlPerformanceData((function(e,t,n){return new i.default(e,t,n,o,function(){return!isNaN(t)&&!isNaN(n)})})("QuickEdit",t,a));e.writeEUPLBreakdown(JSON.stringify(f))}}};function s(e,t,n,r){if(e&&t){var i=t-e;r[n]=i}}function o(e,t){return e&&t?t.endTime-t.startTime:0}});
define("aPK",["require","exports","mU","f","tj","cL","cu","ce","i1","aPL","iU","ft","Lz","LC","fq","yj","gw","fc","ff","HT","cH","kI","Es","es","oJ","bt","yT","nY","yU","fS","yb","rc","aS","aPH","cs","ds","bo","GP","at5","cv","a2","C","h7"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var z=B.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../../actions/launchColumnManagementPanel/LaunchColumnManagementPanelExecutor"],t,n)})];case 1:return[2,t.sent().LaunchColumnManagementPanelAction]}})})}),W=n.__assign(n.__assign({},k.default),L.default),X={ODB:1261},V={ODB:1746},$={ODB:1725},J={ODB:1439},K={ODB:1806},Q={ODB:1892},G={ODB:1947},Y={ODB:1170},Z={ODB:1310},ee={ODB:1757},te=w.asAutoAction()(b.LaunchFilterPanelAction),ne=w.asAutoAction()(b.SortAction),re=w.asAutoAction()(z),ie={ODB:1553},se={ODB:420},oe=N.Killswitch.isActivated("8755e60f-68f8-4103-aa9e-be030b248b24","11/12/2019","Use rum one logging in quick edit."),ue=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._refreshChangedItemsInCache=function(e){var t=n.props.refreshItemsById,r=Object.keys(n._itemIdsToRefresh);return t&&r.length?t({itemIds:r,shouldInvalidateDataForLayout:e}).then(function(){n._itemIdsToRefresh={}}):Promise.resolve()};n._onItemCreatedFromClientForm=function(e){return n._onItemCreatedOrUpdatedFromClientForm(F.ClientFormEvents.newItemCreated,e.args)};n._onItemUpdatedFromClientForm=function(e){return n._onItemCreatedOrUpdatedFromClientForm(F.ClientFormEvents.itemUpdated,e.args)};n._onItemCreatedOrUpdatedFromClientForm=function(e,t){var r=n.props,i=r.telemetry,s=r.refreshItemsById;if(s&&t&&t.itemIds){s({itemIds:t.itemIds,shouldReturnRefreshedRows:!0}).then(function(e){e&&e.length&&n.setState({refreshedRows:e})});i&&i(q.default).logData({name:e+"QuickEdit",isIntentional:!0,extraData:{isBulkEdit:t.itemIds.length>1}})}};n._onSelectionChanged=function(e){var t=n.props.onSelectionChanged;e&&e.length&&n._refreshChangedItemsInCache();t&&t(e)};n.onColumnChangeSucceeded=function(){n._isSchemaChanged=!0};n.onPaging=function(e){n._refreshChangedItemsInCache();if(n.props.onPaging){n.props.onPaging(e);n.setState({currentFirstRow:e.isBackward?e.firstRowInGrid-n.props.rowLimit:e.lastRowInGrid+1})}};n.onLaunchFilterPanel=function(e){e&&n.setState({filterPanel:{columnKey:l.spFieldKeyFacet.serialize({internalName:e})}})};n.onSort=function(e,t){e&&n.setState({sortActionProps:{itemSetKey:n.props.itemKey,isAscending:t,sortFieldKey:e}})};n.onSortActionComplete=function(){n.setState({sortActionProps:void 0})};n.closeFilterPanel=function(){n.setState({filterPanel:void 0})};n.onLaunchColumnManagementPanel=function(e,t){t&&(n._columnManagementPanelActionOnComplete=t);n.setState({columnPanelProps:{createField:e.createField,editField:e.editField,isHyperlink:e.isHyperlink,isQuickEdit:!0}})};n.onColumnManagementPanelActionComplete=function(){if(n._columnManagementPanelActionOnComplete){n._columnManagementPanelActionOnComplete();n._columnManagementPanelActionOnComplete=void 0}n._isSchemaChanged=!0;n.setState({columnPanelProps:void 0})};n.closeColumnManagementPanel=function(){n.setState({columnPanelProps:void 0})};oe||D.addRumOneMarker("quickEdit.pltafterlayoutswitch.start");n.state={filterPanel:void 0,itemKey:t.itemKey};n._events=new E.EventGroup(n);n._itemIdsToRefresh={};n._isSchemaChanged=!1;return n}t.getDerivedStateFromProps=function(e,t){return t.itemKey&&t.itemKey!==e.itemKey?{itemKey:e.itemKey,currentFirstRow:void 0,isLoading:!0}:null};t.prototype.componentDidMount=function(){var e=this;this._events.on(document,"quickEditWriteChangesToList",function(t){if(t&&t.itemIds)for(var n=0,r=t.itemIds;n<r.length;n++){var i=r[n];e._itemIdsToRefresh[i]=!0}});this._events.on(window,F.ClientFormEvents.itemUpdated,this._onItemUpdatedFromClientForm);this._events.on(window,F.ClientFormEvents.newItemCreated,this._onItemCreatedFromClientForm)};t.prototype.componentWillUnmount=function(){this._isSchemaChanged&&this.props.invalidateSchema&&this.props.invalidateSchema();this._events.dispose()};t.prototype.componentDidUpdate=function(e){var t=this;this.state.isLoading&&this._refreshChangedItemsInCache(!0).then(function(){t.setState({isLoading:!1})});var n=this.props,r=n.flightStatus,i=n.gridLayoutType;r&&r[$.ODB]&&r[ie.ODB]&&e.gridLayoutType!==i&&this._refreshChangedItemsInCache(!0)};t.prototype.render=function(){var e=this.props,t=e.itemResponseJsonString,i=e.getAuthToken,s=e.pageContext,o=e.gridInitInfo,u=e.completeExitingQuickEditSignal,a=e.customFormatterProps,l=e.additionalColumnSchema,c=e.telemetry,h=e.baseEngagementData,p=e.itemKey,d=e.rows,v=e.isDataReadyForLayout,m=e.rowLimit,g=e.hasNextPage,y=e.flightStatus,b=e.getEventSource,w=e.gridLayoutType,E=this.state,S=E.filterPanel,x=E.isLoading,C=E.sortActionProps,k=E.columnPanelProps,L=E.currentFirstRow,O=E.refreshedRows,M=!!x||!v||L&&d.length<L,_=!s||!N.getKillSwitch(s).isActivated("733DEDA3-596C-4E49-89CE-CD0E8F5C2AC2","04/18/2019","Use filter panel in quick edit"),D=d,P=d.length;if(!M&&s&&o&&void 0!==L){P=Math.min(L-1+m,P);D=d.slice(L-1,P)}return r.createElement("div",{className:"quickEditParentDiv"},M&&r.createElement(T.Spinner,{size:T.SpinnerSize.large}),!M&&s&&o&&r.createElement(f.default,{key:p+(L||1)+w,itemResponseJsonString:t,rows:D,firstRowInGrid:L||1,hasNextPage:g||P<d.length,onPaging:this.onPaging,getAuthToken:i,pageContext:s,gridInitInfo:o,completeExitingQuickEditSignal:u,customFormatterProps:a,additionalColumnSchema:l,telemetry:c,baseEngagementData:h,onLaunchFilterPanel:_?this.onLaunchFilterPanel:void 0,onSort:this.onSort,onLaunchColumnManagementPanel:this.onLaunchColumnManagementPanel,getColumnWidthsFromLocalStorage:A.getColumnWidthsFromLocalStorage,setColumnWidthsToLocalStorage:A.setColumnWidthsToLocalStorage,flightStatus:y,onColumnChangeSucceeded:this.onColumnChangeSucceeded,onSelectionChanged:this._onSelectionChanged,getEventSource:b,refreshedRows:O,gridLayoutType:this.props.gridLayoutType}),!M&&S&&S.columnKey&&r.createElement(te,{columnKey:S.columnKey,itemSetKey:this.props.itemKey,onComplete:this.closeFilterPanel,onError:this.closeFilterPanel}),!!C&&C.sortFieldKey&&r.createElement(ne,n.__assign({},C,{onComplete:this.onSortActionComplete})),!!k&&r.createElement(re,{itemSetKey:this.props.itemKey,columnManagementPanelExecutorProps:k,onComplete:this.onColumnManagementPanelActionComplete,onError:this.closeColumnManagementPanel}))};return t})(r.PureComponent),ae=g.withTelemetry()(i.withLayoutRenderComplete()(ue));t.ItemSetQuickEditList=s.connectToItemCache(function(e,t){var r=t.itemKey,i=e.dispatch,s=30,f=void 0,g=e.isItemFacetResolved(a.getItemResponseJsonStringFacet,t.itemKey)||e.isItemFacetResolved(u.errorFacet,t.itemKey),b=function(e){return i(c.getAuthToken({url:e}))},w=e.demandItem({deserizalizeKey:l.spFolderItemSetKeyFacet,itemResponseJsonString:a.getItemResponseJsonStringFacet},r),E=w.deserizalizeKey,S=w.itemResponseJsonString,T=e.demandItemFacet(a.viewFormatterFacet,O.getViewKeyFromItemSetKey(e,{itemSetKey:r}));if(!E||!S)return{itemResponseJsonString:S||"",rows:[],gridInitInfo:void 0,pageContext:void 0,getAuthToken:b,isDataReadyForLayout:!1,rowLimit:s};var N=[];if(S){var k=e.demandItemFacet(o.childItemsFacet,r);if(k&&k.itemKeys)for(var L=0,A=k.itemKeys;L<A.length;L++){var D=A[L];if(e.isItemFacetResolved(o.pageFacet,D))f=D;else{if(!e.isItemFacetResolved(a.rowDataFacet,D)){N=[];g=!1;break}var B=e.demandItemFacet(a.rowDataFacet,D);B&&N.push(n.__assign({},B))}}}for(var F=e.demandItemFacet(a.spPageContextFacet,l.spPageContextKeyFacet.serialize(E)),I=l.spGridInitInfoKeyFacet.serialize({listKey:{webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl},viewKey:E.viewKey}),q=e.demandItem({gridInitInfo:a.gridInitInfoFacet,completeExitingQuickEditSignal:a.completeExitingQuickEditSignalFacet},I),U=q.gridInitInfo,z=q.completeExitingQuickEditSignal,te=h.getCustomFormatterSchemaFromItemCache(e,r),ne=d.isFeatureEnabled(e,{feature:X,pageContext:F}),re=[],oe=0,ue=v.readItemSetSchemaFromItemCache(e,{mapping:{internalName:a.internalNameFacet,isFilterable:m.isFilterableFacet,customFormatter:a.customFormatterFacet,isSortable:m.isSortableFacet,mappedColumnFieldType:a.mappedColumnFieldTypeFacet,fieldType:a.fieldFieldTypeFacet,isEditable:m.isEditableFacet,isCalculated:a.isCalculatedFacet},itemSetKey:r});oe<ue.length;oe++){var ae=ue[oe];if(ae.internalName){var ce={internalName:ae.internalName,filterable:!!ae.isFilterable,customFormatter:ae.customFormatter,fieldType:ae.fieldType,isEditable:ae.isEditable,isCalculated:ae.isCalculated};if(ae.isSortable){var he=C.getSortMenuStrings({fieldType:ae.mappedColumnFieldType,internalName:ae.internalName},W),pe=he.ascendingString,de=he.descendingString;ce.ascendingString=pe;ce.descendingString=de}re.push(ce)}}var ve,me=void 0;if(E.viewKey){var ge=l.spViewKeyFacet.serialize(E.viewKey),ye=e.isItemFacetResolved(a.serverViewFacet,ge)?e.demandItemFacet(a.serverViewFacet,ge):void 0;ye&&ye.RowLimit&&(s=ye.RowLimit);ve=e.demandItemFacet(a.viewGridLayoutFacet,ge);var be=P.getConfiguration(e,{expandedPageRowLimitNumber:a.spItemPageExpandedRowLimitConfigurationFacet}).expandedPageRowLimitNumber;if(be&&(!s||s<be)){s=be;if(f){var we=e.demandItemFacet(l.spItemPageKeyFacet,f),Ee=we&&we.token;if(Ee){var Se=Ee&&R.deserializeQuery(Ee.toLowerCase()),xe=Se&&Se.pagefirstrow;if(Number(xe)-1<s){g=!1;fe(f,i)}}}}me=function(){var e,t=E&&l.spListKeyFacet.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl});return i(x.invalidateItems({items:(e={},e[ge]=[a.serverViewFacet,a.currentDerivedViewFacet],e[I]=[a.gridInitInfoFacet],e[t]=[a.contentTypeKeysFacet],e[r]=[o.childItemsFacet],e)}))}}var Te=new H.PlatformDetection,Ne={};Ne[V.ODB]=d.isFeatureEnabled(e,{feature:V,pageContext:F});Ne[J.ODB]=d.isFeatureEnabled(e,{feature:J,pageContext:F});Ne[$.ODB]=d.isFeatureEnabled(e,{feature:$,pageContext:F})&&!Te.isIE;Ne[K.ODB]=d.isFeatureEnabled(e,{feature:K,pageContext:F});Ne[Q.ODB]=d.isFeatureEnabled(e,{feature:Q,pageContext:F});Ne[G.ODB]=d.isFeatureEnabled(e,{feature:G,pageContext:F});Ne[Y.ODB]=d.isFeatureEnabled(e,{feature:Y,pageContext:F});Ne[Z.ODB]=d.isFeatureEnabled(e,{feature:Z,pageContext:F});Ne[ee.ODB]=d.isFeatureEnabled(e,{feature:ee,pageContext:F});Ne[ie.ODB]=d.isFeatureEnabled(e,{feature:ie,pageContext:F});Ne[se.ODB]=d.isFeatureEnabled(e,{feature:se,pageContext:F});var Ce=void 0;T&&T.viewFormatter&&!T.viewFormatter.getRowFormatter()&&(Ce=T.viewFormatter.getAdditionalRowClass());var ke,Le=y.getItemEngagement(e,{itemKey:l.spItemKeyFacet.serialize(E),engagement:{isIntentional:!0}}),Ae=_.getItemsScope(e).itemsScopeItemKey;Ae&&(ke=function(e){if(e){for(var t=[],n=0,r=e;n<r.length;n++){var s=r[n],o={webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl,itemId:s},u=l.spItemKeyFacet.serialize(o);t.push(u)}i(M.selectItems({itemsScopeItemKey:Ae,selectedItemKeys:t,currentSelectionKey:void 0}))}});Le.objectType=void 0;return{itemResponseJsonString:S||"",rows:N,gridInitInfo:U,pageContext:F,getAuthToken:b,isDataReadyForLayout:g,completeExitingQuickEditSignal:z,customFormatterProps:{customFormatterSchema:te,getItemData:function(e,t){return p.getItemData(e,t,ne)},additionalRowClass:Ce},additionalColumnSchema:re,baseEngagementData:Le,refreshItemsById:function(e){return le(i,r,E.webAbsoluteUrl,E.listFullUrl,e)},invalidateSchema:me,onPaging:function(e){var t,n=e.lastRowInGrid;!e.isBackward&&f&&N&&n+s>N.length&&(t=f);t&&fe(t,i)},rowLimit:s,hasNextPage:!!f,flightStatus:Ne,onSelectionChanged:ke,getEventSource:function(){return i(j.getSharePointDataEventSource)},gridLayoutType:ve}})(ae);var fe=function(e,t){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,t(U.demandItems(function(t){t.demandItemFacet(o.childItemsFacet,e)}))];case 1:n.sent();return[2]}})})},le=function(e,t,r,i,s){var o,u=s.itemIds,f=s.shouldInvalidateDataForLayout,c=s.shouldReturnRefreshedRows;if(!u||!u.length)return Promise.resolve([]);for(var h={},p={},d=0,v=u;d<v.length;d++){var m=v[d],g=l.spItemKeyFacet.serialize({webAbsoluteUrl:r,listFullUrl:i,itemId:m});h[g]={};p[g]=[a.rowDataFacet]}f&&e(x.invalidateItems({items:p}));return e(S.refreshItemsInSet({items:(o={},o[t]=h,o)})).then(function(){if(!c)return[];for(var t=[],r=function(r){var i=e(I.readItems(function(e){return e.demandItemFacet(a.rowDataFacet,r)}));i&&i.ID&&t.push(n.__assign({},i))},i=0,s=Object.keys(h);i<s.length;i++){r(s[i])}return t})}});
define("aPL",["require","exports","mU","f","aQ3","aQA","aQq","aQo","aQn","aPY","oJ","OneDriveLightspeedItemsScopeDeferred_mini_css","an","Ft","ay6","aPW","aPV","aPU","aPT","n4","bt","kI","GO","X","aPS","aPR","azb","aPQ","aPH","aPP","aPO","aPN","aPM"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_){"use strict";c=c.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var D=w.Killswitch.isActivated("FCBB4612-13ED-47B8-9E17-79F91890AC92","9/26/2019","Translate the title column to linktitle when comparing Grid columns to the additionalColumnSchema"),P=w.Killswitch.isActivated("8755e60f-68f8-4103-aa9e-be030b248b24","11/12/2019","Use rum one logging in quick edit."),H=w.Killswitch.isActivated("8DAECEAF-4AEF-45B5-A606-9A3034CC2124","10/18/2019","Use modern taxonomy editor in quick edit."),B=w.Killswitch.isActivated("09F7C55C-78BE-463F-A5CF-BEECB48E874B","11/25/2019","Allow the grid to exist in multiple webparts on a page."),j=w.Killswitch.isActivated("75452fe6-d341-4b80-a203-a947dca04245","10/3/2019","Remove unused strings carried over from classic implementation"),F=w.Killswitch.isActivated("983CF6BF-776A-4753-92FC-1D8F1F1C6DAA","10/17/2019","make quick edit compatible with dark themes"),I=w.Killswitch.isActivated("3A4C46AF-0333-42C2-8741-9390170C8DB5","3/2/2020","fix an issue with some strings not loading in the correct language"),q=w.Killswitch.isActivated("734DA0D0-4C39-4582-A547-804B3D63665B","3/4/2020","fix jsgrid on prepsp machines"),R=w.Killswitch.isActivated("9536EDA9-94F6-4F65-BDB6-FAABD3B4565A","4/14/2020","remove extra space around the grid added by default by HTML table elements to allow for sticky header positioned correctly"),U=1746,z=1725,W=1553,X=1757,V="https://ajax.aspnetcdn.com/ajax/4.0/1/MicrosoftAjax.js",$="QuickEdit.InitGrid",J="QuickEdit.InitGanttControl",K="QuickEdit.UpdateWithRefreshedRows",Q=function(e){return"string"==typeof e?e:e.message},G=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._additionColumnSchemaMap={};n.previousPageIds=[];n.currentPageIdx=0;n.didPage=!1;n.gridInitInfo={};n._loadScriptsDependentOnInit=function(){var e=n._pageContextInfo.webAbsoluteUrl+"/",t="1033";n._loadCoreJsScript(function(){if(!j&&n.quickEditPltFlightEnabled){n.LoadClassicStrings();n._loadScriptsDependentOnStrings()}else{I||n._pageContextInfo.currentLanguage&&(t=n._pageContextInfo.currentLanguage.toString());n.LoadExternalJsFile(e+"_layouts/15/"+t+"/sp.res.js");n.LoadExternalJsFile(e+"_layouts/15/"+t+"/strings.js",n._loadScriptsDependentOnStrings);n.LoadExternalJsFile(e+"_layouts/15/"+t+"/sp.jsgrid.res.js")}n.quickEditPltFlightEnabled?O.global_inplview():n.LoadExternalJsFile(e+"_layouts/15/inplview.js");n.quickEditPltFlightEnabled||n.LoadExternalJsFile(e+"_layouts/15/clientrenderer.js");if(H||!n.quickEditPltFlightEnabled){n.LoadExternalJsFile(e+"_layouts/15/sp.runtime.js");n.LoadExternalJsFile(e+"_layouts/15/sp.js");n.LoadExternalJsFile(e+"_layouts/15/sp.init.js");n.LoadExternalJsFile(e+"_layouts/15/mquery.js")}n.LoadExternalJsFile(e+"_layouts/15/sp.ui.dialog.js");n.LoadExternalJsFile(e+"_layouts/15/datepicker.js",function(){n.LoadExternalJsFile(e+"_layouts/15/sp.datetimeutil.js")})})};n._loadCoreJsScript=function(e){var t=n._pageContextInfo.webAbsoluteUrl+"/";if(n.quickEditPltFlightEnabled){M.global_core();e()}else n.LoadExternalJsFile(t+"_layouts/15/core.js",e.bind(n))};n._loadScriptsDependentOnStrings=function(){var e=n._pageContextInfo.webAbsoluteUrl+"/";if(n.quickEditPltFlightEnabled){A.globalClienttemplates();n._loadScriptsDependentOnClientTemplates()}else n.LoadExternalJsFile(e+"_layouts/15/clienttemplates.js",n._loadScriptsDependentOnClientTemplates.bind(n))};n._loadScriptsDependentOnClientTemplates=function(){var e=n._pageContextInfo.webAbsoluteUrl+"/",t="en-US";n.props.pageContext.currentUICultureName&&(t=n.props.pageContext.currentUICultureName.toString());n.LoadExternalJsFile(e+"_layouts/15/ms.rte.js",function(){n.LoadExternalJsFile(e+"_layouts/15/sp.ui.rte.publishing.js",function(){});!H&&n.quickEditPltFlightEnabled||n.LoadExternalJsFile(e+"_layouts/15/sp.taxonomy.js",function(){n.LoadExternalJsFile(e+"_layouts/15/sp.ui.taxonomy.js",function(){n.LoadExternalJsFile(e+"_layouts/15/scriptforwebtaggingui.js",function(){n.LoadExternalJsFile(e+"_layouts/15/ScriptResx.ashx?culture="+t.replace("-","%2D")+"&name=ScriptResources&rev=oRPNQhCzzZsnsjrrXFJTKg%3D%3D:formatted",function(){})})})})})};n._countLoadedJsFiles=function(){n._numLoadedJsFiles++;if(n._numLoadedJsFiles>=n._totalFilesToLoad){P||L.addRumOneMarker("quickEdit.loadExternalFiles.end");n.setState({isLoading:!1})}};n.onScroll=function(){for(var e=u.JsGridUtil.Internal.GetScrollParent(n.tableRef.current),t=document.getElementsByClassName(c.stickyEditor),r=0;r<t.length;r++)t[r].style.left=Math.max(e.scrollLeft,32)+28+"px";n.jsGridControl.objBag.paneMgr.gridPane.UpdateDragHandleForScroll(e)};n.DoPagingBackward=function(e){var t=n.props,r=t.onPaging,i=t.firstRowInGrid;r&&r({firstRowInGrid:i,lastRowInGrid:i?n.rows.length+i-1:n.rows.length,isBackward:!0});return!1};n.DoPaging=function(e){var t=n.props,r=t.onPaging,i=t.firstRowInGrid;r&&r({firstRowInGrid:i,lastRowInGrid:i?n.rows.length+i-1:n.rows.length,isBackward:!1});return!1};n._constructPagingControls=function(){var e=n.props,t=e.firstRowInGrid,i=e.hasNextPage;if(e.onPaging){var s=t>1,o=i||n.rows&&n.props.rows&&n.rows.length<n.props.rows.length;if(s||o){var u=(t||1)+" - "+(t?t+n.rows.length-1:n.rows.length);return r.createElement("div",{className:c.spGridPagingFooter},s&&r.createElement(b.IconButton,{iconProps:{iconName:"ChevronLeft"},onClick:n.DoPagingBackward,title:v.default.previousPageButtonTitle}),r.createElement("span",null,u),o&&r.createElement(b.IconButton,{iconProps:{iconName:"ChevronRight"},onClick:n.DoPaging,title:v.default.nextPageButtonTitle}))}}};n.itemResponse=JSON.parse(n.props.itemResponseJsonString);n.listData=n.itemResponse.ListData;n.listSchema=n.itemResponse.ListSchema;n.rows=t.rows;n._additionalColumnSchema=t.additionalColumnSchema;n._customFormatterProps=t.customFormatterProps;n._telemetry=t.telemetry;n._baseEngagementData=t.baseEngagementData;n._events=new E.EventGroup(n);n.getColumnWidthsFromLocalStorage=t.getColumnWidthsFromLocalStorage;n.quickEditPltFlightEnabled=t.flightStatus[U];n._totalFilesToLoad=n._getTotalFilesToLoad();n._numLoadedJsFiles=0;n.tableRef=r.createRef();if(B)u.JsGridUtil.privateWpq="WPQ1";else{var i=document.getElementsByClassName("quickEditParentDiv");u.JsGridUtil.privateWpq="WPQ"+(i.length+1).toString()}n.dragDropMgr=new N.ColumnDragDropManager({telemetry:n._telemetry,baseEngagementData:n._baseEngagementData,events:n._events,onColumnChangeSucceeded:t.onColumnChangeSucceeded});if(n._additionalColumnSchema)for(var s=0,o=n._additionalColumnSchema;s<o.length;s++){var a=o[s];n._additionColumnSchemaMap[a.internalName]=a}n.props.pageContext?n._pageContextInfo=n.props.pageContext:n.itemResponse.PageContextInfo?n._pageContextInfo=JSON.parse(n.itemResponse.PageContextInfo):console.log("WARNING!! No page context!");if(t.gridInitInfo){n.gridInitInfo.controllerId=t.gridInitInfo.ControllerId;n.gridInitInfo.jsInitObj=JSON.parse(t.gridInitInfo.JsInitObj);n.viewId=n.gridInitInfo.jsInitObj.viewId;n.itemResponse&&n.itemResponse.rootFolder&&(n.gridInitInfo.jsInitObj.viewRootFolder=n.itemResponse.rootFolder);n.gridInitInfo.gridSerializer=t.gridInitInfo.GridSerializer;n.gridInitInfo.jsInitObj.iframeId="spgridIframeId";n.gridInitInfo.jsInitObj.flightStatus=n.props.flightStatus}n.setColumnWidthsToLocalStorage=function(e,r){var i=n.viewId.substring(1,n.viewId.length-1);t.setColumnWidthsToLocalStorage(i,e,r)};n.itemResponse.ListData.Row&&n.itemResponse.ListData.Row[0]&&n._addPageId(n.itemResponse.ListData.Row[0].ID);n.state={isLoading:n._shouldWaitLoadExternalJsFiles()};return n}t.prototype._startGridLoadSequence=function(){var e=this,t=this.props.flightStatus,n=this._pageContextInfo.webAbsoluteUrl+"/",r="1033";I?this.props.pageContext.currentLanguage&&(r=this.props.pageContext.currentLanguage.toString()):this._pageContextInfo.currentLanguage&&(r=this._pageContextInfo.currentLanguage.toString());P||L.addRumOneMarker("quickEdit.loadExternalFiles.start");t[z]&&!F||this.LoadExternalCssFile(n+"_layouts/15/styles/Themable/jsgrid.css","jsgridcss");!H&&this.quickEditPltFlightEnabled||this.LoadExternalCssFile(n+"_layouts/15/"+r+"/styles/WebTaggingUI.css","taxonomycss");this.GetRegionalSettings(this.props.pageContext.webServerRelativeUrl,null);this.LoadExternalJsFile(V,function(){e.LoadExternalJsFile("https://ajax.aspnetcdn.com/ajax/4.0/1/MicrosoftAjaxWebForms.js",function(){if(e.quickEditPltFlightEnabled){_.globalInit();e._loadScriptsDependentOnInit()}else e.LoadExternalJsFile(n+"_layouts/15/init.js",e._loadScriptsDependentOnInit.bind(e))})})};t.prototype.LoadClassicStrings=function(){window.Strings=window.Strings||{STS:y.default};window.Strings.STS=y.default;window.Strings.STS.L_RelativeDateTime_Format_DateTimeFormattingString_Override="";window.SP=window.SP||{};window.SP.Res=window.SP.Res||m.default;window.SP.JsGrid=window.SP.JsGrid||{Res:g.default,Image:{},Utility:{},PropertyType:{}};window.SP.JsGrid.Res=window.SP.JsGrid.Res||g.default};t.prototype._startInitSequence=function(){var e=this;P||L.addRumOneMarker("quickEdit.serialization.start");var t=document.getElementById("spgridcontainer_"+u.JsGridUtil.privateWpq);if(t&&0===t.childElementCount){this._registerGlobals();window.modernJsGrid=this;PageMinimized.minimized=!0;this.gridInitInfo&&this.gridInitInfo.jsInitObj&&this.gridInitInfo.jsInitObj.viewId&&(window.g_SPGridInitInfo[this.gridInitInfo.jsInitObj.viewId]=this.gridInitInfo);u.JsGridUtil.Internal.SiteUrl=this.gridInitInfo.jsInitObj.siteUrl;var n={crsAjaxRefresh:!0,currentCtx:this.itemResponse};n.currentCtx.enteringGridMode=!0;n.currentCtx.wpq=u.JsGridUtil.privateWpq;var r={Fields:{}},i=void 0;i=this.quickEditPltFlightEnabled?A.RenderFieldValueDefault:window.RenderFieldValueDefault;for(var s=0;s<this.listSchema.Field.length;s++)r.Fields[this.listSchema.Field[s].Name]=i;n.currentCtx.Templates=r;var o=window.CLVPFromEventReal(n);this.oldReRenderListView=window.ReRenderListView;window.ReRenderListView=this.CatchContext.bind(this);window.CLVPRefreshPagingEx.bind(o)("?",!0,null,void 0,void 0);this.props.getAuthToken(this._pageContextInfo.webAbsoluteUrl).then(function(t){e._setAuthToken(t)});this.quickEditPltFlightEnabled||(GetThemedImageUrl=u.JsGridUtil.Internal.GetImageUrl);this.InitGrid()}};t.prototype._registerGlobals=function(){if(this.quickEditPltFlightEnabled){window.ReRenderListView=O.ReRenderListView;window.CLVPRefreshPagingEx=O.CLVPRefreshPagingEx;window.CLVPFromEventReal=O.CLVPFromEventReal;window.g_fAnimateListCSR=!1;SP.UI.Notify||(SP.UI.Notify={addNotification:window.addNotification})}SP.JsGrid.Image=u.JsGridUtil.Image;SP.JsGrid.Utility||(SP.JsGrid.Utility={});SP.JsGrid.Utility.IsChar=u.JsGridUtil.Utility.IsChar;this.quickEditPltFlightEnabled&&!SP.ScriptUtility&&(SP.ScriptUtility={isNullOrEmptyString:k.Taxonomy.Utility.isNullOrEmpty,isNullOrUndefined:k.Taxonomy.Utility.isNullOrUndefined,isUndefined:k.Taxonomy.Utility.isUndefined});this.quickEditPltFlightEnabled&&!SP.Utilities&&(SP.Utilities={});SP.Utilities.Range=a.Range;SP.JsGrid.PropertyType={Utils:{RegisterEditControl:f.PropertyType.Utils.RegisterEditControl,RegisterWidgetControl:f.PropertyType.Utils.RegisterWidgetControl},RegisterNewCustomPropType:f.PropertyType.RegisterNewCustomPropType};var e=document.getElementById("__REQUESTDIGEST");if(!e){(e=document.createElement("INPUT")).id="__REQUESTDIGEST";e.name="__REQUESTDIGEST";e.type="hidden";e.value=this.props.pageContext.formDigestValue;document.body.appendChild(e)}q||(SP.JsGrid.DisplayControl={Type:{Image:"DISP_IMAGE",ImageText:"DISP_IMAGETEXT",Text:"DISP_TEXT",Checkbox:"DISP_CHECKBOX",Hierarchy:"DISP_HIERARCHY",RecordIndicatorCheckbox:"DISP_RECORDINDICATORCHECKBOX",CSR:"DISP_CSR",User:"DISP_USER"}});A.InitListViewFlightSettings()};t.prototype.InitFromRenderContext=function(e){this.setState({isLoading:!0});this.listData=e.ListData;this.rows=e.ListData.Row;this.CatchContext(e);this.listSchema=e.ListSchema;if(this.didPage){this._addPageId(e.CurrentItem.ID);this.didPage=!1}this._startGridLoadSequence()};t.prototype._setAuthToken=function(e){var t=this;if(e){this._authToken="Bearer "+e;var n=this._authToken,r=SP.ClientRuntimeContext.prototype.onExecutingWebRequest;this._oldOnExecuting=SP.ClientRuntimeContext.prototype.onExecutingWebRequest;console.log(this._authToken+this._oldOnExecuting);SP.ClientRuntimeContext.prototype.onExecutingWebRequest=function(e){var i=r.bind(t);e.get_webRequest()._headers.Authorization=n;i(e)}}};t.prototype.CatchContext=function(e){this.renderCtx=e;window.ReRenderListView=this.oldReRenderListView;if(!this.quickEditPltFlightEnabled){g_ctxDict["{"+this.viewId.toUpperCase()+"}"]=e;g_ctxDict["ctx"+e.ctxId]=e}window["ctx"+e.ctxId]=e;currentCtx=e};t.prototype.LoadExternalCssFile=function(e,t){var n=document.getElementsByTagName("head")[0],r=document.createElement("link");r.id=t;r.rel="stylesheet";r.type="text/css";r.href=e;r.media="all";n.appendChild(r)};t.prototype._getTotalFilesToLoad=function(){var e=23;if(this.quickEditPltFlightEnabled){H||(e-=8);j||(e-=3);e-=2;e-=1;e-=1;e-=1}return e};t.prototype.LoadExternalJsFile=function(e,t){u.JsGridUtil.injectJsScript(e,this._countLoadedJsFiles.bind(this),t)};t.prototype.GetRegionalSettings=function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState){console.log(n.responseText);if(n.responseText){var e=JSON.parse(n.responseText);if(e.value){var t=JSON.parse(e.value);u.JsGridUtil.SpRegionalSettings.adjustHijriDays=t.HijriAdjustment;u.JsGridUtil.SpRegionalSettings.calendarType=t.CalendarType;u.JsGridUtil.SpRegionalSettings.currentDateInLocalCalendar=new Date;u.JsGridUtil.SpRegionalSettings.firstDayOfWeek=t.FirstDayOfWeek;u.JsGridUtil.SpRegionalSettings.firstWeekOfYear=t.FirstWeekOfYear;u.JsGridUtil.SpRegionalSettings.localeId=t.LocaleId;u.JsGridUtil.SpRegionalSettings.showWeeks=t.ShowWeekNumber;u.JsGridUtil.SpRegionalSettings.time24=t.HoursMode24;u.JsGridUtil.SpRegionalSettings.timeZone=t.TimeZoneDifference;u.JsGridUtil.SpRegionalSettings.timeZoneInHours=parseInt(t.TimeZoneDifference);u.JsGridUtil.SpRegionalSettings.workDays=t.WorkWeek;window._spRegionalSettings=u.JsGridUtil.SpRegionalSettings}}}};var r=(e+"/_api/web/GetRegionalDateTimeSchema").replace(/\/\//g,"/");n.open("POST",r,!0);n.setRequestHeader("Content-Type","application/json;charset=utf-8");n.setRequestHeader("ACCEPT","application/json; odata.metadata=minimal");this._pageContextInfo.formDigestValue&&n.setRequestHeader("x-requestdigest",this._pageContextInfo.formDigestValue);n.setRequestHeader("ODATA-VERSION","4.0");n.send(t?JSON.stringify(t):void 0)};t.prototype.InitGrid=function(){var e=this,t=new(this._telemetry(x.Qos))({name:$}),r=this.gridInitInfo,a=document.getElementById("spgridcontainer_"+u.JsGridUtil.privateWpq);if(a){try{this.gridJson=i.DeserializeFromJson(r.gridSerializer)}catch(e){var f=Q(e);t.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToDeserializeFromJsonString",error:f});console.log("SPGrid FailToDeserializeFromJsonString: "+f);return}try{if(this._additionalColumnSchema&&this._additionalColumnSchema.length&&this._additionColumnSchemaMap&&this.gridJson.Columns)for(var l=0,c=this.gridJson.Columns;l<c.length;l++){var v=c[l];if(D){if(m=this._additionColumnSchemaMap[v.columnKey]){v.customFormatter=m.customFormatter;v.isFilterable=m.filterable;v.ascendingString=m.ascendingString;v.descendingString=m.descendingString;v.fieldType=m.fieldType;v.internalName=m.internalName;v.isEditable=m.isEditable;v.isCalculated=m.isCalculated}}else{var m,g=u.JsGridUtil.Internal.normalizeColumnKey(v.columnKey);if(m=this._additionColumnSchemaMap[g]){v.customFormatter=m.customFormatter;v.isFilterable=m.filterable;v.ascendingString=m.ascendingString;v.descendingString=m.descendingString;v.fieldType=m.fieldType;v.internalName=m.internalName;v.isEditable=m.isEditable;v.isCalculated=m.isCalculated}}}if(this.viewId&&this.gridJson.Columns)for(var y=this.viewId.substring(1,this.viewId.length-1),b=this.viewId&&this.getColumnWidthsFromLocalStorage(y)||{},w=this.viewId&&this.getColumnWidthsFromLocalStorage(y,!0)||{},E=0,N=this.gridJson.Columns;E<N.length;E++){var k=(v=N[E]).name,A=parseInt(w[k],10)||parseInt(b[k],10);A&&(v.width=A+T.JsGridConstants.Internal.ColumnWidthOffset)}if(!P){L.addRumOneMarker("quickEdit.serialization.end");L.addRumOneMarker("quickEdit.gridrender.start")}this.callback=function(t){var i=e.jsGridControl=new s.JsGridControl(a,r.showLoading,{setColumnWidthsToLocalStorage:e.setColumnWidthsToLocalStorage.bind(e),dragDropMgr:e.dragDropMgr,onSelectionChanged:e.props.onSelectionChanged,siteAssetsThumbnailMetadata:e.itemResponse.SiteAssetsThumbnailMetadata});r.jsInitObj.spCsrRenderCtx=e.renderCtx;r.jsInitObj.spCsrRenderCtx.queryString="";r.jsInitObj.peoplePickerDataSource=new p.PeoplePickerDataSource({},{pageContext:e._pageContextInfo,getAuthToken:e.props.getAuthToken});r.jsInitObj.locationDataSource=new d.LocationDataSource({pageContext:e._pageContextInfo});r.jsInitObj.taxonomyPickerDataSource=new C.TaxonomyDataSource(e._pageContextInfo);r.jsInitObj.pageContext=e._pageContextInfo;r.jsInitObj.customFormatterProps=e._customFormatterProps;r.jsInitObj.telemetry=e._telemetry;r.jsInitObj.onLaunchFilterPanel=e.props.onLaunchFilterPanel;r.jsInitObj.onSort=e.props.onSort;r.jsInitObj.onLaunchColumnManagementPanel=e.props.onLaunchColumnManagementPanel;r.jsInitObj.baseEngagementData=e._baseEngagementData;r.jsInitObj.onColumnChangeSucceeded=e.props.onColumnChangeSucceeded;e.props.flightStatus[z]&&e.props.flightStatus[W]&&1===e.props.gridLayoutType&&(r.jsInitObj.spCsrRenderCtx.fixedHeightRowEnabled=!0);var f=new(e._telemetry(x.Qos))({name:J});try{var l=e.ganttControl=new o.GanttControl(e._telemetry);window[r.controllerId]=l;window[r.controllerId].Init(i,t,r.jsInitObj,r.pagingInfo);e.dragDropMgr.setGanttControl(l);e.dragDropMgr.setPaneManager(i._GetPaneManager());e._events.on(document,S.SPGridEvents.startExitingQuickEditEventName,function(){l.TryDispose(function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){this.props.completeExitingQuickEditSignal&&this.props.completeExitingQuickEditSignal.resolve();window[r.controllerId]=null;return[2]})})})});if(e.props.getEventSource){var c=e.props.getEventSource();e._events.on(c,S.SPGridEvents.deleteCompletedEventName,function(e){e&&e.itemIds&&e.itemIds.length&&i.DeleteRecords(e.itemIds,null)})}f.end({resultType:x.ResultTypeEnum.Success})}catch(e){var v=Q(e);f.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToInitGanttControl",error:v});console.log("SPGrid FailToInitGanttControl: "+v)}window.setTimeout(function(){i.Focus()},0);if(null!=r.selectedRows&&1!=r.selectedRows.length||e._pageContextInfo.listBaseTemplate!==h.default.tasksWithTimelineAndHierarchy){if(null!=r.selectedRows)for(var m=0;m<r.selectedRows.length;m++)i.SelectRowRangeByKey(r.selectedRows[m],r.selectedRows[m],0!==m)}else{var g=null==r.selectedRows?i.GetTopRecordIndex():i.GetViewIndexOfRecord(r.selectedRows[0]),y=i.GetColumns();y.length>1&&"Checkmark"==y[0].columnKey?i.SelectCellRange(g,g,1,1,!1):i.SelectRowRange(g,g,!1)}g_fAnimateListCSR=!1;null!=r.fnCallback&&r.fnCallback(window[r.controllerId]);if(u.JsGridUtil.Internal.IsStickyColumnEnabled()){u.JsGridUtil.Internal.GetScrollParent(e.tableRef.current).addEventListener("scroll",e.onScroll)}window.setTimeout(function(){P||L.addRumOneMarker("quickEdit.gridrender.end");e.PostRenderAfterJSGridRender(e.renderCtx);if(!P){L.addRumOneMarker("quickEdit.plt.end");L.writeRumOneData()}},0)};this.TranslateCSRtoJsGrid(this.listData,this.rows,this.gridJson,this.listSchema,this.renderCtx);this.callback(this.gridJson);t.end({resultType:x.ResultTypeEnum.Success})}catch(e){f=Q(e);t.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToInitGrid",error:f});console.log("SPGrid FailToInitGrid: "+f)}}else t.end({resultType:x.ResultTypeEnum.Failure,resultCode:"MissingContainerElement",error:"Cannot init grid due to missing contianer element."})};t.prototype.PostRenderAfterJSGridRender=function(e){e.enteringGridMode=!1;this.quickEditPltFlightEnabled?A.SPClientRenderer._ExecuteRenderCallbacks(e,"OnPostRender"):window.SPClientRenderer._ExecuteRenderCallbacks(e,"OnPostRender")};t.prototype._shouldWaitLoadExternalJsFiles=function(){return!document.getElementById(V)};t.prototype.componentDidMount=function(){this._shouldWaitLoadExternalJsFiles()?this._startGridLoadSequence():this._startInitSequence();this.dragDropMgr.subscribe()};t.prototype.shouldComponentUpdate=function(e,t){return t!==this.state||e.refreshedRows!==this.props.refreshedRows};t.prototype.componentDidUpdate=function(e,t){t.isLoading&&!this.state.isLoading?this._startInitSequence():e.refreshedRows!==this.props.refreshedRows&&this.updateWithRefreshedRows();this.dragDropMgr.subscribe()};t.prototype.componentWillUnmount=function(){this.ganttControl._jsGridControl._GetPaneManager().editMgr.unBindEditors();this._events.dispose();this.dragDropMgr.dispose();if(u.JsGridUtil.Internal.IsStickyColumnEnabled()){u.JsGridUtil.Internal.GetScrollParent(this.tableRef.current).removeEventListener("scroll",this.onScroll)}};t.prototype.TranslateCSRtoJsGrid=function(e,t,n,r,i){var s,o,a,f,l,c,h,p,d={},v={},m=r.Field,g=m.length,y={},b=n.Fields,w=b.length,E=null,S=t.length,x=0,T=[],N=0,C=null,k=null,L=null,A=null,O=null,M=null,_=null,D=0,P=null==i;function H(t,r){if("string"==typeof e[r])if("?"==e[r].substring(0,1))n.AdditionalParams[t]=e[r].substring(1);else{var i=e[r].split("?");n.AdditionalParams[t]=i[1]}else n.AdditionalParams[t]=null}H("prevHref","PrevHref");H("nextHref","NextHref");function B(t,r){if("string"==typeof e[r])n.AdditionalParams[t]=Number(e[r]);else if("number"==typeof e[r])n.AdditionalParams[t]=e[r];else{u.JsGridUtil.DebugAssert(null==e[r]);n.AdditionalParams[t]=null}}B("first","FirstRow");B("last","LastRow");if("string"==typeof r.group1){N=1;k=r.group1;O=n.MetaData.GroupingPrefix;_=[];if("string"==typeof r.group2){N=2;L=r.group2}n.MetaData.GroupingLevel=N;A=n.MetaData.GridOperationalConstantsFieldKeyMap[0]=n.Columns[0].fieldKey;delete n.RecordCount;delete n.TopRecord}for(o=0;o<w;o++){"SPUser"!=b[o].propertyTypeId&&"SPUser_MultiValue"!=b[o].propertyTypeId&&"Location"!=b[o].propertyTypeId||(b[o].hasDataValue=!0);y[(a=b[o]).fieldKey]=a}for(o=0;o<g;o++)v[(a=m[o]).RealFieldName]=a;if(S>0){for(o=0,l=null;o<S&&(null==l||Boolean(l["CustomData."]));o++)l=t[o];for(s in l){h=this.TranslateCSRtoJsGridFieldName(s,v[s]);d[s]=h;null!=v[s]&&(d[v[s].Name]=h)}if("string"==typeof e.FilterLink){u.JsGridUtil.DebugAssert("?"==e.FilterLink.substring(0,1));var j=e.FilterLink.substring(1),F=new u.JsGridUtil.Internal.List_QstringStruct(j),I={};for(var q in F.filterParams){var R=F.filterParams[q],U=null,z=null;if(null!=R.FilterField){u.JsGridUtil.DebugAssert(null!=R.FilterValue);U=R.FilterField;z=R.FilterValue}else{u.JsGridUtil.DebugAssert(null!=R.FilterFields);u.JsGridUtil.DebugAssert(null!=R.FilterValues);U=R.FilterFields;z=R.FilterValues}U=d[u.JsGridUtil.Internal.UnescapeProperly(U)];z=u.JsGridUtil.Internal.UnescapeProperly(z);u.JsGridUtil.DebugAssert(null!=U);null!=U&&(I[U]=z)}n.AutoFilterState=I}}if(Boolean(e.SortField)){var W=d[e.SortField];null==W&&(W=e.SortField);n.SortState=[{fieldKey:W,isDescending:"ascending"!=e.SortDir}]}n.LocalizedTable=[];n.UnlocalizedTable=[];for(o=0;o<S;o++){l=t[o];if(Boolean(l["CustomData."]))x++;else{D++;if(N>0){var X=function(e,t,n){return O+l[e+".groupindex"+(2==n?"2":"")]+"_"+t},V=function(e,t){var r;if(P){r=e+": "+String(l[e]);if(1==t)M=O+" "+e+":"+String(l[e]);else{u.JsGridUtil.DebugAssert(2==t);M=O+" "+k+":"+String(l[k])+" "+L+":"+String(l[L])}}else{var s=document.createElement("div");if(1==t)s.innerHTML=RenderGroupEx(i,l,!0);else{u.JsGridUtil.DebugAssert(2==t);var o=l[k+".newgroup"];l[k+".newgroup"]="0";s.innerHTML=RenderGroup(i,l);l[k+".newgroup"]=o}r=u.JsGridUtil.Internal.GetInnerText(s);if(1==t)M=X(e,r,1);else{u.JsGridUtil.DebugAssert(2==t);M=X(k,r,1)+" "+X(L,r,2)}}u.JsGridUtil.DebugAssert(-1==_.indexOf(M));f={};p={ID:M,_GRPDESC:Number(l[e+".COUNT.group"+(2==t?"2":"")])};2==N&&(p._GRPLVL=t);if(2==t){u.JsGridUtil.DebugAssert(null!=C);C._GRPDESC++}else C=p;p[A]=f[A]=r;n.LocalizedTable.push(f);n.UnlocalizedTable.push(p);_.push(M);T.push(M)};"1"==l[k+".newgroup"]&&V(k,1);"1"==l[L+".newgroup"]&&V(L,2)}f={};p={};T.push(this.TranslateCSRtoJsGridField("ID",v.ID,l,y.ID).value);for(s in l){var $=v[s],J=null==$?null:d[$.Name];E=null==J?null:y[J];if(null!=(c=this.TranslateCSRtoJsGridField(s,$,l,E))&&null!=(a=y[h=d[s]])){if(a.hasLocalizedValue){u.JsGridUtil.DebugAssert(null!=c.localizedValue);f[h]=c.localizedValue}if(a.hasDataValue||N>0&&"Title"==h){u.JsGridUtil.DebugAssert(null!=c.value);p[h]=c.value}}}P||(p.csrInfo=l);n.LocalizedTable.push(f);n.UnlocalizedTable.push(p)}}if(!P)for(o=0;o<n.Fields.length;o++)(E=n.Fields[o]).csrInfo=v[E.fieldKey];n.ViewInfo=T;N>0?n.ViewDepKeys=_:n.RecordCount=D;n.AdditionalParams.last-=x};t.prototype.TranslateCSRtoJsGridFieldName=function(e,t){switch(null!=t?t.FieldType:e){case"ContentTypeId":return"_ContentTypeId";case"File_x0020_Type":return"DocIcon";case"PermMask":return"Edit"}return null!=t&&"string"==typeof t.RealFieldName?t.RealFieldName:e};t.prototype.TranslateCSRtoJsGridField=function(e,t,n,r){var i,s=n[e];if(null!=r&&("SPMultilineText"==r.propertyTypeId||"String"==r.propertyTypeId||"SPTextMaxLength"==r.propertyTypeId)){u.JsGridUtil.Internal.IsNullOrUndefined(s)||u.JsGridUtil.DebugAssert("string"==typeof s||s.constructor==String);s=u.JsGridUtil.Internal.Encoding_STSHtmlDecode(s)}var o=null!=t?t.FieldType:e;if(null==s){if(w.Killswitch.isActivated("BE461D86-69A9-4E1A-A61D-18464280F692","02/24/2020","Do not throw when fieldContents is null."))throw"CSR JSON did not contain a value for expected field "+e;return null}if(null==o)return null;switch(o){case"Boolean":return null==s||""==s?null:new Y(n[e+".value"],s);case"Computed":if("FileLeafRef"==e){u.JsGridUtil.Internal.EnsureFileLeafRefName(n);return new Y(null,n["FileLeafRef.Name"])}if("Hyperlink"==t.Format)return y(e,s,n);break;case"File_x0020_Type":return""==s?null:new Y(null,s);case"ID":return new Y(Number(s),String(s));case"Lookup":case"LookupMulti":if(""==s)return null;if("string"==typeof s)return new Y(s);var a=s,f=[];s=null;for(i=0;i<a.length;i++){var l=a[i],c=l.lookupId,h=l.lookupValue;if("Lookup"==o)return new Y(c,h);s=null==s?h:s+"; "+h;f.push(c)}return new Y(f,s);case"MultiChoice":return Array.isArray(s)?new Y(s.join("; ")):new Y("");case"PermMask":var p=0|parseInt(s.substring(s.length-8),16);n.Edit=p;return new Y(p);case"URL":return y(e,s,n);case"User":case"UserMulti":var d=n[e];s=[];var v="";for(i=0;i<d.length;i++){var m=d[i];v=""==v?m.title:v+"; "+m.title;s.push(b(m))}return new Y(s,v);case"TaxonomyFieldType":case"TaxonomyFieldTypeMulti":var g=k.Taxonomy.DataConverters.DataValueToInputValue(s,"TaxonomyFieldTypeMulti"==o);return new Y(s,g);case"Location":return new Y(s,s?s.DisplayName:"")}return null==s||""==s?null:new Y(s);function y(e,t,n){if(null==t||""==t)return null;var r=t,i=n[e+".desc"];return new Y({display:i,address:r})}function b(e){if(null==e||""==e)return null;u.JsGridUtil.DebugAssert("email"in e&&"title"in e,"caller did not pass in the right user object");return{display:e.title,email:e.email}}};t.prototype._addPageId=function(e){this.previousPageIds[this.currentPageIdx]=e};t.prototype.render=function(){for(var e=[],t=0;t<this.listSchema.Field.length;t++)e.push(r.createElement("th",{scope:"col",title:"",role:"presentation"},r.createElement("span",null)));this.dragDropMgr.subscribe();var n=this.props.flightStatus[X]&&!R,i=n?c.wrapperTable:"",s=n?c.wrapperTd:"";return this.state.isLoading?r.createElement(l.Spinner,{size:l.SpinnerSize.large}):r.createElement("div",{className:c.spGridRoot},r.createElement("iframe",{id:"spgridIframeId",title:"","aria-hidden":"true",style:{offsetLeft:"-550px",offsetTop:"-550px",display:"block",width:0,height:0,frameborder:0}}," "),r.createElement("table",{className:i,summary:"Custom list",ref:this.tableRef},r.createElement("thead",{role:"presentation",id:"js-listviewthead-"+u.JsGridUtil.privateWpq,className:c.spGridTableHead},r.createElement("tr",{role:"row",className:"ms-viewheadertr ms-vhltr"},r.createElement("th",{className:"ms-headerCellStyleIcon ms-vh-icon ms-vh-selectAllIcon",scope:"col",role:"columnheader"},r.createElement("span",{className:"ms-selectall-span",id:"cbxSelectAllItems2",title:"Select and deselect all items",role:"checkbox","aria-checked":"false","aria-label":"Press space key to select all items on this list"},r.createElement("span",{className:"ms-selectall-iconouter"},r.createElement("img",{className:"ms-selectall-icon",alt:"",src:"/_layouts/15/images/spcommon.png?rev=44#ThemeKey="})))),r.createElement("th",{scope:"col",role:"columnheader"},r.createElement("div",null,r.createElement("a",{id:"diidSort2LinkTitle",title:"Title, Click to sort by Title"},"Title"),r.createElement("span",{id:"diidSortArrowSpan2LinkTitle"},r.createElement("img",{src:"/_layouts/15/images/spcommon.png?rev=44#ThemeKey=",alt:""})),r.createElement("span",{id:"diidFilterSpan2LinkTitle"},r.createElement("img",{src:"/_layouts/15/images/spcommon.png?rev=44#ThemeKey=",alt:""}))),r.createElement("div",null,r.createElement("div",null,r.createElement("span",null," "),r.createElement("a",{href:"javascript:;",title:"Open Title sort and filter menu","aria-expanded":"false"},r.createElement("img",{src:"/_layouts/15/images/ecbarw.png?rev=44#ThemeKey=",alt:"Open Title sort and filter menu","ms-jsgrid-click-passthrough":"true"})),r.createElement("span",null)))),e)),r.createElement("script",{id:"scriptBody"+u.JsGridUtil.privateWpq}),r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",{className:s},r.createElement("div",{id:"spgridcontainer_"+u.JsGridUtil.privateWpq}))))),this._constructPagingControls())};t.prototype.updateWithRefreshedRows=function(){var e=this.props.refreshedRows;if(e&&e.length&&this.jsGridControl&&this.ganttControl){var t=new(this._telemetry(x.Qos))({name:K});try{var r={Fields:this.gridJson.Fields,AdditionalParams:n.__assign({},this.gridJson.AdditionalParams)};this.TranslateCSRtoJsGrid({},e,r,this.listSchema);for(var i=0;i<e.length;i++){var s=e[i],o=this.jsGridControl.GetRecord(s.ID),u=this.ganttControl.MakeRecord(r.UnlocalizedTable[i],r.LocalizedTable[i]);u&&!u.fieldRawDataMap&&(u.fieldRawDataMap={});u.fieldRawDataMap.csrInfo=s;if(o){o.properties=u.properties;o.fieldRawDataMap=u.fieldRawDataMap;o.fieldRawLocMap=u.fieldRawLocMap;this.jsGridControl.RefreshRow(o.recordKey)}else{var a=this.jsGridControl.GetRecordKeyByViewIndex(0);this.jsGridControl.InsertRecordBefore(a,u,null);this.rows.unshift(s)}}t.end({resultType:x.ResultTypeEnum.Success})}catch(e){var f=Q(e);t.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToUpdateWithRefreshedRows",error:f})}}};return t})(r.Component);t.default=G;var Y=function(e,t){this.value=e;if(null!=t){this.localizedValue=t;this.localizedValueSetExplicitly=!0}else{this.localizedValue=e;this.localizedValueSetExplicitly=!1}}});
define("aQ3",["require","exports","aPS","aQo","aQv","aPY","aPZ","aQw","aQA","aQ4"],function(require,exports,constants_1,gridutil_1,ColumnInfo_1,property_1,control_1,styles_1,jsgridobj_1,JSONParse_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Deserializer=(function(){function e(e,t,n){this.keyColumnName=n;this._serializedJsGridData=e;this._initType=t;this.Init()}e.prototype.InitJsGridParams=function(e){var t=null!=e?e:new jsgridobj_1.JsGridControlParameters;t.tableViewParams=this.InitJsGridTableViewParams(t.tableViewParams);return t};e.prototype.InitJsGridTableViewParams=function(e){var t=null!=e?e:new jsgridobj_1.TableViewParameters;t.operationalConstantsFieldKeyMap=this.operationalConstantsFieldKeyMap;t.gridFieldMap=this.gridFieldMap;t.paneLayout=this.paneLayout;t.keyFieldName=this.keyColumnName;t.bAutoFilterableColumns=this.bAutoFilterableColumns;null!=this.columns&&(t.columns=new ColumnInfo_1.ColumnInfoCollection(this.columns));this.isGanttEnabled&&(t.ganttParams=this.InitJsGridGanttParams(t.ganttParams));t.rowViewParams=this.InitJsGridRowViewParams(t.rowViewParams);return t};e.prototype.InitJsGridRowViewParams=function(e){var t=null!=e?e:new jsgridobj_1.RowViewParameters;t.minimalInfo=this.minimalInfo;t.hierarchyMode=!1;t.groupingLevel=this.groupingLevel;t.groupingRecordKeyPrefix=this.groupingPrefix;t.view=this.view;t.autoFilterState=this.autoFilterState;t.sortState=this.sortState;t.autoFilterEntries=this.autoFilterEntries;return t};e.prototype.InitJsGridGanttParams=function(e){var t=null!=e?e:new jsgridobj_1.GanttParameters;t.dateRange=[this.ganttInfo.StartDate,this.ganttInfo.FinishDate];t.ganttBarStyles=this.ganttInfo.Styles.barStyles;t.fieldKeyRedrawFilter=this.ganttInfo.Styles.fieldKeyRedrawFilter;return t};e.prototype.InitCellStyles=function(e){if(null!=this.cellStyles)for(var t in this.cellStyles)e.RegisterCellStyle(t,styles_1.StyleUtil.CreateStyle(styles_1.StyleType.Cell,this.cellStyles[t]));if(null!=this.groupingGridRowStyleIds){for(var n=[],r=0;r<this.groupingGridRowStyleIds.length;r++)n.push(e.GetCellStyle(this.groupingGridRowStyleIds[r]));e.groupingStyles=n}};e.prototype.Init=function(){this._initType==constants_1.JsGridConstants.DeserializationMode.Full?this.PopulateFull():this._initType==constants_1.JsGridConstants.DeserializationMode.TableView?this.PopulateTableView():this._initType==constants_1.JsGridConstants.DeserializationMode.RowView?this.PopulateRowView():this._initType==constants_1.JsGridConstants.DeserializationMode.Slice?this.PopulateIncremental():this._initType==constants_1.JsGridConstants.DeserializationMode.AutoFilter&&this.PopulateAutoFilter()};e.prototype.PopulateFull=function(){this.PopulateTableView(this._serializedJsGridData)};e.prototype.PopulateTableView=function(e){var t=this,n=this._serializedJsGridData.MultiValueSeparator;null!=e.LookupTableInfo&&(function(e){for(var t=0;t<e.length;t++)property_1.PropertyType.RegisterNewLookupPropType(e[t].id,e[t].lookup,e[t].showImage&&e[t].showText?control_1.DisplayControlType.ImageText:e[t].showImage?control_1.DisplayControlType.Image:control_1.DisplayControlType.Text,e[t].limitToList)})(e.LookupTableInfo);(function(e){t.gridFieldMap={};for(var r=0;r<e.length;r++){"SPUser"!=e[r].propertyTypeId&&"SPUser_Multi"!=e[r].propertyTypeId&&"Location"!=e[r].propertyTypeId||(e[r].hasDataValue=!0);var i=e[r],s=new ColumnInfo_1.GridField(i.fieldKey,i.hasDataValue,i.hasLocalizedValue,i.textDirection,i.defaultCellStyleId,i.editMode,i.dateOnly,i.csrInfo);i.multiValue&&s.SetIsMultiValue(n);s.SetSingleValuePropType(null!=i.propertyTypeId?property_1.PropertyType.Internal.Property.GetInstance().GetPropType(i.propertyTypeId):null);t.gridFieldMap[s.key]=s}})(e.Fields);(function(e){t.columns=[];for(var n=0;n<e.length;n++){var r=e[n],i=new ColumnInfo_1.ColumnInfo(r.name,r.imgSrc,r.columnKey,r.width);i.isVisible=r.isVisible;i.isHidable=r.isHidable;i.isResizable=r.isResizable;i.isSortable=r.isSortable;i.isAutoFilterable=r.isAutoFilterable;i.imgRawSrc=r.imgRawSrc;i.customFormatter=r.customFormatter;i.ascendingString=r.ascendingString;i.descendingString=r.descendingString;i.isFilterable=r.isFilterable;i.fieldType=r.fieldType;i.internalName=r.internalName;i.isEditable=r.isEditable;i.isCalculated=r.isCalculated;i.customFormatter&&(i.fnGetDisplayControlName=function(){return control_1.DisplayControlType.CustomFormatter});t.columns.push(i)}})(e.Columns);null!=e.PivotedColumns&&gridutil_1.JsGridUtil.DebugAssert(!1,"Uh oh!  We removed pivoted columns...");this.paneLayout=e.PaneLayout;this.ganttInfo=e.GanttInfo;this.bAutoFilterableColumns=e.AutoFilterableColumns;this.PopulateRowView()};e.prototype.PopulateRowView=function(){this.view=this._serializedJsGridData.ViewInfo;this.autoFilterState=this._serializedJsGridData.AutoFilterState;this.sortState=this._serializedJsGridData.SortState;this.cellStyles=this._serializedJsGridData.CellStyles;this.groupingGridRowStyleIds=this._serializedJsGridData.GroupingGridRowStyleIds;this.autoFilterEntries=this.DecompressAutoFilterEntries(this._serializedJsGridData.AutoFilterEntries);this.PopulateIncremental()};e.prototype.PopulateIncremental=function(){null!=this._serializedJsGridData.MetaData&&this.PopulateMetaData(this._serializedJsGridData.MetaData);if(null!=this._serializedJsGridData.LocalizedTable&&null!=this._serializedJsGridData.UnlocalizedTable){var e=this._serializedJsGridData.LocalizedTable,t=this._serializedJsGridData.UnlocalizedTable;this.viewDependentKeys=this._serializedJsGridData.ViewDepKeys;gridutil_1.JsGridUtil.DebugAssert(e.length==t.length);this.data={};for(var n=0;n<t.length;n++)this.data[t[n][this.keyColumnName]]={data:t[n],localized:e[n]}}this.additionalParams=this._serializedJsGridData.AdditionalParams;null!=this._serializedJsGridData.RecordCount&&null!=this._serializedJsGridData.TopRecord&&(this.minimalInfo={topRecord:this._serializedJsGridData.TopRecord,recordCount:this._serializedJsGridData.RecordCount})};e.prototype.PopulateAutoFilter=function(){this.PopulateMetaData(this._serializedJsGridData.MetaData);this.autoFilterEntries=this.DecompressAutoFilterEntries(this._serializedJsGridData.AutoFilterEntries)};e.prototype.PopulateMetaData=function(e){switch(this._initType){case constants_1.JsGridConstants.DeserializationMode.Full:case constants_1.JsGridConstants.DeserializationMode.TableView:this.isGanttEnabled=e.IsGanttEnabled;this.operationalConstantsFieldKeyMap=e.GridOperationalConstantsFieldKeyMap;this.keyColumnName=e.KeyColumnName;case constants_1.JsGridConstants.DeserializationMode.RowView:this.groupingLevel=e.GroupingLevel;this.groupingPrefix=e.GroupingPrefix;this.isGrouped=0!==this.groupingLevel;this.isSorted=e.IsSorted;default:this.recordKeyHash=e.RecordKeyHash;this.recordKeyOrderChanged=e.RecordKeyOrderChanged}};e.prototype.DecompressAutoFilterEntries=function(e){if(null!=e)for(var t in e)for(var n=e[t],r=0;r<n.length;r++)1===n[r].displayString&&(n[r].displayString=n[r].dataValue);return e};return e})();exports.Deserializer=Deserializer;function DeserializeFromJson(e,t){t||(t={});"guid"in t||(t.guid=function(e){return'"'+gridutil_1.JsGridUtil.GuidManager.prototype.GetIndexForGuid(e)+'"'});for(var n in t)e=EvalFunctionCallsInJson(e,n,t[n]);gridutil_1.JsGridUtil.DebugAssert(null!=e&&""!==e,"Null or empty parameter to deserialize");try{return JSONParse_1.JSONParse(e)}catch(e){throw e}}exports.DeserializeFromJson=DeserializeFromJson;function EvalFunctionCallsInJson(jsonText,prefix,fn){var unescapedQuoteRegEx='([^\\\\])\\"',regEx=unescapedQuoteRegEx+Escape(prefix)+"<;>(.+?)"+unescapedQuoteRegEx;return jsonText.replace(eval("/"+regEx+"/g"),function(e,t,n,r){var i=fn.apply(null,DeserializeEncodedArray(n+r));return t+(null==i?"":i)});function DeserializeEncodedArray(e){for(var t=e.split("<;>"),n=0;n<t.length-1;n++)t[n]=Unescape(t[n]);return t}function Unescape(e){return e.replace(/;;/g,";")}function Escape(e){return e.replace(/;/g,";;")}}exports.EvalFunctionCallsInJson=EvalFunctionCallsInJson});
define("aPS",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.SPGPermissions={addListItems:2,editListItems:4,deleteListItems:8};e.DeserializationMode={Full:0,TableView:1,RowView:2,Slice:3,AutoFilter:4};e.SelectionTypeFlags={NoRows:0,SingleRow:1,SingleRowRange:3,MultipleRowRanges:7,_RowMask:7,NoCols:0,SingleCol:8,SingleColRange:24,MultipleColRanges:56,_ColMask:56,NoCells:0,SingleCell:64,SingleCellRange:192,MultipleCellRanges:448,_CellMask:448};e.LinkType={FinishFinish:0,FinishStart:1,StartFinish:2,StartStart:3};e.ClickContext={SelectAllSquare:0,RowHeader:1,ColumnHeader:2,Cell:3,Gantt:4,Other:5};e.SelectionType={None:0,CellRange:1,RowRange:2,ColumnRange:3};e.EventType={OnCellFocusChanged:0,OnRowFocusChanged:1,OnCellEditBegin:2,OnCellEditCompleted:3,OnRightClick:4,OnPropertyChanged:6,OnRecordInserted:7,OnRecordDeleted:8,OnRecordChecked:9,OnCellErrorStateChanged:10,OnEntryRecordAdded:11,OnEntryRecordCommitted:13,OnEntryRecordPropertyChanged:14,OnRowErrorStateChanged:15,OnDoubleClick:16,OnBeforeGridDispose:17,OnSingleCellClick:18,OnInitialChangesForChangeKeyComplete:19,OnVacateChange:20,OnGridErrorStateChanged:21,OnSingleCellKeyDown:22,OnRecordsReordered:23,OnBeforePropertyChanged:24,OnRowEscape:25,OnBeginRenameColumn:26,OnEndRenameColumn:27,OnPasteBegin:28,OnPasteEnd:29,OnBeginRedoDataUpdateChange:30,OnBeginUndoDataUpdateChange:31};e.DelegateType={CreateRecords:0,ExpandColumnMenu:1,AddColumnMenuItems:2,Sort:3,Filter:4,InsertRecord:5,DeleteRecords:6,IndentRecords:7,OutdentRecords:8,IsRecordInsertInView:9,ExpandDelayLoadedHierarchyNode:10,AutoFilter:11,ExpandConflictResolution:12,GetAutoFilterEntries:13,LaunchFilterDialog:14,GetRecordEditMode:16,GetGridRowStyleId:17,CreateEntryRecord:18,TryInsertEntryRecord:19,WillAddColumnMenuItems:20,NextPage:21,AddNewColumn:22,RemoveColumnFromView:23,ReorderColumnPositionInView:24,TryCreateProvisionalRecord:25,CanReorderRecords:26,AddNewColumnMenuItems:27,TryBeginPaste:28,AllowSelectionChange:29,GetFieldEditMode:30,GetFieldReadOnlyActiveState:31,OnBeforeRecordReordered:32,EditColumn:33};(function(e){e.EventType={OnRowHeaderStateChanged:0,OnGridDisposing:1,OnChangeKeyCreated:2,OnChangeKeyInitialUpdateFinished:3,OnBeforeRecordInserted:4,OnBeforeRecordDeleted:5};e.DelegateType={CallAsyncFn:0,GetLocalizedString:1,DoLargeTask:2};e.LoadErrorState={};e.MinColumnWidth=110;e.RowHeaderWidth=25;e.ColumnHeaderHeight=42;e.RowHeaderWidthNewStyles=58;e.SplitterWidth=6;e.IconColumnWidth=30;e.IconColumnNewWidth=40;e.ColumnWidthOffset=20;e.zIndex={editor:20,selectionFrame:25,expandableEditorsZIndex:30,stickyZIndex:50,tableHeader:35};e.fixedRowHeight=46;e.wellAndFlyoutOffset=20})(e.Internal||(e.Internal={}));e.OperationalConstants={HierarchyMain:0,HierarchyOutlineLevel:1,GroupingOutlineLevel:2,HierarchyDescendantCount:3,GroupingDescendantCount:4,GanttDependants:5,GanttBarStyleIds:6,GridRowStyleId:7,RecordEditMode:8};e.RecordIndicatorCheckboxColumnKey="JsGridRecordIndicatorCheckboxes";e.NewRowKeyPrefix="NewRowKey";e.ErrorWidgetId="ErrorWidget";e.RecordIndicatorControlId="DISP_RECORDINDICATORCHECKBOX";e.HierarchyControlId="DISP_HIERARCHY";e.TextDirection={Default:0,RightToLeft:1,LeftToRight:2};e.PaneId={MainGrid:0,PivotedGrid:1,Gantt:2};e.PaneLayout={GridOnly:0,GridAndGantt:1,GridAndPivotedGrid:2};e.EditMode={ReadOnly:0,ReadWrite:1,ReadOnlyDefer:2,ReadWriteDefer:3,Defer:4};e.GanttDrawBarFlags={LeftLink:1,RightLink:2};e.GanttBarDateType={Start:0,End:1};e.ValidationState={Valid:0,Pending:1,Invalid:2};e.HierarchyMode={None:0,Standard:1,Grouping:2};e.EditActorWriteType={Both:1,LocalizedOnly:2,DataOnly:3,Either:4};e.EditActorReadType={Both:1,LocalizedOnly:2,DataOnly:3};e.EditActorUpdateType={Committed:0,Uncommitted:1};(function(e){e[e.Ascending=1]="Ascending";e[e.Descending=-1]="Descending";e[e.None=0]="None"})(e.SortMode||(e.SortMode={}));e.RowHeaderStyleId={Transfer:"Transfer",Conflict:"Conflict"};e.RowHeaderAutoStyleId={Dirty:"Dirty",Error:"Error",NewRow:"NewRow"};e.RowHeaderStatePriorities={Dirty:10,Transfer:30,CellError:40,Conflict:50,RowError:60,NewRow:90};e.UpdateSerializeMode={Cancel:0,Default:1,PropDataOnly:2,PropLocalizedOnly:3,PropBoth:4};e.UpdateTrackingMode={PropData:2,PropLocalized:3,PropBoth:4};e.ImagesDirectory="/_layouts/15/images/";e.UserAction={UserEdit:"User Edit",DeleteRecord:"Delete Record",InsertRecord:"Insert Record",Indent:"Indent",Outdent:"Outdent",Fill:"Fill",Paste:"Paste",CutPaste:"Cut/Paste"};e.ReadOnlyActiveState={ReadOnlyActive:0,ReadOnlyDisabled:1};e.ChangeType={Insert:0,Level:1,Prop:2,Delete:3};e.UnitTicks=[6e4,36e5,864e5,6048e5,864e6,2628e6,7884e6,15768e6,31536e6];e.NormalizedTouchTypes={touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",touchcancel:"touchcancel"};e.SPCalendarType={none:0,gregorian:1,japan:3,taiwan:4,korea:5,hijri:6,thai:7,hebrew:8,gregorianMEFrench:9,gregorianArabic:10,gregorianXLITEnglish:11,gregorianXLITFrench:12,koreaJapanLunar:14,chineseLunar:15,sakaEra:16,umAlQura:23};e.MouseButton={leftButton:0,middleButton:1,rightButton:2};e.Key={backspace:8,tab:9,enter:13,esc:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,del:46,shift:16,insert:45,six:54,windows:91,numpad_plus:107,numpad_minus:109,F2:113,F6:117,plus:61,comma:188,minus:109,dot:190,back_slash:220,IMEInput:229};e.DialogResult={invalid:-1,cancel:0,OK:1};e.SUPERTEMPORARY_defaultCultureStringify='{"name":"en-US","numberFormat":{"CurrencyDecimalDigits":2,"CurrencyDecimalSeparator":".","IsReadOnly":false,"CurrencyGroupSizes":[3],"NumberGroupSizes":[3],"PercentGroupSizes":[3],"CurrencyGroupSeparator":",","CurrencySymbol":"$","NaNSymbol":"NaN","CurrencyNegativePattern":0,"NumberNegativePattern":1,"PercentPositivePattern":0,"PercentNegativePattern":0,"NegativeInfinitySymbol":"-Infinity","NegativeSign":"-","NumberDecimalDigits":2,"NumberDecimalSeparator":".","NumberGroupSeparator":",","CurrencyPositivePattern":0,"PositiveInfinitySymbol":"Infinity","PositiveSign":"+","PercentDecimalDigits":2,"PercentDecimalSeparator":".","PercentGroupSeparator":",","PercentSymbol":"%","PerMilleSymbol":"‰","NativeDigits":["0","1","2","3","4","5","6","7","8","9"],"DigitSubstitution":1},"dateTimeFormat":{"AMDesignator":"AM","Calendar":{"MinSupportedDateTime":"@-62135568000000@","MaxSupportedDateTime":"@253402300799999@","AlgorithmType":1,"CalendarType":1,"Eras":[1],"TwoDigitYearMax":2029,"IsReadOnly":false},"DateSeparator":"/","FirstDayOfWeek":0,"CalendarWeekRule":0,"FullDateTimePattern":"dddd, MMMM dd, yyyy h:mm:ss tt","LongDatePattern":"dddd, MMMM dd, yyyy","LongTimePattern":"h:mm:ss tt","MonthDayPattern":"MMMM dd","PMDesignator":"PM","RFC1123Pattern":"ddd, dd MMM yyyy HH\':\'mm\':\'ss \'GMT\'","ShortDatePattern":"M/d/yyyy","ShortTimePattern":"h:mm tt","SortableDateTimePattern":"yyyy\'-\'MM\'-\'dd\'T\'HH\':\'mm\':\'ss","TimeSeparator":":","UniversalSortableDateTimePattern":"yyyy\'-\'MM\'-\'dd HH\':\'mm\':\'ss\'Z\'","YearMonthPattern":"MMMM, yyyy","AbbreviatedDayNames":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"ShortestDayNames":["Su","Mo","Tu","We","Th","Fr","Sa"],"DayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"AbbreviatedMonthNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"IsReadOnly":false,"NativeCalendarName":"Gregorian Calendar","AbbreviatedMonthGenitiveNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthGenitiveNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"eras":[1,"A.D.",null,0]}}';e.SUPERTEMPORARY_invariantCultureStringify='{"name":"","numberFormat":{"CurrencyDecimalDigits":2,"CurrencyDecimalSeparator":".","IsReadOnly":true,"CurrencyGroupSizes":[3],"NumberGroupSizes":[3],"PercentGroupSizes":[3],"CurrencyGroupSeparator":",","CurrencySymbol":"¤","NaNSymbol":"NaN","CurrencyNegativePattern":0,"NumberNegativePattern":1,"PercentPositivePattern":0,"PercentNegativePattern":0,"NegativeInfinitySymbol":"-Infinity","NegativeSign":"-","NumberDecimalDigits":2,"NumberDecimalSeparator":".","NumberGroupSeparator":",","CurrencyPositivePattern":0,"PositiveInfinitySymbol":"Infinity","PositiveSign":"+","PercentDecimalDigits":2,"PercentDecimalSeparator":".","PercentGroupSeparator":",","PercentSymbol":"%","PerMilleSymbol":"‰","NativeDigits":["0","1","2","3","4","5","6","7","8","9"],"DigitSubstitution":1},"dateTimeFormat":{"AMDesignator":"AM","Calendar":{"MinSupportedDateTime":"@-62135568000000@","MaxSupportedDateTime":"@253402300799999@","AlgorithmType":1,"CalendarType":1,"Eras":[1],"TwoDigitYearMax":2029,"IsReadOnly":true},"DateSeparator":"/","FirstDayOfWeek":0,"CalendarWeekRule":0,"FullDateTimePattern":"dddd, dd MMMM yyyy HH:mm:ss","LongDatePattern":"dddd, dd MMMM yyyy","LongTimePattern":"HH:mm:ss","MonthDayPattern":"MMMM dd","PMDesignator":"PM","RFC1123Pattern":"ddd, dd MMM yyyy HH\':\'mm\':\'ss \'GMT\'","ShortDatePattern":"MM/dd/yyyy","ShortTimePattern":"HH:mm","SortableDateTimePattern":"yyyy\'-\'MM\'-\'dd\'T\'HH\':\'mm\':\'ss","TimeSeparator":":","UniversalSortableDateTimePattern":"yyyy\'-\'MM\'-\'dd HH\':\'mm\':\'ss\'Z\'","YearMonthPattern":"yyyy MMMM","AbbreviatedDayNames":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"ShortestDayNames":["Su","Mo","Tu","We","Th","Fr","Sa"],"DayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"AbbreviatedMonthNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"IsReadOnly":true,"NativeCalendarName":"Gregorian Calendar","AbbreviatedMonthGenitiveNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthGenitiveNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"eras":[1,"A.D.",null,0]}}';e.SUPERTEMPORARY_spcommonThemedData="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ8AAAEMCAYAAADauzOQAAAgAElEQVR4Xuy9e3xV1Zk//Ky1Ey4FL9ChPztarL46SlI70jDy4tgWBSxBRgQMddQkUMg+yFvHhFTUV4EQ5VXBXBh9gezAAIk6lnARqoRKUKiO/mrNaIcmlMGP7SjMOHXKxVIDSfZ6fp9nnb0P+5zs67mEBPf+R8zZez1rPWvt717ruXwfBuEVaiDUQKiBJDTAkngmfCTUQKiBUAMQgke4CEINhBpISgMheCSltvChUAOhBkLwCNdAqIFQA0lpIASPpNQWPhRqINRACB7hGgg1EGogKQ2E4JGU2sKHQg2EGgjBI1wDoQZCDSSlgRA8klJb+FCogVADIXiEayDUQKiBpDQQgkdSagsfCjUQaiAEj3ANhBoINZCUBkLwSEpt4UOhBkINsNdffx1DNYQaCDUQaiCoBsKdR1CNhfeHGgg1IDUQgke4EEINhBpISgMheCSltvChUAOhBkLwCNdAqIFQA0lpIASPpNQWPhRqINRACB7hGgg1EGogKQ2E4JGU2sKHQg2EGgjBI1wDoQZCDSSlgRA8klJb+FCogVADIXiEayDUQKiBpDQQgkdSagsfCjUQaiAEj3ANhBoINZCUBkLwSEpt4UOhBkINhOARroFQA6EGktJACB5JqS18KNRAqIEQPPrxGvjoo4/wyiuvTP8cTqm4BFC/HRi7HRAuAYDrDDUdAAafAuJOYMpO2FXxaUrqm73hEtDZ7cD47YCYIId9Cih2goI7YeOc1OSk1Mm++fAf9j/+ACKuYBwGMIClI763pLK3e5r+hdfbI/iSyiPg+P3vfw/f/OY3IW0Akv/ICIDsZQCgAoDioVodADSArqXQ/ORngaZhzj+NgG4lmJwsfSls+FEwOQCwcOHC2xGxUAhxk6IoBFCg6/qnnPO3GGON1dXVOwP1vQ/c/On+x68Aph/mwGNzxDi7dsRNiw+lu3uqql5EbWqadjKx7RA80q3tXmjPBI6bb74Z3njjjfQAyJSKyYDiJQCQiwUQdwODV4HDO9DNowsnS1wEAsYBwm3A2GRjqCeB8btgV8VuX0O/d8Nk4MpLgBiVA2w3IL4KCr4DuhKVo+gXgc7GAWO3AWBUDmMnQeh3wfNzfMkpKyuj3dIGABjOGFuPiHsURZHgo+v6CMbYJACYjYgkc05NTc0BP/1fsGDBJbqur0bE6cb9pwBg4/Hjx8ubmpo6/bSR6j3/vW/ZJMbZa9Z2GODU5duOPyynKSvrqWeeeebVVOQUFBQow4YNawCAu412Go8fPz6nqamJPhrRKUlFQPhs72vAChym9JQBZPKSucCgztht7AHGF8Guig9cRzel4npAsQIA6CXUASECuyvXuz5T2DAXAA05uAcUXAQb57jLmb3hetDZCgD5susALAKNRa5yysrKJjPGmoQQGmPssZqamg67fpWVlQ1GxCc45yoiFtTU1HgCUyQS2YuItwBAI2PsLUS8CQAKox9nLeJrRRRuilJ/Nhbbv38ev//3m8umM2Tb4sAD4Z4/X140sa2t7arXX389R9f1Fl3X73/22Wd97dYSdxiqqt4HAKutMhBxTn19/cYQPHzNct+6yQ44UgaQKUsmAUKzARzLobnysUCjzl/yBAA8Kl9sBvmwq3KP7fP3Nk4CJgw5uBwaZweTU7jxCQAWlYM8H54vtJVDOw7G2D7OecEzzzzzup+x/OQnP7lFCNGEiOPddiAFBQUDhg0bdgYAdmualm+2rarqPgDI0TTta37kgQkOdgDi9pvR+B9+UbEBgM+Ok4WwfcT3Fj+l63rVmTNnvr127dpff/LJJ99WFOX+qqqqRqd+Oe0whg0bVgsAP04Aj+r6+vryEDx8zXLfuckNOJIGEGkYFb+NHlVYJTQvW5rUiM8CCB1hru1hSCXDqFB+Gz2qYCU0zk5OjgkgdITh+rV2htTy8vL3hRDra2pqnvMay4IFC4YOGDDgutra2ncWLlx4H2NMraqqGu30nPF1PgEAL2qado8FPF4BgJs0TbvYS2bsdzuQ8AMc+x9/ABjSi93zYuyxr3138XJd12k39WhbW9uvGxoaLuzs7NxeW1sbe+mtDzrtMDjnpxCxKQE8ptXX18dsROGxxfdsn7sb/QBHUgCSv4S2pbQ93QPNlbemNML8JXQGp6PFGmiuXBDXVuEmQw7ugcbZqckp3PiacYRZA43FcXLKysqmc86f/Pjjj3OtZ3O7cVVUVAw4efJkM2PsFkS858iRIz+97LLL/g0A6Jiz3e4ZVVXpyEXGZKfL/9GFWrCChbVFp+OM5Z5jb1WM7Bb8P+hPWVxcPvymio8RcaQQ4kHOeWzHsGvXLn3Pnj2namtrbYFNVdVnnXYYqqqSDeUBQ+wqTdOesnYzBI+U3pjMPxwEOAIByNRHLwVd+UgeVxgf42nj8Bpq1AbynrxN0S+HV5Yflf8u2nQpIETlKGKMp43DS460gfCoHAaXQ0NxVE7Us/ICY+xAVVVV3CK3a5LuNYyBnyHijTU1NR8uXLhwIQDkVVdXx3YV1mdVVbWWKVmp6/pTnPMVjLG55n2apgV7pxIBxAdwLFy4EKurq9lnb1ZKIPuLmxa/KIQ4zDmX3iS6dF2HpqYmOHLkCBw9evSkE3hEIpE77XYYjLFLAeB2Op7R0Wb48OGvIeIWTdPWmDKCDdRrYsPf06qBZIDDN4BMXvwwMPak9Kjsqpxq2/Epi+8GZGRxJ5fgKWlr2F3xluMg8xfvAKDYEHwEdj8efYGLGh4GxCeBsVehocheTvS+mwCRbCJDo4ZRKILG4hdtZRVt2gEIFIfyCDQUxYBi4cKFf2CM5VdVVbW6TcTChQvNr22HYed4l+4vLy/PQ8Tm6upqW9uFFTwYY7fW1dXtiUQiZGylHYm8egs8Vq5cuRwARpDMjo6OIUOGDIkB3hdffAEbN24Exhj86Ec/gocfftgRPOj5xB0GY6wVEU1vzj2IqDAm1wG1WV5XV1ct/53W1R42ljYNpAIcvgBk8uJmw926AJorY1+T2ACmLCkElK5Of8BBD0a9Nuukm3f341GDYmFDs3S3Ii6A52f3lGPVWNEmcgPTonUHkKjXZp108zYWSTnkOWGMfdHV1fU108OwcOHCHyqKsn/lypWxILPy8vKHkcAs+iIUVFVVbTG7cP/994/Izs7+AyJ+xc5Dk7DzOKpp2mWqqv6R3MFJgUeSxxbaeVRVVcV2F7/61a96rLu/+Zu/gYKCAlAUhXTjCB6GzSNuhwEALwshhjHGKBaHvDUE5uau5pCmadeG4JG2Vz29DaUDODwBJH/JEQC4FAQbCz9fJr+8DsBxEhDzYffj73iO8gdLbwCOvwSAo9BceVkUPDZF5TAYCw3F8XLsGiQAAdZsxIGQa3YeNBbF3IPykaJNNwBCVE5jsZSTCB7l5eVyR0ABYdnZ2feQ56WsrOxuxhgdVwg4Hkk83gQED7nLSAAU/zuPJA2m1HcTPDznw7jBCTwikchCRKwybuuxw6AdBwCQO956xTxN4c7D7wz00n3pBA5XAMlfQi7HAZDFL4efVXwcN7z8Jd0+IkyjjzRXnl1Df1cxEroFGfE6oblyoAEeUTmMXQ4NRWflOH11e+pZh8birLg/FzWMBMSonMbiqJzoS/VHOk7QsYWOIN3d3a8YUaU6xXwAwFzO+QAhxJra2tp4o27AY4vTcvB1bEnRVZsu8FBVlTxt1xhj6bHDyMrKGtPd3f2m8TtFr35IAWirV6+mwLjw2NJLmOBLTCaAwxFA3MHDf/3izINHz2AqZ/CIM5iWlZVdBQCvMcauMPUghNh59OjRGXbeGB8G0x6eCevEMsYq6+rqvN3QKQaJpRE8yMZkRgonrtG4WBa7BRzuPHy91r1zExUdp5DzTF0UiXrLLbdE59zt2DJ58WxgbJ2x++gA5Le6GkrNDqfl2CINp2T3GGxElPo6tlAXyFULAE8cOXLk2yY4PPjgg5cIIZoR8XoAeNcwkPaIOCWPgperNlPzErRdAo8gzwghbG0eFOfS3d1N7lgCWXMH0mOH4SQrBI8gs3A+3Xs2LsPeYJoMgJgGU2vciBmX4ctg6gM4aA5iBtOecSMUJIaIWnV1dcw4awSDPavr+iKncG0/QWLn0/SnYywheKRDi/2xDV+u2oAel7S6atkcaCyyD6t2cNUau4/rEPHNrKysGekOT++P05zJPofgkUnt9uW244LEcDTsetxXVqnjkKYsvg6QvS9/dwoSE2I0vDAnNTn3bLgOOI/KSQgSM/v2k5/85DbKVSHDqM/EuPuMXJiUMlH78nRnom8heGRCq/2lTTM83RqXkWzfz8aNuISnn43LSFZMLG6EwuATwtOtbZK3BQDIbkOZs42Uki+EIB4Pilm4lFLyGWOUDUv2j3legWVJ9/c8frD/g0fB5sEwuOM26Bj8KjTNsk29Po/nL7WhpS0xbukyAFwCAJlOjFsGwJZIbg+HxLhEhRAZEPF2AMD3LcFcxwBgP/Fw9AUyoEgkQjlBQBGrqU1o7z7dv8GjcBMRlVC04EgAoBiCRxxDmntXr/1HWpQEiLJCKSAoxZR8PtWRFIhIgBg35KSaki+m+iUFysREqKpKdpUljLFxMgAO4CgiUhAdrUO6FtXX1xM4eV5GSrzM1Tl+/PgYr4Q+zwZTvCEx6M2uOTOWpX+CRzTCkHzuN9gM7l1gcL+vaMYUFX3ePN6DDAjLPW0g+RU5AIJSw5MnAxJY7mkDuef5HODdtUHIgDI1Lwafx4MAQLss2iXsR8QPGWPk6qSPmEkL+KmmaV/304+SkpJCM7EOEdfX19c7cm/4aS/Ve85f8IgGB9EkmdRobrp60Uicio+eTFW75+vz0R0I8TdQXgkZI1+VRMccWoFH6ftA6CNAQJ5BjHyboYpTwHhBIBpCxi1y2KuS6JjkII/KYcKQI4mRz8pBUXCOdxxERkQh3fPq6+vj0vZVVY2G4UcvmffitVQopP7Pf/7zYSFEEd3LOW8YMmTI1U7MZ3btlZaWXs85f9uIi4lOkxCdiqJMqKqqck5idOicCR7m7oL+3/pveqx/7TwKNg+FQV88DMAoZZqCh/xeHQBYDae/8hQ0zZIhteHlooGoDYS+qj4JkNl6YGxpYBZ1yZrOg8lR9KV9gUWdYkbM8GyrJiORyGREpERCypuZU1dX50lpaGSzTtY0bTw9Z1Ac7knkzfBasxQcx9hZWsLEhD+n5912GecHeEQDgojqLsZV4KVMm98/BWCPeXFfJtHu+fmIdOPy6QbRMaV9k+eCrlZA/EzuShSxPcbZkawWiOtDwHSD6DheDrDPJDEyh+1Wzo6gotLBnl5SUkLGVjNBzNOeoarqTYyxO+vq6krN/hrZq9cbR5yLEJGOOhcJISasW7dO0iXOmzfvFs75XjI8M8Y+pP/SsQgAPrDyaCTqIBPg4abnvr/zKGz4PiDWAgMKK07PhfABMFYKjUW+jFnpERq2ci40kE72dFVV/8vy8fK0Zxh2jCetRxcCIMYY5ZKsEkJsycrK+nTt2rUxIiOrjoihvbOz81LO+Z3E5IWI+W4GWIqOTSArXmCNsPXaeSQeS7zmq++Cx72NVwGIFcDApLb3Gkvw3xG2A/BF8HwhoXp4nWcacGJPLy0tHacoimLaAvyypwe1Zxg7iGZN02IZv6TiSCQyDhHJ47TS62hiHGkeZIxNraurc6RDMAifqU3T02PWpZlWU1PjSoFgZ98wl0L/OractWuQNXtAL6znTkBYBWcGV4b2kARt91IlN6MGChVlup0xdgkiysp0RCWIiJ8yxnYqirJz9erVvivGObGnG4BCX35AxBlWnlIv9nTDnkGlDug44WnPsNt5WI4vNEbK9N197NixSGKtF/LoDB8+vA5R1qu5VdM014jc0tLSNznnVP4h8TpQXV39bbf36PyweaTHrpEs3oT2EFNzvVTJbc6cOcTYFahiXFdX19INGzZ41iBxYk83AILsCXRNSwwO80qMU1WV0v0H19XVzfBaaCUlJU2MsU4rw7r1mUgkkoOIbQBwuaZpcd5AVVVpB/ERY+zbdXV17V6yzN9LS0urOOfkUFhfXV09z89zftyydu30jWNLJuwafrRmd8+X3R7SS5XcjK/42cp0AOSVeFUI8Y5RvY12HhdxzikAi9y0scp0jLG73LwYXuzpdGxhjA2oqanpYfPySsknIygAEDHOVE3THHNgVFWlPtMx4ruaptm6Sg3S4Qc0Tfuu3VJUVfVNxthzdXV1P/W7nE2WNHIj19TUuBffMhp1O7a4yT234NEbdg2/Wk+878toD+mlSm6RSGSuQRasUK6JEYnpWjGupKSEDObEUC6D0Rhjkbq6OtuXw409nVysgwcPlvFBF1xwwcaKiooepSF9kAER0THZ4uZYAcTqjTGIh7a7VY9TVZXAkzwoT82fP/9SRKSARwLN+8mIatg7rtc07S6/y/iBBx64RlGU3zLGxvjN0+lf4FFQdxEMHLQEmKxE1Rt2Db+6T7yP7CHPwZnTldAU6VHgN9lG++RzvVTJjfI3iJncDIPXNC1QxThVVWOV6Ygh3S4PxI09/YEHHhipKIqsc5KdnX3x008/3WNevdjTjQhTik8hAp1XjYjQnQnemFPHjx//qlPdWiMw7I9U7oHybYhkmNoxwIPAlZjI9jPG3h4yZMhX/QaM0c7pG9/4xn998sknX/cb4t4/ji0FmxUY+IUKjNECiDFN98mXKb5TxwDxMTjzFQ2aZsUK/PaDfvvrYi9VciPDaHd3t6xM55uqz2YEFgA5mZWVda3VkGrHnm5twg94eBEgm+0Zu6FHGWNDqa5JEG+MeawxyhucYowtMG0bhi1kNbWLiBRb43pE8jfJznf1ffCQCVGsCoDlpDrYc/c8tgNi+bkMjc7I2HupkpuqqrJiHB1V6uvrU6oYV1JSQp4KWZlO07QYiXFvgkfiXASJLjV0QUefck3TbOvSqKpKxytiNafjTw+i5oyshSQazXxinH+W7CS638uP+Kjm1cs9Sl5cL1VyozO9EEJWjEPEMfX19a42Dq8B0VefMSazUDnnl1sDrazs6Ynt+Nl5eB1bvPrm53fahVEBLbsQd+vzZKOhPKMgbmo/8tN5TwgeQbR5XoGHj0puUcqDsxXjGMuHhiLnZCsbekDD+EfJjK9qmuZYMc7wZsRVjHP5Mu+gUohEwWANtnIzmPoBDy+DaZCl8mW4NwSPILN8PoGHVyW3woZCAJnoFa0Y5wUcpEebSm6qqpr0/gvc8jPocSMCM65inB2AGF4bYgmLKw9gx55uTq8XeHi5aoMsky/LvSF4BJnp8wo8XCq5WYGDWLsA86Gh2LtinE0lN9OYyDkfu3btWs+KcQaAEOBcRK5ZI/09rmLc/PnzbxBCyIpxianvduzpNMVe4OEUJKaqKvGlJpNfRa7Y0UGWV2/em6yxlPrYe3Ee55PNIzq7h4DBIUC2HQZ07oT184jSrv9dhZvsK7nJHcQm/xXjrIBqU4xJVdWonIRoygCLV9c0La5inBGFKSvGJeaPUHi6HXu6G3i4hadb+SyCTHKyz/mRcWTRZSrqYgVwTgDreQkE8uosGrnyk1g5imT7Z30u3Hl4qt7lBvoqI6yE04Oq+x1/qjt4+C8qlHnw6FH/1Q08aLbSyZ6ejpfM7xIzYkAohJ4Y8u53OuZ9Uv6XJ/wChymbAOTyZ45cYP5/kHGRPcqMlg3Bw+9sAvwUGPwUsrv2x3YYlP+hK8TvQFXkyWgHQKHtnE2Lq8XqX8a5udOtAHVhw+xoFXpp7+gAxm51NZSaI0jDscUwnMYqxgU9tphdSRd7epCXzDqRQZ8j4Dhx4sTQ7OxsGjsdk05qmnax3eL45MHLJLhftuIT+XPXp7+FM7/7FXS8vx3O/P5XjuvpGyuPxDYLfvtnZAiTe3wn5fWE4OH9ur4LQpkDL9zrnpg0e8P1IJQGiGaDfgqMjc0EgFiCo5abkZl+/+Y4VK9KbskAiE0lN0tchqfB1A9w0HhMg6mfuJFU2dP9vmSJeg7ynBG5ug0RO7q7uxcYAHLIKTzdBI+v/T8vAygDIGv4N4B/JYozpw/tg+NbHwb9RE+qkKDgYQT3kc2H3MtEI7AoBA838EDYAmcGF/k+hkSpBLZJgl7GDkDHoBvTneKvquqfDG7RU5qmya2n3785DrXIj6s2oMclja5aRJzjRAasqqqtq9b7mxD8jiAgkMzOg7w8F1988UvEPCY3sYhbhBCRzz///KRTmLkJHlZ5g64ZDxffXgFZI/4v0P/0GfxxQzF0HonP5g8CHtSv4cOHv4aIt1C4/PHjxydQf0LwcF5D78LpweN9A4fZDuXsDB78prEDeQoaix8Jvkydn1BVleIkKJ/iKU3TZNt+/+YMHpsuBQQZvAUZrORmDRIDgNFe/BReeqOyBwAgK8YlBol5PZvM717gYZRO+CG9ZJxzRQjx+okTJ14MkF9CcTRUfEpejLGNx44dm+f2vAkeX539T3KH0XXk36DjN7sB9S648AeL4ILvlYB+8lP4w3N/J/9rXk7gEYlEiNR5vaZpsXwfy872aFdX12iTDiEED/tVpLu+RKbXyMldWySLNFPK9ilQxNV9gazX82WJhadntpKbGZ6eGJfh2T+bGyxxI3Hh6cm05ecZN/CYO3fucM55M2MsrgQIIr7b3d09NTs7+w+mW9NOlqqqlKVLZNPyMhLtPLk4Em0e9CyBxPEtD8pjC+1Aht40Fzra98AfN/7IFTxKSkqo/gxxq+wfMmRIPiXiGeH2RCtAWczjrUxmIXjYr5qfQmOxcwq0F3hQm0UNr8hSAQj3w/PFz/lZnOf0nvQlxrlWcktXYlwkEqEMVFmZLjExLlN6dAOPSCRCdgrKU3mOMSbdoIhIfKKUNU6cH7c5gUdJSUkVY7IagHlpbmn81vFZjy10TBmcMwkuvLUcWPYg+J/6u6XR9H8t3ANZX/0m/OEfp8SOL3Y7D2NnSDEzVDZiJ3l5AIDC/0cgYml9ff0qq+wQPOxWGoMZ0FAcV4sj7jY/4BEN534BAN6CxmJbopdMLfKk2+2lSm6Wr5msTJdiSj7xenqWNiCdpMqebhckRoZaRVEeMwLVeuyAIpFILSI+QPLtwMMwkJLdxiQ6ek7TNHppfV12No/s/3U1jLhvG2DXafjvmkkw8Jt/A3SsOfXWejixs0K263RsMY6CtGumuBE6utB/X7RjQutb4CEjGCVk+wp48aXdZG4a0PVV14AvX+DRcAUAkh3hFDQWx3zqyXSnV59JJAPKUCW3RDIgxhhllrpydFKauhCi1g8ZkFVn6WRPDzIXicFvieBBRx1FUV7RNO1G4wh2gLwYQWSY4HHR1CXSvvH53mfh85+vkP+mv51sfgr+tH8t/GXFAXmc+e8qsnk6gwf9ZpI2GwF9B4YMGTLWjkukr4DHWcKdCxUFOrOJ68NPsaEgevZ7bwc0Fn/Fdqfh1YLVBlKweQAM6qCISoDTg78S2PDqJSuTv0d3IBmv5GbsQM7KAXiVYgh0XW/lPFoxTggxQlGUPCJGNqgI6c8UJVngZ8fhxJ6eqD6/7Ol2avcCCaepstoYsrKypnpl19q1Y4LHpU/8FtiAISD+/Ef4z2XXS5ftJQ+/LY2nf2woga/9wy6gHcnRR6/2BA+6waACWK0oytg1a9Ycchr3uQ1Pt1L9kauTLqroJuuSiioAyRzdm1cmwGMgNM3qQXXXm4MKLKuXKrkZNpAAFeNgfVZW1lI/6elO7OluuvBiT3cDD9o91dXVVVvvMTOJGWO5iSTGBDpEiNTd3b1q/fr1SaU2mOBx4cRSaRg99aYmdx/AFbjsqd/DmY/+N3y2tgBGzG+CAd+43jd4GAAyMpGUOWFssfKTvR2e/i4AWxQrunSWNZ2cVGcrup0LAqEs/Wuw4UfO7Nx+ji3EzcrEYRkw1ljsq9Bx4Be8Nx7ohUpuNAzDWEcGx9sYY2Sgk5XpDJYtmotXOefbnYoj2akikT2ddhfEXldTUxMXNfXggw8Su9lJc2vugz2dCJApy/gq+vIaINCKiNcg4lSzKJNZpoEx9k5dXd2ETEzXf/zksj9xZtQU9ikglfD0cw0eRC//CDQWR5mTnFjTrQzmvU9deE+sf3YT4gs8Nt4HjBFr1n5oLJb1R8Or9zSQyJ5uAMcrjLGRiDjeBJCysrJLGWP7EPHjM2fOTKOjg1dKvqqqZMu6gkZjAY9cRCRPBe2eKRqZjMHXAMAxIcSYdevW/S4To/9k0WUPAoplANxX3WZBLldkS0c+88lysz8BEhN7DKEXjy0Nj8YSx/yypscda3qJNJlkPl/sXJPDD3gUbqKkplv6jas2Eyv7HLaZSAZUUVEx4MSJE02ccyos1d7d3S0BPSsrax9jjAyxOy+++OICk0k9GTKgefPmXUFF6BCRSkUQz+1bnPPyILulc6iylERn/thC3UuONT2ewdwv8KSiDkWMho1z7GnyvMCDdlOA+/pVkJiDrtra2i6hF04IQQbLSxhjspIbIpJn5FPO+U568XJzc31XcrMTtXnz5ksURZFyOOeUPyHlAMABIYSUo+v6zlmzZvmSY8eebgDIK5zzSYwxObeIeL0QYs/FF1881VqCoTdoCFNZnn3t2cyCR3qOHvEM5pksFBXNTRkb2Esyd91w6Mym7StVPk97eHpvLZrDhw+P6OrqokAslTFGW3DHCxEp+lDLzs5eevXVV3tWcrM2tHnzZvKmBKoYp+v60lmzZjnKcSNANrwqr5llGYUQbzHGbk10RfplT++t+ejrcjIHHmk3eiYwmGesRCXugdNfmeE7uS0KHBTwc1OmEuN6YxG1tbWRh4sStGS8DdVSNaIk39F1XcbiKIpCv8lKbkYtVfqK02935ebm+gra2rZt22REjFWME0LsZoy9qijKO11dXVJOdnb2RbquU1Ho2zjncRXjZsyYYSvHCzyMCvVEpUDXfqo8H4LH2ZU1YcIEMgaPZ4xd3N3dfcW+fftOTIVG86UAACAASURBVJo0iXZoD1Bp0N27d/8+cR2mHzwy7m5lu0HwcpkuLzNaOyjjNM0XtgNjc6Ch2J02L3pUId4L2nF8BsDGQmNRRoxkaR5gXHPt7e2ykhvtNsxKbrm5ua4s521tbbFKbsYuJJKTk+Na5nDr1q1zAYDyOSiBbE9WVtai6dOnu8rZvn379d3d3Svo2GHYFCIzZ850qhj3R9pRWCum0bHl888/N6M5zYA0Oh7tvvDCC6eFx5boUpg4ceIbBB7GwngZACgsnSKuKdf/BGU57927l/4eu9IPHkEo7JJ/I3RoLI5S02WU5lB+fX8Kiv5BzBZSvDEPBOQBsB9K42j0M02LcmomuDxMFSEi2QRiFeWFENI+wDmPVZSn3ATGmC/7gNlue3u7rORmHFOW5+TkBKrk1t7eLiu5GQCSn5OTQ2Uke1zbtm2LVYxjjC2fMWNGIDnbtm17AhEfNZK18mfMmNFDTqLB1KiiRgFp5A7+sKuri6q00c7mbQPwt1944YV3pWIwTX4J2zxZUDYYTl0QYxKD5soYbWAQOX4ZySZOnFjKGDuhKMq+rq6uNxhj33SSk5WVdUXi7iMT4OGfwi6IRhLvNSM7Mwoenh08BcBMGsJTnncncQMijhCC3HKgUsq3WxNCCLL2a5zzpYwxTzsEGUYBgOqbXoSIlbm5uVTqMPBlARA6dlybaEg1DKOxinEzZsxISo4FQE7qun5toiE1kT2dap8MHDhwB2PsKirvmOCqfRsRP/TrqrVTykMPPSTX+tNPP536eySBY9BQgLNMYtBcacsk5jZBfhnJ6EiCiJLawOai3WCM9BkRf6/r+mg6yljvTX3QiZJ762U+d+BxCBj7EFDshAHdWzJJgGzYFWL2AUSU9gEAICZzk3tB2iHIPsAYi9kHyA5h2C0c11p7e3uskltubm5Kldza2tpildxycnLiqpxt3bpVyqGjSkFBQUpympqayPApK8bNnDmzRzW1RPZ0OrYcP378klWrVlGsUewiQuRhw4Z9atl13McYU6uqqnwznqcNPAoqBsCfxTZA7ADoXmAAyCForvRd6JoGFoSRbOLEiTUAUJqwOJZ1d3fXEkiMHz/+4qysLPrdBHoCDgKzl1taWmgnByF4BPnO9mLpBUScK4Soo90G2SGI/dp0NTp1mVyQiCgrytMuhHMeYYzZ2gcOHTp0qa7rHyEi7WbGeNk4vNRk2EBkJbesrKzLr7nmGhnRuXnz5ksVRZGkQ5zzMV42Di85ZAMRQkg5uq5fPmvWrLjIUSf2dLd2kwlPp/bSAh4FBQqcuvYlgCiTGABuAaFE4MK2k9DU5Ls+cjKMZFYAQcSNe/funWOABtmZPiAQIUMqY2y2RX8nWlpahoXg4bVSE3/vJfBARHr5mw1mquWU/h2kq7quP8E5f9QAkHzGWA/7wMGDBx9GxCcR8dXc3FzbSm4HDx68WwjRYNhDTpGHIjc317Fi3MGDB3dQMhtj7JFRo0Y9RX3esmXLw4yxJ4UQrxYUFNjK2bp1a1xlOsYY2TQc5TQ1Ne0wAr8eufPOO6Uc65VO9nQ3vacFPCYvaQB2lkkMGNsIQ9rnBQEO6qOqqoEZySZMmHAHY8ykobi5paVl38SJE2WdGjqq7N2794qJEyeSEZWMqea1r6Wl5eYQPIK8kXRvL4CHYRiV9gEhRKWiKEnZB0wAMY431yYaUg8ePNhsHIsW5OTk9DDMtbe3FyIifXVkxTgv4CD1kNcGANbRcWnUqFH59LempiYCQXLPLrjzzjt7yNm6dStR8MUq03kBB7VpeG3WkZu3oKBAykm80sWebm3XBAuvZePbBpK/tA4AY0xiwGA97Kr0ZBJLlJ8MI1mCd4WajAMPAPigpaVltBU8iPjI6nEJjy1eK8H6ey+Ah67rqznnsqI85zwl+4AQQtohhBBrFEWJsw+0tbUdYYxREeqx3/rWt+Jc0lbgoDgOznn+qFGjPCvG/eY3v7mBc/5LRDyam5t7mfGiHyGWKqoYN3369Dg5CcBx0gAOTznbt2+PVYybOXOmlON0pcqenjHwmLy0ChhamMSYBs3LIkGWI92bLCPZxIkTjxs2DCnS57GltqWlpczsYwge/marFZA/As8X2roh/TXhfRcixirKk33Ay8bh1aIRhh2rKM8Yi9kH2tvbZSU3RLw8Nzc3zpjY1tbW7RVhasrOycmJraG2traRjDFZyS0nJ2egAR5SjmGfiJOzdetW35XpZs6cGZOzefPmkYqiSDkzZ86Ucs7FlfSxhQykf9J3QMzAzZ6D5mW+mcTMsabCSDZx4kQ6rtxBxxOLi7a2u7t7mYPB1BQbA5AQPNxXHZWWfAwairf0xuJERGJIl3YIzrmtfQARpR3CsIecol0BY8zRPiCEIFelrCjPGIvZB9zAo7293be7PUXw8C3nvAGPH1QMBy5egebKG2Hy4mbg7ADsqgzEJEZrMR2MZNTO5MmTv9nd3U12jphbOAFQ4pY+Y2z0nj17ZGBfCB72qHAUgC2F04M2QtMs3xbvVAGGjKSGu3WBSahrbRMRC4UQG/wCh7EdlXYIcvMS0JjtuR1bDh48OFsIQbYL8vR0AMCtboZSs80kji1kxY9VpqPoUDdDqSknyLEl1Tlxez6pnUf+4iUAUbZy6OBTYV9FUvFB6WAks4CHW1T0vqysrDm6rsvo0z179sSKjofgEb86jgFCJZwZrAVOjkvDKtV1/QjnnFisxzLG4uwDVuAwjKC04/C0DyAilQX4pRDiqKIoMfuAJS7D1mCaDICYBlOy15hxI2ZchovBNDCAWAymKceNpDJtyYHHEgRglSDYKvh5RVJMYtTndDCSUTuGx4UM1rEwdMYYkTdLsDBtIXZ6CsEjqpVTAFgNp89UQ1MkVvgmlYWVzLO6rp/hnMuK8oyxOPuAruvdXhGmpkzGWGxeEXEkAPyHEKJTUZSYfcCPqzaoxyUFV20gj4uTq3bixIlIXqG9e/f6StIz9TVhwoTJlDjX0tKS/vchmYXQy8/Q0aWrq2sp53wVHUlMD4txfNnU0tISpV9PuNKvrP4VYdoJDDTI7lqayUhRv2vBDTzorfDbjh/wsAaJcc5Hjxo1ypXF3Ev2wYMHrxNCyHBnpyAxRVFG33HHHSnJefnll6/TdV3KSQwSmzhxIlEFvkkA4gcMTLAxMm6/29LS4mg78hr/l/H3LzF44HpgvDKTyWxBF5THsUXaIQx7Rwe5cd0MpaZsp2ML/W6Gp1vjMoL22bzfEjeyxiU83TEuw69cM27EKTzdBBBqz2snQeBhyA2Bw+8EWO778oEH0Q2i8phM6e9jlxmXAQBOBtPAAEJh7obBtEfcSLoS49ra2pYxxpYY3B6ZTIyLVYyzS4yj6bQAQhDw8Ly3jy2VPtGdLxN4vA4MHvHk6DiH0+LTVRvI4+LkqjWHaZAAEUmwrOSWSko+0RI4kQIZJEBU/1RJQ0r+VCdSoMTps4KJ9TevXck5XAb9RnQGwGPjEwDSWhutx5L+K2rcbJwdDdv2trH0SoBXOoaZECQ2mkV5QpK+EDFmh6CK8tYgMWujiWRARODrZQNpa2vLAQBZyS1ZMqDs7OxyLxvI5s2bcxhjtX7IgOwUReCRCBR2f7M+m5eXJ/M7klD8B62trb6zcpNoP/rI5MeuAVBUYEjMaGY/PwBk+wF0DXY/YVuwKVFeJBLZQKzy5Gnp7Oy8YuPGjSdKSkqu55w/QMWv165d24M9zNpG+sGDWp/zTyNAV5YAygpw5D1Ix0XGzTWQ3VUZM27O3nA96NyJk6BXA7zSMUBqwxKeHheXkUz7ZtyIXXh6Ynu0A2GMxSq5GYFqVPi4VQghuUE45yMAII8IixljtxltUN5LQUAawpgcSpgjomPOeWtXV5eUk52dTRwmUg7nPCaHKsb53XGY40sSPLC1tTXwu5GXl5fUc4HmdsrihYDsCWBwAAR7C7holc8LngccbwKE64DhY7Dr8bhCVHYySkpKiAAoxh5G3hYhRIw9jN5kTdPi2MMyDx6mhEKq3SooKMaa0htIV9GbbYybRZseBIQnjVoZ1jbPSYBXEoOyfSSNiXHLOOeyojwR9PhhGCMbiGG78EWADACU7r80KIu6QQ4UqGKcQYAciCWNFNznwaNg82AY1BFlD0O8H56fbc8edjakfRwwXAC7Ho/WQEq8piy+G5CtBsR34AJlGjRVxFUtVFW1FBEle5gQgrJlHdnDOOdXuO0+AqNrUi8J8Zoq+pOAQGHS/i834yYpfWCHCgxoEQ6nQjvnMsDL/6C876RsVyEElQsgrs9UU/KnepECJfaI3LhCCFnJjerGMsZkJTdENOvJykpuJmeH94js7yCuD875dIPoWO5qjDvlboeIj+hLmMjZEURenwYPWsNDTw2FLuU1YHA9UNH3hiJ79rD8JbUA8EPI4mPhZxVxMUA99PF3FSOhW/wSkL0Iu5eVm7/TkYQx5os9DAB+39nZOZqOMk767h3wMKUXbboBEKok07j7tR8YLPJl3KSaMIMG3w6nO3aeywCvIAvaz702ZEDlXjYQRMxBRGmH8CID8tOH8+GeZAymyR4/Aj1HRdEHn94GAjsgW19gAMghaCzuyR42ZfF1gOx9YJAPuyrjkzPzKWIVAJor49/lKUsmAUIzAP82NFdIz6KqqrbsYZ2dnbUEErNnz754wIABtuxhmqZJ9jDr1bvgYUq+t3ESgFgh0Tb+6jfGzd54sYwdCFU8k8ZnskNQRXmyQ0TZ2uUlv9gGCY+0DwghKGGuIOiOozfGlGkZ6XDVBgIBy4B8PyfrGXW8BAyi7GEIW2BgVwQ+v/CkbS5VdNdxg0ymS7ycwIPuy1/yNiB7x7r7sAIIY2xjXV3dHAKNQYMGXX/69OkPCEQMQ2oce5imaZI97NyDh9mDok0/BARKEqIUvaXQUPzTTC+u/tY+2UCEILuRbwLk9QYBcmD7QH/TjV1/0xEk5gUCRPn30Ucfmez55Hp+/YorrnixyS9tYOGmONYvANwIp78yzzEJM3/JbwHwOWh+/LlA4DFlyQPSadFcmWs+p6rqHUZJBTKA37x27dp9qqqa3qXfa5p2xfz588cb9pAotiHuq6+vl+xhfQc8qCeEwnT1YvZqf3xJyI1LJQQMouM4+wAiSvsALQond2x/HHPQPqcrPN0NPMaNGze8s7OzWe4E4q93hRBTOed/cPXUFDbEs4eRM6Bxtjt7WP6SMyBgBvy8kuaYdhTuqQrmEeYHS24DDi+YLOwJ3hU78PhA07TRCeAx3cnjcm6OLUFXRXh/qAEfGkhXYpwbeOTl5W0zQPw5RJSeEcYYMa//2Kiwd5sjeNy7qQoYxLOHNRZ5s4elBh4vQXPlBdRPVVXj2MN8HltqNU2LsYf1rZ2Hj0UR3hJqoDc14BAkRgz2jyEi1SRe09raGkfrmJeXR3YJCo4EW/AgA+mg0zsAMFoeg8Fz0FDsjz0sf8lhAFyV6rFFVVXJHkaeFIuLtrazs3OZg8HUVLstgIQ7j95clZmQNaXiEkD9diC2MIS4SvPA4FNA3AlM2Qm7KtJjA6HiRH+6aBIwnWQBoPIpXHByDzTVEGkQAJHdND9emYmh9tU2aadi7VsP8IjWM34FGotvhMKGZkA8AM8X+2cPy1/6LABeD82V3+2hA3eD6ZvSuN5cGVefZf78+d80MqCtbmEroMSJQcTR9fX1PcqChuDRV1ekV7/yHxkBkB2o0jxA11JoftKzkpytaFlfZBTRJD5IzO4J95yUKQNDf7scTo3qBsCl5yOAeIKE05wVNiwBwCh72OnBU30XUTfbM121wG+F5orX48Q4gUd+xS0A4jVgOBp2PR6X5mCAhyN7GBlIFUWJsYfV19fH2MPCY4vXi9nXf59SMRlQxCrJAeJuYPAqcHgHunmUzChLXAQCxgHCbWeJduEkMH4X7KoIRJYD0RqqVCyaKrW5XPg6AIvW702MO/CjUzNPKZGl3unvHm2mmruR2LwFPMpbW1vjwr/z8vIk/6wQIvf999+Pz9iW/cdKGNC9KmnemOjuYzpk8Rt9BolRPd4tibsOGpPhcYmxh1EYOiJSPosMVTdtIV5TFu48vDTU136fvGQusGileaKUBMYXwa4K10rzMKXiekCxwnj5dUCIwO5K14r2ccOOL0z0GTB8CkAxvoDi+4ByN0LeoLNXKuBBrdiVEw1Y+iLV3I28vDwKZqSX7Co6ihjgQTE21xBB9a9+9av91NXvfOc7lBdEhtR3WltbJ2RkyaQpPN3sG+0+EHGpEGIVHUksHhY6vmzSNM2WPSzceWRkdnuh0VjUoASO5dBcGaiSHOQvkRXtKf/ONlrRbgiTF48DxugrRtcBEHx8D+7N8RVDYbCgdHvK8oxeyYAHPeeUJe0TONKZu5GXl0dlMq+gbpngQTsLqk1jZI3TDoPm4hpKj1AUZcy7777rRiac+iJJTIxjGOW6RXZD0MS4VDsT7jxS1WBvPS8No0JWkpMEus3LkqokZwEQOsJc62lIPbvr0IHxMXG7nPylywCQAth6XsmChx2A+ASOdOduOE3tDTfccIWu65RmMY6AmBjdurq6yn/961/H1c3N2NI4m5JPR0RrSv7rQVLyU+1fCB6parC3ns9fIivNy6NKc2VKleQgf8lrxhFmDTRX9qg0Hzek/CX/BSC9OG/ZW/sdAOQcgEe6czd6a2r7q5wQPPrDzE199FLQo5Xme3z9k+l/1AYiK8mBol8OryzvnS+mn76mfmyJJX/5DIKiXp2wy93w093z5Z633377qo8//vjwXXfd5RsTfN94viipX45j8uKHgbEnpUdlV6VtJTk5rskVNwETFDpNiXQ6MCxy5H3IX7wDgGJD8BHY/XiPSvMxPdmGQju4YvOXUFwBGRmPQnOlaw1Z23mwAkeSBtN05m70xlqJlD54uq525aBAstLEJGbK/MUvfpHzn//5n230/yF4BJqJfnAzlSWM1jVdAM2V9mQx5jCiBk46lrgDSNRrs066eXc/bltpXjbpmEeRACC3Lc4DwaK7GYRG2F1ZFFizKbpq0527Ebj/AR/4h/KHOoBzCRz/uPJJfx/yNDKJkdx/+Zd/+VZ7e/uBefPmwT//8z/D3Xff7a8fGSk3GVCB4e0+NJC/RFaaB8HGws+XxVWSs306CiC0A6FgLh0Q58Hux+MDfX6wlKzz5DVw3yXEg8cBgK4JPQLNoscq8shQgSnw3U8fQw9yS7pzN4LIDnrvTx6toGC6aFKocT2zfJnzi5tmVy2JfOutt3Lfe++93zzwgIyqD8Ej6CT2i/spMYq4YLP45XEBQl7ZlWcHp0NzZVbcWKNsU7LSPDRXOlea7ynjGCCuBAZGqUtGx5SzUacM1sOuSvcs0QwpPd25G9RNkx/EiW3d63e7of6/FU84ZsX+fxWP2QNIGpjErH15/fXXJ7z55pstS5acdZaFO48MLcxz2mzq4NEz7iIoeJC9haJV3S66Zwifkcib2du6S1fuhhU86N92LOzm2JIp5bDsyRUxEFn6yCLnXUeamMQS52H//v1z9+3bt84EkBA8enul9oa8wMcWaTglu8fg1I8thiuWXK9RchmTM9Y68mPAoBJ2Va7qDXV4yUhX7oYpx46dLAhj2dM1q3rsNBaV/gN/qvofhSnjkfIHmPW+h8oeOAsmaWQSS9TdW2+9Vbp3794aApAQPLxWVn/8/Wxchg+DqQ/gIB2YBlM/cSMUDGYGpVGC3J9H3QKIMvISGPsdDDn4Ovhl0eoF/acrd8Pa1WS4UM3nCRTiwMD4ofrZNVFQQfhw4T/cd7Xj/WlkErNT/y9+8YuSN954Q7v66qtDg2kvrM/eFZG0qxbmwK7KRtvO+nXV9u5I0yYtHbkbiZ1JBBC/RxU78Pj/6/6pTID+Y874lQxg6wJ1bpTPFAB63J8aGVCMScxNuXv27Lnt7bfffmXp0qX9z9ti1PK43Sj0E8dLIYT4lAoD6bq+c9asWSnxUlBtEs65lEORk4yx6yT4E8cCgJQjhNgZtBZJ4sQY9VduN4iJiYdUyuGcH0DETw0i451+6qlAXJBYzxTrwG9cLMW7DwaJBR5M7z2QLvDQNjU+wEDcLnS8mXM4WjJ79jeso0gzeMSYxNKtKd8ok27BZnubN28eoShKIF4KowBQIF6Kw4cPj+jq6qJCyb4KGjHGtOzs7KVXX311IDmISNXO5Hio7oqb3qg8AgBoBmGxuxwzPN0rLsPPRJ2NG/EOT/fT3pfgnnQdWzY2vvSZAHEhKPCZgvyXxffcNbOhoWFIUVHRn112HmlhEkv3NJ1T8DCKH8d4KYQQu4nIV1GUd7q6uiQvRXZ29kW6ro8zCgNFKdwATjLG7vJbetAo5vwSY0yS2BglCYhM9h1d16UcRVHoN0p0uo1KHhi7EfrtLr+lFI3nYuNBRDkekmNUbqNmpRyDyDg2HpLjWiohbYlxsVwUf4lx6V5x/bC9dBhM7WweTqroufNIL5NYuqbgnIHH1q1b5wJEeSmEEHuysrIWTZ8+3ZWXYvv27dd3d3evCFL0OLGIMwAsys3NdZXT1tZGmYorghRxtinStIgx5ioHEa9HRCnHV5GmKAmQrDSfeko+nxqYFChdq64ftePmVfHrcXEymPoGjzQziaVL/b7Bo6ysbPCpU6cmcc4ldyXZIYYOHbqnpibKXVlSUrKkvr7eF3fltm3bqLI6RUBSzYvlM2bMCMRLsW3bticQUfJSMMbyZ8yYEV9Fy9BOe3u7lMMYky9bTk5OIDnt7e2S/8KoAp+fk5NjKwcR6eVvTlN5yHzGmK0cOaweZEBYnkgz12Nx5FfkAAgi6CUmsOBkQOlabf2wHa8gMK/facgpgwc1kkYmMXMa3iA/j3HdTJTMAS/PB6jAzbBhwxy5KxGx+sSJE8uHDRvWTcxEXgBiGEYlLwVjrHLGjBlJ8VJYAOSkruvXJhpSyTAKAL+lowoiVubm5iYlxwIgsmB0oiE1jYWpn+CcEyB6F6aO7kBileZlwhwRHXNoBa5EbSdCHwEC8gxi5FileWC8INxxBHxLUrw9LeCRgfB0Ag8CDfO/QYfpCh7GbmMHbavdGqaKWYgouSs1TXNtc+vWrZKXgo4qBQUFKfFSNDU1vWYcYdbMnDkzjpeivb1dykHEPbm5uSnJaWtre83QwZqcnJw4Obqur+acSzmc85TkCCGkHCHEGkVR3Hk2ojaQAJXm2XpgbKkn+U/iRFNcx59GETv7nQBIjFlnyWeAHQLELXDBwZ19Kc4j6EuQ6fvtgsS8ZDraSNLIJJZR8FBV1VoWj6qSPSWEMNmbv88Y68Fd6QYeVBVdUaK8FJzzMV42Di8Fkw1EiCgvha7rl5vV1KnKu67rHyHKxKMxXjYOLzmGDUTKycrKutysDk9V3IQQsfF42Ti85JANxBwP5/xyX9XfpBuXTzeIjuMqyQHiZ3JXoojtSXF2UOo35w2AsjraZwDyOHXKGMdQAKSPyghg8C4IUQS7nzjkNcbw9zRoIE1MYhkDj0gkQh6BGHelruvj169ff8w69AULFgzt7u6O4650A48tW7Y8zBgjhulXCwoKHHkptm3bdpNhE4mmlQMUzZw580U7tTc1Ne2guA1EfOTOO++UvBQHDx58GBGfpMLQubm5jnLa2tpuYtHs06Fk1+CcF40aNcpWzsGDB3cYMRuPjBo1SspBRMmYTXKIENdpWSDiTYZNZKhhGC1ijNnKEULQTo9iUB4hsE7DUkuuCfMLB0BzXg7NlfZ1hPOX0o6E7CnDgeFjsOvxOFbx5ISn9tRDDz0kz/JPP/103C7Y6e+pSeu/T2cMPCy7Dh0Rx1iLvkQiEYqXsOWudAOPpqYmMipORsQFd955pysvxbZt2wi8zvJSOACI4bVZR27egoICyUtx8ODBZsNtuiAnJ8dVzsGDB2Ny3ACEvDYAsI7cqaNGjZJyCBCYwbPBGHOVg4jj6FhCFe/dAIS8NiSH3Lycc2eejUyu2SlLVkQZ0dmL0HV6AbQ8HS3n4HRNfOgiyB60GgDvBgYrYVel/4JGGRiHCRJWALH7WwZE96smMwkeMe5KTdN6VKpyAhA38Ni6davkpeCcj50+fbonL4UBIGd5KQDmzZw5M46XYvv27TcIISQvxcyZMyV7VVtb2xHGGB0pxn7rW9/ylEMAYgABGVdpBzJv1KhRcXJ+85vf3ECs2Yh4NDc3V8rRdf0I55xKDoxljHnKIQAhXnEyFhsAMo+o8qwrDhHpiPBLIcRRRVGCs3Glunzzl1D195cA2HPQvMxfOURTZtQjQDVb73Lcqdj0b9KkSd9HRKrhmmf83MoYq96zZ48sbZDMZQUL6/OJu5Fk2j7nz9zbeA2AUIFJtnoLATLsB+AaPF/o6/iYMfDIhIK2bt0qeSkM+8THpoytW7e6V/0+2xl95syZcbwUmzdvHqkoiuSlmDlzpuSlaG9vl3IQ8fLc3NyYnPb2dl9yCEByc3Pj5LS1tY1kjEk5OTk5Uo6u62c45wMAgOwTMTmI6EsOAYiiKHFyEJEIdf5DCNGpKIozz0YmJogs+qekDeczGHpwjK0R1K28YbSqHNmGhsJQnusnNX/ixIny6OcwnEdaWlqSProlAsh5ARxFmxYCAoUQHACEt4AB1ZEhp2seMEkBeR0weAwaij2Pjxlz1aqq2uMFcHLFqqoa467UNM3xa5kG8ICZM2fGnWMzAR40Fzk5OXFyMgEeJIcxFifnnILHlMV3A7IXQMBU+HklRcb2vNzAg+7+wZLbgMMrwPAeR/5Uo1Vjx7GXcJhsVogo7Sqc89kAMvWfDN7jW1pa3koGK/sFeESr8ZEOaMd5vyPNpFkom1EVQFwAjcW2NjMo3HQ3MLYaEN6B04OmQdOszmR05+cZR7eqHXhIgEuI5Zg3b14e5zzKXQnQqGmaI3dlEscWMpye5aXI0LGFDKcAQG7SwRk+tpDhlOweg/vksSV/6QuyivvQg19zdL16gUd0NIo4gwAAIABJREFU9/Ff0jPTvOwet0U4ceJE86PTY4dh2ZHsb2lpkWUQg1z94tgigWPQUIBsWuN0/DgJzZXW4tNnh1y0qRYQfgiMjYWGotgu11YnRQ0jAfGXgPAiPF9c7qS3N0DuYCi2aPnNAIECKOWHz6nhBPA40NXVNWHDhg1xyVvz588nu0KMu5JsGWvXrnU8+5txGT4Npp7AQX23GExjcSOWuAxPg6kf4CA5psHUGjdixmUQMbEPg6kncBjgbBpMfceNlJSUkNs8zmZAwXv19fXBbAaSN4K1ur70XuBBgyAQYjgOdlVe6QEeJ8j+093d/fV9+/bFZUvn5+dTIuMf6IVqaWmxf6EcGs+kwZRIluvr628OAmS299IR8c9iGyB2AHQvMADkEDRX3tXj/ns2XAecvw/I8+H5wvjoYyfS6HsbJ0kmfaF8G164N752riHgDYA/3QxwgfnfoGPyCx7ULrnsViKi5K5kLJ67EhHX19fXu3JXpuCqnTNz5kxbXop0umoZY3NycnJs5aTZVTuHMWYrJ6irVlVVV5uBpmn+bQb5S04AsvWwe9nZr5VfnlRrkafJS6uA4Y9duVGj/KB+wONUS0vLBUEWdqZctQQcZj9SAhC5O7uWjNIGhwduAaFE4MK2k7Y7vuiu4wZoLL6xhx7cioAXbnpbHl8cdh9vRG1NtH6euhngkSA69rvzoLOvO3clwKvHjx+f0dTU5Hq+sgaJKYoy+o477iAOjaSvl19++Tpd19+nBpyCxDjno0eNGpWSnIMHD14nhJByXILERjPGUpKDiDE5foLEjB2HtBkwxiguRNoMhBBxNgNN0/zZDNILHio0V7q+9JZjy6KWlpaV1oUwceJECkCk4txJHVuSXlQOD1qBI2UAiS8cTl/ijTCkfZ7jUbFw028B4Tl4vvi5QOBx76YHgKEKjbNz060PV/AwXbHkei0pKXmAMWbLXUl5I/X19b65Ky3h6bG4jGQHZsaNAIBjeLo1LiNZOZa4Ebfw9JTjMsy4EV/h6UQYctZQ/UjiDsOyI9mvaZo/m0E6jy2AedBcea2bzidNmkTBfTvIg8UYW9TV1SXBT1GUuymYMFWDabLznfhc4o4jpR1I/tI6AFRjMvywzRduOgOIM+D52VEjtlNVPbNRs2DWvRtvA85fgIaiQMc+v3pzzUMhAKmrq5MJZZQgN3z4cMpfiXJXAvzu2LFjrzcF5K5MY2KcGaiW0cS4tra2ZQSciJjpxLhlnHMCaO/EOGMCVFWV2/6srKyvr169Os5mMGfOnBHZ2dnSZqBpmr/FEzWYToKhB7+eaYPpD37wg+G6rpOh0IztsFuzKblq/b4EXveZYGE9qtj9zasdiB7nyDZlXEyD5mURz+dSAQ/GXoLG4kDHPs/+mL33e2M67zNIgCQvRRpS8qc6kQIZJECvpCMlHwCmOpECUTSrEOKVNKXkT3UlBbJMhE/wOKVpmr/FY7pqGc93zLz1MphGM36b3Vy1CcBxCBEfY4wVGu5KGuG7qQaJpXO9pqWts1mxBgFUgCC8wk2HAWFVvzm2pEVhLo0kkgFlZ2eXe9lANm/enMMYq02FDIhzXu5lA2lra8sBgNoUyYDKvWwgiJiDiFKOLzKgBH1aji2LNE2LsxmoqhqzGfg+tkSDxKhm6amUgsQYXARD+LV2QWKJwNHd3T0+0dOS6bXX6+3/oGI4cPEKNFfeCEQBydmBQCH8RZueBYTrobG4R6R37AhjHlWsgyvc9KYMImsoLs3EmD35PDIh1GzT2IHEeCkoYY4IiDnnrV1dXdItnJ2dTZygeQYxcoyXgjFWEISGkDEWk2Mksu0EgFYhhJTDOZcZqSSHMRaTg4gFQWgIhRBNlL9CbZIcg+iYogBNN7eUYyTZSTlCiFOc8wK/Ow5TfyUlJdRXaTNAxEXZ2dnSZqDr+t2UGGjaDHwbTOnhDIanjxs3bvCQIUMotoOOKoe+FMAhdbp4CQAjXtv90MGnwr4KMzPZ3+tlumqB3QqNRWZWe/RZx/q+DbcA4GsgxGh4YY6nIf+qq64azzkf/+///u8V/jqVBHuQ34b93mfYQALwUsB6gwA5EIs6kQMZtgtfBMgAsB4AlgZlUSdyICGiPBs+CZDXGwTIgcYzd+7c4VlZWa8hoqvNIJCr1py02NmcPQdD20s9uTqk6zGnVua1IKuOc/UmLIQJEyaQDemHXxrgiAIyArBKEGwV/LwiLjPd73sC0d3HdGDsRp9BYm8Dgy1+dh0EHIwRJxDA4cOHfW8ofN/oe5BJ3khuXM75dIPoOI6XgnYHRCQshNhucnYkKQaI60MIMZ3cz0KIEYwx+fIhYivnnHYHtPvZbnJ2JCuHuD4AQI6HMRY3HkSU4wGA7b44OxI6kQAchxhjjyFinM0gqSAxU040SpT8/wSC7SDgMcdw9Wg4OkUq0lGvEoYefMoLbMaPHz903759wb6+yU7E+fJchsLTTeAYM2YMvPfee/0TPM6XOc70OBKBIysra3yipyVtfYgnA/oUEPYAM8iAEIYCk5yol0gyIORzoLnCNpIxbf0JGwJITIzjEI3oFnBD0MQ4K3BQEyF4nMcLjGghv/jiizeNo8qhjAJH3C4kZzoAUjTkVda0eQD8HQD/KQxt3+612ziPp6X3h2am5APcAsxIyUcgpv7X/abkJwJHCB4+pnHBggWX6Loeq+RGUZ30GHlGzEpuiqLszNjX3Ecf3W4xgvd+2CvAkWJfw8f7rgb+6q/+qoKSXK09ZIwt61cG095SrxE0FagyXVdX19LEZMDe6q+bHKJ/XL16dWgz6AuT8SXuQ58xmGZyDiKRCFEfxiq5AcBuMowKId4xIkdp53ER51xWjKPqKEZ/ZGW6uro6uj/pyyQHSuTuSLrB8MFQA31AA+c9eEQikbmIKCvTUTo9VYyz8rHazUFJSUmsYpyRdBapq6sj123gK5FVLASQwCo8pw9QLA3n/AGztEjCNv91IcSq+vp6ihn60l3+waNg82AY+MUkYCArxgHCp3DmK3ugaZasGAeFDUugschXxTg3LW/evHnwwIEDJzHGpByyQ5w5c2bPrFlROS+//PKSO+64w5ecSCQSq0xHhCeapgUiPFFV1SRLkZXp6urqnCu52QzKiY4wBJAMv2eOgVOboux4dtGYNl0iThvimNV1vXHdunXxwVkAMG/evFsURSlExNle9YqcRkxG8Ozs7L2MMckk9vTTT7sSaWdYc4Ga9waPgs0KDDr9MDB4EBBloejYxdhJQKiG04OWw6CObgC2NFkA2bx5szJgwAAqzUBh1fFyAE5S3EJnZ+fygQMHysp0XgBChtHu7u5YZTozwS+QdqKZqyaAnMzKyrrWryHVi8c0BJCgMxHgfmvWqQkUdn9zadKolNhNR1whxEon8OCc03qdnAx4EHAMGjSI2PRjTGJPP/20vyTGAOrI1K3u4EG7jUFf7ABwrxgXdRGBrBjnF9WtAzJ2GxRm7VqZzipn2rRprn1XVTVWMa6+vj6lSm4lJSWxinGaprlXcovuluL4X02gCHqEcaKC9LMYklnMftrtN/c4pa373HXQOFVV/S/G2FIhxFxjZxA3fESkBD46stytaVogzoyKiooBHR0d2wCgg3O+gAAEEQ+tWLGiJ5NYH1W6O3gUboqrGAcMngJuVIzr5t+XuxEAiqQ8ewWYHPOhl19+ucHIqqQ/UZRnrDId55zo5XvIcQMPgx5RVnJLrDmTzDyQDYQxJnlaiaRn7dq1R53a8QIIr9+t7RJ4JAMCyT6XjG769DOJABJwbUYikfcQcY6maY65IXQ0Jjauurq6CX51QbuaK6+8kgz4BpMYbOns7IwcOXLkZFCKC78yM3GfM3gUbRoHCNGKccSQld05HtbPi4/LL9g8FAZ1xFWMC7rz+NnPfkY1U2KV6c6cOTN+1qxZcXI2b948dODAgXFy3MDDQoTzqqZptpXcVFW9GwAIHImhm9ye+W4JZKqq0s5IVnJzyhfxCwx+7wsCAqqq3mT2P8hztovKKe3eKx3fa4Vmql0nuSmCh6qqROewys3WVVJSMpuyojVNcyV7tnbx4YcfbjDSCcw/b/zoo4/m9SfgkLDgON9ndx06KGIMbJxDEWzRq3DjMgDJLNbzCojull2HLoSIq1+7c+dOx8p0HuBBhZXI3bpA07QeBqiSkpJCxtgGv8BBgzS8NuvoDKxpWo9Kbn4BwVSYn/v9ggAZ7jjndLTaWVdXN8Pvc45zb+UtNblJ7f7mBRaJv2eqXbt+pOHYUlJSQvP9Vn19vSzMNXfu3Ks452SXW2XuRoj6gJIh6+vrHVnKrd1btGhRHWPsLJMYwPqnn37alfs3qJr93E9BYkKIfR9++OE+P/fb3eMGHrGKcfY8Ag4AEhA8duzYEZMzbdq0HnwFTgDiAR6xynSJbO4JwEFxHORFkaTObtf8+fNjlekSa9P4AQK7tr2e8wMChmGY+FXJO7VS07RFfp7zGm80E9TmshIdezZic0Om2rWKSoPB1Phg0Merg3aaRpDh24i4kzE2nXP+XTq+lpSUVHHOj9bV1XkWWXrooYeqACDGJIaI2ooVK7yZxJLRs8czV199tZxfRLw5WQDx9rZkoOOZblJVVVkxjiq5aZoWV+NCVVWyoNNRxfOy2htUVZWV3Ig7Q9O0uEpuXiDgJMjrOS8QMKghydBGxur9x48fn0BbX7Li19TURF3oqVyJL3qqwGH2JVPtmu2nz1V7H2Psmrq6utJIJLJXCLGT+HrpyEulLo4dOzZ22LBhdPSl47F9ESajT2Qg/eKLL6iIuQxAZIw999RTTwUr55nKXCY8S+BhZtImCyBuOw+bL4+DK5YYi0CWujsKjcWB6qvu2LHDtjKdnSt2x44dMTnTpk1zlOMBHr5KQZKu/YKHgeC2HpZkgYOes4JHJBJZSOUtNE2LFZ22uJGPdnV1jT516tSxYcOG0XGMFve36+rqUstyzdRLnql20/hyUVMlJSVE3XB3fX19gRGlTMdheSHijPr6+u0EKrquL7dz5Zr3lpWVDc/Ozn5lxYoVNy5atIjaOLBixYqki4Hn5eWZJRPsRky76Vvfe+8919rJJnhQA5RNmwyABAQPiZnxsRzFG/NARD0R5KiFxmLHinF2I7UDD2Ny4mI5tm/fHqtMh4iNd9xxh6McVVXdji1k4KKzLO0+6Ot8qx+mLbdji2VB+QIQrx2H2Z4JHiUlJUsoaYl2F0OGDMmnXYWxmMmITAFs4+noRen6iqJQKQZZfcw38bHdxGTqeJGpdtMMHNScMedVdoXeLXNEsUQFbh6Zhx56iOyDRIK0f9CgQVMrKgIyidmMzQFAfAEHNWcFj2QBxB94kLdF6Z4AG34UVzEOijZdanhkaEtP5tex0FDsWS3eqosE8DiQnZ09YcqUKXFyfvazn8VVphNCjJ0+fbqjHEtchpPBNDCAmAZTCnF3ixvxAgav3626McHDcD3/0nCLU1wBbXcJsEcgYqmxlV6NiCO6u7sXZGfL8oXtQTwAceszU4bNTLWbAeCgJo2j6l5N0652EkEk1F1dXVe7JVAaRagqOzs7V9XU1CTHJOYNIL6Bg5rKbFZtT2v1MWBspaxAFb1uio86xfXQODuw1Thx58EYO0YRfZxzKUcIcVNC1On6adOmucrx46oN6nHx46r12oEEAQ5j8cbiPFRVJeoAOrZR9C0dXei/LxJARCKRWkR8wNixbRFCRD7//PPkYwYy5VLNVLsZAo+CgoIBw4YN+xMAlAoh3h0wYMAhymamrObOzs5rOOcUUr46mVicdHXZ2IGQbcbzqJIumWY73jsPostDdK8YR/d0DJqRTEVuC3j4qkx35syZGbNmuVf+tgaJAcBoty2lH4UaL66sGOcVJOYEIIly/ISnJxpMDZcsnZnJGHxgyJAhY0+dOvWEUafWFPFcVlbWcr9h9H7G/2W+x0+U77kED5qbv/7rv77017/+tWPgYqbmzwU8DFcsuV5l2TrJZzk8oSPHAKESni/2XTEucSCmK5Zcrzt27JCV6RAxTg7tRqgy3bRp03zLMcPTneIygihUVVUzbmSNn/B0LwDxAxyJOw+zTSO4bbWiKGN1XaeyksQ1al5PaZr2iKqqH2ma5lpkOsj4v8z3RiKRcRTQReHpiHgNABAz/inGGNWbofD0Rj+u/vNRhx7h6RuXQePsKNsQJcgNPHMLMD1aMQ6V38GZga9D0yw9VcUQgNx+++1SDiXIDRw48BbGmJSDiL87c+bM67NmBZOTrsQ4s+wmHRWCJMY5AYhf4HACD+PvI7Oyso51d3dTOQmTe+QxTdOWuz2X6jyFz4casGrgvIzzMAdo8UiQZyXVlPypyZICJUsG5BTncd99911DBb6PHz9+wbBhw8jjQnEGsSLIXvEh4SsQaiAdGjivwYMUlEgGxBgr97KBRCKRHCGErOSWKhlQKpNkd96m87VlNyRLSRpbawKR2HHvXJ/DUxl3X3t28mM7ruEMVAT2fQQkNzgwYB8wwP0CQdv9xLRDfa3Pdv2ZOHGi7xgner6lpcUVH8578DAAhGgIYxXj6EtNeSC6rpu1WsirM0JRFFnJzaAipEfpbFuQ7I4jUwvKCIJbmpWVtTE0jDprmQzdiEgxMkQvSdnfRxHxHcZYpdcHxGx1yuIdCwXAExxgsJ0kQSn1AI/tenyaZ3h6ptaD33ZD8PCrqYT7DBtIoMp0WVlZS8OXM0mFn8PHDBcr0TjMpoBCxtjdxDbf3d29DxFfNOgfNh4/fvwpp0zWgorNA/6kD9jBIRpObl5c4Z30b6EL8njFLgG4+wKlc1pThbsnsIdaJGdOBwX23QCI98PzszPGJGZU67NPaE3oGDko9u7dG8euntj3L8XOwzpow40rK8ZRJTezXCNjrJUquZkV49w4O87hexGK9qEBVVWfJeBgjM0TQtxA3joyJquq+ih58iiGCBEpjH+jpmm2+SVTluyoBQQZO2Ne37n6q/9Wcff/LflrKl7830f/9fAfv53Qnepdj0/zlV0rnyPgGHpqKHQpr8n6K8TM11CUUSYxPwDiBzio+1868PCx9tJ+i59YASehoe0i2HQQrwkAvAAAZECmhEH6fzKY07GDPIMdxtGF2O/uA4B7EtMTpix++ToB7H2ekED5+D1j93/nmv9F5FTwr4f+e//iF34p/21eglIFFPx2c8Ud3jlFVD5y8OltILADsvUFBoAcgsbijDOJuQGIX+AIwSPYukz67mS9H4nPGYS8RCEQqBSEmdRlAlFeXl6c4ay1tdX1I+J0fyIoegGd3/spgnPgwIELOedkq6IoTspCfVcIsfvMmTPVbjVrVFUl4HjH9D6pqkq5J5S/9LERbr7PjIFRVfXHADAuMYzfbtdBffirSy8+/My8v5VG6Z+s+5dj/370hF3YuvfuQ4Y9dLwEzGASQ9gCA7si8PmFJ9MR+uBnodoBSBDgOK/BI22FkWiiB3fcDignmoKEpLUdQJb3OyQrkXcM3uk26WkED/qKvkkcJIjY7OdlNe8FgO+aX1gCAy/AcFqA1meTHRe17fRsWVkZfc03MMYGUAo851zmMNHxg3NOlf7I5jCnpqZmv10fKSmScz7WPHaqqvoHygOjbGRVVSmk/wh5qOhZM2cokZ9lyuIdBDg018lc7bsen+bOZxpP70nRTBvh9Ffm9RZwmINKNKB6eVcSlXFeHlvKysokJ6oQYk1tba0nYbHjCqGaoEwQXwN9/cgesgeAGZXakCINyZU7AkAWei6C5wttXXbJvmR2zxnbcspxiaMMcHiRzB1GDDjovr4KHmVlZdMZY9uIJOfMmTPliTsMY0dSRUxclBJfU1OzPXHcyRwRE0F48qM7znAuUwDirtzLh8OKuYTfAIvWvwVt/2Gb43Zy1+PTnO0WhQ11AGhhEvOXE/ad73yH0hDIZrP8X//1X2UJEb9/c1rfIXgkaKasrIy4LChGYwEiruacz3nmmWcobybYdbYa+TFgUA4NxT+1baBo052AUCtjLBg8Bg3FPVx2aQaP2JHDz87D7LP1Xit4JB5JnJRk7lScdh5+X1qzH4k6Ic4Lxth/kDekpqYmxq5VVlZGngioqamJEQyXlZURld/diHh5Ypaqzc6DEtsuC7LzSAU8mIBTry6fJnc2Pa57N1UBO8skBsA0aCzyxSSWl5dH45Ch8a2trbJ9v38LwcPHq09sTZ9//vlhYl+vrq5es3DhQjKILbzwwgtzKyoqpIvN13XvphUGM/yLcPr0AmiKxAh4bJ8vqLsIBg2iUg93A8JKeL44juglneDh90vrBSxmO352IX7u8TNGt3tKS0uf4JwXnj59Ote641i4cKEk4Kmuro7xxtIOZNCgQW1CiMba2tq4Ql6GzeMtk7uW8nwAYLyDzYPWBxFHx5EX3/bo9sPI+VWJuva587A/tpCBdNDpHQAYdf0yeA4ain0ziVn4O55qbW19xAAPkxTI9W8hePh468vLyylJbPbHH3+cS/57oum77LLL/o1ccjU1NSt9NAFQtOmHgEDGrECTK9su2vQsIPwYGNxl3an4ebHs+ubnOYejje+SDX6Awc89yfbVHHd5efn7ZBCtqamRL4bXVVZW9iQZVKuqqkZb7zWOdXTUXIOIVHmQAsToi21edOxsjR5BYS7NWqK35bZHtz+LnJMxNe7yBR4MVu2qnFYa9+DcdcOhM/sVaCy+EQobmgHxQOIHxmu8ffH388bmUVZWdilj7Lec87usx5Sf/OQntwkhiOr+ak8iFvl16PgIED6DM4PH2BqwnPgxaXajVvT3gMFQOD0416Qo8PNifdnBo7S09IyiKPdUVVVtsepi4cKF8phWXV0dt1bLy8vv1HV9XW1tbQ/7gqqqVJuYjjXENkd8MJ8RiTHxvBBhEjGiM8YIYIgPpcexwclV6wUe5KrlgKN3PX5HfJ0XKsUKKJng4PTgqdA0y7Cb9UVI8N8nV/AwDSqJVlinv/sVa56PE7fWTn/30+7ChQtfEEKMrK2t/e6CBQuIFJi+OntWr159a2lpKTFrfehpPC3cRLVcXgDEqfD8bHs7iRt4UEfv3XgbMEZ5JvdAY7EkxQ3BIzqDHseWE4qizAsCHhToVV1d3cO+YESYUiTlDxljLyLiD80IU8bYTxGR5vmnx48fr2xqarI9ztrtPrzAA+x2HTRwuWawEgZ0r+pR+8jP4u6j9/gCD+q7CSBWC21Q146pA6txzWpAM3/3e1437y8tLb2ec/4+Y2xMVVVV6/z588nVR6HJG9euXTuHfgcAovEbW1tbe7b+TOKkFG6iGIHJcHrw1xzdZl7gIWv7dlA5iT3QWCzP0iF4eIOH07HFaedBNhJFUW5LPLZYp5Qq/QHAo4wxcpFQaYpPEfEtyrCur693Xge0ibQJT3cDj6TD088xMLz00ks4cuTIq2+88cYPg3bF89jilEyTLHDYAYi100GBg54tLS19k3P+cXV1tXxZ58+fH3NrrV27VhrUSktLN3DOL7Ea3nooq3AT+fdbzZfeVple4BH90hAIjYPGYknIk2nwsOunXz36sWf4ucfPGJM0mPY4trgZTIO+AF73n0+JcXZjJfCgv//lX/5l7ve+9z3vyFhLI57gQfem6g92miC/EYduE0yuWdq+ElHPM8888zsDPIjTkQiBF6xdu1YmGjnZROLaLmo4AQLXw/PFZ/MTnCqPJXbKWuwq6pL7MTQWy/oufl4suzE6GUP97tDsdnj0bF901d5///0jsrOzPzI8KLHYHLudR2lpKbngC7u6uq589tln40m5vdAgid/NlHwd4RaFclAozh3hA4XB6/0pJd9u6C+++CL+/d//Paxbtw5ycnKu+9u//dvf+FVRvwYP4wv0WzrXVlVVxdyj8+fPN4ONZqxduzYWSFReXk4VwO52dN2mFzxUaCyW5/E0g4eMMqV2vXYXFvDoF0FiZAQl6gQ/QWJElZBoH/G76MP7zmrABA/6y6pVq2DMmDHfuummm9r86MgTPPrysYVcs4hItULjPCn33XdfnlGaYMyaNWvILScvC9isrKqq6smHmt5jSx40Fl+bTvAwo0vP5/D08vLySUIICgJzC09fUFNTEyi/x8/L8GW8xwoeNP7Kykr47ne/O/GWW26RwXluV781mJrHEABYWl1dHRfVSdb2v/iLv7juf/7nfw4kWtPLysrmMsZW2Lpuo7aKSXB68NfTbTD1mgin3xOq1qFRWzfQi9MfE+MGDx5MHwUKqJKJcZQCwBjb3dHRsdItMS5ZPZ+r58aMGUMpDlS1jeJOev2yggcBx/jx4+d9//vfX++nI77Aoy+6ask1SwvL7ghy33333UY7Es75c6tXr46LG6DAsZEjR76n6/o7PVy3MVetyIfn59i/oF4G03s3TAbGKSoy5qr1MxHhPV8+DdBa/Oijj2S1xSuvvHKMEzFRJjVjggcBx4QJE8puuukmSrXwdXkeW3y10ss3lZaWjuOcU8Xye2pqanoUGL7vvvvILUtfrNY1a9aMSexeWVnZZMbYK4g4uqam5mxATzRIrA0QTqUYJHYRnB58bTJ1bHpZlV9acePGjRvc1dW110j5v7+1tTVjDF5OSh4zZgwlb1KUK9UDWv/ee+819vaEEHgcPnwYbr75ZvV73/tefRD5/RU8XlMUZWhVVdWNdoOlnYcQgnIlVq5Zs8a2enlZWRkFcnXU1NQUxLWRgfD0IBMS3pt5DRBwnD59eijnnIIHZV3f1tZWVwYvrwBGr98TR0V96OzsPGxEwRJfScOAAQOufuedd6h+cq9dy5YtwxtvvHHqpEmTAieP9kvwWLhwYTdjbHlVVZUrx6LbDJSXlxciYl11dfVXetxnZj9SfkvH4FJPnoUo5wfR1v0YEKrjXL29tgzSIIgoCECo8H/a+xbwKMo03e//u9PpIB4uijprZuaQQUCzXqAbOebsjBgiI8sl3tB5UHB5CJ2RA4PISGDBEAMsCcy4/Q7wAAAgAElEQVSgjByYBHgcQFkHUAwOE5ebMrqwQjqwcsJN0N3RPeuAunhE0p1013eer7qrU11dl786HUig/ufhAar/+ur/v6p667t/DKimRlvdEoR9ALzWrOSA2dUZYwUijZGsMnwlSSo4fPiw0u40rQ3n5+d7vF7vm/ThkCRpKgEINXBqaGgwreBl5PamRZj9ZrRIn89Hxv4HGhsbh9Ecn89HBspdwWCwKq2NXYaTuip4UI3Kx+O1NNJl2zlEXKebiCVHiYbmAGA5IBwDwPmG4eoUjg5sETC4DYBVQshbZQk26a64I89rK0FwFBA+ACYnjwEg+IDJpfxuT6fkQPzFoliMh7UJaNrtmAWjxYFFphMMBilK1PaI2xheB4hX8ALY6vF4SnNzc4X6+qYbGe3z+Sju6C5EpExdKkgk/42IwxsbG6kcItXmoEZnBCCUwU3RntS4+jQiHrkcKpUIc7skeIhsLCNzkosBfRHPxFSSmpRiQBT2fBAk1yR47UlbEXoZWaMAkfvvv59iJ0736tVrfopRTkkVZ3APIE5V8nFSyJIxmbFVcqPzkLdYbc8xi2Oh3yRJGs45p5fWFECswINeNsaYTCcdABk8eLBcJEq1t9/l5eWV2DFUagMbFVpmMTdDhgy5V5IkMqKvQMSt0Wj0C6PeskOGDLkpGo1SkidVrpvBOR956NAh3appAre+Q6c44GHF3phK8lC8DCF9MSiGhEYQED4FDr+H5pxt6Ugb9yyHnPC3MDaMsK2pAlp8lfBRsBzkitz+hfBo1jWw48Cz0C4duKioiFoQLI2veeXu3buTa0hMXE/q1uPA2FDYMPHPpuyYuOEHgPghIGxSq2ZW4KGmafaSWYGHmo7dMop+v78GUV3BC9YFg8ESq9uv93s6kdGDBg0iIz/Z2ZZZqSak0gDAc5IkjdaqaQMGDFiEiJSvs/jkyZNy6oXosXT2anaOAx6Z5qgNev4XYAIy2MAA3mmWoNjLIRwsB+ZbCGsBYTJDmNiwANK2wBcVFZG6QaIwldRr4ZwX7Ny5MxE0B0+8cjtwfhiQj4RXJyTHGRi5pJ/ceD8wqR4k1x2KpKWAhyqblRpwk4S2Ud0bxSrSVgEPsktkZ2dTsyaZDjWT7tu3b6LHikiujfo2+Hy+X1NRKOUYY6y2oaFBqIJXpsCD6Ph8vtsBgIy074RCodKmpqakjN64PYbKCVB8y4hgMJic2k/6Tr9+33LOu0uSdOH06dNyBLPoMWUvCIjBhrbHwOyR9flJa2W6OOGAh42XPdNT8yvA4+Vym4BHGcABpGS6WJEaChzamjcQfrblMbldgO0xcuTIPq2trRRD8AM6GRFL9uzZkxz8E5M67paL1GiHWTzLhPX7ZfUlngOkgEIgEFAqWyWoMcZW1NTUyMVxRMFDVTVLvaoVwWBQpmMHPOiFzMnJqYsHnBEfVjY2NgpX8NKyJR21RU1j0KBBt3HOKfz7h8FgMEnS8/l8dK8ov+eOw4cP66rA/fv3T1QPO3XqlFw4SfSYso6Ghgb0+WICNCJBCVKB6fifKEgS/T8KnDM4fvwkhayLg8eJcf4BUQkDwPFekKSY1Z3zIyCxfS7OagduaegSvTltv3GX4QQZQBjsAQ5bg8/DisEvwEMMYE7erVCQLnDQNoqKikjHlkveMcbW7dq1K1VEp3B8hJXw6lOJJtkJFpiBx5PrZwDDAGz8O7lKuAo8qFI5FduxzLvRY7UCCj6fL0HHrnqipnvPPff0bm1t/UNDQ0OB3+8nfhxtaGhIKhFp55anazBVX8Pv91P+zoxgMPhjAx68Hwc4/Zq5dhZsMFcBjzbAkCAaJdCI/d2jRw/25ZdfosvF4cyZT8TB4/i4Qc9KEi5inOv25kRJauaczb91y+FO35szA3zuUBK+Svh3RTIISZBNdg/5y1oJn8d7qx5VbCDahQwfPpwK3TyXlZU1sr6+PimztKioaB4ALIqfE+zVq1eBbtGbCevDgPhwwpNklUGsZA6Th4nz15TuZkbgYfSV1u5F3U+GwEILHlYuXIWeFmh8Ph8VBKJkyH3hcHh0U1NT2hW8MuWq9fv9r8c9KFV33nnnzW63mzyHEIlEppMRlewd5Jmxch2358Ek8Bg8eBBEo8mgQcDRs2dPGTgISLKyXHDmzKfW4NE0Lt/DMbsOWexrZTUYwjsSCxfnb0nW26zOc35P5YCvEvYwgG0N5bDSvxDGIkJ5SIICBUy0Z4wYMaJQkiQ5cYmaISHiiN27d8tFmuN2jvfiXdK+5pz7d+7cKZcqSBntAQ/yemiyhtVqCwFCO8Ajof7EwUSou7sOeNB5lR6PZ8WBAwd0+ySIPo9WQWBWv9N14oFhX5HtSZIkiqWh0oSKKkmRpgs45/skSdrv8Xiu66iAMQKPO++8U5YylD+K1EF/kxpDw+PJgtOnz1iDx7FHBr8EPNabk7mzWtg1Pc9L35y7Qc1c3qPPWfzufE+MtMo9LVBiy/PfCIr35hS9U11wXrzYMlUwoxJ306l6u8g2fJVAPVP/DgH2MYC7kRLAAO5VjKh6AFJUVESxApSWTwY4utl7e/fuPfLChQs9WltbqeAzuY+jiDh6z549xkl0E9Z/DAgrMqW2kMG0Z8+eS4gHtbW139MDDz1Q0UoeccMhAcj4YDD4PT3JQw9U2qPiiNyr9s7x+XyjAIA8LtQX+QLVm1FsG2QLoRo0jDEKASCDxOhgMGg76lNkjQQet99+O7S2tiZUFbUKwxijcHkZPE6d+tgcPI6P890uSdHDjHMXerKb+/9mWxO7ttd1n0wd9d8i33x9HS3I3aP3V3mrdvw//Pa/vjr1i4fyWUs4B2WrCrsjf4u+cUdkI1fKHOo7wjmnXIm7JEn6Rq8wr3av5I5FhC2KcfSTExDJGwjuT06AHMjEEEoaFiS+TEmnFxYW3sw5pxweufEyIm4jKzzVbo1LJAt27dpVacrfWLX3u2DjU6n6t7nB9H05iGzDU6aGUC14UDPxmpoaf2lpaYPSYJzWpwUP7Zp1wCMYDAb9Pp+PDMKK6xy6AHhQew5qsj4rGAzqpk34fD76+JB3aFswGEy/YZnJjSfwyM+/DVpaWhP2DUXiUIDj+uuvZ999dwGPHz9hDh5aqaPfyrqP3L1v9Edamj/+9OlR19M6+q7e8aXbk3NL5Ou/NJyeVnyHI3203R2qbMUY6xOJRKZ6PB4qvnxMKYlo9vIqcR4/uhW2knGUbCDBcvjhuM3gOnMcHs2+FrabxXkUFRWR5EHqi2ykVI0du3fvHm0JzIqrFtgI2DhRjnRMDCPwmLChEAB3giQNgtcmya5EIy+K+jgBhgIcWgARAQ9V06kGBTi0ANLZwYMCwC5evHjByvaSn5/fvVu3bt0PHTpEgYkZHwQeAwcOgO7dr03YN0hVIWlD+eNyuSAryw1NTcfMwaPpkcEnGG/rzUnSx8DVfzzFr+15pxS6KFcV4t5u+dK35//1xNN/25+kjsSOJDh22xuN5r05M779zkNw5syZ1J1OVvcoehAASj///HOhcOdM7KKwsJB6uJKNQ7knFNrsV2wglteISR8PAWMFgkFi++X+vHGpwwo84lJQksShSCDac41csCrJQytxyP8nOnbct5Y8ucInEHj0798PwuHWhH1DkTgINAhAFPD46KOjlpJHGDS9OWUAqak/w6/p8dfES+m7b/7Px1NH9pWaw9eoeYsgfZO/5UhbRuKYxWTlJ2v/Ynh7Xqybl+gxFWFETNBhjMl0RI9dqnv/zDPP/Jpzngg+AoCVy5cvTzuGIN1133///dQAmpK9yFszdPfu3SnBRYa0MxSerqWvtW2YGVDVkoeWjta2YWZA7eySR7r3N9PnEXj06/cjCIdbyOAugwWpKefPn0cCDQVA3G43HDlyJD3w6P/y28fdva4bTIuP/NdXjaemj7k1SeqQUQUu3PZGY1vvjFGLvwUO3ek47JgXOy56LBk8Er05GWMyHUQUOpZpZuvRo45ljDEKI5YHIlaJdjvriPUVFRVR8lXzrl27fpcWfW1iHAe5Oz1IcLdVYpzR9ex6W4zo2HXVouIuSIsRsgfrig6eJPAYMKAfRCKSDBy0XQUwGCOpg46RCsOgsfGwJXh8DFzO9JMHeVv++8t1/+q97sYh0daWM4hRiewdoa/+cujfphffqdg74g9XstoyZtESAHqpsArenh9rHSh6LBk8EpF0jDGZDiIKHUvzmRE+LV4LlQydilt7/vLlyxcLE+isE5WUfIBCiFcJBwTqb7LXLCW/s4LH2++nxjJGIhHZy9Da0gI9uwGMKlSqHLbt4koHj4yGpzc9MvhlxkHuzYkcov1+s73Bc8PNQ6Otrf9+euoYWZfut+rtZldW1g9bzv7Hh58888igBIBIsOK2NxqTe3N20pdDBT56K6Q4iREUN2G2/BkzZgxwuVyHP/vss2u///3vUzWyHS+++GJqhGYn5cHVsCxF8iDwGPPjAbpbXrd1H9S+8iqUP1sCo4YPTZqTDnhEo9F/oI49lM/jcrn+Xu+iInO60v2RxTO1q5bnZH93y8tvn8JuPW48M20Mj359lmIGwNX7hi9+tPJtiV385i8fTx/Tn2wf5Krl3DXo1i2pCTydlQkGACIEHLSnePsGily8oNfqsLPu+2palwIeb713DB4cdpvu1le9thNu6XszzF/8EsyfORnGFP2PxLw0weOzuc+X5y5ZWPm5y+X6vgF4WM7pSvcpoduppQ9SW9w9r/+y9cv//Cv1ZrKu/97/jZz/8vquKHWo96EBEGHgIBrxhswUCfi7ZcuWdYgrrSs9QJ1xrQp4bN39ETxaJFc4SBkrN74DG19/I3H8wx1t5TuvNvB4NxZwSBnYp+8DuEX0nraBx1UWnh4HkKdFVBVRZjrzOgcHFPB4vT4IPxuZiCFLWlwkKsFvN1F2PMggkgnweG7u3+cuW/IPppKH1ZzLwcF3AZQkyqP3QayejMhIsSpfTYlxiEgVm/5DhFGdfU5paSlFtxaq18kY21tTUzPc1tonrKegsyQ6ssF041P26Ix8fg8A09DBvVC/0Baduro63fUUFxcb0lHA49W3P4QnxyTbM4gX5IxpDkfgwsVW2LzjT7DhH7fCwT+ubbfaMvO52bkvLltqCh5Wc2zdqwxNfg+gDgHGAsAH9wHoZvvqXUrXJaWk5DN6iDjGUvIldgQB9jop+Rm6Y3Eymzdvdnk8HsqQLUREF+d8bygU2vTYY48J1/EoKSkppNB4g5U9UVtbqxsKnTI/Fj1qSMewRKGW0MiKQoBY4l7KYPgE/HGh0Hq2b99OPNGlQ203HnzwQV06Cni8su0DmPQQSePJo6U1Ct81t8K3F1tg+679wuBhZvCMRqOfPfPL53Jf+tUyU/AwmiNsTH1m1yLgbB5IuBheuj8WRyV6zOABeQ/gNQSgsPhd9wGMEH3Cr2h/tigTLte8zZs39/Z6vfXx3iHqL99Bt9s9urW19WxxcXHKPdKTMkT3kCSN6EsZoqTapBFdKUOUTJs0YiBliBLaq0gjCnis2fwuTHnsvqTzoxLCxVCrLHVcuNgC/7TvQyHwUF7uZ2b9MvelX/8qBSAIPKZO/0Xuqpd/YwoeRnNk8InTNvPYwLM7vwXg3QGkC7B8RCyOSvSYMXjUIECAAWwfBlAsynAHPEQ51QHz6urqKCqUEqVWIqKchcsYIzsMuc0po3KUHnio6mdoU9VPkuuYMUZSC8WgyFm32pGoI0r5K1SjI7WOx0lA+fqU+PgAIOrSkc+lMbIcob6SyX8nj5OAbAdwjAIar0c+FwDq6uqQ9kt/p9CJ8cN0XwqvFPBYvWkXPD1ezhNMjBCpK80x4CAAee9AgyV4KMDx9PTpuRQ8teo3K6jeSsqYNGVK7itr1piChzJH7/ypv5iRiyjB6pdfJvr6Lt+Ze5YAwzmArApeHB6LoxI9ZvAMvwtANUWmMYBNw6jToeBwwEOQUZmetm3bNspJoazY1cXFxUnZk3V1ddTyT86XMQIPnfUQ+MxFRNJdCYS2x9MEqABy0kgCj1RCqyEUmgveHJkOhJq3Q7Z3HjBIoZMEHnp0WsNzwZMdo9MS3g6e7HmAOnRU4KG3r3A4PNfr9cp0QqHQ9uzsbEp/SFmPFjzIozJtQlt5GjKSKurKdxdjasu/BI+IgMdnT02enAtAodyManoCveSxTFQqTRH/NwBs2rjBFDzGT5iYSy+dHNkpR3fG/804IFD5P8JNhPXr1hnSyfSz+C6AHHyJAKsLAYQzeR3wyPSdaCc97VdXEDyORqPRYS6XixLkFCmBamAWICI1NUoKozQED8aOQlbLMGj1vNcmbeAxCIULwOsl10RyOKZa8kje91GQ+DDgUvJ6WsMF4MneKddNVQ9j8DgaDoeHZWdnJ9EJh8MFXq+XspeT6JiBh9pISqChgMfho0dFwEMOAHv40XG5wADe3LJFV/KIb0kkSEz3KXl43LhcQIA3t8r0Dem08xFLOX0vQDkDeIEBLB8GIFyfxwGPTN8JQXoiIGFESidnZDFj7FNEbHMZxKSPEkTsrWq9IJM0ljxwMQD/FCCZDgArAYa9ARMtHGJLMwaPxXJbCgZJ6wEEqqPaG5iGjgF4UHsBABDelxl4qI2kir2D1JdjJ45ZggdtVVFdRhc/mPuHurcyLhWQzUOhfSmBg/b2LsBNCHAzAnwxHEDY+5gKHoreGr+hKQ+w1e/xE5SXQ+/LSVOsftdelyp19erV63FyR3LOXZIk7T1//vwmOw17ZJpyN7jmxwFkt6YLgO+FkHeT7b4r48a54LuBj8fckcwFgHvhmuObYMsWIS+JCjxmFRcXJ9WDfeutt6iO5RJEzH/wwQdTqmjrgQc1dWKMUVWyxEDESVRnxCZ4nAbAJDoAbBIw7GMPPPA0aNYDiJMAWB+b4EFd05LWwxibhIgp+zICD1JfzIaoq1bYIyL4AVFP60jaIsvZDXBbEVB3RPFhDB5EQwsgaoOYEbhowIP+qwUQ9VfXCFzUW5g8eTJV6arXit+IeDASiYzOyso6a9ZMKEFr8tre0JJFATHabKiD4I6OhojrbOJrasbDn1b0BpdUnyJ+MzgI2DoaIOtsCu809IgHVNcCEQcwxkaPHTtW7gpWV1dHSjoZUg8YxTLogMdRt9tdEIlEyIaixGOfdLvd/kgkQvtN8leaqi3N3gLwXvwQgCXoQCjHD97mFDomksdRaOYFkCMlrQeauR9y5M5pyf5Tc7WlIDs7O4lOOBz2Z2dnp9DRAw8CBpHR3jgPkWt01jnvAsgV2RjAn88C5D0WM0xbDn21RQ8kbACHclU9kLALHESrtLT0TUSUvRKMMdkrgYhJXgkh8Hhy/ZvAqPANrISoK1Zj1BV9Wm5QzdgOQBwlBB4jy+NeErYSILYeAFoPTgMGOwBhlAh4kGTBGKMXg+pWEuq7qAEYY4yK9frHjh2rW7hYL9UdEZczxirjfIKsrKytkUiESgaQcTFpmBpMqVF3OFQJ3hziN0DIuxW8F+cAsBQ6pgZTZMshEqoEtydOx7UVciTd9ai9LTpP7PJwOFzp9XplOqFQaKvX66Um0Snr0YKH5dNvMCGd8PR0r9UZztsLsIoBjEeA7YUAE0XXZGzzSHW7xWhaSBzaC+u43eQpIhIHzfv5z39+tyTJX7DVtbW1SZbg0tLSl6gHBs2zBI+J6+8GBJkObHwq2aIca34k07EEj58uuBs4xujUVybTGVme8JKI8mn79u19EZFqVlLDpyhj7APG2KwxY8YY6p4mdTIofZ6aRikuTaXTvTh4yDgop+HvAgYxF6uSnq+9ucY2D2XmEWC0HhYFRJKodNdjAR5ES14PuaDjzZt06Yg+U6IvhzPPnAPmBlMtgNgEDuXS7TEOGi0/nX6hurS0MQ7KC2H3yckQr0QuGwgEEg2dROZr5rxTW1s7Uj42YUM9gPxSpzHYO7BxYozOA8/XA2Pp0UF8B95ZKNOpq6tr176Ki4tj63HGJeFApwePqxkkLskT4FzkqudAu7NqUzjYSdQWBTxIlK+pqUnySgQCAdKhqRxgfk1NjbmlWJEwGMyCDU8ld7ubuGEOUJUyyZWvNG82fKIUvjCcBX9cmEzngefnAGNLAHg+1FfYslxf9U+ww4DLxoGMZdXKO+hEBlMCD8UrQU2M1qxZI3slSktLH6Civ4yxA0KZozHwoNbgAwDYaNg4UaYDT77yADAuezeEMkdjvInTwdFQvzBG528rHgCU3gTAA3YzRy/bU+Nc2OEAAGQuq9bMq2LD42LmVbHjcYmDRz6ibKRM8koAwNeSJPnXrl2r305R/WgQeJBkwaNxOngsFp8ht5z4GoD5YeNEazoyD3g+gGzETVkPRCU/7FxkTcd5bB0OdBAH+vfvj6dOnRIOAM1cVq1VEJjV73GGWAWBWf2u5WtJSUlfl8v1a0SUvRJUe4BzPuu3v/2tcEScTHPChr5A3g0W824QHYipMvbojJjfF1w84SWR6biis+APi+3R6aAHyCGbygG7z5wRD0X60trhf1FRkZwIuHv3buEX3og+AQf9ZhM8nKxaOzess8z1+XyUi0I1UQnMqHUkgc8BAPgBrZFzPvvQoUMx1cgZ7eKAHYnX7EJqI75liIDFihXgyAR4KMBhFzycrNp2PVaX/mRq5pyTk/McIhJw7EJEAgjq9taPQtPjAWO0sC+o2fOlX+GVd8VMhQxkygOoBo72gocaONIADyertis97n6/fx4iPouIJY2NjdvUa/f5fJRVKTewJkkkGAzmiuzNrq4rQvNKmqMXsJhOYJlekJ5dCUQLHO0BDy1w2AUPJ6u2Cz7l1NBYr+nx4MGDH1CS3Ci5rbGx0TyzK773dPRdEfHc7ouhpdleW0OmbAKO5KF/tzOXVdsFX8KutOQhQ4bcK0nSUlqziD3D5/NREtmjwWDQsrFWujqvHv8ypddnws6QKbtAJtZCvMoUb4hWpvZGtNpz/zOTVduV3kQba509eza5ZKmj/b2UhEbNs6uqqoS+6DYuYznV5/P9JwDIjbRE7Bl+v38CtYkQUV3ao/eqF54pnT5TX/pM2QbaKwEpPLrSvC2Zzaq1fAXsTfhiX+XtnLMZkoQrbrq33LKDe1lZmbaGZeKCjLFSRKzRW0F1dbWuq2vmzJm9PR7PCQCgGhDKIDftsOrq6g/s7aZ9s+3aMwYPHlzIGKsPBoPZVldur+6r/aoq10tHbcmUfUH7dVbWlAm3phU/u+rvdm1fmc+qzRDnsKnCc+4r3kReBPIm9LlOymf5FS1m5Ak8jIDA6jeqPFVdXZ2npj979uzJjLHkqlaxCeuqq6uputUlG3F7BkW0fiNiz3Akj2TRnm6UAxyX7HE1vVC7g1KstnF2X+UcYHKBVXkgsNk3/uT5ZR0IHqAFntmzZ09jjFGF6KTBGNtYVVUlXL/Aaq+iv/t8vtcAICcYDD5sdY7P59tC5YODwaBlVev26LzadWRKr8+EnSGTdgErfju/i3OgQ8Hjm/0VvUMt/GPGgepoxsBDgq+9HumWHgUVVPBGdyjShVZ9IVCw+g0A/lxdXf1DNeF58+bdHIlESPrpoT7OGBteVVW1V5xdmZkZN4JSf9DRwWCQWgroDp/PNwoA/gAAPw4Gg5bqleNtycz9caiIcaBDwePcn15YhSD3IYHA8kZ5RbXPDqbC9av7/GSBYYl3K9XESKUx2/KcOXOo+xipLn1JZaA2BdXV1fEqYGLMUmZNmTLlXfr3mjVrEh2F9I6ZUfX7/TXxql+T1ACi9sbQWhlj2xoaGkpFVmhX1xWh6cy5OjiAVEUPYAgAHGJUVU9gdBh4nP3nirukKDRw4JR8lgQeEkhR7gL/Df+zgipEpQwr6UKRQNQnqo7p2TyotF85IlYyxr7IyclpDoVCWyRJWrl06VKqvGVrKEChAIj2/yLEKMI0Ozu7nDFGJfV2cM7XNTQ0bNd4Yy6EQqHrmpqaTG1EItdz5jgcMOKAAhxPlpYteLWm+gXGWIUItxLgEQgEFsXrXS6ura2Ve2CKHtO70Nk/vfA+AEsUulVLHrH5+MENP1mg21Q3XclDUXPUksns2bPvZoxR348cANhaXV09TmMDmaqWQMrKyv4GEad169atpKKi4oIRE9WAocxRSyIizKc5Q4YMuUuSpHmMse4NDQ0j7XpjRK/jzHM4oMcBBTjGT5m9gBpapQse38ZTzC/U1tbKPTADgYDQMe2izu2rHI8MyCiYGItfI08pwLwnBiaOMYQn+txbntKsuJ2SR5LNo6ys7LC6diZj7GeISMbTk/FK490557lLliw5N3fu3D6SJNF8jyRJdyxbtuwLs0cuHYnD6hFON7rUiq7zu8MBLQcU4Cie+MwCb5YbstyutMFDTo4BgKra2lq5B2YgEBA6pl5UzDWLJwBcZFtIjOVbP5Zb6f3ysf6qo9FP+1zHBmpdt+lKHnqPR1lZ2cW41KH+eUF1dXXlzJkzczweTx3nfMHp06cP5uXlUQ3NQkmShi9btkwok5UAJB2Jw3mUHQ5cbg4gYsXwR59e4PW4wZudBdluN2xas9S+2pKpjWhds5Z0EebecG95lXpeOyWPJJtHWVkZSUDj1fRzcnKuvXjx4lrOea3X6z3Y1NTUnJeXR6X8XwCAWdXV1cnlBS034UxwOND1OKBIHj99/H8tIPAg6eP36351ecDjy/2LbpYiEuknVGEraSzZdBKo0fC8JwcCp+6+beMCd/OB1xfMTxTRSVfy0LN5UKe5vLy8GYyxsYjoi6+NXLnU6MZDblBEvImiOAFgG9lEut5j4KzY4UB6HFAAZNT46TKAvPHK8ssDHuf+tHADAk7Q20aqwbRtFgO2sc9Pnk8Ea7UTPFLiPAzUGSrCQ7EWZBQlEDmXk5Mz1MxImt7taTtr//79hmH3BQUFMqJ2940ynHMhuEOeoxe+n477ur37cc6/Mjigtn3UbXjp8oDHX96rDDMuv4i2BkrQcuOw8kTuhlluC3ew6A4AAAN/SURBVABQdik1V0oZdl+geOwHSRzNiDh06dKlZETtsCECHkYAogCHsjg1j+zuu8M26BDushy47HEe596vDCDAoyi1RZRacZNx+JoBbO3z4/Jaq7kd8XtZWdl4xlhzVVVVUkGejriWKHhoAUQLHGoAcYCjI+6UQ1OEAx0WJCZy8attjh3wUADECDiuNt45++18HHDA4xLeE7vgcQmX5lzK4YBtDjjgYZtl6Z/ggEf6vHPO7HwcyAh4UMq0VY0FkTmdjz2xFVF6ulIQR/1vu+tNBzwyWSjX7nqd+Q4HzDiQAh52ra6itRbSAY9AIEC5MdPcbnfJqlWrDPNMlA0i4t9IkjSNc17CGLOcL/poZAo8RK+nnSfK43TpO+c5HEiHA3rgUaFk11ml59r5KtoFj0mTJvXJysqS80zcbvcdq1atMs0zQcREXgrn/A7Knk2HIXrnXG7woDXZ5V+m9u7QcThgxAFD8KA8FIpzNwMQ5YHW/q13MTsPP0WF9uzZs54xRjU4hivNrY02gYguRKxHxELO+XDGmFBeiuhjkQ54+Hw+w2CvYDAo812v/4eypnTqhorux5nncCATHDAEj9ZIFEKtEaCIMxEJpD02j0Ag8LokSbVr166Vq3pNmTKF6lxQpNusmpqalDyTaDT6OuWlMMbk+fGua3JeCmPMMC8FEW9mjNnuJZsOeNC69ABEAQ7l5mWigVAmHgSHhsMBuxzQBQ/K7Q9HIhAKt0KoJQJ7tq42DVkVkSrM5gQCgbNKnglj7Ka4FLFtzZo1unkm0Wj0LOdczkuhNgaSJJGUso1zbpiXQu0LAICqmo1gjB20w6h0wUMLIFrg0AMQR+Kwc2ecuZeTA7rg8fjkXy4gqYPA459+/7/bJXmIqDaBQCAlz8Ttdg81MpIiojxfkqREXgrnfKiRkTQOHFRugAaVILQFIO0BDwVAjIBDDSAOcFzOV8G5tl0O6ILHI5OeXUDAsWPTy5bAQRc0kypEjaolJSVkr5DzTFwu19DVq1eb5pmQfYMkDs55MwAQcOjO1wCHwp8UADGzP9BJaletGZMdALD7CDrzuyoHdMGDKguJ2DqUTVupLaKuxkAgMB4Rm9esWSOUZ4KIVKejmVSWrnoDnHU7HOiqHGh3nIeV5CEKMF2Vgc66HQ5crRzISITp1co8Z98OB65mDjjgcTXffWfvDgfawYH/D7MfvdieNp4hAAAAAElFTkSuQmCC";e.AddFieldOptions={defaultValue:0,addToDefaultContentType:1,addToNoContentType:2,addToAllContentTypes:4,addFieldInternalNameHint:8,addFieldToDefaultView:16,addFieldCheckDisplayName:32};e.ClientErrorCodes={GenericError:-1,AccessDenied:-2147024891,DocAlreadyExists:-2130575257,VersionConflict:-2130575339,ListItemDeleted:-2130575338,InvalidFieldValue:-2130575155,NotSupported:-2147024846,Redirect:-2130575152,NotSupportedRequestVersion:-2130575151,FieldValueFailedValidation:-2130575163,ItemValueFailedValidation:-2130575162};e.Priority={Low:3,Medium:2,High:1,SuperHigh:0};e.FieldTypeToJsGridType={DateTime:"SPDateTime",Choice:"SPTextMaxLength",Attachments:"SPAttachmentsFlag",User:"SPUser",UserMulti:"SPUser",URL:"Hyperlink",Computed:"SPTextMaxLength",Lookup:"SPTextMaxLength",Boolean:"DropdownBoolean",Note:"SPMultilineText",Edit:"SPEdit",TaxonomyFieldType:"TaxonomyField",TaxonomyFieldTypeMulti:"TaxonomyField",Text:"SPTextMaxLength",Number:"SPTextMaxLength",Currency:"SPTextMaxLength",WorkflowStatus:"SPTextMaxLength",Location:"Location",Geolocation:"SPTextMaxLength"}})(t.JsGridConstants||(t.JsGridConstants={}))});
define("aQo",["require","exports","mU","g","f","aPS","aQn","aQp","ji","oJ","bt","ds"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:1725},p={ODB:420};(function(e){e._locationFilldownKillswitchIsActive=l.Killswitch.isActivated("C63C13A2-4C8D-4AF9-AAF4-2F0193EB3C98","11/21/2019","fix filldown for location fields");e.EmptyValue={};e.InvalidValue={};e.serializedFieldSeparator=",#";e.SPUserValueOnPasteFixup=function(t){if(Boolean(e.lastCopiedValueType_SPUser)&&Boolean(e.hasPasteStarted)){for(var n=t.split(e.multiValSeparator),r=[],i=0;i<n.length;i++){var s=n[i].indexOf(e.serializedFieldSeparator);-1!==s?r.push(n[i].substring(0,s)):r.push(n[i])}return m.URI_ConvertMultiColumnValueToString(r,e.multiValSeparator,!1)}return t};function t(e){}e.ClearEventListeners=t;var d=(function(){function e(){this._map=[];this._idxMap=[]}e.prototype.GetIndexForGuid=function(e){var t,n=m.LowerBound(this._map,e,"guid");if(null!=this._map[n]&&this._map[n].guid==e)t=this._map[n].idx;else{t=this._idxMap.length;this._idxMap.push({guid:e,idx:t});this._map.splice(n,0,this._idxMap[t])}return t};e.prototype.LookupIndexForGuid=function(e){var t=m.LowerBound(this._map,e,"guid"),n=null;null!=this._map[t]&&this._map[t].guid==e&&(n=this._map[t].idx);return n};e.prototype.LookupGuidForIndex=function(e){return null!=this._idxMap[e]?this._idxMap[e].guid:null};return e})();e.GuidManager=d;var v=(function(){function e(){this._delay=[10,75,150,500];this._tasks={};this._stopCount=0}e.GetInstance=function(){this._instance||(this._instance=new e);return this._instance};e.prototype.RegisterTask=function(e,t,n){var r=this,i=null==t?s.JsGridConstants.Priority.High:t,o=n,u=setInterval(function(){o in r._tasks&&!e(o)&&r.ClearTask(o)},this._delay[i]);o=null!=o?o:u;this._tasks[o]={intervalId:u,priority:i,fn:e};return o};e.prototype.SetTaskPriority=function(e,t){var n=this._tasks[e];this.ClearTask(e);this.RegisterTask(n.fn,t,e)};e.prototype.GetTaskPriority=function(e){return this._tasks[e]&&this._tasks[e].priority};e.prototype.TaskRegistered=function(e){return e in this._tasks};e.prototype.ClearTask=function(e){var t=this._tasks[e];if(null!=t){clearInterval(t.intervalId);delete this._tasks[e]}};e.prototype.Stop=function(){for(var e in this._tasks)clearInterval(this._tasks[e].intervalId);this._stopCount++};e.prototype.Resume=function(){if(1==this._stopCount){var e={};for(var t in this._tasks)e[t]=this._tasks[t];this._tasks={};for(var t in e)this.RegisterTask(e[t].fn,e[t].priority,t)}this._stopCount=Math.min(this._stopCount-1,0)};return e})();e.AsynchronousTaskManager=v;var m,g=(function(){function e(){this._jobs={};this._maxNumToProcess=10;this._curJobKey=0;this._upShiftThreshold=5;this._downShiftThreshold=20;this._asyncMgr=v.GetInstance()}e.GetInstance=function(){this._instance||(this._instance=new e);return this._instance};e.prototype.TryAdjustThreadPriority=function(e){var t=e.cells.length-e.lastCellCount,n=this._asyncMgr.GetTaskPriority(e.token)==s.JsGridConstants.Priority.SuperHigh;if(!n&&t<this._upShiftThreshold){this._asyncMgr.SetTaskPriority(e.token,s.JsGridConstants.Priority.SuperHigh);n=!0}else if(n&&t>this._downShiftThreshold){this._asyncMgr.SetTaskPriority(e.token,s.JsGridConstants.Priority.Medium);n=!1}return n};e.prototype.ProcessTasks=function(e,t){var n,r=this._jobs[e];if(t)n=r.cells.length;else{var i=this.TryAdjustThreadPriority(r);n=Math.min(i?7*this._maxNumToProcess:this._maxNumToProcess,r.cells.length)}for(var s=0;s<n;s++)try{r.fn.apply(null,r.cells[s])}catch(e){console.log("Exception running job: "+e.toString())}r.cells.splice(0,n);r.lastCellCount=r.cells.length;return 0!==r.cells.length};e.prototype.RegisterCell=function(e,t,n){var r=this._jobs[e];null!=r.token&&this._asyncMgr.TaskRegistered(r.token)||(r.token=this._asyncMgr.RegisterTask(r.fnProcess,s.JsGridConstants.Priority.Medium));r.cells[r.cells.length]=Array.prototype.slice.apply(arguments,[1,arguments.length])};e.prototype.ChangeRecordKeys=function(e,t){for(var n in this._jobs)for(var r=this._jobs[n].cells,i=0;i<r.length;i++)r[i][0]==e&&(r[i][0]=t)};e.prototype.RegisterJob=function(e){var t=this,n=this._curJobKey++;this._jobs[n]={fn:e,cells:[],fnProcess:function(){return t.ProcessTasks(n)},lastCellCount:0};return n};e.prototype.FlushJob=function(e){e in this._jobs&&this.ProcessTasks(e,!0)};return e})();e.AsynchronousCellUpdater=g;e.DebugAssert=function(e,t){0};(function(t){(function(e){e._hex2pos={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15};e._pos2hex="0123456789ABCDEF";function t(e,t,r){return n(1,e,t,r)}e.MakeColor=t;function n(e,t,n,r){return{a:e,r:t*e,g:n*e,b:r*e}}e.MakeAlphaColor=n;e.RemoveAlphaChannel=function(e){return e.a<1?t(e.r/e.a,e.g/e.a,e.b/e.a):e};e.HexStringToColor=function(r){function i(t){var n=t.charAt(0),r=1==t.length?n:t.charAt(1);return(16*e._hex2pos[n]+e._hex2pos[r])/255}var s,o;if("#"==r.charAt(0)){var u=r.toUpperCase();s=4==u.length?t(i(u.substr(1,1)),i(u.substr(2,1)),i(u.substr(3,1))):t(i(u.substr(1,2)),i(u.substr(3,2)),i(u.substr(5,2)))}else 0==r.indexOf("rgb(")||0==r.indexOf("RGB(")?s=t((o=r.substr(4,r.length-5).split(","))[0]/255,o[1]/255,o[2]/255):0!=r.indexOf("rgba(")&&0!=r.indexOf("RGBA(")||(s=n((o=r.substr(5,r.length-6).split(","))[3],o[0]/255,o[1]/255,o[2]/255));return s};e.ColorToHexString=function(t){function n(t){t=Math.floor(255*t);return e._pos2hex.charAt(Math.floor(t/16))+e._pos2hex.charAt(t%16)}return"#"+n(t.r)+n(t.g)+n(t.b)};e.AlphaBlend=function(e,t){var r=1-e.a;return n(e.a+t.a*r,e.r+r*t.r,e.g+r*t.g,e.b+r*t.b)}})(t.Color||(t.Color={}));t.object=function(e){function t(){}t.prototype=e;return new t};t.ConvertTableToMap=function(e,t,n){for(var r={},i=0;i<e.length;i++)r[e[i][t]]=null!=n?e[i][n]:e[i];return r};t.ConvertTableColumnToArray=function(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r][t]);return n};t.ConvertSetKeysToArray=function(e){var t=[];for(var n in e)t.push(n);return t};t.ConvertSetDataToArray=function(e){var t=[];for(var n in e)t.push(e[n]);return t};t.ConvertArrayToSet=function(e,t){for(var n={},r=0;r<e.length;r++)n[e[r][t]]=e[r];return n};t.EncodeString=function(e){return'"'+e+'"'};t.MoveItemInArray=function(e,t,n){var r=e.splice(t,1);e.splice(n,0,r[0])};t.GetFirstElement=function(e){for(var t in e)return e[t]};t.IsAssocArrayEmpty=function(e){for(var t in e)return!1;return!0};t.GetAssocArraySize=function(e){var t=0;for(var n in e)t++;return t};t.CloneObj=function e(t,n){var r;if(null==t)return null;if(null!=t.clone&&n)return t.clone();if(null!=t.Clone&&n)return t.Clone();if(t instanceof Array){r=[];for(var i=0;i<t.length;i++)r.push(n?e(t[i],!0):t[i]);return r}if(t instanceof Date)return r=new Date(t.getTime());if(t instanceof Function)return t;if(t instanceof Object){var s=!0;for(var o in t)s=s&&!(t[o]instanceof Function);if(s){r={};for(var o in t)o in r||(r[o]=n?e(t[o],!0):t[o])}return r}return t};t.BinarySearch=function(e,n,r){var i=t.LowerBound(e,n,r);return i===e.length||(r?e[i][r]:e[i])!==n?null:i};t.LowerBound=function(e,n,r){return t.LowerBoundCompare(e,n,function(t,n){var i=r?e[t][r]:e[t];return n>i?1:i>n?-1:0})};t.LowerBoundCompare=function(e,t,n){for(var r,i=-1,s=e.length;s-i>1;)n(r=i+s>>>1,t)>0?i=r:s=r;return s};t.UpperBound=function(e,t,n){for(var r,i=-1,s=e.length;s-i>1;){r=i+s>>>1;t>=(n?e[r][n]:e[r])?i=r:s=r}return s};t.Compose=function(e,t){return function(n){var r=t?t(n):n;return e?e(r):r}};t.FindInArray=function(e,t,n){for(var r,i=0;i<e.length;i++)if(t(e[i])){r=i;if(!n)break}return r};t.Find=function(e,t,r){var i=n(e,t,r);return null==i?null:e[i]};function n(e,t,n){var r=void 0;for(var i in e)if(t(e[i])){r=i;if(!n)break}return r}t.FindKey=n;t.RoundTo=function(e,t){var n=Math.pow(10,t);return 0==e?e:Math.round(e*n)/n};t.shutUpKeys=null;t.CoalesceFunctionCalls=function(e,t,n){null==this._shutUpKeys&&(this._shutUpKeys=new o.Set);var r=this._shutUpKeys;if(!r.Contains(e)){r.Add(e);setTimeout(function(){r.Remove(e);t()},null==n?0:n)}};t.Flatten2LevelArray=function(e){var t=[];for(var n in e)for(var r in e[n])t.push(e[n][r]);return t};t.TokenizeString=function(t,n){var r=[];if(null!=t&&t!==e.EmptyValue)for(var i=t.split(n),s=0;s<i.length;s++){var o=i[s].replace(/^\s+|\s+$/g,"");""!==o&&r.push(o)}return r};t.JoinStrings=function(e,t){if(null==e)return null;for(var n=[],r=0;r<e.length;r++)""!==e[r]&&null!=e[r]&&n.push(e[r]);return n.join(t)};t.ProfilerMark=function(e){window.msWriteProfilerMark&&window.msWriteProfilerMark(e)};(function(e){e.OnRowHeaderStateChanged=function(e,t){return{recordKey:e,rowHeaderState:t}};e.ChangeKeyStageUpdated=function(e){return{changeKey:e}};e.RecordInserted=function(e){return{recordKey:e}};e.RecordDeleted=function(e){return{recordKey:e}}})(t.EventArgs||(t.EventArgs={}));t.EmptyFunction=function(){};t.CrackCellKey=function(e){var t=e.split(",");return{rowIdx:t[0],colIdx:t[1]}};t.MakeCellKey=function(e,t){return[e,t].join()};t.IsNoOpChange=function(e,t){var n=e.fieldKey;return!(t.HasLocalizedValue(n)&&e.oldProp.localized!=e.newProp.localized||t.HasDataValue(n)&&e.oldProp.data!=e.newProp.data)};var r=(function(){function n(){var e=this;this._zoomFactor=1;this.OnMouseMove=function(t){null!=e._fnUserOnMouseMove&&e._fnUserOnMouseMove(t)};this.OnMouseUp=function(t){null!=e._fnUserOnMouseUp&&e._fnUserOnMouseUp(t);e.ReleaseCapture()};this.StopEvent=function(e){e.stopPropagation();e.preventDefault()};this.CacheIEZoomFactor=function(){if(e.BrowserIsIE){var t,n;if(null==(t=document.getElementById("__iezoomtest1"))||null==(n=document.getElementById("__iezoomtest2"))){t=document.createElement("div");n=document.createElement("div");t.style.cssText="position:absolute;top:0px;left:0px";n.style.cssText="position:absolute;top:0px;left:200px";t.appendChild(n);t.id="__iezoomtest1";n.id="__iezoomtest2";document.body.appendChild(t)}var r=t.getBoundingClientRect(),i=n.getBoundingClientRect(),s={x:r.left,y:r.top},o={x:i.left,y:i.top};e._zoomFactor=(o.x-s.x)/200;0==e._zoomFactor&&(e._zoomFactor=1)}};this.BrowserIsIE=!1;this.BrowserIsIEAndRenderingModeIs7=!1;this.BrowserCanRenderVml=!1;this.functionsRequiringInit=[{name:"SetText",selector:function(){return null!=document.body.innerText?function(e,t){e.innerText=t}:function(e,t){e.textContent=t}}},{name:"GetScreenOffsets",selector:function(){return"pageYOffset"in window?function(){return{top:window.pageYOffset,left:window.pageXOffset}}:function(){return{top:document.documentElement.scrollTop,left:document.documentElement.scrollLeft}}}},{name:"GetXmlHttpObj",selector:function(){return window.XMLHttpRequest?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")}}},{name:"GetComputedStyle",selector:function(){return null!=document.defaultView&&null!=document.defaultView.getComputedStyle?function(e,t,n){var r=document.defaultView.getComputedStyle(e,null);return r?r.getPropertyValue(n):""}:function(e,t,n){return"width"==t?String(e.offsetWidth)+"px":e.currentStyle[t]}}},{name:"AdjustCoordsForIEZoom",selector:function(){if(e.BrowserIsIE){e.CacheIEZoomFactor();window.addEventListener("resize",e.CacheIEZoomFactor)}return function(t){return{x:Math.round(t.x/e._zoomFactor),y:Math.round(t.y/e._zoomFactor)}}}},{name:"GetOuterHTML",selector:function(){return null!=document.body.outerHTML?function(e){return e.outerHTML}:function(e){var t=e.ownerDocument,n=e.cloneNode(!0),r=t.createElement("div");t.documentElement.appendChild(r);r.appendChild(n);var i=r.innerHTML;t.documentElement.removeChild(r);return i}}}];for(var t=function(t){var n=e;n[t.name]=function(){n[t.name]=t.selector();return n[t.name].apply(n,arguments)}},n=0;n<this.functionsRequiringInit.length;n++)t(this.functionsRequiringInit[n])}n.GetInstance=function(){n._instance||(n._instance=new n);return n._instance};n.prototype.SetCapture=function(e,n,r){this._bUsingIE=!1;this._captureElem=e;this._fnUserOnMouseMove=n;this._fnUserOnMouseUp=r;this._origBodyCursor=document.body.style.cursor;document.body.style.cursor=t.DomElement.GetInstance().GetComputedStyle(this._captureElem,"cursor","cursor");document.addEventListener("mousemove",this.OnMouseMove,!0);document.addEventListener("mouseup",this.OnMouseUp,!0);document.addEventListener("mouseover",this.StopEvent,!0);document.addEventListener("mouseenter",this.StopEvent,!0);document.addEventListener("mouseleave",this.StopEvent,!0)};n.prototype.ReleaseCapture=function(){if(null!=this._captureElem){if(this._bUsingIE){this._captureElem.releaseCapture();document.removeEventListener("mousemove",this.OnMouseMove);document.removeEventListener("mouseup",this.OnMouseUp)}else{document.body.style.cursor=this._origBodyCursor;document.removeEventListener("mousemove",this.OnMouseMove,!0);document.removeEventListener("mouseup",this.OnMouseUp,!0);document.removeEventListener("mouseover",this.StopEvent,!0);document.removeEventListener("mouseenter",this.StopEvent,!0);document.removeEventListener("mouseleave",this.StopEvent,!0)}this._captureElem=null;this._fnUserOnMouseMove=null;this._fnUserOnMouseUp=null;this._origBodyCursor=null}};n.prototype.OnMouseWheel=function(e,t){var n=e.rawEvent;e.wheelDelta=Math.round(null!=n.wheelDelta?n.wheelDelta/-40:n.detail);t(e)};n.prototype.AttributeOnElementOrAncestor=function(e,t,n){for(;null!=e&&null!=e.getAttribute;){if(e.getAttribute(t)==n)return!0;e=e.parentNode}return!1};n.prototype.PointInDomElem=function(t,n,r,i){var s=null==i?e.Internal.DomElement.GetInstance().GetLocation(r):i;return s.x<=t&&s.x+r.offsetWidth>=t&&s.y<=n&&s.y+r.offsetHeight>=n};n.prototype.ElementAttachedToDom=function(t){if(null!=document.body.contains)return document.body.contains(t);e.DebugAssert(null!=document.body.compareDocumentPosition);return document.body.compareDocumentPosition(t)>=16};n.prototype.ForceIEZoomFactorRecomputation=function(){this.CacheIEZoomFactor()};n.prototype.GetLocation=function(e){var n=e.getBoundingClientRect();return t.DomElement.GetInstance().AdjustCoordsForIEZoom({x:n.left,y:n.top})};n.prototype.GetEventLocation=function(e){var n=t.DomElement.GetInstance().GetScreenOffsets();return t.DomElement.GetInstance().AdjustCoordsForIEZoom({x:e.clientX+n.left,y:e.clientY+n.top})};n.prototype.GetNextElement=function(e){do{var t=e.nextSibling}while(t&&1!==t.nodeType);return t};n.prototype.GetPrevElement=function(e){do{var t=e.previousSibling}while(t&&1!==t.nodeType);return t};n.prototype.GetFirstChildElement=function(e){for(var t=e.firstChild;t&&1!==t.nodeType;)t=e.nextSibling;return t};n.prototype.AddMouseWheelHandler=function(e,t){var n=this,r=function(e){n.OnMouseWheel(e,t)};null==e._mouseWheelFnInfo&&(e._mouseWheelFnInfo=[]);e._mouseWheelFnInfo.push({usrFn:t,wheelFn:r});e.addEventListener("mousewheel",r);e.addEventListener("DOMMouseScroll",r)};n.prototype.RemoveMouseWheelHandler=function(t,n){var r=e.Internal.FindInArray(t._mouseWheelFnInfo,function(e){return e.usrFn==n});if(null!=r){t.removeEventListener("mousewheel",t._mouseWheelFnInfo[r].wheelFn);t.removeEventListener("DOMMouseScroll",t._mouseWheelFnInfo[r].wheelFn);1==t._mouseWheelFnInfo.length?t._mouseWheelFnInfo=null:t._mouseWheelFnInfo.splice(r,1)}};n.prototype.GetCustomAttribute=function(e,t){var n=null!=e.getAttribute?e.getAttribute(t):null;return null==n||""==n?e[t]:n};n.prototype.GetParentElement=function(e){var t=e.parentNode;return t&&1!==t.nodeType?null:t};n.prototype.GetAncestorByTag=function(e,t){if(null===e)return null;for(var n=e.parentNode;null!==n&&n.tagName!==t;)n=n.parentNode;return n};n.prototype.SetOpacity=function(e,t){e.style.opacity=t;e.style["-moz-opacity"]=t;e.style.filter="alpha(opacity="+100*t+")"};n.prototype.RemoveOpacity=function(e){e.style.opacity="";e.style["-moz-opacity"]=1;e.style.filter=""};n.prototype.ForEachElementChild=function(e,t,n){n||t(e);for(var r=0;r<e.childNodes.length;r++)this.ForEachElementChild(e.childNodes[r],t,!1)};n.prototype.FindAncestorWithProperty=function(e,t,n){return null==e?null:void 0!==this.GetCustomAttribute(e,t)?{elem:e,child:n}:this.FindAncestorWithProperty(e.parentNode,t,e)};n.prototype.FindFirstAncestorWithAnyPropertyValue=function(e,t,n,r){return null==e?null:this.GetCustomAttribute(e,t)in n?{elem:e,child:r}:this.FindFirstAncestorWithAnyPropertyValue(e.parentNode,t,n,e)};n.prototype.GetChildrenWithCustomAttribute=function(e,t){var n=this,r={};this.ForEachElementChild(e,function(e){var i=n.GetCustomAttribute(e,t);null!=i&&(r[i]=e)},null);return r};n.prototype.FindChildrenWithProperty=function(e,t){var n=[];(function e(r,i){for(var s=0;s<r.childNodes.length;s++){var o=r.childNodes[s];null!=this.GetCustomAttribute(o,t)&&n.push(o);e(o,t)}})(e);return n};n.prototype.ComputeMaximumSizeForWebPart=function(t,n){var r={},i=document.getElementById("MSO_ContentTable");e.DebugAssert(null!=i,"The function 'ComputeMaximumSizeForWebPart' may only be called on a sharepoint web part page");var s=this.GetLocation(t),o=this.GetLocation(i);n||(t.style.display="none");var u=s.y-o.y;r.height=i.offsetHeight-u;u=s.x-o.x;r.width=i.offsetWidth-u;n||(t.style.display="block");return r};n.prototype.SetMouseHover=function(e,t,n,r){e.addEventListener("mousemove",u);e.addEventListener("mouseout",o);var i=!0,s=!1;function o(){s=!0;setTimeout(a,0)}function u(e){i&&null!=t&&t();null!=r&&r(e);i=s=!1}function a(){if(!i&&s){null!=n&&n();i=!0;s=!1}}return function(){e.addEventListener("mouseout",o);e.addEventListener("mousemove",u);o=null;u=null;a=null;e=null}};n.prototype.DashNameFromCamelName=function(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})};n.prototype.CamelNameFromDashName=function(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})};n.prototype.GetXmlDomObj=function(e){var t;if(document.implementation&&document.implementation.createDocument)t=document.implementation.createDocument("","",null);else try{var n=document.createElement("xml");document.body.appendChild(n);t=n.XMLDocument;document.body.removeChild(n)}catch(e){(t=new ActiveXObject("Microsoft.XMLDOM")).setProperty("ProhibitDTD",!0)}if(null!=e)if("loadXML"in t){t.async=!1;t.loadXML(e)}else t=(new DOMParser).parseFromString(e,"text/xml");return t};n.prototype.SetTextNoBR=function(e,t){e.innerHTML="";e.appendChild(document.createTextNode(t))};return n})();t.DomElement=r;var i=(function(){function e(){this.Reset()}e.prototype.ElapsedMs=function(){return(new Date).getTime()-this.start};e.prototype.Reset=function(){this.start=(new Date).getTime()};e.prototype.toString=function(e){var t=this.ElapsedMs(),n=new Date(t),r=Math.floor(t/36e5),i=n.getUTCMinutes(),s=n.getUTCSeconds()+n.getUTCMilliseconds()/1e3;if("M"==e){i+=60*r;r=0}else if("S"==e){s+=60*(60*r+i);r=i=0}var o=[];r&&o.push(r);r+i&&o.push((i<10?"0":"")+i);o.push((s<10?"0":"")+s.toFixed(3));return o.join(":")};return e})();t.Timer=i;t.CallAsyncFn=function(e,t,n,r){e(function(){null!=t&&t();null!=r&&r()})?t():null!=n&&n()};function u(e,t){for(var n=e[t],r=e.offsetParent;null!=r&&"BODY"!==r.tagName;){n+=r[t];r=r.offsetParent}null!=r&&(n+=r[t]);return n}t.DOM_Abs=u;t.DOM_AbsLeft=function(e){return u(e,"offsetLeft")};t.DOM_AbsTop=function(e){return u(e,"offsetTop")};function a(e,t,n){if(void 0!==document.defaultView&&void 0!==document.defaultView.getComputedStyle){var r=document.defaultView.getComputedStyle(e,null);return n?r.getPropertyValue(n):r}return"width"==t?String(e.offsetWidth)+"px":e.currentStyle[t]}t.GetCurrentStyle=a;t.GetVisible=function(e){var t=a(e,"");return"hidden"!==t.visibility&&"none"!==t.display};t.GenerateIID=function(e){return f(e,e.CurrentItem)};function f(e,t){return e.ctxId+","+t.ID+","+t.FSObjType}t.GenerateIIDForListItem=f;t.IsElementRtl=function(e){for(;null!=e&&null!=e.tagName;){var t=e.getAttribute("dir");null!=t&&""!=t||null==e.style||(t=e.style.direction);if("rtl"==t)return!0;if("ltr"==t)return!1;e=e.parentNode}return!1};t.AddCssClass=function(e,t){e.className+=" "+t};t.RemoveCssClass=function(e,t){e.classList.remove(t)};t.URI_ConvertMultiColumnValueToString=function(e,t,n){null==t&&(t=";#");null==n&&(n=!0);for(var r=t.charAt(0),i=r+r,s=new RegExp(t.charAt(0),"g"),o=!1,u="",a=0;a<e.length;a++){var f=e[a];null!=f&&f.length>0&&(f=f.replace(s,i));null!=f&&f.length>0&&(o=!0);(n||0!==a)&&(u+=t);u+=f}if(o){n&&(u+=t);return u}return""};t.GetEventSrcElement=function(e){return null!=e.target?e.target:null};t.GenerateXMLArray=function(e,t){var n=[];if(null!=e){var r="<"+t+">",i="</"+t+">";for(var s in e){n.push(r);n.push(e[s]);n.push(i)}}return n.join("")};t.EscapeProperly=function(e,n,r,i){var s="",o=0;if(void 0===e)return"";for(o=0;o<e.length;o++){var u=e.charCodeAt(o),a=e.charAt(o);if(n&&("#"==a||"?"==a)){s+=e.substr(o);break}if(r&&"&"==a)s+=a;else if(u<=127)i||u>=97&&u<=122||u>=65&&u<=90||u>=48&&u<=57||n&&u>=32&&u<=95&&" \"%<>'&".indexOf(a)<0?s+=a:u<=15?s+="%0"+u.toString(16).toUpperCase():u<=127&&(s+="%"+u.toString(16).toUpperCase());else if(u<=2047){s+="%"+(t.Utf8Variables.UTF8_1ST_OF_2|u>>6).toString(16).toUpperCase();s+="%"+(t.Utf8Variables.UTF8_TRAIL|63&u).toString(16).toUpperCase()}else if((u&t.Utf8Variables.SURROGATE_6_BIT)!=t.Utf8Variables.HIGH_SURROGATE_BITS){s+="%"+(t.Utf8Variables.UTF8_1ST_OF_3|u>>12).toString(16).toUpperCase();s+="%"+(t.Utf8Variables.UTF8_TRAIL|(4032&u)>>6).toString(16).toUpperCase();s+="%"+(t.Utf8Variables.UTF8_TRAIL|63&u).toString(16).toUpperCase()}else if(o<e.length-1){u=(1023&u)<<10;o++;u|=1023&e.charCodeAt(o);u+=t.Utf8Variables.SURROGATE_OFFSET;s+="%"+(t.Utf8Variables.UTF8_1ST_OF_4|u>>18).toString(16).toUpperCase();s+="%"+(t.Utf8Variables.UTF8_TRAIL|(258048&u)>>12).toString(16).toUpperCase();s+="%"+(t.Utf8Variables.UTF8_TRAIL|(4032&u)>>6).toString(16).toUpperCase();s+="%"+(t.Utf8Variables.UTF8_TRAIL|63&u).toString(16).toUpperCase()}}return s};t.Utf8Variables={UTF8_1ST_OF_2:192,UTF8_1ST_OF_3:224,UTF8_1ST_OF_4:240,UTF8_TRAIL:128,HIGH_SURROGATE_BITS:55296,LOW_SURROGATE_BITS:56320,SURROGATE_6_BIT:64512,SURROGATE_ID_BITS:63488,SURROGATE_OFFSET:65536};t.IsXhrAborted=function(e){try{if(4==e.readyState&&(void 0===e.status||0==e.status))return!0}catch(e){return!0}return!1};t.IsStrNullOrEmpty=function(e){return null==e||""==e};t.IsNullOrUndefined=function(e){return null==e||null==e};var d=(function(){function e(e){this.nonFilterParams={};this.filterParams={};null==e&&(e="");0==e.indexOf("?")&&(e=e.substring(1));this.nonFilterParams={};this.filterParams={};var t,n=e.split("&");for(t=0;t<n.length;t++){var r=n[t].split("=");if(2==r.length)if(-1!=r[0].search("^Filter")){var i,s=r[0].match(new RegExp("[0-9]*$"));if(void 0!==this.filterParams[s])i=this.filterParams[s];else{i=new Object;this.filterParams[s]=i}i[r[0].match(new RegExp("^Filter[^0-9]*"))]=r[1]}else this.nonFilterParams[r[0]]=r[1]}}e.prototype.toArray=function(){var e,t,n=[],r=1;for(e in this.filterParams){var i=this.filterParams[e];for(e in i){(t=[]).push(e);t.push(r);t.push("=");t.push(i[e]);n.push(t.join(""))}r++}for(e in this.nonFilterParams){(t=[]).push(e);t.push("=");t.push(this.nonFilterParams[e]);n.push(t.join(""))}return n};return e})();t.List_QstringStruct=d;t.List_ReconcileQstringFilters=function(e,t){var n=[];n.push(new d(e));n.push(new d(t));var r,i,s,o,u=[];for(r=0;r<n.length;r++)for(s in n[r].nonFilterParams)if(0==r||void 0===n[0].nonFilterParams[s]&&1==r){(o=[]).push(s);o.push("=");o.push(n[r].nonFilterParams[s]);u.push(o.join(""))}var a=1,f=new Object;for(r=0;r<n.length;r++)for(i in n[r].filterParams){var l=n[r].filterParams[i],c="string"==typeof l.FilterField?l.FilterField:null;null==c&&(c="string"==typeof l.FilterFields?l.FilterFields:null);if(null!=c&&void 0===f[c]){for(s in l){(o=[]).push(s);o.push(a);o.push("=");o.push(l[s]);u.push(o.join(""))}a++;f[l.FilterField]=l}}return u.join("&")};t.UnescapeProperly=function(e){var t=null;if("undefined"!=typeof decodeURIComponent){t=decodeURIComponent(e);var n=v(e);t!=n&&alert("unescapeProperly error\noriginal string = "+e+"\ndecodeURIComponent string = "+t+"\nunescapeProperlyInternal string = "+n)}else t=v(e);return t};function v(e){if(null==e)return"null";for(var t,n,r=0,i=0,s="",o=new Array,u=0;r<e.length;)if("%"==e.charAt(r))if("u"==e.charAt(++r)){t="";for(i=0;i<4&&r<e.length;++i)t+=e.charAt(++r);for(;t.length<4;)t+="0";n=parseInt(t,16);isNaN(n)?s+="?":s+=String.fromCharCode(n)}else{t="";for(i=0;i<2&&r<e.length;++i)t+=e.charAt(r++);for(;t.length<2;)t+="0";n=parseInt(t,16);if(isNaN(n)){if(u){s+=y(o);u=0;o.length=u}s+="?"}else o[u++]=n}else{if(u){s+=y(o);u=0;o.length=u}s+=e.charAt(r++)}if(u){s+=y(o);u=0;o.length=u}return s}var m,g=[0,128,2048,65536,2097152,67108864,2147483648];function y(e){for(var t,n,r,i,s=0,o="";s<e.length;)if(e[s]<=127)o+=String.fromCharCode(e[s++]);else{n=e[s++];i=r=Boolean(32&n)?Boolean(b(n))?3:2:1;t=n&255>>>2+r;for(;Boolean(r)&&s<e.length;){--r;if(0==(n=e[s++]))return o;if(128!=(192&n)){o+="?";break}t=t<<6|63&n}if(Boolean(r)){o+="?";break}if(t<g[i]){o+="?";break}if(t<=65535)o+=String.fromCharCode(t);else if(t<=1114111){t-=65536;o+=String.fromCharCode(55296|t>>>10);o+=String.fromCharCode(56320|w(t))}else o+="?"}return o}function b(e){return 16&e}function w(e){return 1023&e}t.GetInnerText=function(e){return void 0!==e.textContent&&null!=e.textContent?e.textContent:void 0!==e.innerText?e.innerText:void 0};t.EnsureFileLeafRefName=function(e){if(void 0===e["FileLeafRef.Name"]){var t=e.FileLeafRef,n=t.lastIndexOf(".");n>=0&&l.Killswitch.isActivated("48F7CF05-25D8-41E7-9508-D739EC3005C3","10/30/2019","Do not truncate the file name in Quick Edit editors")?e["FileLeafRef.Name"]=t.substring(0,n):e["FileLeafRef.Name"]=t}};t.Encoding_STSHtmlDecode=function(e){if(null==e)return"";var t=[/\&lt;/g,/\&gt;/g,/\&quot;/g,/\&#39;/g,/\&#58;/g,/\&#123;/g,/\&#125;/g,/\&amp;/g],n=["<",">",'"',"'",":","{","}","&"],r=[],i=0,s=t.length;for(i=0;i<s;i++){var o=e.indexOf("&");if(-1==o)break;if(0<o){r.push(e.substr(0,o));e=e.substr(o)}e=e.replace(t[i],n[i])}r.push(e);return r.join("")};t.Encoding_STSHtmlEncode=function(e){if(null==e)return"";var t=new String(e),n=[],r=0,i=t.length;for(r=0;r<i;r++){var s=t.charAt(r);switch(s){case"<":n.push("&lt;");break;case">":n.push("&gt;");break;case"&":n.push("&amp;");break;case'"':n.push("&quot;");break;case"'":n.push("&#39;");break;default:n.push(s)}}return n.join("")};t.GetCSSClassForFieldTd=function(e){return"TRUE"==e.CalloutMenu||"Menu"==e.ClassInfo||"TRUE"==e.listItemMenu?"ms-cellstyle ms-vb-title":"Menu"==e.ClassInfo||"TRUE"==e.listItemMenu?"ms-cellstyle ms-vb-title ms-positionRelative":"Icon"==e.ClassInfo?"ms-cellstyle ms-vb-icon":"User"==e.Type||"UserMulti"==e.Type?"ms-cellstyle ms-vb-user":"ms-cellstyle ms-vb2"};t.SiteUrl="";t.GetImageUrl=function(t){return e.Internal.SiteUrl+s.JsGridConstants.ImagesDirectory+t};t.GetLocalizedImageUrl=function(t){return e.Internal.SiteUrl+"/_layouts/15/1033/images/"+t};t.GetScrollParent=function e(t){return"true"===t.getAttribute("data-is-scrollable")?t:t.parentElement?e(t.parentElement):null};t.GetGridParentElement=function(){var e=document.getElementsByClassName("quickEditParentDiv");return e&&e.length>0?e[0]:null};t.GetFocusElement=function(){return document.getElementById("spgridcontainer_"+e.privateWpq+"_focusElement")};function E(e){return window.g_SPGridInitInfo[Object.keys(window.g_SPGridInitInfo)[0]].jsInitObj.flightStatus[e.ODB]}t.IsFeatureEnabled=E;t.IsStickyColumnEnabled=function(){if(E(p)){void 0===m&&(m=new c.PlatformDetection);return E(h)&&E(p)&&!m.isIE}};t.normalizeColumnKey=function(e){return"Title"===e?"LinkTitle":e};t.positionWidget=function(t,n,r){if(r){var i=e.Internal.GetGridParentElement(),s=i.getElementsByTagName("TABLE")[0].clientWidth-t.offsetWidth,o=e.Internal.GetScrollParent(i).scrollWidth-t.offsetWidth;t.style.left=Math.min(s,o,n.x)+"px"}else t.style.left=Math.max(0,n.x+n.width-t.offsetWidth)+"px"}})(m=e.Internal||(e.Internal={}));(function(e){e.CellFocusChanged=function(e,t,n,r){return{newRecordKey:e,newFieldKey:t,oldRecordKey:n,oldFieldKey:r}};e.RowFocusChanged=function(e,t){return{newRecordKey:e,oldRecordKey:t}};e.CellEditBegin=function(e,t){return{recordKey:e,fieldKey:t}};e.CellEditCompleted=function(e,t,n,r){return{recordKey:e,fieldKey:t,changeKey:n,bCancelled:r}};e.Click=function(e,t,n,r){return{eventInfo:e,context:t,recordKey:n,fieldKey:r}};e.PropertyChanged=function(e,t,n,r,i,s,o){return{recordKey:e,fieldKey:t,oldProp:n,newProp:r,propType:i,changeKey:s,validationState:o}};e.RecordInserted=function(e,t,n,r){return{recordKey:e,recordIdx:t,afterRecordKey:n,changeKey:r}};e.RecordDeleted=function(e,t,n){return{recordKey:e,recordIdx:t,changeKey:n}};e.RecordChecked=function(e,t){return{recordKeySet:e,bChecked:t}};e.OnCellErrorStateChanged=function(e,t,n,r,i,s){return{recordKey:e,fieldKey:t,bAddingError:n,bCellCurrentlyHasError:r,bCellHadError:i,errorId:s}};e.OnRowErrorStateChanged=function(e,t,n,r,i,s){return{recordKey:e,bAddingError:t,bErrorCurrentlyInRow:n,bRowHadError:r,errorId:i,message:s}};e.OnEntryRecordAdded=function(e){return{recordKey:e}};e.OnEntryRecordCommitted=function(e,t,n){return{originalRecordKey:e,recordKey:t,changeKey:n}};e.SingleCellClick=function(e,t,n){return{eventInfo:e,recordKey:t,fieldKey:n}};e.PendingChangeKeyInitiallyComplete=function(e){return{changeKey:e}};e.VacateChange=function(e){return{changeKey:e}};e.GridErrorStateChanged=function(e){return{bAnyErrors:e}};e.SingleCellKeyDown=function(e,t,n){return{eventInfo:e,recordKey:t,fieldKey:n}};e.OnRecordsReordered=function(e,t){return{reorderedKeys:e,changeKey:t}};e.OnRowEscape=function(e){return{recordKey:e}};e.OnEndRenameColumn=function(e,t,n){return{columnKey:e,originalColumnTitle:t,newColumnTitle:n}};e.OnBeginRedoDataUpdateChange=function(e){return{changeKey:e}};e.OnBeginUndoDataUpdateChange=function(e){return{changeKey:e}}})(e.EventArgs||(e.EventArgs={}));var y=(function(){function e(e,t,n,r,i){this.imgSrc=e;this.bIsClustered=t;this.outerCssNames=n;this.imgCssNames=r;this.bIsAnimated=i;this._imageWithFabricIcons=new b({imgSrc:e,bIsClustered:t,optOuterCssNames:n,optImgCssNames:r,bIsAnimated:i})}e.prototype.Render=function(e,t,n){return this._imageWithFabricIcons.Render(e,t,n)};return e})();e.Image=y;var b=(function(){function t(e){this.imgSrc=e.imgSrc;this.bIsClustered=e.bIsClustered;this.outerCssNames=e.optOuterCssNames;this.imgCssNames=e.optImgCssNames;this.bIsAnimated=e.bIsAnimated;this.iconProps=e.iconProps;this.spinnerProps=e.spinnerProps}t.prototype.Render=function(t,o,u){if(!this.imgSrc&&!this.iconProps&&!this.spinnerProps)return null;var l;if(this.iconProps||this.spinnerProps){var c=document.createElement("span");this.iconProps?r.render(i.createElement(a.Icon,n.__assign({ariaLabel:t},this.iconProps)),c):r.render(i.createElement(f.Spinner,n.__assign({ariaLabel:t},this.spinnerProps)),c);l=c}else{var h=document.createElement("img");h.src=this.imgSrc;if(null!=t){h.alt=t;u||(h.title=t)}else h.alt="";l=h}l.style.border="0";null!=this.imgCssNames&&(l.className=this.imgCssNames);if(this.bIsClustered){var p=document.createElement("div");p.className=this.outerCssNames;p.appendChild(l);l=p}if(this.bIsAnimated){e.DebugAssert(null==o,"Cannot specify a clickFn to an animated image.");o=function(e){l.style.visibility="hidden"}}if(null!=o){l.addEventListener("mousedown",o);l.addEventListener("keydown",function(e){e.keyCode==s.JsGridConstants.Key.enter&&o(e)});l.style.cursor="pointer";l.tabIndex=-1}null!=o&&(l.Dispose=function(){o=null;p=null;l.Dispose=null;l=null});return l};return t})();e.ImageWithFabricIcons=b;e.ApplyServerChangesToGrid=function(t,n,r,i,o,a){var f;if(null!=n)for(var l=0;l<n.length;l++){for(var c=n[l],h=[],p=[],d=[],v=0;v<c.updates.length;v++){var m=c.updates[v];m.type==s.JsGridConstants.ChangeType.Prop?h.push(g(m.recordKey,m.fieldKey,m.newProp)):m.type==s.JsGridConstants.ChangeType.Insert?d.push(m):m.type==s.JsGridConstants.ChangeType.Delete&&p.push(m.recordKey)}w(d);E(h);S(p);f=null}function g(e,t,n){return n.hasLocalizedValue&&n.hasDataValue?u.CreateValidatedPropertyUpdate(e,t,n.dataValue,n.localizedValue):u.CreateUnvalidatedPropertyUpdate(e,t,n.hasDataValue?n.dataValue:n.localizedValue,!n.hasDataValue)}function y(){var n=f;null!=n||o||(-1==c.changeNumber?e.DebugAssert(!1,"Invalid change list from server - if these changes are to be applied as a new update, please set the bOptNewChange parameter to true"):n=t.GetChangeKeyForVersion(c.changeNumber));return n}function b(e){f=e}function w(t){for(var n=0;n<t.length;n++){var i=r(t[n].afterRecordKey,t[n].recordKey,y());e.DebugAssert(null!=i,"The change key from inserting the record must be returned.");b(i)}}function E(e){if(h.length>0){var n=t.UpdateProperties(h,s.JsGridConstants.UserAction.UserEdit,y());null!=a&&a(h,n);b(n)}}function S(e){if(p.length>0){b(t.DeleteRecords(p,y()))}}};var w=(function(){function t(){this.events={}}t.prototype.FireEvent=function(e,t){var n=this.events[e];if(null!=n)for(var r in n)n[r](t)};t.prototype.AttachEvent=function(e,t){null==this.events[e]&&(this.events[e]=[]);this.events[e].push(t)};t.prototype.DetachEvent=function(t,n){if(null!=this.events[t]){var r=e.Internal.FindInArray(this.events[t],function(e){return e==n},null);null!=r&&this.events[t].splice(r,1)}};return t})();e.EventManager=w;var E=(function(){function e(){this._delegates={}}e.prototype.SetDelegate=function(e,t){null!=t?this._delegates[e]=t:delete this._delegates[e]};e.prototype.DelegatePresent=function(e){return e in this._delegates};e.prototype.GetDelegate=function(e){return this._delegates[e]};e.prototype.Apply=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._delegates[e[0]];if(null!=n)return n.apply(null,Array.prototype.slice.call(e,1))};return e})();e.DelegateManager=E;e.MakeShapeStyle=function(e,t){return{shape:e,color:t}};e.MakeBarStyle=function(e,t,n,r,i,s){return{shape:e,color:t,pattern:n,start:r,end:i,strokeWeight:s}};function S(){var e;return function(t){null==e&&(e=null!=t?t:1);e>0&&--e}}e.GetSingleStopBreakpoint=S;e.bpt=S();var x=(function(){function t(e,t,n){this._elementToCover=e;this._childElems=t;this._optId=n;this.Init()}t.prototype.Show=function(){this._elementToCover.addEventListener("resize",this.OnResize);this._elementToCover.appendChild(this.transparentDiv);this._elementToCover.appendChild(this.opaqueContainerDiv);this.RefreshLayout()};t.prototype.Hide=function(){this._elementToCover.removeEventListener("resize",this.OnResize);this._elementToCover.removeChild(this.transparentDiv);this._elementToCover.removeChild(this.opaqueContainerDiv)};t.prototype.Dispose=function(){this.transparentDiv=this.opaqueDiv=this.opaqueContainerDiv=null};t.prototype.RefreshLayout=function(){this.opaqueContainerDiv.style.height=this.transparentDiv.style.height=Math.max(0,this._elementToCover.offsetHeight-2)+"px";this.opaqueContainerDiv.style.width=this.transparentDiv.style.width=Math.max(0,this._elementToCover.offsetWidth-2)+"px";this.opaqueDiv.style.left=Math.max((this._elementToCover.offsetWidth-this.opaqueDiv.offsetWidth)/2,50)+"px";this.opaqueDiv.style.marginTop=(this._elementToCover.offsetHeight-this.opaqueDiv.offsetHeight)/2+"px"};t.prototype.OnResize=function(e){this.RefreshLayout()};t.prototype.Init=function(){e.DebugAssert("DIV"==this._elementToCover.tagName.toUpperCase()&&"RELATIVE"==this._elementToCover.style.position.toUpperCase(),"Banner can only cover relative positioned div elements!");this.transparentDiv=document.createElement("div");this.transparentDiv.style.cssText="z-index:5; position:absolute; top:0px; left:0px; background-color:#ffffff;border:1px solid #999999;";m.DomElement.GetInstance().SetOpacity(this.transparentDiv,.85);null!=this._optId&&(this.transparentDiv.id=this._optId);this.opaqueContainerDiv=document.createElement("div");this.opaqueContainerDiv.style.cssText="z-index:6; position:absolute; top:0px; left:0px; background-color:transparent;";this.opaqueDiv=document.createElement("div");this.opaqueDiv.style.cssText="position:absolute; vertical-align:middle; top:0px; left:0px; padding-left:20px; padding-right:20px; background-color:#ffffff; border:1px solid #EBEEF2; white-space:nowrap;";for(var t=0;t<this._childElems.length;t++)this.opaqueDiv.appendChild(this._childElems[t]);this.opaqueContainerDiv.appendChild(this.opaqueDiv)};return t})();e.ElementCover=x;var T=(function(){function t(e,t){this._elementToCover=e;this._optBannerId=t;this.Init()}t.prototype.Show=function(e){if(null==e){this.imgElem.alt=this.imgElem.title="";this.textElem.style.display="none"}else{m.DomElement.GetInstance().SetText(this.textElem,e);this.imgElem.alt=this.imgElem.title=e;this.textElem.style.display=""}this.elemCover.Show()};t.prototype.Hide=function(){this.elemCover.Hide()};t.prototype.UpdateText=function(e){m.DomElement.GetInstance().SetText(this.textElem,e);this.elemCover.RefreshLayout()};t.prototype.Dispose=function(){this.elemCover.Dispose();this.textElem=this.imgElem=this._elementToCover=null};t.prototype.Init=function(){this.imgElem=document.createElement("img");this.imgElem.src=e.Internal.SiteUrl+s.JsGridConstants.ImagesDirectory+"progress-circle-24.gif";this.imgElem.style.cssText="vertical-align:middle;margin:30px 10px 30px 10px";this.textElem=document.createElement("span");this.textElem.style.cssText="vertical-align:middle; margin:30px 10px 30px 10px; color:black; text-align:center; white-space:nowrap; overflow:hidden";this.elemCover=new x(this._elementToCover,[this.imgElem,this.textElem],this._optBannerId)};return t})();e.LoadingBanner=T;var N=(function(){function e(e,t){this._elementToCover=e;this._optBannerId=t;this.Init()}e.prototype.Show=function(e){m.DomElement.GetInstance().SetText(this.textElem,e);this.elemCover.Show()};e.prototype.Hide=function(){this.elemCover.Hide()};e.prototype.UpdateText=function(e){m.DomElement.GetInstance().SetText(this.textElem,e);this.elemCover.RefreshLayout()};e.prototype.Dispose=function(){this.elemCover.Dispose();this.textElem=this._elementToCover=null};e.prototype.Init=function(){var e=document.createElement("table");this.textElem=e.insertRow(-1).insertCell(-1);this.textElem.style.cssText="align:middle; vertical-align:middle; color:#AA0000;text-align:center; padding:20px;";this.elemCover=new x(this._elementToCover,[e],this._optBannerId)};return e})();e.ErrorBanner=N;(function(t){t.IsChar=function(e){return e.rawEvent?"keypress"==e.type&&(null==e.rawEvent.which||e.rawEvent.which>0&&e.rawEvent.charCode>0):"keypress"==e.type};t.FocusElementInDOMCollection=function(t,n,r){var i=[];function s(e){return null!=e.hasAttribute?e.hasAttribute("tabIndex")&&-1==e.getAttribute("tabIndex"):null!=e.tabIndex&&-1==e.tabIndex}(function e(t){for(var n=0;n<t.length;n++){var r=t[n];s(r)&&i.push(r);e(r.childNodes)}})(t);return(function(){if(0==i.length)return null;var t;if(null==n)t=i[0];else for(var s=0;s<i.length;s++)if(i[s]===n){t=r?s==i.length-1?i[0]:i[s+1]:0==s?i[i.length-1]:i[s-1];break}if(null!=t)try{t.focus()}catch(t){e.DebugAssert(!1,"Incorrectly trying to focus the element. Is it hidden?")}return t})()};t.CloneObj=function(e,t){return m.CloneObj(e,t)};t.GetDocumentDirection=function(){return document.documentElement.getAttribute("dir")};t.HTMLDecode=function(e){return m.Encoding_STSHtmlDecode(e)};t.HTMLEncode=function(e){return m.Encoding_STSHtmlEncode(e)};var n=(function(){function t(e){this._jsFilesLoaded=!1;this._totalFilesToLoad=e;this._numLoadedJsFiles=0}t.prototype._countLoadedJsFiles=function(e,t){void 0===t&&(t=[]);this._numLoadedJsFiles++;if(this._numLoadedJsFiles>=this._totalFilesToLoad){this._jsFilesLoaded=!0;t.forEach(function(e){return e()});e()}};t.prototype._ensureExternalJsFilesLoaded=function(t,n,r){void 0===t&&(t=[]);if(this._jsFilesLoaded)n();else{var i=e.injectJsScript,s=this._countLoadedJsFiles.bind(this,n,r);t.forEach(function(e){return i(e,s)})}};return t})();t.LoadExternalJsFiles=n})(e.Utility||(e.Utility={}));var C=(function(){function e(){this._changeKeys=new Array}e.prototype.GetList=function(){return this._changeKeys};e.prototype.AddMapping=function(e,t){var n={id:e,fn:t};this._changeKeys.splice(m.LowerBound(this._changeKeys,e,"id"),0,n)};e.prototype.RemoveMapping=function(e){var t=m.BinarySearch(this._changeKeys,e,"id");null!=t&&this._changeKeys.splice(t,1);return null!=t};e.prototype.CallFunctions=function(e,t,n){for(var r=0;r<this._changeKeys.length&&this._changeKeys[r].id<=e;r++){null!=this._changeKeys[r].fn&&this._changeKeys[r].fn(t,n);this.RemoveMapping(this._changeKeys[r].id)}};return e})();e.ChangeKeyOnCompleteMap=C;e.SpRegionalSettings={adjustHijriDays:1,calendarType:2,firstDayOfWeek:3,firstWeekOfYear:4,localeId:5,currentDateInLocalCalendar:new Date(2013,10,9),showWeeks:!0,timeZone:"-7:00",timeZoneInHours:-7,workDayEnd:16,workDayStart:8,workDays:"1110111",time24:"1"};e.hasPasteStarted=!1;e.injectJsScript=function(e,t,n){void 0===n&&(n=function(){});if(null==document.getElementById(e)){var r=document.createElement("script");r.setAttribute("type","text/javascript");r.setAttribute("src",e);r.id=e;r.onload=function(){t();n()};document.getElementsByTagName("head")[0].appendChild(r)}else{t();n()}}})(t.JsGridUtil||(t.JsGridUtil={}))});
define("aQn",["require","exports","aQo"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this.collection=n.JsGridUtil.Internal.IsNullOrUndefined(e)?{}:e}e.prototype.IsEmpty=function(){for(var e in this.collection)return!1;return!0};e.prototype.First=function(){for(var e in this.collection)return e;n.JsGridUtil.DebugAssert(!1,"Should not call First on empty Set");return null};e.prototype.GetCollection=function(){return this.collection};e.prototype.ToArray=function(){return n.JsGridUtil.Internal.ConvertSetKeysToArray(this.collection)};e.prototype.AddArray=function(e){for(var t=0;t<e.length;t++)this.collection[e[t]]=1;return this};e.prototype.Add=function(e){this.collection[e]=1;return e};e.prototype.Remove=function(e){var t=this.collection[e];delete this.collection[e];return t};e.prototype.Clear=function(){this.collection={};return this};e.prototype.Contains=function(e){return e in this.collection};e.prototype.Clone=function(){var t={};for(var n in this.collection)t[n]=1;return new e(t)};e.prototype.SymmetricDifference=function(t){var n={};for(var r in this.collection)r in t.collection||(n[r]=1);for(r in t.collection)r in this.collection||(n[r]=1);return new e(n)};e.prototype.Difference=function(t){var n={};for(var r in this.collection)r in t.collection||(n[r]=1);return new e(n)};e.prototype.Union=function(e){var t=this.Clone();for(var n in e.collection)t.collection[n]=1;return t};e.prototype.UnionWith=function(e){for(var t in e.collection)this.collection[t]=1};e.prototype.Intersection=function(t){var n={};for(var r in this.collection)r in t.collection&&(n[r]=1);return new e(n)};return e})();t.Set=r;var i=(function(){function e(){this.dictionary={};this.valueKeyMap={}}e.prototype.Add=function(e,t){this.dictionary[e]=t;this.valueKeyMap[t]=e};e.prototype.RemoveKey=function(e){delete this.valueKeyMap[this.dictionary[e]];delete this.dictionary[e]};e.prototype.RemoveValue=function(e){delete this.dictionary[this.valueKeyMap[e]];delete this.valueKeyMap[e]};e.prototype.GetValue=function(e){return this.dictionary[e]};e.prototype.GetKey=function(e){return this.valueKeyMap[e]};e.prototype.GetDictionary=function(){return this.dictionary};e.prototype.Clear=function(){this.dictionary={};this.valueKeyMap={}};e.prototype.ContainsKey=function(e){return e in this.dictionary};e.prototype.ContainsValue=function(e){return e in this.valueKeyMap};return e})();t.KeyMap=i;var s=(function(){function e(e,t){if(null==e||null==t)this.Clear();else{this.begin=e;this.end=t}}e.prototype.Normalize=function(){var e=Math.min(this.begin,this.end),t=Math.max(this.begin,this.end);this.begin=e;this.end=t;return this};e.prototype.Contains=function(e){return e>=this.begin&&e<=this.end};e.prototype.IsEmpty=function(){return this.begin>this.end};e.prototype.Clear=function(){this.begin=0;this.end=-1};e.prototype.Size=function(){return Math.max(0,this.end-this.begin+1)};e.prototype.Overlaps=function(e){return this.end>=e.begin&&e.end>=this.begin};e.prototype.Intersect=function(t){return new e(Math.max(this.begin,t.begin),Math.min(this.end,t.end))};e.prototype.IsDifferent=function(e){return this.begin!==e.begin||this.end!==e.end};return e})();t.Range=s});
define("aQp",["require","exports","aQo","aPS"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this.data=e;this.localized=t}e.prototype.HasDataValue=function(){return this.data!==n.JsGridUtil.EmptyValue};e.prototype.HasLocalizedValue=function(){return this.localized!==n.JsGridUtil.EmptyValue};return e})();t.PropertyUpdate=i;t.CreateUnvalidatedPropertyUpdate=function(e,t,n,r){return new s(e,t,n,r)};t.CreateValidatedPropertyUpdate=function(e,t,n,r){return new o(e,t,n,r)};var s=function(e,t,r,i){this.validated=!1;this.recordKey=e;this.fieldKey=t;this.newValue=r;this.newValueIsLocalized=i;if(!n.JsGridUtil._locationFilldownKillswitchIsActive&&!i&&"string"==typeof this.newValue)try{this.newValue=JSON.parse(this.newValue)}catch(e){}};t.UnvalidatedPropertyUpdate=s;var o=function(e,t,n,r){this.validated=!0;this.recordKey=e;this.fieldKey=t;this.newDataValue=n;this.newLocalizedValue=r};t.ValidatedPropertyUpdate=o;var u=(function(){function e(e,t){this._objBag=e}e.prototype.ApplyPropUpdates=function(e,t){for(var n=0;n<e.length;n++)this.ApplySinglePropUpdateRequest(e[n],t)};e.prototype.ApplySinglePropUpdateRequest=function(e,t){var s=this,o=function(o){f=!1;o.isValid?u(new i(o.dataValue,o.normalizedLocValue),r.JsGridConstants.ValidationState.Valid,null):u(e.newValueIsLocalized?new i(n.JsGridUtil.InvalidValue,e.newValue):new i(e.newValue,n.JsGridUtil.InvalidValue),r.JsGridConstants.ValidationState.Invalid,o.errorMsg);l&&s._objBag.pendingChangeMgr.DecrementPendingChangeCount(t)},u=function(n,i,o){e.fieldKey!==r.JsGridConstants.RecordIndicatorCheckboxColumnKey?s._objBag.versionMgr.AddPropChange(e.recordKey,e.fieldKey,t,n,i,o):n.data?s._objBag.checkSelMgr.ExternalAPI.CheckRecord(e.recordKey):s._objBag.checkSelMgr.ExternalAPI.UncheckRecord(e.recordKey)};if(e.validated)u(new i(e.newDataValue,e.newLocalizedValue),r.JsGridConstants.ValidationState.Valid,null);else{var a=this._objBag.controller.GetPropType(e.recordKey,e.fieldKey);n.JsGridUtil.DebugAssert(null!=a);e.newValueIsLocalized&&(e.newValue=null==e.newValue?"":e.newValue.replace(/^\s+|\s+$/g,""));var f=!0,l=!1;a.BeginValidateNormalizeConvert(e.recordKey,e.fieldKey,e.newValue,e.newValueIsLocalized,o,function(){var e={isValid:!1,errorMsg:SP.JsGrid.Res.vncfailed};o(e)});if(f){this._objBag.pendingChangeMgr.IncrementPendingChangeCount(t);l=!0;u(e.newValueIsLocalized?new i(n.JsGridUtil.InvalidValue,e.newValue):new i(e.newValue,n.JsGridUtil.InvalidValue),r.JsGridConstants.ValidationState.Pending,null)}}};return e})();t.PropertyUpdateManager=u;var a=(function(){function e(e){this.callbackCount=0;this.pendingCount=0;this.activeChangeKeys={};this.pendingCallbacks=[];this.completeCallbacks=[];this.pendingChangeKeys={};this.newRowChanges={};e.intEventMgr.AttachEvent(r.JsGridConstants.Internal.EventType.OnChangeKeyCreated,this.NotifyKeyCreated.bind(this));e.intEventMgr.AttachEvent(r.JsGridConstants.Internal.EventType.OnChangeKeyInitialUpdateFinished,this.NotifyKeyInitiallyComplete.bind(this));e.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnEntryRecordPropertyChanged,this.EntryRecordPropertyChanged.bind(this));e.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnEntryRecordCommitted,this.EntryRecordCommitted.bind(this));e.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnVacateChange,this.OnVacateChange.bind(this));this._objBag=e}e.prototype.OnVacateChange=function(e){var t=e.changeKey.GetVersionNumber();delete this.activeChangeKeys[t];delete this.pendingChangeKeys[t]};e.prototype.EntryRecordPropertyChanged=function(e){var t=e.recordKey;t in this.newRowChanges||(this.newRowChanges[t]=[]);this.newRowChanges[t].push(e.changeKey);this.IncrementPendingChangeCountForChangeKey(e.changeKey)};e.prototype.EntryRecordCommitted=function(e){var t=e.originalRecordKey;if(t in this.newRowChanges)for(var n=this.newRowChanges[t],r=0;r<n.length;r++)this.TryFireChangeKeyCompleteEvent(n[r])};e.prototype.NotifyKeyCreated=function(e){var t=e.changeKey.GetVersionNumber();this.activeChangeKeys[t]=e.changeKey;this.pendingChangeKeys[t]=1};e.prototype.NotifyKeyInitiallyComplete=function(e){this.TryFireChangeKeyCompleteEvent(e.changeKey)};e.prototype.TryFireChangeKeyCompleteEvent=function(e){var t=this,i=e.GetVersionNumber();if(0==--this.pendingChangeKeys[i]){delete this.pendingChangeKeys[i];this.callbackCount++;setTimeout(function(){t.callbackCount--;t._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnInitialChangesForChangeKeyComplete,n.JsGridUtil.EventArgs.PendingChangeKeyInitiallyComplete(e));delete t.activeChangeKeys[i];if(0!==t.completeCallbacks.length&&!t.AnyActiveChanges()){for(var s=0;s<t.completeCallbacks.length;s++)t.completeCallbacks[s]();t.completeCallbacks=[]}},0)}};e.prototype.AnyActiveChanges=function(){var e=!1;for(var t in this.activeChangeKeys)if(this._objBag.controller.IsChangeKeyApplied(this.activeChangeKeys[t])){e=!0;break}return e};e.prototype.IncrementPendingChangeCountForChangeKey=function(e){var t=e.GetVersionNumber();t in this.pendingChangeKeys?this.pendingChangeKeys[t]++:this.pendingChangeKeys[t]=1};e.prototype.WaitForPendingUpdates=function(e){null!=e&&(0!==this.pendingCount?this.pendingCallbacks.push(e):e())};e.prototype.WaitForAllChangeKeysToComplete=function(e){null!=e&&(0!==this.callbackCount||0!==this.pendingCount||this.AnyActiveChanges()?this.completeCallbacks.push(e):e())};e.prototype.IncrementPendingChangeCount=function(e){this.pendingCount++;this.IncrementPendingChangeCountForChangeKey(e)};e.prototype.DecrementPendingChangeCount=function(e){this.pendingCount--;if(0==this.pendingCount&&0!==this.pendingCallbacks.length){for(var t=0;t<this.pendingCallbacks.length;t++)this.pendingCallbacks[t]();this.pendingCallbacks=[]}this.TryFireChangeKeyCompleteEvent(e)};return e})();t.PendingChangesManager=a});
define("aQv",["require","exports","aPY","aQo","aPS"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t,n,r,s,o,u,a){this.key=e;this.hasDataValue=t;this.hasLocalizedValue=n;this.textDirection=r;this._defaultCellStyleId=s;this._editMode=null==o?i.JsGridConstants.EditMode.Defer:o;this._propType=null;this._multiValue=!1;this.dateOnly=null==u||u;this.csrInfo=a}e.prototype.GetEditMode=function(){return this._editMode};e.prototype.SetEditMode=function(e){this._editMode=e};e.prototype.GetDefaultCellStyleId=function(){return this._defaultCellStyleId};e.prototype.CompareSingleDataEqual=function(e,t){var n=this.GetSingleValuePropType().IsDataEqual;return null==n?e==t:n(e,t)};e.prototype.GetPropType=function(){return this._propType};e.prototype.GetSingleValuePropType=function(){return this._multiValue?this._propType.singleValuePropType:this._propType};e.prototype.GetMultiValuePropType=function(){return this._multiValue?this._propType:null};e.prototype.SetSingleValuePropType=function(e){if(this._multiValue&&!r.JsGridUtil.Internal.IsNullOrUndefined(e)){var t=new n.PropertyType.MultiValuePropType(e.ID,this._listSeparator,null,null);n.PropertyType.RegisterNewDerivedCustomPropType(t,e.ID);this._propType=t}else this._propType=e};e.prototype.SetIsMultiValue=function(e){if(!this._multiValue){this._listSeparator=e;this._multiValue=!0;this.SetSingleValuePropType(this._propType)}};e.prototype.GetIsMultiValue=function(){return this._multiValue};return e})();t.GridField=s;var o=(function(){function e(e,t,n,i){this.isVisible=!0;this.isHidable=!0;this.isResizable=!0;this.isSortable=!0;this.isAutoFilterable=!0;this.isFooter=!1;this.bOpenMenuOnContentClick=!1;this.fnShouldLinkSingleValue=null;this.fnSingleValueClicked=null;this.fnGetCellEditMode=null;this.fnGetDisplayControlName=null;this.fnGetEditControlName=null;this.fnGetWidgetControlNames=null;this.fnGetCellStyleId=null;this.fnGetSingleValueTooltip=null;this.name=e;this.imgSrc=t;this.columnKey=n;this.fieldKeys=[n];this.width=i;this.bOpenMenuOnContentClick=!r.JsGridUtil.Internal.IsNullOrUndefined(this.imgSrc)}e.prototype.ColumnType=function(){return"column"};return e})();t.ColumnInfo=o;var u=(function(){function e(e){this.colInfoMap={};this._colInfoArray=e;this.BuildMap()}e.prototype.GetColumnByKey=function(e){return this.colInfoMap[e]};e.prototype.GetColumnArray=function(e){var t=[];if(e)for(var n=0;n<this._colInfoArray.length;++n)this._colInfoArray[n].isVisible&&t.push(this._colInfoArray[n]);else t=this._colInfoArray;return t};e.prototype.GetColumnMap=function(){return this.colInfoMap};e.prototype.AppendColumn=function(e){this.InsertColumnAt(this._colInfoArray.length,e)};e.prototype.InsertColumnAt=function(e,t){this._colInfoArray.splice(e,0,t);this.BuildMap()};e.prototype.RemoveColumn=function(e){var t=this.colInfoMap[e],n=r.JsGridUtil.Internal.FindKey(this._colInfoArray,function(e){return e==t},null);r.JsGridUtil.Internal.IsNullOrUndefined(n)||this._colInfoArray.splice(n,1);this.BuildMap();return n};e.prototype.GetColumnPosition=function(e){for(var t=0,n=0;n<this._colInfoArray.length;++n)if(this._colInfoArray[n].isVisible){if(this._colInfoArray[n].columnKey==e)return t;t++}return null};e.prototype.BuildMap=function(){for(var e=0;e<this._colInfoArray.length;++e)this.colInfoMap[this._colInfoArray[e].columnKey]=this._colInfoArray[e]};return e})();t.ColumnInfoCollection=u});
define("aPY",["require","exports","mU","aQo","aPS","aPZ","di","bt"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u.Killswitch.isActivated("5A1F221C-336E-4AD0-B168-F49F39DC1347","3/20/2020","fix custom formatter choice fields");(function(e){var t=(function(){function e(){var e=this;this.ID="String";this.toString=function(){return e.ID}}e.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s,o){n=null!=n&&0==n.length?null:n;s({isValid:!0,dataValue:n=r.JsGridUtil.SPUserValueOnPasteFixup(n),normalizedLocValue:n})};return e})();e.String=t;var u=function(e,t,n){var i=this;this.GetItemFromData=function(e){return null==e?null:r.JsGridUtil.Internal.Find(i._items,function(t){return t.value==e})};this.GetItemFromLocalized=function(e){if(null==e)return null;var t=e.toLowerCase();return r.JsGridUtil.Internal.Find(i._items,function(e){return e.localString.toLowerCase()==t})};this.BeginValidateNormalizeConvert=function(e,t,n,r,s,o){var u={},a=r?i.GetItemFromLocalized(n):i.GetItemFromData(n);u.isValid=null!=a||!i._bLimitToList;if(null!=a){u.normalizedLocValue=a.localString;u.dataValue=a.value}else u.normalizedLocValue=u.dataValue=n;s(u)};this.GetItems=function(e){for(var t=[],n=0;n<i._items.length;n++)t.push(b.prototype.MakeProperty(i._items[n].value,i._items[n].localString,!0,!0,i));e(t)};this.DataToLocalized=function(e){var t=i.GetItemFromData(e);return a?t?t.localString:r.JsGridUtil.EmptyValue:t?t.localString:""};this.LocalizedToData=function(e){var t=i.GetItemFromLocalized(e);return a?t?t.value:r.JsGridUtil.EmptyValue:t?t.value:""};this.GetImageSource=function(e,t){var n=i.GetItemFromData(t);return null!=n?n.imageUrl:null};this.GetStyleId=function(e){var t=i.GetItemFromData(e);return null!=t?t.styleId:null};this.GetIsLimitedToList=function(){return i._bLimitToList};this.GetSerializableLookupPropType=function(){return{items:i._items,id:i._id,bLimitToList:i._bLimitToList}};this._items=e;this._id=t;this._bLimitToList=n;this.ID=t};e.LookupTable=u;var f=(function(){function e(){this.ID="CheckBoxBoolean"}e.prototype.BeginValidateNormalizeConvert=function(e,n,r,i,s,o){"string"!=typeof r&&r.constructor!=t||(r=r.toUpperCase());i||"boolean"==typeof r||(r="1"==r);s({isValid:!0,dataValue:r=i?""!==r&&r!==SP.JsGrid.Res.checkboxUnchecked.toUpperCase():!!r,normalizedLocValue:this.DataToLocalized(r)})};e.prototype.DataToLocalized=function(e){"boolean"!=typeof e&&(e="1"==e);return e?SP.JsGrid.Res.checkboxChecked:SP.JsGrid.Res.checkboxUnchecked};e.prototype.GetBool=function(e){"boolean"!=typeof e&&(e="1"==e);return e!=r.JsGridUtil.EmptyValue&&!!e};e.prototype.toString=function(){return this.ID};return e})();e.CheckBoxBoolean=f;var l=(function(){function n(){this.ID="DropdownBoolean"}n.prototype.BeginValidateNormalizeConvert=function(e,n,r,i,s,o){"string"!=typeof r&&r.constructor!=t||(r=r.toUpperCase());i||"boolean"==typeof r||(r="1"==r);s({isValid:!0,dataValue:r=i?""!==r&&r!==SP.JsGrid.Res.booleanNo.toUpperCase():!!r,normalizedLocValue:this.DataToLocalized(r)})};n.prototype.DataToLocalized=function(e){"boolean"!=typeof e&&(e="1"==e);return e?SP.JsGrid.Res.booleanYes:SP.JsGrid.Res.booleanNo};n.prototype.GetBool=function(e){"boolean"!=typeof e&&(e="1"==e);return e!=r.JsGridUtil.EmptyValue&&!!e};n.prototype.GetItems=function(t){for(var n=[],r=0;r<2;r++){var i=1==r?SP.JsGrid.Res.booleanYes:SP.JsGrid.Res.booleanNo;n.push(e.Property.prototype.MakeProperty(r,i,!0,!0,this))}t(n)};n.prototype.toString=function(){return this.ID};return n})();e.DropdownBoolean=l;var c=(function(){function t(e,t,n,i){var s=this;this.LocStrArrayToLocStr=function(e){return r.JsGridUtil.Internal.JoinStrings(e,s._separatorChar+" ")};this._singleValuePropTypeID=e;this._separatorChar=t;this._bDelayInit=n;this._bAllowDuplicateValues=i;this.ID=e+"_MultiValue";this.bMultiValue=!0;this.separator=t;this.singleValuePropType=this.svPropType;n||this.InitSVPropType()}t.prototype.InitSVPropType=function(){var t=this;this.svPropType=e.Internal.Property.GetInstance().GetPropType(this._singleValuePropTypeID);this.singleValuePropType=this.svPropType;null!=this.svPropType&&null!=this.svPropType.SetSeparator&&this.svPropType.SetSeparator(this._separatorChar);this.GetImageSource=this.svPropType.GetImageSource&&function(e,n){return t.ForEachInArray(n,function(n){return t.svPropType.GetImageSource(e,n)})};this.GetItems=this.svPropType.GetItems;this.GetUpdateTrackingMode=this.svPropType.GetUpdateTrackingMode;this.GetUpdateSerializeMode=this.svPropType.GetUpdateSerializeMode;this.DataToLocalized=this.svPropType.DataToLocalized&&function(e){return t.LocStrArrayToLocStr(t.ForEachInArray(e,function(e){return t.svPropType.DataToLocalized(e)}))};this.LocalizedToData=this.svPropType.LocalizedToData&&function(e){return t.ForEachInArray(t.LocStrToLocStrArray(e),function(e){return t.svPropType.LocalizedToData(e)})};this.GetDisplayValue=this.svPropType.GetDisplayValue&&function(e,n,i){var s=[];if(null!=n&&n!==r.JsGridUtil.EmptyValue&&n!==r.JsGridUtil.InvalidValue)for(var o=t.LocStrToLocStrArray(i),u=0;u<n.length;u++)s.push(t.svPropType.GetDisplayValue(e,n[u],u>=o.length?null:o[u]));else s.push(t.svPropType.GetDisplayValue(e,n,i));return r.JsGridUtil.Internal.JoinStrings(s,t._separatorChar+" ")}};t.prototype.GetCopyValue=function(e,t,n){return"SPUser"==this._singleValuePropTypeID&&null!=t&&t!==r.JsGridUtil.EmptyValue&&t!==r.JsGridUtil.InvalidValue?this.svPropType.GetCopyValue(e,t,n):n};t.prototype.GetSerializableMultiValuePropType=function(){return{singleValuePropTypeID:this._singleValuePropTypeID,separatorChar:this._separatorChar,bDelayInit:this._bDelayInit}};t.prototype.InitSingleValuePropType=function(){this.InitSVPropType()};t.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s,o){var u=this,a=function(){u.svPropType.BeginValidateNormalizeConvert(e,t,n[p],i,f,o)},f=function(e){l(e);++p<n.length?a():s(c())},l=function(e){if(0==p)h={isValid:e.isValid,dataValue:[e.dataValue],normalizedLocValue:[e.normalizedLocValue]};else{h.isValid=h.isValid&&e.isValid;h.dataValue.push(e.dataValue);h.normalizedLocValue.push(e.normalizedLocValue)}},c=function(){if(null!=h){if(h.isValid){if(!u._bAllowDuplicateValues)for(var e=u.svPropType.IsDataEqual,t=h.dataValue,n=0;n<t.length;n++)for(var r=0;r<t.length;r++)n!=r&&(null==e?t[n]==t[r]:e(t[n],t[r]))&&t.splice(r,1);h.normalizedLocValue=u.LocStrArrayToLocStr(h.normalizedLocValue);return h}return{isValid:!1}}return{isValid:!0,dataValue:null,normalizedLocValue:null}};if(i&&""==n||!(i||null!=n&&0!=n.length))s({isValid:!0,dataValue:[],normalizedLocValue:""});else{i&&(n=this.LocStrToLocStrArray(n));r.JsGridUtil.DebugAssert(n.constructor==Array);var h,p=0;a()}};t.prototype.LocStrToLocStrArray=function(e){return e&&"string"!=typeof e?[]:r.JsGridUtil.Internal.TokenizeString(e,this._separatorChar)};t.prototype.ForEachInArray=function(e,t){if(null==e)return null;for(var n=[],r=0;r<e.length;r++)n.push(t(e[r]));return n};return t})();e.MultiValuePropType=c;var h=(function(){function e(){this.ID="Hyperlink";this.bHyperlink=!0;this._serializedValueStartsEndsWith='"';this._serializedValueSeparator='", "';this._serializedValueSeparatorEncoded=encodeURIComponent(this._serializedValueSeparator)}e.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s,o){n=r.JsGridUtil.SPUserValueOnPasteFixup(n);var u=i?this.Deserialize(n):n;s({isValid:null!=u,dataValue:u,normalizedLocValue:this.DataToLocalized(u)})};e.prototype.DataToLocalized=function(e){return e?e.display:""};e.prototype.GetAddress=function(e){return e?e.address:""};e.prototype.GetCopyValue=function(e,t,n){return this.Serialize(t)};e.prototype.Serialize=function(e){if(!e)return null;var t=e.address.replace(this._serializedValueSeparator,this._serializedValueSeparatorEncoded);return o.format("{0}{1}{2}{3}{0}",this._serializedValueStartsEndsWith,t,this._serializedValueSeparator,e.display)};e.prototype.Deserialize=function(e){if(null==e)return null;0==e.length&&(e="");var t=e.indexOf(this._serializedValueSeparator);return t<0||!e.startsWith(this._serializedValueStartsEndsWith)||!e.endsWith(this._serializedValueStartsEndsWith)?{address:e,display:e}:{address:e.substring(1,t).replace(this._serializedValueSeparatorEncoded,this._serializedValueSeparator),display:e.substring(t+this._serializedValueSeparator.length,e.length-1)}};e.prototype.toString=function(){return this.ID};return e})();e.Hyperlink=h;var p=(function(){function e(){this.ID="Location";this.ForceDataCopy=!0}e.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s,o){n=r.JsGridUtil.SPUserValueOnPasteFixup(n);var u=i?this.Deserialize(n):n;s({isValid:null!=u,dataValue:u,normalizedLocValue:this.DataToLocalized(u)})};e.prototype.DataToLocalized=function(e){return e?e.DisplayName:""};e.prototype.GetCopyValue=function(e,t,n){return r.JsGridUtil._locationFilldownKillswitchIsActive?this.Serialize(t):JSON.stringify(this.Serialize(t))};e.prototype.toString=function(){return this.ID};e.prototype.Serialize=function(e){return r.JsGridUtil._locationFilldownKillswitchIsActive?null:e};e.prototype.Deserialize=function(e){return null};return e})();e.Location=p;e.RegisterNewLookupPropType=function(t,n,i,o){r.JsGridUtil.DebugAssert(i==s.DisplayControlType.Image||i==s.DisplayControlType.ImageText||i==s.DisplayControlType.Text);var u=new e.LookupTable(n,t,o);d.Property.GetInstance().RegisterPropType(u,i,s.EditControlType.ComboBox,[])};e.RegisterNewCustomPropType=function(e,t,n,r){d.Property.GetInstance().RegisterPropType(e,t,n,r)};e.RegisterNewDerivedCustomPropType=function(e,t){d.Property.GetInstance().RegisterDerivedPropType(e,t)};(function(e){e.RegisterDisplayControl=function(e,t,n){d.Property.GetInstance().RegisterDisplayControl(e,t,n)};e.RegisterEditControl=function(e,t,n){d.Property.GetInstance().RegisterEditControl(e,t,n)};e.RegisterWidgetControl=function(e,t,n){d.Property.GetInstance().RegisterWidgetControl(e,t,n)};e.UpdateDisplayControlForPropType=function(e,t){d.Property.GetInstance().UpdateDisplayControlForPropType(e,t)};e.UpdateEditControlForPropType=function(e,t){d.Property.GetInstance().UpdateEditControlForPropType(e,t)};e.UpdateWidgetControlsForPropType=function(e,t){d.Property.GetInstance().UpdateWidgetControlsForPropType(e,t)};e.GetPropType=function(e){return d.Property.GetInstance().GetPropType(e)};e.GetPropTypes=function(){return d.Property.GetInstance().GetPropTypes()}})(e.Utils||(e.Utils={}));var d,v={ODB:1806},m={ODB:1892};(function(e){var n=(function(){function e(){this.defaultControlsMap={};this.eligibleControlsMap={};var e=r.JsGridUtil.Internal.IsFeatureEnabled(v),n=r.JsGridUtil.Internal.IsFeatureEnabled(m);this.propTypeInfoTable=[[new t,s.DisplayControlType.Text,s.EditControlType.EditBox,[]],[new f,s.DisplayControlType.Checkbox,s.EditControlType.Checkbox,[]],[new l,s.DisplayControlType.Text,s.EditControlType.ComboBox,[]],[new h,s.DisplayControlType.Text,s.EditControlType.Hyperlink,e?[]:[s.WidgetControlType.Hyperlink]],[new p,s.DisplayControlType.Text,s.EditControlType.LocationPicker,[]]];this.propSingletonMap=r.JsGridUtil.Internal.ConvertTableToMap(this.propTypeInfoTable,"0","1");this.displayControlInfoTable=[[s.DisplayControlType.Image,new s.DisplayControl.ImageDisplayControl,["GetImageSource"]],[s.DisplayControlType.ImageText,new s.DisplayControl.ImageTextDisplayControl,["GetImageSource"]],[s.DisplayControlType.Text,new s.DisplayControl.TextDisplayControl,[]],[s.DisplayControlType.Checkbox,new s.DisplayControl.CheckboxDisplayControl,["GetBool"]],[s.DisplayControlType.CSR,new s.DisplayControl.CSRDisplayControl,[]],[s.DisplayControlType.CustomFormatter,new s.DisplayControl.CustomFormatterDisplayControl,[]],[s.DisplayControlType.User,new s.DisplayControl.UserDisplayControl,["GetSipAddress"]],[s.DisplayControlType.ImageThumbnail,new s.DisplayControl.ImageThumbnailDisplayControl,[]]];this.displayControlsSingletonMap=r.JsGridUtil.Internal.ConvertTableToMap(this.displayControlInfoTable,"0","1");this.displayControlInterfaceMap=r.JsGridUtil.Internal.ConvertTableToMap(this.displayControlInfoTable,"0","2");this.editControlInfoTable=[[s.EditControlType.EditBox,function(e,t){return new s.EditControl.EditBoxEditControl(e,t)},[]],[s.EditControlType.Checkbox,function(e){return new s.EditControl.CheckboxEditControl(e)},["GetBool"]],[s.EditControlType.PeoplePicker,function(e){return new s.EditControl.PeoplePickerEditControl(e)},["GetSipAddress"]],[s.EditControlType.LocationPicker,function(e){return new s.EditControl.LocationPickerEditControl(e)},[]]];e?this.editControlInfoTable.push([s.EditControlType.Hyperlink,function(e){return new s.EditControl.HyperlinkEditControlV2(e)},[]]):this.editControlInfoTable.push([s.EditControlType.Hyperlink,function(e,t){return s.EditControl.GetHyperlinkEditControl(e,t)},[]]);n?this.editControlInfoTable.push([s.EditControlType.ComboBox,function(e){return new s.EditControl.ModernComboBoxEditControl(e)},["GetItems"]]):this.editControlInfoTable.push([s.EditControlType.ComboBox,function(e){return new s.EditControl.ComboBoxEditControl(e)},["GetItems"]]);this.editControlsFactoryMap=r.JsGridUtil.Internal.ConvertTableToMap(this.editControlInfoTable,"0","1");this.editControlInterfaceMap=r.JsGridUtil.Internal.ConvertTableToMap(this.editControlInfoTable,"0","2");this.widgetControlInfoTable=[[s.WidgetControlType.Date,function(e){return new s.WidgetControl.DateWidget(e)},[]],[i.JsGridConstants.ErrorWidgetId,function(e,t){return new s.WidgetControl.ErrorWidget(e,t)},[]]];e||this.widgetControlInfoTable.push([s.WidgetControlType.Hyperlink,function(e){return new s.WidgetControl.HyperlinkWidget(e)},["GetAddress"]]);this.widgetControlsFactoryMap=r.JsGridUtil.Internal.ConvertTableToMap(this.widgetControlInfoTable,"0","1");this.widgetControlInterfaceMap=r.JsGridUtil.Internal.ConvertTableToMap(this.widgetControlInfoTable,"0","2");this.Init()}e.GetInstance=function(){this._instance||(this._instance=new e);return this._instance};e.prototype.GetDefaultDisplayControlMap=function(){var e={};for(var t in this.defaultControlsMap)e[t]=this.defaultControlsMap[t].display.Id;return e};e.prototype.RegisterDefaultPropTypesFromDefaultDisplayControlMap=function(e,t){null==t&&(t={});for(var n in e)null==this.defaultControlsMap[n]&&this.RegisterDefaultDisplayPropTypeInternal(n,this.GetDisplayControl(e[n]),t)};e.prototype.GetLookupPropTypeMap=function(){var e={};for(var t in this.propSingletonMap)null!=this.propSingletonMap[t].GetSerializableLookupPropType?e[t]=this.propSingletonMap[t].GetSerializableLookupPropType():this.propSingletonMap[t].bMultiValue&&null!=this.propSingletonMap[t].singleValuePropType.GetSerializableLookupPropType&&(e[t]=this.propSingletonMap[t].GetSerializableMultiValuePropType());return e};e.prototype.RegisterDisplayControl=function(e,t,n){this.displayControlsSingletonMap[e]=t;this.displayControlInterfaceMap[e]=n;this.eligibleControlsMap={}};e.prototype.RegisterEditControl=function(e,t,n){this.editControlsFactoryMap[e]=t;this.editControlInterfaceMap[e]=n;this.eligibleControlsMap={}};e.prototype.RegisterWidgetControl=function(e,t,n){this.widgetControlsFactoryMap[e]=t;this.widgetControlInterfaceMap[e]=n;this.eligibleControlsMap={}};e.prototype.GetPropType=function(e){r.JsGridUtil.DebugAssert(e in this.propSingletonMap);return this.propSingletonMap[e]};e.prototype.GetPropTypes=function(){var e=[];for(var t in this.propSingletonMap)e.push(t);return e};e.prototype.PropTypeExists=function(e){return e in this.propSingletonMap};e.prototype.GetDisplayControl=function(e){r.JsGridUtil.DebugAssert(e in this.displayControlsSingletonMap);return this.displayControlsSingletonMap[e]};e.prototype.GetEditControl=function(e,t){r.JsGridUtil.DebugAssert(e in this.editControlsFactoryMap,o.format("Edit control named {0} needs to be registered before being instatiated."));return this.editControlsFactoryMap[e].apply(null,t)};e.prototype.GetWidgetControl=function(e,t){r.JsGridUtil.DebugAssert(e in this.widgetControlsFactoryMap,o.format("Widget control named {0} needs to be registered before being instatiated."));return this.widgetControlsFactoryMap[e].apply(null,t)};e.prototype.GetUpdateTrackingMode=function(e,t){if(null!=e.GetUpdateTrackingMode)return e.GetUpdateTrackingMode();r.JsGridUtil.DebugAssert(null==t||t.hasDataValue||t.hasLocalizedValue);return null!=t&&t.hasDataValue?t.hasLocalizedValue?i.JsGridConstants.UpdateTrackingMode.PropBoth:i.JsGridConstants.UpdateTrackingMode.PropData:i.JsGridConstants.UpdateTrackingMode.PropLocalized};e.prototype.GetUpdateSerializeMode=function(e,t){if(e&&null!=e.GetUpdateSerializeMode)return e.GetUpdateSerializeMode();var n=null!=e&&null!=t?this.GetUpdateTrackingMode(e,t):i.JsGridConstants.UpdateSerializeMode.PropBoth;n==i.JsGridConstants.UpdateSerializeMode.PropBoth&&(n=i.JsGridConstants.UpdateSerializeMode.PropLocalizedOnly);return n};e.prototype.RegisterDefaultDisplayPropTypeInternal=function(e,t,n){if(e in n){var r=n[e];null!=r.singleValuePropTypeID?this.propSingletonMap[e]=new c(r.singleValuePropTypeID,r.separatorChar,r.bDelayInit,null):this.propSingletonMap[e]=new u(r.items,r.id,r.bLimitToList)}delete this.eligibleControlsMap[e];this.defaultControlsMap[e]={display:t,editControlName:"",widgetControlNames:[]}};e.prototype.RegisterPropType=function(e,t,n,r){t||(t=s.DisplayControlType.Text);r=null==r?[]:r;this.RegisterPropTypeInternal(e,this.GetDisplayControl(t),n,r)};e.prototype.RegisterDerivedPropType=function(e,t){var n=this.defaultControlsMap[t];this.RegisterPropTypeInternal(e,n.display,n.editControlName,n.widgetControlNames)};e.prototype.RegisterPropTypeInternal=function(e,t,n,r){this.propSingletonMap[e.ID]=e;delete this.eligibleControlsMap[e.ID];this.defaultControlsMap[e.ID]={display:t,editControlName:n,widgetControlNames:r}};e.prototype.UpdateDisplayControlForPropType=function(e,t){r.JsGridUtil.DebugAssert(null!=this.propSingletonMap[e]);r.JsGridUtil.DebugAssert(null!=this.defaultControlsMap[e]);this.defaultControlsMap[e].display=this.GetDisplayControl(t)};e.prototype.UpdateEditControlForPropType=function(e,t){r.JsGridUtil.DebugAssert(null!=this.propSingletonMap[e]);r.JsGridUtil.DebugAssert(null!=this.defaultControlsMap[e]);this.defaultControlsMap[e].editControlName=t};e.prototype.UpdateWidgetControlsForPropType=function(e,t){r.JsGridUtil.DebugAssert(null!=this.propSingletonMap[e]);r.JsGridUtil.DebugAssert(null!=this.defaultControlsMap[e]);this.defaultControlsMap[e].widgetControlNames=t};e.prototype.GetDisplayControlForProperty=function(e,t){return null!=t?this.GetDisplayControl(t):this.defaultControlsMap[e.ID].display};e.prototype.GetEditAndWidgetControlNamesForProperty=function(e,t,n,r){var i,s;return{editControlName:null!=t.fnGetEditControlName&&null!=(i=t.fnGetEditControlName(e,n))?i:this.defaultControlsMap[r.ID].editControlName,widgetControlNames:null!=t.fnGetWidgetControlNames&&null!=(s=t.fnGetWidgetControlNames(e,n))?s:[].concat(this.defaultControlsMap[r.ID].widgetControlNames)}};e.prototype.Init=function(){for(var e in this.propTypeInfoTable){var t=this.propTypeInfoTable[e];this.RegisterPropType(t[0],t[1],t[2],t[3])}this.InitLocalNumericTypesForGrid();this.InitLocalDateTypeForGrid()};e.prototype.InitLocalDateTypeForGrid=function(){this.RegisterPropType(new a("JSDateTime","M/d/yyyy"),s.DisplayControlType.Text,s.EditControlType.EditBox,[s.WidgetControlType.Date])};e.prototype.InitLocalNumericTypesForGrid=function(){var e=function(e,t,n,r,i,s){var o=this;var u=r?(function(e){e=null!=o.PreParse?o.PreParse(e):e;var t=parseFloat(e);return null!=o.PostParse?o.PostParse(t):t})(n):null!=n.format?n:parseFloat(n+""),a=u.localeFormat(this.FormatString);i({isValid:!isNaN(u),dataValue:null!=this.ProcessData?this.ProcessData(u):u,normalizedLocValue:null!=this.ProcessLocalized?this.ProcessLocalized(u,a):a})},t=function(e,t){r.JsGridUtil.DebugAssert("number"==typeof e&&"number"==typeof t);return e-t},n=[{ID:"JSNumber",FormatString:"D"}];for(var i in n){var o=r.JsGridUtil.Internal.object(n[i]);o.BeginValidateNormalizeConvert=e;o.CompareTo=t;this.RegisterPropType(o,s.DisplayControlType.Text,s.EditControlType.EditBox,[])}};return e})();e.Property=n;var a=(function(){function e(e,t){this.ID=e;this._formatString=t}e.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s){var o={};n=r.JsGridUtil.SPUserValueOnPasteFixup(n);var u=i?Date.parse(n)||Date.parse(n)||Date.parse(n):null!=n.getTime?n:new Date(+n);u=null!=u?new Date(u):null;o.isValid=null!=u&&!isNaN(u.getTime());o.dataValue=o.isValid?u:null;o.normalizedLocValue=o.isValid?u.localeFormat(this._formatString):null;s(o)};return e})();e.JSDateTime=a})(d=e.Internal||(e.Internal={}));var g=(function(){function t(e,t,n){this.gridFieldMap=e;this._keyColumnName=t;this._fnGetPropType=n}t.prototype.MakeRecord=function(t,n,r){var i=new y;i.recordKey=t[this._keyColumnName];for(var s in this.gridFieldMap){var o=this.gridFieldMap[s],u=e.Property.prototype.MakePropertyFromGridField(o,t[s],n[s],null==this._fnGetPropType||o.GetIsMultiValue()?null:this._fnGetPropType(i.recordKey,o.key,t));if(null!=u){i.properties[s]=u;if(!r){delete t[s];delete n[s]}}}i.fieldRawDataMap=null!=t?t:{};i.fieldRawLocMap=null!=n?n:{};return i};return t})();e.RecordFactory=g;var y=(function(){function e(){this.properties={}}e.prototype.key=function(){return this.recordKey};e.prototype.GetDataValue=function(e){return e in this.properties?this.properties[e].GetData():this.fieldRawDataMap[e]};e.prototype.GetLocalizedValue=function(e){return e in this.properties?this.properties[e].GetLocalized():this.fieldRawLocMap[e]};e.prototype.HasDataValue=function(e){return e in this.properties?this.properties[e].HasDataValue():e in this.fieldRawDataMap};e.prototype.HasLocalizedValue=function(e){return e in this.properties?this.properties[e].HasLocalizedValue():e in this.fieldRawLocMap};e.prototype.GetProp=function(e){return this.properties[e]};e.prototype.SetProp=function(e,t){r.JsGridUtil.DebugAssert(e in this.properties);this.properties[e]=t};e.prototype.AddFieldValue=function(e,t){if(t.isProp)this.properties[e]=t.prop;else if(e in this.properties)this.properties[e].Update(t.hasData?t.data:r.JsGridUtil.EmptyValue,t.hasLocalized?t.localized:r.JsGridUtil.EmptyValue);else{t.hasLocalized&&(this.fieldRawLocMap[e]=t.localized);t.hasData&&(this.fieldRawDataMap[e]=t.data)}};e.prototype.RemoveFieldValue=function(e){delete this.properties[e];delete this.fieldRawLocMap[e];delete this.fieldRawDataMap[e]};return e})();e.Record=y;var b=(function(){function e(e,t,n){null!=n&&(this.propType=n);null!=e&&(this.dataValue=e);null!=t&&(this.localizedValue=t)}e.prototype.LocalizedProperty=function(e,t){this.localizedValue=e;null!=t&&(this.propType=t)};e.prototype.DataProperty=function(e,t){this.dataValue=e;null!=t&&(this.propType=t)};e.prototype.HasLocalizedValue=function(){return!0};e.prototype.HasDataValue=function(){return!0};e.prototype.Clone=function(){return this.MakeProperty(r.JsGridUtil.Internal.CloneObj(this.dataValue,null),this.localizedValue,!0,!0,this.propType)};e.prototype.Update=function(e,t){e!==r.JsGridUtil.EmptyValue&&(this.dataValue=e!==r.JsGridUtil.InvalidValue?r.JsGridUtil.Internal.CloneObj(e,null):e);t!==r.JsGridUtil.EmptyValue&&(this.localizedValue=t)};e.prototype.GetLocalized=function(){return this.localizedValue};e.prototype.GetData=function(){return this.dataValue};e.prototype.MakeProperty=function(t,n,r,i,s){return r&&i?new e(t,n,s):r?new w(t,null,s):new E(null,n,s)};e.prototype.MakePropertyFromGridField=function(e,t,n,r){var i=null,s=null!=r?r:e.GetPropType();null!=s&&(i=this.MakeProperty(t,n,e.hasDataValue,e.hasLocalizedValue,s));return i};return e})();e.Property=b;var w=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.HasLocalizedValue=function(){return null!=this.propType.DataToLocalized};t.prototype.HasDataValue=function(){return!0};t.prototype.Clone=function(){return this.MakeProperty(r.JsGridUtil.Internal.CloneObj(this.dataValue,null),this.localizedValue,!0,!1,this.propType)};t.prototype.Update=function(e,t){e!==r.JsGridUtil.EmptyValue&&(this.dataValue=e!==r.JsGridUtil.InvalidValue?r.JsGridUtil.Internal.CloneObj(e,null):e)};t.prototype.GetLocalized=function(){r.JsGridUtil.DebugAssert(this.HasLocalizedValue());return this.dataValue!==r.JsGridUtil.InvalidValue?this.propType.DataToLocalized(this.dataValue):""};t.prototype.GetData=function(){return this.dataValue};return t})(b);e.DataProperty=w;var E=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.HasLocalizedValue=function(){return!0};t.prototype.HasDataValue=function(){return null!=this.propType.LocalizedToData};t.prototype.Clone=function(){return this.MakeProperty(r.JsGridUtil.Internal.CloneObj(this.dataValue,null),this.localizedValue,!1,!0,this.propType)};t.prototype.Update=function(e,t){t!==r.JsGridUtil.EmptyValue&&(this.localizedValue=t)};t.prototype.GetLocalized=function(){return this.localizedValue};t.prototype.GetData=function(){r.JsGridUtil.DebugAssert(this.HasDataValue());return this.localizedValue!==r.JsGridUtil.InvalidValue?this.propType.LocalizedToData(this.localizedValue):null};return t})(b);e.LocalizedProperty=E})(t.PropertyType||(t.PropertyType={}))});
define("aPZ",["require","exports","mU","g","f","aPS","aQo","aPY","di","aQl","aQj","aQi","aQd","aP7","aP6","ayF","LK","aPW","bt","aP4","y4","Zx","aP1","aPQ","aPP","yW","B","v","W","fb","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O){"use strict";var M=O.tablemgr_9;O=O.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var _=y.Killswitch.isActivated("46DFBEC2-2AE8-4FB3-A262-8250A3A2B12A","9/20/2019","Properly render thumbnails when we encounter them.  Fixes VSO 770299"),D=y.Killswitch.isActivated("983CF6BF-776A-4753-92FC-1D8F1F1C6DAA","10/17/2019","make quick edit compatible with dark themes"),P=y.Killswitch.isActivated("E9D6989B-CA84-4451-BE8E-EB906AA2699E","12/13/2019","Use the same image rendering for all of the various types of possible image types."),H=y.Killswitch.isActivated("EA014738-A23C-45F3-B132-ED5DE252CBB3","12/30/2019","Dont let hyperlink widgets expand out past the left edge of the grid."),B=y.Killswitch.isActivated("E018B29A-CDB6-4371-ADC3-D48973674A2F","12/31/2019",'Update the return type for empty single choice from {} to "" so that it doesnt break .'),j=y.Killswitch.isActivated("4A9E7B15-9A73-4C10-9DED-B95112FFAE9E","2/25/2020","Fix a data format issue with custom formatters."),F=y.Killswitch.isActivated("59BAC612-E381-438A-893A-E1EC5719BB4C","1/30/2020",'Fix the positioning of the datepicker after the iframe loads to override the classic date picker"s incorrect positioning in some scenarios.'),I=y.Killswitch.isActivated("56576B97-4ED4-42AC-B0EA-FE5940B1F66B","1/31/2020","Fix an issue where some pickers do not cleanup container divs after dispose."),q=y.Killswitch.isActivated("F02E7AFA-FCD5-4ECF-A4C1-677F72C39097","4/1/2020","Fix an issue where single choice with fill-in columns with a custom formatter don't render fill-in values."),R=y.Killswitch.isActivated("6E0F9B18-4BCC-4034-980F-F477BA89DFB5","04/24/2020","Attempt to rationalize the way we determine the value for custom formatters."),U=y.Killswitch.isActivated("D0B8E914-C520-4ED9-A468-2CB2127A68F9","04/23/2020","Render title or name field as text instead of link"),z=y.Killswitch.isActivated("0345ADFA-E6FE-43BA-8465-DB405A2881E2","04/27/2020","Set the resolve principal source for quick edit people pickers."),W={ODB:1746},X={ODB:1725};function V(e){return"Title"===e.key||"FileLeafRef"===e.key}(function(e){function t(e,t){return"function"!=typeof e.LocalizedValueToCSRValue||null==t||null==t.localized}e.PropTypeNeedsCSRItemToRender=t;function a(e,t,n,r,i,s,a,f,l){var c=r.GetSpCsrRenderCtx(),h=c.ListSchema,p=o.JsGridUtil.Internal.IsFeatureEnabled(X);o.JsGridUtil.DebugAssert(!o.JsGridUtil.Internal.IsNullOrUndefined(n));null==i&&(i={});if(t.hasLocalizedValue&&"function"==typeof f.LocalizedValueToCSRValue){var d=t._propType.LocalizedValueToCSRValue(a.localized);i[n.RealFieldName]=i[n.Name]=d}c.CurrentItem=i;c.CurrentFieldSchema=n;var v=s.parentNode;o.JsGridUtil.DebugAssert("tr"==v.tagName.toLowerCase());null==v.getAttribute("iid")&&v.setAttribute("iid",o.JsGridUtil.Internal.GenerateIID(c));if("TRUE"==n.listItemMenu){var m=s;o.JsGridUtil.DebugAssert("td"==m.tagName.toLowerCase());m.setAttribute("IsECB","TRUE")}var g,y=document.createElement("span"),b={DocIcon:"File_x0020_Type",ThumbnailOnForm:"FileRef",PreviewOnForm:"FileRef"},w=n.RealFieldName in b?b[n.RealFieldName]:n.RealFieldName;if(P){if(!_&&"Thumbnail"===w){(E=document.createElement("img")).src=i.FileRef;l.width&&(p&&c.fixedHeightRowEnabled?E.style.maxHeight="36px":E.style.maxWidth=l.width-23+"px");return E}}else if("Thumbnail"===w||"Image"===n.Format||"Thumbnail"===n.FieldType){var E=document.createElement("img"),S="";if("Thumbnail"===w)S=i.FileRef;else if("Image"===n.Format)a&&a.data&&(S=a.data.address);else if("Thumbnail"===n.FieldType&&a&&a.localized)try{S=JSON.parse(a.localized).serverRelativeUrl}catch(e){console.log("Error parsing JSON for image: "+e.toString())}p&&c.fixedHeightRowEnabled&&s.classList.add(M.imageTypeCell);E.src=S;l.width&&(p&&c.fixedHeightRowEnabled?E.style.maxHeight="36px":E.style.maxWidth=l.width-23+"px");return E}if(!(w in i))return y;g=n.FieldType&&-1!==n.FieldType.indexOf("Taxonomy")?x.Taxonomy.TaxonomyFieldTemplate.renderViewControl(c,n,i,h):o.JsGridUtil.Internal.IsFeatureEnabled(W)?T.spMgr.RenderField(c,n,i,h):window.spMgr.RenderField(c,n,i,h);if(!o.JsGridUtil.Internal.IsNullOrUndefined(g)){o.JsGridUtil.DebugAssert(g.constructor==String);y.innerHTML=g}for(var N=y.getElementsByTagName("a"),C=0;C<N.length;C++){var k=N[C];if(!o.JsGridUtil.Internal.DomElement.GetInstance().AttributeOnElementOrAncestor(k,"ms-jsgrid-click-passthrough","true")){k.onclick=null;k.addEventListener("click",L)}}o.JsGridUtil.Internal.IsNullOrUndefined(l.fnGetDisplayControlName)||u.PropertyType.Internal.Property.GetInstance().GetDisplayControlForProperty(f,l.fnGetDisplayControlName(e,t.key));p&&n.FieldType&&(c.fixedHeightRowEnabled?y.classList.add(O.cellHiddenOverflow):y.classList.add(O.cellBreakWordOverflow));return y;function L(e){e.preventDefault();if(!o.JsGridUtil.Internal.DomElement.GetInstance().AttributeOnElementOrAncestor(e.target,"ms-jsgrid-click-passthrough","true")){e.stopPropagation();o.JsGridUtil.Internal.IsNullOrUndefined(e.ctrlKey&&e.target.href)||window.open(e.target.href,"JsGridAnchorWindow")}}}e.RenderWithCSR=a;function f(e,t,n,r,i){if(null==e)return null;var s=new o.JsGridUtil.ImageWithFabricIcons({imgSrc:e,bIsClustered:!1}).Render(t,n,null);r&&(s.className=r);s.style.border="0px";return i?s:{elem:s,fnDispose:function(){if(!o.JsGridUtil.Internal.IsNullOrUndefined(s)&&!o.JsGridUtil.Internal.IsNullOrUndefined(s.Dispose)){s.Dispose();s=null}}}}e.RenderImage=f;function c(e,t,n,r,i){if(""==e||null==e||e==o.JsGridUtil.EmptyValue||e==o.JsGridUtil.InvalidValue)return null;var u,a=document.createElement("span");if(o.JsGridUtil.Internal.IsNullOrUndefined(t.fnClick))u=a;else{(u=document.createElement("a")).style.cssText=i;a.appendChild(u);u.href="javascript:";u.addEventListener("click",function(e){t.fnClick(e)});u.addEventListener("keydown",function(e){if(e.keyCode==s.JsGridConstants.Key.enter){t.fnClick(e);o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)}});u.tabIndex=-1}o.JsGridUtil.Internal.DomElement.GetInstance().SetTextNoBR(u,e);o.JsGridUtil.Internal.IsNullOrUndefined(t.toolTip)||(u.title=t.toolTip);r&&(a.className=r);n.textDirection!==s.JsGridConstants.TextDirection.Default&&(a.dir=n.textDirection==s.JsGridConstants.TextDirection.RightToLeft?"rtl":"ltr");var f=a;o.JsGridUtil.Internal.IsNullOrUndefined(t.fnClick)||(f={elem:a,fnDispose:function(){o.JsGridUtil.ClearEventListeners(u);u=a=f=null}});return f}e.RenderText=c;function h(e,t,n){var r=document.createElement("div");r.style.cssText="text-align:center";var i=document.createElement("input");i.type="checkbox";i.tabIndex=-1;r.appendChild(i);i.disabled=e;i.checked=t;if(!o.JsGridUtil.Internal.IsNullOrUndefined(n)){i.addEventListener("mousedown",function(e){o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)});i.addEventListener("click",n)}(r={elem:r}).fnDispose=function(){r=null;o.JsGridUtil.ClearEventListeners(i);i=null};return r}e.RenderCheckbox=h;function p(e,t,n,r,i,s){if(!o.JsGridUtil.Internal.IsNullOrUndefined(r)&&r.bHyperlink)return function(){window.open(r.GetAddress(s))};var u=!o.JsGridUtil.Internal.IsNullOrUndefined(t.fnShouldLinkSingleValue)&&t.fnShouldLinkSingleValue(e,n.key,s,i)&&t.fnSingleValueClicked;return u?function(){u(e,n.key,s)}:null}e.GetSingleValueClick=p;function d(e,t,n,r,i){var s=null==t.fnGetSingleValueTooltip?null:t.fnGetSingleValueTooltip(e,n.key,i,r);return null==s?r:s}e.GetSingleValueToolTip=d;function g(e,t,n,r,i,s){return{toolTip:d(e,t,n,i,s),fnClick:p(e,t,n,r,i,s)}}e.GetSingleValueRenderInfo=g;function b(e,t,n,r,i,s,o,u,a){var l=g(e,t,n,r,i,s),c=f(o,l.toolTip,l.fnClick,u,null);return null==c?[]:[c]}e.RenderImageForSingleValue=b;function E(e,t,n,r,i,s,o,u,a){var f=c(i,g(e,t,n,r,i,s),n,u,a);return null==f?[]:[f]}e.RenderTextForSingleValue=E;function S(e,t,n,r,i,s,u,a,l){var h=g(e,t,n,r,i,s),p=f(u,h.toolTip,h.fnClick,a,null),d=c(i,h,n,a,l),v=[];o.JsGridUtil.Internal.IsNullOrUndefined(p)||v.push(p);o.JsGridUtil.Internal.IsNullOrUndefined(d)||v.push(d);return v}e.RenderImageAndTextForSingleValue=S;function D(e,t,n,r,i,s,u,a,f,l,c){var h,p=[],d=!o.JsGridUtil.Internal.IsNullOrUndefined(i)&&i.GetImageSource?i.GetImageSource(t,e.data):null,v=c.GetSpCsrRenderCtx();h=o.JsGridUtil.Internal.IsFeatureEnabled(X)?v.fixedHeightRowEnabled?O.cellHiddenOverflow:O.cellBreakWordOverflow:f.bEnabled?"jsgrid-control-text-rtl":"jsgrid-control-text";!U&&V(r)&&(h=h+" "+(o.JsGridUtil.Internal.IsFeatureEnabled(X)?O.isTitleOrNameFieldVisualRefresh:O.isTitleOrNameField));if(o.JsGridUtil.Internal.IsNullOrUndefined(i)||!i.bMultiValue||o.JsGridUtil.Internal.IsFeatureEnabled(X))p=u(t,n,r,i,e.localized,e.data,d,h,l);else for(var m=i.LocStrToLocStrArray(e.localized),g=0;g<m.length;g++){var y=g<m.length-1&&a?m[g]+i.separator:m[g];p=p.concat(u(t,n,r,i.singleValuePropType,y,e.data?e.data[g]:null,d?d[g]:null,h,l))}return 1==p.length?p[0]:0==p.length?null:{multipleChildren:p}}e.RenderImageAndOrText=D;var H=(function(){function e(){this.Id="DISP_IMAGE"}e.prototype.Render=function(e,t,n,r,i,s,o,u,a){return D(e,t,n,r,i,0,b,!1,u,null,o)};e.prototype.FocusNext=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};e.prototype.OnKeyDown=function(e,t,n,r,i,u,a){if(u.bMultiValue)return!1;if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==s.JsGridConstants.Key.enter){var f=p(n,r,i,u,t.localized,t.data);if(null!=f){f(e);o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}}return!1};return e})();e.ImageDisplayControl=H;var F=(function(){function e(){this.Id="DISP_IMAGETEXT";this._styleForLinks=null}e.prototype.Render=function(e,t,n,r,i,s,o,u,a){return D(e,t,n,r,i,0,S,!0,u,this._styleForLinks,o)};e.prototype.FocusNext=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};e.prototype.OnKeyDown=function(e,t,n,r,i,u,a){if(u.bMultiValue)return!1;if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==s.JsGridConstants.Key.enter){var f=p(n,r,i,u,t.localized,t.data);if(null!=f){f(e);o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}}return!1};return e})();e.ImageTextDisplayControl=F;var I=(function(){function e(){this.Id="DISP_TEXT";this._styleForLinks=null}e.prototype.Render=function(e,t,n,r,i,s,o,u,a){return D(e,t,n,r,i,0,E,!0,u,this._styleForLinks,o)};e.prototype.FocusNext=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};e.prototype.OnKeyDown=function(e,t,n,r,i,u,a){if(u.bMultiValue)return!1;if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==s.JsGridConstants.Key.enter){var f=p(n,r,i,u,t.localized,t.data);if(null!=f){f(e);o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}}return!1};return e})();e.TextDisplayControl=I;var z=(function(){function e(){this.Id="DISP_CHECKBOX"}e.prototype.Render=function(e,t,n,r,i,s,u,a,f){o.JsGridUtil.DebugAssert(!i.bMultiValue);return u.IsGroupingRecordKey(t.key())?null:h(!1,i.GetBool(e.data),null)};e.prototype.FocusNext=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};return e})();e.CheckboxDisplayControl=z;var $=(function(){function e(e,t,n,r,i){this.Id=e+s.JsGridConstants.RecordIndicatorControlId;this._fnUpdateCheckStatus=t;this._fnIsHidden=n;this._fnIsDisabled=r;this._fnIsChecked=i}e.prototype.Render=function(e,t,n,r,i,s,o,u){var a=this,f=t.key();return this._fnIsHidden(f)?null:h(this._fnIsDisabled(f),this._fnIsChecked(f),function(e){a._fnUpdateCheckStatus(f)})};e.prototype.OnKeyDown=function(e,t,n,r,i,u){if(e.keyCode==s.JsGridConstants.Key.space||e.charCode==s.JsGridConstants.Key.space){this._fnUpdateCheckStatus(n.key());o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}return!1};e.prototype.FocusNext=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};return e})();e.RecordIndicatorCheckboxControl=$;var J=(function(){function e(){}e.prototype.Render=function(e,n,r,i,s,u,f,l,c){var h=n.fieldRawDataMap.csrInfo,p=i.csrInfo,d=null!=h&&null!=h.stale&&h.stale[i.key],v=!0;v=n.HasDataValue(i.key)?n.GetDataValue(i.key)==e.data:null==e.data||e.data==o.JsGridUtil.EmptyValue;v=n.HasLocalizedValue(i.key)?n.GetLocalizedValue(i.key)==e.localized:null==e.localized||e.localized==o.JsGridUtil.EmptyValue;var m=f.IsGroupingRecordKey(n.recordKey),g=f.IsGroupingColumnKey(r.columnKey),y=n.bIsNewRow&&"SPEdit"==i.GetPropType().ID,b="DropdownBoolean"==i.GetPropType().ID&&null==e.data;if(m&&!g||y||b)return null;s=i.GetPropType();var S=null==h&&t(s,e);if(("SPUser"==s.ID||"SPUser_MultiValue"==s.ID)&&(null==e.localized||e.localized==o.JsGridUtil.EmptyValue)&&v){(x=document.createElement("div")).style.width="180px";return x}h&&h[i.key]&&p&&"Geolocation"===p.FieldType&&0===h[i.key].indexOf("Point")&&(h[i.key]=w.formatGeolocationString(h[i.key]));if(!v||null==p||d||S||"JSGrid_NewColumn"==i.key||!U&&V(i)){if(!Boolean(e)&&S&&null!=p&&"Title"==p.RealFieldName&&("TRUE"==p.listItemMenu||"TRUE"==p.CalloutMenu)){var x;return x=document.createElement("div")}return D(e,n,r,i,s,0,E,!1,l,null,f)}o.JsGridUtil.DebugAssert(!t(s,e)||null!=h);return a(n,i,p,f,h,c,e,s,r)};return e})();e.CSRDisplayControl=J;var K=(function(){function e(){}e.prototype.Render=function(e,t,n,r,i,s,u,a,f){var l=document.createElement("div"),c=u.GetSpCsrRenderCtx();if(o.JsGridUtil.Internal.IsFeatureEnabled(X)){l.classList.add(O.customFormatField);c.fixedHeightRowEnabled&&f.classList.add(M.customFormatterCell)}l.classList.add(O.spGridCustomFormatField);var h,p=u&&u.objBag&&u.objBag.jsGridParams&&u.objBag.jsGridParams.customFormatterProps,d=p&&p.customFormatterSchema;if(R)if(j){h=t&&t.fieldRawDataMap&&t.fieldRawDataMap.csrInfo;p&&p.getItemData&&(h=p.getItemData(h,d));if(y.Killswitch.isActivated("EC4AE4F1-A4D6-4A7D-B010-0F14A2EFA541","10/15/2019","Fix several problematic custom formatter bugs.")){if(!y.Killswitch.isActivated("A2742A0E-92AA-4A9A-8692-EF584A6C6B37","8/15/2019","Let custom formatters use the updated, user-entered value rather than the stored (old) value when rendering.")&&h){v=r.hasLocalizedValue?e.localized:e.data;h[r.key]!==v&&(h[r.key]=v)}}else{var v=t.HasDataValue(r.key)?e.data:e.localized;h?h[r.key]=v:(h={})[r.key]=v;B||"Choice"===r.csrInfo.FieldType&&h[r.key]===o.JsGridUtil.EmptyValue&&(h[r.key]="")}}else{h=k.deepCopy(t&&t.fieldRawDataMap&&t.fieldRawDataMap.csrInfo);var v=k.deepCopy(t.HasDataValue(r.key)?e.data:e.localized);q||(r&&r.csrInfo&&"MultiChoice"==r.csrInfo.FieldType?e&&e.localized&&(v=e.localized.split("; ")):!e.data&&e.localized?v=k.deepCopy(e.localized):e.data&&!e.localized&&(v=k.deepCopy(e.data)));h?h[r.key]=v:(h={})[r.key]=v;if(v&&t.fieldRawDataMap.csrInfo&&t.fieldRawDataMap.csrInfo[r.key]&&p.customFormatterSchema&&p.customFormatterSchema[r.key]&&"User"===p.customFormatterSchema[r.key])if(v.length&&t.fieldRawDataMap.csrInfo[r.key]&&t.fieldRawDataMap.csrInfo[r.key].length){for(var g=0;g<v.length;g++)for(var b=0;b<t.fieldRawDataMap.csrInfo[r.key].length;b++)if(v[g].display==t.fieldRawDataMap.csrInfo[r.key][b].title){h[r.key][g]=t.fieldRawDataMap.csrInfo[r.key][b];break}}else v&&t.fieldRawDataMap.csrInfo[r.key]&&t.fieldRawDataMap.csrInfo[r.key].length?v.display==t.fieldRawDataMap.csrInfo[r.key][0].title&&(h[r.key]=t.fieldRawDataMap.csrInfo[r.key]):v&&t.fieldRawDataMap.csrInfo[r.key]&&v.display==t.fieldRawDataMap.csrInfo[r.key].title&&(h[r.key]=t.fieldRawDataMap.csrInfo[r.key]);p&&p.getItemData&&(h=p.getItemData(h,d))}else h=this._getValueForCustomFormatter(t,r,e,p,d);var w=new L.default({name:"CFParseColumn"}),E=null;try{E=JSON.parse(n.customFormatter);w.end({resultType:L.ResultTypeEnum.Success})}catch(e){w.end(A.getQosEndSchemaFromError(e))}var S=new m.CustomFormatter({rowIndex:t?t.rowIndex:-1,fieldRendererFormat:E,row:h,currentFieldName:n.columnKey,rowSchema:d,errorStrings:null,pageContextInfo:u.objBag.jsGridParams.pageContext});l.innerHTML=S.evaluate();return l};e.prototype._getValueForCustomFormatter=function(e,t,n,r,i){var s=k.deepCopy(e&&e.fieldRawDataMap&&e.fieldRawDataMap.csrInfo),o=k.deepCopy(e.HasDataValue(t.key)?n.data:n.localized);if(t&&t.csrInfo&&t.csrInfo.FieldType)switch(t.csrInfo.FieldType){case"MultiChoice":n&&n.localized&&(o=n.localized.split("; "));break;case"Choice":n&&n.localized&&(o=n.localized);break;case"User":case"UserMulti":if(o&&o.length&&e.fieldRawDataMap.csrInfo[t.key]&&e.fieldRawDataMap.csrInfo[t.key].length){for(var u=0;u<o.length;u++)for(var a=0;a<e.fieldRawDataMap.csrInfo[t.key].length;a++)if(o[u].display==e.fieldRawDataMap.csrInfo[t.key][a].title){o[u]=e.fieldRawDataMap.csrInfo[t.key][a];break}}else o&&e.fieldRawDataMap.csrInfo[t.key]&&e.fieldRawDataMap.csrInfo[t.key].length?o.display==e.fieldRawDataMap.csrInfo[t.key][0].title&&(o=e.fieldRawDataMap.csrInfo[t.key]):o&&e.fieldRawDataMap.csrInfo[t.key]&&o.display==e.fieldRawDataMap.csrInfo[t.key].title&&(o=e.fieldRawDataMap.csrInfo[t.key])}s?s[t.key]=o:(s={})[t.key]=o;r&&r.getItemData&&(s=r.getItemData(s,i));return s};return e})();e.CustomFormatterDisplayControl=K;var Q=(function(){function e(){}e.prototype.Render=function(e,t,n,s,u,a,f,c){var h=e&&e.localized;if(!h||h==o.JsGridUtil.EmptyValue||h==o.JsGridUtil.InvalidValue)return null;var p=u.bMultiValue?u.LocStrToLocStrArray(e.localized):[e.localized];if(o.JsGridUtil.Internal.IsFeatureEnabled({ODB:1947})){for(var d=[],m=0;m<p.length;m++){(y=Array.isArray(e.data)?e.data[m]:e.data)&&d.push({text:p[m]||y.display,secondaryText:y.email})}var g=document.createElement("span");o.JsGridUtil.Internal.IsFeatureEnabled(X)&&f.GetSpCsrRenderCtx().fixedHeightRowEnabled&&g.classList.add(O.cellHiddenOverflow);r.render(i.createElement(l.PersonDisplay,{users:d}),g);return g}for(d=[],m=0;m<p.length;m++){var y;(y=Array.isArray(e.data)?e.data[m]:e.data)&&d.push({title:p[m]||y.display,email:y.email,picture:"",sip:""})}g=document.createElement("span");if(o.JsGridUtil.Internal.IsFeatureEnabled(X)&&f.GetSpCsrRenderCtx().fixedHeightRowEnabled){g.classList.add(O.cellHiddenOverflow);var b=d.map(function(e){return e.title}).join(", ");g.textContent=b}else r.render(i.createElement(v.UserField,{users:d}),g);return g};e.prototype.FocusNext=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};e.prototype.OnKeyDown=function(e,t,n,r,i,u,a){return!u.bMultiValue&&(function(){if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==s.JsGridConstants.Key.enter){if(null!=p(n,r,i,u,t.localized,t.data)){this._fnClick(e);o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}}return!1})()};return e})();e.UserDisplayControl=Q;var G=(function(){function e(){}e.prototype.Render=function(e,t,r,i,s,u,a,f,l){var c=e&&e.localized;if(!c||c==o.JsGridUtil.EmptyValue||c==o.JsGridUtil.InvalidValue)return null;var h,p=a.GetSpCsrRenderCtx(),d=o.JsGridUtil.Internal.IsFeatureEnabled(X);try{h=JSON.parse(e.localized)}catch(e){o.JsGridUtil.DebugAssert(!1,"Error parsing json for image data. "+e.toString())}if(h&&h.serverRelativeUrl){var v=h.serverRelativeUrl,m=v=(h.serverUrl||"")+v,g=a.objBag&&a.objBag.siteAssetsThumbnailMetadata;if(g&&h.thumbnailRenderer&&h.thumbnailRenderer.spItemUrl&&h.thumbnailRenderer.fileType){var y=g[".thumbnailUrl"],b=n.__assign(n.__assign({},g),{".fileType":h.thumbnailRenderer.fileType,".spItemUrl":h.thumbnailRenderer.spItemUrl}),w={height:48};v=N.buildUrl(y,b)+"&"+C.serializeQuery(w)}var E=document.createElement("img");E.src=v;E.title=h.fileName||"";E.onclick=function(e){Boolean(e)&&Boolean(e.target)&&window.open(m,"_blank")};d&&p.fixedHeightRowEnabled&&l.classList.add(M.imageTypeCell);r.width&&(d&&p.fixedHeightRowEnabled?E.style.maxHeight="36px":E.style.maxWidth=r.width-23+"px");return E}return null};return e})();e.ImageThumbnailDisplayControl=G})(t.DisplayControl||(t.DisplayControl={}));t.DisplayControlType={Image:"DISP_IMAGE",ImageText:"DISP_IMAGETEXT",Text:"DISP_TEXT",Checkbox:"DISP_CHECKBOX",Hierarchy:"DISP_HIERARCHY",RecordIndicatorCheckbox:"DISP_RECORDINDICATORCHECKBOX",CSR:"DISP_CSR",User:"DISP_USER",CustomFormatter:"DISP_CUSTOMFORMATTER",ImageThumbnail:"DISP_IMAGE_THUMBNAIL"};(function(e){var t=(function(){function e(t,n){this.id="jsgrid_editbox";this._bInEdit=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;null!=t.parentNode&&(this.id+=t.parentNode.id);this._parentNode=t.parentNode;this._bUsingGridTextInputElement=null!=n;this._tbGrid=n;this._gridContext=t;this.iid="EditBoxEditControl_"+e._controlNum;console.log("IID: "+this.iid);e._controlNum++;this.Init()}e.prototype.Init=function(){o.JsGridUtil.DebugAssert(null==this._tbGrid||o.JsGridUtil.Internal.DomElement.GetInstance().ElementAttachedToDom(this._tbGrid));this._tbOwn=document.createElement("input");this._tbOwn.id=this.id;this._tbOwn.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;";this._parentNode.appendChild(this._tbOwn);this.UpdateTextBoxProperty(["type"],"text");var e=o.JsGridUtil.Internal.DomElement.GetInstance().GetComputedStyle(this._tbGrid||this._tbOwn,"backgroundColor","background-color"),t="#fff";if(null!=e&&e.length>0){var n=o.JsGridUtil.Internal.Color.HexStringToColor(e);n=o.JsGridUtil.Internal.Color.RemoveAlphaChannel(n);t=o.JsGridUtil.Internal.Color.ColorToHexString(n)}null!=t&&t.length>0&&this.UpdateTextBoxProperty(["style","backgroundColor"],t);var r=this._gridContext.jsGridObj.GetSpCsrRenderCtx(),i=o.JsGridUtil.Internal.IsFeatureEnabled(X)?O.spGridControlEditbox+" "+(r.fixedHeightRowEnabled?"":O.spGridControlEditboxDynamicHeight):"jsgrid-control-editbox";this.UpdateTextBoxProperty(["className"],i);this.UpdateTextBoxProperty(["tabIndex"],-1);this.UpdateTextBoxProperty(["style","direction"],this._gridContext.RTL.ltr)};e.prototype.GetCellContext=function(){return this._cellContext};e.prototype.GetOriginalValue=function(){return this._cellContext.originalValue.localized};e.prototype.SetValue=function(e){this._cellContext.SetCurrentValue({localized:e})};e.prototype.Dispose=function(){o.JsGridUtil.ClearEventListeners(this._tbOwn)};e.prototype.GetInputElement=function(){return this._tbGrid||this._tbOwn};e.prototype.Focus=function(e){var t=this,n=function(){var e=t.GetOriginalValue();r.value=null==e||e==o.JsGridUtil.EmptyValue?"":e;o.JsGridUtil.Internal.IsFeatureEnabled(X)&&(r.scrollLeft=t._gridContext.RTL.bEnabled?-9999:9999)};try{var r=this.GetCurrentTextBoxInputControl();if(null==e){r.focus();r.value=r.value}else if(this._bUsingGridTextInputElement){this._gridContext.OnActivateActor();("mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&e.keyCode==s.JsGridConstants.Key.F2)&&n()}else{r.focus();if("mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&e.keyCode==s.JsGridConstants.Key.F2)n();else if(o.JsGridUtil.Utility.IsChar(e)){var i=String.fromCharCode(e.charCode);r.value=i;this.SetValue(i)}}}catch(e){o.JsGridUtil.DebugAssert(!1,"Incorrectly trying to focus the EditBoxEditControl while hidden?")}};e.prototype.BindToCell=function(e){this._cellContext=e;this.SizeToCell();this._cellContext.field.textDirection!==s.JsGridConstants.TextDirection.Default&&this.UpdateTextBoxProperty(["style","direction"],this._cellContext.field.textDirection==s.JsGridConstants.TextDirection.RightToLeft?"rtl":"ltr");if(o.JsGridUtil.Internal.IsFeatureEnabled(X)){var t=this.GetCurrentTextBoxInputControl();t.classList.remove(O.inputIsNumber);t.classList.remove(O.inputIsTitle);"Number"!==this._cellContext.field.csrInfo.FieldType||this._cellContext.field.csrInfo.CustomFormatter||t.classList.add(O.inputIsNumber);"Title"!==this._cellContext.fieldKey&&"FileLeafRef"!==this._cellContext.fieldKey||t.classList.add(O.inputIsTitle);o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?t.classList.add(O.stickyEditor):t.classList.remove(O.stickyEditor))}this.UpdateTextBoxValue(this._cellContext.originalValue.data)};e.prototype.OnBeginEdit=function(e){var t=this;this._bUsingGridTextInputElement=null!=this._tbGrid&&"keypress"==e.type;var n=this.GetCurrentTextBoxInputControl();this._cellContext.Show(n);this._bInEdit=!0;this.SetupHandlers(!0);"mousedown"!=e.type||this._bUsingGridTextInputElement?this.Focus(e):setTimeout(function(){t.Focus(e)},0)};e.prototype.Unbind=function(){this.UpdateTextBoxValue("")};e.prototype.OnEndEdit=function(){var e=this.GetOriginalValue(),t=this.GetCurrentTextBoxInputControl();e=null==e||e==o.JsGridUtil.EmptyValue?"":e;t.value!==e&&this.SetValue(t.value);this.SetupHandlers(!1);this._cellContext.Hide(t);this._bInEdit=!1};e.prototype.OnCellMove=function(){this.SizeToCell();this._bInEdit&&this._cellContext.Show(this.GetCurrentTextBoxInputControl())};e.prototype.OnValueChanged=function(e){this.UpdateTextBoxValue(null==e.localized||e.localized==o.JsGridUtil.EmptyValue?"":e.localized)};e.prototype.IsCurrentlyUsingGridTextInputElement=function(){return this._bUsingGridTextInputElement};e.prototype.SetupHandlers=function(e){var t=this.GetCurrentTextBoxInputControl();if(e){t.addEventListener("focus",this._gridContext.OnActivateActor);t.addEventListener("blur",this._gridContext.OnDeactivateActor);this._bUsingGridTextInputElement||t.addEventListener("keydown",this._gridContext.OnKeyDown);t.addEventListener("keyup",this.OnKeyUp.bind(this));t.addEventListener("mousedown",this.OnMouseDown.bind(this))}else{t.addEventListener("focus",this._gridContext.OnActivateActor);t.addEventListener("blur",this._gridContext.OnDeactivateActor);this._bUsingGridTextInputElement||t.removeEventListener("keydown",this._gridContext.OnKeyDown);t.removeEventListener("keyup",this.OnKeyUp.bind(this));t.removeEventListener("mousedown",this.OnMouseDown.bind(this))}};e.prototype.OnKeyUp=function(){this.SetValue(this.GetCurrentTextBoxInputControl().value)};e.prototype.SizeToCell=function(){o.JsGridUtil.Internal.IsFeatureEnabled(X)?this.SetSize(this._cellContext.cellWidth-3,this._cellContext.cellHeight-5):this.SetSize(this._cellContext.cellWidth-10,this._cellContext.cellHeight-6)};e.prototype.SetSize=function(e,t){this.UpdateTextBoxProperty(["style","width"],e+"px");this.UpdateTextBoxProperty(["style","height"],t+"px")};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.GetCurrentTextBoxInputControl=function(){return this._bUsingGridTextInputElement?this._tbGrid:this._tbOwn};e.prototype.UpdateTextBoxValue=function(e){var t="";null!=e&&void 0!==e&&"string"==typeof e&&(t=e);this._tbOwn.value=t;this._bUsingGridTextInputElement&&(this._tbGrid.value=t)};e.prototype.SetProp=function(e,t,n){for(var r=0;r<t.length-1;r++)e=e[t[r]];e[t[t.length-1]]=n};e.prototype.UpdateTextBoxProperty=function(e,t){this.SetProp(this._tbOwn,e,t);this._bUsingGridTextInputElement&&this.SetProp(this._tbGrid,e,t)};e._controlNum=0;return e})();e.EditBoxEditControl=t;var n=(function(){function e(e){var t=this;this.id="jsgrid_combobox";this._isDirty=!1;this._disposeFns=[];this._isBound=!1;this._shouldBind=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnMenuDismissed=function(){t._gridPane._objBag.focusMgr.Focus()};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.SetSelectionFrame=function(e){t._gridPane.SetSelectionFrameOnNonTdElement(e,t._cellContext.GetCurrentRect())};this.RegisterForKeyEvents=function(e){t._activeChoiceEditor=e};this.Expand=function(){t._activeChoiceEditor.Expand()};this.OnKeyDown=function(e){if(e.keyCode==s.JsGridConstants.Key.esc){t._processingEsc=!0;setTimeout(function(){t._gridContext.OnKeyDown(e);t._processingEsc=!1},0)}else e.keyCode==s.JsGridConstants.Key.tab?t._gridContext.OnKeyDown(e):e.keyCode==s.JsGridConstants.Key.space&&t._activeChoiceEditor.OnRegisteredKeyEvent(e)};this.OnValueChangedInternal=function(e){if(t._isBound){if(t._processingEsc)return;if(e){null==e.data&&e.localized===g.default.emptyChoice&&(e.localized=null);t._cellContext.SetCurrentValue(e);t._isDirty=!0}}};this.GetListData=function(e){t._cellContext.propType.GetItems(function(n){if(null==n)e(null,null,!1,!0);else{for(var r=[],i=0;i<n.length;i++){var s=t.GetCellValue(n[i],t._cellContext.fieldKey);(s.data||s.localized)&&r.push({key:s.data,text:s.localized})}n.length>0&&"DropdownBoolean"!==n[0].propType.ID&&r.push({key:null,text:g.default.emptyChoice});e(r)}})};this._gridContext=e;null!=e.parentNode&&(this.id+=e.parentNode.id);this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._container=document.createElement("div");this._container.id=this.id;this._container.style.cssText="position:absolute;visibility:hidden;border:0px;top:0px;background-color:"+this._gridContext.styleManager.gridPaneStyle.verticalBorderColor+";overflow-x:visible;";this._gridContext.RTL.bEnabled?this._container.style.right="0px":this._container.style.left="0px";this._container.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this._container);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.Dispose=function(){this._parentNode.removeChild(this._container)};e.prototype.BindToCell=function(e){var t=this;this._shouldBind=!0;this._isBound=!1;this._isMultiSelect=e.propType.bMultiValue;this._gridPane.useCustomSelFrames=!0;if(this._shouldBind){this._isBound=!0;this._cellContext=e;this.GetListData(function(e){t.RenderData(e,t._cellContext.originalValue)})}};e.prototype.RenderData=function(e,t){this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);var n={options:[],gridOptions:e,multiSelect:this._isMultiSelect,gridValue:t,gridOnChange:this.OnValueChangedInternal.bind(this),positionGridSelectionFrame:this.PositionGridSelectionFrame,registerForKeyEvents:this.RegisterForKeyEvents,shouldRestoreFocus:!1,onMenuDismissed:this.OnMenuDismissed,setSelectionFrame:this.SetSelectionFrame};if(this._cellContext.propType.GetIsLimitedToList)n.allowFreeform=!this._cellContext.propType.GetIsLimitedToList();else if(this._cellContext.propType.singleValuePropType&&this._cellContext.propType.singleValuePropType.GetIsLimitedToList){n.allowFreeform=!this._cellContext.propType.singleValuePropType.GetIsLimitedToList();if(n.allowFreeform&&t.localized&&t.data)for(var s=t.localized.split(";"),u=0;u<t.data.length;u++)if("object"==typeof t.data[u]){t.data[u]=s[u];e.push({key:s[u],text:s[u]})}}o.JsGridUtil.Internal.IsFeatureEnabled(X)&&this._gridPane.tableDiv.classList.remove(M.tableHasMouseDown);r.render(i.createElement(c.ChoiceEditor,n),this._container);this.LayoutPickerControl();o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(O.stickyEditor):this._container.classList.remove(O.stickyEditor));this._container.addEventListener("keydown",this.OnKeyDown);this._container.focus()};e.prototype.Unbind=function(){this._shouldBind=!1;if(this._isBound){r.unmountComponentAtNode(this._container);this.OnEndEdit();this._container.removeEventListener("keydown",this.OnKeyDown.bind(this));this._cellContext.Hide(this._container);this._isDirty=!1;for(;this._disposeFns.length>0;)this._disposeFns.shift()()}this._gridPane.useCustomSelFrames=!1;this._isBound=!1};e.prototype.OnBeginEdit=function(e){};e.prototype.OnCellMove=function(e){};e.prototype.OnEndEdit=function(){this._isBound&&this._isDirty&&this._cellContext.NotifyEditComplete()};e.prototype.SetSize=function(e,t){if(this._isBound){this._container.style.minWidth=e+"px";this._container.style.width=e+"px";this._container.style.height=t-1+"px";this._container.style.top=(parseInt(this._container.style.top)+Math.max(0,t/2-10)).toString()+"px"}};e.prototype.LayoutPickerControl=function(){this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);o.JsGridUtil.Internal.IsFeatureEnabled(X)?this._cellContext.Show(this._container,!0):this._cellContext.Show(this._container)};e.prototype.OnValueChanged=function(e){var t=this;if(null==e)return this.OnValueChangedInternal(e);this._isBound&&this.GetListData(function(n){t.RenderData(n,e)})};e.prototype.GetCellValue=function(e,t){var n={};e.HasDataValue(t)&&(n.data=e.GetData(t));e.HasLocalizedValue(t)&&(n.localized=e.GetLocalized(t));null!=e.propType&&null!=e.propType.GetDisplayValue&&(n.localized=e.propType.GetDisplayValue(this._cellContext.record,n.data,n.localized));return n};return e})();e.ComboBoxEditControl=n;var u=(function(){function e(e){var t=this;this.id="jsgrid_combobox";this._isDirty=!1;this._disposeFns=[];this._isBound=!1;this._shouldBind=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnMenuDismissed=function(){t._gridPane._objBag.focusMgr.Focus()};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.RegisterForKeyEvents=function(e){t._activeChoiceEditor=e};this.Expand=function(){t._activeChoiceEditor.Expand()};this.OnKeyDown=function(e){if(e.keyCode==s.JsGridConstants.Key.esc){t._processingEsc=!0;setTimeout(function(){t._gridContext.OnKeyDown(e);t._processingEsc=!1},0)}else e.keyCode==s.JsGridConstants.Key.tab?t._gridContext.OnKeyDown(e):e.keyCode==s.JsGridConstants.Key.space&&t._activeChoiceEditor.OnRegisteredKeyEvent(e)};this.OnValueChangedInternal=function(e){if(t._isBound){if(t._processingEsc)return;if(e){null==e.data&&e.localized===g.default.emptyChoice&&(e.localized=null);t._cellContext.SetCurrentValue(e);t._isDirty=!0}}};this.GetListData=function(e){t._cellContext.propType.GetItems(function(n){if(null==n)e(null,null,!1,!0);else{for(var r=[],i=0;i<n.length;i++){var s=t.GetCellValue(n[i],t._cellContext.fieldKey);(s.data||s.localized)&&r.push({key:s.data,text:s.localized})}e(r)}})};this._gridContext=e;null!=e.parentNode&&(this.id+=e.parentNode.id);this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._container=document.createElement("div");this._container.id=this.id;this._container.style.cssText="position:absolute;visibility:hidden;border:0px;top:0px;background-color:"+this._gridContext.styleManager.gridPaneStyle.verticalBorderColor+";overflow-x:visible;"+(o.JsGridUtil.Internal.IsFeatureEnabled(X)?"z-index:"+s.JsGridConstants.Internal.zIndex.editor:"margin-left:-1px");this._gridContext.RTL.bEnabled?this._container.style.right="0px":this._container.style.left="0px";this._container.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this._container);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.Dispose=function(){this._parentNode.removeChild(this._container)};e.prototype.BindToCell=function(e){this._shouldBind=!0;this._isBound=!1;this._isMultiSelect=e.propType.bMultiValue;this._gridPane.useCustomSelFrames=!0;if(this._shouldBind){this._isBound=!0;this._cellContext=e}};e.prototype.RenderData=function(e,t){this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);var n={rowData:this._cellContext.record.fieldRawDataMap.csrInfo,rowSchema:[this._cellContext.column],currentFieldName:this._cellContext.column.columnKey,options:[],gridOptions:e,multiSelect:this._isMultiSelect,gridValue:t,gridOnChange:this.OnValueChangedInternal.bind(this),positionGridSelectionFrame:this.PositionGridSelectionFrame,registerForKeyEvents:this.RegisterForKeyEvents,shouldRestoreFocus:!1,onMenuDismissed:this.OnMenuDismissed,cellHeight:this._cellContext.cellHeight,cellWidth:this._cellContext.cellWidth,fieldType:this._cellContext.column.fieldType};if(this._cellContext.propType.GetIsLimitedToList)n.allowFreeform=!this._cellContext.propType.GetIsLimitedToList();else if(this._cellContext.propType.singleValuePropType&&this._cellContext.propType.singleValuePropType.GetIsLimitedToList){n.allowFreeform=!this._cellContext.propType.singleValuePropType.GetIsLimitedToList();if(n.allowFreeform&&t.localized&&t.data)for(var s=t.localized.split(";"),u=0;u<t.data.length;u++)if("object"==typeof t.data[u]){t.data[u]=s[u];e.push({key:s[u],text:s[u]})}}o.JsGridUtil.Internal.IsFeatureEnabled(X)&&this._gridPane.tableDiv.classList.remove(M.tableHasMouseDown);r.render(i.createElement(h.ModernChoiceEditor,n),this._container);this.LayoutPickerControl();this._container.addEventListener("keydown",this.OnKeyDown);this._container.focus()};e.prototype.Unbind=function(){this._shouldBind=!1;if(this._isBound){r.unmountComponentAtNode(this._container);this.OnEndEdit();this._container.removeEventListener("keydown",this.OnKeyDown);this._cellContext.Hide(this._container);this._isDirty=!1;for(;this._disposeFns.length>0;)this._disposeFns.shift()()}this._gridPane.useCustomSelFrames=!1;this._isBound=!1};e.prototype.OnBeginEdit=function(e){var t=this;this.GetListData(function(e){t.RenderData(e,t._cellContext.originalValue)})};e.prototype.OnCellMove=function(e){};e.prototype.OnEndEdit=function(){this._isBound&&this._isDirty&&this._cellContext.NotifyEditComplete()};e.prototype.SetSize=function(e,t){if(this._isBound){this._container.style.minWidth=e+"px";this._container.style.width=e+"px";this._container.style.height=t-1+"px";this._container.style.top=(parseInt(this._container.style.top)+Math.max(0,t/2-10)).toString()+"px"}};e.prototype.LayoutPickerControl=function(){this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);o.JsGridUtil.Internal.IsFeatureEnabled(X)?this._cellContext.Show(this._container,!0):this._cellContext.Show(this._container)};e.prototype.OnValueChanged=function(e){var t=this;if(null==e)return this.OnValueChangedInternal(e);this._isBound&&this.GetListData(function(n){t.RenderData(n,e)})};e.prototype.GetCellValue=function(e,t){var n={};e.HasDataValue(t)&&(n.data=e.GetData(t));e.HasLocalizedValue(t)&&(n.localized=e.GetLocalized(t));null!=e.propType&&null!=e.propType.GetDisplayValue&&(n.localized=e.propType.GetDisplayValue(this._cellContext.record,n.data,n.localized));return n};return e})();e.ModernComboBoxEditControl=u;var a=(function(){function e(e){this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.DataOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.DataOnly;this._checkboxActive=!1;this._potentialToggleCoords=null;this._divShown=!1;this._parentNode=e.parentNode;this._gridContext=e;this.Init()}e.prototype.Init=function(){var e=this;this._gridContext.bLightFocus=!0;this.mainDiv=document.createElement("div");this.mainDiv.style.cssText="position:absolute;top:0px;left:0px;visibility:hidden;text-align:center;background-color:#ffffff;";this._parentNode.appendChild(this.mainDiv);this.cbx=document.createElement("input");this.cbx.type="checkbox";this.cbx.tabIndex=-1;this.mainDiv.appendChild(this.cbx);this.cbx.addEventListener("focus",this._gridContext.OnActivateActor);this.cbx.addEventListener("blur",this._gridContext.OnDeactivateActor);document.body.addEventListener("mouseup",function(t){if(e._checkboxActive&&!e._divShown&&null!=e._potentialToggleCoords){var n=o.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(e.cbx),r=o.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(t);if(o.JsGridUtil.Internal.DomElement.GetInstance().PointInDomElem(r.x,r.y,e.cbx,n)&&o.JsGridUtil.Internal.DomElement.GetInstance().PointInDomElem(e._potentialToggleCoords.x,e._potentialToggleCoords.y,e.cbx,n)){e.cbx.checked=!e._cellContext.propType.GetBool(e._cellContext.originalValue.data);e.ApplyUpdate()}}e._divShown=!1});document.body.addEventListener("mousedown",function(t){var n=o.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(t);e._potentialToggleCoords={x:n.x,y:n.y}});this.mainDiv.addEventListener("mousedown",function(t){e._divShown=!0});this.mainDiv.addEventListener("focus",function(t){e.cbx.focus()})};e.prototype.Dispose=function(){o.JsGridUtil.ClearEventListeners(this.mainDiv);o.JsGridUtil.ClearEventListeners(this.cbx);this._parentNode.removeChild(this.mainDiv)};e.prototype.BindToCell=function(e){this._cellContext=e;o.JsGridUtil.DebugAssert(!this._cellContext.propType.bMultiValue);this._checkboxActive=!0;this.LayoutControl();this.cbx.checked=this._cellContext.propType.GetBool(this._cellContext.originalValue.data);this.cbx.addEventListener("keydown",this._gridContext.OnKeyDown);this.cbx.addEventListener("click",this.ApplyUpdate.bind(this))};e.prototype.OnCellMove=function(){this.LayoutControl()};e.prototype.SetSize=function(e,t){this.mainDiv.style.width=e+"px";var n=Math.floor((t-this.cbx.clientHeight)/2);this.mainDiv.style.padding=n+"px 0px 0px 0px";this.mainDiv.style.height=t-n+"px"};e.prototype.LayoutControl=function(){this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);this._cellContext.Show(this.mainDiv)};e.prototype.Unbind=function(){this._checkboxActive=!1;this.cbx.removeEventListener("keydown",this._gridContext.OnKeyDown);this.cbx.removeEventListener("click",this.ApplyUpdate);this._cellContext.Hide(this.mainDiv)};e.prototype.OnValueChanged=function(){this.cbx.checked=this._cellContext.propType.GetBool(this._cellContext.originalValue.data)};e.prototype.OnKeyDown=function(e){if(e.keyCode==s.JsGridConstants.Key.space||e.charCode==s.JsGridConstants.Key.space){this.cbx.checked=!this.cbx.checked;this.ApplyUpdate();o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}return!1};e.prototype.OnBeginEdit=function(e){this.cbx.focus()};e.prototype.OnEndEdit=function(){};e.prototype.ApplyUpdate=function(){this._cellContext.SetCurrentValue({data:this.cbx.checked});this._cellContext.NotifyEditComplete()};return e})();e.CheckboxEditControl=a;var l=(function(){function e(e){var t=this;this.idPrefix="peoplePickerDiv";this._isDirty=!1;this._inEdit=!1;this._isBound=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnUserResolvedCallback=function(e){t._isDirty=!0;var n;if(Boolean(t._cellContext.field._multiValue)&&e.length>0){for(var r=[],i=[],s=0;s<e.length;s++){var u=t.OnSingleUserValue(e[s]);r.push(u.data);i.push(u.localized)}n={data:r,localized:o.JsGridUtil.Internal.URI_ConvertMultiColumnValueToString(i,o.JsGridUtil.multiValSeparator,!1)}}else n=e.length>0?t.OnSingleUserValue(e[0]):{data:null,localized:""};void 0!==n&&null!=n&&t._cellContext.SetCurrentValue(n)};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect(),t._cellContext.column.isSticky)};this.SetSelectionFrame=function(e){t._gridPane.SetSelectionFrameOnNonTdElement(e,t._cellContext.GetCurrentRect())};this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.EnsurePeoplePicker=function(e,t){var n=this._cellContext.propType.bMultiValue?this._cellContext.propType.singleValuePropType:this._cellContext.propType,s=n.GetPeoplePickerSettings.bind(n)(this._cellContext.fieldKey),u=null==s||""==s?[]:s.split(";#");o.JsGridUtil.DebugAssert(3==u.length,"SPUser settings to initialize PeoplePicker has 3 values.");var a={principalType:d.createSPPrincipalType(u[0]),allowMultipleEntities:this._cellContext.field._multiValue,groupID:u[1],maximumEntitySuggestions:3,required:"True"===u[2]};z||(a.principalSource=15);var l={dataSource:this._gridContext.peoplePickerDataSource,context:this._gridContext.pageContext,selectedItems:e,peoplePickerQueryParams:a,onSelectedPersonasChange:this.OnUserResolvedCallback,inputProps:{onBlur:this.OnPickerInputBlur.bind(this),onFocus:this._gridContext.OnActivateActor},onEditorMouseDown:this.OnMouseDown.bind(this),onEditorKeyDown:this.OnKeyDown.bind(this),positionGridSelectionFrame:this.PositionGridSelectionFrame,setSelectionFrame:this.SetSelectionFrame};r.render(i.createElement(f.PeopleEditor,l),this._pickercontainer);var c=this._pickercontainer.getElementsByTagName("input");c&&c.length&&(this._editorelm=c[0]);this._inEdit&&this.SetupHandlers(!0);if(null!=t&&null!=this._editorelm&&("keydown"==t.type||"keypress"==t.type)&&o.JsGridUtil.Utility.IsChar(t)){var h=String.fromCharCode(t.charCode);this._editorelm.value=h}};e.prototype.Init=function(){this._gridContext.RTL.bEnabled?this._direction=this._gridContext.RTL.rtl:this._direction=this._gridContext.RTL.ltr;this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.CreatePickerDiv=function(e){this._pickercontainer=document.createElement("div");this._pickercontainer.id=e;this._pickercontainer.style.direction=this._direction;this._direction==this._gridContext.RTL.rtl?this._pickercontainer.style.right="-1px":this._pickercontainer.style.left="-1px";this._pickercontainer.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;border-width:0px";this._pickercontainer.className=o.JsGridUtil.Internal.IsFeatureEnabled(X)?O.msGrid:"ms-grid";o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._pickercontainer.classList.add(O.stickyEditor):this._pickercontainer.classList.remove(O.stickyEditor));this._parentNode.appendChild(this._pickercontainer);this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight)};e.prototype.Dispose=function(){};e.prototype.IsCurrentlyUsingGridTextInputElement=function(){return!1};e.prototype.BindToCell=function(e){this._cellContext=e;this._isBound=!0;this._gridPane.useCustomSelFrames=!1;this.CreatePickerDiv(this.idPrefix)};e.prototype.Unbind=function(){this._isBound=!1;this._gridPane.useCustomSelFrames=!1;this._cellContext.Hide(this._pickercontainer);r.unmountComponentAtNode(this._pickercontainer);I||this._parentNode.removeChild(this._pickercontainer)};e.prototype.OnBeginEdit=function(e){var t=this.GetOriginalValue();this._inEdit=!0;this._cellContext.Show(this._pickercontainer);this.EnsurePeoplePicker(t,e)};e.prototype.OnEndEdit=function(){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1};e.prototype.SetupHandlers=function(e){null!=this._pickercontainer&&(e?this._pickercontainer.addEventListener("mousedown",this.OnMouseDown.bind(this)):this._pickercontainer.removeEventListener("mousedown",this.OnMouseDown.bind(this)))};e.prototype.OnPickerInputBlur=function(e){this._inEdit||this._gridContext.OnDeactivateActor(e)};e.prototype.IsSpecialNavKeys=function(e){var t=e.keyCode;return t==s.JsGridConstants.Key.tab||t==s.JsGridConstants.Key.esc||t==s.JsGridConstants.Key.enter||t==s.JsGridConstants.Key.windows||t>=s.JsGridConstants.Key.left&&t<=s.JsGridConstants.Key.down};e.prototype.OnKeyDown=function(e){if(!this._inEdit||this.IsSpecialNavKeys(e)){this._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;this._gridContext.OnKeyDown(e)}};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.OnValueChanged=function(e){if(this._isDirty){this.UpdateElementValue(this._editorelm,e);this._isDirty=!1}};e.prototype.SetSize=function(e,t){this._pickercontainer.style.minWidth=String(e-2)+"px";o.JsGridUtil.Internal.IsFeatureEnabled(W)||(this._pickercontainer.style.minHeight=String(t-2)+"px")};e.prototype.OnCellMove=function(){this._isBound&&this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight)};e.prototype.GetOriginalValue=function(){return null!=this._cellContext.originalValue.data?this.GetOriginalDataValue():this.GetOriginalLocValue()};e.prototype.GetOriginalDataValue=function(){for(var e=[],t=this._cellContext.originalValue.data,n=0;n<t.length;n++)"email"in t[n]?e.push(this.BuildUnresolvedEntity(t[n].email,t[n].display)):e.push(this.BuildUnresolvedEntity(t[n].get_email(),t[n].get_lookupValue()));return e};e.prototype.GetOriginalLocValue=function(){var e=[],t=this._cellContext.originalValue.localized;if(null!=t&&""!==t)for(var n=t.split(o.JsGridUtil.multiValSeparator),r=0;r<n.length;r++)""!==n[r]&&e.push(this.BuildUnresolvedEntity(o.JsGridUtil.Internal.Encoding_STSHtmlEncode(n[r]),n[r]));return e};e.prototype.BuildUnresolvedEntity=function(e,t){return{userId:e,name:t,email:e}};e.prototype.OnSingleUserValue=function(e){var t={data:null,localized:""};e&&(t={data:{email:e.email,display:e.name},localized:e.name});return t};e.prototype.UpdateElementValue=function(e,t){o.JsGridUtil.DebugAssert(null!=e);e.value=t};return e})();e.PeoplePickerEditControl=l;var v=(function(){function e(e){var t=this;this.idPrefix="locationPickerDiv";this._isDirty=!1;this._inEdit=!1;this._isBound=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnLocationResolvedCallback=function(e){t._isDirty=!0;var n;void 0!==(n=e?t.OnSingleLocationValue(e):{data:null,localized:""})&&null!=n&&t._cellContext.SetCurrentValue(n)};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.SetSelectionFrame=function(e){t._gridPane.SetSelectionFrameOnNonTdElement(e,t._cellContext.GetCurrentRect())};this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.EnsureLocationPicker=function(e,t){var n={dataSource:this._gridContext.locationDataSource,pageContext:this._gridContext.pageContext,defaultLocation:e,onChange:this.OnLocationResolvedCallback,onBlur:this.OnPickerInputBlur.bind(this),onEditorMouseDown:this.OnMouseDown.bind(this),onEditorKeyDown:this.OnKeyDown.bind(this),positionGridSelectionFrame:this.PositionGridSelectionFrame,setSelectionFrame:this.SetSelectionFrame};r.render(i.createElement(b.LocationEditor,n),this._pickercontainer);var s=this._pickercontainer.getElementsByTagName("input");s&&s.length&&(this._editorelm=s[0]);this._inEdit&&this.SetupHandlers(!0);if(null!=t&&null!=this._editorelm&&("keydown"==t.type||"keypress"==t.type)&&o.JsGridUtil.Utility.IsChar(t)){var u=String.fromCharCode(t.charCode);this._editorelm.value=u}};e.prototype.Init=function(){this._gridContext.RTL.bEnabled?this._direction=this._gridContext.RTL.rtl:this._direction=this._gridContext.RTL.ltr;this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.CreatePickerDiv=function(e){this._pickercontainer=document.createElement("div");this._pickercontainer.id=e;this._pickercontainer.style.direction=this._direction;this._direction==this._gridContext.RTL.rtl?this._pickercontainer.style.right="-1px":this._pickercontainer.style.left="-1px";this._pickercontainer.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;border-width:0px";this._pickercontainer.className=o.JsGridUtil.Internal.IsFeatureEnabled(X)?O.msGrid:"ms-grid";this._parentNode.appendChild(this._pickercontainer);this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._pickercontainer.classList.add(O.stickyEditor):this._pickercontainer.classList.remove(O.stickyEditor))};e.prototype.Dispose=function(){};e.prototype.IsCurrentlyUsingGridTextInputElement=function(){return!1};e.prototype.BindToCell=function(e){this._cellContext=e;this._isBound=!0;this._gridPane.useCustomSelFrames=!1;this.CreatePickerDiv(this.idPrefix)};e.prototype.Unbind=function(){this._isBound=!1;this._gridPane.useCustomSelFrames=!1;this._cellContext.Hide(this._pickercontainer);r.unmountComponentAtNode(this._pickercontainer)};e.prototype.OnBeginEdit=function(e){var t=this.GetOriginalValue();this._inEdit=!0;this._cellContext.Show(this._pickercontainer);this.EnsureLocationPicker(t,e)};e.prototype.OnEndEdit=function(){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1};e.prototype.SetupHandlers=function(e){null!=this._pickercontainer&&(e?this._pickercontainer.addEventListener("mousedown",this.OnMouseDown.bind(this)):this._pickercontainer.removeEventListener("mousedown",this.OnMouseDown.bind(this)))};e.prototype.OnPickerInputBlur=function(e){this._inEdit||this._gridContext.OnDeactivateActor(e)};e.prototype.IsSpecialNavKeys=function(e){var t=e.keyCode;return t==s.JsGridConstants.Key.tab||t==s.JsGridConstants.Key.esc||t==s.JsGridConstants.Key.enter||t==s.JsGridConstants.Key.windows||t>=s.JsGridConstants.Key.left&&t<=s.JsGridConstants.Key.down};e.prototype.OnKeyDown=function(e){if(!this._inEdit||this.IsSpecialNavKeys(e)){this._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;this._gridContext.OnKeyDown(e)}};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.OnValueChanged=function(e){if(this._isDirty){this.UpdateElementValue(this._editorelm,e);this._isDirty=!1}};e.prototype.SetSize=function(e,t){this._pickercontainer.style.minWidth=String(e-2)+"px";o.JsGridUtil.Internal.IsFeatureEnabled(W)||(this._pickercontainer.style.minHeight=String(t-2)+"px")};e.prototype.OnCellMove=function(){this._isBound&&this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight)};e.prototype.GetOriginalValue=function(){return null!=this._cellContext.originalValue.data?this.GetOriginalDataValue():this.GetOriginalLocValue()};e.prototype.GetOriginalDataValue=function(){var e=this._cellContext.originalValue.data;return this.BuildUnresolvedEntity(e.Address,e.DisplayName,e.Coordinates,e.LocationUri,e.EntityType)};e.prototype.GetOriginalLocValue=function(){var e=this._cellContext.originalValue.localized;return this.BuildUnresolvedEntity(null,e,null,null,null)};e.prototype.BuildUnresolvedEntity=function(e,t,n,r,i){return e||t||n||r||i?{Address:e,DisplayName:t,Coordinates:n,LocationUri:r,EntityType:i}:null};e.prototype.OnSingleLocationValue=function(e){var t={data:null,localized:""};e&&(t={data:{Address:e.Address,DisplayName:e.DisplayName,Coordinates:e.Coordinates,LocationUri:e.LocationUri,EntityType:e.EntityType},localized:e.DisplayName});return t};e.prototype.UpdateElementValue=function(e,t){o.JsGridUtil.DebugAssert(null!=e);e.value=t};return e})();e.LocationPickerEditControl=v;var m=(function(){function e(e,t){var n=this;this.idPrefix="taxonomyPickerDiv";this._isDirty=!1;this._inEdit=!1;this._isBound=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnTermResolvedCallback=function(e){n._isDirty=!0;var t;if(Boolean(n._cellContext.field._multiValue)&&e.length>0){for(var r=[],i=[],s=0;s<e.length;s++){var u=n.OnSingleTermValue(e[s]);r.push(u.data);i.push(u.localized)}t={data:r,localized:o.JsGridUtil.Internal.URI_ConvertMultiColumnValueToString(i,E.TERM_DELIMITER,!1)}}else t=e.length>0?n.OnSingleTermValue(e[0]):{data:null,localized:""};void 0!==t&&null!=t&&n._cellContext.SetCurrentValue(t)};this.PositionGridSelectionFrame=function(e){n._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,n._cellContext.GetCurrentRect())};this.SetSelectionFrame=function(e){n._gridPane.SetSelectionFrameOnNonTdElement(e,n._cellContext.GetCurrentRect())};this._gridContext=e;this._customFieldInfo=t;this._parentNode=e.parentNode;this.Init()}e.prototype.EnsureTaxonomyPicker=function(e,t){var n={onEditorKeyDown:this.OnKeyDown.bind(this),onEditorMouseDown:this.OnMouseDown.bind(this),positionGridSelectionFrame:this.PositionGridSelectionFrame,dataSource:this._gridContext.taxonomyPickerDataSource,pageContext:this._gridContext.pageContext,selectedTerms:e,onItemsChange:this.OnTermResolvedCallback,onBlur:this.OnPickerInputBlur.bind(this),schema:this._customFieldInfo[this._cellContext.fieldKey],setSelectionFrame:this.SetSelectionFrame};r.render(i.createElement(S.TaxonomyEditor,n),this._pickercontainer);var s=this._pickercontainer.getElementsByTagName("input");s&&s.length&&(this._editorelm=s[0]);this._inEdit&&this.SetupHandlers(!0);if(null!=t&&null!=this._editorelm&&("keydown"==t.type||"keypress"==t.type)&&o.JsGridUtil.Utility.IsChar(t)){var u=String.fromCharCode(t.charCode);this._editorelm.value=u}};e.prototype.Init=function(){this._gridContext.RTL.bEnabled?this._direction=this._gridContext.RTL.rtl:this._direction=this._gridContext.RTL.ltr;this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.CreatePickerDiv=function(e){this._pickercontainer=document.createElement("div");this._pickercontainer.id=e;this._pickercontainer.style.direction=this._direction;this._direction==this._gridContext.RTL.rtl?this._pickercontainer.style.right="-1px":this._pickercontainer.style.left="-1px";this._pickercontainer.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;border-width:0px";this._pickercontainer.className=o.JsGridUtil.Internal.IsFeatureEnabled(X)?O.msGrid:"ms-grid";o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._pickercontainer.classList.add(O.stickyEditor):this._pickercontainer.classList.remove(O.stickyEditor));this._parentNode.appendChild(this._pickercontainer);this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight)};e.prototype.Dispose=function(){};e.prototype.IsCurrentlyUsingGridTextInputElement=function(){return!1};e.prototype.BindToCell=function(e){this._cellContext=e;this._isBound=!0;this._gridPane.useCustomSelFrames=!1;this.CreatePickerDiv(this.idPrefix)};e.prototype.Unbind=function(){this._isBound=!1;this._gridPane.useCustomSelFrames=!1;this._cellContext.Hide(this._pickercontainer);r.unmountComponentAtNode(this._pickercontainer);I||this._parentNode.removeChild(this._pickercontainer)};e.prototype.OnBeginEdit=function(e){var t=this.GetOriginalValue();this._inEdit=!0;this._cellContext.Show(this._pickercontainer);this.EnsureTaxonomyPicker(t,e)};e.prototype.OnEndEdit=function(){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1};e.prototype.SetupHandlers=function(e){null!=this._pickercontainer&&(e?this._pickercontainer.addEventListener("mousedown",this.OnMouseDown.bind(this)):this._pickercontainer.removeEventListener("mousedown",this.OnMouseDown.bind(this)))};e.prototype.OnPickerInputBlur=function(e){this._inEdit||this._gridContext.OnDeactivateActor(e)};e.prototype.IsSpecialNavKeys=function(e){var t=e.keyCode;return t==s.JsGridConstants.Key.tab||t==s.JsGridConstants.Key.esc||t==s.JsGridConstants.Key.enter||t==s.JsGridConstants.Key.windows||t>=s.JsGridConstants.Key.left&&t<=s.JsGridConstants.Key.down};e.prototype.OnKeyDown=function(e){if(!this._inEdit||this.IsSpecialNavKeys(e)){this._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;this._gridContext.OnKeyDown(e)}};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.OnValueChanged=function(e){if(this._isDirty){this.UpdateElementValue(this._editorelm,e);this._isDirty=!1}};e.prototype.SetSize=function(e,t){this._pickercontainer.style.minWidth=String(e-2)+"px";o.JsGridUtil.Internal.IsFeatureEnabled(W)||(this._pickercontainer.style.minHeight=String(t-2)+"px")};e.prototype.OnCellMove=function(){this._isBound&&this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight)};e.prototype.GetOriginalValue=function(){return null!=this._cellContext.originalValue.data?this.GetOriginalDataValue():this.GetOriginalLocValue()};e.prototype.GetOriginalDataValue=function(){var e=[],t=this._cellContext.originalValue.data;if(""!==t)if(Array.isArray(t))for(var n=0;n<t.length;n++)e.push(this.BuildUnresolvedEntity(t[n].TermID,t[n].Label));else e.push(this.BuildUnresolvedEntity(t.TermID,t.Label));return e};e.prototype.GetOriginalLocValue=function(){var e=[],t=this._cellContext.originalValue.localized;if(null!=t&&""!==t)for(var n=t.split(E.TERM_DELIMITER),r=0;r<n.length;r++)if(""!==n[r]){var i=n[r].split(E.LABEL_ID_DELIMITER);e.push(this.BuildUnresolvedEntity(i[1],i[0]))}return e};e.prototype.BuildUnresolvedEntity=function(e,t){var n=e!==E.INVALID_TERM_ID;return{term:{termId:e,label:t,isValid:n},isSynonym:!1,completions:[],start:"",state:n?1:2}};e.prototype.OnSingleTermValue=function(e){var t={data:null,localized:""};e&&(t={data:{Label:e.term.label,TermID:e.term.termId},localized:e.term.label+E.LABEL_ID_DELIMITER+e.term.termId});return t};e.prototype.UpdateElementValue=function(e,t){o.JsGridUtil.DebugAssert(null!=e);e.value=t};return e})();e.TaxonomyPickerEditControl=m;e.GetHyperlinkEditControl=function(t,n){var r=new e.EditBoxEditControl(t,n);r.SetValue=function(e){var t=r.GetInputElement(),n=r.GetCellContext(),i=null!=n.originalValue.data?n.originalValue.data.display:null,s=null!=n.originalValue.data?n.originalValue.data.address:null,o=null==i||""==i||i==s?t.value:i,u={address:t.value,display:o};n.SetCurrentValue({data:u})};r.GetOriginalValue=function(){var e=r.GetCellContext();return null!=e.originalValue.data?e.originalValue.data.address:null};r.OnValueChanged=function(e){r.GetInputElement().value=null==e.data||null==e.data.address||e.data==o.JsGridUtil.EmptyValue||e.data.address==o.JsGridUtil.EmptyValue?"":e.data.address};return r};var y=(function(){function e(e){var t=this;this.id="jsgrid_hyperlink";this._isDirty=!1;this._isBound=!1;this._inEdit=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnMenuDismissed=function(){t._gridPane._objBag.focusMgr.Focus()};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.SetSelectionFrame=function(e){t._gridPane.SetSelectionFrameOnNonTdElement(e,t._cellContext.GetCurrentRect())};this.OnValueChanged=function(e){if(t._isDirty){t.UpdateElementValue(t._editorelm,e);t._isDirty=!1}};this.OnOK=function(e){t._cellContext.NotifyEditComplete();t._cellContext.NotifyEditComplete();null!=e&&null!=e.preventDefault&&e.preventDefault()};this.OnCancel=function(){t._cellContext.NotifyEditComplete(!0);t._cellContext.NotifyEditComplete(!0)};this.OnValueChangedInternal=function(e){if(e){var n=t.GetOriginalValue(),r=n.display,i=n.address,s=e.display,o=e.address;s!=r||null!=r&&""!=r&&r!=i||(s=o);t._cellContext.SetCurrentValue({data:{address:o,display:s}});t._isDirty=!0}};this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._container=document.createElement("div");this._container.id=this.id;this._container.style.cssText="position:absolute;visibility:hidden;border:0px;top:0px;overflow-x:visible;margin-left:-1px";this._gridContext.RTL.bEnabled?this._container.style.right="0px":this._container.style.left="0px";this._container.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this._container);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.Dispose=function(){this._parentNode.removeChild(this._container)};e.prototype.BindToCell=function(e){this._isBound=!0;this._cellContext=e};e.prototype.Unbind=function(){if(this._isBound){this.OnEndEdit();this._cellContext.Hide(this._container);this._isDirty=!1;r.unmountComponentAtNode(this._container)}this._gridPane.useCustomSelFrames=!1;this._isBound=!1};e.prototype.OnBeginEdit=function(e){var t=this.GetOriginalValue();this._inEdit=!0;this._cellContext.Show(this._container);this.RenderData(t)};e.prototype.OnCellMove=function(e){};e.prototype.OnEndEdit=function(){if(this._isBound&&this._isDirty){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1;this._cellContext.NotifyEditComplete()}};e.prototype.RenderData=function(e){var t={target:this._cellContext.GetCurrentTd(),onSave:this.OnOK,onCancel:this.OnCancel},n={onEditorMouseDown:this.OnMouseDown.bind(this),onEditorKeyDown:this.OnKeyDown.bind(this),onValueChange:this.OnValueChangedInternal,currentUrlValue:e.address,currentDisplayValue:e.display,calloutProps:t};r.render(i.createElement(p.HyperlinkEditor,n),this._container);this._inEdit&&this.SetupHandlers(!0);o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(O.stickyEditor):this._container.classList.remove(O.stickyEditor));this._container.focus()};e.prototype.OnKeyDown=function(e){if(e.keyCode==s.JsGridConstants.Key.enter||e.keyCode==s.JsGridConstants.Key.esc){this._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;this._gridContext.OnKeyDown(e)}};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.UpdateElementValue=function(e,t){o.JsGridUtil.DebugAssert(null!=e);e.value=t};e.prototype.SetupHandlers=function(e){null!=this._container&&(e?this._container.addEventListener("mousedown",this.OnMouseDown.bind(this)):this._container.removeEventListener("mousedown",this.OnMouseDown.bind(this)))};e.prototype.GetOriginalValue=function(){var e,t,n=this._cellContext.originalValue.data;if(null!=n){e=n.address;t=n.display}return{address:e,display:t}};return e})();e.HyperlinkEditControlV2=y})(t.EditControl||(t.EditControl={}));t.EditControlType={EditBox:"EDIT_EDITBOX",ComboBox:"EDIT_COMBOBOX",Checkbox:"EDIT_CHECKBOX",Hyperlink:"EDIT_HYPERLINK",PeoplePicker:"EDIT_PEOPLEPICKER",LocationPicker:"EDIT_LOCATIONPICKER"};(function(e){var t=(function(){function e(e,t){this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.Either;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.Both;this.id=s.JsGridConstants.ErrorWidgetId;this._gridContext=e;this._errorMgr=t;null!=e.parentNode&&(this.id+=e.parentNode.id);this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._gridContext.bLightFocus=!0;var e=o.JsGridUtil.Internal.IsFeatureEnabled(X)?s.JsGridConstants.Internal.zIndex.editor:1;o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(e+=s.JsGridConstants.Internal.zIndex.stickyZIndex);this.mainDiv=document.createElement("div");this.mainDiv.id=this.id+"_mainDiv";this.mainDiv.style.cssText="z-index:"+e+"; visibility: hidden; font-size: 10; position: absolute; top: 0px; left: 0px; background-color: #FFE0E0; border: 1px solid #DD3300; padding: 5px 10px; color: #333333!important";this._parentNode.appendChild(this.mainDiv);this.focusElement=document.createElement("input");this.focusElement.id=this.id+"_focuselem";this.focusElement.style.cssText="position:fixed;top:0px;left:-10px;height:0px;width:0px;display:none";this.focusElement.setAttribute("role","presentation");this.mainDiv.appendChild(this.focusElement);this.errorSpan=document.createElement("span");this.errorSpan.id=this.id+"_errorSpan";this.mainDiv.appendChild(this.errorSpan)};e.prototype.Dispose=function(){this._parentNode.removeChild(this.mainDiv)};e.prototype.BindToCell=function(e){this._cellContext=e;this.mainDiv.addEventListener("keydown",this._gridContext.OnKeyDown)};e.prototype.Unbind=function(){o.JsGridUtil.ClearEventListeners(this.mainDiv)};e.prototype.GetIcon=function(){return new o.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Error",className:O.spGridErrorIcon}}).Render(SP.JsGrid.Res.openErrorWidget)};e.prototype.Collapse=function(){this.mainDiv.style.visibility="hidden";this._cellContext.NotifyCollapseWidget()};e.prototype.Expand=function(){o.JsGridUtil.Internal.DomElement.GetInstance().SetText(this.errorSpan,this._errorMgr.GetMessageForCell(this._cellContext.record.key(),this._cellContext.fieldKey));this._widgetHeight=this.mainDiv.offsetHeight;var e=this._cellContext.cellRect;this.mainDiv.style.top=(this._cellContext.cellExpandSpace.bottom>this._widgetHeight||this._cellContext.cellExpandSpace.top<this._widgetHeight?e.y+e.height+3:e.y-this._widgetHeight-3)+"px";this.mainDiv.style.left=e.x-(this._gridContext.RTL.bEnabled?this.mainDiv.offsetWidth-e.width:2)+"px";this._cellContext.NotifyExpandWidget();this.mainDiv.style.visibility="";this.focusElement.focus()};e.prototype.OnValueChanged=function(e){};return e})();e.ErrorWidget=t;var n=(function(){function e(e){this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this._widgetHeight=200;this.strDatePickerImageID="DatePickerImage";this.strDatePickerFrameID="DatePickerFrame";this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.ClickDatePickerFn=function(e,t,n,r){clickDatePicker(e,t,n);r()};e.prototype.Init=function(){var e=o.JsGridUtil.Internal.IsFeatureEnabled(X);this._box=document.createElement("input");this._box.id="datewidgetinput-"+this._parentNode.id;this._box.style.cssText="display:none;position:absolute;top:0px;left:0px";this._box.onvaluesetfrompicker=this.OnValueSetHandler.bind(this);this._box.tabIndex=-1;this._parentNode.appendChild(this._box);this._anchor=document.createElement("div");this._anchor.id=this._box.id+this.strDatePickerImageID;this._anchor.style.cssText="position:absolute;background:transparent;visibility:hidden;height:0px;z-index:-1";this._parentNode.appendChild(this._anchor);this._iframe=document.createElement("iframe");this._iframe.id=this._box.id+this.strDatePickerFrameID;this._iframe.src=o.JsGridUtil.Internal.SiteUrl+s.JsGridConstants.ImagesDirectory+"blank.gif";this._iframe.frameBorder="0";this._iframe.scrolling="no";this._iframe.title=SP.JsGrid.Res.calendarTitle;var t=s.JsGridConstants.Internal.zIndex.editor;o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(t+=s.JsGridConstants.Internal.zIndex.stickyZIndex);this._iframe.style.cssText="display: none; position: absolute; width: 220px; z-index: "+(e?t:1)+" ";this._iframe.tabIndex=-1;this._parentNode.appendChild(this._iframe);null==window.g_strDateTimeControlIDs&&(window.g_strDateTimeControlIDs=[]);window.g_strDateTimeControlIDs.JsGridDatePicker=this._box.id};e.prototype.Dispose=function(){this._box.onvaluesetfrompicker=null;this._parentNode.removeChild(this._box);this._parentNode.removeChild(this._anchor);this._parentNode.removeChild(this._iframe)};e.prototype.BindToCell=function(e){this._cellContext=e;this._curValue=this._cellContext.originalValue.localized==o.JsGridUtil.EmptyValue?"":this._cellContext.originalValue.localized};e.prototype.Unbind=function(){this._curValue=null};e.prototype.Expand=function(){var e=this,t=this._cellContext.cellRect;o.JsGridUtil.DebugAssert(null!=t);if(null!=t){this._anchor.style.width=t.width+"px";this._anchor.style.top=(this._cellContext.cellExpandSpace.bottom>this._widgetHeight||this._cellContext.cellExpandSpace.top<this._widgetHeight?t.y+t.height+3:t.y-this._widgetHeight-3)+"px";this._anchor.style.left=t.x-(this._gridContext.RTL.bEnabled?this._anchor.offsetWidth-t.width:2)+"px";this._anchor.style.visibility="";this._box.value=null!=this._curValue?this._curValue:"";o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._anchor.classList.add(O.stickyEditor):this._anchor.classList.remove(O.stickyEditor));this._cellContext.NotifyExpandWidget();this.ClickDatePickerFn(this._box.id,this.GetDatePickerQueryString(),this._box.value,function(){var n=e._iframe.resultfunc;e._iframe.resultfunc=function(t){null==t&&e._cellContext.NotifyEditComplete(!0);e.Collapse();n(t)};F||(e._iframe.onloadcallback=function(){o.JsGridUtil.Internal.positionWidget(e._iframe,t,e._gridContext.RTL.bEnabled)})})}};e.prototype.GetIcon=function(){return new o.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Calendar"}}).Render(SP.JsGrid.Res.openCalendar)};e.prototype.Collapse=function(){var e=this;o.JsGridUtil.Internal.GetVisible(this._iframe)?this.ClickDatePickerFn(this._box.id,this.GetDatePickerQueryString(),this._box.value,function(){e._cellContext.NotifyCollapseWidget()}):this._cellContext.NotifyCollapseWidget()};e.prototype.OnValueChanged=function(e){this._curValue=e.localized};e.prototype.OnValueSetHandler=function(){this._cellContext.SetCurrentValue({localized:this._box.value});this._cellContext.NotifyEditComplete()};e.prototype.GetDatePickerQueryString=function(){return[o.JsGridUtil.Internal.SiteUrl+"/_layouts/iframe.aspx?","&cal=",o.JsGridUtil.SpRegionalSettings.calendarType,"&lcid=",o.JsGridUtil.SpRegionalSettings.localeId,"&langid=",_spPageContextInfo.currentLanguage,"&tz=",o.JsGridUtil.SpRegionalSettings.timeZone,"&time24=",o.JsGridUtil.SpRegionalSettings.time24?"true":"false","&ww=",o.JsGridUtil.SpRegionalSettings.workDays,"&fdow=",o.JsGridUtil.SpRegionalSettings.firstDayOfWeek,"&fwoy=",o.JsGridUtil.SpRegionalSettings.firstWeekOfYear,"&hj=",o.JsGridUtil.SpRegionalSettings.adjustHijriDays,"&swn=",o.JsGridUtil.SpRegionalSettings.showWeeks?"true":"false","&minjday=109207","&maxjday=2666269","&dateonly=",this._cellContext.field.dateOnly?"true":"false","&date="].join("")};return e})();e.DateWidget=n;var r=(function(){function e(e){this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.Either;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.Both;this.id="HyperlinkWidgetControl";this._gridContext=e;null!=e.parentNode&&(this.id+=e.parentNode.id);this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){var e=o.JsGridUtil.Internal.IsFeatureEnabled(X);this._mainDiv=document.createElement("div");this._mainDiv.id="mainDiv";this._mainDiv.className=D?"jsgrid-widget-hyperlink":"jsgrid-widget-hyperlink-quickedit";var t=s.JsGridConstants.Internal.zIndex.editor;o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(t+=s.JsGridConstants.Internal.zIndex.stickyZIndex);this._mainDiv.style.cssText="z-index: "+(e?t:1)+"; visibility: hidden; position: absolute; top: 0px; left: 0px; width: 290px; direction: "+this._gridContext.RTL.ltr+";";this._parentNode.appendChild(this._mainDiv);this._addressInputId=a.format("{0}_{1}",this.id,"addressInput");this._verifyButtonId=a.format("{0}_{1}",this.id,"verifyButton");this._displayInputId=a.format("{0}_{1}",this.id,"displayInput");this._okButtonId=a.format("{0}_{1}",this.id,"okButton");this._cancelButtonId=a.format("{0}_{1}",this.id,"cancelButton");var n,r=a.format('<DIV style="margin:3px 10px 0px 10px; text-align:{0};"><img src="{1}" alt="{2}" title="{2}" id="{3}" tabIndex="-1" style="cursor:pointer;"/></DIV>',this._gridContext.RTL.Right,o.JsGridUtil.Internal.SiteUrl+s.JsGridConstants.ImagesDirectory+"closexon.png",SP.JsGrid.Res.close,this._cancelButtonId),i=a.format('<a href="javascript:;" id="{0}" title="{1}" style="float:{2};">{1}</a>',this._verifyButtonId,SP.JsGrid.Res.testHyperlink,this._gridContext.RTL.Right),u='<DIV style="margin:3px 10px 9px 10px;"><LABEL for={0}>{1}</LABEL>{3}<DIV style="margin-top:3px;"><INPUT id={0} style="width:268px; padding:0px;" maxLength="1024" type="text"></DIV><DIV style="margin-top:3px;">{2}</DIV></DIV>',f=a.format(u,this._addressInputId,SP.JsGrid.Res.hyperlinkAddress,SP.JsGrid.Res.hyperlinkAddressExample,i),l=a.format(u,this._displayInputId,SP.JsGrid.Res.hyperlinkDisplay,SP.JsGrid.Res.hyperlinkDisplayExample,"");n=D?a.format('<DIV style="padding:3px 10px 3px 10px; text-align:{0}" class="jsgrid-widget-hyperlink-buttonarea"><a href="javascript:;" title="{1}" id="{2}" class="jsgrid-widget-hyperlink-okbutton">{1}</a></DIV>',this._gridContext.RTL.Right,SP.JsGrid.Res.ok,this._okButtonId):a.format('<DIV style="padding:3px 10px 3px 10px; text-align:{0}" class="jsgrid-widget-hyperlink-buttonarea-quickedit"><a href="javascript:;" title="{1}" id="{2}">{1}</a></DIV>',this._gridContext.RTL.Right,SP.JsGrid.Res.ok,this._okButtonId);this._mainDiv.innerHTML=[r,f,l,n].join("");this._widgetHeight=this._mainDiv.offsetHeight;this._addressInput=document.getElementById(this._addressInputId);this._verifyButton=document.getElementById(this._verifyButtonId);this._displayInput=document.getElementById(this._displayInputId);this._okButton=document.getElementById(this._okButtonId);this._cancelButton=document.getElementById(this._cancelButtonId);this._displayInput.addEventListener("keyup",this.OnDisplayValueUpdated.bind(this));this._okButton.addEventListener("click",this.OnOK.bind(this));this._cancelButton.addEventListener("click",this.OnCancel.bind(this));this._verifyButton.addEventListener("click",this.OnVerify.bind(this));this._mainDiv.addEventListener("keydown",this.OnKeyDown.bind(this));this._mainDiv.addEventListener("mousedown",this.OnMouseDown.bind(this))};e.prototype.Dispose=function(){o.JsGridUtil.ClearEventListeners(this._displayInput);o.JsGridUtil.ClearEventListeners(this._okButton);o.JsGridUtil.ClearEventListeners(this._cancelButton);o.JsGridUtil.ClearEventListeners(this._verifyButton);o.JsGridUtil.ClearEventListeners(this._mainDiv);this._parentNode.removeChild(this._mainDiv)};e.prototype.BindToCell=function(e){this._cellContext=e;this._currentDisplayValue=this._cellContext.originalValue.localized!==o.JsGridUtil.EmptyValue?this._cellContext.originalValue.localized:this._cellContext.propType.GetAddress(this._cellContext.originalValue.data);this._currentDisplayValue||(this._currentDisplayValue="");this._currentAddress=this._cellContext.originalValue.data!==o.JsGridUtil.EmptyValue?this._cellContext.propType.GetAddress(this._cellContext.originalValue.data):this._cellContext.originalValue.localized};e.prototype.Unbind=function(){};e.prototype.GetIcon=function(){return new o.JsGridUtil.ImageWithFabricIcons({imgSrc:o.JsGridUtil.Internal.SiteUrl+s.JsGridConstants.ImagesDirectory+"link.gif"}).Render(SP.JsGrid.Res.editHyperlink)};e.prototype.Collapse=function(){this._mainDiv.style.visibility="hidden";this._cellContext.NotifyCollapseWidget()};e.prototype.Expand=function(){var e=this._cellContext.cellRect;this._mainDiv.style.top=(this._cellContext.cellExpandSpace.bottom>this._widgetHeight||this._cellContext.cellExpandSpace.top<this._widgetHeight?e.y+e.height+3:e.y-this._widgetHeight-3)+"px";H?this._mainDiv.style.left=(this._gridContext.RTL.bEnabled?e.x:e.x+e.width-this._mainDiv.offsetWidth)+"px":o.JsGridUtil.Internal.positionWidget(this._mainDiv,e,this._gridContext.RTL.bEnabled);this._currentDisplayValue=this._cellContext.originalValue.localized!==o.JsGridUtil.EmptyValue?this._cellContext.originalValue.localized:this._cellContext.propType.GetAddress(this._cellContext.originalValue.data);this._currentDisplayValue||(this._currentDisplayValue="");this._currentAddress=this._cellContext.originalValue.data!==o.JsGridUtil.EmptyValue?this._cellContext.propType.GetAddress(this._cellContext.originalValue.data):this._cellContext.originalValue.localized;this._displayInput.value=this._currentDisplayValue;this._addressInput.value=this._currentAddress;this._cellContext.NotifyExpandWidget();this._mainDiv.style.visibility="";o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._mainDiv.classList.add(O.stickyEditor):this._mainDiv.classList.remove(O.stickyEditor));this._addressInput.focus();this._addressInput.value=this._addressInput.value};e.prototype.OnValueChanged=function(e){this._currentDisplayValue=null==e.localized||e.localized==o.JsGridUtil.EmptyValue?"":e.localized;this._currentAddress=null==e.data||e.data==o.JsGridUtil.EmptyValue?this._currentDisplayValue:this._cellContext.propType.GetAddress(e.data)};e.prototype.OnDisplayValueUpdated=function(){this.SetCurrentValue()};e.prototype.OnOK=function(e){this.SetCurrentValue();this._cellContext.NotifyEditComplete();this.Collapse();null!=e&&null!=e.preventDefault&&e.preventDefault();return!1};e.prototype.OnCancel=function(){this._cellContext.NotifyEditComplete(!0)};e.prototype.OnVerify=function(){window.open(this._addressInput.value)};e.prototype.SetCurrentValue=function(){this._cellContext.SetCurrentValue({localized:this._displayInput.value,data:{address:this._addressInput.value,display:this._displayInput.value}})};e.prototype.OnKeyDown=function(e){var t=this,n=!e.ctrlKey&&!e.altKey&&!e.shiftKey;!(function(){switch(e.keyCode){case s.JsGridConstants.Key.esc:t.OnCancel();return!0;case s.JsGridConstants.Key.enter:e.target==t._cancelButton?t.OnCancel():e.target==t._verifyButton?t.OnVerify():t.OnOK();return!0;case s.JsGridConstants.Key.tab:if(n){if(e.target==t._okButton){t._cancelButton.focus();return!0}}else if(e.shiftKey){if(e.target==t._cancelButton){t._okButton.focus();return!0}if(e.target==t._verifyButton){t._cancelButton.focus();return!0}}}return!1})()?e.stopPropagation():o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)};e.prototype.OnMouseDown=function(e){e.stopPropagation()};return e})();e.HyperlinkWidget=r})(t.WidgetControl||(t.WidgetControl={}));t.WidgetControlType={Demo:"WIDGET_DEMO",Date:"WIDGET_DATE",Hyperlink:"WIDGET_HYPERLINK"}});
define("aQl",["require","exports","mU","f","Jl","Jh","Jc","dJ","aQo","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";f=f.PeopleEditor_7;Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._isActive=!0;n._onSelectedPersonasChange=function(e){if(n._isActive){var t=n.props,r=t.peoplePickerQueryParams,i=t.onSelectedPersonasChange,s=n.state.currentSelectedPeople;s=r.allowMultipleEntities||e.length<=1?e:[e[e.length-1]];n.setState({currentSelectedPeople:s});i&&i(s)}};n._onSuggestionSelected=function(e){if(n._isActive){var t=n.props.peoplePickerQueryParams;if(e&&(!1===e.isExternal||e.isExternal&&e.providerName))return e;if(e&&e.principalType===i.PrincipalType.distributionList){t.isGraphDistributionList=!0;t.useGraph=!0;t.useSubstrate=!0}return n._peoplePickerProvider.resolve(e.userId,t).then(function(e){e&&!e.email&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails);e&&!e.name&&e.rawData.EntityData&&(e.name=e.rawData.EntityData.OtherMails);return e})}};n._containerRef=r.createRef();n._peoplePickerProvider=new s.PeoplePickerProvider({pageContext:t.context,peoplePickerDataSource:t.dataSource});n.state={currentSelectedPeople:t.selectedItems};return n}t.prototype.componentDidMount=function(){this._peoplePicker&&this._peoplePicker.focusInput();if(a.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this.props.setSelectionFrame(this._containerRef.current);else{var e=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(e)}};t.prototype.componentDidUpdate=function(){if(a.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this.props.setSelectionFrame(this._containerRef.current);else{var e=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(e)}};t.prototype.componentWillUnmount=function(){this._isActive=!1};t.prototype.render=function(){var e=this,t=this.props,i=t.peoplePickerQueryParams,s=t.onEditorKeyDown,a=t.onEditorMouseDown,l=this.state.currentSelectedPeople,c=u.default.isFeatureEnabled({ODB:1725})?" "+f.increaseZIndex:"";return r.createElement("span",{onKeyDown:s,onMouseDown:a,ref:this._containerRef},r.createElement(o.PeoplePicker,n.__assign({},this.props,{className:f.peopleEditor+c,onSelectedPersonasChange:this._onSelectedPersonasChange,selectedItems:l,onSuggestionSelected:this._onSuggestionSelected,"aria-required":i&&i.required,componentRef:function(t){return e._peoplePicker=t}})))};return t})(r.PureComponent);t.PeopleEditor=l});
define("aQj",["require","exports","f","IB","Iq","k9","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o){"use strict";o=o.PersonDisplay_7;Object.defineProperty(t,"__esModule",{value:!0});t.PersonDisplay=function(e){var t=e.users,r=function(e){var t=e.theme;return{removeButton:{display:"none"},root:{selectors:{"&.personDisplay":{background:t.palette.neutralLight,selectors:{":hover":{background:t.palette.neutralLight}}}}},subComponentStyles:{persona:{details:{paddingLeft:4}}}}};return n.createElement(n.Fragment,null,t.map(function(e,t){return n.createElement(i.PeoplePickerItem,{className:"personDisplay",index:t,dir:"auto",item:e,styles:r})}))};t.GetPersonDisplay=function(e){var t=r.getPersonaInitialsColor(e),n=s.getInitials(e.text,!1),i="<span class="+o.personDisplayCoin+" style='background:"+t+"'>"+n+"</span>",u="<span class="+o.personDisplayName+">"+e.text+"</span>";return"<div class="+o.personDisplayPill+">"+i+u+"</div>"}});
define("aQi",["require","exports","mU","f","aPS","ajg","jm","bt","dJ","aQo"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=u.Killswitch.isActivated("DC101D81-F3CE-4E97-8A0D-BA3985B448FC","12/03/2019","Fix an issue with multiple-choice lookup fields."),c=o.getTheme(),h=(function(e){n.__extends(t,e);function t(t){var s=e.call(this,t)||this;s._isActive=!0;s.OnPendingValueUpdated=function(e,t,n){n&&s.setState({pendingValue:{data:n,localized:n}})};s.OnValueChanged=function(e,t,r,i){if(s._isActive){var o={data:[],localized:""};if(s.props.multiSelect){var u=[];if(s.props.allowFreeform&&i){o={data:n.__spreadArrays(s.state.value.data,[i]),localized:s.state.value.localized+";"+i};u.push({key:i,text:i})}else{if(t.selected){if(null!==t.key)if(s.state.value.data||l){for(var a=0;a<s.state.value.data.length;a++)o.data.push(s.state.value.data[a]);o.data.push(t.key)}else o.data.push(t.key)}else for(a=0;a<s.state.value.data.length;a++)s.state.value.data[a]!==t.key&&o.data.push(s.state.value.data[a]);for(a=0;a<o.data.length;a++)if(l)o.localized+=o.data[a]+";";else for(var f=0;f<s.state.options.length;f++)s.state.options[f].key==o.data[a]&&(o.localized+=s.state.options[f].text+";");o.localized=o.localized.substr(0,o.localized.length-1)}s.props.gridOnChange(o);s.setState({value:o,pendingValue:o,options:n.__spreadArrays(s.state.options,u)})}else{s.props.allowFreeform?i?o={data:i,localized:i}:t&&(o={data:t.key,localized:t.text}):o={data:t.key,localized:t.text};if(o){s.props.gridOnChange(o);s.setState({value:o,pendingValue:o})}}}};s.OnRegisteredKeyEvent=function(e){e.keyCode==i.JsGridConstants.Key.space&&s.Expand()};s.Expand=function(){s._comboxBoxRef.current&&s._comboxBoxRef.current.focus(!0,!0)};s._fixedEditorPadding=56;s._editorLetterSize=6.5;s.state={options:s.props.gridOptions,value:s.props.gridValue,pendingValue:s.props.gridValue};s._containerRef=r.createRef();s._comboxBoxRef=r.createRef();s.props.registerForKeyEvents&&s.props.registerForKeyEvents(s);return s}t.prototype.componentWillUnmount=function(){this.state.pendingValue!==this.state.value&&this.props.gridOnChange(this.state.pendingValue);this._isActive=!1};t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({value:e.gridValue,pendingValue:e.gridValue})};t.prototype.componentDidMount=function(){this._fixEditorWidth()};t.prototype.componentDidUpdate=function(){this._fixEditorWidth()};t.prototype.render=function(){var e=this.state.value.data,t={root:{borderWidth:0,marginBottom:0},divider:{borderWidth:0,borderBottomWidth:1,borderColor:c.palette.neutralTertiary}};a.default.isFeatureEnabled({ODB:1725})&&(t.root.zIndex=i.JsGridConstants.Internal.zIndex.editor);return r.createElement("div",{ref:this._containerRef},r.createElement(s.ComboBox,n.__assign({},this.props,{options:this.state.options,styles:t,componentRef:this._comboxBoxRef,text:this.state.value.localized,onChange:this.OnValueChanged,onPendingValueChanged:this.OnPendingValueUpdated,selectedKey:e})))};t.prototype._fixEditorWidth=function(){if(this._isActive){if(this.state&&this.state.value&&this.state.value.localized&&this._containerRef&&this._containerRef.current){var e=this._containerRef.current.clientWidth,t=this._fixedEditorPadding+this._editorLetterSize*this.state.value.localized.length,n=0;this.state.pendingValue&&this.state.pendingValue.localized&&(n=this._fixedEditorPadding+this._editorLetterSize*this.state.pendingValue.localized.length);this._containerRef.current.style.width=Math.max(e,Math.max(n,t)).toString()+"px"}if(f.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this._containerRef&&this._containerRef.current&&this._containerRef.current.children&&this._containerRef.current.children.length>0&&this._containerRef.current.children[0]&&this._containerRef.current.children[0].children&&this._containerRef.current.children[0].children.length>0&&this.props.setSelectionFrame(this._containerRef.current.children[0].children[0]);else if(this.props.positionGridSelectionFrame){var r=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(r)}}};return t})(r.PureComponent);t.ChoiceEditor=h});
define("aQd",["require","exports","mU","f","aPS","bt","aQh","aQe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s.Killswitch.isActivated("DC101D81-F3CE-4E97-8A0D-BA3985B448FC","12/03/2019","Fix an issue with multiple-choice lookup fields."),f=(function(e){n.__extends(t,e);function t(t){var s=e.call(this,t)||this;s._onInputChanged=function(e){var t;t=s.props.multiSelect&&s.state.value.localized&&s.state.value.localized.length>0?{data:s.state.value.localized+";"+e,localized:s.state.value.localized+";"+e}:{data:e,localized:e};s.setState({inputPrefix:e,pendingValue:t});var n=[],r=s.state.notYetSelectedOptions;if(e){r.forEach(function(t){0===t.text.toLowerCase().lastIndexOf(e.toLowerCase(),0)&&n.push(t)});s.setState({notYetSelectedOptionsBasedOnInput:n})}};s._saveOptions=function(e,t){var r=s.state,i=r.selectedOptions,o=r.notYetSelectedOptions,u=n.__spreadArrays(i),a=n.__spreadArrays(o);if(t){var f=s.state.options;0==f.filter(function(t){return t.key==e.key}).length&&f.push({key:e.key,text:e.text});s.setState({options:f});if(s.props.multiSelect){u.push(e);a=a.filter(function(t){return t.key!==e.key})}else{u=[e];a=s.state.options.filter(function(t){return t.key!==e.key})}}else if(s.props.multiSelect){a.push(e);u=u.filter(function(t){return t.key!==e.key})}else{a.push(e);u=[]}s.setState({selectedOptions:u,notYetSelectedOptions:a})};s.OnValueChanged=function(e,t){var r={},i=String(t.key);if(s.props.multiSelect){var o=s.state.value.data,u=s.state.value.localized,f=u&&u.split(";");r.data=[];r.localized="";if(f)for(var l=0;l<o.length;l++)""===o[l]&&Array.isArray(o)&&(o[l]=f[l].trim());if(t.selected){if(null!==t.key)if(o||a){for(l=0;l<o.length;l++)r.data.push(o[l]);r.data.push(i)}else r.data.push(i)}else for(l=0;l<o.length;l++)o[l]!==t.key&&r.data.push(o[l]);for(l=0;l<r.data.length;l++)if(a)r.localized+=r.data[l]+";";else{for(var c=!1,h=0;h<s.state.options.length;h++)if(s.state.options[h].key==r.data[l]){r.localized+=s.state.options[h].text+";";c=!0;break}c||(r.localized+=r.data[l]+";")}r.localized=r.localized.substr(0,r.localized.length-1);s.props.gridOnChange(r);s.setState({value:r,pendingValue:r,options:n.__spreadArrays(s.state.options,[])})}else{s.props.allowFreeform?t&&(r=t.selected?{data:String(t.key),localized:t.text}:{data:[],localized:""}):r=t.selected?{data:String(t.key),localized:t.text}:{data:[],localized:""};if(r){s.props.gridOnChange(r);s.setState({value:r,pendingValue:r})}}};s.OnRegisteredKeyEvent=function(e){e.keyCode==i.JsGridConstants.Key.space&&s.Expand()};s.Expand=function(){s._comboxBoxRef.current&&s._comboxBoxRef.current.focus(!0,!0)};s.currentlySelectedOptions=[];s.currentNotYetSelectedOptions=s.props.gridOptions;s._initializeWellAndFlyoutOptions();s.state={options:s.props.gridOptions,value:s.props.gridValue,pendingValue:s.props.gridValue,selectedOptions:s.currentlySelectedOptions,notYetSelectedOptions:s.currentNotYetSelectedOptions,notYetSelectedOptionsBasedOnInput:s.currentNotYetSelectedOptions,inputPrefix:""};s._containerRef=r.createRef();s._comboxBoxRef=r.createRef();s.props.registerForKeyEvents&&s.props.registerForKeyEvents(s);return s}t.prototype.componentWillUnmount=function(){this.state.pendingValue!==this.state.value&&this.props.gridOnChange(this.state.pendingValue)};t.prototype.componentDidMount=function(){this._fixEditorWidth()};t.prototype.componentDidUpdate=function(){this._fixEditorWidth()};t.prototype.render=function(){var e=this.props,t=e.rowSchema,n=e.rowData,i=e.currentFieldName,s=e.cellHeight,a=e.cellWidth,f=e.fieldType,l=e.allowFreeform,c=this.state,h=c.selectedOptions,p=c.inputPrefix,d=c.notYetSelectedOptionsBasedOnInput,v=c.notYetSelectedOptions;return r.createElement("div",{ref:this._containerRef,style:{height:"100%",width:"100%"}},r.createElement(u.Well,{targetElement:this._containerRef,saveSelectedOptions:this._saveOptions,itemsToDisplay:h,onValueChanged:this.OnValueChanged,onInputChanged:this._onInputChanged,rowSchema:t,rowData:n,currentFieldName:i,cellHeight:s,cellWidth:a,fieldType:f,allowFillInText:l}),r.createElement(o.Flyout,{targetElement:this._containerRef,saveSelectedOptions:this._saveOptions,options:p.length>0?d:v,onValueChanged:this.OnValueChanged,rowSchema:t,rowData:n,currentFieldName:i,fieldType:f,cellWidth:a}))};t.prototype._initializeWellAndFlyoutOptions=function(){var e=this;if(this.props.gridValue&&this.props.gridValue.localized){var t=this.props.gridValue.localized.split(";");(t=t.map(function(e){return e.trim()})).map(function(t,n){return e.currentlySelectedOptions.push(void 0===e.props.gridOptions.filter(function(e){return e.key===t})[0]?{key:t,text:t}:e.props.gridOptions.filter(function(e){return e.key===t})[0])});this.currentNotYetSelectedOptions=this.props.gridOptions.filter(function(e){return-1===t.indexOf(e.key)})}};t.prototype._fixEditorWidth=function(){if(this.state&&this.state.value&&this.state.value.localized&&this._containerRef&&this._containerRef.current){var e=this._containerRef.current.clientWidth;this._containerRef.current.style.width=e.toString()+"px"}if(this.props.positionGridSelectionFrame){var t=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(t)}};return t})(r.PureComponent);t.ModernChoiceEditor=f});
define("aQh",["require","exports","mU","f","oP","aQg","OneDriveLightspeedItemsScopeDeferred_mini_css","aPS"],function(e,t,n,r,i,s,o,u){"use strict";o=o.ChoicePill_6;Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.handleClick=function(e,n){n.selected=!0;t.props.saveSelectedOptions(n,!0);t.props.onValueChanged(e,n)};return t}t.prototype.render=function(){var e=this,t=this.props,n=t.rowData,a=t.rowSchema,f=t.currentFieldName,l=t.fieldType,c=t.options,h=t.targetElement;return r.createElement(r.Fragment,null,r.createElement(i.Callout,{styles:{root:{minWidth:this.props.cellWidth+u.JsGridConstants.Internal.wellAndFlyoutOffset}},gapSpace:4,target:h,isBeakVisible:!1,directionalHint:i.DirectionalHint.bottomLeftEdge},c.map(function(t,i){return r.createElement(s.ChoicePill,{option:t,onClick:e.handleClick,valueToDisplay:t.key,rowData:n,rowSchema:a,currentFieldName:f,customClassName:o.pill,fieldType:l})})))};return t})(r.Component);t.Flyout=a});
define("aQg",["require","exports","mU","f","aAa","H5"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.onClickChoice=function(e){t.props.onClick(e,t.props.option)};return t}t.prototype.render=function(){var e=this.props,t=e.currentFieldName,n=e.fieldType,s=e.valueToDisplay,o=e.rowSchema,u=e.rowData,a=e.customClassName,f="MultiChoice"===n?[s]:s,l=this.changeFieldTypeForMultiChoice(o);return r.createElement("div",{className:a,onClick:this.onClickChoice},r.createElement(i.CustomFieldRenderer,{rowSchema:l,rowData:u,currentFieldName:t,currentValueOverride:f}))};t.prototype.changeFieldTypeForMultiChoice=function(e){var t=JSON.parse(JSON.stringify(e));if(t&&t.length>0)for(var n=0;n<t.length;n++)"MultiChoice"!==t[n].fieldType&&"Choice"!==t[n].fieldType||(t[n].fieldType=s.ColumnFieldType.Choice);return t};return t})(r.Component);t.ChoicePill=o});
define("aQe",["require","exports","mU","f","oP","CO","aQg","OneDriveLightspeedItemsScopeDeferred_mini_css","aPS","k9"],function(e,t,n,r,i,s,o,u,a,f){"use strict";u=u.ChoicePill_6;Object.defineProperty(t,"__esModule",{value:!0});var l={fieldGroup:{minHeight:a.JsGridConstants.Internal.fixedRowHeight-2-2,border:"none"},root:{width:"calc(100% - 32px)"}},c=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._textfield=r.createRef();t.handleClick=function(e,n){n.selected=!1;t.props.saveSelectedOptions(n,!1);t.props.onValueChanged(e,n)};t.handleInputChange=function(e){t.props.onInputChanged(t._textfield.current.value)};t.handleTextFieldKeyDownEvent=function(e){if(13==e.which){var n={key:t._textfield.current.value,text:t._textfield.current.value,selected:!0};t.props.saveSelectedOptions(n,!0);t.props.onValueChanged(e,n)}};t.getCalloutStyles=f.memoizeFunction(function(e){var n=e.theme.palette;return{root:{minWidth:t.props.cellWidth,border:"2px solid "+n.themePrimary,minHeight:t.props.cellHeight}}});return t}t.prototype.render=function(){var e=this,t=this.props,n=t.targetElement,a=t.rowData,f=t.rowSchema,c=t.currentFieldName,h=t.fieldType,p=t.allowFillInText,d=t.itemsToDisplay;return r.createElement(r.Fragment,null,r.createElement(i.Callout,{styles:this.getCalloutStyles,target:n,directionalHint:i.DirectionalHint.leftBottomEdge,coverTarget:!0,isBeakVisible:!1,calloutMaxHeight:200},this.props.itemsToDisplay.map(function(t,n){return r.createElement(o.ChoicePill,{option:t,onClick:e.handleClick,valueToDisplay:t.key,rowData:a,rowSchema:f,currentFieldName:c,customClassName:u.pillNoHoverStyle,fieldType:h})}),p&&("MultiChoice"===h||"Choice"===h&&d&&0===d.length)&&r.createElement(s.TextField,{onChange:this.handleInputChange,onKeyDown:this.handleTextFieldKeyDownEvent,componentRef:this._textfield,placeholder:"Type to filter or add new choice",borderless:!0,styles:l})))};return t})(r.Component);t.Well=c});
define("aP7",["require","exports","mU","f","aQb","aP8"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._isActive=!0;n.OnDisplayValueChanged=function(e,t){var r=n.props.onValueChange;if(n._isActive&&r){r({address:n.state.address,display:t});n.setState({display:t})}};n.OnUrlValueChanged=function(e,t){var r=n.props.onValueChange;if(n._isActive&&r){r({address:t,display:n.state.display});n.setState({address:t})}};n.state={address:t.currentUrlValue,display:t.currentDisplayValue};return n}t.prototype.componentWillUnmount=function(){this._isActive=!1};t.prototype.render=function(){var e=this.props,t=e.onEditorKeyDown,o=e.onEditorMouseDown,u=e.calloutProps,a=this.state,f=a.address,l=a.display;return r.createElement(s.CommonEditorCallout,n.__assign({},u),r.createElement(i.HyperlinkControl,n.__assign({},this.props,{linkText:f,displayText:l,onLinkTextChange:this.OnUrlValueChanged,onDisplayTextChange:this.OnDisplayValueChanged,onKeyDown:t,onMouseDown:o,style:{width:"288px"}})))};return t})(r.PureComponent);t.HyperlinkEditor=o});
define("aQb",["require","exports","mU","f","CO","k9","aQc"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={root:{paddingBottom:8},subComponentStyles:{label:{root:{paddingTop:0}}}};t.HyperlinkControl=r.memo(function(e){var t=s.getNativeProps(e,s.divProperties);return r.createElement("div",n.__assign({},t),r.createElement(i.TextField,{label:o.default.Link,styles:u,value:e.linkText,onChange:e.onLinkTextChange,placeholder:o.default.LinkPlaceholder}),r.createElement(i.TextField,{label:o.default.Display,value:e.displayText,onChange:e.onDisplayTextChange,placeholder:o.default.DisplayPlaceholder}))})});
define("aP8",["require","exports","f","oP","n4","aPS","OneDriveLightspeedItemsScopeDeferred_mini_css","aP9"],function(e,t,n,r,i,s,o,u){"use strict";o=o.CommonEditorCallout_4;Object.defineProperty(t,"__esModule",{value:!0});var a={calloutMain:{padding:12},container:{zIndex:s.JsGridConstants.Internal.zIndex.expandableEditorsZIndex}},f={root:{height:24,width:24,padding:0,marginRight:4}},l={root:{height:24,width:24,padding:0,marginLeft:4}};t.CommonEditorCallout=n.memo(function(e){var t=e.target,s=e.onSave,c=e.onCancel,h=e.children,p=s&&c;return n.createElement(r.FocusTrapCallout,{target:t,isBeakVisible:!1,setInitialFocus:!0,preventDismissOnScroll:!0,doNotLayer:!0,gapSpace:4,styles:a,directionalHint:r.DirectionalHint.bottomLeftEdge},h,p&&n.createElement("div",{className:o.calloutButtonsContainer},n.createElement(i.IconButton,{iconProps:{iconName:"Accept",style:{margin:0}},onClick:s,title:u.default.saveButtonLabel,styles:f}),n.createElement(i.IconButton,{iconProps:{iconName:"Cancel",style:{margin:0}},onClick:c,title:u.default.cancelButtonLabel,styles:l})))})});
define("aP6",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createSPPrincipalType=function(e){if(!e)return 0;for(var t=0,n=0,r=e.split(",");n<r.length;n++){var i=r[n];"User"===i?t|=1:"DL"===i?t|=2:"SecGroup"===i?t|=4:"SPGroup"===i&&(t|=8)}return t}});
define("aP4",["require","exports","mU","f","f","ay4","ayV","ayR","X","OneDriveLightspeedItemsScopeDeferred_mini_css","aQo"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";f=f.LocationEditor_1;Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._picker=i.createRef();r._containerRef=i.createRef();r._isActive=!0;r._resolveItem=function(e){return e&&e.LocationUri?r._dataSource.resolveLocationFromBingUri(e.LocationUri).then(function(t){if(t){var r=n.__assign(n.__assign({},e.Address),t.Address);if(e.Address){for(var i in r)!r[i]&&e.Address[i]&&(r[i]=e.Address[i]);t.Address=r}return t}return e}):Promise.resolve(e)};r._resolveSuggestions=function(e){return r._dataSource.search(e).then(function(t){return r._hasFillIn()?t.concat([{DisplayName:e,EntityType:"Custom"}]):t}).catch(function(e){e&&"Canceled"!==e.name&&r.setState({error:e});return[]})};r._onItemsChange=function(e){if(r._isActive){var t,n=r.props.onChange;r.setState({selectedLocation:e});if(r.state.selectedLocation){var i=r.state.selectedLocation;t="Custom"===i.EntityType?new a.Qos({name:"QuickEditSaveUnresolvedLocation"}):i.Address&&i.Address.Street&&i.Address.City&&i.Address.State&&i.Address.CountryOrRegion&&i.Address.PostalCode&&i.Coordinates?new a.Qos({name:"QuickEditSaveFullLocation"}):new a.Qos({name:"QuickEditSaveSparseLocation"})}else t=new a.Qos({name:"QuickEditSaveRemoveLocation"});try{n&&n(e);t.end({resultType:a.ResultTypeEnum.Success})}catch(e){t.end({resultType:a.ResultTypeEnum.Failure,error:e})}}};r._dataSource=r._getDataSource(t);r.state={selectedLocation:t.defaultLocation};return r}t.prototype._updateGridSelectionFrame=function(){if(l.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this.props.setSelectionFrame(this._containerRef.current);else{var e=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(e)}};t.prototype.componentDidMount=function(){this._picker.current&&this._picker.current.focus();this._updateGridSelectionFrame()};t.prototype.componentDidUpdate=function(){this._updateGridSelectionFrame()};t.prototype.componentWillUnmount=function(){this._isActive=!1};t.prototype.render=function(){var e=this,t=this.props,i=t.onEditorKeyDown,s=t.onEditorMouseDown,a=this.state.selectedLocation;return r.createElement("span",{onKeyDown:i,onMouseDown:s,ref:this._containerRef},r.createElement(o.LocationPicker,n.__assign({},this.props,{defaultLocation:a,onChange:this._onItemsChange,className:f.locationEditor,resolveLocations:this._resolveSuggestions,placeHolder:u.default.locationEditorPlaceHolder,onItemSelected:this._resolveItem,strings:{useCustomLocation:u.default.useLocationCustomValueTag},componentRef:this._picker,allowCustomLocations:this._hasFillIn(),onFocus:function(){return e._updateGridSelectionFrame()}})))};t.prototype.getData=function(){var e=this.state.selectedLocation;return e?JSON.stringify(e):""};t.prototype._shouldSaveDataOnEnter=function(){return!1};t.prototype._getAriaLabelDataString=function(){if(this.state.selectedLocation)return this.state.selectedLocation.DisplayName};t.prototype._hasFillIn=function(){return!0};t.prototype._getPlaceHolderString=function(){return u.default.locationEditorPlaceHolder};t.prototype._getDataSource=function(e){return e&&e.dataSource?e.dataSource:new s.LocationDataSource({pageContext:e.pageContext})};return t})(r.PureComponent);t.LocationEditor=c});
define("aP1",["require","exports","mU","f","aP3","f","n4","azj","Z8","Zx","aze","azb","aza","k9","dJ","a2","aQo","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";g=g.TaxonomyEditor_2;Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._taxonomyPicker=s.createRef();n._root=s.createRef();n._isActive=!0;n.showClassicTaggingTree=function(){n.setState({forceClassicTree:!0,taxonomyTreeOpen:!0})};n._resolveSuggestions=function(e){return n._dataManager.resolveSuggestions(e,n.state.queryParams).then(function(e){return h.TaxonomyEditorDataManager.filterTaggedTerms(e,n.state.selectedTerms)}).catch(function(e){return[]})};n._onItemsChange=function(e){if(n._isActive){n.setState({selectedTerms:e},function(){0===e.length&&n._focus();n._validateTerms(e)});n.props.onItemsChange&&n.props.onItemsChange(e);n._updateGridSelectionFrame()}};n._launchTree=function(e){if(!n.state.taxonomyTreeOpen){v.Engagement.logData({name:"QuickEditLaunchTaxonomyTree",isIntentional:!0});n.setState({taxonomyTreeOpen:!0})}};n._dismissTree=function(){n.state.taxonomyTreeOpen&&n.setState({taxonomyTreeOpen:!1},n._focus)};n.handleTreeDialogResults=function(e){if(e){var t=e.value;try{var r=t.split(f.TERM_DELIMITER).map(function(e){var t=e.split(f.LABEL_ID_DELIMITER),n=t[1]!==f.INVALID_TERM_ID;return{term:{label:t[0],termId:t[1],isValid:n},isSynonym:!1,completions:[],start:"",state:n?1:2}});if(0===r.filter(function(e){return!e.term.isValid}).length){n.setState({selectedTerms:r,taxonomyTreeOpen:!1},n._focus);n.props.onItemsChange&&n.props.onItemsChange(r);n._updateGridSelectionFrame()}}catch(e){}}else n.setState({taxonomyTreeOpen:!1},n._focus)};n._dataSource=t.dataSource||new c.TaxonomyDataSource(t.pageContext);n._dataProvider=new c.TaxonomyProvider({},{dataSource:n._dataSource});n._dataManager=new h.TaxonomyEditorDataManager({dataProvider:n._dataProvider,dataSource:n._dataSource});n._async=new p.Async;var r=t.schema,i={lcid:r.Lcid||1033,sspList:r.SspId,termSetList:r.TermSetId,anchorId:r.AnchorId||f.INVALID_TERM_ID,excludedTermset:f.INVALID_TERM_ID,isSpanTermStores:r.IsSpanTermStores||!1,isSpanTermSets:r.IsSpanTermSets||!1,isIncludeUnavailable:!1,isIncludeDeprecated:!1,isAddTerms:r.IsAddTerms||!1,isIncludePathData:!1,excludeKeyword:!r.Name&&"TaxKeyword"!==r.Name,isUseCommaAsDelimiter:"boolean"!=typeof r.IsUseCommaAsDelimiter||r.IsUseCommaAsDelimiter,isIncludeTermSetName:!1,webServiceUrl:r.WebServiceUrl,allowFillIn:"boolean"!=typeof r.AllowFillIn||r.AllowFillIn};n.state={queryParams:i,selectedTerms:t.selectedTerms,taxonomyTreeOpen:!1,serverTerms:t.selectedTerms};return n}t.prototype._updateGridSelectionFrame=function(){if(m.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this.props.setSelectionFrame(this._root.current);else{var e=this._root.current.getBoundingClientRect();this.props.positionGridSelectionFrame(e)}};t.prototype.componentDidMount=function(){this._taxonomyPicker.current&&this._taxonomyPicker.current.focus();this._updateGridSelectionFrame()};t.prototype.componentDidUpdate=function(){this._updateGridSelectionFrame()};t.prototype.componentWillUnmount=function(){this._isActive=!1};t.prototype.render=function(){var e=this.props,t=e.onEditorKeyDown,n=e.onEditorMouseDown,s=e.schema,f=s.AllowMultipleValues?void 0:1,c=this.state.queryParams&&!this.state.queryParams.isSpanTermSets,h=this._isQuickEditVisualRefreshFlightEnabled?" "+g.increaseZIndex:"";return r.createElement("span",{onKeyDown:t,onMouseDown:n,ref:this._root,className:g.taxonomyEditorSpan+h},r.createElement(a.TaxonomyPicker,{selectedTerms:this.state.selectedTerms,onItemsChange:this._onItemsChange,className:"taxonomyEditor-Picker",containerClassName:"taxonomyEditor-TaxonomyPicker",resolveSuggestions:this._resolveSuggestions,termLimit:f,ref:this._taxonomyPicker,"aria-required":this._isRequiredField()}),c&&r.createElement(o.ActionButton,{"aria-hidden":this._isNarrationForTagIconEnabled?void 0:"true","aria-label":this._isNarrationForTagIconEnabled?i.default.AriaLabelForTagIcon:void 0,iconProps:{iconName:"tag"},onClick:this._launchTree}),c&&this._isModernTaggingToBeDisplayed&&r.createElement(l.TaxonomyTaggingPanel,{onDismiss:this._dismissTree,title:s.Title,onItemsChange:this._onItemsChange,selectedTerms:this.state.selectedTerms,queryParams:this.state.queryParams,pageContext:this.props.pageContext,dataSource:this._dataSource,termLimit:f,isRequiredField:this._isRequiredField(),isPanelOpen:this.state.taxonomyTreeOpen,getOAuthToken:this.props.getOAuthToken,showClassicTaggingTree:this.showClassicTaggingTree}),c&&this.state.taxonomyTreeOpen&&!this._isModernTaggingToBeDisplayed&&r.createElement(u.TaxonomyTreePicker,{taxonomyTreeUrl:this.getTaxonomyTreeUrl(),resultHander:this.handleTreeDialogResults,onDismiss:this._dismissTree,title:s.Title}))};t.prototype._focus=function(){this._taxonomyPicker.current&&this._taxonomyPicker.current.focus()};t.prototype._isRequiredField=function(){return this.props.schema&&this.props.schema.Required};t.prototype._validateTerms=function(e){var t=this;this._timeout&&this._async.clearTimeout(this._timeout);this._timeout=this._async.setTimeout(function(){t._getValidatedTerms(e).then(function(e){t.setState({selectedTerms:e})})},300)};t.prototype._getValidatedTerms=function(e){return e.some(function(e){return 1!==e.state})?this._dataManager.validateTerms(this.state.queryParams,e):Promise.resolve(e)};t.prototype.getTaxonomyTreeUrl=function(){return this._dataSource.getTaxonomyTreeUrl(this.convertToTermsRawString(this.state.selectedTerms),{name:this.props.schema.Name,id:this.props.schema.Id,isMulti:this.props.schema.AllowMultipleValues},this.state.queryParams)};t.prototype.convertToTermsRawString=function(e){for(var t="",n=0;n<e.length;n++){var r=e[n];if(1===r.state){t+=r.term.label+f.LABEL_ID_DELIMITER+r.term.termId;n<e.length-1&&(t+=f.TERM_DELIMITER)}}return t};t.prototype._getTermsAsServerString=function(){return this.state.selectedTerms.reduce(function(e,t){return e+t.term.label+f.LABEL_ID_DELIMITER+t.term.termId+f.TERM_DELIMITER},"")};t.prototype.getData=function(){return this._getTermsAsServerString()};t.prototype._shouldSaveDataOnEnter=function(){return!1};Object.defineProperty(t.prototype,"_isModernTaggingToBeDisplayed",{get:function(){return this._isClassicTreeToBeShownForcefullyAllowed?!this.state.forceClassicTree&&(this._isModernTaggingIgniteFlightEnabled||this._isModernTaggingQuickEditGAFlightEnabled):this._isModernTaggingIgniteFlightEnabled||this._isModernTaggingQuickEditGAFlightEnabled},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isClassicTreeToBeShownForcefullyAllowed",{get:function(){return d.default.isFeatureEnabled({ODB:1910})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isModernTaggingIgniteFlightEnabled",{get:function(){return d.default.isFeatureEnabled({ODB:1659})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isModernTaggingQuickEditGAFlightEnabled",{get:function(){return d.default.isFeatureEnabled({ODB:1842})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isQuickEditVisualRefreshFlightEnabled",{get:function(){return d.default.isFeatureEnabled({ODB:1725})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isNarrationForTagIconEnabled",{get:function(){return d.default.isFeatureEnabled({ODB:307})},enumerable:!0,configurable:!0});return t})(r.PureComponent);t.TaxonomyEditor=y});
define("aPQ",["require","exports","mU"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){(function(t){function r(t,n){var r="";if(e.Utility.isObjectInstance(t))if(n){for(var i=new Sys.StringBuilder,s=0;s<t.length;s++){s>0&&i.append(";");e.JsonTerm.appendTo(i,t[s])}r=i.toString()}else r=e.JsonTerm.getLocalizedValue(t);return r}t.DataValueToInputValue=r;t.InputValueToDataValue=function(t,n){var r=null;if(!e.Utility.isNullOrEmpty(t))if(n){r=[];for(var i=t.split(";"),s=0;s<i.length;s++)r.push(e.JsonTerm.parseInputValue(i[s]))}else r=e.JsonTerm.parseInputValue(t);return r};t.SPListValueToGridValue=function(t,n,s){if(e.Utility.isNullOrUndefined(t))return null;var o=e.JsonTerm.create(t.get_label(),t.get_termGuid());return i(o,r(o,!1))};t.SPListValueCollectionToGridValue=function(t,n,s){for(var o=[],u=t.get_count(),a=0;a<u;a++){var f=e.JsonTerm.parseTaxonomyFieldValue(t.itemAt(a));o.push(f)}return i(o,r(o,!0))};t.GridValueToInputValue=function(t){var r=n.__assign({},t);e.Utility.isObject(t.data)||(r.data=null);e.Utility.isString(t.localized)||(r.localized="");return r.localized};function i(t,n){var r=t,i=n;e.Utility.isObject(t)||(r=null);e.Utility.isString(n)||(i="");return{data:r,localized:i}}t.CreateGridValue=i})(e.DataConverters||(e.DataConverters={}));(function(t){t.renderViewControl=function(t,n,r,i){var s="";if(t&&n&&r){var o=r[n.Name];e.Utility.isObjectInstance(o)&&(n.AllowMultipleValues?s=e.JsonTerm.arrayToDisplayString(o):e.Utility.isNullOrUndefined(o)||(s=o.Label))}return s}})(e.TaxonomyFieldTemplate||(e.TaxonomyFieldTemplate={}));(function(e){e.isObjectInstance=function(e){return!t(e)&&r(e)};function t(e){return null===e||n(e)}e.isNullOrUndefined=t;e.isNullOrEmpty=function(e){return t(e)||""===e};function n(e){return void 0===e}e.isUndefined=n;function r(e){return"object"==typeof e}e.isObject=r;e.isString=function(e){return"string"==typeof e}})(e.Utility||(e.Utility={}));(function(e){e.appendTo=function(e,t){e.append(t.Label);e.append("|");e.append(t.TermID)};e.getLocalizedValue=function(e){return e.Label+"|"+e.TermID};function t(e,t){var n={};n.Label=e;n.TermID=t;return n}e.create=t;e.parseInputValue=function(e){var n=e.split("|");return t(n[0],n[1])};e.parseTaxonomyFieldValue=function(e){return t(e.get_label(),e.get_termGuid())};e.arrayToDisplayString=function(e){var t=new Sys.StringBuilder;if(e)for(var n=0;n<e.length;n++){t.append(e[n].Label);t.append("; ")}return t.toString()}})(e.JsonTerm||(e.JsonTerm={}));var t=(function(){function t(e){this.ID="TaxonomyField";this.customFieldInfo=e}t.prototype.LocalizedValueToCSRValue=function(t){return e.DataConverters.InputValueToDataValue(t,!1)};t.prototype.BeginValidateNormalizeConvert=function(t,n,r,i,s,o){var u={};if(i){u.normalizedLocValue=r;u.dataValue=e.DataConverters.InputValueToDataValue(u.normalizedLocValue,!1)}else{u.dataValue=r;u.normalizedLocValue=SP.UI.Taxonomy.DataConverters.DataValueToInputValue(u.dataValue,!1)}u.isValid=!0;s&&s(u)};t.prototype.GetFieldSchema=function(e){return this.customFieldInfo?this.customFieldInfo[e]:null};return t})();e.TaxonomyFieldPropertyType=t})(t.Taxonomy||(t.Taxonomy={}))});
define("aPP",["require","exports","aQo","aPM","bt","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s){"use strict";s=s.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var o,u,a,f,l,c,h=i.Killswitch.isActivated("EABF579C-6EB3-42E0-97C7-203F466C1DB7","2/25/2020","Fix HTML string decoding for display control for multi line text fields."),p=i.Killswitch.isActivated("F8981E1F-1867-43CA-9123-178C686F8AE1","2/25/2020","Strip only certain HTML tags from RTE and MultiLine Text Fields to preserve font styles minus fot-size"),d={ODB:1725};t.globalClienttemplates=function(){"undefined"==typeof g_all_modules&&(g_all_modules={});g_all_modules["clienttemplates.js"]={version:{rmj:16,rmm:0,rup:19416,rpr:12e3}};"function"==typeof spWriteProfilerMark&&spWriteProfilerMark("perfMarkBegin_clienttemplates.js");n.JsGridUtil.SPListView||(n.JsGridUtil.SPListView=!1);o="undefined"!=typeof SingleListView;(function(){var e=n.JsGridUtil.SPListView;ListModule.Settings.SupportsCallouts=e;ListModule.Settings.SupportsDragDrop=e;ListModule.Settings.SupportsRibbon=e;ListModule.Settings.SupportsQCB=e;ListModule.Settings.SupportsUpload=e;ListModule.Settings.SupportsInplHash=e;ListModule.Settings.SupportsAnimation=e;ListModule.Settings.SupportsGrouping=e;ListModule.Settings.SupportsNonCSR=e;ListModule.Settings.SupportsInPlaceEdit=e;ListModule.Settings.SupportsItemDelete=e;ListModule.Settings.SupportsCheckout=e;ListModule.Settings.SupportsPopup=e;ListModule.Settings.SupportsErrorDlg=e;ListModule.Settings.SupportsFileAttach=e;ListModule.Settings.SupportsCopies=e;ListModule.Settings.SupportsModeration=e;ListModule.Settings.SupportsMQuery=e;ListModule.Settings.SupportsForms=e;ListModule.Settings.SupportsViewSelectorPivot=e;ListModule.Settings.SupportsWebPageLibraryTemplate=e;ListModule.Settings.SupportsDeveloperAppTemplate=e;ListModule.Settings.SupportsDelayLoading=e;ListModule.Settings.SupportsItemSelection=e;ListModule.Settings.SupportsSharingDialog=e;ListModule.Settings.UseAbsoluteUserDispUrl=!e;ListModule.Settings.SupportsCrossDomainPhotos=e;ListModule.Settings.SupportsTouch=e;ListModule.Settings.SupportsBusinessDataField=e;ListModule.Settings.SupportsUrlTokenReplacement=e;ListModule.Settings.SupportsAsyncDataLoad=e;ListModule.Settings.SupportsBreadCrumb=e;ListModule.Settings.SupportsSubmitFormPost=e;ListModule.Settings.SupportsFacePile=e;ListModule.Settings.SupportsRest=o;ListModule.Settings.SupportsDatapipes=o;ListModule.Settings.SupportsOldDesktopMenus=e;ListModule.Settings.SupportsTaskListEditMode=e})();u=!1;a=!1;(function(){if(Boolean(a))return;void 0===window.ListView&&(window.ListView=new Object);void 0===window.ListView.Strings&&(n.JsGridUtil.SPListView&&void 0!==Strings.STS?window.ListView.Strings=Strings.STS:void 0!==ListViewDefaults.Strings&&(window.ListView.Strings=ListViewDefaults.Strings));a=!0})();void 0===window.ListView&&(window.ListView=new Object);void 0===window.ListView.ImageBasePath&&(window.ListView.ImageBasePath="");f=[];l=function(e,t){f.push(this);var n=e,r={},i={},s={},o={},u={};this.Matches=function(e){return e==n};this.RegisterHierarchyNode=function(e,t,n,a){r[e]=!0;i[e]=n;s[a]=e;u[e]=a;o[e]=[];null!=t&&o[t].push(e)};this.IsParent=function(e){return e in o&&o[e].length>0};this.ToggleExpandByImg=function(e){if(e.id in s){a(s[e.id],e)}};this.ToggleExpandById=function(e){if(null!=e&&e in u){var t=u[e],n=$get(t);null!=n&&a(e,n)}};this.GetToggleStateById=function(e){return null==e?0:e in r?0==o[e].length?0:r[e]?1:2:0};function a(e,n){var s=!r[e];if(s){n.firstChild.className="ms-commentcollapse"+(t?"rtl":"")+"-icon";(function e(t){for(var n=0;n<o[t].length;n++){document.getElementById(i[o[t][n]]).style.display="";r[o[t][n]]&&e(o[t][n])}})(e)}else{n.firstChild.className="ms-commentexpand"+(t?"rtl":"")+"-icon";(function e(t){for(var n=0;n<o[t].length;n++){document.getElementById(i[o[t][n]]).style.display="none";e(o[t][n])}})(e)}r[e]=s}};t.SPClientRenderer={GlobalDebugMode:!1,AddCallStackInfoToErrors:!1,RenderErrors:!0};t.SPClientRenderer.IsDebugMode=function(e){return void 0!==e&&null!=e&&void 0!==e.DebugMode?Boolean(e.DebugMode):Boolean(t.SPClientRenderer.GlobalDebugMode)};t.SPClientRenderer._ExecuteRenderCallbacks=function(e,n){var r={Operation:n};return g(function(){return t.SPClientRenderer._ExecuteRenderCallbacksWorker(e,n,r)},e,null,r)};t.SPClientRenderer._ExecuteRenderCallbacksWorker=function(e,t,n){if(e&&null!=t&&""!=t){var r=e[t];if(null!=r)if("function"==typeof r){n.TemplateFunction=r;r(e)}else if("object"==typeof r){var i=r.length;if(i&&"number"==typeof i)for(var s=0;s<Number(i);s++)if("function"==typeof r[s]){n.TemplateFunction=r[s];r[s](e)}}}};t.SPClientRenderer.CoreRender=y;"function"!=typeof window.ComputedFieldWorker&&(window.ComputedFieldWorker=(function(){function e(e,t,r){if("1"==e["Created_x0020_Date.ifnew"]){var i;i=n.JsGridUtil.Internal.GetImageUrl("spcommon.png");r.push('<span class="ms-newdocument-iconouter"><img class="ms-newdocument-icon" src="');r.push(i);r.push('" alt="');r.push(window.ListView.Strings.L_SPClientNew);r.push('" title="');r.push(window.ListView.Strings.L_SPClientNew);r.push('" /></span>')}}function i(e,t,n,r,i,s,u){var a=[];a.push('<span style="vertical-align:middle">');a.push('<span style="height:16px;width:16px;position:relative;display:inline-block;overflow:hidden;" class="s4-clust"><a href="');a.push(e);o(a,s,u);a.push('" style="height:16px;width:16px;display:inline-block;" ><img src="'+ListView.ImageBasePath+'/_layouts/15/images/fgimg.png?rev=47" alt="');a.push(t);a.push('" style="left:-0px !important;top:');a.push(n);a.push('px !important;position:absolute;" title="');a.push(r);a.push('" class="imglink" longDesc="');a.push(i);a.push('"></a>');a.push("</span>");a.push("</span>");return a.join("")}function o(e,t,n){e.push(t.HttpVDir);e.push("/Lists/Posts/Post.aspx?ID=");e.push(n.ID)}function u(t,i,o){var u=[],a=i.FileRef;if(null!=a&&void 0!==a&&""!=r.TrimSpaces(a))if("1"==i.FSObjType)"1"==o.IsDocLib?I(t,u,i.FileLeafRef,i,o):F(u,i.FileLeafRef,i,o);else if(ListModule.Settings.SupportsAddToOneDrive&&Boolean(IsMountPoint(i))){_(i);u.push(RenderMountPointLink(t,u,i["FileLeafRef.Name"],i,o))}else if(ListModule.Settings.SupportsShortcutLink&&Boolean(r.IsShortcutLink(i))){_(i);r.RenderShortcutLink(t,u,i["FileLeafRef.Name"],i,o)}else{var f,l=(Boolean(t.RealHttpRoot)?ListModule.Util.getHostUrl(t.HttpRoot):"")+i.FileRef;l=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(54)?Encoding.HtmlEncodeEx(l):Encoding.HtmlEncode(l);var c=n.JsGridUtil.Internal.IsFeatureEnabled(d)?" "+s.listLink:"";u.push("<a class='ms-listlink"+c+"' href=\"");u.push(l);u.push('" onmousedown="return VerifyHref(this,event,\'');u.push(o.DefaultItemOpen);u.push("','");u.push(i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);u.push("','");f=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?Encoding.ScriptEncode(i["serverurl.progid"]):i["serverurl.progid"];if((null==window.OffSwitch||OffSwitch.IsActive("88E16BF7-E8BC-4ABA-ABE7-001818C101E8"))&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(164)&&"ms-word"==i["File_x0020_Type.mapapp"]||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(194)&&"ms-powerpoint"==i["File_x0020_Type.mapapp"]||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(225)&&"ms-visio"==i["File_x0020_Type.mapapp"]||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(181)&&"ms-excel"==i["File_x0020_Type.mapapp"]){f=f.replace("WopiFrame.aspx","doc.aspx");(null==window.OffSwitch||OffSwitch.IsActive("8682DDE6-14A4-4290-876C-8D1F5AFD46E0")||"ms-visio"!=i["File_x0020_Type.mapapp"]&&"ms-excel"!=i["File_x0020_Type.mapapp"])&&(f=f.replace("action=default","action=edit"))}u.push(f);u.push('\')" onclick="');be(u,i,"Navigation");if(x()){if(S()&&E(t)){u.push("CoreInvoke('CallSuiteExtensionControlFactory', this, event, '");null==window.OffSwitch||OffSwitch.IsActive("9E9D50DD-3F1B-4186-8AC0-80E9634B2891")?u.push(i.File_x0020_Type):u.push(Encoding.ScriptEncode(i.File_x0020_Type));u.push("','");u.push(t.HttpRoot);u.push("','");u.push(Encoding.ScriptEncode(i.FileRef));u.push("');")}}else{u.push("CoreInvoke('CallSuiteExtensionControlFactory', this, event, '");null==window.OffSwitch||OffSwitch.IsActive("9E9D50DD-3F1B-4186-8AC0-80E9634B2891")?u.push(i.File_x0020_Type):u.push(Encoding.ScriptEncode(i.File_x0020_Type));u.push("','");u.push(t.HttpRoot);u.push("','");u.push(Encoding.ScriptEncode(i.FileRef));u.push("');")}u.push("return DispEx(this,event,'TRUE','FALSE','");u.push(i["File_x0020_Type.url"]);u.push("','");u.push(i["File_x0020_Type.progid"]);u.push("','");u.push(o.DefaultItemOpen);u.push("','");u.push(i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);u.push("','");u.push(i.HTML_x0020_File_x0020_Type);u.push("','");u.push(f);u.push("','");u.push(Boolean(i.CheckoutUser)?i.CheckoutUser[0].id:"");u.push("','");u.push(o.Userid);u.push("','");u.push(o.ForceCheckout);u.push("','");u.push(i.IsCheckedoutToLocal);u.push("','");u.push(i.PermMask);var h=i.FileLeafRef;if(null!=h){var p=h.lastIndexOf(".");h=p>=0?h.substring(0,p):h}if(ListModule.Settings.SupportsDoclibAccessibility){u.push("')\"");var v=h+", "+L(i["File_x0020_Type.mapapp"],i.File_x0020_Type);u.push(" aria-label='");u.push(Encoding.HtmlEncode(v));u.push("'>")}else u.push("')\">");u.push(Encoding.HtmlEncode(h));u.push("</a>");e(i,0,u)}else{u.push("<nobr>");u.push(Encoding.HtmlEncode(i.FileLeafRef));u.push("</nobr>")}return u.join("")}function a(e,n,i,s){var o=[],u=Encoding.HtmlEncode(i.FileLeafRef),a="imgIcon"+i.ID+e.wpq,f=void 0!==i["DocIcon.groupHeader"];if(f){a="imgIcon"+e.ctxId+"-";if(i["DocIcon.groupindex"])a+=i["DocIcon.groupindex"];else if(i["DocIcon.groupindex2"]){var l=s.group1;a+=i[l+".groupindex"]+i["DocIcon.groupindex2"]}}if(ListModule.Settings.SupportsAddToOneDrive&&Boolean(IsMountPoint(i))){var c=MountPointInfo.createByListItem(i,e);if((function(e){return Boolean(e)&&!e.inGridMode&&(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(168)&&700==e.ListTemplateType&&51==e.BaseViewID||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(424)&&null!=window.groupContextData&&101==e.ListTemplateType&&1==e.BaseViewID)})(e)){o.push('<a href="#" onclick="');o.push("EnterFolderAjax(event, '");o.push(URI_Encoding.encodeURIComponent(i.FileRef));o.push("', '");o.push(c.getMountPointUrl());o.push("', true);return false;\"");ListModule.Settings.SupportsDoclibAccessibility?o.push(' aria-label="'+Encoding.HtmlEncode(window.ListView.Strings.L_FieldType_SharedFolder)+'">'):o.push(">")}else{o.push('<a href="');o.push(c.getMountPointUrl());ListModule.Settings.SupportsDoclibAccessibility?o.push(' aria-label="'+Encoding.HtmlEncode(window.ListView.Strings.L_FieldType_SharedFolder)+'">'):o.push('">')}o.push('<img border="0" alt="');o.push(u);o.push('" title="');o.push(u);o.push('" src="');o.push(ListView.ImageBasePath+"/_layouts/15/images/SharedFolder16.png?rev=47");o.push('" />');o.push("</a>")}else if(ListModule.Settings.SupportsShortcutLink&&Boolean(r.IsShortcutLink(i))){_(i);r.RenderShortcutLinkIcon(e,o,i["FileLeafRef.Name"],i,s)}else if("1"==i.FSObjType){var h=H()?"&MaintainUserChrome=true":"";if(T())C();else{o.push('<a href="');o.push(s.PagePath);o.push("?RootFolder=");o.push(URI_Encoding.encodeURIComponent(i.FileRef));o.push(s.ShowWebPart);o.push("&FolderCTID=");o.push(i.ContentTypeId);o.push("&View=");o.push(URI_Encoding.encodeURIComponent(s.View));o.push(h);o.push('" onmousedown="VerifyFolderHref(this, event, \'');o.push(i["File_x0020_Type.url"]);o.push("','");o.push(i["File_x0020_Type.progid"]);o.push("','");o.push(s.DefaultItemOpen);o.push("', '");o.push(i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);o.push("', '");o.push(i.HTML_x0020_File_x0020_Type);o.push("', '");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?o.push(Encoding.ScriptEncode(i["serverurl.progid"])):o.push(i["serverurl.progid"]);o.push('\')" onclick="');be(o,i,"Navigation");o.push("return HandleFolder(this,event,'");o.push(s.PagePath);o.push("?RootFolder=");o.push(URI_Encoding.encodeURIComponent(i.FileRef));o.push(s.ShowWebPart);o.push("&FolderCTID=");o.push(i.ContentTypeId);o.push("&View=");o.push(URI_Encoding.encodeURIComponent(s.View));o.push(h);o.push("','TRUE','FALSE','");o.push(i["File_x0020_Type.url"]);o.push("','");o.push(i["File_x0020_Type.progid"]);o.push("','");o.push(s.DefaultItemOpen);o.push("','");o.push(i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);o.push("','");o.push(i.HTML_x0020_File_x0020_Type);o.push("','");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?o.push(Encoding.ScriptEncode(i["serverurl.progid"])):o.push(i["serverurl.progid"]);o.push("','");o.push(Boolean(i.CheckoutUser)?i.CheckoutUser[0].id:"");o.push("','");o.push(s.Userid);o.push("','");o.push(s.ForceCheckout);o.push("','");o.push(i.IsCheckedoutToLocal);o.push("','");o.push(i.PermMask);ListModule.Settings.SupportsDoclibAccessibility?o.push('\');" tabIndex="-1" IsFolder="TRUE" aria-label="'+Encoding.HtmlEncode(k(i["File_x0020_Type.mapapp"],!1))+'"><img border="0" alt="'):o.push('\');"><img border="0" alt="');o.push(u);o.push('" title="');o.push(u);o.push('" src="');o.push((function(e){return""==e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]?ListView.ImageBasePath+"/_layouts/15/images/folder.gif?rev=47":ListView.ImageBasePath+"/_layouts/15/images/"+e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]})(i));o.push('" />');if(void 0!==i.IconOverlay&&""!=i.IconOverlay){o.push('<img width="16" height="16" src="'+ListView.ImageBasePath+"/_layouts/15/images/");null==window.OffSwitch||OffSwitch.IsActive("B35674E3-5E63-4A44-AF45-127010C82E7D")?o.push(i["IconOverlay.mapoly"]):o.push(Encoding.HtmlEncode(i["IconOverlay.mapoly"]));o.push('" class="ms-vb-icon-overlay" alt="" title="" />')}o.push("</a>")}}else if("1"==s.IsDocLib)if(void 0===i.IconOverlay||""==i.IconOverlay){var p=!1,d=null,v=void 0===i.CheckoutUser||""==i.CheckoutUser,m=void 0!==i._ComplianceFlags&&null!=i._ComplianceFlags&&4==(4&i._ComplianceFlags);if(x()){e.allowedSuiteExtensionFileTypes=["pdf"];S()&&E(e)&&(p=!0)}else{e.allowedSuiteExtensionFileTypes=["bmp","chm","gif","htm","html","jpeg","jpg","pdf","png","psd","tif","txt","wma","wmv","xml","zip"];S()&&void 0!==i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]&&(""==i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]||IE8Support.arrayIndexOf(e.allowedSuiteExtensionFileTypes,i.File_x0020_Type,0)>-1)&&(p=!0)}if(T())C();else if(v){d=ListModule.Settings.SupportsDoclibAccessibility?L(i["File_x0020_Type.mapapp"],i.File_x0020_Type):i.FileLeafRef;var g=Boolean(i["HTML_x0020_File_x0020_Type.File_x0020_Type.isIconDynamic"])?" onclick=\"this.style.display='none';\"":"";m&&(d=w());N(d,i.FileLeafRef,!0,i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"],g)}else N(d=b(),d,!0,i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"],void 0);if(!f&&(!v||m)){var y=ListView.ImageBasePath+"/_layouts/15/images/checkoutoverlay.gif";d=b();if(v&&m){d=w();y=ListView.ImageBasePath+"/_layouts/15/images/lockoverlay.png"}o.push('<img src="'+y+'" class="ms-vb-icon-overlay" alt="');o.push(d);o.push('" title="');o.push(d);o.push('" />')}}else{N(i.FileLeafRef,i.FileLeafRef,!1,i["IconOverlay.mapico"],void 0);o.push('<img width="16" height="16" src="'+ListView.ImageBasePath+"/_layouts/15/images/");null==window.OffSwitch||OffSwitch.IsActive("B35674E3-5E63-4A44-AF45-127010C82E7D")?o.push(i["IconOverlay.mapoly"]):o.push(Encoding.HtmlEncode(i["IconOverlay.mapoly"]));o.push('" class="ms-vb-icon-overlay" alt="" title="" />')}else N(i.FileLeafRef,i.FileLeafRef,!1,i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"],void 0);function b(){return i.FileLeafRef+"&#10;"+window.ListView.Strings.L_SPCheckedoutto+": "+(Boolean(i.CheckoutUser)?Encoding.HtmlEncode(i.CheckoutUser[0].title):"")}function w(){return i.FileLeafRef+"&#10;"+window.ListView.Strings.L_Tag_Callout_BlockDeleteItem}function T(){return ListModule.Settings.SupportsPolicyTips&&void 0!==i._ip_UnifiedCompliancePolicyUIAction&&Number(i._ip_UnifiedCompliancePolicyUIAction)>0&&!f}function N(t,n,r,s,u){o.push('<img width="16" height="16" border="0" alt="');o.push(t);x()?p&&o.push('" class="registerFileIcon'):p&&(""==i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]||IE8Support.arrayIndexOf(e.allowedSuiteExtensionFileTypes,i.File_x0020_Type,0)>-1)&&o.push('" class="registerFileIcon');o.push('" title="');o.push(n);if(void 0!==a){o.push('" id="');o.push(a)}r&&p&&""==s&&(s="icgen.gif");o.push('" src="'+ListView.ImageBasePath+"/_layouts/15/images/"+s);o.push('"');void 0!==u&&o.push(u);o.push("/>")}function C(){var n,r;if(1==Number(i._ip_UnifiedCompliancePolicyUIAction)){n="dlpalert.png";r=window.ListView.Strings.L_DLP_Callout_PolicyTip}else{n="dlpblock.png";r=window.ListView.Strings.L_DLP_Callout_BlockedItem}N(r,r,!0,n,' class="ms-listview-policyTipIcon"');var s=!1;t.SPClientRenderer.AddPostRenderCallback(e,function(){if(!s){s=!0;var t=document.getElementById(a);Boolean(t)&&DOM.AddEventHandler(t,"onclick",function(t){1==Number(i._ip_UnifiedCompliancePolicyUIAction)||3==Number(i._ip_UnifiedCompliancePolicyUIAction)?EnsureScriptFunc("core.js","LaunchDlpDialog",function(){LaunchDlpDialog(i,e,"DocIcon")}):WriteDocEngagementLog("Documents_PolicyTipIconClickNoNotify","OneDrive_PolicyTipIconClickNoNotify")},!1)}})}return o.join("")}function f(e,t,n,r){return l(e,n,r,n.Title)}function l(t,n,r,i){var s=[];"1"==n.FSObjType?"1"==r.IsDocLib?I(t,s,A(i),n,r):F(s,A(i),n,r):C(s,t,n,r,A(i),void 0);e(n,0,s);return s.join("")}function c(e,t,n,r){var i=[];i.push('<a href="'+D(n.FileRef,void 0)+'">');i.push('<img galleryimg="false" border="0"');i.push(' id="'+n.ID+'webImgShrinked"');"PreviewOnForm"!=t.Name&&i.push(' class="ms-displayBlock"');var s=("PreviewOnForm"==t.Name?"256":"128")+"px";i.push(' style="max-width: '+s+"; max-height: "+s+'; margin:auto; visibility: hidden;"');i.push(' onerror="displayGenericDocumentIcon(event.srcElement ? event.srcElement : event.target, '+n.FSObjType+'); return false;"');i.push(" onload=\"(event.srcElement ? event.srcElement : event.target).style.visibility = 'visible';\"");i.push(' alt="');var o=n._Comments;null!=o&&""!=o?i.push(Encoding.HtmlEncode(o)):i.push(window.ListView.Strings.L_ImgAlt_Text);i.push('" src="'+D((void 0)(n,256,e),void 0)+'"/>');i.push("</a>");return i.join("")}return{URLwMenu:function(e,t,n,r){var i;if("1"==n.FSObjType){var s=[];s.push('<a onfocus="OnLink(this)" href="SubmitFormPost()" onclick="ClearSearchTerm(\'');s.push(r.View);s.push("');ClearSearchTerm('');SubmitFormPost('");s.push(r.PagePath);s.push("?RootFolder=");s.push(URI_Encoding.encodeURIComponent(n.FileRef));s.push(r.ShowWebPart);s.push("&FolderCTID=");s.push(n.ContentTypeId);s.push("');return false;\">");s.push(n.FileLeafRef);s.push("</a>");i=s.join("")}else i=P(n,"URL",r,t,!0);return i},URLNoMenu:function(e,t,n,r){return P(n,"URL",r,t,!0)},mswh_Title:function(e,t,n,r){var i=[];i.push('<a onfocus="OnLink(this)" href="');i.push(n.FileRef);i.push('" onclick="LaunchWebDesigner(');i.push("'");i.push(n.FileRef);i.push("','design'); return false;");i.push('">');i.push(A(n.Title));i.push("</a>");return i.join("")},LinkTitle:f,LinkTitleNoMenu:f,Edit:function(e,t,n,r){if(ListModule.Util.hasEditPermission(n)){var i=(function(e,t){return"4"==e.EventType?e.ID+".1."+e.MasterSeriesItemID:e.ID})(n),s=[];s.push('<a href="');s.push(e.editFormUrl);s.push("&ID=");s.push(i);s.push('" onclick="EditItemWithCheckoutAlert(event, \'');s.push(e.editFormUrl);s.push("&ID=");s.push(i);s.push("', '");s.push((function(e,t){var n=void 0===e.CheckoutUser||""==e.CheckoutUser;return"1"==t.ForceCheckout&&"1"!=e.FSObjType&&n?"1":""})(n,r));s.push("', '");s.push(n.IsCheckedoutToLocal);s.push("', '");s.push(escape(n.FileRef));s.push("', '");s.push(r.HttpVDir);s.push("', '");s.push(n.CheckedOutUserId);s.push("', '");s.push(r.Userid);s.push('\');return false;" target="_self">');s.push('<img border="0" alt="');s.push(window.ListView.Strings.L_SPClientEdit);s.push('" src="'+ListView.ImageBasePath+'/_layouts/15/images/edititem.gif?rev=47"/></a>');return s.join("")}return"&nbsp;"},DocIcon:a,MasterPageIcon:a,LinkFilename:function(e,t,n,r){return u(e,n,r)},LinkFilenameNoMenu:function(e,t,n,r){return u(e,n,r)},NumCommentsWithLink:function(e,t,n,r){var s=[];s.push(i("",window.ListView.Strings.L_SPClientNumComments,"-396",window.ListView.Strings.L_SPClientNumComments,window.ListView.Strings.L_SPClientNumComments,r,n));s.push('<span><a href="');o(s,r,n);s.push('">&nbsp;');s.push(n.NumComments);s.push("&nbsp;");s.push("Comment(s)");s.push("</a></span>");return s.join("")},EmailPostLink:function(e,t,n,r){return i("javascript:navigateMailToLink('",window.ListView.Strings.L_SPEmailPostLink,"-267",window.ListView.Strings.L_SPEmailPostLink,window.ListView.Strings.L_SPEmailPostLink,r,n)},Permalink:function(e,t,n,r){return i("","Permanent Link to Post","-412","Permanent Link to Post","Permanent Link to Post",r,n)},CategoryWithLink:function(e,t,n,r){var i=[];i.push('<a class="static menu-item" href="');i.push(r.HttpVDir);i.push("/");i.push("lists/Categories/Category.aspx?CategoryId=");i.push(n.ID);i.push('" id="blgcat');i.push(n.ID);i.push('"><span class="additional-backgroud"><span class="menu-item-text">');i.push(n.Title);i.push("</span></span></a>");return i.join("")},LinkIssueIDNoMenu:function(e,t,n,r){var i=[];i.push('<a href="');i.push(e.displayFormUrl);i.push("&ID=");i.push(n.ID);i.push('" onclick="');be(i,n,"Navigation");i.push("EditLink2(this,");i.push(e.ctxId);i.push(');return false;" target="_self">');i.push(n.ID);i.push("</a>");return i.join("")},SelectTitle:function(e,t,n,r){if(r.SelectedID==n.ID||"-1"==r.SelectedID&&1==n.firstRow)return'<img border="0" align="absmiddle" style="cursor: hand" src="'+ListView.ImageBasePath+'/_layouts/15/images/rbsel.gif" alt="'+window.ListView.Strings.L_SPSelected+'" />';var i=[];i.push("<a href=\"javascript:SelectField('");i.push(r.View);i.push("','");i.push(n.ID);i.push("');return false;\" onclick=\"SelectField('");i.push(r.View);i.push("','");i.push(n.ID);i.push('\');return false;" target="_self">');i.push('<img border="0" align="absmiddle" style="cursor: hand" src="'+ListView.ImageBasePath+'/_layouts/15/images/rbunsel.gif"  alt="');i.push(window.ListView.Strings.L_SPGroupBoardTimeCardSettingsNotFlex);i.push('" /></a>');return i.join("")},DisplayResponse:function(e,t,n,r){var i=[];i.push('<a onfocus="OnLink(this)" href="');i.push(e.displayFormUrl);i.push("&ID=");i.push(n.ID);i.push('" onclick="GoToLinkOrDialogNewWindow(this);return false;" target="_self" id="onetidViewResponse">');i.push(window.ListView.Strings.L_SPView_Response);i.push(" #");i.push(n.ID);i.push("</a>");return i.join("")},Completed:function(e,t,n,r){return"1"==n._Level?window.ListView.Strings.L_SPYes:window.ListView.Strings.L_SPNo},RepairDocument:function(e,t,n,r){return'<input id="chkRepair" type="checkbox" title="'+window.ListView.Strings.L_SPRelink+'" docID="'+n.ID+'" />'},Combine:function(e,t,n,r){if("0"==n.FSObjType){var i='<input id="chkCombine" type="checkbox" title="';i+=window.ListView.Strings.L_SPMerge;i+='" href="';i+=("0"==n.FSObjType?String(r.HttpVDir)+String(n.FileRef):n.FileRef)+'" />';i+='<input id="chkUrl" type="hidden" href="';i+=n.TemplateUrl;i+='" />';i+='<input id="chkProgID" type="hidden" href="';i+=n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"];return i+='" />'}return""},HealthReportSeverityIcon:function(e,t,n,r){var i,s=new String(n.HealthReportSeverity),o=s.indexOf(" - ");i="1"==(s=s.substring(0,o))?"hltherr":"2"==s?"hlthwrn":"3"==s?"hlthinfo":"4"==s?"hlthsucc":"hlthfail";return'<img src="'+ListView.ImageBasePath+"/_layouts/15/images/"+i+'.png" alt="'+s+'" />'},FileSizeDisplay:function(e,t,n,r){return"0"==n.FSObjType?String(Math.ceil(n.File_x0020_Size/1024))+" KB":""},NameOrTitle:function(e,t,n,r){return l(e,n,r,n.FileLeafRef)},ImageSize:function(e,t,n,r){var i=[];if("0"==n.FSObjType&&""!=n.ImageWidth&&"0"!=n.ImageWidth){i.push('<span dir="ltr">');i.push(n.ImageWidth+" x "+n.ImageHeight);i.push("</span>")}return i.join("")},ThumbnailOnForm:c,PreviewOnForm:c,Thumbnail:c,FileType:function(e,t,n,r){return n.File_x0020_Type},_IsRecord:function(e,t,n,r){return void 0!==n._ComplianceFlags&&null!=n._ComplianceFlags&&(4==(4&n._ComplianceFlags)||256==(256&n._ComplianceFlags))?window.ListView.Strings.L_SPYes:window.ListView.Strings.L_SPNo}}})());O.prototype={fieldRenderer:null,fldName:null,RenderField:M};c=function(e,t,r,i,o){var u=[],a=e.ListSchema,f=n.JsGridUtil.Internal.IsFeatureEnabled(d)&&e.fixedHeightRowEnabled?" "+s.cellHiddenOverflow:"";u.push('<div class="ms-vb '+(1==o?"":"ms-tableCell ms-list-TitleLink")+f+' ms-vb-menuPadding itx" CTXName="ctx');u.push(e.ctxId);u.push('" id="');u.push(t.ID);u.push('" Field="');u.push(r.Name);u.push('" Perm="');u.push(t.PermMask);u.push('" EventType="');u.push(t.EventType);u.push('">');u.push(i);u.push("</div>");if(1==o){u.push('</td><td class="ms-list-itemLink-td ms-cellstyle');a.Field[a.Field.length-1]==r&&u.push(" ms-vb-lastCell");u.push('">')}if(!PageMinimized()){u.push('<div class="ms-list-itemLink '+(1==o?"":"ms-tableCell ms-alignRight")+'" ');u.push("onclick=\"CoreInvoke('ShowECBMenuForTr', this, event");u.push(", ListView.Strings");u.push('); return false;">');u.push('<a ms-jsgrid-click-passthrough="true" class="ms-lstItmLinkAnchor ms-ellipsis-a" title="');u.push(Encoding.HtmlEncode(window.ListView.Strings.L_OpenMenuECB));u.push('" aria-haspopup="true" ');u.push("onclick=\"CoreInvoke('ShowECBMenuForTr', this.parentNode, event");u.push(", ListView.Strings");u.push('); return false; " href="#" >');u.push('<img class="ms-ellipsis-icon" src="'+n.JsGridUtil.Internal.GetImageUrl("spcommon.png")+'" alt="'+Encoding.HtmlEncode(window.ListView.Strings.L_OpenMenu)+'" /></a>');u.push("</div>")}return u.join("")};q.prototype={fldName:null,RenderField:R};U.prototype={fldName:null,RenderField:z};W.prototype={fldName:null,RenderField:X};V.prototype={fldName:null,RenderField:$};J.prototype={fldName:null,RenderField:K};Q.prototype={fldName:null,RenderField:G};Y.prototype={fldName:null,RenderField:ee};te.prototype={fldName:null,RenderField:ne};re.prototype={fldName:null,RenderField:ie};se.prototype={fldName:null,RenderField:oe};ue.prototype={fldName:null,RenderField:ae};fe.prototype={fldName:null,RenderField:le};null==window.OffSwitch||OffSwitch.IsActive("39A8E192-9EFC-4922-9FD8-343D685E163C")||(ce.prototype={fldName:null,RenderField:he});pe.prototype={fldName:null,RenderField:de};ve.prototype={fldName:null,RenderField:ge};ye.prototype={NewGroup:void 0,RenderField:void 0,RenderFieldByName:void 0};t.spMgr=new ye;"function"==typeof RegisterSharedWithFieldRenderer&&RegisterSharedWithFieldRenderer();"undefined"!=typeof Sys&&null!=Sys&&null!=Sys.Application&&Sys.Application.notifyScriptLoaded();"function"==typeof NotifyScriptLoadedAndExecuteWaitingJobs&&NotifyScriptLoadedAndExecuteWaitingJobs("clienttemplates.js");"function"==typeof spWriteProfilerMark&&spWriteProfilerMark("perfMarkEnd_clienttemplates.js")};t.InitListViewFlightSettings=function(){if(!Boolean(u)){ListModule.Settings.SupportsFileExtensionControls=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(439);ListModule.Settings.SupportsFileHandlerForAllNonOfficeFiles=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(754);ListModule.Settings.SupportsFileExtensionDataPipe=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(461);ListModule.Settings.SupportsFileHandlerAddInPicker=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(512);ListModule.Settings.SupportsFileHandlerFileCreation=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(540);ListModule.Settings.SupportsAddToOneDrive=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134);ListModule.Settings.SupportsAddToOneDriveQCB=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(161);ListModule.Settings.SupportsPeopleHoverCard=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(0);ListModule.Settings.SupportsMaintainUserChrome=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(63);ListModule.Settings.SupportsInfiniteScroll=!1;ListModule.Settings.SupportsAddToOneDriveInSync=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(259);ListModule.Settings.SupportsPolicyTips=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(340);ListModule.Settings.SupportsRightClickECB=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(249)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(383)&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(104);ListModule.Settings.SupportsShortcutLink=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(563);ListModule.Settings.SupportsDoclibAccessibility=!n.JsGridUtil.SPListView||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(169);ListModule.Settings.SupportsDoclibQCB=!n.JsGridUtil.SPListView||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(60);u=!0}};function v(e){for(var t=0;t<f.length;t++)f[t].ToggleExpandByImg(e.target.parentNode);e.stopPropagation()}function m(e,t){for(var n=0;n<f.length;n++)if(f[n].Matches(e))return f[n];return new l(e,t)}t.GetClientHierarchyManagerForWebpart=m;function g(e,n,r,i){if(t.SPClientRenderer.IsDebugMode(n))return e();try{return e()}catch(e){null==n.Errors&&(n.Errors=[]);try{e.ExecutionContext=i;Boolean(t.SPClientRenderer.AddCallStackInfoToErrors)&&"object"==typeof i&&null!=i&&"function"==typeof ULSGetCallstack&&(i.CallStack=ULSGetCallstack(g.caller))}catch(e){}n.Errors.push(e);return r}}function y(e,n){return g(function(){return(function(e,n){var r;"string"==typeof e?r=t.SPClientRenderer.ParseTemplateString(e,n):"function"==typeof e&&(r=e);return null==r?"":r(n)})(e,n)},n,"",{TemplateFunction:e,Operation:"CoreRender"})}function b(e,t){(function(e,t,n,r){if(Boolean(e)&&"function"==typeof n&&""!=t){var i=e[t];if(null==i)e[t]=n;else if("function"==typeof i){if(!Boolean(r)||String(i)!=String(n)){var s=[];s.push(i);s.push(n);e[t]=s}}else if("object"==typeof i){var o=!1;if(Boolean(r))for(var u=0;u<i.length;u++)if(i[u]==n){o=!0;break}o||e[t].push(n)}}})(e,"OnPostRender",t,!1)}function w(e,t,n){if(null==e||null==t||null==n)return null;for(var r="",i=-1,s=[],o=0,u=(s=s.concat(t.split("||"))).length;o<u;o++){var a=s[o];if(null!=a&&""!=a){for(var f=[],l=0,c=(f=f.concat(a.split(","))).length;l<c;l++){var h=f[l];if(null!=h&&""!=h)if(isNaN(Number(h))){if(-1!=h.indexOf("-")){var p,d=h.split("-");if(null==d||2!==d.length)continue;if(""===d[0])p=0;else{if(isNaN(Number(d[0])))continue;p=parseInt(d[0])}if(n>=p){if(""===d[1]){i=o;break}if(isNaN(Number(d[1])))continue;if(n<=parseInt(d[1])){i=o;break}}}else if(-1!=h.indexOf("*")){var v=h.trim().replace(/\*/g,"[0-9]*");if(new RegExp("^"+v+"$").test(n.toString())){i=o;break}}}else{if(n===parseInt(h)){i=o;break}}}if(-1!==i)break}}if(-1!==i){var m=e.split("||");null!=m&&null!=m[i]&&""!=m[i]&&(r=m[i])}return r}function E(e){return void 0!==e.allowedSuiteExtensionFileTypes&&IE8Support.arrayIndexOf(e.allowedSuiteExtensionFileTypes,e.CurrentItem.File_x0020_Type,0)>-1||!Boolean(e.CurrentItem["File_x0020_Type.mapapp"])&&!Boolean(e.CurrentItem["serverurl.progid"])}function S(){return!(BrowserDetection.userAgent.ie8down||!ListModule.Settings.SupportsFileExtensionControls)}function x(){return!(BrowserDetection.userAgent.ie8down||!ListModule.Settings.SupportsFileHandlerForAllNonOfficeFiles)}function T(e){return null!=e&&null!=e.ListSchema&&"1"==e.ListSchema.TabularView&&1!=e.inGridMode}function N(e){return null!=e&&null!=e.CurrentFieldValue?e.CurrentFieldValue.toString():""}t.RenderFieldValueDefault=N;function C(e,t,r,i,o,u){var a=n.JsGridUtil.Internal.IsFeatureEnabled(d)?" "+s.listLink:"";e.push('<a class="ms-listlink'+a+'" onfocus="OnLink(this)" href="');e.push(ListModule.Util.createItemPropertiesTitleUrl(t,r));e.push('" onclick="');be(e,r,"Navigation");e.push("EditLink2(this,");e.push(t.ctxId);e.push(');return false;" target="_self">');e.push(Boolean(i.HasTitle)||Boolean(u)?o:Encoding.HtmlEncode(o));e.push("</a>")}function k(e,t){return null!=e&&-1!=e.toLowerCase().indexOf("onenote")?t?window.ListView.Strings.L_FieldType_File_OneNote:window.ListView.Strings.L_FieldType_Folder_OneNote:window.ListView.Strings.L_FieldType_Folder}function L(e,t){var n=window.ListView.Strings.L_FieldType_File;null!=e&&""!=e?-1!=e.toLowerCase().indexOf("ms-word")?n=window.ListView.Strings.L_FieldType_File_Document:-1!=e.toLowerCase().indexOf("ms-excel")?n=window.ListView.Strings.L_FieldType_File_workbook:-1!=e.toLowerCase().indexOf("ms-powerpoint")?n=window.ListView.Strings.L_FieldType_File_PPT:-1!=e.toLowerCase().indexOf("onenote")&&(n=window.ListView.Strings.L_FieldType_File_OneNote):null!=t&&""!=t&&(n=t+" "+window.ListView.Strings.L_FieldType_File);return n}function A(e){return""==e?window.ListView.Strings.L_SPClientNoTitle:e}function O(e){this.fldName=e;this.fieldRenderer=null}function M(e,t,n,r){null==this.fieldRenderer&&(this.fieldRenderer=ComputedFieldWorker[this.fldName]);return null!=this.fieldRenderer?this.fieldRenderer(e,t,n,r):Encoding.HtmlEncode(n[this.fldName])}function _(e){if(void 0===e["FileLeafRef.Name"]){var t=e.FileLeafRef,n=t.lastIndexOf(".");e["FileLeafRef.Name"]=n>=0?t.substring(0,n):t}}function D(e,t){return void 0!==e&&null!=e?t?e.replace(/'/g,"%27"):e.replace(/"/g,"%22"):""}function P(e,t,n,r,i){var s=[],o=e[t],u=e[t+".desc"];if("Image"==r.Format){if(ListModule.Util.isDefinedAndNotNullOrEmpty(o)){s.push("<img ");if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(494)){s.push(" class='ms-listview-image' ");s.push(" onclick='javascript:var imgUrl=\"");s.push(D(o,void 0));s.push("\"; if (_shouldOpenInLightbox(imgUrl)){_openInLightbox(imgUrl);} else{STSNavigate(imgUrl);}'")}i&&s.push('onfocus="OnLink(this)" ');s.push('src="');s.push(D(o,void 0));s.push('" alt="');s.push(u);s.push('"/>')}}else if("Hyperlink"==r.Format)if(ListModule.Util.isDefinedAndNotNullOrEmpty(o)){s.push("<a ");i&&s.push('onfocus="OnLink(this)" ');s.push('href="');s.push(D(o,void 0));var a=void 0===Nav.ajaxNavigate?window.location.search.match(RegExp("[?&]IsDlg=1")):Nav.ajaxNavigate.get_search().match(RegExp("[?&]IsDlg=1"));Boolean(a)&&s.push('" target="_blank');s.push('">');""==u?s.push(Encoding.HtmlEncode(o)):s.push(Encoding.HtmlEncode(u));s.push("</a>")}else null!=u&&s.push(u);return s.join("")}function H(){var e=new URI(Nav.ajaxNavigate.get_href()).getQueryParameter("MaintainUserChrome");return ListModule.Settings.SupportsMaintainUserChrome&&Boolean(e)&&"true"==e.toLowerCase()}function B(e,t){var n=e.AdditionalQueryString;void 0!==n&&""!=n&&t.push(n)}function j(e,t,n){n.push(t.PagePath);n.push("?RootFolder=");n.push(URI_Encoding.encodeURIComponent(e.FileRef));n.push(t.ShowWebPart);n.push("&FolderCTID=");n.push(e.ContentTypeId);n.push("&View=");n.push(URI_Encoding.encodeURIComponent(t.View));B(e,n)}function F(e,t,n,r){e.push('<a onfocus="OnLink(this)" href="');j(n,r,e);e.push('" onclick="');be(e,n,"Navigation");e.push("javascript:EnterFolder('");e.push(r.PagePath);e.push("?RootFolder=");e.push(URI_Encoding.encodeURIComponent(n.FileRef));e.push(r.ShowWebPart);e.push("&FolderCTID=");e.push(n.ContentTypeId);e.push("&View=");e.push(URI_Encoding.encodeURIComponent(r.View));B(n,e);if(ListModule.Settings.SupportsDoclibAccessibility){e.push('\');return false;" aria-label="');e.push(Encoding.HtmlEncode(t));e.push(", "+Encoding.HtmlEncode(k(n["File_x0020_Type.mapapp"],!0))+'">')}else e.push("');return false;\">");e.push(Encoding.HtmlEncode(t));e.push("</a>")}function I(e,t,r,i,o){H()&&(function(e,t,n){var r=e.AdditionalQueryString;if(void 0!==r&&""!=r){var i=new URI(e.FileRef+"?"+r);i.setQueryParameter(t,n);e.AdditionalQueryString="&"+i.getQuery()}else e.AdditionalQueryString="&"+t+"="+n})(i,"MaintainUserChrome","true");var u=n.JsGridUtil.Internal.IsFeatureEnabled(d)?" "+s.listLink:"";t.push('<a onfocus="OnLink(this)" class="ms-listlink'+u+'" href="');j(i,o,t);t.push('" onmousedown="');t.push("javascript:VerifyFolderHref(this,event,'");t.push(i["File_x0020_Type.url"]);t.push("','");t.push(i["File_x0020_Type.progid"]);t.push("','");t.push(o.DefaultItemOpen);t.push("','");t.push(i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);t.push("','");t.push(i.HTML_x0020_File_x0020_Type);t.push("','");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?t.push(Encoding.ScriptEncode(i["serverurl.progid"])):t.push(i["serverurl.progid"]);t.push("');");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(226)||t.push("return false;");t.push('" onclick="');be(t,i,"Navigation");t.push("return HandleFolder(this,event,'");t.push(o.PagePath);t.push("?RootFolder=");t.push(URI_Encoding.encodeURIComponent(i.FileRef));t.push(o.ShowWebPart);t.push("&FolderCTID=");t.push(i.ContentTypeId);t.push("&View=");t.push(URI_Encoding.encodeURIComponent(o.View));B(i,t);var a=ListModule.Util.makeMountedFolderQueryStrParams(!0,!0);Boolean(a)&&t.push(a);t.push("','TRUE','FALSE','");t.push(i["File_x0020_Type.url"]);t.push("','");t.push(i["File_x0020_Type.progid"]);t.push("','");t.push(o.DefaultItemOpen);t.push("','");t.push(i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);t.push("','");t.push(i.HTML_x0020_File_x0020_Type);t.push("','");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?t.push(Encoding.ScriptEncode(i["serverurl.progid"])):t.push(i["serverurl.progid"]);t.push("','");t.push(Boolean(i.CheckoutUser)?i.CheckoutUser[0].id:"");t.push("','");t.push(o.Userid);t.push("','");t.push(o.ForceCheckout);t.push("','");t.push(i.IsCheckedoutToLocal);t.push("','");t.push(i.PermMask);if(ListModule.Settings.SupportsDoclibAccessibility){t.push('\');" aria-label="');t.push(Encoding.HtmlEncode(r));t.push(", "+Encoding.HtmlEncode(k(i["File_x0020_Type.mapapp"],!0))+'">')}else t.push("');\">");t.push(Encoding.HtmlEncode(r));t.push("</a>")}function q(e){this.fldName=e}function R(e,t,n,r){return Encoding.HtmlEncode(n[this.fldName])}function U(e){this.fldName=e}function z(e,t,n,r){return n[this.fldName]}function W(e){this.fldName=e}function X(e,t,r,i){return"0"!=r[this.fldName]?'<img border="0" width="16" height="16" src="'+n.JsGridUtil.Internal.GetImageUrl("attach16.png")+'"/>':""}function V(e){this.fldName=e}function $(e,t,n,r){var i=n[this.fldName],s='<img border="0" width="16" height="16" src="';s+=ListView.ImageBasePath;s+="/_layouts/15/images/";if("1"==i){var o=n.EventType;s+="3"==o||"4"==o?"recurEx.gif":"recur.gif"}else s+="blank.gif";s+='" alt="';s+=window.ListView.Strings.L_SPMeetingWorkSpace;s+='" title="';s+=window.ListView.Strings.L_SPMeetingWorkSpace;return s+='"/>'}function J(e){this.fldName=e}function K(e,t,r,i){if("1"!=r.WorkspaceLink&&"-1"!=r.WorkspaceLink)return'<img border="0" width="16" height="16" src="'+ListView.ImageBasePath+'/_layouts/15/images/blank.gif" />';var s='<a href="';s+=r.Workspace;s+='" target="_self" title="';s+=window.ListView.Strings.L_SPMeetingWorkSpace;s+='"><img border="" src="'+n.JsGridUtil.Internal.GetImageUrl("mtgicon.gif")+'" alt="';s+=window.ListView.Strings.L_SPMeetingWorkSpace;return s+='"/></a>'}function Q(e){this.fldName=e}function G(e,t,n,r){return n[this.fldName]==window.ListView.Strings.L_SPYes?window.ListView.Strings.L_SPYes:""}function Y(e){this.fldName=e}function Z(e){!ListModule.Util.isDefinedAndNotNullOrEmpty(e)||-1==e.indexOf("<")&&-1==e.indexOf(">")||WriteEngagementLog("CalculatedFieldHasScript",{script:e})}function ee(e,t,r,i){var o=r[this.fldName];if(null!=window.OffSwitch&&!OffSwitch.IsActive("856528C6-8452-44E4-A756-32C6E13004E3")&&"Calculated"==t.FieldType)if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(68)||Boolean(_spPageContextInfo)&&Boolean(_spPageContextInfo.AllowCustomMarkupInCalculatedField))o=Encoding.HtmlEncode(o);else if(!t.scriptLogged){t.scriptLogged=!0;Z(o)}return'<div align="right" class="ms-number'+(n.JsGridUtil.Internal.IsFeatureEnabled(d)&&e.fixedHeightRowEnabled?" "+s.cellHiddenOverflow:"")+'">'+o+"</div>"}function te(e){this.fldName=e}function ne(e,t,n,r){var i=e.CurrentFieldSchema,s=n[this.fldName];""==s&&(s=window.ListView.Strings.L_BusinessDataField_Blank);var o='<table cellpadding="0" cellspacing="0" style="display=inline">';o+="<tr>";if(Boolean(i.HasActions)){o+='<td><input type="hidden" name="BusinessDataField_ActionsMenuProxyPageWebUrl" id="BusinessDataField_ActionsMenuProxyPageWebUrl" value="'+e.HttpRoot+'" />';o+='<div style="display=inline">';o+='<table cellspacing="0">';o+="<tr>";o+='<td class="ms-vb" valign="top" nowrap="nowrap">';o+='<span class="ms-SPLink ms-hovercellinactive" onmouseover="this.className=\'ms-SPLink ms-HoverCellActive\';" onmouseout="this.className=\'ms-SPLink ms-HoverCellInactive\';">';var u="",a="",f="";if(Boolean(e.ExternalDataList)){u="showActionMenuInExternalList("+(f="'"+window.ListView.Strings.L_BusinessDataField_ActionMenuLoadingMessage+"',null,true,'"+e.LobSystemInstanceName+"','"+e.EntityNamespace+"','"+e.EntityName+"','"+e.SpecificFinderName+"','"+i.AssociationName+"','"+i.SystemInstanceName+"','"+i.EntityNamespace+"','"+i.EntityName+"','"+n.ID+"', event")+")";a="actionMenuOnKeyDownInExternalList("+f+")"}else if(void 0!==t.RelatedField&&""!=t.RelatedField&&void 0!==n[t.RelatedField]&&""!=n[t.RelatedField]){u="showActionMenu("+(f="'"+window.ListView.Strings.L_BusinessDataField_ActionMenuLoadingMessage+"',null,true,'"+i.SystemInstanceName+"','"+i.EntityNamespace+"','"+i.EntityName+"','"+n[t.RelatedField]+"', event")+")";a="actionMenuOnKeyDown("+f+")"}o+='<a style="cursor:hand;white-space:nowrap;">';o+='<img border="0" align="absmiddle" src='+ListView.ImageBasePath+'/_layouts/15/images/bizdataactionicon.gif?rev=47 tabindex="0" alt="'+window.ListView.Strings.L_BusinessDataField_ActionMenuAltText+'" title="'+window.ListView.Strings.L_BusinessDataField_ActionMenuAltText+'"';o+=' onclick="'+u+'"';o+=' onkeydown="'+a+'" />';o+="</a>";o+="<a>";o+='<img align="absmiddle" src='+ListView.ImageBasePath+'/_layouts/15/images/menudark.gif?rev=47 tabindex="0" alt="'+window.ListView.Strings.L_BusinessDataField_ActionMenuAltText+'"';o+=' onclick="'+u+'"';o+=' onkeydown="'+a+'" />';o+="</a>";o+="</span>";o+="</td>";o+="</tr>";o+="</table>";o+="</div>";o+='<div STYLE="display=inline" />';o+="</td>"}o+='<td class="ms-vb">';""!=i.Profile&&"True"==i.ContainsDefaultAction?o+='<a href="'+e.HttpRoot+i.Profile+n[t.RelatedField]+'" >'+s+"</a>":o+=s;o+="</td>";o+="</tr>";return o+="</table>"}function re(e){this.fldName=e}function ie(e,t,n,r){var i=n[this.fldName];if(null!=window.OffSwitch&&!OffSwitch.IsActive("856528C6-8452-44E4-A756-32C6E13004E3")&&"Calculated"==t.FieldType)if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(68))i=Encoding.HtmlEncode(i);else if(!t.scriptLogged){t.scriptLogged=!0;Z(i)}if(null==i)return"";var s=n[this.fldName+".FriendlyDisplay"],o=null;null!=s&&""!=s&&(o=(function(e){var t=null,n=null,r=e.split("|"),i=Boolean(window.ListView)&&Boolean(window.ListView.Strings)?window.ListView.Strings:Strings.STS;if("0"==r[0])return e.substring(2);var s="1"==r[1],o=r[2],u=r.length>=4?r[3]:null,a=r.length>=5?r[4]:null;switch(o){case"1":t=s?i.L_RelativeDateTime_AFewSecondsFuture:i.L_RelativeDateTime_AFewSeconds;break;case"2":t=s?i.L_RelativeDateTime_AboutAMinuteFuture:i.L_RelativeDateTime_AboutAMinute;break;case"3":n=w(s?i.L_RelativeDateTime_XMinutesFuture:i.L_RelativeDateTime_XMinutes,s?i.L_RelativeDateTime_XMinutesFutureIntervals:i.L_RelativeDateTime_XMinutesIntervals,Number(u));break;case"4":t=s?i.L_RelativeDateTime_AboutAnHourFuture:i.L_RelativeDateTime_AboutAnHour;break;case"5":null==u?t=s?i.L_RelativeDateTime_Tomorrow:i.L_RelativeDateTime_Yesterday:n=s?i.L_RelativeDateTime_TomorrowAndTime:i.L_RelativeDateTime_YesterdayAndTime;break;case"6":n=w(s?i.L_RelativeDateTime_XHoursFuture:i.L_RelativeDateTime_XHours,s?i.L_RelativeDateTime_XHoursFutureIntervals:i.L_RelativeDateTime_XHoursIntervals,Number(u));break;case"7":null==a?t=u:n=i.L_RelativeDateTime_DayAndTime;break;case"8":n=w(s?i.L_RelativeDateTime_XDaysFuture:i.L_RelativeDateTime_XDays,s?i.L_RelativeDateTime_XDaysFutureIntervals:i.L_RelativeDateTime_XDaysIntervals,Number(u));break;case"9":t=i.L_RelativeDateTime_Today}if(null!=n){t=n.replace("{0}",u);null!=a&&(t=t.replace("{1}",a))}return t})(s));var u='<span class="ms-noWrap" title="'+i+'">';u+=null!=o&&""!=o?o:i;return u+="</span>"}function se(e){this.fldName=e}function oe(e,t,n,r){return null!=t.AutoHyperLink?n[this.fldName]:Encoding.HtmlEncode(n[this.fldName])}function ue(e){this.fldName=e}function ae(e,t,n,r){var i=n[this.fldName];if(!Boolean(i))return"";if("string"==typeof i)return Encoding.HtmlEncode(i);if(null!=t.RenderAsText)return(function(e){if(!Boolean(e))return"";s=[];for(o=0;o<e.length;o++){o>0&&s.push("; ");s.push(Encoding.HtmlEncode(e[o].lookupValue))}return s.join("")})(i);if(!Boolean(t.DispFormUrl))return"";for(var s=[],o=0;o<i.length;o++){o>0&&s.push("; ");var u=[];null==window.OffSwitch||OffSwitch.IsActive("9A1172B1-4735-4132-B0A3-8CD8CFF199E8")?u.push(Encoding.ScriptEncode(t.DispFormUrl)):u.push(t.DispFormUrl);u.push("&ID=");u.push(i[o].lookupId.toString());u.push("&RootFolder=*");var a=u.join("");s.push("<a ");s.push("onclick=\"OpenPopUpPage('");null==window.OffSwitch||OffSwitch.IsActive("9A1172B1-4735-4132-B0A3-8CD8CFF199E8")?s.push(a):s.push(Encoding.ScriptEncode(a));s.push("', RefreshPage); return false;\" ");s.push('href="');null==window.OffSwitch||OffSwitch.IsActive("9A1172B1-4735-4132-B0A3-8CD8CFF199E8")?s.push(a):s.push(D(a,void 0));s.push('">');s.push(Encoding.HtmlEncode(i[o].lookupValue));s.push("</a>")}return s.join("")}function fe(e){this.fldName=e}function le(e,t,r,i){var o,u,a=[],f=h||"Note"!==t.Type||"FALSE"!==t.RichText?r[this.fldName]:n.JsGridUtil.Internal.Encoding_STSHtmlDecode(r[this.fldName]);if(n.JsGridUtil.Internal.IsFeatureEnabled(d)&&e.fixedHeightRowEnabled){u=" "+s.cellHiddenOverflow;if(p){var l=document.createElement("div");l.innerHTML=f;o=l.textContent||l.innerText||f}else if("Note"===t.Type&&"FALSE"===t.RichText)o=f.replace(/<br>/g," ");else if("Note"===t.Type&&"TRUE"===t.RichText){o=n.JsGridUtil.Internal.Encoding_STSHtmlDecode(f).replace(/(<\s*\/?\s*(div|br|p|ul|li|blockquote)\s*.*?>)|(font-size\s*.*?pt;)/g," ")}else o=f}else{u="";o=f}a.push('<div dir="');a.push(t.Direction);a.push('" class="ms-rtestate-field'+u+'">');a.push(o);a.push("</div>");return a.join("")}function ce(e){this.fldName=e}function he(e,t,n,r){var i,s=n[this.fldName];s.DisplayName?i=s.DisplayName:s.Address&&s.Address.Street&&(i=s.Address.Street);return Encoding.HtmlEncode(i)}function pe(e){this.fldName=e}function de(e,t,n,r){return P(n,this.fldName,0,t,!1)}function ve(e){this.fldName=e}function me(e,t){void 0!==t.piCD&&""!=t.piCD&&void 0===e.piCD&&(e.piCD=t.piCD);void 0!==t.piPC&&""!=t.piPC&&void 0===e.piPC&&(e.piPC=t.piPC)}function ge(e,t,n,r){var i=n[this.fldName];if("string"==typeof i&&(""==i||"***"==i))return i;var s=[],o=t.DefaultRender&&t.AllowMultipleValues;if(o&&t.InlineRender){for(var u=[],a=0;a<i.length;a++){var f=i[a];me(f,n);u.push(void 0)}if(1===u.length)s.push(u[0]);else if(2===u.length)s.push(StringUtil.BuildParam(Encoding.HtmlEncode(window.ListView.Strings.L_UserFieldInlineTwo),u[0],u[1]));else if(3===u.length)s.push(StringUtil.BuildParam(Encoding.HtmlEncode(window.ListView.Strings.L_UserFieldInlineThree),u[0],u[1],u[2]));else{var l="",c="";if(Boolean(t.InlineRenderMoreAsLink)){l='<a href="#" onclick="return false;" class="ms-imnMoreLink ms-link">';c="</a>"}var h=u.length-3;s.push(StringUtil.BuildParam(Encoding.HtmlEncode(window.ListView.Strings.L_UserFieldInlineMore),u[0],u[1],u[2],l,String(h),c))}}else{o&&s.push("<table style='padding:0px; border-spacing:0px; border:none'><tr><td class='ms-vb'>");var p=!0;for(var d in i){p?p=!1:t.AllowMultipleValues&&(o?s.push("</td></tr><tr><td class='ms-vb'>"):t.WithPicture||t.WithPictureDetail||t.PictureOnly||s.push("; "));var v=i[d];me(v,n);s.push(void 0)}o&&s.push("</td></tr></table>")}return s.join("")}function ye(){this.NewGroup=function(e,t){return"1"==e[t]};function e(e,t,n,r){if(void 0===t.FieldRenderer){var i={Computed:new O(t.Name),Attachments:new W(t.Name),User:new ve(t.Name),UserMulti:new ve(t.Name),URL:new pe(t.Name),Note:new fe(t.Name),Recurrence:new V(t.Name),CrossProjectLink:new J(t.Name),AllDayEvent:new Q(t.Name),Number:new Y(t.Name),BusinessData:new te(t.Name),Currency:new Y(t.Name),DateTime:new re(t.Name),Text:new se(t.Name),Lookup:new ue(t.Name),LookupMulti:new ue(t.Name),WorkflowStatus:new U(t.Name),Location:void 0};null==window.OffSwitch||OffSwitch.IsActive("39A8E192-9EFC-4922-9FD8-343D685E163C")||(i.Location=new ce(t.Name));if("1"==t.XSLRender)t.FieldRenderer=new U(t.Name);else{t.FieldRenderer=i[t.FieldType];null==t.FieldRenderer&&(t.FieldRenderer=i[t.Type])}null==t.FieldRenderer&&(t.FieldRenderer=new q(t.Name))}return t.FieldRenderer.RenderField(e,t,n,r)}this.RenderField=function(r,i,o,u){if(void 0===i.fieldRenderer){var a,f,l=r.Templates.Fields,h=i.Name;null!=l[h]&&(a=l[h]);null!=a&&""!=a&&a!=N?"string"==typeof a?f=t.SPClientRenderer.ParseTemplateString(a,r):"function"==typeof a&&(f=a):f=e;i.fieldRenderer=f}r.CurrentFieldSchema=i;var p=i.fieldRenderer(r,i,o,u);r.CurrentFieldSchema=null;if(null!=i.Direction){var g=[];g.push('<span dir="');g.push(i.Direction);g.push('">');g.push(p);g.push("</span>");p=g.join("")}if(null!=i.linkToItem){g=[];"1"==o.FSObjType?"1"==u.IsDocLib?I(0,g,p,o,u):F(g,p,o,u):C(g,r,o,u,A(o[i.Name]),!0);p=g.join("")}u.UseParentHierarchy&&u.ParentHierarchyDisplayField==i.Name&&(p=(function(e,t,r,i,s){if(e.inGridMode)return s;var o=e.ListData.HierarchyHasIndention?22:0,u=e.ListData.HierarchyHasIndention?13:0,a=[],f=e.ctxId+","+r.ID+","+r.FSObjType,l="idExpandCollapse"+f;a.push('<span style="');r.isParent&&a.push("font-weight: bold;");a.push("float: ");a.push(DOM.rightToLeft?"right":"left");a.push("; margin-");a.push(DOM.rightToLeft?"right":"left");a.push(":");var c=parseInt(r.outlineLevel);if(c<=1)h=r.isParent?0:u;else{var h=(c-1)*o;r.isParent||(h+=u)}a.push(h);a.push('px">');a.push("<table><tr>");if(r.isParent){a.push('<td style="vertical-align: top;"><span id="');a.push(l);a.push('" class="ms-commentcollapse'+(DOM.rightToLeft?"rtl":"")+'-iconouter"><img src="');a.push(n.JsGridUtil.Internal.GetImageUrl("spcommon.png"));a.push('" class="ms-commentcollapse'+(DOM.rightToLeft?"rtl":"")+'-icon"/></span></td>')}a.push("<td>");a.push(s);a.push("</td></tr></table></span>");function p(){var t=e.hierarchyMgr;null==t&&(t=e.hierarchyMgr=m(e.wpq,DOM.rightToLeft));if(r.isParent){var i=document.getElementById(l);null!=i&&$addHandler(i,"click",v);EnsureScriptFunc("core.js","GetAncestorByTagNames",function(){var e=n.JsGridUtil.Internal.DomElement.GetInstance().GetAncestorByTag(i,"TR");null!=e&&(e.style.fontWeight="bold")})}t.RegisterHierarchyNode(parseInt(r.ID),null==r.parentID?null:parseInt(r.parentID),f,l)}b(e,function(){setTimeout(p,0)});return a.join("")})(r,0,o,0,p));var y=o["CustomData."];null!=y&&void 0!==y&&0!=Boolean(y)||(null!=i.CalloutMenu?p=(function(e,t,r,i,o){var u=[],a="ctx"+e.ctxId+"_"+t.ID+"_calloutLaunchPoint",f=e.ListSchema,l=n.JsGridUtil.Internal.IsFeatureEnabled(d)&&e.fixedHeightRowEnabled?" "+s.cellHiddenOverflow:"";u.push('<div class="ms-vb '+(1==o?"":"ms-tableCell ms-list-TitleLink")+l+' itx" CTXName="ctx');u.push(e.ctxId);u.push('" id="');u.push(t.ID);if(!OffSwitch.IsActive("18AE54C9-EB03-45F3-8768-DFB1CC034209")&&t.PermMask){u.push('" Perm="');u.push(t.PermMask)}u.push('" App="');u.push(t["File_x0020_Type.mapapp"]);u.push('">');u.push(i);u.push("</div>");if(1==o){u.push('</td><td class="ms-list-itemLink-td ms-cellstyle');f.Field[f.Field.length-1]==r&&u.push(" ms-vb-lastCell");u.push('" role="gridcell">')}if(!PageMinimized())if(void 0!==t.RenderCalloutWithoutHover&&t.RenderCalloutWithoutHover)u.push(we(!1,t,a,!0));else{u.push('<div class="ms-list-itemLink '+(1==o?"":"ms-tableCell ms-alignRight")+' " ');u.push(' onclick="ShowMenuForTrOuter(this,event, true); return false;" >');u.push(we(!0,t,a,!1));u.push("</div>")}return u.join("")})(r,o,i,p,T(r)):null!=i.listItemMenu&&(p=c(r,o,i,p,T(r))));return p}}function be(e,t,n){if(void 0!==t.piCD&&""!=t.piCD){if(void 0!==t.piPC&&""!=t.piPC){e.push("RecordClickForPaging('"+Encoding.HtmlEncode(n)+"','");e.push(Encoding.HtmlEncode(t.piCD));e.push("','");e.push(Encoding.HtmlEncode(t.piPC))}else{e.push("RecordClick('Navigation','");e.push(Encoding.HtmlEncode(t.piCD))}e.push("');")}}function we(e,t,r,i){var s=[],o=Boolean(i),u="ms-lstItmLinkAnchor "+(o?"ms-ellipsis-a-tile":"ms-ellipsis-a");s.push('<a ms-jsgrid-click-passthrough="true" class="'+u+'" title="');s.push(Encoding.HtmlEncode(window.ListView.Strings.L_OpenMenuAriaLabel));s.push('" aria-haspopup="true" aria-expanded="false"');s.push('onclick="');i||be(s,t,"Hover");e?s.push("OpenCalloutAndSelectItem(this, event, this, '"+t.ID+'\'); return false;" href="#" id="'+r+'" >'):s.push("OpenCallout(this, event, this, '"+t.ID+'\'); return false;" href="#" id="'+r+'" >');var a=o?"ms-ellipsis-icon-tile":"ms-ellipsis-icon";s.push('<img class="'+a+'" src="'+n.JsGridUtil.Internal.GetImageUrl("spcommon.png")+'" alt="'+Encoding.HtmlEncode(window.ListView.Strings.L_OpenMenu)+'" /></a>');return s.join("")}});
define("aPM",["require","exports","aQo"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.globalInit=function(){window.RegisterModuleInit=_;window.commonShowModalDialog=I;window.ExecuteAndRegisterBeginEndFunctions=O;window.ExecuteOrDelayUntilScriptLoaded=H;window.currentCtx=null;window._dlgWndTop=F;window.ctx=void 0;window.setInnerText=U;window.GetImageUrlWithRevision=z;window.IsFullNameDefined=X;void 0===window.g_all_modules&&(window.g_all_modules={});window.g_all_modules["init.js"]={version:{rmj:16,rmm:0,rup:19506,rpr:12e3}};void 0===r&&((r={__namespace:!0}).IsActive=function(e){var t=window.g_SPOffSwitches,n=null;if(null==t){var r=window._spPageContextInfo;n=null==r?null:r.killSwitches;t=n}null==t||t.hasOwnProperty("C1AF433B-A979-4DD9-8C60-56024438168A")||e&&(e=e.toUpperCase().replace(/[{}]/g,""));return null!=t&&t.hasOwnProperty(e)});window.OffSwitch=r;if(void 0===i){i={__namespace:!0};(function(){i.MismatchError=function(e,t,n){Error.call(this,n);this.expected=e;this.actual=t};i.MismatchError.prototype=new Error;i.ArgumentTypeError=function(e,t){i.MismatchError.call(this,e,t,"runtime type mismatch")};i.ArgumentTypeError.prototype=new i.MismatchError})()}void 0===s&&(s={__namespace:!0});void 0===o&&(o={__namespace:!0});void 0===u&&(u={__namespace:!0});(function(){t.prototype={firefox:void 0,firefox36up:void 0,firefox3up:void 0,firefox4up:void 0,ie:void 0,ie55up:void 0,ie5up:void 0,ie7down:void 0,ie8down:void 0,ie8standard:void 0,ie8standardUp:void 0,ie9down:void 0,ie9standardUp:void 0,ipad:void 0,windowsphone:void 0,chrome:void 0,chrome7up:void 0,chrome8up:void 0,chrome9up:void 0,iever:void 0,mac:void 0,major:void 0,msTouch:void 0,isTouch:void 0,nav:void 0,nav6:void 0,nav6up:void 0,nav7up:void 0,osver:void 0,safari:void 0,safari125up:void 0,safari3up:void 0,verIEFull:void 0,w3c:void 0,webKit:void 0,win:void 0,win8AppHost:void 0,win32:void 0,win64bit:void 0,winnt:void 0,armProcessor:void 0};e.prototype=t.prototype;e.prototype.ie10standardUp=void 0;e.prototype.ie11=void 0;e.prototype.ie11up=void 0;e.prototype.msEdge=void 0;function e(){var e,t=navigator.userAgent.toLowerCase();this.osver=1;if(Boolean(t)){var n=t.substring(t.indexOf("windows ")+11);this.osver=parseFloat(n)}this.major=parseInt(navigator.appVersion);this.msEdge=-1!=t.indexOf("edge/");var r=t.indexOf("msie"),i=t.indexOf("trident");this.ie=-1!=r||-1!=i;var s="0";if(this.ie)if(-1!=r)s=t.substring(r+5);else{var o=t.indexOf("rv:");-1!=o&&(s=t.substring(o+3))}this.iever=parseInt(s);this.verIEFull=parseFloat(s);this.ie4up=this.ie&&this.major>=4;this.ie5up=this.ie&&this.iever>=5;this.ie55up=this.ie&&this.verIEFull>=5.5;this.ie6up=this.ie&&this.iever>=6;this.ie7down=this.ie&&this.iever<=7;this.ie8down=this.ie&&this.iever<=8;this.ie9down=this.ie&&this.iever<=9;this.ie7up=this.ie&&this.iever>=7;this.ie8standard=this.ie&&Boolean(document.documentMode)&&8==document.documentMode;this.ie8standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=8;this.ie9standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=9;this.ie10standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=10;this.ie11=this.ie&&Boolean(document.documentMode)&&11==document.documentMode;this.ie11up=this.ie&&Boolean(document.documentMode)&&document.documentMode>=11;this.nav=-1!=t.indexOf("mozilla")&&-1==t.indexOf("spoofer")&&-1==t.indexOf("compatible")&&!this.ie;this.nav6=this.nav&&5==this.major;this.nav6up=this.nav&&this.major>=5;this.nav7up=!1;this.nav6up&&(e=t.indexOf("netscape/"))>=0&&(this.nav7up=parseInt(t.substring(e+9))>=7);this.winnt=-1!=t.indexOf("winnt")||-1!=t.indexOf("windows nt");this.win32=this.major>=4&&"Win32"==navigator.platform||-1!=t.indexOf("win32")||-1!=t.indexOf("32bit");this.win64bit=-1!=t.indexOf("win64");this.win=this.winnt||this.win32||this.win64bit;this.safari=-1!=t.indexOf("webkit")&&!this.ie&&!this.msEdge;this.safari125up=!1;this.safari3up=!1;if(this.safari&&this.major>=5){(e=t.indexOf("webkit/"))>=0&&(this.safari125up=parseInt(t.substring(e+7))>=125);var u=t.indexOf("version/");u>=0&&(this.safari3up=parseInt(t.substring(u+8))>=3)}this.firefox=this.nav&&-1!=t.indexOf("firefox");this.firefox3up=!1;this.firefox36up=!1;this.firefox4up=!1;if(this.firefox&&this.major>=5){var a=t.indexOf("firefox/");if(a>=0){var f=t.substring(a+8);this.firefox3up=parseInt(f)>=3;this.firefox36up=parseFloat(f)>=3.6;this.firefox4up=parseInt(f)>=4}}this.chrome=this.nav&&-1!=t.indexOf("chrome")&&!this.ie&&!this.msEdge;this.chrome7up=!1;this.chrome8up=!1;this.chrome9up=!1;if(this.chrome&&this.major>=5){var l=t.indexOf("chrome/");if(l>=0){var c=t.substring(l+7),h=parseInt(c);this.chrome7up=h>=7;this.chrome8up=h>=8;this.chrome9up=h>=9}}this.ipad=-1!=t.indexOf("ipad");this.windowsphone=-1!=t.indexOf("windows phone");this.aol=this.ie&&-1!=t.indexOf(" aol ");this.mac=-1!=t.indexOf("mac");this.w3c=this.nav6up;this.webKit=-1!=t.indexOf("webkit")&&!this.ie&&!this.msEdge;this.win8AppHost=-1!=t.indexOf("msapphost");this.msTouch=void 0!==navigator.msMaxTouchPoints&&navigator.msMaxTouchPoints>0;this.isTouch=this.msTouch||"ontouchstart"in document.documentElement;this.armProcessor=-1!=t.indexOf("arm")}function t(){var e,t=navigator.userAgent.toLowerCase();this.osver=1;if(Boolean(t)){var n=t.substring(t.indexOf("windows ")+11);this.osver=parseFloat(n)}this.major=parseInt(navigator.appVersion);this.nav=-1!=t.indexOf("mozilla")&&-1==t.indexOf("spoofer")&&-1==t.indexOf("compatible");this.nav6=this.nav&&5==this.major;this.nav6up=this.nav&&this.major>=5;this.nav7up=!1;this.nav6up&&(e=t.indexOf("netscape/"))>=0&&(this.nav7up=parseInt(t.substring(e+9))>=7);this.ie=-1!=t.indexOf("msie");this.ipad=-1!=t.indexOf("ipad");this.windowsphone=-1!=t.indexOf("windows phone");this.aol=this.ie&&-1!=t.indexOf(" aol ");if(this.ie){var r=t.substring(t.indexOf("msie ")+5);this.iever=parseInt(r);this.verIEFull=parseFloat(r)}else this.iever=0;this.ie4up=this.ie&&this.major>=4;this.ie5up=this.ie&&this.iever>=5;this.ie55up=this.ie&&this.verIEFull>=5.5;this.ie6up=this.ie&&this.iever>=6;this.ie7down=this.ie&&this.iever<=7;this.ie8down=this.ie&&this.iever<=8;this.ie9down=this.ie&&this.iever<=9;this.ie7up=this.ie&&this.iever>=7;this.ie8standard=this.ie&&Boolean(document.documentMode)&&8==document.documentMode;this.ie8standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=8;this.ie9standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=9;this.ie10standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=10;this.winnt=-1!=t.indexOf("winnt")||-1!=t.indexOf("windows nt");this.win32=this.major>=4&&"Win32"==navigator.platform||-1!=t.indexOf("win32")||-1!=t.indexOf("32bit");this.win64bit=-1!=t.indexOf("win64");this.win=this.winnt||this.win32||this.win64bit;this.mac=-1!=t.indexOf("mac");this.w3c=this.nav6up;this.webKit=-1!=t.indexOf("webkit");this.safari=-1!=t.indexOf("webkit");this.safari125up=!1;this.safari3up=!1;if(this.safari&&this.major>=5){(e=t.indexOf("webkit/"))>=0&&(this.safari125up=parseInt(t.substring(e+7))>=125);var i=t.indexOf("version/");i>=0&&(this.safari3up=parseInt(t.substring(i+8))>=3)}this.firefox=this.nav&&-1!=t.indexOf("firefox");this.firefox3up=!1;this.firefox36up=!1;this.firefox4up=!1;if(this.firefox&&this.major>=5){var s=t.indexOf("firefox/");if(s>=0){var o=t.substring(s+8);this.firefox3up=parseInt(o)>=3;this.firefox36up=parseFloat(o)>=3.6;this.firefox4up=parseInt(o)>=4}}this.win8AppHost=-1!=t.indexOf("msapphost");this.chrome=this.nav&&-1!=t.indexOf("chrome");this.chrome7up=!1;this.chrome8up=!1;this.chrome9up=!1;if(this.chrome&&this.major>=5){var u=t.indexOf("chrome/");if(u>=0){var a=t.substring(u+7),f=parseInt(a);this.chrome7up=f>=7;this.chrome8up=f>=8;this.chrome9up=f>=9}}this.msTouch=void 0!==navigator.msMaxTouchPoints&&navigator.msMaxTouchPoints>0;this.isTouch=this.msTouch||"ontouchstart"in document.documentElement;this.armProcessor=-1!=t.indexOf("arm")}"undefined"!=typeof _browserisFlight?u.userAgent=new e:u.userAgent=new t})();void 0===a&&(a={__namespace:!0});if(void 0===f){f={__namespace:!0};(function(){f.rightToLeft="rtl"==document.documentElement.dir;f.GetElementsByName=function(e){var t;0==(t=document.getElementsByName(e)).length&&Boolean(XMLHttpRequest)&&(t=(function(e,t){var n,r=[],i=e.getElementById(t);for(;null!=i;){r.push(i);i.id="";i=e.getElementById(t)}for(n=0;n<r.length;n++)r[n].id=t;return r})(document,e));return t}})()}if(void 0===l){l={__namespace:!0};(function(){l.HtmlEncode=function(e){if(null==e)return"";var t=new String(e),n=[],r=0,i=t.length;for(r=0;r<i;r++){var s=t.charAt(r);switch(s){case"<":n.push("&lt;");break;case">":n.push("&gt;");break;case"&":n.push("&amp;");break;case'"':n.push("&quot;");break;case"'":n.push("&#39;");break;default:n.push(s)}}return n.join("")};l.HtmlEncodeEx=function(e){if(null==e)return"";var t=new String(e),n=[],r=0,i=t.length;for(r=0;r<i;r++){var s=t.charAt(r);switch(s){case"<":n.push("&lt;");break;case">":n.push("&gt;");break;case"&":n.push("&amp;");break;case'"':n.push("&quot;");break;case"'":n.push("&#39;");break;case"#":n.push("%23");break;case"%":n.push("%25");break;default:n.push(s)}}return n.join("")};l.ScriptEncode=function(e){if(null==e||void 0===e)return"";var t=new String(e),n=[],r=0,i=t.length;for(r=0;r<i;r++){var s=t.charCodeAt(r);if(s>4095)n.push("\\u"+s.toString(16).toUpperCase());else if(s>255)n.push("\\u0"+s.toString(16).toUpperCase());else if(s>127)n.push("\\u00"+s.toString(16).toUpperCase());else{var o=t.charAt(r);switch(o){case"\n":n.push("\\n");break;case"\r":n.push("\\r");break;case'"':n.push("\\u0022");break;case"%":n.push("\\u0025");break;case"&":n.push("\\u0026");break;case"'":n.push("\\u0027");break;case"(":n.push("\\u0028");break;case")":n.push("\\u0029");break;case"+":n.push("\\u002b");break;case"/":n.push("\\u002f");break;case"<":n.push("\\u003c");break;case">":n.push("\\u003e");break;case"\\":n.push("\\\\");break;default:n.push(o)}}}return n.join("")}})()}window.Encoding=l;void 0===c&&(c={__namespace:!0});if(void 0===h){h={__namespace:!0};(function(){h.arrayIndexOf=function(e,t,n){if(void 0!==Array.prototype.indexOf)return e.indexOf(t,n);if(void 0===t)return-1;var r=e.length;if(0!==r){n-=0;if(isNaN(n))n=0;else{isFinite(n)&&(n-=n%1);n<0&&(n=Math.max(0,r+n))}for(var i=n;i<r;i++)if(void 0!==e[i]&&e[i]===t)return i}return-1};h.attachDOMContentLoaded=function(e){void 0===document.addEventListener?document.onreadystatechange=function(){"complete"==document.readyState&&e()}:document.addEventListener("DOMContentLoaded",e,!1)}})()}void 0===p&&(p={__namespace:!0});void 0===d&&(d={__namespace:!0});v=function(e,t){var n=this,r=!1;void 0!==t&&"boolean"==typeof t.queryCaseInsensitive&&(r=t.queryCaseInsensitive);var i=!1;void 0!==t&&"boolean"==typeof t.disableEncodingDecodingForLegacyCode&&(i=t.disableEncodingDecodingForLegacyCode);var s="",o="",u={};this.setQuery=function(e){var t=a(e);n.setQueryFromObject(t)};this.getQueryAsObject=function(){return u};this.setQueryFromObject=function(e){u={};for(var t in e)e.hasOwnProperty(t)&&n.setQueryParameter(t,e[t])};this.getQueryParameter=function(e){var t=null,i=n.getQueryAsObject();if(r)for(var s in i)u.hasOwnProperty(s)&&s.toLowerCase()===e.toLowerCase()&&(t=i[s]);else t=i[e];return void 0!==t?t:null};this.setQueryParameter=function(e,t){var n=p(e),r=p(t);u[n]=r};var a=function(e){var t={};0===e.indexOf("?")&&(e=e.substring(1));for(var n=e.split(/[;&]+/),r=0;r<n.length;r++){var i=n[r].split("=");if(i.length>0){var s=i[0];if(s.length>0){var o="";2==i.length&&(o=i[1]);t[s]=o}}}return t},f=function(e){o=e;var t=e.lastIndexOf("@");t>=0&&(o=o.substring(t+1));var n=o.indexOf(":");if(!(t<0&&n<0)){var r=e;if(t<0)o=r;else{s=r.substring(0,t);o=r.substring(t+1)}n>=0&&(o=o.substring(0,n));s=p(s);o=p(o)}},l=function(e){for(var t=e.split("/"),n=0;n<t.length;++n){var r=t[n].split(";"),i=p(r[0]);t[n]=h(i);for(var s=1;s<r.length;++s){var o=p(r[s]);t[n]+=";"+h(o)}}},c=function(e,t){for(var n=0;n<e.length;n++)for(var r=e[n],i=0;i<t.length;i++)if(r===t[i])return n;return-1},h=function(e){return i?e:encodeURIComponent(e)},p=function(e){return i?e:v.decodeURIComponent(e)};(function(){var t=e,r=t.indexOf("#");if(r>=0){var i=t.substring(r+1);n.setFragment(i);t=t.substring(0,r)}var s=c(t,";/?:@&=$,");if(s>=0){var o=t.indexOf(":");o>=0&&o===s&&(t=t.substring(s+1));var u="",a=t.indexOf("//");if(a>=0&&0===a){t=t.substring(2);var h,p=c(t,"/?");if(p>=0){u=t.substring(0,p);t=t.substring(p);h=!1}else{u=t;h=!0}f(u);if(h)return}var d=t.indexOf("?");if(d>=0){n.setQuery(t.substring(d+1));t=t.substring(0,d)}l(t)}else l(t)})()};(function(){var e=[0,128,2048,65536,2097152,67108864,2147483648];function t(t){for(var n,r,i,s,o=0,u="";o<t.length;)if(t[o]<=127)u+=String.fromCharCode(t[o++]);else{r=t[o++];s=i=Boolean(32&r)?Boolean(16&r)?3:2:1;n=r&255>>>2+i;for(;Boolean(i)&&o<t.length;){--i;if(0==(r=t[o++]))return u;if(128!=(192&r)){u+="?";break}n=n<<6|63&r}if(Boolean(i)){u+="?";break}if(n<e[s]){u+="?";break}if(n<=65535)u+=String.fromCharCode(n);else if(n<=1114111){n-=65536;u+=String.fromCharCode(55296|n>>>10);u+=String.fromCharCode(56320|1023&n)}else u+="?"}return u}function n(e){var n=null;try{n=decodeURIComponent(e)}catch(r){n=(function(e){if(null==e)return"null";var n,r,i=0,s=0,o="",u=[],a=0;for(;i<e.length;)if("%"==e.charAt(i))if("u"==e.charAt(++i)){n="";for(s=0;s<4&&i<e.length;++s)n+=e.charAt(++i);for(;n.length<4;)n+="0";r=parseInt(n,16);isNaN(r)?o+="?":o+=String.fromCharCode(r)}else{n="";for(s=0;s<2&&i<e.length;++s)n+=e.charAt(i++);for(;n.length<2;)n+="0";r=parseInt(n,16);if(isNaN(r)){if(Boolean(a)){o+=t(u);a=0;u.length=a}o+="?"}else u[a++]=r}else{if(Boolean(a)){o+=t(u);a=0;u.length=a}o+=e.charAt(i++)}if(Boolean(a)){o+=t(u);a=0;u.length=a}return o})(e)}return n}v.decodeURIComponent=n;v.getAbsolute=function(e){var t=document.createElement("a");t.href=e;var n=t.href;t=null;return n};v.removeKeyValue=function(e,t){var n=new RegExp(e+"=[^&]*&");t=t.replace(n,"");n=new RegExp(e+"=[^&]*");return t=t.replace(n,"")};v.removeParameters=function(e){var t=e.indexOf("?");return-1==t?e:e.substr(0,t)};v.removeQueryParameter=function(e,t){var n=e.indexOf("?"),r=e.indexOf("#");if(-1==n)return e;-1==r&&(r=e.length);if(r<=n)return e;var i=e.substr(n,r-n),s=new RegExp("[&?]"+t+"=[^&]*","");(i=i.replace(s,"")).length>0&&"&"==i[0]&&(i="?"+i.substr(1));return e.substr(0,n)+i+e.substr(r)};v.completeDecode=function(e){if(void 0===e||null==e)return e;for(var t=e,r=n(t);t!=r;)r=n(t=r);return t};v.restructureFilterUrl=function(e,t){var n=t+1,r=e.match(new RegExp("FilterField"+String(n)+"=[^&]*")),i=!1;Boolean(r)||(i=null!=(r=e.match(new RegExp("FilterFields"+String(n)+"=[^&]*"))));for(var s=t;null!=r;s++){var o=i?"FilterFields"+String(s):"FilterField"+String(s),u=i?"FilterFields"+String(n):"FilterField"+String(n);e=e.replace(u,o);o=i?"FilterValues"+String(s):"FilterValue"+String(s);u=i?"FilterValues"+String(n):"FilterValue"+String(n);e=e.replace(u,o);o="FilterOp"+String(s);u="FilterOp"+String(n);e=e.replace(u,o);o="FilterLookupId"+String(s);u="FilterLookupId"+String(n);e=e.replace(u,o);o="FilterData"+String(s);u="FilterData"+String(n);n++;r=(e=e.replace(u,o)).match(new RegExp("FilterField"+String(n)+"=[^&]*"));Boolean(r)||(r=e.match(new RegExp("FilterFields"+String(n)+"=[^&]*")))}return e};v.parseMultiColumnValue=function(e,t,n){var r,i=[];null==t&&(t=";#");var s=t.charCodeAt(0),o=t.charCodeAt(1);if(null==e||0==e.length)return i;var u=t.charAt(0),a=new RegExp(u+u,"g"),f=t.charAt(0),l=0;if(e.substr(0,2)==t){Boolean(n)&&i.push("");l=2}for(var c=l,h=!1,p=e.length;c<p;){var d=e.indexOf(u,c);if(d>=0){c=d;c++;if(e.charCodeAt(c)==o){if(c-1>l){r=e.substr(l,c-l-1);h&&(r=r.replace(a,f));i.push(r);h=!1}else i.push("");l=++c;continue}if(e.charCodeAt(c)==s){c++;h=!0;continue}throw"ArgumentException"}c=p}if(c>l){r=e.substr(l,c-l);h&&(r=r.replace(a,f));i.push(r)}else Boolean(n)&&i.push("");return i};v.convertMultiColumnValueToString=function(e,t,n){null==t&&(t=";#");null==n&&(n=!0);for(var r=t.charAt(0),i=r+r,s=new RegExp(t.charAt(0),"g"),o=!1,u="",a=0;a<e.length;a++){var f=e[a];null!=f&&f.length>0&&(f=f.replace(s,i));null!=f&&f.length>0&&(o=!0);(n||0!=a)&&(u+=t);u+=f}if(o){n&&(u+=t);return u}return""}})();if(void 0===m){m={__namespace:!0};(function(){function e(e,t,n,r){var i="",s=0;if(void 0===e)return"";for(s=0;s<e.length;s++){var o=e.charCodeAt(s),u=e.charAt(s);if(t&&("#"==u||"?"==u)){i+=e.substr(s);break}if(n&&"&"==u)i+=u;else if(o<=127)r||o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||t&&o>=32&&o<=95&&" \"%<>'&".indexOf(u)<0?i+=u:o<=15?i+="%0"+o.toString(16).toUpperCase():o<=127&&(i+="%"+o.toString(16).toUpperCase());else if(o<=2047){i+="%"+(192|o>>6).toString(16).toUpperCase();i+="%"+(128|63&o).toString(16).toUpperCase()}else if(55296!=(64512&o)){i+="%"+(224|o>>12).toString(16).toUpperCase();i+="%"+(128|(4032&o)>>6).toString(16).toUpperCase();i+="%"+(128|63&o).toString(16).toUpperCase()}else if(s<e.length-1){o=(1023&o)<<10;s++;o|=1023&e.charCodeAt(s);i+="%"+(240|(o+=65536)>>18).toString(16).toUpperCase();i+="%"+(128|(258048&o)>>12).toString(16).toUpperCase();i+="%"+(128|(4032&o)>>6).toString(16).toUpperCase();i+="%"+(128|63&o).toString(16).toUpperCase()}}return i}m.encodeURIComponent=e;m.escapeUrlForCallback=function(t){var n=t.indexOf("#"),r=t.indexOf("?");if(n>0&&(-1==r||n<r)){var i=t.substr(0,n);r>0&&(i+=t.substr(r));t=i}return e(t,!0,!1,!0)}})()}if(void 0===g){g={__namespace:!0};(function(){function e(e,t){if(L(e,"/")){t.startsWith("/")&&(t=t.substring(1));return e+t}return t.startsWith("/")?e+t:e+"/"+t}var t=new(function(){this._list=new Array(0);this.get_href=function(){var e=null;if(L(window.location.pathname.toLowerCase(),"/_layouts/15/start.aspx")){"undefined"!=typeof g_MinimalDownload&&g_MinimalDownload&&(e=this.getSavedFormAction());Boolean(e)||(e=(function(){var e=null,t=window.location.href,n=t.toLowerCase().indexOf("/_layouts/15/start.aspx"),r=t.indexOf("://"),i=t.indexOf("/",r+3);-1==i&&(i=t.length);var s=t.indexOf("#");e=-1!=s&&s+1<=t.length&&"/"==t[s+1]?s+2<=t.length&&"/"==t[s+2]?t.substr(0,i)+t.substr(s+2):t.substr(0,n)+t.substr(s+1):t.substr(0,n);return e})())}else e=window.location.href;return e};this.get_search=function(){var e="";if("undefined"!=typeof g_MinimalDownload&&g_MinimalDownload&&L(window.location.pathname.toLowerCase(),"/_layouts/15/start.aspx")){var t=this.getSavedFormAction();if(Boolean(t)){var n=t.indexOf("?");-1!=n&&(e=t.substr(n))}}else e=window.location.search;return e};this.add_navigate=function(e){if("function"!=typeof e)throw"unexpected";-1==h.arrayIndexOf(this._list,e,0)&&this._list.push(e)};this.convertMDSURLtoRegularURL=function(t){var n=t;if(null!=t||""!=t){var r=t.toLowerCase().indexOf("/_layouts/15/start.aspx");if(-1!=r){var i=t.substring(0,r);r+="/_layouts/15/start.aspx".length;if(t.length==r)n=i;else if("#"==t[r]){r+=1;if(t.length==r)n=i;else if(t.length>=r+2&&"/"==t[r]&&"/"==t[r+1]){var s=t.indexOf("://");if(-1!=s){var o=t.indexOf("/",s+3);if(-1!=o){n=e(t.substring(0,o),t.substring(r+1))}}}else if(t.length>=r+1&&"/"==t[r]){n=e(i,t.substring(r))}}}}return n}});g.ajaxNavigate=t;g.combineUrl=e;g.pageUrlValidation=function(e,t){if(n(e))return e;Boolean(t)&&alert(t);return""};g.getUrlKeyValue=function(e,t,n,r){var i,s,o="";null==n&&(n=g.ajaxNavigate.get_href()+"");(i=n.indexOf("#"))>=0&&(n=n.substr(0,i));if(r){e=e.toLowerCase();s=n.toLowerCase()}else s=n;-1==(i=s.indexOf("&"+e+"="))&&(i=s.indexOf("?"+e+"="));if(-1!=i){var u=n.indexOf("&",i+1);-1==u&&(u=n.length);o=n.substring(i+e.length+2,u)}return t?o:v.decodeURIComponent(o)};g.isPageUrlValid=n;function n(e){return"http"==e.substr(0,4)||"/"==e.substr(0,1)||-1==e.indexOf(":")}})()}void 0===y&&(y={__namespace:!0});if(void 0===b){b={__namespace:!0};(function(){b.BasePermissions=function(){};b.BasePermissions.prototype={ManageLists:void 0,OpenItems:void 0};b.Context=function(){this.listBaseType=null;this.listTemplate=null;this.listName=null;this.view=null;this.listUrlDir=null;this.HttpPath=null;this.HttpRoot=null;this.serverUrl=null;this.imagesPath=null;this.PortalUrl=null;this.RecycleBinEnabled=null;this.enteringGridMode=!1;this.inGridMode=!1;this.isWebEditorPreview=null;this.rootFolderForDisplay=null;this.isPortalTemplate=null;this.isModerated=!1;this.recursiveView=!1;this.displayFormUrl=null;this.editFormUrl=null;this.newFormUrl=null;this.ctxId=null;this.CurrentUserId=null;this.isForceCheckout=!1;this.EnableMinorVersions=!1;this.ModerationStatus=0;this.verEnabled=0;this.isVersions=0;this.WorkflowsAssociated=!1;this.ExternalDataList=!1;this.HasRelatedCascadeLists=0;this.CascadeDeleteWarningMessage=null;this.ContentTypesEnabled=!1;this.SendToLocationName="";this.SendToLocationUrl="";this.StateInitDone=!1;this.TotalListItems=null;this.CurrentSelectedItems=null;this.LastSelectableRowIdx=null;this.SelectAllCbx=null;this.TableCbxFocusHandler=null;this.TableMouseoverHandler=null;this.onItemSelectionChangedHandlers=[]};b.Context.prototype={AllowGridMode:void 0,BasePermissions:void 0,BaseViewID:void 0,CascadeDeleteWarningMessage:void 0,ContentTypesEnabled:void 0,CurrentSelectedItems:void 0,CurrentUserId:void 0,EnableMinorVersions:void 0,ExternalDataList:void 0,HasRelatedCascadeLists:void 0,HttpPath:void 0,HttpRoot:void 0,RealHttpRoot:void 0,NoScriptEnabled:void 0,LastSelectableRowIdx:void 0,LastSelectedItemIID:void 0,LastRowIndexSelected:void 0,RowFocusTimerID:void 0,ListData:void 0,ListSchema:void 0,ModerationStatus:void 0,mountPointUrl:void 0,PortalUrl:void 0,RecycleBinEnabled:void 0,SelectAllCbx:void 0,SendToLocationName:void 0,SendToLocationUrl:void 0,StateInitDone:void 0,TableCbxFocusHandler:void 0,TableMouseoverHandler:void 0,TotalListItems:void 0,WorkflowsAssociated:void 0,clvp:void 0,ctxId:void 0,ctxType:void 0,dictSel:void 0,displayFormUrl:void 0,editFormUrl:void 0,imagesPath:void 0,inGridMode:void 0,inGridFullRender:void 0,isForceCheckout:void 0,isModerated:void 0,isPortalTemplate:void 0,isVersions:void 0,isWebEditorPreview:void 0,leavingGridMode:!1,loadingAsyncData:!1,listBaseType:void 0,listName:void 0,listTemplate:void 0,listUrlDir:void 0,newFormUrl:void 0,onRefreshFailed:void 0,overrideDeleteConfirmation:void 0,overrideFilterQstring:void 0,overrideScope:void 0,searchTerm:void 0,recursiveView:void 0,rootFolderForDisplay:void 0,serverUrl:void 0,verEnabled:void 0,view:void 0,queryString:void 0,IsClientRendering:void 0,wpq:void 0,rootFolder:void 0,hasRootFolder:void 0,IsAppWeb:void 0,NewWOPIDocumentEnabled:void 0,NewWOPIDocumentUrl:void 0,NewWOPIDocumentTypes:void 0,AllowCreateFolder:void 0,CanShareLinkForNewDocument:void 0,VisioDrawingCreationEnabled:void 0,noGroupCollapse:void 0,SiteTemplateId:void 0,RealSiteTemplateId:void 0,ExcludeFromOfflineClient:!1,onItemSelectionChangedHandlers:void 0,bNoDelete:!1,qcb:void 0};b.Context.Type={EditMenu:0,ViewSelector:1};b.Settings={SupportsCallouts:!1,SupportsDragDrop:!1,SupportsRibbon:!1,SupportsQCB:!1,SupportsUpload:!1,SupportsInplHash:!1,SupportsAnimation:!1,SupportsGrouping:!1,SupportsNonCSR:!1,SupportsInPlaceEdit:!1,SupportsItemDelete:!1,SupportsCheckout:!1,SupportsPopup:!1,SupportsErrorDlg:!1,SupportsFileAttach:!1,SupportsCopies:!1,SupportsModeration:!1,SupportsMQuery:!1,SupportsRest:!1,SupportsDatapipes:!1,SupportsAddToOneDrive:!1,SupportsAddToOneDriveQCB:!1,SupportsTaskListEditMode:!1,SupportsPeopleHoverCard:!1,SupportsMaintainUserChrome:!1,SupportsInfiniteScroll:!1,SupportsDragDropAttract:!1,SupportsDragDropAttractB:!1,SupportsDoclibAccessibility:!1,SupportsDoclibQCB:!1,SupportsOldDesktopMenus:!1,SupportsPolicyTips:!1,SupportsRightClickECB:!1,SupportsShortcutLink:!1,SupportsFileExtensionDefinition:!1,SupportsFileExtensionControls:!1,SupportsFileHandlerForAllNonOfficeFiles:!1,SupportsFileExtensionDataPipe:!1,SupportsFileHandlerAddInPicker:!1,SupportsFileHandlerFileCreation:!1}})()}window.ListModule=b;if(void 0===w){w={__namespace:!0};(function(){b.Util={};b.Util.createViewEditUrl=e;b.Util.createItemPropertiesTitleUrl=function(t,n){if(t.inGridMode)return e(t,n,!0,!1);return e(t,n,!1,!1)};b.Util.isDefinedAndNotNullOrEmpty=function(e){return null!=e&&""!==e};function e(e,t,n,r){var i=[];n?i.push(e.editFormUrl):i.push(e.displayFormUrl);i.push("&ID=");i.push(t.ID);i.push("&ContentTypeID=");i.push(t.ContentTypeId);if(r){i.push("&Source=");i.push(g.getSource())}return i.join("")}})()}void 0===E&&(E={__namespace:!0});null==S&&((S={}).ExpFeatures=[]);S.VariantConfiguration={};S.VariantConfiguration.IsExpFeatureClientEnabled=function(e){var t,n=Math.floor(e/32);if(null==window.OffSwitch||r.IsActive("AF5A380E-20E0-4096-BA87-2C4CDFB4DBDF")){if(n<0||n>=S.ExpFeatures.length)return!1;t=1<<e%32;return 0!=(S.ExpFeatures[n]&t)}var i=S.ExpFeatures,s=window._spPageContextInfo;0===i.length&&null!=s&&null!=s.ExpFeatures&&(i=_spPageContextInfo.ExpFeatures);if(n<0||n>=i.length)return!1;t=1<<e%32;return 0!=(i[n]&t)};window.Flighting=S;String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};void 0===x&&(x=new Array(0));window.NotifyScriptLoadedAndExecuteWaitingJobs=B;1;1;void 0!==Date.now&&null!==Date.now||(Date.now=function(){return Number(new Date)});A.prototype={webPartId:void 0,serverUrl:void 0,siteRelativeUrl:void 0,listName:void 0,rootFolder:void 0,overwriteAll:void 0,hideProgressBar:void 0,refreshFunc:void 0,preUploadFunc:void 0,postUploadFunc:void 0,checkPermissionFunc:void 0};window.PageMinimized=D;if(null==T){(T=[]).push("_spBodyOnLoad");T.push("_spRestoreScrollForDiv_rscr")}null!=document.body&&null!=document.body.firstChild||void 0!==document.addEventListener&&void 0!==window.msWriteProfilerMark&&document.addEventListener("DOMContentLoaded",function(){window.msWriteProfilerMark("DOMContentLoaded")},!1);N=new Object;j.prototype.buildMinimized=void 0;j.prototype.initialTabId=void 0;C=0;k=null;(function(){q.prototype.hasRetVal=void 0;q.prototype.retVal=void 0;q.prototype.set=function(e){if(void 0!==e){this.retVal=e;this.hasRetval=!0}};q.prototype.isSet=function(){return this.hasRetval};q.prototype.get=function(){return this.hasRetval?this.retVal:void 0};q.prototype.clear=function(){this.hasRetval=!1;this.retVal=null}})();n.JsGridUtil.SPListView=!0;R("SP");R("SP.UI");T.push("AllowCSSFiltersOnIE8")};var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k;function L(e,t){return-1!==e.indexOf(t,e.length-t.length)}t.TrimSpaces=function(e){var t,n,r=(e=e.toString()).length;for(t=0;t<r&&" "==e.charAt(t);t++);if(t==r)return"";for(n=r-1;n>t&&" "==e.charAt(n);n--);n++;return e.substring(t,n)};function A(e,t,n,r,i,s,o,u,a,f,l){this.webPartId=e;this.serverUrl=t;this.siteRelativeUrl=n;this.listName=r;this.rootFolder=i;this.overwriteAll=s;this.hideProgressBar=o;this.refreshFunc=u;this.preUploadFunc=a;this.postUploadFunc=f;this.checkPermissionFunc=l}function O(e,t,n,r){M(e,e,t,n,r);null!=t&&t();null!=n&&n();null!=r&&r()}function M(e,t,n,r,i){if("string"!=typeof t)throw"Unexpected";if(null!=n&&"function"!=typeof n)throw"Unexpected";if(null!=r&&"function"!=typeof r)throw"Unexpected";if(null!=i&&"function"!=typeof i)throw"Unexpected";x[t]||(x[t]={tag:t,scriptURI:new v(e),beginFunc:n,endFunc:r,loadFunc:i,executed:!1})}function _(e,t){M(e,e,t,null,null)}function D(){return!0}t.IsXhrAborted=function(e){try{if(4==e.readyState&&(void 0===e.status||0==e.status))return!0}catch(e){return!0}return!1};function P(e,t){var n=N[t];if(null!=n&&n.notified){null!=n.args?e.apply(null,n.args):e();return!0}(function(e,t){var n=N[t];if(null==n){(n=new Object).notified=!1;n.jobs=[];n.args=null;N[t]=n}n.jobs.push(e)})(e,t);return!1}function H(e,t){return P(e,"sp.scriptloaded-"+(t=t.toLowerCase()))}function B(e){}function j(){}t.getUniqueIndex=function(){return++C};function F(){if(Boolean(k))return k;try{var e;e=window;for(;null!=e&&e!=e.parent;)null!=(e=e.parent)&&e.g_spDlgLauncher&&(k=e)}catch(e){}finally{Boolean(k)||(k=window)}return k}function I(e,t,n,r){}function q(){}t.IsShortcutLink=function(e){return Boolean(e)&&("url"==e.File_x0020_Type||"website"==e.File_x0020_Type)};t.AjaxNavAddNavigate=function(e){g.ajaxNavigate.add_navigate(e)};function R(e){(function(e,t){for(var n,r=e.split("."),i=0,s=r.length;i<s;i++){var o=r[i];void 0===n&&(n=window);void 0===n[o]&&(n[o]=new Object);n=n[o];t&&(n.__namespace=!0)}})(e,!0)}function U(e,t){var n=e.ownerDocument;if(Boolean(n.createTextNode)){var r=n.createTextNode(t);e.innerHTML="";e.appendChild(r)}else e.innerText=t}function z(e){return e.search(/[?]/)>-1?e:e+"?rev=47"}function W(e,t,n,r,i,s){var o=r._ShortcutUniqueId,u=r._ShortcutWebId,a=r._ShortcutSiteId,f=r._ShortcutUrl,c=(function(e,t,n,r,i){var s="",o="?";if(Boolean(t)){var u=t.indexOf("?");-1!=u&&(o=t.substring(u))}if(Boolean(i)&&Boolean(r)&&Boolean(n)){s=e.WebUrl+"/_layouts/15/ShortcutLink.aspx";s+=o;s+="&siteid="+m.encodeURIComponent(n);s+="&webid="+m.encodeURIComponent(r);s+="&uniqueid="+m.encodeURIComponent(i)}else Boolean(t)&&(s=t);return s})(e,f,a,u,o);t.push('<a onfocus="OnLink(this)" class="ms-listlink" href="');if(""!=c){t.push(l.HtmlEncode(c));t.push('" title="');t.push(l.HtmlEncode(f))}else{c=e.WebUrl+"/_layouts/15/ShortcutLink.aspx?shortcut="+m.encodeURIComponent(r.FileRef);t.push(c);t.push('" title="');t.push(l.HtmlEncode(Strings.STS.L_Shortcut_Processing));if(s){t.push('" id="shortcut_');t.push(l.HtmlEncode(r.FileRef));(function(e,t){if(null!=window.XMLHttpRequest){var n=t.WebUrl+"/_api/SP.Utilities.ShortcutLink.GetShortcutLink('"+m.encodeURIComponent(e)+"')",r=new XMLHttpRequest;r.open("GET",n,!0);r.setRequestHeader("Content-Type","application/json");r.setRequestHeader("Accept","application/json");r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var t=JSON.parse(r.responseText),n=void 0;if(null!=(n=document.getElementById("shortcut_"+e))){n.href=t.url;n.title=t.url}}};r.send(null)}})(r.FileRef,e)}}t.push('" aria-label="');t.push(l.HtmlEncode(Strings.STS.L_FieldType_File_Shortcut));t.push('">')}t.RenderShortcutLink=function(e,t,n,r,i){W(e,t,0,r,0,!0);t.push(l.HtmlEncode(n));t.push("</a>")};t.RenderShortcutLinkIcon=function(e,t,n,r,i){W(e,t,0,r,0,!1);t.push('<img border="0" alt="');t.push(l.HtmlEncode(Strings.STS.L_FieldType_File_Shortcut));t.push('" title="');t.push(l.HtmlEncode(Strings.STS.L_FieldType_File_Shortcut));t.push('" src="');t.push(ListView.ImageBasePath+"/_layouts/15/images/icspgen.gif?rev=47");t.push('" />');t.push("</a>")};function X(e){if(!Boolean(e))return!1;for(var t=e.split("."),n=t.length,r=window,i=0;i<n;i++)if(void 0===(r=r[t[i]]))return!1;return!0}(function(e){e.AddClass=function(e,t){if(null!=e&&!n(e,t)){e.className+=" "+t;return!0}return!1};e.RemoveClass=function(e,r){if(n(e,r)){e.className=e.className.replace(t(r)," ");return!0}return!1};function t(e){return new RegExp("(\\s|^)"+e+"(\\s|$)")}function n(e,n){return null!=e&&null!=n&&null!=e.className.match(t(n))}})(t.CSSUtil||(t.CSSUtil={}))});
define("aQw",["require","exports","aQo","jm","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i){"use strict";var s=i.SPGrid_6;i=i.styles_9;Object.defineProperty(t,"__esModule",{value:!0});var o=r.getTheme(),u={ODB:1725};function a(e){var t=n.JsGridUtil.Internal.Color.HexStringToColor(e);null!=t&&(t=n.JsGridUtil.Internal.Color.MakeAlphaColor(.2,t.r,t.g,t.b));return t}t.StyleType={Splitter:{outerBorderColor:{jsId:"borderTopColor"},leftInnerBorderColor:{jsId:"borderLeftColor"},innerBorderColor:{jsId:"borderBottomColor"},backgroundColor:{}},SplitterHandle:{outerBorderColor:{jsId:"borderTopColor"},leftInnerBorderColor:{jsId:"borderLeftColor"},innerBorderColor:{jsId:"borderBottomColor"},backgroundColor:{},gripUpperColor:{jsId:"color"},gripLowerColor:{jsId:"borderRightColor"}},GridPane:{verticalBorderColor:{jsId:"borderRightColor"},verticalBorderStyle:{jsId:"borderRightStyle"},horizontalBorderColor:{jsId:"borderBottomColor"},horizontalBorderStyle:{jsId:"borderBottomStyle"},backgroundColor:{jsId:"backgroundColor"},columnDropIndicatorColor:{jsId:"borderLeftColor"},rowDropIndicatorColor:{jsId:"borderLeftColor"},linkColor:{classId:"link",jsId:"color"},visitedLinkColor:{classId:"link",jsId:"backgroundColor"},copyRectForeBorderColor:{classId:"selection",jsId:"borderLeftColor"},copyRectBackBorderColor:{classId:"selection",jsId:"borderRightColor"},focusRectBorderColor:{classId:"selection",jsId:"borderTopColor"},selectionRectBorderColor:{classId:"selection",jsId:"borderBottomColor",semanticColor:"inputFocusBorderAlt"},selectedCellBgColor:{classId:"selection",jsId:"color",fromCss:a},readonlySelectionRectBorderColor:{classId:"readOnlySelection",jsId:"borderBottomColor"},changeHighlightCellBgColor:{classId:"edit",jsId:"backgroundColor",fromCss:a},fillRectBorderColor:{classId:"edit",jsId:"borderLeftColor",semanticColor:"inputFocusBorderAlt"},errorRectBorderColor:{classId:"edit",jsId:"borderTopColor"}},Header:{font:{jsId:"fontFamily"},fontSize:{},fontWeight:{},textColor:{jsId:"color"},outerBorderColor:{jsId:"borderBottomColor"},innerBorderColor:{jsId:"borderRightColor"},eyeBrowBorderColor:{jsId:"borderTopColor"},eyeBrowColor:{jsId:"borderLeftColor"},menuColor:{classId:"elementColor",jsId:"backgroundColor"},menuBorderColor:{classId:"elementColor",jsId:"borderLeftColor"},resizeColor:{classId:"elementColor",jsId:"borderBottomcolor"},resizeBorderColor:{classId:"elementColor",jsId:"borderRightColor"},menuHoverColor:{classId:"elementHoverColor",jsId:"backgroundColor"},menuHoverBorderColor:{classId:"elementHoverColor",jsId:"borderLeftColor"},resizeHoverColor:{classId:"elementHoverColor",jsId:"borderTopColor"},resizeHoverBorderColor:{classId:"elementHoverColor",jsId:"borderRightColor"},eyeBrowHoverColor:{classId:"elementHoverColor",jsId:"borderTopColor"},eyeBrowHoverBorderColor:{classId:"elementHoverColor",jsId:"borderBottomColor"},elementClickColor:{classId:"elementClickColor",jsId:"backgroundColor"},elementClickBorderColor:{classId:"elementClickColor",jsId:"borderLeftColor"}},RowHeaderStyle:{backgroundColor:{},outerBorderColor:{jsId:"borderBottomColor"},innerBorderColor:{jsId:"borderRightColor"}},TimescaleTier:{font:{jsId:"fontFamily"},fontSize:{},fontWeight:{},textColor:{jsId:"color"},backgroundColor:{},verticalBorderColor:{jsId:"borderRightColor"},verticalBorderStyle:{jsId:"borderRightStyle"},horizontalBorderColor:{jsId:"borderBottomColor"},horizontalBorderStyle:{jsId:"borderBottomStyle"},outerBorderColor:{jsId:"borderLeftColor"},todayLineColor:{jsId:"borderTopColor"}},Cell:{font:{jsId:"fontFamily"},fontSize:{},fontWeight:{},fontStyle:{},textColor:{jsId:"color"},backgroundColor:{},textAlign:{}},Widget:{backgroundColor:{jsId:"backgroundColor"},borderColor:{jsId:"borderColor"}}};var f,l=0,c=1,h=2,p=3,d=4,v=5,m=(function(){function e(){var e=this;this.Dispose=function(){window.removeEventListener("unload",e.Dispose);e.testElement=null};this.Type=t.StyleType;for(var r in t.StyleType)for(var i in t.StyleType[r]){var s=t.StyleType[r][i],o=null==s.jsId?i:s.jsId;if(""!==o&&(null==s.cssId||""==s.cssId)){s.cssId=n.JsGridUtil.Internal.DomElement.GetInstance().DashNameFromCamelName(o);s.jsId=o}}window.addEventListener("unload",this.Dispose)}e.getInstance=function(){e._instance||(e._instance=new e);return e._instance};e.prototype.CreateStyleObject=function(e){var t={};for(var n in e)t[n]=null;return t};e.prototype.CreateReadOnlyCellStyle=function(){return{textColor:null}};e.prototype.MakeHeaderStyleCollection=function(){var e=this,n=function(n){var r=e.CreateStyleObject(t.StyleType.Header);r.type=n;return r};return{normal:n(l),normalHover:n(p),partSelected:n(c),partSelectedHover:n(d),allSelected:n(h),allSelectedHover:n(v)}};e.prototype.MakeSplitterStyleCollection=function(){return{normal:this.CreateStyleObject(t.StyleType.Splitter),normalHandle:this.CreateStyleObject(t.StyleType.SplitterHandle),hover:this.CreateStyleObject(t.StyleType.Splitter),hoverHandle:this.CreateStyleObject(t.StyleType.SplitterHandle),drag:this.CreateStyleObject(t.StyleType.Splitter),dragHandle:this.CreateStyleObject(t.StyleType.SplitterHandle)}};e.prototype.LoadNameClassInfoFromStyle=function(e){var t={};for(var n in e){var r=null==e[n].classId?"base":e[n].classId;r in t||(t[r]={});t[r][n]=e[n]}return t};e.prototype.LoadCollectionCss=function(e,t,n){for(var r in t)null!=n[r]&&f.CreateStyleFromCss(t[r],n[r],e)};e.prototype.GetDefaultStyleMgr=function(){var e=this,r={};return{gridPaneStyle:this.CreateStyleObject(t.StyleType.GridPane),columnHeaderStyleCollection:this.MakeHeaderStyleCollection(),rowHeaderStyleCollection:this.MakeHeaderStyleCollection(),splitterStyleCollection:this.MakeSplitterStyleCollection(),defaultCellStyle:{},readOnlyCellStyle:this.CreateReadOnlyCellStyle(),readOnlyFocusedCellStyle:{},timescaleTierStyle:this.CreateStyleObject(t.StyleType.TimescaleTier),groupingStyles:[],widgetDockStyle:{},widgetDockHoverStyle:{},widgetDockPressedStyle:{},RegisterCellStyle:function(e,t){r[e]=t},GetCellStyle:function(e){return r[e]},UpdateSplitterStyleFromCss:function(e,n){for(var r in n)for(var i in n[r])f.CreateStyleFromCss(t.StyleType.Splitter,n[r][i],e[r],i)},UpdateHeaderStyleFromCss:function(e,n){for(var r in n)for(var i in n[r])f.CreateStyleFromCss(t.StyleType.Header,n[r][i],e[r],i)},UpdateGridPaneStyleFromCss:function(n,r){e.LoadCollectionCss(n,e.LoadNameClassInfoFromStyle(t.StyleType.GridPane),r)},UpdateDefaultCellStyleFromCss:function(e,r){f.CreateStyleFromCss(t.StyleType.Cell,r,e);e.textAlign="rtl"==n.JsGridUtil.Utility.GetDocumentDirection()?"right":"left"},UpdateGroupStylesFromCss:function(e,r){for(var i={},s=1;s<10;s++){i=f.CreateStyleFromCss(t.StyleType.Cell,r+s);n.JsGridUtil.Internal.IsAssocArrayEmpty(i)||e.push(i)}}}};e.prototype.InitStylesFromCSS=function(e){for(var r=n.JsGridUtil.Internal.IsFeatureEnabled(u),o=[[e.gridPaneStyle,e.UpdateGridPaneStyleFromCss,null,{base:r?s.msGrid:"ms-grid",link:r?s.msGridLink:"ms-grid-link",selection:r?s.msGridSelection:"ms-grid-selection",readOnlySelection:r?s.msGridSelectionReadonly:"ms-grid-selection-readonly",edit:r?s.msGridEdit:"ms-grid-edit"}],[e.columnHeaderStyleCollection,e.UpdateHeaderStyleFromCss,null,{normal:{base:r?s.msGridColHeaderNormal:"ms-grid-col-header-normal",elementColor:r?s.msGridColHeaderElemBgColorsNormal:"ms-grid-col-header-elem-bg-colors-normal",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsNormal:"ms-grid-col-header-elem-hover-bg-colors-normal",elementClickColor:r?s.msGridColElemColorsClickNormal:"ms-grid-col-elem-colors-click-normal"},normalHover:{base:r?s.msGridColHeaderNormalHover:"ms-grid-col-header-normal-hover",elementColor:r?s.msGridColHeaderElemBgColorsNormalHover:"ms-grid-col-header-elem-bg-colors-normal-hover",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsNormalHover:"ms-grid-col-header-elem-hover-bg-colors-normal-hover",elementClickColor:r?s.msGridColElemColorsClickNormalHover:"ms-grid-col-elem-colors-click-normal-hover"},partSelected:{base:r?s.msGridColHeaderPartSelected:"ms-grid-col-header-part-selected",elementColor:r?s.msGridColHeaderElemBgColorsPartSelected:"ms-grid-col-header-elem-bg-colors-part-selected",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsPartSelected:"ms-grid-col-header-elem-hover-bg-colors-part-selected",elementClickColor:r?s.msGridColElemColorsClickPartSelected:"ms-grid-col-elem-colors-click-part-selected"},partSelectedHover:{base:r?s.msGridColHeaderPartSelectedHover:"ms-grid-col-header-part-selected-hover",elementColor:r?s.msGridColHeaderElemBgColorsPartSelectedHover:"ms-grid-col-header-elem-bg-colors-part-selected-hover",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsPartSelectedHover:"ms-grid-col-header-elem-hover-bg-colors-part-selected-hover",elementClickColor:r?s.msGridColElemColorsClickPartSelectedHover:"ms-grid-col-elem-colors-click-part-selected-hover"},allSelected:{base:r?s.msGridColHeaderAllSelected:"ms-grid-col-header-all-selected",elementColor:r?s.msGridColHeaderElemBgColorsAllSelected:"ms-grid-col-header-elem-bg-colors-all-selected",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsAllSelected:"ms-grid-col-header-elem-hover-bg-colors-all-selected",elementClickColor:r?s.msGridColElemColorsClickAllSelected:"ms-grid-col-elem-colors-click-all-selected"},allSelectedHover:{base:r?s.msGridColHeaderAllSelectedHover:"ms-grid-col-header-all-selected-hover",elementColor:r?s.msGridColHeaderElemBgColorsAllSelectedHover:"ms-grid-col-header-elem-bg-colors-all-selected-hover",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsAllSelectedHover:"ms-grid-col-header-elem-hover-bg-colors-all-selected-hover",elementClickColor:r?s.msGridColElemColorsClickAllSelectedHover:"ms-grid-col-elem-colors-click-all-selected-hover"}}],[e.rowHeaderStyleCollection,e.UpdateHeaderStyleFromCss,null,{normal:{base:r?s.msGridRowHeaderNormal:"ms-grid-row-header-normal"},normalHover:{base:r?s.msGridRowHeaderNormalHover:"ms-grid-row-header-normal-hover"},partSelected:{base:r?s.msGridRowHeaderPartSelected:"ms-jsgrid-rowheader-partselected"},partSelectedHover:{base:r?s.msGridRowHeaderPartSelectedHover:"ms-jsgrid-rowheader-partselected"},allSelected:{base:r?s.msGridRowHeaderAllSelected:"ms-grid-row-header-all-selected"},allSelectedHover:{base:r?s.msGridRowHeaderAllSelectedHover:"ms-grid-row-header-all-selected-hover"}}],[e.splitterStyleCollection,e.UpdateSplitterStyleFromCss,null,{normal:{base:r?s.msGridSplitter:"ms-grid-splitter"},normalHandle:{base:r?s.msGridSplitterHandle:"ms-grid-splitter-handle"},hover:{base:r?s.msGridSplitterHover:"ms-grid-splitter-hover"},hoverHandle:{base:r?s.msGridSplitterHandleHover:"ms-grid-splitter-handle-hover"},drag:{base:r?s.msGridSplitterDrag:"ms-grid-splitter-drag"},dragHandle:{base:r?s.msGridSplitterHandleDrag:"ms-grid-splitter-handle-drag"}}],[e.defaultCellStyle,e.UpdateDefaultCellStyleFromCss,null,i.msGridCell],[e.readOnlyCellStyle,t.StyleType.Cell,i.msGridCellReadonly],[e.readOnlyFocusedCellStyle,t.StyleType.Cell,i.msGridCellReadonlyFocused],[e.timescaleTierStyle,t.StyleType.TimescaleTier,r?s.msGridTimescale:"ms-grid-timescale"],[e.groupingStyles,e.UpdateGroupStylesFromCss,null,"ms-grid-group"],[e.widgetDockStyle,t.StyleType.Widget,r?s.msGridWidgetDock:"jsgrid-widget-dock"],[e.widgetDockHoverStyle,t.StyleType.Widget,r?s.msGridWidgetDockHover:"jsgrid-widget-dock-hover"],[e.widgetDockPressedStyle,t.StyleType.Widget,r?s.msGridWidgetDockPressed:"jsgrid-widget-dock-pressed"]],a=0;a<o.length;a++){var l=o[a];null!=l[2]?f.CreateStyleFromCss(l[1],l[2],l[0]):l[1].apply(e,[l[0],l[3]])}return e};e.prototype.SetRTL=function(e){this._rtl=e};e.prototype.MakeJsGridStyleManager=function(){return this.InitStylesFromCSS(this.GetDefaultStyleMgr())};return e})();t.Style=m;(function(e){var r,s;e.CreateStyleFromCss=function(e,t,u,a){var f=n.JsGridUtil.Internal.IsNullOrUndefined(u)?{}:u;if(n.JsGridUtil.Internal.IsNullOrUndefined(r)){n.JsGridUtil.DebugAssert(n.JsGridUtil.Internal.IsNullOrUndefined(s));(r=document.createElement("div")).style.display="none";document.body.appendChild(r);(s=document.createElement("div")).style.display="none";document.body.appendChild(s)}n.JsGridUtil.DebugAssert(""==s.className);r.className=i.msGridBaseStyle+" "+t;for(var l in e)if(null==a||a==e[l].classId||"base"==a&&null==e[l].classId){var c=e[l].jsId;if(e[l].semanticColor)f[l]=o.semanticColors[e[l].semanticColor];else if(""!==c){var h=n.JsGridUtil.Internal.DomElement.GetInstance().GetComputedStyle(r,c,e[l].cssId),p=n.JsGridUtil.Internal.DomElement.GetInstance().GetComputedStyle(s,c,e[l].cssId);if("backgroundColor"!==c||h!==p){var d=n.JsGridUtil.Internal.IsNullOrUndefined(e[l].fromCss)?h:e[l].fromCss(h);null!=d&&(f[l]=d)}else f[l]="transparent"}}return f};e.CreateStyle=function(e,t){var n={};for(var r in e)null!=t[r]&&(n[r]=t[r]);return n};e.MergeCellStyles=function(e,n){var r={};for(var i in t.StyleType.Cell)r[i]=null!=e&&null!=e[i]?e[i]:n[i];return r};e.ApplyCellStyle=function(e,t){var n=e.style;null!=t.textColor&&(n.color=t.textColor);null!=t.backgroundColor&&(n.backgroundColor=t.backgroundColor);null!=t.font&&(n.fontFamily=t.font);null!=t.fontSize&&(n.fontSize=t.fontSize);null!=t.fontWeight&&(n.fontWeight=t.fontWeight);null!=t.fontStyle&&(n.fontStyle=t.fontStyle);null!=t.textAlign&&(n.textAlign=t.textAlign)};function u(e,t,r){var i=e.style;if(e.headerStyleType!==t.type){e.headerStyleType=t.type;i.backgroundColor=t.backgroundColor;if(null!=t.innerBorderColor){e.headerStyleInnerBorderString=i.borderBottom="1px solid "+t.innerBorderColor;i["border"+m.getInstance()._rtl.Right]="1px solid "+t.outerBorderColor}else e.headerStyleBorderString=i.borderBottom=i["border"+m.getInstance()._rtl.Right]="1px solid "+t.outerBorderColor;i.borderTop="0px"}var s=r&&r(e,!0);if(null!=s){var o=a(s,e);null!=t.innerBorderColor?s.style.borderBottom=o.headerStyleInnerBorderString:s.style.borderBottom=o.headerStyleBorderString}var u=r&&r(e,!1);null!=(o=null!=u?a(u,e):e).headerStyleInnerBorderString?i.borderBottom=o.headerStyleInnerBorderString:i.borderBottom=o.headerStyleBorderString;function a(e,t){n.JsGridUtil.DebugAssert(null!=e.headerStyleType||null!=t.headerStyleType);return null==e.headerStyleType?t:null==t.headerStyleType||e.headerStyleType>t.headerStyleType?e:t}}e.ApplyRowHeaderStyle=u;e.ApplyCornerHeaderBorderStyle=function(e,t,n){u(e,t,function(){return null})};e.ApplyHeaderInnerBorderStyle=function(e,t,n,r){e.style[t?"borderTop":"border"+r.Left]=n.headerStyleInnerBorderString};e.ApplyColumnContextMenuStyle=function(e,t){e.style.border=a(1,"solid",t.borderColor);e.style.backgroundColor=t.backgroundColor||"transparent"};e.ApplySplitterStyle=function(e,t){e.style.borderLeft=e.style.borderRight=a(1,"solid",t.outerColor);e.style.backgroundColor=t.innerColor};function a(e,t,n){return[e,"px ",t," ",n||"transparent"].join("")}e.MakeBorderString=a;e.GetCellStyleDefaultBackgroundColor=function(){return"#FFFFFF"}})(f=t.StyleUtil||(t.StyleUtil={}))});
define("aQA",["require","exports","aQo","aPS","aQn","aQw","aQ2","aQ0","aQZ","aQV","aQF","aPZ","aQE","aQD","aQB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(){function e(e,t,i){var s=this;this.disableCount=0;this.bIsInitialized=!1;this.bViewSet=!1;this.eventMgr=new n.JsGridUtil.EventManager;this.delegateMgr=new n.JsGridUtil.DelegateManager;this.intDelegateMgr=new n.JsGridUtil.DelegateManager;this.objBag={};this.TestEventType={Start:0,Finish:1};this.Dispose=function(){if(s.bIsInitialized){window.removeEventListener("unload",s.Dispose);s.objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnBeforeGridDispose);s.objBag.intEventMgr.FireEvent(r.JsGridConstants.Internal.EventType.OnGridDisposing);s.loadingBanner.Dispose();if(n.JsGridUtil.Internal.DomElement.GetInstance().ElementAttachedToDom(s.parentNode)){s.paneMgr.Dispose();s.parentNode.innerHTML="";s.parentNode=s.parentNode.jsgrid=s.parentNode.jsgridparams=s.parentNode.jsgridtableviewparams=s.parentNode.jsgridrowviewparams=null}delete s.parentNode;s.objBag.parentNode=null;s.bIsInitialized=s.bViewSet=!1;s.commandMgr.RemovePreExecuteNotifier(s.StopEditing.bind(s))}};this.StaticInit();e.style.position="relative";this.parentNode=e;this.bShowLoadingBanner=t;this.loadingBanner=new n.JsGridUtil.LoadingBanner(e,e.id+"_disable_banner");e.jsgrid=this;t&&this.SetEnabledState(!1);if(i){this.objBag.setColumnWidthsToLocalStorage=i.setColumnWidthsToLocalStorage;this.objBag.dragDropMgr=i.dragDropMgr;this.objBag.onSelectionChanged=i.onSelectionChanged;this.objBag.siteAssetsThumbnailMetadata=i.siteAssetsThumbnailMetadata}}e.prototype.IsInitialized=function(){return this.bIsInitialized};e.prototype.ResetData=function(e){this.tableCache=e};e.prototype.Init=function(e){var t=this,i=e;this._jsGridParams=this.parentNode.jsgridparams=i;this.parentNode.jsgridtableviewparams=i.tableViewParams;this.parentNode.jsgridrowviewparams=i.tableViewParams&&i.tableViewParams.rowViewParams;this.FireTestEvent(this.TestEventType.Start);this.name=null!=i.name?i.name:"";this.InitOldStyleDelegates();this.tableCache=i.tableCache;this.commandMgr=i.commandMgr;this.commandMgr.IsUndoEnabled()&&this.commandMgr.AddPreExecuteNotifier(this.StopEditing.bind(this));this.objBag.RTL={bEnabled:i.isRTL,left:i.isRTL?"right":"left",Left:i.isRTL?"Right":"Left",right:i.isRTL?"left":"right",Right:i.isRTL?"Left":"Right",ltr:i.isRTL?"rtl":"ltr"};s.Style.getInstance().SetRTL(this.objBag.RTL);this.intDelegateMgr.SetDelegate(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,this.CallAsyncFn.bind(this));this.intDelegateMgr.SetDelegate(r.JsGridConstants.Internal.DelegateType.GetLocalizedString,this.GetLocalizedString.bind(this));this.intDelegateMgr.SetDelegate(r.JsGridConstants.Internal.DelegateType.DoLargeTask,this.DoLargeTask.bind(this));this.objBag.jsGridObj=this;this.objBag.jsGridParams=this._jsGridParams;this.objBag.gridId=this.parentNode.id;this.objBag.eventMgr=this.eventMgr;this.objBag.intEventMgr=new n.JsGridUtil.EventManager;this.objBag.intDelegateMgr=this.intDelegateMgr;this.objBag.commandMgr=i.commandMgr;this.objBag.delegateMgr=this.delegateMgr;this.objBag.styleMgr=i.styleManager;this.objBag.tableCache=i.tableCache;this.objBag.canUserAddColumn=i.canUserAddColumn;this.objBag.showAddColumnMenu=i.showAddColumn;this.objBag.spGrid=i.spGrid;this.objBag.spCsrRenderCtx=i.spCsrRenderCtx;this.objBag.qualifier=i.qualifier;this.objBag.errorMgr=new o.ErrorManager(this.objBag);this.objBag.rowHeaderStateMgr=new u.RowHeaderStateManager(this.objBag.intEventMgr);this.objBag.rowHeaderStates=new u.RowHeaderStates(this.objBag);this.objBag.rowHeaderAutoStates=new u.AutoRowHeaderStates(i.enabledRowHeaderAutoStates,this.objBag);this.objBag.entryRecordMgr=new a.EntryRecordManager(this.objBag);this.objBag.provisionalRecordMgr=new a.ProvisionalRecordManager(this.objBag);this.objBag.parentNode=this.parentNode;this.objBag.bUpdateCoordCache=!1;this.objBag.gridControls={};this.spCsrRenderCtx=i.spCsrRenderCtx;var h="{cursor:pointer} :link {color:"+this.objBag.styleMgr.gridPaneStyle.linkColor+"} :visited {color: "+this.objBag.styleMgr.gridPaneStyle.visitedLinkColor+"}";c.DisplayControl.ImageTextDisplayControl.prototype._styleForLinks=h;c.DisplayControl.TextDisplayControl.prototype._styleForLinks=h;i.bNotificationsEnabled&&o.ErrorNotificationManager.Instance.Init(this.objBag.gridId,this.objBag);this.objBag.controller=this.controller=new f.MVCController(this.objBag,this.GetLocalizedString.bind(this));this.objBag.paneMgr=this.paneMgr=new l.PaneManager(this.parentNode.id,this.objBag,this.GetLocalizedString.bind(this),this.parentNode,i.minHeaderHeight,i.minRowHeight,function(){return 0==t.disableCount});this.paneMgr.SetEventSinks(this.controller.GetViewEventSinks());null!=e.tableViewParams&&this.SetTableViewInternal(e.tableViewParams);window.addEventListener("unload",this.Dispose);this.bIsInitialized=!0;this.FireTestEvent(this.TestEventType.Finish)};e.prototype.InitOldStyleDelegates=function(){null!=this._jsGridParams.fnCreateNewRecords&&this.delegateMgr.SetDelegate(r.JsGridConstants.DelegateType.CreateRecords,this._jsGridParams.fnCreateNewRecords);null!=this._jsGridParams.fnExpandColumnMenu&&this.delegateMgr.SetDelegate(r.JsGridConstants.DelegateType.ExpandColumnMenu,this._jsGridParams.fnExpandColumnMenu);null!=this._jsGridParams.fnSort&&this.delegateMgr.SetDelegate(r.JsGridConstants.DelegateType.Sort,this._jsGridParams.fnSort)};e.prototype.Cleanup=function(){window.removeEventListener("unload",this.Dispose);this.loadingBanner.Dispose();if(n.JsGridUtil.Internal.DomElement.GetInstance().ElementAttachedToDom(this.parentNode)){this.paneMgr.Dispose();this.parentNode.innerHTML=""}this.bIsInitialized=this.bViewSet=!1};e.prototype.NotifyDataAvailable=function(){this.controller.NotifyDataAvailable()};e.prototype.NotifySave=function(){this.controller.NotifySave()};e.prototype.NotifyHide=function(){this.controller.NotifyHide()};e.prototype.NotifyResize=function(){this.paneMgr.NotifyResize()};e.prototype.ClearTableView=function(){if(this.bViewSet){this.controller.ClearTableView();this.bViewSet=!1}};e.prototype.HideInitialLoadingBanner=function(){if(this.bShowLoadingBanner){this.SetEnabledState(!0);this.bShowLoadingBanner=!1}};e.prototype.ShowInitialGridErrorMsg=function(e){n.JsGridUtil.DebugAssert(!this.bViewSet);this.HideInitialLoadingBanner();this.errorBanner=new n.JsGridUtil.ErrorBanner(this.parentNode,this.parentNode.id+"_initial_error_banner");this.errorBanner.Show(e)};e.prototype.ShowGridErrorMsg=function(e){this.HideInitialLoadingBanner();this.errorBanner=new n.JsGridUtil.ErrorBanner(this.parentNode,this.parentNode.id+"_error_banner");this.errorBanner.Show(e)};e.prototype.LaunchPrintPreview=function(e,t,n,i,s,o,u,a,f,l){var c=this,p=null;null==i&&(i="test");this.paneMgr.GetRecordMap(function(d){c.objBag.intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return p=c.tableCache.GetRecords([{pos:0,count:c.tableCache.GetRecordCount()}],function(t){p=t;e()})},function(){c._jsGridParams.tableViewParams.rowViewParams.view=c.tableCache.GetView();s?h.FinishLaunchPrintPreview(p.records[0],c._jsGridParams,e,t,n,u,a,i,s,o,c.parentNode.clientWidth-c.objBag.paneMgr.GetSplitterPosition()-r.JsGridConstants.Internal.SplitterWidth,c.objBag.paneMgr.GetGanttZoomLevel(),f,l):h.FinishLaunchPrintPreview(p.records[0],c._jsGridParams,e,t,n,u,a,i,s,null,0,0,null,null)})})};e.prototype.GetAllDataJson=function(e,t){this.paneMgr.GetAllDataJson(e,t)};e.prototype.GetAllDataAfterExpansionJson=function(e,t){this.paneMgr.GetAllDataAfterExpansionJson(e,t)};e.prototype.AddColumn=function(e,t){this.paneMgr.AddColumn(e);this.objBag.entryRecordMgr.AddColumn(e.columnKey,t)};e.prototype.SetTableView=function(e){this._jsGridParams.tableViewParams=this.parentNode.jsgridtableviewparams=e;this.parentNode.jsgridrowviewparams=e.rowViewParams;this.FireTestEvent(this.TestEventType.Start);this.SetTableView(e);this.FireTestEvent(this.TestEventType.Finish)};e.prototype.SetTableViewInternal=function(e){this.bViewSet&&this.ClearTableView();this.bViewSet=!0;this.HideInitialLoadingBanner();this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.GetGridRowStyleId)&&(e.fnGetGridRowStyleId=this.delegateMgr.GetDelegate(r.JsGridConstants.DelegateType.GetGridRowStyleId));null!=this._oldStyleAttachedRightClickFn&&this.eventMgr.DetachEvent(r.JsGridConstants.EventType.OnRightClick,this._oldStyleAttachedRightClickFn);this._oldStyleAttachedRightClickFn=null==e.fnOnRightClick?null:function(t){e.fnOnRightClick(t.eventInfo,t.context,t.recordKey,t.fieldKey)};null!=this._oldStyleAttachedRightClickFn&&this.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRightClick,this._oldStyleAttachedRightClickFn);this.posConverter=new p.PositionConverter(this.tableCache,this.objBag);if(null!=e.operationalConstantsFieldKeyMap){this.operationalConstantsFieldKeyMap=e.operationalConstantsFieldKeyMap;this.operationalUtil=this.GetOperationalUtility()}n.JsGridUtil.DebugAssert(!e.bNewRowEnabled||this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.CreateEntryRecord)&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.TryInsertEntryRecord));n.JsGridUtil.DebugAssert(null!=this.operationalUtil);this.controller.SetTableView(e.rowViewParams,e.columns,e.gridFieldMap,e.defaultEditMode,e.bNewRowEnabled,e.bEditingEnabled,e.splitterPos,this.posConverter,this.operationalUtil,e.fnGetGridRowStyleId,e.allowedSelectionTypes,e.bMovableColumns,e.bResizableColumns,e.bHidableColumns,e.bSortableColumns,e.bAutoFilterableColumns,e.bRowHeadersEnabled,e.paneLayout,e.ganttParams,e.pivotedGridParams,e.bRecordIndicatorCheckboxesEnabled,e.checkSelectionCheckboxHiddenRecordKeys,e.checkSelectionCheckboxDisabledRecordKeys,e.checkSelectionCheckedRecordKeys)};e.prototype.SetRowView=function(e){this._jsGridParams.tableViewParams.rowViewParams=this.parentNode.jsgridrowviewparams=e;this.FireTestEvent(this.TestEventType.Start);this.controller.SetRowView(e);this.FireTestEvent(this.TestEventType.Finish)};e.prototype.Enable=function(){this.SetEnabledState(!0)};e.prototype.Disable=function(e){this.SetEnabledState(!1,e)};e.prototype.EnableEditing=function(){this.controller.EnableEditing()};e.prototype.DisableEditing=function(){this.controller.DisableEditing()};e.prototype.TryBeginEdit=function(){return this.controller.TryBeginEdit()};e.prototype.FinalizeEditing=function(e,t){this.controller.FinalizeEditing(e,t)};e.prototype._GetPaneManager=function(){return this.objBag.paneMgr};e.prototype.GetColumnByFieldKey=function(e,t){var n=this.paneMgr.GetGridPane().GetGridPaneConverter().FieldKeyToColIdx(e);return null==n?null:this.paneMgr.GetColumns(t)[n]};e.prototype.Focus=function(){this.paneMgr.Focus()};e.prototype.TryCommitFirstEntryRecords=function(e){this.objBag.entryRecordMgr.TryCommitFirstEntryRecords(e,!0)};e.prototype.ClearUncommittedEntryRecords=function(){this.objBag.entryRecordMgr.ClearUncommittedEntryRecords()};e.prototype.ClearEntryRecord=function(e){this.objBag.entryRecordMgr.ClearEntryRecord(e)};e.prototype.AnyUncomittedEntryRecords=function(){return null!=this.objBag&&null!=this.objBag.entryRecordMgr&&this.objBag.entryRecordMgr.AnyUncomittedEntryRecords()};e.prototype.AnyUncomittedProvisionalRecords=function(){return null!=this.objBag&&null!=this.objBag.provisionalRecordMgr&&this.objBag.provisionalRecordMgr.AnyUncomittedProvisionalRecords()};e.prototype.GetRecord=function(e){return this.objBag.entryRecordMgr.IsEntryRecordKey(e)?this.objBag.entryRecordMgr.GetEntryRecord(e):this.objBag.tableCache.GetCachedRecord(e)};e.prototype.GetEntryRecord=function(e){return this.objBag.entryRecordMgr.GetEntryRecord(e)};e.prototype.IsEntryRecordKey=function(e){return this.objBag.entryRecordMgr.IsEntryRecordKey(e)};e.prototype.IsCellEditable=function(e,t,n){return this.paneMgr.IsCellEditable(e,t,n)};e.prototype.AddBuiltInRowHeaderState=function(e,t){this.AddRowHeaderState(e,this.objBag.rowHeaderStates[t])};e.prototype.AddRowHeaderState=function(e,t){this.objBag.rowHeaderStateMgr.AddRowHeaderState(e,t)};e.prototype.RemoveRowHeaderState=function(e,t){this.objBag.rowHeaderStateMgr.RemoveRowHeaderState(e,t)};e.prototype.GetCheckSelectionManager=function(){return this.controller.GetCheckSelectionManager()};e.prototype.UpdateProperties=function(e,t,r){var i=this.controller.UpdateProperties(e,t,r,null);n.JsGridUtil.DebugAssert(null!=i,"can't update the NewRow programmatically");return i};e.prototype.GetLastRecordKey=function(){return this.objBag.paneMgr.GetLastRecordKey()};e.prototype.InsertProvisionalRecordBefore=function(e,t,n){return this.objBag.provisionalRecordMgr.InsertProvisionalRecordBefore(e,t,n)};e.prototype.InsertProvisionalRecordAfter=function(e,t,n){null==e&&(e=this.objBag.paneMgr.GetLastRecordKey());return this.objBag.provisionalRecordMgr.InsertProvisionalRecordAfter(e,t,n)};e.prototype.IsProvisionalRecordKey=function(e){return this.objBag.provisionalRecordMgr.IsProvisionalRecordKey(e)};e.prototype.InsertRecordAfter=function(e,t,n){return this.controller.InsertRecordAfter(e,t,n,!0)};e.prototype.InsertRecordBefore=function(e,t,n){return this.controller.InsertRecordBefore(e,t,n,!0)};e.prototype.InsertHiddenRecord=function(e,t,n){return this.controller.InsertHiddenRecord(e,t,n)};e.prototype.DeleteRecords=function(e,t){return this.controller.DeleteRecords(e,t)};e.prototype.IndentRecords=function(e,t){return this.controller.AdjustRecordsIndentLevel(e,1,t)};e.prototype.OutdentRecords=function(e,t){return this.controller.AdjustRecordsIndentLevel(e,-1,t)};e.prototype.ReorderRecords=function(e,t,n,r){return this.controller.ReorderRecords(e,t,n,r)};e.prototype.GetContiguousRowSelectionWithoutEntryRecords=function(){var e=this,t=function(t){for(var n=[],r=0;r<t.length;r++)e.IsEntryRecordKey(t[r])||n.push(t[r]);return n},n=(function(e){if(e.length<=1)return e;var t=e.slice(0);t.sort(function(e,t){return e.begin<t.begin});for(var n=[t[0]],r=1;r<t.length;r++){if(n[0].end+1!=t[r].begin)return e;n[0].end=t[r].end;n[0].keys.push(t[r].keys)}return n})(this.GetSelectedRowRanges());return 1==n.length?{begin:n[0].begin,end:n[0].end,keys:t(n[0].keys)}:1==(n=this.GetSelectedCellRanges()).length&&n[0].rowRange.keys.length>0?{begin:n[0].rowRange.begin,end:n[0].rowRange.end,keys:t(n[0].rowRange.keys)}:null};e.prototype.CanMoveRecordsUpByOne=function(e){return!(!this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.CanReorderRecords)||!this.delegateMgr.Apply(r.JsGridConstants.DelegateType.CanReorderRecords,e))&&(!(this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.OnBeforeRecordReordered)&&!this.delegateMgr.Apply(r.JsGridConstants.DelegateType.OnBeforeRecordReordered,e))&&(0!=(e=this.GetReorderRange(e)).length&&this.posConverter.RecordKeyToViewIdx(e[0])>0))};e.prototype.CanMoveRecordsDownByOne=function(e){return!(!this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.CanReorderRecords)||!this.delegateMgr.Apply(r.JsGridConstants.DelegateType.CanReorderRecords,e))&&(!(this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.OnBeforeRecordReordered)&&!this.delegateMgr.Apply(r.JsGridConstants.DelegateType.OnBeforeRecordReordered,e))&&(0!=(e=this.GetReorderRange(e)).length&&this.posConverter.RecordKeyToViewIdx(e[e.length-1])<this.GetViewRecordCount()-1))};e.prototype.MoveRecordsUpByOne=function(e){e=this.GetReorderRange(e);var t=this.posConverter.RecordKeyToViewIdx(e[0]),n=this.posConverter.ViewIdxToRecordKey(t-1);return this.ReorderRecords(e[0],e[e.length-1],n,!0)};e.prototype.MoveRecordsDownByOne=function(e){e=this.GetReorderRange(e);var t=this.posConverter.RecordKeyToViewIdx(e[e.length-1]),n=this.posConverter.ViewIdxToRecordKey(t+2);this.IsEntryRecordKey(n)&&(n=null);return this.ReorderRecords(e[0],e[e.length-1],n,!0)};e.prototype.GetReorderRange=function(e){return e};e.prototype.GetNodeExpandCollapseState=function(e){return this.controller.GetNodeExpandCollapseState(e)};e.prototype.ToggleExpandCollapse=function(e){this.controller.ToggleExpandCollapse(e)};e.prototype.AttachEvent=function(e,t){this.eventMgr.AttachEvent(e,t)};e.prototype.DetachEvent=function(e,t){this.eventMgr.DetachEvent(e,t)};e.prototype.SetDelegate=function(e,t){this.delegateMgr.SetDelegate(e,t)};e.prototype.GetDelegate=function(e){return this.delegateMgr.GetDelegate(e)};e.prototype.RefreshRow=function(e){this.paneMgr.NotifyChangedRows(this.posConverter.RecordKeyToViewIdx(e),1)};e.prototype.RefreshAllRows=function(e,t){this.paneMgr.RefreshAllRows(e,t)};e.prototype.ClearChanges=function(){this.controller.ClearChanges()};e.prototype.GetGanttZoomLevel=function(){return this.paneMgr.GetGanttZoomLevel()};e.prototype.SetGanttZoomLevel=function(e){this.paneMgr.SetGanttZoomLevel(e)};e.prototype.ScrollGanttToDate=function(e){this.paneMgr.ScrollGanttToDate(e)};e.prototype.ScrollCellIntoView=function(e,t,n){this.paneMgr.ScrollCellIntoView(e,t,n)};e.prototype.GetTopRecordIndex=function(){return this.posConverter.GetTopViewIdx()};e.prototype.GetTopRowIndex=function(e){return this.paneMgr.GetTopRowIndex(e)};e.prototype.GetViewRecordCount=function(){return this.posConverter.GetViewRecordCount()};e.prototype.GetViewIndexOfRecord=function(e){return this.posConverter.RecordKeyToViewIdx(e)};e.prototype.GetRecordKeyByViewIndex=function(e){return this.posConverter.ViewIdxToRecordKey(e)};e.prototype.GetLeftColumnIndex=function(e){return this.paneMgr.GetLeftColumnIndex(e)};e.prototype.GetOutlineLevel=function(e){return this.controller.GetOutlineLevel(e)};e.prototype.ShowColumn=function(e,t){this.paneMgr.ShowColumn(e,t)};e.prototype.HideColumn=function(e){this.paneMgr.HideColumn(e)};e.prototype.EnsurePaneWidth=function(){this.paneMgr.EnsurePaneWidth()};e.prototype.RenameColumn=function(e){this.paneMgr.RenameColumn(e)};e.prototype.UpdateColumns=function(e){this.paneMgr.UpdateColumns(e)};e.prototype.GetColumns=function(e){return this.paneMgr.GetColumns(e)};e.prototype.GetSplitterPosition=function(){return this.paneMgr.GetSplitterPosition()};e.prototype.SetSplitterPosition=function(e){this.paneMgr.SetSplitterPosition(e)};e.prototype.AnyErrors=function(){return this.objBag.errorMgr.AnyErrors()};e.prototype.AnyErrorsInRecord=function(e){return this.objBag.errorMgr.AnyErrorsInRow(e)};e.prototype.SetCellError=function(e,t,n){return this.objBag.errorMgr.SetCellError(e,t,n)};e.prototype.SetRowError=function(e,t){return this.objBag.errorMgr.SetRowError(e,t)};e.prototype.ClearCellError=function(e,t,n){this.objBag.errorMgr.ClearCellError(e,t,n)};e.prototype.ClearAllErrorsOnCell=function(e,t){this.objBag.errorMgr.ClearAllErrorsOnCell(e,t)};e.prototype.ClearRowError=function(e,t){this.objBag.errorMgr.ClearRowError(e,t)};e.prototype.ClearAllErrorsOnRow=function(e){return this.objBag.errorMgr.ClearAllErrorsOnRow(e)};e.prototype.GetRowErrorMessage=function(e){return this.objBag.errorMgr.GetMessageForRow(e)};e.prototype.GetCellErrorMessage=function(e,t){return this.objBag.errorMgr.GetMessageForCell(e,t)};e.prototype.ScrollToAndExpandNextError=function(e,t){return this.objBag.paneMgr.ScrollToAndExpandNextError(e,null,t)};e.prototype.ScrollToAndExpandNextErrorOnRecord=function(e,t,r,i){n.JsGridUtil.DebugAssert(null!=t);return this.objBag.paneMgr.ScrollToAndExpandNextError(e,t,r,i)};e.prototype.GetFocusedItem=function(){return this.paneMgr.GetFocusedItemInfo()};e.prototype.SendKeyDownEvent=function(e){return this.objBag.focusMgr.HandleKeyDown(e)};e.prototype.JumpToEntryRecord=function(){this.paneMgr.JumpToEntryRecord()};e.prototype.SelectRowRange=function(e,t,n,r){this.paneMgr.Select(e,t,null,null,n,r)};e.prototype.SelectColumnRange=function(e,t,n,r){this.paneMgr.Select(null,null,e,t,n,r)};e.prototype.SelectCellRange=function(e,t,n,r,i,s){this.paneMgr.Select(e,t,n,r,i,s)};e.prototype.SelectRowRangeByKey=function(e,t,n,r){this.paneMgr.SelectByKey(e,t,null,null,n,r)};e.prototype.SelectColumnRangeByKey=function(e,t,n,r){this.paneMgr.SelectByKey(null,null,e,t,n,r)};e.prototype.SelectCellRangeByKey=function(e,t,n,r,i,s){this.paneMgr.SelectByKey(e,t,n,r,i,s)};e.prototype.ChangeKeys=function(e,t){this.objBag.controller.ChangeKeys(e,t)};e.prototype.GetSelectedRowRanges=function(e){return this.paneMgr.GetOrderedSelections(e,r.JsGridConstants.SelectionType.RowRange)};e.prototype.GetSelectedColumnRanges=function(e){return this.paneMgr.GetOrderedSelections(e,r.JsGridConstants.SelectionType.ColumnRange)};e.prototype.GetSelectedCellRanges=function(e){return this.paneMgr.GetOrderedSelections(e,r.JsGridConstants.SelectionType.CellRange)};e.prototype.GetSelectedRanges=function(e){return this.paneMgr.GetOrderedSelections(e,null)};e.prototype.MarkPropUpdateInvalid=function(e,t,n,r){return this.controller.MarkPropUpdateInvalid(e,t,n,r)};e.prototype.GetCurrentChangeKey=function(){return this.controller.GetCurrentChangeKey()};e.prototype.CreateAndSynchronizeToNewChangeKey=function(){var e=this.controller.CreateDataUpdateCmd();this.commandMgr.Execute(e,null,d.CommandManagerConstants.CommandType.Explicit);return e.GetChangeKey()};e.prototype.CreateDataUpdateCmd=function(e){return this.controller.CreateDataUpdateCmd(e)};e.prototype.IsChangeKeyApplied=function(e){return this.objBag.controller.IsChangeKeyApplied(e)};e.prototype.GetChangeKeyForVersion=function(e){return this.controller.GetChangeKeyForVersion(e)};e.prototype.TryReadPropForChangeKey=function(e,t,n){return this.controller.TryReadPropForChangeKey(e,t,n)};e.prototype.GetUnfilteredHierarchyMap=function(){return null};e.prototype.GetHierarchyState=function(e){return null};e.prototype.IsGroupingRecordKey=function(e){return!1};e.prototype.IsGroupingColumnKey=function(e){return!1};e.prototype.GetSelectedRecordKeys=function(e){return this.GetSelectedRecordKeysInternal(e)};e.prototype.CutToClipboard=function(){var e=this.objBag.selectionMgr.GetFocusedPane();null!=e&&this.objBag.cutcopypasteMgr.OnCut(e)};e.prototype.CopyToClipboard=function(){var e=this.objBag.selectionMgr.GetFocusedPane();null!=e&&this.objBag.cutcopypasteMgr.OnCopy(e)};e.prototype.PasteFromClipboard=function(){var e=this.objBag.selectionMgr.GetFocusedPane();null!=e&&this.objBag.cutcopypasteMgr.OnPaste(e)};e.prototype.TryRestoreFocusAfterInsertOrDeleteColumns=function(e){var t=this.objBag.selectionMgr.GetFocusedPane();null!=t&&t.TryRestoreFocusAfterInsertOrDeleteColumns(e)};e.prototype.GetUndoManager=function(){return this.commandMgr};e.prototype.GetVisibleRecordCount=function(){return this.objBag.paneMgr.GetVisibleRecordCount()};e.prototype.GetRecordIndicatorCheckBoxColumnIndex=function(){return this.objBag.paneMgr.GetRecordIndicatorCheckBoxColumnIndex()};e.prototype.IsRecordVisibleInView=function(e){return null!=this.posConverter.RecordKeyToViewIdx(e)};e.prototype.GetHierarchyQueryObject=function(){return null};e.prototype.StopEditing=function(){this.objBag.paneMgr.StopEditing(!1)};e.prototype.GetSelectedRecordKeysInternal=function(e){var t,n=this.GetSelectedRowRanges(),r=this.GetSelectedColumnRanges(),s=this.GetSelectedCellRanges();if(0!==r.length)t=this.tableCache.GetView();else if(e){t=[];for(var o=0;o<n.length;o++)t=t.concat(n[o].keys);for(o=0;o<s.length;o++)t=t.concat(s[o].rowRange.keys)}else{var u=new i.Set;for(o=0;o<n.length;o++)u.AddArray(n[o].keys);for(o=0;o<s.length;o++)u.AddArray(s[o].rowRange.keys);t=u.ToArray()}return t};e.prototype.StaticInit=function(){this._bStaticInit||(this._bStaticInit=!0)};e.prototype.GetOperationalUtility=function(){var e=this,t=function(t){return e.operationalConstantsFieldKeyMap[t]};return{GetFieldKey:t,GetProp:function(e,n){var r=t(n);return{fieldKey:r,prop:e.GetProp(r)}},GetValue:function(e,n){return e.GetDataValue(t(n))}}};e.prototype.CallAsyncFn=function(e,t){return n.JsGridUtil.Internal.CallAsyncFn(e,t,function(){this.Disable()},function(){this.Enable()})};e.prototype.DoLargeTask=function(e,t,r,i,s){var o=this,u=0;if(e>t){this.Disable();n.JsGridUtil.AsynchronousTaskManager.GetInstance().RegisterTask(function(){var n=(Math.floor(u/t)+1)*t;if((u=r(u,n))<e)return!0;o.Enable();i();return!1},s)}else{r(0,e);i()}};e.prototype.GetLocalizedString=function(e){e=e.charAt(0).toLowerCase()+e.substr(1);var t=this._jsGridParams.tableViewParams.messageOverrides;return t&&t[e]||SP.JsGrid.Res[e]};e.prototype.FireTestEvent=function(e){if(this.parentNode.fireEvent)switch(e){case this.TestEventType.Start:this.parentNode.fireEvent("onbeforeupdate");break;case this.TestEventType.Finish:this.parentNode.fireEvent("onafterupdate")}};e.prototype.SetEnabledState=function(e,t){if(e&&1==this.disableCount)this.loadingBanner.Hide();else if(!e){var r=null==t?SP.JsGrid.Res.loadingMsg:t;0==this.disableCount?this.loadingBanner.Show(r):this.loadingBanner.UpdateText(r)}this.disableCount-=e?1:-1;null!=this.objBag.ariaMgr&&this.objBag.ariaMgr.EnableGrid(e);n.JsGridUtil.DebugAssert(this.disableCount>=0)};e.prototype.GetSpCsrRenderCtx=function(){return this.spCsrRenderCtx};return e})();t.JsGridControl=v;var m=function(){this.tableCache=null;this.name=null;this.bNotificationsEnabled=!1;this.styleManager=s.Style.getInstance().MakeJsGridStyleManager();this.minHeaderHeight=0;this.minRowHeight=0;this.commandMgr=new d.CommandManager(100);this.enabledRowHeaderAutoStates=(new i.Set).AddArray([r.JsGridConstants.RowHeaderAutoStyleId.Error]);this.isRTL="rtl"==n.JsGridUtil.Utility.GetDocumentDirection();this.tableViewParams=new g};t.JsGridControlParameters=m;var g=function(){this.keyFieldName=null;this.columns=null;this.gridFieldMap=null;this.messageOverrides=null;this.operationalConstantsFieldKeyMap=null;this.defaultEditMode=r.JsGridConstants.EditMode.ReadWriteDefer;this.allowedSelectionTypes=r.JsGridConstants.SelectionTypeFlags.MultipleCellRanges|r.JsGridConstants.SelectionTypeFlags.MultipleRowRanges|r.JsGridConstants.SelectionTypeFlags.MultipleColRanges;this.bMovableColumns=!0;this.bResizableColumns=!0;this.bHidableColumns=!0;this.bSortableColumns=!0;this.bAutoFilterableColumns=!0;this.bRowHeadersEnabled=!0;this.bRecordIndicatorCheckboxesEnabled=!1;this.bCreateFieldColumnEnabled=!1;this.bFillControlEnabled=!0;this.checkSelectionCheckboxHiddenRecordKeys=[];this.checkSelectionCheckboxDisabledRecordKeys=[];this.checkSelectionCheckedRecordKeys=[];this.bEditingEnabled=!1;this.bNewRowEnabled=!1;this.splitterPos=400;this.paneLayout=r.JsGridConstants.PaneLayout.GridOnly;this.ganttParams=null;this.pivotedGridParams=null;this.rowViewParams=new y};t.TableViewParameters=g;var y=function(){this.view=null;this.minimalInfo=null;this.topViewIdx=0;this.hierarchyMode=r.JsGridConstants.HierarchyMode.None;this.groupingLevel=null;this.groupingRecordKeyPrefix;this.autoFilterState=null;this.unfilteredHierarchyMgr=null;this.hierarchyDelayLoadKeys=null;this.hierarchyState=null;this.sortState=null;this.filterState=null;this.autoFilterEntries=null;this.filteredDescCounts=null};t.RowViewParameters=y;var b=function(){this.columns=null};t.PivotedGridParameters=b;var w=function(){this.dateRange=null;this.ganttBarStyles=null;this.ganttZoomLevel=3;this.fnRenderGanttRow=null;this.fnGetGanttBarDate=null;this.fnGetGanttBarStyleIds=null;this.fnGetPredecessors=null;this.workDayStart=n.JsGridUtil.SpRegionalSettings.workDayStart;this.workDayEnd=n.JsGridUtil.SpRegionalSettings.workDayEnd;this.fieldKeyRedrawFilter=null};t.GanttParameters=w});
define("aQ2",["require","exports","aPS","aQo","aQn","di","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o){"use strict";o=o.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var u={ODB:1725};t.ErrorType={Row:1,Cell:2};var a=(function(){function e(e){this._rowErrs=new c;this._cellErrs={};this._key=e}e.prototype.AddRowError=function(e,t){this._rowErrs.AddError(e,t)};e.prototype.AddCellError=function(e,t,n){e in this._cellErrs||(this._cellErrs[e]=new c);this._cellErrs[e].AddError(t,n)};e.prototype.ClearRowError=function(e){return this._rowErrs.RemoveError(e)};e.prototype.ClearCellError=function(e,t){if(e in this._cellErrs&&this._cellErrs[e].RemoveError(t)){this._cellErrs[e].AnyErrors()||delete this._cellErrs[e];return!0}return!1};e.prototype.ClearAllErrorsOnCell=function(e){e in this._cellErrs&&delete this._cellErrs[e]};e.prototype.ClearAllErrorsOnRow=function(){this._rowErrs=new c};e.prototype.AnyErrors=function(){return this._rowErrs.AnyErrors()||!r.JsGridUtil.Internal.IsAssocArrayEmpty(this._cellErrs)};e.prototype.AnyErrorsOnCell=function(e){return e in this._cellErrs&&this._cellErrs[e].AnyErrors()};e.prototype.AnyErrorsOnRow=function(){return this._rowErrs.AnyErrors()};e.prototype.GetMessageForCell=function(e){return e in this._cellErrs?this._cellErrs[e].GetTopMessage(e):null};e.prototype.GetMessageForRow=function(){return this._rowErrs.GetTopMessage()};e.prototype.GetIdForCell=function(e){return e in this._cellErrs?this._cellErrs[e].GetTopId():null};e.prototype.GetIdForRow=function(){return this._rowErrs.GetTopId()};e.prototype.GetMinError=function(e,n){var r=this,i=this._rowErrs.GetMinError(null!=e?function(t){return e(r._key,null,t)}:null);null!=i&&(i.type=t.ErrorType.Row);for(var s in this._cellErrs){var o=this._cellErrs[s].GetMinError(null!=e?function(t){return e(r._key,s,t)}:null);if(null!=o&&(null==i||o.id<i.id)){(i=o).fieldKey=s;i.type=t.ErrorType.Cell}}return i};return e})();t.RecordErrorCollection=a;var f=(function(){function e(e){this._curId=0;this._errors={};this._currentlyDeletedRecords=new i.Set;e.intEventMgr.AttachEvent(n.JsGridConstants.Internal.EventType.OnBeforeRecordInserted,this.OnRecordInserted.bind(this));e.intEventMgr.AttachEvent(n.JsGridConstants.Internal.EventType.OnBeforeRecordDeleted,this.OnRecordDeleted.bind(this));this._objBag=e}e.prototype.SetRowError=function(e,t){var i=this.AnyErrors();null==this._errors[e]&&(this._errors[e]=new a(e));var s=this._curId++;t=null!=t?t:SP.JsGrid.Res.defaultRowMessage;var o=i&&this._errors[e].AnyErrorsOnRow();this._errors[e].AddRowError(s,t);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnRowErrorStateChanged,r.JsGridUtil.EventArgs.OnRowErrorStateChanged(e,!0,!0,o,s,t));i||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!0));return s};e.prototype.ClearRowError=function(e,t){if(null!=this._errors[e]&&this._errors[e].ClearRowError(t)){this.TryCleanUpRecord(e);var i=e in this._errors&&this._errors[e].AnyErrorsOnRow();this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnRowErrorStateChanged,r.JsGridUtil.EventArgs.OnRowErrorStateChanged(e,!1,i,!0,t,null));this.AnyErrors()||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1));return!0}return!1};e.prototype.SetCellError=function(e,t,i){var s=this.AnyErrors();null==this._errors[e]&&(this._errors[e]=new a(e));var o=this._errors[e].AnyErrorsOnCell(t),u=this._curId++;this._errors[e].AddCellError(t,u,i);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnCellErrorStateChanged,r.JsGridUtil.EventArgs.OnCellErrorStateChanged(e,t,!0,!0,o,u));s||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!0));return u};e.prototype.ClearCellError=function(e,t,i){if(null!=this._errors[e]&&this._errors[e].ClearCellError(t,i)){this.TryCleanUpRecord(e);var s=e in this._errors&&this._errors[e].AnyErrorsOnCell(t);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnCellErrorStateChanged,r.JsGridUtil.EventArgs.OnCellErrorStateChanged(e,t,!1,s,!0,i));this.AnyErrors()||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1));return!0}return!1};e.prototype.ClearAllErrorsOnRow=function(e){var t=!1;if(e in this._errors){t=!0;this._errors[e].ClearAllErrorsOnRow();this.TryCleanUpRecord(e);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnRowErrorStateChanged,r.JsGridUtil.EventArgs.OnRowErrorStateChanged(e,!1,!1,-1,null,null));this.AnyErrors()||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1))}return t};e.prototype.ClearAllErrorsOnCell=function(e,t){var i=!1;if(e in this._errors&&this._errors[e].AnyErrorsOnCell(t)){i=!0;var s=this._errors[e].GetIdForCell(t);this._errors[e].ClearAllErrorsOnCell(t);this.TryCleanUpRecord(e);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnCellErrorStateChanged,r.JsGridUtil.EventArgs.OnCellErrorStateChanged(e,t,!1,!1,s,null));this.AnyErrors()||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1))}return i};e.prototype.CellHasError=function(e,t){return e in this._errors&&!this._currentlyDeletedRecords.Contains(e)&&this._errors[e].AnyErrorsOnCell(t)};e.prototype.GetMessageForCell=function(e,t){return e in this._errors&&!this._currentlyDeletedRecords.Contains(e)?this._errors[e].GetMessageForCell(t):null};e.prototype.GetMessageForRow=function(e){return e in this._errors&&!this._currentlyDeletedRecords.Contains(e)?this._errors[e].GetMessageForRow():null};e.prototype.AnyErrors=function(){var e=!1;for(var t in this._errors)if(!this._currentlyDeletedRecords.Contains(t)){e=!0;break}return e};e.prototype.AnyErrorsInRow=function(e){return e in this._errors&&!this._currentlyDeletedRecords.Contains(e)&&this._errors[e].AnyErrors()};e.prototype.GetNextError=function(e,t){var n=null;if(this.AnyErrors()){null!=e&&e<this._curId&&(n=this.GetMinError(function(n,r,i){return i>e&&(null==t||t(n,r,i))}));null==n&&(n=this.GetMinError(t))}return n};e.prototype.GetNextErrorForRecord=function(e,t,n){var r=null;if(t in this._errors&&!this._currentlyDeletedRecords.Contains(t)){null!=e&&e<this._curId&&(r=this._errors[t].GetMinError(function(t,r,i){return i>e&&(null==n||n(t,r,i))}));null==r&&(r=this._errors[t].GetMinError(n));null!=r&&(r.recordKey=t)}return r};e.prototype.ChangeKeys=function(e,t){if(this._currentlyDeletedRecords.Contains(e)){this._currentlyDeletedRecords.Remove(e);this._currentlyDeletedRecords.Add(t)}if(e in this._errors){this._errors[t]=this._errors[e];delete this._errors[e]}};e.prototype.GetMinError=function(e){var t=null;for(var n in this._errors){var r=this._errors[n].GetMinError(e);null!=r&&(null==t||r.id<t.id)&&((t=r).recordKey=n)}return t};e.prototype.OnRecordInserted=function(e){var t=this.AnyErrors();this._currentlyDeletedRecords.Remove(e.recordKey);!t&&this.AnyErrors()&&this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!0))};e.prototype.OnRecordDeleted=function(e){var t=this.AnyErrors();this._currentlyDeletedRecords.Add(e.recordKey);t&&!this.AnyErrors()&&this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1))};e.prototype.TryCleanUpRecord=function(e){this._errors[e].AnyErrors()||delete this._errors[e]};return e})();t.ErrorManager=f;var l=(function(){function e(){this._notificationId=null;this._lastExpandedId=null}Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0});e.prototype.Init=function(e,t){var r=this;this._objBag=t;this._objBag.eventMgr.AttachEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,this.NotifyError);this._id=e;window[this._id+"_onclick"]=function(){r._lastExpandedId=r._objBag.jsGridObj.ScrollToAndExpandNextError(r._lastExpandedId)}};e.prototype.NotifyError=function(e){if(e.bAnyErrors&&null==this._notificationId)this._notificationId=addNotification((r.JsGridUtil.Internal.IsFeatureEnabled(u),o.spGridErrorNotification),!0);else if(!e.bAnyErrors&&null!=this._notificationId){removeNotification(this._notificationId);this._notificationId=null}};return e})();t.ErrorNotificationManager=l;var c=(function(){function e(){this._errors=[]}e.prototype.AddError=function(e,t){this._errors.unshift({id:e,msg:t})};e.prototype.RemoveError=function(e){var t=r.JsGridUtil.Internal.FindInArray(this._errors,function(t){return e==t.id});if(null!=t){this._errors.splice(t,1);return!0}return!1};e.prototype.AnyErrors=function(){return 0!==this._errors.length};e.prototype.GetTopMessage=function(){return this._errors.length>0?this._errors[0].msg:null};e.prototype.GetTopId=function(){return this._errors.length>0?this._errors[0].id:null};e.prototype.GetMinError=function(e){for(var t=null,n=this._errors.length-1;n>=0;n--){var r=this._errors[n];(null==e||e(r.id))&&(t={message:r.msg,id:r.id})}return t};e.prototype.ContainsError=function(e){return null!=r.JsGridUtil.Internal.FindInArray(this._errors,function(t){return e==t.id},null)};return e})()});
define("aQ0",["require","exports","aQo","aPS","oJ","jm","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o){"use strict";var u=o.RowHeaderState_3;o=o.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var a={ODB:1725},f=(function(){function e(e){this._rowHeaderStates={};this._intEventMgr=e}e.prototype.AddRowHeaderState=function(e,t){var i=null;e in this._rowHeaderStates?i=this._rowHeaderStates[e][0]:this._rowHeaderStates[e]=[];var s=this._rowHeaderStates[e],o=n.JsGridUtil.Internal.LowerBoundCompare(s,t.GetPriority(),function(e,t){return t>s[e].GetPriority()});s.splice(o,0,t);null!=i&&s[0].GetId()===i.GetId()||this._intEventMgr.FireEvent(r.JsGridConstants.Internal.EventType.OnRowHeaderStateChanged,n.JsGridUtil.Internal.EventArgs.OnRowHeaderStateChanged(e,s[0]))};e.prototype.RemoveRowHeaderState=function(e,t){if(e in this._rowHeaderStates){var i=this._rowHeaderStates[e][0];this.RemoveLastStateWithId(this._rowHeaderStates[e],t);0==this._rowHeaderStates[e].length&&delete this._rowHeaderStates[e];null!=this._rowHeaderStates[e]&&i.GetId()===this._rowHeaderStates[e][0].GetId()||this._intEventMgr.FireEvent(r.JsGridConstants.Internal.EventType.OnRowHeaderStateChanged,n.JsGridUtil.Internal.EventArgs.OnRowHeaderStateChanged(e,this._rowHeaderStates[e]&&this._rowHeaderStates[e][0]))}};e.prototype.ChangeKeys=function(e,t){if(e in this._rowHeaderStates){this._rowHeaderStates[t]=this._rowHeaderStates[e];delete this._rowHeaderStates[e]}};e.prototype.GetRowHeaderState=function(e){return e in this._rowHeaderStates?this._rowHeaderStates[e][0]:null};e.prototype.RemoveLastStateWithId=function(e,t){for(var n=0;n<e.length;n++)if(e[n].GetId()==t){e.splice(n,1);break}};return e})();t.RowHeaderStateManager=f;var l=(function(){function e(e,t,n,r,i){this.id=e;this.img=t;this.priority=n;this.tooltip=r;this.fnOnClick=i}e.prototype.GetId=function(){return this.id};e.prototype.GetImg=function(){return this.img};e.prototype.GetPriority=function(){return this.priority};e.prototype.GetOnClick=function(){return this.fnOnClick};e.prototype.GetTooltip=function(){return this.tooltip};e.prototype.toString=function(){return this.id};return e})();t.RowHeaderState=l;var c=function(e){this[r.JsGridConstants.RowHeaderStyleId.Transfer]=new l(r.JsGridConstants.RowHeaderStyleId.Transfer,new n.JsGridUtil.ImageWithFabricIcons({spinnerProps:{size:i.SpinnerSize.xSmall,styles:n.JsGridUtil.Internal.IsFeatureEnabled(a)?{circle:{width:14,height:14}}:{}}}),r.JsGridConstants.RowHeaderStatePriorities.Transfer,SP.JsGrid.Res.transferHeaderStateTooltip,null);this[r.JsGridConstants.RowHeaderStyleId.Conflict]=new l(r.JsGridConstants.RowHeaderStyleId.Conflict,new n.JsGridUtil.ImageWithFabricIcons({imgSrc:n.JsGridUtil.Internal.SiteUrl+r.JsGridConstants.ImagesDirectory+"jsgridcluster.png",bIsClustered:!0,optOuterCssNames:"clip16x16",optImgCssNames:"jsgridcluster_conflictheader"}),r.JsGridConstants.RowHeaderStatePriorities.Conflict,e.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.ExpandConflictResolution)?SP.JsGrid.Res.conflictHeaderStateClickTooltip:SP.JsGrid.Res.conflictHeaderStateTooltip,e.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.ExpandConflictResolution)?function(t,n){e.delegateMgr.Apply(r.JsGridConstants.DelegateType.ExpandConflictResolution,t,n)}:null);this[r.JsGridConstants.RowHeaderAutoStyleId.Dirty]=new l(r.JsGridConstants.RowHeaderAutoStyleId.Dirty,new n.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Edit"}}),r.JsGridConstants.RowHeaderStatePriorities.Dirty,SP.JsGrid.Res.editingHeaderStateTooltip,null)};t.RowHeaderStates=c;var h=function(e,t){this.autoRowStates=[[r.JsGridConstants.RowHeaderAutoStyleId.Dirty,function(e){t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnCellEditBegin,function(e){if(0==i){n=e.recordKey;t.jsGridObj.AddRowHeaderState(e.recordKey,s)}i++});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnCellEditCompleted,function(r){r.bCancelled&&i--;0==i&&r.bCancelled&&r.recordKey==n&&t.jsGridObj.RemoveRowHeaderState(n,e)});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRowFocusChanged,function(r){i>0&&t.jsGridObj.RemoveRowHeaderState(n,e);i=0;n=r.recordKey});var n,i,s=t.rowHeaderStates[r.JsGridConstants.RowHeaderAutoStyleId.Dirty]}],[r.JsGridConstants.RowHeaderAutoStyleId.Error,function(e){var i=document.createElement("span");i.id=e+"mainDiv";i.style.cssText="display:none; font-size:10; position:absolute; background-color:#FFE0E0; border:1px solid #DD3300; padding:5px 10px; color:#333333 !important;";i.style.cssText=i.style.cssText+"z-index: "+s.ZIndexes.ScrollablePane+";";document.body.appendChild(i);var f=null,c=null,h=e+"RowError",p=new l(e,new n.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Error",className:n.JsGridUtil.Internal.IsFeatureEnabled(a)?u.errorIcon:o.spGridErrorIcon}}),r.JsGridConstants.RowHeaderStatePriorities.CellError,SP.JsGrid.Res.errorHeaderStateTooltip,function(e,n){c!==n&&(f=null);f=t.jsGridObj.ScrollToAndExpandNextErrorOnRecord(f,n);c=n}),d=new l(h,new n.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Error",className:n.JsGridUtil.Internal.IsFeatureEnabled(a)?u.errorIcon:o.spGridErrorIcon}}),r.JsGridConstants.RowHeaderStatePriorities.RowError,SP.JsGrid.Res.rowErrorToolTip,function(e,r){if(i.curRecKey!==r){i.curRecKey=r;i.style.display="";n.JsGridUtil.Internal.DomElement.GetInstance().SetText(i,t.jsGridObj.GetRowErrorMessage(r));var s=(function(e){for(;null!=e&&"TD"!==e.tagName.toUpperCase();)e=e.parentNode;return e})(e.target);if(null!=s){var o=n.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(s);i.style.left=o.x+"px";i.style.top=o.y+s.offsetHeight+2+"px"}else{n.JsGridUtil.DebugAssert(!1);i.style.left=e.clientX+5+"px";i.style.top=e.clientY+5+"px"}}else{i.curRecKey=null;i.style.display="none"}});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnCellErrorStateChanged,function(n){n.bAddingError&&!n.bCellHadError?t.jsGridObj.AddRowHeaderState(n.recordKey,p):n.bCellCurrentlyHasError||t.jsGridObj.RemoveRowHeaderState(n.recordKey,e)});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRowErrorStateChanged,function(e){e.bAddingError&&!e.bRowHadError?t.jsGridObj.AddRowHeaderState(e.recordKey,d):e.bErrorCurrentlyInRow||t.jsGridObj.RemoveRowHeaderState(e.recordKey,h)});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRowFocusChanged,function(e){if(e.newRecordKey!==c){f=null;i.curRecKey=null;i.style.display="none"}});t.intEventMgr.AttachEvent(r.JsGridConstants.Internal.EventType.OnGridDisposing,function(){if(null!=i){i.curRecKey=null;i.innerHTML="";i=null}})}],[r.JsGridConstants.RowHeaderAutoStyleId.NewRow,function(e){var i=null,s=r.JsGridConstants.SUPERTEMPORARY_spcommonThemedData,o=new l(e,new n.JsGridUtil.ImageWithFabricIcons({imgSrc:s,bIsClustered:!0,optOuterCssNames:"clip16x16",optImgCssNames:"ms-addcolumn-icon"}),r.JsGridConstants.RowHeaderStatePriorities.NewRow,"",null);t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnEntryRecordAdded,function(n){null!=i&&t.jsGridObj.RemoveRowHeaderState(i,e);t.jsGridObj.AddRowHeaderState(n.recordKey,o);i=n.recordKey})}]];var i=n.JsGridUtil.Internal.ConvertTableToMap(this.autoRowStates,0,1);for(var f in i)e.Contains(f)&&(i[f]=new i[f](f));this.autoRowStates=null};t.AutoRowHeaderStates=h});
define("aQZ",["require","exports","aQo","aPS","aQn","aPY","aQp"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function u(e,t){for(var n={},r=0;r<e;r++)t.IsChangeKeyApplied(e[r].changeKey)&&(n[e[r].fieldKey]=0);return n}var a=(function(){function e(e){this._entryRecordKeyPrefix="NewRowKey";this._entryRecordKeys=new i.Set;this._entryRecords=[];this._entryRecordUpdates={};this._entryRecordKeyIdxCache={};this._committedRecordKeys=new i.Set;this._bRegisteredEvent=!1;this._bCurrentlyCommitting=!1;this._curEntryRecordIdx=0;this._bReadyToCommit=!1;this._commitErrorId=null;this._bClearingUncommittedChanges=!1;this._commitAttemptCompleteNotifiers=[];this._objBag=e}e.prototype.GetNextEntryRecordKey=function(){return this._entryRecordKeyPrefix+this._curEntryRecordIdx++};e.prototype.CreateEntryRecord=function(e,t){var i=null==t?this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.CreateEntryRecord):t;null==i.recordKey&&(i.recordKey=this.GetNextEntryRecordKey());n.JsGridUtil.DebugAssert(i.key()==i.recordKey);i.properties[this._objBag.jsGridParams.tableViewParams.keyFieldName].dataValue=i.recordKey;this._entryRecords.push(i);this._entryRecordKeyIdxCache[i.key()]=this._entryRecords.length-1;this._entryRecordKeys.Add(i.key());i.bIsNewRow=!0;i.newRowNumber=this._curEntryRecordIdx;this._objBag.paneMgr.NotifyCreateEntryRow(this._entryRecords.length-1,e);this._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnEntryRecordAdded,n.JsGridUtil.EventArgs.OnEntryRecordAdded(i.key()));return i};e.prototype.IsEntryRecordDirty=function(e){var t=this._objBag.controller.GetEarliestChangeKeyForRecord(e);return null!=t&&this._objBag.controller.IsChangeKeyApplied(t)};e.prototype.RemoveEntryRow=function(e,t){this._objBag.editUtil.IsNewRowEnabled()&&!t&&this._objBag.paneMgr.NotifyRemoveEntryRow(e);var n=this._entryRecords[e].key();this._entryRecords.splice(e,1);this._entryRecordKeys.Remove(n);this._entryRecordKeyIdxCache[n]=null;for(e=n+1;null!=this._entryRecordKeyIdxCache[e];++e)this._entryRecordKeyIdxCache[e]=this._entryRecordKeyIdxCache[e]-1;delete this._entryRecordUpdates[n];this._objBag.controller.ClearAllPropChangesForRecord(n);return n};e.prototype.RemoveLastEntryRecord=function(){var e=null;this._entryRecords.length>1&&(e=this.RemoveEntryRow(this._entryRecords.length-1));return e};e.prototype.ClearUncommittedEntryRecordsInternal=function(e,t){var n=this;this._bClearingUncommittedChanges=!0;this._objBag.paneMgr.StopEditing(!0);this._objBag.paneMgr.UnbindEditing(function(){if(null==t)for(;n._entryRecords.length>0;)n.RemoveEntryRow(0,e);else for(var r=0;r<n._entryRecords.length;r++)if(n._entryRecords[r].key()==t){n.RemoveEntryRow(r,e);break}n._bClearingUncommittedChanges=!1})};e.prototype.CreateEntryRecordWithChangeKey=function(e,t,r){var i=this,s=this.CreateEntryRecord(e,r);this._objBag.controller.AttachUndoActionToChangeKey(t,function(){var e=i.RemoveLastEntryRecord();n.JsGridUtil.DebugAssert(null==e||s.key()==e,"either the record we're removing should have been committed or it should be the record we added.")})};e.prototype.OnEntryRecordPropertyUpdated=function(e){this.GetLastEntryKey()==e.recordKey&&this.CreateEntryRecordWithChangeKey(!1,e.changeKey);if(e.validationState==r.JsGridConstants.ValidationState.Valid){null==this._entryRecordUpdates[e.recordKey]&&(this._entryRecordUpdates[e.recordKey]=[]);this._entryRecordUpdates[e.recordKey].push(e);e.recordKey==this._entryRecords[0].key()&&this.ForceReadyToCommit()}var t=this._objBag.paneMgr.GetFocusedItemInfo();null!=t&&t.recordKey==e.recordKey||this.TryCommitFirstEntryRecord()};e.prototype.ForceReadyToCommit=function(){this._bReadyToCommit=!0;if(null!=this._commitErrorId){var e=this._objBag.errorMgr.ClearRowError(this._entryRecords[0].key(),this._commitErrorId);n.JsGridUtil.DebugAssert(e);this._commitErrorId=null}};e.prototype.OnRowFocusChanged=function(e){this._entryRecords.length>0&&e.oldRecordKey==this._entryRecords[0].key()&&this.TryCommitFirstEntryRecord()};e.prototype.OnRecordFailedCommit=function(e,t){this._objBag.commandMgr.Unlock();this._bCurrentlyCommitting=!1;this._bReadyToCommit=!1;this._commitErrorId=null!=t?t:this._objBag.errorMgr.SetRowError(this._entryRecords[0].key(),e)};e.prototype.OnRecordSuceededCommit=function(e,t,n){this._objBag.commandMgr.Unlock();this._bCurrentlyCommitting=!1;return this.Commit(e,t,n)};e.prototype.Commit=function(e,t,i){var s=this._entryRecords[0],o=s.key(),a=u(this._entryRecordUpdates[o],this._objBag.jsGridObj);delete this._entryRecordUpdates[o];this._entryRecordKeys.Remove(o);this._committedRecordKeys.Add(o);if(null!=e&&e!==o){this._objBag.controller.ChangeKeys(o,e);s.recordKey=e;s.properties[this._objBag.jsGridParams.tableViewParams.keyFieldName].dataValue=s.recordKey}n.JsGridUtil.DebugAssert(null==s.key().startsWith||!s.key().startsWith(this._entryRecordKeyPrefix));this._entryRecords.shift();this._entryRecordKeyIdxCache={};delete s.bIsNewRow;for(var f in i)f in a||s.AddFieldValue(f,{hasData:!0,data:i[f]});for(var f in t)f in a||s.AddFieldValue(f,{hasLocalized:!0,localized:t[f]});var l=this._objBag.controller.GetEarliestChangeKeyForRecord(s.key());n.JsGridUtil.DebugAssert(this._objBag.controller.IsChangeKeyApplied(l));0==this._entryRecords.length&&this.CreateEntryRecordWithChangeKey(!1,l);var c=this._objBag.paneMgr.GetLastRecordKey();this._objBag.controller.InsertRecordAfter(c,s,l,!1,!0,null,!1);this._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnEntryRecordCommitted,n.JsGridUtil.EventArgs.OnEntryRecordCommitted(o,s.key(),l));this._objBag.paneMgr.NotifyChangedRowByKey(s.key());this.TryCommitFirstEntryRecord();return l};e.prototype.TryCommitFirstEntryRecords=function(e,t){null!=e&&this._commitAttemptCompleteNotifiers.push(e);t&&this.ForceReadyToCommit();this.TryCommitFirstEntryRecord()};e.prototype.TryCommitFirstEntryRecord=function(){var e=this,t=!1;if(!this._bCurrentlyCommitting&&this._bReadyToCommit&&this._entryRecords.length>0&&this._entryRecords[0].key()in this._entryRecordUpdates&&!this._bClearingUncommittedChanges&&this.IsEntryRecordDirty(this._entryRecords[0].key())){t=this._bCurrentlyCommitting=!0;this._objBag.commandMgr.Lock();setTimeout(function(){e._objBag.pendingChangeMgr.WaitForPendingUpdates(n)},0)}t||this._bCurrentlyCommitting||this.TryNotifyCommitComplete();var n=function(){if(e._objBag.errorMgr.AnyErrorsInRow(e._entryRecords[0].key())){e._bCurrentlyCommitting=!1;e._bReadyToCommit=!1;e._objBag.commandMgr.Unlock();e.TryNotifyCommitComplete()}else e._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.TryInsertEntryRecord,e._entryRecords[0],e._entryRecordUpdates[e._entryRecords[0].key()],e.OnRecordSuceededCommit.bind(e),e.OnRecordFailedCommit.bind(e))}};e.prototype.TryNotifyCommitComplete=function(){if(this._commitAttemptCompleteNotifiers.length>0)for(var e=!this.AnyUncomittedEntryRecords();this._commitAttemptCompleteNotifiers.length>0;)this._commitAttemptCompleteNotifiers.shift()(e)};e.prototype.CreateEntryRows=function(e,t,n){for(var r=0;r<e;r++)this.CreateEntryRecordWithChangeKey(!t,n)};e.prototype.AnyUncomittedEntryRecords=function(){return this._entryRecords.length>1||1==this._entryRecords.length&&this.IsEntryRecordDirty(this._entryRecords[0].key())};e.prototype.ClearUncommittedEntryRecords=function(){this.ClearUncommittedEntryRecordsInternal(!1,null)};e.prototype.ClearEntryRecord=function(e){this.ClearUncommittedEntryRecordsInternal(!1,e)};e.prototype.EnsureLastEntryRowExists=function(){if(this._objBag.editUtil.IsNewRowEnabled()&&0==this._entryRecords.length){this.CreateEntryRecord(!1);if(!this._bRegisteredEvent){this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnEntryRecordPropertyChanged,this.OnEntryRecordPropertyUpdated.bind(this));this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRowFocusChanged,this.OnRowFocusChanged.bind(this));this._bRegisteredEvent=!0}}};e.prototype.AddColumn=function(e,t){if(this._entryRecords.length>0){var n={isProp:!0,prop:s.PropertyType.Property.prototype.MakeProperty(void 0,void 0,t.hasDataValue,t.hasLocalizedValue,t.GetPropType())};this._entryRecords[0].AddFieldValue(e,n)}};e.prototype.NotifyTableViewChangeCompleted=function(){this._bReadyToCommit=!1;this.EnsureLastEntryRowExists()};e.prototype.NotifyTableViewCleared=function(){if(this._entryRecords.length>0){this.ClearUncommittedEntryRecordsInternal(!0,null);if(this._bRegisteredEvent){this._objBag.eventMgr.DetachEvent(r.JsGridConstants.EventType.OnEntryRecordPropertyChanged,this.OnEntryRecordPropertyUpdated.bind(this));this._objBag.eventMgr.DetachEvent(r.JsGridConstants.EventType.OnRowFocusChanged,this.OnRowFocusChanged.bind(this));this._bRegisteredEvent=!1}}};e.prototype.GetEntryRecords=function(){return this._entryRecords};e.prototype.IsEntryRecordKey=function(e){return this._entryRecordKeys.Contains(e)};e.prototype.GetLastEntryKey=function(){n.JsGridUtil.DebugAssert(this._entryRecords.length>0);return null!=this._objBag?this._entryRecords[this._entryRecords.length-1].key():null};e.prototype.GetEntryRecordIdx=function(e){if(null!=this._entryRecordKeyIdxCache[e])return this._entryRecordKeyIdxCache[e];var t=n.JsGridUtil.Internal.FindInArray(this._entryRecords,function(t){return e==t.key()});n.JsGridUtil.DebugAssert(null!=t);this._entryRecordKeyIdxCache[e]=t;return t};e.prototype.GetEntryRecord=function(e){return this._entryRecords[this.GetEntryRecordIdx(e)]};return e})();t.EntryRecordManager=a;var f=(function(){function e(e){this._provisionalRecordKeyPrefix="NewInsertedKey";this._currentKey=null;this._bPastingCells=!1;this._provisionalRecords={};this._provisionalRecordUpdates={};this._curProvisionalRecordIdx=0;this._bRegisteredEvents=!1;this._objBag=e}e.prototype.GetNextProvisionalRecordKey=function(){return this._provisionalRecordKeyPrefix+this._curProvisionalRecordIdx++};e.prototype.EnsureEventHandlers=function(){if(!this._bRegisteredEvents){this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnPropertyChanged,this.OnProvisionalRecordPropertyUpdated.bind(this));this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnPasteBegin,this.OnPasteBegin.bind(this));this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnPasteEnd,this.OnPasteEnd.bind(this));this._bRegisteredEvents=!0}};e.prototype.AnyUncomittedProvisionalRecords=function(){return!n.JsGridUtil.Internal.IsAssocArrayEmpty(this._provisionalRecords)};e.prototype.IsProvisionalRecordKey=function(e){return e in this._provisionalRecords};e.prototype.InsertProvisionalRecordBefore=function(e,t,n){return this.InsertionProvisionalRecord(e,t,this._objBag.jsGridObj.InsertRecordBefore,n)};e.prototype.InsertProvisionalRecordAfter=function(e,t,n){return this.InsertionProvisionalRecord(e,t,this._objBag.jsGridObj.InsertRecordAfter,n)};e.prototype.InsertionProvisionalRecord=function(e,t,i,s){var u=this;this.EnsureEventHandlers();t.recordKey=this.GetNextProvisionalRecordKey();this._provisionalRecords[t.key()]=t;var a=i(e,t,null,!0);(function(e,t,i){u._provisionalRecordUpdates[e]=[];if(null!=t)for(var s=0;s<t.length;s++)u._provisionalRecordUpdates[e].push(n.JsGridUtil.EventArgs.PropertyChanged(e,t[s].fieldKey,null,new o.PropertyUpdate(t[s].propertyValue.hasDataValue?t[s].propertyValue.dataValue:n.JsGridUtil.EmptyValue,t[s].propertyValue.hasLocalizedValue?t[s].propertyValue.localizedValue:n.JsGridUtil.EmptyValue),null,i,r.JsGridConstants.ValidationState.Pending))})(t.key(),s,a);this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.TryCreateProvisionalRecord,t,this._provisionalRecordUpdates[t.key()],function(e){u.OnSuccess.apply(u,[t.key()].concat(e))},this.OnFailed);return a};e.prototype.OnProvisionalRecordPropertyUpdated=function(e){var t=e.recordKey;if(null!=this._provisionalRecords[t]){null==this._provisionalRecordUpdates[t]&&(this._provisionalRecordUpdates[t]=[]);this._provisionalRecordUpdates[t].push(e);if(this._bPastingCells){var n=this._currentKey;this._currentKey=t;n!==t&&this.TryCommitProvisionalRecordUpdatesForKey(n)}else this.TryCommitProvisionalRecordUpdatesForKey(t)}};e.prototype.OnPasteBegin=function(){this._bPastingCells=!0;this._currentKey=null};e.prototype.OnPasteEnd=function(){this._bPastingCells=!1;this.TryCommitProvisionalRecordUpdatesForKey(this._currentKey)};e.prototype.TryCommitProvisionalRecordUpdatesForKey=function(e){var t=this;this._provisionalRecords[e]&&this._provisionalRecordUpdates[e]&&this._provisionalRecordUpdates[e].length>0&&this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.TryCreateProvisionalRecord,this._provisionalRecords[e],this._provisionalRecordUpdates[e],function(n){t.OnSuccess.apply(t,[e].concat(n))},this.OnFailed)};e.prototype.OnSuccess=function(e,t,n,r){var i=this._provisionalRecords[e],s=u(this._provisionalRecordUpdates[e],this._objBag.jsGridObj);delete this._provisionalRecords[e];delete this._provisionalRecordUpdates[e];if(null!=t&&t!==e){this._objBag.jsGridObj.ChangeKeys(e,t);i.recordKey=t;i.properties.ID.dataValue=i.recordKey}for(var o in n)o in s||i.AddFieldValue(o,{hasLocalized:!0,localized:n[o]});for(var o in r)o in s||i.AddFieldValue(o,{hasData:!0,data:r[o]});this._objBag.paneMgr.NotifyChangedRowByKey(i.key())};e.prototype.OnFailed=function(){};return e})();t.ProvisionalRecordManager=f});
define("aQV",["require","exports","aQC","aQp","aQo","aPS","aPY","aQW","aQB","aPZ","aQn","di"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(){function e(e,t){var s=this;this.processingNewRow=!1;this.actionsAssociatedWithUndo={};this._objBag=e;this._fnGetLocStr=t;this.versionMgr=e.versionMgr=new n.VersionManager(e,this.DoPhysicalPropChange.bind(this),this.DoPhysicalRowInsert.bind(this),this.DoPhysicalRowDelete.bind(this),function(){i.JsGridUtil.DebugAssert(!1,"Oh no!  We've removed hierarchy support.")},this.GetRecord.bind(this));this.checkSelMgr=new v(e);this.pendingChangeMgr=e.pendingChangeMgr=new r.PendingChangesManager(e);this.propUpdateMgr=new r.PropertyUpdateManager(e);e.tableCache.fnApplyUpdatesToNewRecord=function(e){s.versionMgr.ApplyChangesToRecord(e)};this.editUtil=e.editUtil=new p(this);this.eventSinks={OnPropertiesChanged:function(e,t,n,r){s.UpdateProperties(e,t,n,r)},OnNodeExpanded:function(e){i.JsGridUtil.DebugAssert(!1,"Oh no!  We've removed hierarchy support.")},OnNodeCollapsed:function(e){i.JsGridUtil.DebugAssert(!1,"Oh no!  We've removed hierarchy support.")},OnFocusedCellChanged:function(e){s.OnCellFocusedChanged(e)}}}e.prototype.GetCurrentDataValue=function(e,t){var n=this.versionMgr.GetCurrentValue(e,t);if(n==i.JsGridUtil.EmptyValue){var r=this._objBag.tableCache.GetCachedRecord(e);n=null!=r?r.GetDataValue(t):null}else n=n.GetData();return n};e.prototype.GetEarliestChangeKeyForRecord=function(e){return this.versionMgr.GetEarliestPropChangeKeyForRecord(e)};e.prototype.GetCurrentLocalizedValue=function(e,t){var n=this.versionMgr.GetCurrentValue(e,t);if(n==i.JsGridUtil.EmptyValue){var r=this._objBag.tableCache.GetCachedRecord(e);n=null!=r?r.GetLocalizedValue(t):null}else n=n.GetLocalized();return n};e.prototype.GetPropType=function(e,t){var n=this._objBag.tableCache.GetCachedRecord(e),r=null;null!=n&&null!=n.GetProp(t)?r=n.GetProp(t).propType:this._objBag.entryRecordMgr.IsEntryRecordKey(e)&&null!=this._objBag.jsGridParams.tableViewParams.gridFieldMap[t]?r=this._objBag.jsGridParams.tableViewParams.gridFieldMap[t].GetPropType():t==s.JsGridConstants.RecordIndicatorCheckboxColumnKey&&(r=o.PropertyType.Internal.Property.GetInstance().GetPropType("RecordIndicatorCheckBoxBoolean"));null==r&&(r=o.PropertyType.Internal.Property.GetInstance().GetPropType("String"));return r};e.prototype.ClearAllPropChangesForRecord=function(e){this.versionMgr.ClearAllPropChangesForRecord(e)};e.prototype.NotifyDataAvailable=function(){this._objBag.paneMgr.RefreshAllRows(0)};e.prototype.ClearChanges=function(){this._objBag.commandMgr.ClearUndoStack();null!=this.versionMgr&&this.versionMgr.Clear()};e.prototype.GetViewEventSinks=function(){return this.eventSinks};e.prototype.ClearTableView=function(){this._objBag.entryRecordMgr.NotifyTableViewCleared();this._objBag.paneMgr.ClearView()};e.prototype.TryReadPropForChangeKey=function(e,t,n){return this.versionMgr.TryReadPropForChangeKey(e,t,n)};e.prototype.SetTableView=function(e,t,n,r,i,s,o,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){this.posConverter=a;this.operationalUtil=f;this.columns=t;this.defaultEditMode=r;this.gridFieldMap=n;this.bNewRowEnabled=i;this.bEditingEnabled=s;this.SetRowViewInternal(e,!1);this.checkSelMgr.SetTableView(S,x,T);null!=this._objBag.columnMenuMgr&&this._objBag.columnMenuMgr.Dispose();this._objBag.columnMenuMgr=new u.default(this._objBag,e.autoFilterState,e.autoFilterEntries,this.gridFieldMap,this._fnGetLocStr,e.sortState);this._objBag.paneMgr.SetView(this.posConverter,this.columns,this.gridFieldMap,e.topViewIdx,this.operationalUtil,o,l,c,h,p,d,v,m,g,y,b,w,E,e.sortState);this.UpdateFilterAndSortState(e.sortState,e.filterState,e.autoFilterState)};e.prototype.SetRowView=function(e){this.SetRowViewInternal(e,!0);this._objBag.columnMenuMgr.SetAutoFilterState(e.autoFilterState);this._objBag.columnMenuMgr.SeedAutoFilterEntryCache(e.autoFilterEntries)};e.prototype.ChangeKeys=function(e,t){this._objBag.paneMgr.ChangeKeys(e,t);this.versionMgr.ChangeKeysOnPropUpdates(e,t);i.JsGridUtil.AsynchronousCellUpdater.GetInstance().ChangeRecordKeys(e,t);this._objBag.rowHeaderStateMgr.ChangeKeys(e,t);this._objBag.errorMgr.ChangeKeys(e,t);this._objBag.entryRecordMgr.IsEntryRecordKey(e)||this._objBag.tableCache.ChangeKeys(e,t)};e.prototype.UpdateFilterAndSortState=function(e,t,n){this._objBag.paneMgr.SetSortState(e);var r=new l.Set(n);null!=t&&(r=r.Union(t));this._objBag.paneMgr.SetFilterState(r.ToArray())};e.prototype.SetRowViewInternal=function(e,t){this._objBag.tableCache.SetView(e.view,e.minimalInfo&&e.minimalInfo.recordCount);if(t){this._objBag.paneMgr.NotifyNewRowStateChanged(!0);this._objBag.paneMgr.RefreshAllRows(e.topViewIdx);this.UpdateFilterAndSortState(e.sortState,e.filterState,e.autoFilterState)}};e.prototype.UpdateProperties=function(e,t,n,r){i.JsGridUtil.DebugAssert(e.length>0);var s;if(null==n){this._objBag.commandMgr.OpenGroup();n=(s=this.CreateDataUpdateCmd(null)).GetChangeKey()}null!=r&&r(n);this.propUpdateMgr.ApplyPropUpdates(e,n);if(null!=s){this._objBag.commandMgr.Execute(s,t,a.CommandManagerConstants.CommandType.Explicit);this._objBag.commandMgr.CloseGroup(t,a.CommandManagerConstants.CommandType.Explicit,!0)}return n};e.prototype.InsertHiddenRecord=function(e,t,n){if(null!=n&&this._objBag.entryRecordMgr.IsEntryRecordKey(n)){alert(this._fnGetLocStr("NoInsertAfterEntryRow"));return null}return this.InsertRecordAfterCore(this.GenerateRowUpdateForInsert(e,!1,n,!1,!1,null,null),t)};e.prototype.InsertRecordAfter=function(e,t,n,r,i,s,o){if(this._objBag.entryRecordMgr.IsEntryRecordKey(e)){alert(this._fnGetLocStr("NoInsertAfterEntryRow"));return null}this._objBag.tableCache.SeedInsertedRecord(t);return this.InsertRecordAfterCore(this.GenerateRowUpdateForInsert(t.key(),!0,e,r,i,s,o),n)};e.prototype.InsertRecordAfterCore=function(e,t){var n;null==t&&(t=(n=this.CreateDataUpdateCmd(null)).GetChangeKey());this.versionMgr.AddRowInsertChange(e,t);null!=n&&this._objBag.commandMgr.Execute(n,s.JsGridConstants.UserAction.InsertRecord,a.CommandManagerConstants.CommandType.Explicit);return t};e.prototype.InsertRecordBefore=function(e,t,n,r){var s,o;if(null==e)s=this.posConverter.RecordIdxToRecordKey(this._objBag.tableCache.GetRecordCount()-1);else{var u=this.posConverter.RecordKeyToRecordIdx(e);s=o=0==u?null:this.posConverter.RecordIdxToRecordKey(u-1);i.JsGridUtil.DebugAssert(null!=s,"Cannot determine afterRecordKey from beforeRecordKey")}return this.InsertRecordAfter(s,t,n,r,!1,o,s!==o)};e.prototype.DeleteRecords=function(e,t){var n,r=this;if(null!=i.JsGridUtil.Internal.FindInArray(e,function(e){return r._objBag.entryRecordMgr.IsEntryRecordKey(e)})){alert(this._fnGetLocStr("OpNotSupportedOnEntryRow"));return null}null==t&&(t=(n=this.CreateDataUpdateCmd(null)).GetChangeKey());for(var o=0;o<e.length;o++)this.versionMgr.AddRowDeleteChange(this.GenerateRowUpdateForDelete(e[o]),t);null!=n&&this._objBag.commandMgr.Execute(n,s.JsGridConstants.UserAction.DeleteRecord,a.CommandManagerConstants.CommandType.Explicit);return t};e.prototype.EnableEditing=function(){if(!this.bEditingEnabled){this.bEditingEnabled=!0;this._objBag.entryRecordMgr.EnsureLastEntryRowExists();this._objBag.paneMgr.NotifyNewRowStateChanged();this._objBag.paneMgr.NotifyCanEditUpdated();this._objBag.ariaMgr.EnableGridEditing(!0)}};e.prototype.DisableEditing=function(){var e=this;if(this.bEditingEnabled){this._objBag.paneMgr.StopEditing(!0);this._objBag.paneMgr.UnbindEditing(function(){e._objBag.entryRecordMgr.ClearUncommittedEntryRecords();e._objBag.paneMgr.NotifyNewRowStateChanged();e._objBag.paneMgr.NotifyCanEditUpdated();e._objBag.ariaMgr.EnableGridEditing(!1);e.bEditingEnabled=!1})}};e.prototype.TryBeginEdit=function(){var e=this._objBag.selectionMgr.GetFocusedPane();return null!=e&&e.TryBeginEdit({type:"gridapi"})};e.prototype.FinalizeEditing=function(e,t){var n=this;i.JsGridUtil.DebugAssert(null!=e&&null!=t);if(this.bEditingEnabled){this._objBag.paneMgr.StopEditing(!1);this.pendingChangeMgr.WaitForPendingUpdates(function(){n._objBag.errorMgr.AnyErrors()?t():n._objBag.entryRecordMgr.TryCommitFirstEntryRecords(function(){n._objBag.entryRecordMgr.AnyUncomittedEntryRecords()?t():n.pendingChangeMgr.WaitForAllChangeKeysToComplete(e)},!1)})}else e()};e.prototype.NotifyHide=function(){this.FinalizeEditing(function(){},function(){})};e.prototype.MarkPropUpdateInvalid=function(e,t,n,r){return this.versionMgr.MarkPropUpdateInvalid(e,t,n,r)};e.prototype.GetCurrentChangeKey=function(){return this.versionMgr.GetCurrentChangeKey()};e.prototype.IsChangeKeyApplied=function(e){return this.versionMgr.IsChangeKeyApplied(e)};e.prototype.GetChangeKeyForVersion=function(e){return this.versionMgr.GetChangeKeyForVersion(e)};e.prototype.GetCheckSelectionManager=function(){return null!=this.checkSelMgr?this.checkSelMgr.ExternalAPI:null};e.prototype.OnCellFocusedChanged=function(e){var t=e.oldRecordKey;e.newRecordKey!==t&&this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRowFocusChanged,i.JsGridUtil.EventArgs.RowFocusChanged(e.newRecordKey,e.oldRecordKey));this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnCellFocusChanged,e)};e.prototype.AttachUndoActionToChangeKey=function(e,t){var n=e.GetVersionNumber();null==this.actionsAssociatedWithUndo[n]&&(this.actionsAssociatedWithUndo[n]=[]);this.actionsAssociatedWithUndo[n].push(t)};e.prototype.CreateDataUpdateCmd=function(e){var t=this,n=!1,r=this.versionMgr.GetNextVersionKey();this._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnChangeKeyCreated,i.JsGridUtil.Internal.EventArgs.ChangeKeyStageUpdated(r));r.Reserve();return{Apply:function(){n&&t._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnBeginRedoDataUpdateChange,i.JsGridUtil.EventArgs.OnBeginRedoDataUpdateChange(r));t._objBag.paneMgr.ClearAllChangeIndications();t.versionMgr.ApplyChangeKey(r);n||e||t._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnChangeKeyInitialUpdateFinished,i.JsGridUtil.Internal.EventArgs.ChangeKeyStageUpdated(r));n=!0},Undo:function(){t._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnBeginUndoDataUpdateChange,i.JsGridUtil.EventArgs.OnBeginUndoDataUpdateChange(r));t._objBag.paneMgr.ClearAllChangeIndications();t.versionMgr.UndoChangeKey(r);var e=t.actionsAssociatedWithUndo[r.GetVersionNumber()];if(null!=e)for(var n=e.length-1;n>=0;n--)e[n]();t.actionsAssociatedWithUndo[r.GetVersionNumber()]=null},Dispose:function(e){e==a.CommandManagerConstants.DisposeState.Unapplied&&t.versionMgr.VacateChange(r);r.Release()},GetChangeKey:function(){return r},NotifyInitialUpdateComplete:function(){i.JsGridUtil.DebugAssert(e);t._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnChangeKeyInitialUpdateFinished,i.JsGridUtil.Internal.EventArgs.ChangeKeyStageUpdated(r))}}};e.prototype.DoPhysicalPropChange=function(e,t,n,o,u,a,f,l,h){this._objBag.cutcopypasteMgr.CancelMode();var p=null,d=null!=f?f:this._objBag.entryRecordMgr.IsEntryRecordKey(e)?this._objBag.entryRecordMgr.GetEntryRecord(e):this._objBag.tableCache.GetCachedRecord(e);null==n&&(n=new r.PropertyUpdate(null,""));var v=new r.PropertyUpdate(i.JsGridUtil.EmptyValue,i.JsGridUtil.EmptyValue);if(null!=d){var m=!0;if(null!=(p=d.GetProp(t))){v.localized=p.HasLocalizedValue()?p.GetLocalized():i.JsGridUtil.EmptyValue;v.data=p.HasDataValue()?p.GetData():i.JsGridUtil.EmptyValue;v.data!==n.data||v.localized!==n.localized?(v.localized!==n.localized||"SPUser"!==p.propType.ID&&"SPUser_MultiValue"!==p.propType.ID)&&p.Update(n.data,n.localized):m=!1}if(m){a||this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnBeforePropertyChanged,i.JsGridUtil.EventArgs.PropertyChanged(e,t,null==h?v:h,n,p&&p.propType,o,u));this._objBag.paneMgr.NotifyUpdateProperty(e,t,!0,n,u,o)}}this._objBag.errorMgr.ClearAllErrorsOnCell(e,t);if(u==s.JsGridConstants.ValidationState.Invalid){var g=null!=l?l:n.localized!==i.JsGridUtil.EmptyValue?c.format(this._fnGetLocStr("LocalizedConversionError"),n.localized):this._fnGetLocStr("GeneralConversionError");this._objBag.errorMgr.SetCellError(e,t,g)}if(!a){i.JsGridUtil.DebugAssert(null!=u);this._objBag.entryRecordMgr.IsEntryRecordKey(e)?this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnEntryRecordPropertyChanged,i.JsGridUtil.EventArgs.PropertyChanged(e,t,null==h?v:h,n,p&&p.propType,o,u)):this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnPropertyChanged,i.JsGridUtil.EventArgs.PropertyChanged(e,t,null==h?v:h,n,p&&p.propType,o,u))}};e.prototype.GetInsertIdxForRowUpdate=function(e,t,n){var r=!1,i=null;if("visualAfterRecordKey"in e){r=!0;i=e.visualAfterRecordKey;for(;null!=i&&null!=t&&null!=t[i];)n(i=t[i].visualAfterRecordKey)&&(i=null)}return this.GetRecordIdxForInsert(e.afterRecordKey,i,r)};e.prototype.DoPhysicalRowInsert=function(e,t,n,r){var o=function(){};this._objBag.cutcopypasteMgr.CancelMode();if(n(e.recordKey))return null;var u=null;this._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnBeforeRecordInserted,i.JsGridUtil.EventArgs.RecordInserted(e.recordKey,null,null,null));if(e.bIsInView){u=this.GetInsertIdxForRowUpdate(e,r,n);this._objBag.tableCache.InsertRecord(u,e.recordKey);e.bDoNotUpdatePaneOnFirstInsert?delete e.bDoNotUpdatePaneOnFirstInsert:this._objBag.paneMgr.NotifyInsertRows(this.posConverter.RecordIdxToViewIdx(u),1,e.bUpdateFocusPos,o)}this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRecordInserted,i.JsGridUtil.EventArgs.RecordInserted(e.recordKey,u,e.afterRecordKey,t));return e};e.prototype.DoPhysicalRowDelete=function(e,t,n){this._objBag.cutcopypasteMgr.CancelMode();var r=[],o=[e.recordKey];if(n(e.recordKey))return null;for(var u=0;u<o.length;u++){var a=o[u],f=a==e.recordKey?e:this.GenerateRowUpdateForDelete(a),l=null;this._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnBeforeRecordDeleted,i.JsGridUtil.Internal.EventArgs.RecordDeleted(a));if(f.bIsInView){l=this.posConverter.RecordKeyToRecordIdx(a);var c=this.posConverter.RecordIdxToViewIdx(l);this._objBag.tableCache.IsKeyInView(a)&&this._objBag.tableCache.DeleteRecord(l);null!=c&&this._objBag.paneMgr.NotifyDeleteRows(c,1);0}this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRecordDeleted,i.JsGridUtil.EventArgs.RecordDeleted(a,l,t));r.push(f)}return r};e.prototype.GenerateRowUpdateForDelete=function(e){var t=this._objBag.tableCache.IsKeyInView(e),n=t?this.posConverter.RecordKeyToRecordIdx(e):null,r=null;t&&(r=0==n?null:this.posConverter.RecordIdxToRecordKey(n-1));return new d(e,r,0,t,!0,!1,void 0,void 0)};e.prototype.GenerateRowUpdateForInsert=function(e,t,n,r,i,s,o){return new d(e,n,0,t,r,i,s,o)};e.prototype.GetRecord=function(e){return this._objBag.tableCache.GetCachedRecord(e)};e.prototype.GetRecordIdxForInsert=function(e,t,n){var r=n?t:e,i=null==r?null:this.posConverter.RecordKeyToRecordIdx(r);n&&null!=r&&null==i&&(i=null==e?null:this.posConverter.RecordKeyToRecordIdx(e));return null==i?0:i+1};return e})();t.MVCController=h;var p=(function(){function e(e){this._controller=e}e.prototype.ValidateAndExpandKeyList=function(e){return!1};e.prototype.IsEditingEnabled=function(){return this._controller.bEditingEnabled};e.prototype.IsNewRowEnabled=function(){return this._controller.bNewRowEnabled&&this._controller.bEditingEnabled};e.prototype.GetFieldValueForCopy=function(e,t){i.JsGridUtil.lastCopiedValueType_SPUser=!1;var n,r=e.HasLocalizedValue(t)?e.GetLocalizedValue(t):null;if(t!==s.JsGridConstants.RecordIndicatorCheckboxColumnKey){var u=e.GetProp(t);n=u&&u.propType}else n=o.PropertyType.Internal.Property.GetInstance().GetPropType("RecordIndicatorCheckBoxBoolean");if(null!=n&&(null!=n.GetDisplayValue||null!=n.GetCopyValue)){var a=e.HasDataValue(t)?e.GetDataValue(t):null;null!=n.GetDisplayValue?r=n.GetDisplayValue(e,a,r):null!=n.GetCopyValue&&(r=n.GetCopyValue(e,a,r))}return null!=r?r:""};e.prototype.CanBindToField=function(e,t,n){return this.CanEditField(e,t,n)&&!(null!=n&&n==s.JsGridConstants.RecordIndicatorCheckboxColumnKey)};e.prototype.CanEditField=function(e,t,n){if(!this._controller.bEditingEnabled||null==e)return!1;if(!e.bIsNewRow&&null!=this._controller.operationalUtil.GetValue(e,s.JsGridConstants.OperationalConstants.GroupingOutlineLevel))return!1;if(null!=n&&n==s.JsGridConstants.RecordIndicatorCheckboxColumnKey)return!0;var r=null!=t&&null!=t.fnGetCellEditMode?t.fnGetCellEditMode(e,n):null;r=null==r?s.JsGridConstants.EditMode.Defer:r;var i=e.bIsNewRow?s.JsGridConstants.EditMode.ReadWriteDefer:this._controller._objBag.delegateMgr.DelegatePresent(s.JsGridConstants.DelegateType.GetRecordEditMode)?this._controller._objBag.delegateMgr.Apply(s.JsGridConstants.DelegateType.GetRecordEditMode,e):null;i=null==(i=null==i?this._controller.operationalUtil.GetValue(e,s.JsGridConstants.OperationalConstants.RecordEditMode):i)?s.JsGridConstants.EditMode.Defer:i;var o=null;null!=n&&(o=null==(o=this._controller._objBag.delegateMgr.DelegatePresent(s.JsGridConstants.DelegateType.GetFieldEditMode)?this._controller._objBag.delegateMgr.Apply(s.JsGridConstants.DelegateType.GetFieldEditMode,n):o)?this._controller.gridFieldMap[n].GetEditMode():o);null==o&&(o=s.JsGridConstants.EditMode.Defer);var u=Math.min(Math.min(Math.min(i,o),r),this._controller.defaultEditMode);return u==s.JsGridConstants.EditMode.ReadWrite||u==s.JsGridConstants.EditMode.ReadWriteDefer||u==s.JsGridConstants.EditMode.Defer};return e})(),d=function(e,t,n,r,i,s,o,u){this.recordKey=e;this.afterRecordKey=t;this.newOutlineLevel=n;r&&(this.bIsInView=r);i&&(this.bUpdateFocusPos=i);s&&(this.bDoNotUpdatePaneOnFirstInsert=s);u&&(this.visualAfterRecordKey=o)},v=(function(){function e(e){var t=this;this._checkedRecordKeys=new l.Set;this._checkboxDisabledRecordKeys=new l.Set;this._checkboxHiddenRecordKeys=new l.Set;this.ExternalAPI={CheckAllRecords:function(){for(var e=t._objBag.tableCache.GetView(),n=new l.Set,r=0;r<e.length;r++){var i=e[r];t._checkedRecordKeys.Contains(i)||t.IsRecordIndicatorCheckboxHidden(i)||t.IsRecordIndicatorCheckboxDisabled(i)||n.Add(i)}t.ChangeMultipleCheckboxStates(n,!0)},ClearCheckedRecords:function(){var e=t._checkedRecordKeys.Clone();t.ChangeMultipleCheckboxStates(e,!1)},EnableRecordCheckbox:function(e){if(t._checkboxDisabledRecordKeys.Contains(e)){t._checkboxDisabledRecordKeys.Remove(e);t.RefreshRecordIndicatorCell(e)}},DisableRecordCheckbox:function(e){if(!t._checkboxDisabledRecordKeys.Contains(e)){t._checkboxDisabledRecordKeys.Add(e);t.RefreshRecordIndicatorCell(e)}},ShowRecordCheckbox:function(e){if(t._checkboxHiddenRecordKeys.Contains(e)){t._checkboxHiddenRecordKeys.Remove(e);t.RefreshRecordIndicatorCell(e)}},HideRecordCheckbox:function(e){if(!t._checkboxHiddenRecordKeys.Contains(e)){t._checkboxHiddenRecordKeys.Add(e);t.RefreshRecordIndicatorCell(e)}},CheckRecord:this.CheckRecord,UncheckRecord:this.UncheckRecord,AnyRecordsChecked:function(){return!t._checkedRecordKeys.IsEmpty()},GetCheckedRecordKeys:function(){return t._checkedRecordKeys.GetCollection()},GetCheckedRecordCount:function(){return t._checkedRecordCount},GetHiddenCheckboxRecordKeys:function(){return t._checkboxHiddenRecordKeys.GetCollection()},GetDisabledCheckboxRecordKeys:function(){return t._checkboxDisabledRecordKeys.GetCollection()}};this._objBag=e;e.checkSelMgr=this;this.Init()}e.prototype.Init=function(){this._checkedRecordCount=0;var e=this._objBag.gridControls[s.JsGridConstants.RecordIndicatorControlId]=new f.DisplayControl.RecordIndicatorCheckboxControl(this._objBag.gridId,this.OnCheckboxClicked,this.IsRecordIndicatorCheckboxHidden,this.IsRecordIndicatorCheckboxDisabled,this.IsRecordIndicatorCheckboxChecked);o.PropertyType.Utils.RegisterDisplayControl(e.Id,e,[])};e.prototype.IsRecordIndicatorCheckboxHidden=function(e){return!!this._checkboxHiddenRecordKeys.Contains(e)};e.prototype.IsRecordIndicatorCheckboxDisabled=function(e){return this._checkboxDisabledRecordKeys.Contains(e)};e.prototype.CheckRecord=function(e){this._checkedRecordKeys.Contains(e)||this.ChangeSingleCheckboxState(e)};e.prototype.UncheckRecord=function(e){this._checkedRecordKeys.Contains(e)&&this.ChangeSingleCheckboxState(e)};e.prototype.ChangeMultipleCheckboxStates=function(e,t){var n=this,r=function(t){if(t){for(var r in e.GetCollection())if(!n._checkedRecordKeys.Contains(r)){n._checkedRecordKeys.Add(r);++n._checkedRecordCount}}else for(var r in e.GetCollection())if(n._checkedRecordKeys.Contains(r)){n._checkedRecordKeys.Remove(r);--n._checkedRecordCount}n.RefreshRecordIndicatorCell(null);n._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRecordChecked,i.JsGridUtil.EventArgs.RecordChecked(e,t))};this._objBag.commandMgr.Execute({Apply:function(){r(t)},Undo:function(){r(!t)}},"ChangeIndicatorCheckBox",a.CommandManagerConstants.CommandType.Explicit)};e.prototype.ChangeSingleCheckboxState=function(e){var t=this,n=function(){if(!t.IsRecordIndicatorCheckboxHidden(e)&&!t.IsRecordIndicatorCheckboxDisabled(e)){var n=!t.IsRecordIndicatorCheckboxChecked(e);if(n){t._checkedRecordKeys.Add(e);++t._checkedRecordCount}else{t._checkedRecordKeys.Remove(e);--t._checkedRecordCount}t.RefreshRecordIndicatorCell(e);t._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRecordChecked,i.JsGridUtil.EventArgs.RecordChecked((new l.Set).AddArray([e]),n))}};this._objBag.commandMgr.Execute({Apply:n,Undo:n,Dispose:function(){n=null}},"ChangeIndicatorCheckBox",a.CommandManagerConstants.CommandType.Explicit)};e.prototype.OnCheckboxClicked=function(e){this.ChangeSingleCheckboxState(e);if(this.IsRecordIndicatorCheckboxChecked(e)){var t=this.GetRecordKeysWhereColumnIsSelected(s.JsGridConstants.RecordIndicatorCheckboxColumnKey);if(t.Contains(e)){for(var n in t)(this._checkedRecordKeys.Contains(n)||this.IsRecordIndicatorCheckboxHidden(n)||this.IsRecordIndicatorCheckboxDisabled(n))&&t.Remove(n);this.ChangeMultipleCheckboxStates(t,!0)}}};e.prototype.GetRecordKeysWhereColumnIsSelected=function(e){for(var t=this._objBag.jsGridObj.GetSelectedRowRanges(),n=this._objBag.jsGridObj.GetSelectedColumnRanges(),r=this._objBag.jsGridObj.GetSelectedCellRanges(),s=new l.Set,o=0;o<n.length;o++)if(null!=i.JsGridUtil.Internal.FindInArray(n[o].keys,function(t){return t==e})){s.AddArray(this._objBag.tableCache.GetView());break}if(s.IsEmpty()){for(o=0;o<t.length;o++)s.AddArray(t[o].keys);for(o=0;o<r.length;o++)null!=i.JsGridUtil.Internal.FindInArray(r[o].colRange.keys,function(t){return t==e})&&s.AddArray(r[o].rowRange.keys)}return s};e.prototype.RefreshRecordIndicatorCell=function(e){this._objBag.paneMgr.NotifyUpdateProperty(e,s.JsGridConstants.RecordIndicatorCheckboxColumnKey,!1,null)};e.prototype.IsRecordIndicatorCheckboxChecked=function(e){return this._checkedRecordKeys.Contains(e)};e.prototype.SetTableView=function(e,t,n){this._checkboxHiddenRecordKeys=new l.Set;this._checkboxHiddenRecordKeys.AddArray(e);this._checkboxDisabledRecordKeys=new l.Set;this._checkboxDisabledRecordKeys.AddArray(t);this._checkedRecordKeys=new l.Set;this._checkedRecordKeys.AddArray(n);this._checkedRecordCount=n.length};return e})()});
define("aQC",["require","exports","aQo","aPS","aPY","aQp","aQn"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function u(e){this.message=e||"Invalid Change Key Error";this.name="InvalidChangeKeyError"}t.InvalidChangeKeyError=u;u.prototype=new Error;u.prototype.constructor=u;var a=function(e){this.version=e;this.changes=[];this.recordKeys=[]},f=(function(){function e(){this.vChanges=[]}e.prototype.VacateChange=function(e){var t=this.GetVacatedChange(e);n.JsGridUtil.DebugAssert(null==t.item);this.vChanges.splice(t.idx,0,e)};e.prototype.AdvanceBaseline=function(e){var t=this.GetVacatedChange(e);this.vChanges.splice(0,t.idx+(null!=t.item?1:0))};e.prototype.ChangeIsVacated=function(e){return null!=this.GetVacatedChange(e).item};e.prototype.GetVacatedChange=function(e){var t=n.JsGridUtil.Internal.LowerBound(this.vChanges,e,null);return{idx:t,item:null!=this.vChanges[t]&&this.vChanges[t]==e?this.vChanges[t]:null}};return e})(),l=(function(){function e(e,t){this.version=e;this._versionManager=t}e.prototype.Reserve=function(){n.JsGridUtil.DebugAssert(this.version>=this._versionManager.baselineVersion);var e=n.JsGridUtil.Internal.LowerBound(this._versionManager.reservedChanges,this.version,"version");null==this._versionManager.reservedChanges[e]||this._versionManager.reservedChanges[e].version!==this.version?this._versionManager.reservedChanges.splice(e,0,{version:this.version,count:1}):this._versionManager.reservedChanges[e].count++};e.prototype.Release=function(){var e=n.JsGridUtil.Internal.LowerBound(this._versionManager.reservedChanges,this.version,"version");n.JsGridUtil.DebugAssert(this._versionManager.reservedChanges[e].version==this.version);if(1==this._versionManager.reservedChanges[e].count){this._versionManager.reservedChanges.splice(e,1);this._versionManager.UpdateBaselineVersion()}else this._versionManager.reservedChanges[e].count--};e.prototype.GetVersionNumber=function(){return this.version};e.prototype.CompareTo=function(e){return this.version-e.GetVersionNumber()};return e})();t.ChangeKey=l;var c=(function(){function e(e){this._versionManager=e;this.Init()}e.prototype.Clear=function(){this.Init()};e.prototype.AddInsertChange=function(e,t){this.ApplyInsert(e,t,null,null,null)};e.prototype.AddDeleteChange=function(e,t){this.ApplyDelete(e,t,null,null)};e.prototype.ApplyAllRowInsertChanges=function(e){this.DoRowChangeOp(this.ApplyInsert.bind(this),this.rowInserts,e,!1,!1,!0)};e.prototype.ApplyAllRowDeleteChanges=function(e){this.DoRowChangeOp(this.ApplyDelete.bind(this),this.rowDeletes,e,!1,!1,!1)};e.prototype.UndoAllRowInsertChanges=function(e){this.DoRowChangeOp(this.ApplyDelete.bind(this),this.rowInserts,e,!0,!0,!1)};e.prototype.UndoAllRowDeleteChanges=function(e){this.DoRowChangeOp(this.ApplyInsert.bind(this),this.rowDeletes,e,!0,!0,!0)};e.prototype.VacateChange=function(e){var t=n.JsGridUtil.Internal.BinarySearch(this.rowInserts,e,"version");null!=t&&this.rowInserts.splice(t,1);null!=(t=n.JsGridUtil.Internal.BinarySearch(this.rowDeletes,e,"version"))&&this.rowDeletes.splice(t,1)};e.prototype.AdvanceBaseline=function(e){};e.prototype.GetChange=function(e,t,n){var i;null!=t&&(i=new o.Set).AddArray(t);var s=this.GetChanges(this.rowInserts,e,i,n?r.JsGridConstants.ChangeType.Delete:r.JsGridConstants.ChangeType.Insert),u=this.GetChanges(this.rowDeletes,e,i,n?r.JsGridConstants.ChangeType.Insert:r.JsGridConstants.ChangeType.Delete);return n?u.concat(s):s.concat(u)};e.prototype.Init=function(){this.rowInserts=[];this.rowDeletes=[]};e.prototype.GetChanges=function(e,t,r,i){var s=[],o=n.JsGridUtil.Internal.BinarySearch(e,t,"version");if(null!=o)for(var u=0;u<e[o].changes.length;u++){var a=e[o].changes[u];(null==r||r.Contains(a.recordKey))&&s.push({type:i,recordKey:a.recordKey,afterRecordKey:a.afterRecordKey,newOutlineLevel:a.newOutlineLevel})}return s};e.prototype.DoRowChangeOp=function(e,t,r,i,s,o){var u=function(e,t){var n;if(o){n=i?t[t.length-1]:t[0];for(;n.afterRecordKey in e;)n=e[n.afterRecordKey];delete e[n.recordKey];for(var r=0;r<t.length;r++)if(n==t[r]){t.splice(r,1);break}}else n=i?t.pop():t.shift();return n},f=n.JsGridUtil.Internal.BinarySearch(t,r.GetVersionNumber(),"version");if(null!=f){var l=t[f].changes;s||(t[f]=new a(t[f].version));for(var c={},h=[],p=0;p<l.length;p++){c[l[p].recordKey]=l[p];h.push(l[p])}for(;h.length>0;)e(u(c,h),r,!0,s,c)}};e.prototype.ApplyInsert=function(e,t,n,r,i){var s=this,o=t.GetVersionNumber();if(this._versionManager.curVersion>=o||n){var u=this._versionManager.fnDoPhysicalRowInsert(e,t,function(e){return 1==s.GetRecordStatus(e,n&&s._versionManager.curVersion<o?o:s._versionManager.curVersion)},i);null==u||r||this.AddChange(this.rowInserts,o,u)}else r||this.AddChange(this.rowInserts,o,e)};e.prototype.ApplyDelete=function(e,t,n,r){var i=this,s=t.GetVersionNumber();if(this._versionManager.curVersion>=s||n){var u=this._versionManager.fnDoPhysicalRowDelete(e,t,function(e){return-1==i.GetRecordStatus(e,n&&i._versionManager.curVersion<s?s:i._versionManager.curVersion)});if(null!=u){for(var a=new o.Set,f=0;f<u;f++)u[f].isbIsInView&&a.Add(u[f].recordKey);a.IsEmpty()||this.ForEachRowChange(function(t,n){if(t)for(var r in n.recordKeys)a.Contains(r)&&a.Remove(r);if(a.IsEmpty())return!1;for(var i=0;i<n.changes.length;i++)a.Contains(n.changes[i].afterRecordKey)&&(n.changes[i].afterRecordKey=e.afterRecordKey);return!0},s,!1,!0);if(!r)for(f=0;f<u.length;f++)this.AddChange(this.rowDeletes,s,u[f])}}else r||this.AddChange(this.rowDeletes,s,e)};e.prototype.GetRecordStatus=function(e,t){var n=0;this.ForEachRowChange(function(t,r){n=e in r.recordKeys?t?1:-1:n;return!0},t,!0,!1);return n};e.prototype.ForEachRowChange=function(e,t,n,r){for(var i=0;(i<this.rowDeletes.length&&(r||this.rowDeletes[i].version<=t)||i<this.rowInserts.length&&r&&this.rowInserts[i].version<=t)&&(!(i<this.rowInserts.length&&(n||this.rowInserts[i].version>t))||e(!0,this.rowInserts[i]))&&(!(i<this.rowDeletes.length&&(n||this.rowDeletes[i].version>t))||e(!1,this.rowDeletes[i]));i++);};e.prototype.AddChange=function(e,t,r){var i=n.JsGridUtil.Internal.LowerBound(e,t,"version");i!=e.length&&e[i].version===t||e.splice(i,0,new a(t));var s=e[i];s.changes.push(r);s.recordKeys[r.recordKey]=null};return e})(),h=(function(){function e(e){this._versionManager=e;this.Init()}e.prototype.Clear=function(){this.Init()};e.prototype.GetChange=function(e,t,i){var s=[],o=null!=t?t:n.JsGridUtil.Internal.ConvertSetKeysToArray(this.propChanges),u=function(t){if(o.hasOwnProperty(t)){var n=o[t];a.ApplyToItemsInRecord(n,e,function(e,t){if(null!=t.item){var o=i?t.prevItem:t.item;s.push({type:r.JsGridConstants.ChangeType.Prop,recordKey:n,fieldKey:e,propUpdate:o.value,validationState:null==o.validationState?r.JsGridConstants.ValidationState.Valid:o.validationState})}},!0)}},a=this;for(var f in o)u(f);return s};e.prototype.TryReadPropForVersion=function(e,t,n){if(e in this.propChanges&&t in this.propChanges[e]){var r=this.GetChangeFromList(this.propChanges[e][t],n),i=null==r.item?r.prevItem:r.item;return null!=i?i.value:null}return null};e.prototype.ChangeKeys=function(e,t){this.propChanges[t]=this.propChanges[e];delete this.propChanges[e]};e.prototype.GetEarliestChangeKeyForRecord=function(e){var t,n=this.propChanges[e];if(null!=n)for(var r in n)if(n.hasOwnProperty(r)){var i=n[r],s=i[0].version!==this._versionManager.baselineVersion?i[0].version:i[1].version;t=null==t||s<t?s:t}return t};e.prototype.ClearAllPropChangesForRecord=function(e){delete this.propChanges[e]};e.prototype.MarkPropUpdateInvalid=function(e,t,n,i){var s=!1,o=n.GetVersionNumber(),u=this.propChanges[e][t];if(null!=u){var a=this.GetChangeFromList(u,o);if(null!=a.item){if(a.item.validationState!==r.JsGridConstants.ValidationState.Invalid){a.item.validationState=r.JsGridConstants.ValidationState.Invalid;null!=i&&(a.item.optErrorMsg=i);this._versionManager.fnDoPhysicalPropChange(e,t,a.item.value,n,r.JsGridConstants.ValidationState.Invalid,!1,null,i,this.GetOldValue(u,a.idx,!1))}s=!0}}return s};e.prototype.AddPropChange=function(e,t,i,s,o,u){var a=i.GetVersionNumber(),f=null,l=null;if(a==this._versionManager.baselineVersion){if(null!=(c=null!=this.propChanges[e]&&null!=this.propChanges[e][t]?this.GetChangeFromList(this.propChanges[e][t],a):null)){n.JsGridUtil.DebugAssert(0==c.idx);n.JsGridUtil.DebugAssert(null!=c.item);f=c.item;l=c.idx}}else{null==this.propChanges[e]&&(this.propChanges[e]={});var c,h=this.propChanges[e][t];if(null==h){var p=this._versionManager.fnGetRecord(e),d=null;null!=p&&(d=this.GetPropUpdateFromRecord(p,t));h=this.propChanges[e][t]=[{version:this._versionManager.baselineVersion,value:d}]}l=(c=this.GetChangeFromList(h,a)).idx;if(null==c.item){this.MinimizePropUpdate(e,t,s);var v={version:a,value:s};o!==r.JsGridConstants.ValidationState.Valid&&(v.validationState=o);null!=u&&(v.optErrorMsg=u);h.splice(l,0,v)}else f=c.item}if(null!=f){f.value=s;o!==f.validationState&&(null==o||o==r.JsGridConstants.ValidationState.Valid?delete f.validationState:f.validationState=o)}var m=null==l?null:this.propChanges[e][t];this._versionManager.curVersion>=a&&(null==l||l==m.length-1||m[l+1].version>this._versionManager.curVersion)&&this._versionManager.fnDoPhysicalPropChange(e,t,s,i,o,!1,null,u,this.GetOldValue(m,l,!1))};e.prototype.ApplyChangesToRecord=function(e){var t=this;e.key()in this.propChanges&&this.ApplyToItemsInRecord(e.key(),this._versionManager.curVersion,function(i,s){var o=t.propChanges[e.key()][i],u=null==s.item?s.prevItem:s.item;if(null!=u&&null!=e.GetProp(i)){var a=n.JsGridUtil.Internal.LowerBound(t._versionManager.changeMap,s.version,"version");t._versionManager.fnDoPhysicalPropChange(e.key(),i,u.value,t._versionManager.changeMap[a].key,null==u.validationState?r.JsGridConstants.ValidationState.Valid:u.validationState,!0,e,u.optErrorMsg,t.GetOldValue(o,a,!1))}},!0)};e.prototype.VacateChange=function(e){var t=this,r=function(r){i.propChanges.hasOwnProperty(r)&&i.ApplyToItemsInRecord(r,e,function(i,s){var o=t.propChanges[r][i];n.JsGridUtil.DebugAssert(o.length>1);if(2==o.length){n.JsGridUtil.DebugAssert(o[0].version==t._versionManager.baselineVersion);n.JsGridUtil.DebugAssert(o[1].version==e);t.DeleteEntry(r,i)}else o.splice(s.idx,1)},null)},i=this;for(var s in this.propChanges)r(s)};e.prototype.SynchronizeToChange=function(e,t){var i=this,s=e.GetVersionNumber(),o=null!=t?t:n.JsGridUtil.Internal.ConvertSetKeysToArray(this.propChanges),u=function(t){if(o.hasOwnProperty(t)){var n=o[t];a.ApplyToItemsInRecord(n,s,function(t,s){var o=null==s.item?s.prevItem:s.item;null!=o&&o.version>i._versionManager.curVersion&&i._versionManager.fnDoPhysicalPropChange(n,t,o.value,e,null==o.validationState?r.JsGridConstants.ValidationState.Valid:o.validationState,!1,null,o.optErrorMsg,i.GetOldValue(i.propChanges[n][t],s.idx,!1))},!0)}},a=this;for(var f in o)u(f)};e.prototype.RollBackChange=function(e,t){var i=this,s=e.GetVersionNumber(),o=null!=t?t:n.JsGridUtil.Internal.ConvertSetKeysToArray(this.propChanges),u=function(e){if(o.hasOwnProperty(e)){var t=o[e];a.ApplyToItemsInRecord(t,s,function(e,s){n.JsGridUtil.DebugAssert(s.idx>0);var o=i.propChanges[t][e][s.idx-1],u=n.JsGridUtil.Internal.LowerBound(i._versionManager.changeMap,o.version,"version"),a=i._versionManager.changeMap[u].key;i._versionManager.fnDoPhysicalPropChange(t,e,o.value,a,null==o.validationState?r.JsGridConstants.ValidationState.Valid:o.validationState,!1,null,o.optErrorMsg,i.GetOldValue(i.propChanges[t][e],s.idx-1,!0))},null)}},a=this;for(var f in o)u(f)};e.prototype.AdvanceBaseline=function(e){for(var t in this.propChanges)if(this.propChanges.hasOwnProperty(t))for(var r in this.propChanges[t])if(this.propChanges[t].hasOwnProperty(r)){for(var i=this.propChanges[t][r],s=n.JsGridUtil.Internal.LowerBound(i,e,"version"),o=1;o<s;o++)i.shift();1==i.length?this.DeleteEntry(t,r):i[0].version=e}};e.prototype.GetOldValue=function(e,t,n){var r,i=n?t+1:t-1;i>=0&&i<e.length&&(r=e[i].value);return r};e.prototype.GetPropUpdateFromRecord=function(e,t){var o=this._versionManager._objBag.controller.GetPropType(e.key(),t),u=o&&i.PropertyType.Internal.Property.GetInstance().GetUpdateTrackingMode(o,this._versionManager._objBag.jsGridParams.tableViewParams.gridFieldMap[t]),a=e.HasDataValue(t)&&u!==r.JsGridConstants.UpdateTrackingMode.PropLocalized?e.GetDataValue(t):n.JsGridUtil.EmptyValue,f=e.HasLocalizedValue(t)&&u!==r.JsGridConstants.UpdateTrackingMode.PropData?e.GetLocalizedValue(t):n.JsGridUtil.EmptyValue;return new s.PropertyUpdate(a,f)};e.prototype.MinimizePropUpdate=function(e,t,i){var s=this._versionManager._objBag.controller.GetPropType(e,t),o=s&&s.GetUpdateTrackingMode&&s.GetUpdateTrackingMode();null!=s&&null!=o&&(o==r.JsGridConstants.UpdateTrackingMode.PropLocalized&&i.data!==n.JsGridUtil.EmptyValue?i.data=n.JsGridUtil.EmptyValue:o==r.JsGridConstants.UpdateTrackingMode.PropData&&i.localized!==n.JsGridUtil.EmptyValue&&(i.localized=n.JsGridUtil.EmptyValue))};e.prototype.Init=function(){this.propChanges={}};e.prototype.DeleteEntry=function(e,t){delete this.propChanges[e][t];n.JsGridUtil.Internal.IsAssocArrayEmpty(this.propChanges[e])&&delete this.propChanges[e]};e.prototype.ApplyToItemsInRecord=function(e,t,n,r){var i=this.propChanges[e];if(null!=i)for(var s in i)if(i.hasOwnProperty(s)){var o=this.GetChangeFromList(i[s],t);(null!=o.item||r)&&n(s,o)}};e.prototype.GetChangeFromList=function(e,t){var r=n.JsGridUtil.Internal.LowerBound(e,t,"version");return{idx:r,item:null!=e[r]&&e[r].version==t?e[r]:null,prevItem:r>0&&r<=e.length?e[r-1]:null}};return e})(),p=(function(){function e(e){this._versionManager=e;this.Init()}e.prototype.Clear=function(){this.Init()};e.prototype.AddLevelChange=function(e,t,n,r){var i=r.GetVersionNumber(),s=this.levelChanges[i];null==s&&(s=this.levelChanges[i]=[]);s.push({recordKey:e,levelDelta:t,adoptedChildrenKeys:n});this._versionManager.curVersion>=i&&this._versionManager.fnDoPhysicalLevelChange(e,t,n,r)};e.prototype.ApplyAllLevelChanges=function(e){this.DoLevelChange(e,!1)};e.prototype.UndoAllLevelChanges=function(e){this.DoLevelChange(e,!0)};e.prototype.GetChange=function(e,t,n){var i;null!=t&&(i=new o.Set).AddArray(t);var s=[],u=this.levelChanges[e];if(null!=u)for(var a=r.JsGridConstants.ChangeType.Level,f=0;f<u.length;f++)if(null==i||i.Contains(u[f].recordKey)){var l=u[f].levelDelta*(n?-1:1);s.push({type:a,recordKey:u[f].recordKey,levelDelta:l,adoptedChildrenKeys:u[f].adoptedChildrenKeys})}return s};e.prototype.VacateChange=function(e){delete this.levelChanges[e]};e.prototype.AdvanceBaseline=function(e){for(var t=this._versionManager.baselineVersion;t<e;t++)this.VacateChange(t)};e.prototype.Init=function(){this.levelChanges={}};e.prototype.DoLevelChange=function(e,t){var n=this.levelChanges[e.GetVersionNumber()];if(null!=n)if(t)for(var r=n.length-1;r>=0;r--)this._versionManager.fnDoPhysicalLevelChange(n[r].recordKey,-n[r].levelDelta,n[r].adoptedChildrenKeys,e);else for(r=0;r<n.length;r++)this._versionManager.fnDoPhysicalLevelChange(n[r].recordKey,n[r].levelDelta,null,e)};return e})(),d=(function(){function e(e,t,n,r,i,s){this.reservedChanges=[];this.curVersion=0;this.baselineVersion=0;this.changeCount=1;this.vacatedChanges=new f;this._objBag=e;this.fnDoPhysicalPropChange=t;this.fnDoPhysicalRowInsert=n;this.fnDoPhysicalRowDelete=r;this.fnDoPhysicalLevelChange=i;this.fnGetRecord=s;this.rowChangeMgr=new c(this);this.changeMap=[{key:new l(0,this),version:0}];this.propChangeMgr=new h(this);this.levelChangeMgr=new p(this)}e.prototype.ChangeKeysOnPropUpdates=function(e,t){this.propChangeMgr.ChangeKeys(e,t)};e.prototype.GetEarliestPropChangeKeyForRecord=function(e){var t=this.propChangeMgr.GetEarliestChangeKeyForRecord(e);null!=t&&(t=this.GetChangeKeyForVersion(t));return t};e.prototype.AddPropChange=function(e,t,n,r,i,s){this.ValidateChangeKey(n,!0)&&this.propChangeMgr.AddPropChange(e,t,n,r,i,s)};e.prototype.MarkPropUpdateInvalid=function(e,t,n,r){var i=!1;this.ValidateChangeKey(n,!0)&&(i=this.propChangeMgr.MarkPropUpdateInvalid(e,t,n,r));return i};e.prototype.ClearAllPropChangesForRecord=function(e){this.propChangeMgr.ClearAllPropChangesForRecord(e)};e.prototype.AddRowInsertChange=function(e,t){this.ValidateChangeKey(t,!0)&&this.rowChangeMgr.AddInsertChange(e,t)};e.prototype.AddRowDeleteChange=function(e,t){this.ValidateChangeKey(t,!0)&&this.rowChangeMgr.AddDeleteChange(e,t)};e.prototype.AddIndentLevelChange=function(e,t,n,r){this.ValidateChangeKey(r,!0)&&this.levelChangeMgr.AddLevelChange(e,t,n,r)};e.prototype.ApplyChangesToRecord=function(e){this.propChangeMgr.ApplyChangesToRecord(e)};e.prototype.ApplyChangeKey=function(e){if(!this.ValidateChangeKey(e,!0)){ULS.SendErrorMessageJS(ULSCat.msoulscat_WSS_JsGrid,"Invalid change key: "+e.GetVersionNumber().toString());throw new u("Invalid change key: "+e.GetVersionNumber().toString())}null!=this.OnSynchronizeChange&&this.OnSynchronizeChange(e);this.rowChangeMgr.ApplyAllRowInsertChanges(e);this.levelChangeMgr.ApplyAllLevelChanges(e);this.propChangeMgr.SynchronizeToChange(e);this.rowChangeMgr.ApplyAllRowDeleteChanges(e);this.curVersion=e.GetVersionNumber()};e.prototype.UndoChangeKey=function(e){if(!this.ValidateChangeKey(e,null)){ULS.SendErrorMessageJS(ULSCat.msoulscat_WSS_JsGrid,"Invalid change key: "+e.GetVersionNumber().toString());throw new u("Invalid change key: "+e.GetVersionNumber().toString())}null!=this.OnRollbackChange&&this.OnRollbackChange(e);var t=this.TryGetPreviousChangeKeyFromVersion(e.GetVersionNumber());this.curVersion=t.GetVersionNumber();this.rowChangeMgr.UndoAllRowDeleteChanges(e);this.levelChangeMgr.UndoAllLevelChanges(e);this.propChangeMgr.RollBackChange(e);this.rowChangeMgr.UndoAllRowInsertChanges(e)};e.prototype.TryReadPropForChangeKey=function(e,t,n){return this.propChangeMgr.TryReadPropForVersion(e,t,n.GetVersionNumber())};e.prototype.GetChange=function(e,t,r){var i=e.GetVersionNumber();n.JsGridUtil.DebugAssert(!r||i!==this.baselineVersion);var s=this.rowChangeMgr.GetChange(i,t,r),o=this.levelChangeMgr.GetChange(i,t,r),u=this.propChangeMgr.GetChange(i,t,r);return s.concat(o,u).sort(function(e,t){return e.type-t.type})};e.prototype.GetCurrentVersion=function(){return this.curVersion};e.prototype.GetCurrentChangeKey=function(){return this.GetChangeKeyFromVersion(this.curVersion)};e.prototype.IsChangeKeyApplied=function(e){return null!=e&&e.GetVersionNumber()<=this.curVersion};e.prototype.GetNextVersionKey=function(){var e=new l(this.changeCount++,this);this.changeMap.push({key:e,version:e.GetVersionNumber()});e.Reserve();return e};e.prototype.ForceReleaseChanges=function(e,t){var n,r=0;this.ForEachChange(e.GetVersionNumber()+1,t.GetVersionNumber(),this.reservedChanges,function(e,t){n=null==n?t:n;r++});this.reservedChanges.splice(n,r);this.UpdateBaselineVersion()};e.prototype.GetChangeKeyForVersion=function(e){var t=this.GetChangeKeyFromVersion(e);return null!=t&&this.ValidateChangeKey(t,!0)?t:null};e.prototype.Clear=function(){this.reservedChanges=[];this.rowChangeMgr.Clear();this.levelChangeMgr.Clear();this.propChangeMgr.Clear()};e.prototype.ReleaseChanges=function(e,t){this.ForEachChange(e.GetVersionNumber()+1,t.GetVersionNumber(),this.changeMap,function(e,t){e.key.Release()});this.UpdateBaselineVersion()};e.prototype.ReserveChanges=function(e,t){this.ForEachChange(e.GetVersionNumber()+1,t.GetVersionNumber(),this.changeMap,function(e,t){e.key.Reserve()})};e.prototype.VacateChange=function(e){var t=e.GetVersionNumber();n.JsGridUtil.DebugAssert(t>this.baselineVersion);n.JsGridUtil.DebugAssert(t>this.curVersion);this._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnVacateChange,n.JsGridUtil.EventArgs.VacateChange(e));null!=this.OnVacateChange&&this.OnVacateChange(e);this.propChangeMgr.VacateChange(t);this.rowChangeMgr.VacateChange(t);this.levelChangeMgr.VacateChange(t);this.vacatedChanges.VacateChange(t);this.CleanUpChangeMap(t,t)};e.prototype.CleanUpChangeMap=function(e,t){var n,r=0;this.ForEachChange(e,t,this.changeMap,function(e,t){n=null==n?t:n;r++});this.changeMap.splice(n,r)};e.prototype.ForEachChange=function(e,t,r,i){for(var s=null==e?0:n.JsGridUtil.Internal.LowerBound(r,e,"version"),o=null==t?r.length-1:n.JsGridUtil.Internal.LowerBound(r,t,"version"),u=s;u<=o;u++)null!=r[u]&&i(r[u],u)};e.prototype.ValidateChangeKey=function(e,t){var r=e.GetVersionNumber();n.JsGridUtil.DebugAssert(r>this.baselineVersion||t&&r==this.baselineVersion);return!this.vacatedChanges.ChangeIsVacated(r)};e.prototype.TryGetPreviousChangeKeyFromVersion=function(e){for(var t=null,n=0;n<this.changeMap.length&&this.changeMap[n].version<e;n++)t=this.changeMap[n];return t&&t.key};e.prototype.GetChangeKeyFromVersion=function(e){var t=n.JsGridUtil.Internal.BinarySearch(this.changeMap,e,"version");return this.changeMap[t].key};e.prototype.UpdateBaselineVersion=function(){var e=this.reservedChanges.length>0?this.reservedChanges[0]-1:this.curVersion-1;if(e>this.baselineVersion){this.propChangeMgr.AdvanceBaseline(e);this.rowChangeMgr.AdvanceBaseline(e);this.levelChangeMgr.AdvanceBaseline(e);this.vacatedChanges.AdvanceBaseline(e);this.CleanUpChangeMap(this.baselineVersion,e-1);this.baselineVersion=e}};return e})();t.VersionManager=d});
define("aQW",["require","exports","aQY","aPS","aQu","aQX","di","aQo","bt","yn"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a.Killswitch.isActivated("FCBB4612-13ED-47B8-9E17-79F91890AC92","9/26/2019","Translate the title column to linktitle when comparing Grid columns to the additionalColumnSchema"),c=(function(){function e(e,t,n,r,i,s){var o=this;this._sortStateMap={};this.OnPropertyChanged=function(e){delete o.cache[e.fieldKey]};this.OnRecordInserted=function(e){o.ClearCache()};this.OnRecordDeleted=function(e){o.ClearCache()};this._objBag=e;this._autoFilterState=t;this._fnGetLocStr=i;if(s)for(var u=0,a=s;u<a.length;u++){var f=a[u];this._sortStateMap[f.fieldKey]=f.isDescending}this.cache=n||{};this.paneMgr=e.paneMgr;this.delegateMgr=e.delegateMgr;this.jsGridObj=e.jsGridObj;this.Init()}e.prototype.Init=function(){this._autoFilterState=null==this._autoFilterState?{}:this._autoFilterState;this.jsGridObj.AttachEvent(r.JsGridConstants.EventType.OnPropertyChanged,this.OnPropertyChanged);this.jsGridObj.AttachEvent(r.JsGridConstants.EventType.OnRecordInserted,this.OnRecordInserted);this.jsGridObj.AttachEvent(r.JsGridConstants.EventType.OnRecordDeleted,this.OnRecordDeleted);this.addColumnMgr=new n.default(this._objBag)};e.prototype.Dispose=function(){this.jsGridObj.DetachEvent(r.JsGridConstants.EventType.OnPropertyChanged,this.OnPropertyChanged);this.jsGridObj.DetachEvent(r.JsGridConstants.EventType.OnRecordInserted,this.OnRecordInserted);this.jsGridObj.DetachEvent(r.JsGridConstants.EventType.OnRecordDeleted,this.OnRecordDeleted);this.addColumnMgr.Dispose()};e.prototype.SetAutoFilterState=function(e){this._autoFilterState=null==e?{}:e;this.ClearCache()};e.prototype.SeedAutoFilterEntryCache=function(e){this.cache=e||{}};e.prototype.ClearCache=function(){this.cache={}};e.prototype.CanExpandMenu=function(e,t,n,i,s){return t||s||n&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.Sort)||i&&e.isAutoFilterable&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.GetAutoFilterEntries)&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.AutoFilter)&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.LaunchFilterDialog)||e.columnKey==r.JsGridConstants.RecordIndicatorCheckboxColumnKey||this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.WillAddColumnMenuItems)&&this.delegateMgr.Apply(r.JsGridConstants.DelegateType.WillAddColumnMenuItems,e.columnKey)};e.prototype.ExpandMenu=function(e,t,n,a,c,h,p){var d=this;var v=e.columnKey,m=p||this.jsGridObj.parentNode;this.columnMenu=new i.ContextMenuWrapper(m,this.jsGridObj.parentNode.id+"_columnmenu",function(){n()});if(a&&e.isHidable){this.columnMenu.InsertSeparator();this.columnMenu.InsertMenuItem({key:"HideColumn",text:this._fnGetLocStr("HideColumn"),onClick:function(){d.jsGridObj.HideColumn(v)}})}if(e.isFooter)this.addColumnMgr.PopulateNewColumnMenu(this.columnMenu,this._objBag.jsGridParams.onColumnChangeSucceeded,this._objBag.jsGridParams.onLaunchColumnManagementPanel);else{e.fieldType&&-1!==f.FieldTypeSwitcherHelper.getSupportedPanelTypes().indexOf(e.fieldType)&&this._objBag&&this._objBag.jsGridParams&&this._objBag.jsGridParams.onLaunchColumnManagementPanel&&e.isEditable&&!e.isCalculated&&e.internalName&&this.addColumnMgr.EditColumn(this.columnMenu,this._objBag.jsGridParams.onLaunchColumnManagementPanel,e.fieldType,e.internalName);this.columnMenu.InsertMenuItem({key:"RenameColumn",text:this._fnGetLocStr("RenameColumn"),onClick:function(){d.OnColumnRename(v,d._objBag.jsGridParams.onColumnChangeSucceeded)}})}if(c&&e.isSortable&&this._objBag&&this._objBag.jsGridParams&&this._objBag.jsGridParams.onSort){this.columnMenu.InsertSeparator();var g=this._sortStateMap[v];this.columnMenu.InsertMenuItem({key:"SortAsc",text:e.ascendingString||this._fnGetLocStr("SortAsc"),onClick:function(){d._objBag.jsGridParams.onSort(v,!0)},canCheck:!0,checked:!1===g});this.columnMenu.InsertMenuItem({key:"SortDesc",text:e.descendingString||this._fnGetLocStr("SortDesc"),onClick:function(){d._objBag.jsGridParams.onSort(v,!1)},canCheck:!0,checked:!0===g})}if(e.isFilterable&&this._objBag&&this._objBag.jsGridParams&&this._objBag.jsGridParams.onLaunchFilterPanel){var y=this._autoFilterState[v],b=s.default.columnMenuFilter;if(y){var w=y.split(";#");b=o.format(s.default.columnMenuFilterByWithNumber,w.length)}this.columnMenu.InsertMenuItem({key:"FilterBy",text:b,onClick:function(){l?d._objBag.jsGridParams.onLaunchFilterPanel(v):d._objBag.jsGridParams.onLaunchFilterPanel(u.JsGridUtil.Internal.normalizeColumnKey(v))}})}if(v==r.JsGridConstants.RecordIndicatorCheckboxColumnKey){this.columnMenu.InsertSeparator();this.columnMenu.InsertMenuItem({key:"CheckAllRecords",text:this._fnGetLocStr("CheckAllRecords"),onClick:function(){d.jsGridObj.GetCheckSelectionManager().CheckAllRecords()}});this.columnMenu.InsertMenuItem({key:"ClearCheckedRecords",text:this._fnGetLocStr("ClearCheckedRecords"),onClick:function(){d.jsGridObj.GetCheckSelectionManager().ClearCheckedRecords()}})}this.columnMenu.IsEmpty()||this.columnMenu.Show();return!this.columnMenu.IsEmpty()};e.prototype.OnColumnRename=function(e,t){this.columnMenu.Hide();this.paneMgr.RenameColumn(e,t)};return e})();t.default=c});
define("aQY",["require","exports","aPS"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this._objBag=e;this.Init()}e.prototype.Init=function(){this._delegateMgr=this._objBag.delegateMgr;this._objBag.addColumnMgr=this};e.prototype.PopulateNewColumnMenu=function(e,t,r,i){this._delegateMgr.Apply(n.JsGridConstants.DelegateType.AddNewColumnMenuItems,e,t,r,i)};e.prototype.EditColumn=function(e,t,r,i){this._delegateMgr.Apply(n.JsGridConstants.DelegateType.EditColumn,e,t,r,i)};e.prototype.ShouldShowAddColumnMenu=function(){return 1==this._objBag.showAddColumnMenu};e.prototype.Dispose=function(){this._objBag.addColumnMgr=null};return e})();t.default=r});
define("aQu",["require","exports","g","f","aQo","qH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t,o){var u=this;this._itemCount=0;this._seperatorCount=0;this._menuItems=[];this._functionDispatch=[];this._isOpen=!1;this.Hide=function(){if(u.IsOpen()){u._onMenuHidden&&u._onMenuHidden();u.Dispose()}};this.Show=function(){if(u._itemCount){n.render(r.createElement(s.ContextualMenu,{items:u._menuItems,target:u._target,onDismiss:u.Hide,calloutProps:{shouldRestoreFocus:!0}}),u._popupAnchor);u._isOpen=!0}};this.Dispose=function(){u._isOpen=!1;n.unmountComponentAtNode(u._popupAnchor);if(!i.JsGridUtil.Internal.IsNullOrUndefined(u._popupAnchor)&&i.JsGridUtil.Internal.DomElement.GetInstance().GetParentElement(u._popupAnchor)){u._popupAnchor.parentNode.removeChild(u._popupAnchor);u._popupAnchor=null}window[u._id+"_onclick"]=null};this._target=e;this._id=t;this._onMenuHidden=o;this._popupAnchor=document.createElement("div");this._popupAnchor.style.cssText="position:absolute;visibility:hidden;width:250px;";window[this._id+"_onclick"]=function(e){setTimeout(u._functionDispatch[e],0)}}e.prototype.IsOpen=function(){return this._isOpen};e.prototype.IsEmpty=function(){return 0==this._itemCount};e.prototype.InsertMenuItem=function(e){e.onClick&&this._functionDispatch.push(e.onClick);this._menuItems.push(e);this._itemCount++};e.prototype.InsertSeparator=function(){if(this._menuItems.length&&this._menuItems[this._menuItems.length-1].itemType!==s.ContextualMenuItemType.Divider){this._menuItems.push({key:"divider_"+this._seperatorCount,itemType:s.ContextualMenuItemType.Divider});this._seperatorCount++}};e.prototype.RemoveMenuItem=function(e){this._menuItems.splice(e,1)};return e})();t.ContextMenuWrapper=o});
define("aQB",["require","exports","aQo","aQC"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=(function(){function e(e){this.lockCount=0;this.undoStack=[];this.redoStack=[];this.undoRealCmdCount=0;this.redoRealCmdCount=0;this.groupStack=[];this._cmdTypeEnum=i.CommandType;this.preExecuteNotifiers=[];this._maxUndoDepth=e}e.prototype.IsUndoEnabled=function(){return this._maxUndoDepth>0};e.prototype.OpenGroup=function(){this.bApplyingOrUndoing?n.JsGridUtil.DebugAssert(!1,"Cannot open a Command Group within an Apply/Undo"):this.groupStack.push([])};e.prototype.CloseGroup=function(e,t,r){if(this.bApplyingOrUndoing)n.JsGridUtil.DebugAssert(!1,"Cannot close a Command Group within an Apply/Undo");else{n.JsGridUtil.DebugAssert(0!==this.groupStack.length);var i=this.groupStack.pop();if(0!=i.length){var s=1==i.length?i[0]:new o(i,r);this.AppendToUndoStack(s,e,t)}}};e.prototype.Execute=function(e,t,r){if(this.bApplyingOrUndoing){n.JsGridUtil.DebugAssert(!1,"Cannot add a command to the undo stack within an Apply/Undo");e.Apply()}else{this.CleanUpRedoStack();this.AppendToUndoStack(e,t,r);this.PreExecuteNotify();this.bExecuting=!0;e.Apply();this.bExecuting=!1}};e.prototype.Undo=function(){var e;try{if(0!==this.lockCount||this.groupStack.length>0||!this.undoRealCmdCount||this.bApplyingOrUndoing||this.bExecuting)return!1;this.PreExecuteNotify();this.bApplyingOrUndoing=!0;do{(e=this.undoStack.pop()).cmd.Undo();this.redoStack.push(e)}while(e.type==this._cmdTypeEnum.Implicit);this.undoRealCmdCount--;this.redoRealCmdCount++}catch(t){ULS.SendExceptionJS(ULSCat.msoulscat_WSS_JsGrid,t);throw t instanceof r.InvalidChangeKeyError?new u("Failed to Undo command with Name:"+e.name+" and Type:"+e.type+" due to Invalid change key: "+e.cmd.GetChangeKey().GetVersionNumber().toString()):t}finally{this.bApplyingOrUndoing=!1}return!0};e.prototype.Redo=function(){var e;try{if(0!==this.lockCount||0!==this.groupStack.length||!this.redoRealCmdCount||this.bApplyingOrUndoing||this.bExecuting)return!1;this.PreExecuteNotify();this.bApplyingOrUndoing=!0;do{(e=this.redoStack.pop()).cmd.Apply();this.undoStack.push(e)}while(e.type==this._cmdTypeEnum.Implicit);this.redoRealCmdCount--;this.undoRealCmdCount++}catch(t){ULS.SendExceptionJS(ULSCat.msoulscat_WSS_JsGrid,t);throw t instanceof r.InvalidChangeKeyError?new u("Failed to Redo command with Name:"+e.name+" and Type:"+e.type+" due to Invalid change key: "+e.cmd.GetChangeKey().GetVersionNumber().toString()):t}finally{this.bApplyingOrUndoing=!1}return!0};e.prototype.CanUndo=function(){return this.undoRealCmdCount>0};e.prototype.CanRedo=function(){return this.redoRealCmdCount>0};e.prototype.GetUndoStack=function(){return this.undoStack};e.prototype.GetRedoStack=function(){return this.redoStack};e.prototype.ClearUndoStack=function(){this.CleanUpUndoStack()};e.prototype.ClearRedoStack=function(){this.CleanUpRedoStack()};e.prototype.Lock=function(){this.lockCount++};e.prototype.Unlock=function(){this.lockCount=Math.max(this.lockCount-1,0)};e.prototype.AddPreExecuteNotifier=function(e){this.preExecuteNotifiers.push(e)};e.prototype.RemovePreExecuteNotifier=function(e){for(var t=!1,n=0;n<this.preExecuteNotifiers.length;n++)if(this.preExecuteNotifiers[n]==e){this.preExecuteNotifiers.splice(n,1);n--;t=!0;break}return t};e.prototype.PreExecuteNotify=function(){for(var e=[].concat(this.preExecuteNotifiers),t=0;t<e.length;t++)e[t]()};e.prototype.CleanUpUndoStack=function(){for(var e=0;e<this.undoStack.length;e++)this.DisposeCmd(this.undoStack[e].cmd,i.DisposeState.Applied);this.undoStack=[];this.undoRealCmdCount=0};e.prototype.CleanUpRedoStack=function(){if(0!==this.redoStack.length){for(var e=this.redoStack.length-1;e>=0;e--)this.DisposeCmd(this.redoStack[e].cmd,i.DisposeState.Unapplied);this.redoStack=[];this.redoRealCmdCount=0}};e.prototype.AppendToUndoStack=function(e,t,n){if(0!==this.groupStack.length)this.groupStack[this.groupStack.length-1].push(e);else if(0!==this.undoRealCmdCount||n!==this._cmdTypeEnum.Implicit){this.undoStack.push({cmd:e,name:t,type:n});this.undoRealCmdCount+=n!==this._cmdTypeEnum.Implicit?1:0;if(this.undoStack.length>this._maxUndoDepth){this.undoStack[0].type!==this._cmdTypeEnum.Implicit&&this.undoRealCmdCount--;this.DisposeCmd(this.undoStack.shift().cmd,i.DisposeState.Applied);for(;this.undoStack.length&&this.undoStack[0].type==this._cmdTypeEnum.Implicit;)this.DisposeCmd(this.undoStack.shift().cmd,i.DisposeState.Applied)}}};e.prototype.DisposeCmd=function(e,t){n.JsGridUtil.Internal.IsNullOrUndefined(e.Dispose)||e.Dispose(t)};return e})();t.CommandManager=s;(function(e){e.CommandType={Explicit:0,Implicit:1};e.DisposeState={Applied:0,Unapplied:1}})(i=t.CommandManagerConstants||(t.CommandManagerConstants={}));var o=(function(){function e(e,t){n.JsGridUtil.DebugAssert(!n.JsGridUtil.Internal.IsNullOrUndefined(e)&&0!==e.length);this.cmdArray=e;this.bReverseOnUndo=t}e.prototype.Apply=function(){for(var e=this.cmdArray.length,t=0;t<e;t++)this.cmdArray[t].Apply()};e.prototype.Undo=function(){var e,t=this.cmdArray.length;if(this.bReverseOnUndo)for(e=t-1;e>=0;e--)this.cmdArray[e].Undo();else for(e=0;e<t;e++)this.cmdArray[e].Undo()};e.prototype.Dispose=function(e){for(var t=this.cmdArray.length,r=0;r<t;r++){var i=this.cmdArray[r];n.JsGridUtil.Internal.IsNullOrUndefined(i.Dispose)||i.Dispose(e)}};return e})();t.AggregateCommand=o;var u=function(e){this.message=e||"Command Manager Error";this.name="CommandManagerError"};t.CommandManagerError=u});
define("aQF",["require","exports","aQo","aPS","aQU","aQn","aQT","aQS","aQQ","aQP","aQO","aQN","aQI","aQT","aPY","aQv","aQH","aQw","aQ2","aPT","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";w=w.panemgr_9;Object.defineProperty(t,"__esModule",{value:!0});var E={ODB:1725},S={ODB:1170},x=(function(){function e(e,t,s,h,p,d,v){var m=this;this.CONST_minPaneWidth=o.GetMinScrollBarLength();this.CONST_minControlWidth=2*this.CONST_minPaneWidth+r.JsGridConstants.Internal.SplitterWidth+o.GetSystemScrollBarThickness();this.CONST_minControlHeight=o.GetMinScrollBarLength()+o.GetSystemScrollBarThickness();this.rowData=[];this.recordCount=0;this.keyToViewIdxMap={};this.bHandlersSet=!1;this.bHorizontalScrollBarVisible=!0;this.cleared=!0;this.mostRecentMouseDownCoords=null;this.bResizingScrollbar=!1;this.bRefreshingAllRows=!1;this.bDeletingOrInsertingRows=!1;this.OnFocus_Window=function(e){m.cutcopypasteMgr.CheckClipboard()};this.OnResize_Window=function(e){m.HandleParentResize()};this.OnMouseDown=function(e){m.mostRecentMouseDownCoords={x:e.clientX,y:e.clientY};if(m._fnIsGridEnabled()){n.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);m.Focus()}};this._jsGridElementId=e;this._objBag=t;this._fnGetLocStr=s;this._parentNode=h;this._minHeaderHeight=p;this._minRowHeight=d;this._fnIsGridEnabled=v;this.lastParentSize={height:h.offsetHeight,width:h.offsetWidth};this.selectionMgr=this._objBag.selectionMgr=new i.SelectionManager(function(e){null!=m.eventSinks.OnFocusedCellChanged&&m.eventSinks.OnFocusedCellChanged(e)});this.changeHighlightMgr=new u.ChangeHighlightManager;this.editMgr=new a.EditManager(this._objBag,function(e,t,n,r){m.eventSinks.OnPropertiesChanged(e,t,n,r)},this.GetCellValue.bind(this));this.cutcopypasteMgr=this._objBag.cutcopypasteMgr=new f.CutCopyPasteManager(this._objBag,s);this.fillDownMgr=new l.FillDownManager(this._objBag.intDelegateMgr,this._objBag.styleMgr);this.focusMgr=this._objBag.focusMgr=new c.FocusManager(e,this._objBag,h,s,v,this.IsGridVisible.bind(this),this.selectionMgr,this.editMgr,this.GetCellValue.bind(this),this.RetryErrorRows.bind(this),this.ScrollIntoViewVertically.bind(this));this.Init()}e.prototype.SetEventSinks=function(e){this.eventSinks=e};e.prototype.Dispose=function(){var e=this,t=function(){e.vertScrollBarContainer=e.leftPaneParent=e.rightPaneParent=e._parentNode=e.borderElement=null;e.editMgr.Dispose();e.focusMgr.Dispose();null!=e.touchMgr&&e.touchMgr.Dispose()};if(null!=this.panes){this.cutcopypasteMgr.CancelMode();this.editMgr.StopEditing(!0);this.editMgr.Unbind(function(){e.UpdatePanes(0,e.rowData.length,0,0,!0);e.panes.each("Dispose");e.vertScrollBar.Dispose();e._parentNode.removeEventListener("mousedown",e.OnMouseDown);window.removeEventListener("focus",e.OnFocus_Window);window.removeEventListener("resize",e.OnResize_Window);t()})}else t()};e.prototype.ClearView=function(){this.cleared=!0;this._objBag.entryRecordMgr.NotifyTableViewCleared();this.editMgr.Unbind();this.selectionMgr.Clear();this.cutcopypasteMgr.CancelMode();this.RefreshAllRows(0);null!=this.panes&&this.panes.each("ClearView")};e.prototype.NotifyCreateEntryRow=function(e,t){if(null!=this.posConverter){var n=e+this.posConverter.GetViewRecordCount(),r=this.posConverter.ViewIdxToRelViewIdx(n);this.UpdateRecordCount(1);this.vertScrollBar.GetItemDisplayCapacity()>r?this.UpdatePanes(0,0,r,1,!0):t&&this.ScrollIntoViewVertically(n)}};e.prototype.NotifyRemoveEntryRow=function(e){null!=this.posConverter&&this.NotifyDeleteRows(e+this.posConverter.GetViewRecordCount(),1)};e.prototype.GetLastRecordKey=function(){return null!=this.posConverter?this.posConverter.GetLastRecordKey():null};e.prototype.ChangeKeys=function(e,t){this.panes.each("ChangeKeys",e,t);if(e in this.keyToViewIdxMap){this.keyToViewIdxMap[t]=this.keyToViewIdxMap[e];delete this.keyToViewIdxMap[e]}};e.prototype.GetVirtualRowCount=function(){return this.gridPane.GetGridPaneConverter().GetVirtualRowCount()};e.prototype.GetVisibleRecordCount=function(){return Math.min(this.recordCount-this.vertScrollBar.GetTopItemIdx(),this.vertScrollBar.GetItemDisplayCapacity())};e.prototype.GetPartialRecordMap=function(e,t){var n,i=this.gridPane.GetGridPaneConverter();this._objBag.intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(t){return n=i.GetRecordsInvolved(e.begin,e.Size(),function(e){n=e;t()})},function(){t(n)})};e.prototype.GetRawRecordMap=function(e,t){var n,i=this;this._objBag.intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(){i._objBag.tableCache.GetRawDataRecords();return n=i._objBag.tableCache.GetRecordCache()},function(){t(n)})};e.prototype.GetRecordMap=function(e){var t=this.gridPane.GetGridPaneConverter(),n=new s.Range(0,t.GetVirtualRowCount()-1);this.GetPartialRecordMap(n,e)};e.prototype.GetGridPaneRowRange=function(){return new s.Range(0,this.gridPane.GetGridPaneConverter().GetVirtualRowCount()-1)};e.prototype.AddColumn=function(e){var t=this.gridPane.GetAllColumns(),n=t.GetColumnPosition("JSGrid_NewColumn");t.InsertColumnAt(n,e)};e.prototype.GetAllDataJson=function(e,t){this.GenerateGridDataJson(e,t,!1)};e.prototype.GetAllDataAfterExpansionJson=function(e,t){this.GenerateGridDataJson(e,t,!0)};e.prototype.GenerateGridDataJson=function(e,t,n){var r=this;this._objBag.jsGridObj.Disable();var i=this.gridPane.GetGridPaneConverter(),o=n?new s.Range(0,this._objBag.tableCache.GetRecordCacheSize()-1):new s.Range(0,i.GetVirtualRowCount()-1),u=new s.Range(0,i.GetVirtualColumnCount()-1),a=null!=this.pivotedGridPane?this.pivotedGridPane.GetGridPaneConverter():null,f=null!=this.pivotedGridPane?a.GetRowMultiple():0,l=null!=this.pivotedGridPane?new s.Range(0,a.GetVirtualColumnCount()-1):null,c=function(e){for(var t=e.GetColumnArray(!0),n=[],r=0;r<t.length;++r)n.push(e.GetColumnByKey(t[r].columnKey).name);return n},h={gridPaneData:null,gridPaneColumns:null,gridPaneStyleData:{cellStyleData:[]},pivotedGridPaneData:null,pivotedGridPaneColumns:null,pivotedGridPaneStyleData:{cellStyleData:[]}},p=[],d=0,v=0,m=[],g=0,y=0,b=this.gridPane.GetAllColumns(),w=b.GetColumnArray();h.gridPaneColumns=c(b);null!=this.pivotedGridPane&&(h.pivotedGridPaneColumns=c(this.pivotedGridPane.GetAllColumns()));var E=function(e){var t=e,i=null;if(e.end-e.begin+1>128){t=new s.Range(e.begin,e.begin+128-1);i=new s.Range(e.begin+128,e.end)}n?r.GetRawRecordMap(t,function(e){return S(e,t,i)}):r.GetPartialRecordMap(t,function(e){return S(e,t,i)})},S=function(i,o,a){var c=r.gridPane.GetData(i,o,u,n);if(null!=t)for(var b in i)for(var S=r._objBag.paneMgr.RecordKeyToViewIdx(b),x=i[b],T=0;T<w.length;++T){var N=w[T].columnKey,C=t(x,N);null!=C&&h.gridPaneStyleData.cellStyleData.push({matrixRow:S,matrixColumn:T,styleText:C})}var k=JSON.stringify(c.matrix);p.push(k.substr(1,k.length-2));d+=c.height;v=c.width;var L=null;if(null!=r.pivotedGridPane){var A=new s.Range(o.begin*f,o.end*f+f-1);L=r.pivotedGridPane.GetData(i,A,l,n);var O=JSON.stringify(L.matrix);m.push(O.substr(1,O.length-2));g+=L.height;y=L.width}null!=a?setTimeout(function(){E(a)},0):setTimeout(function(){var t=["{",'"gridPaneData":{"matrix":',"[",p.join(","),"]",',"height":',d,',"width":',v,"},",'"gridPaneColumns":',JSON.stringify(h.gridPaneColumns),",",'"gridPaneStyleData":',JSON.stringify(h.gridPaneStyleData),",",'"pivotedGridPaneData":',null!=r.pivotedGridPane?['{"matrix":',"[",m.join(","),"]",',"height":',g,',"width":',y,"}"].join(""):"null",",",'"pivotedGridPaneColumns":',null!=r.pivotedGridPane?JSON.stringify(h.pivotedGridPaneColumns):"null",",",'"pivotedGridPaneStyleData":',JSON.stringify(h.pivotedGridPaneStyleData),",",'"pivotedGridPaneRowMultiple":',f,"}"].join("");r._objBag.jsGridObj.Enable();setTimeout(function(){e(t)},0)},0)};E(o)};e.prototype.SetView=function(e,t,i,s,o,u,a,f,l,c,d,v,m,g,y,b,w,E,S){this.lastParentSize={height:this._parentNode.offsetHeight,width:this._parentNode.offsetWidth};0==this._parentNode.offsetHeight&&0==this._parentNode.offsetWidth&&(this.lastParentSize={height:this._parentNode.clientHeight,width:this._parentNode.clientWidth});this.cleared=!1;this.posConverter=e;this.paneLayout=y;this.gridFieldMap=i;this.splitterPos=u;this.bNewRowEnabled=this._objBag.editUtil.IsNewRowEnabled();this.posConverter.SetPaneMgrObj(this);this.posConverter.SetScrollBarObj(this.vertScrollBar);this.selectionMgr.SetAllowedSelectionTypes(f);this.cutcopypasteMgr.CancelMode();n.JsGridUtil.DebugAssert(this.paneLayout==r.JsGridConstants.PaneLayout.GridOnly||this.paneLayout==r.JsGridConstants.PaneLayout.GridAndGantt&&null!=b||this.paneLayout==r.JsGridConstants.PaneLayout.GridAndPivotedGrid&&null!=w);if(null==this.gridPane){this.CreateBorderHtmlElements();this.CreateSelectionBorderHtmlElements();this.CreateLeftPaneHtmlElements();var x=new T(this.leftPaneParent,this);this.gridPane=new h.GridPane(this.leftPaneParent,this._objBag,this.ScrollIntoViewVertically.bind(this),this.ScrollVerticallyByTouch.bind(this),this.paneLayout==r.JsGridConstants.PaneLayout.GridOnly?this.OnHorizontalGridPaneScrollBarVisibilityChange:null,this._objBag.commandMgr,this.selectionMgr,this.changeHighlightMgr,this.editMgr,this.cutcopypasteMgr,this.fillDownMgr,x,this.GetCellValue.bind(this),this._fnGetLocStr,this.RetryErrorRows,this.visualSelectionHtmlElements);this.gridPane.paneSize=x;this.panes=[this.gridPane];this.panes.each=N;this.touchMgr.RegisterTouchableAction("left",{element:this.leftPaneParent,control:this.gridPane})}else this.borderElement.style.display="none";null==this.vertScrollBar&&(this.vertScrollBar=new p.ScrollBar(p.ScrollBarType.Vertical,this.vertScrollBarContainer,!0,null,this._objBag.styleMgr.scrollBarStyle,this._objBag.RTL.bEnabled,this._objBag));this.posConverter.SetScrollBarObj(this.vertScrollBar);this.vertScrollBar.Update({topItemIdx:0,bScrollNotifiy:!1});this.CoordinateHeights();this.LayoutChildElements(!0);this.gridPane.SetView(e,o,this.AddSentinalColumns(t,E),this.gridFieldMap,a,l,c,d,v,m,g,S);null!=this.pivotedGridPane&&this.pivotedGridPane.SetView(e,o,w.columns,this.gridFieldMap,a,!1,!1,!1,!1,!1,!1,null);this.CoordinateHeights();this.panes.each("SetEventSinks",this.eventSinks);this.RefreshAllRows(s);if(!this.bHandlersSet){this.vertScrollBar.SetOnScroll(this.OnVerticalScroll.bind(this));this.vertScrollBar.SetOnVisibilityChanged(this.OnVerticalScrollbarVisibilityChanged.bind(this),!0);this._parentNode.addEventListener("mousedown",this.OnMouseDown);window.addEventListener("focus",this.OnFocus_Window);window.addEventListener("resize",this.OnResize_Window);this.bHandlersSet=!0}this.panes.each("OnResize");this.focusMgr.SetView(this.paneLayout,this.gridPane,this.pivotedGridPane,this.gridFieldMap,l,c,d,v,m,g,S);this._objBag.entryRecordMgr.NotifyTableViewChangeCompleted();this.borderElement.style.display=""};e.prototype.SetFilterState=function(e){this.gridPane.SetFilterState(e)};e.prototype.SetSortState=function(e){this.gridPane.SetSortState(e)};e.prototype.RecordKeyToViewIdx=function(e){return this.keyToViewIdxMap[e]};e.prototype.RefreshAllRows=function(e,t){this.bRefreshingAllRows=!0;if(null!=this.posConverter){this.SetRecordCount(this.posConverter.GetViewRecordCount(),e);this.UpdatePanes(0,this.rowData.length,0,this.GetVisibleRecordCount(),!t)}else this.UpdatePanes(0,this.rowData.length,0,this.rowData.length,!t);this.bRefreshingAllRows=!1};e.prototype.NotifyNewRowStateChanged=function(e){this.cutcopypasteMgr.CancelMode();var t=this.bNewRowEnabled;this.bNewRowEnabled=this._objBag.editUtil.IsNewRowEnabled();if(t!==this.bNewRowEnabled){this._objBag.entryRecordMgr.EnsureLastEntryRowExists();e||this.RefreshAllRows()}};e.prototype.NotifyChangedRowByKey=function(e){e in this.keyToViewIdxMap&&this.NotifyChangedRows(this.keyToViewIdxMap[e],1)};e.prototype.NotifyChangedRows=function(e,t){n.JsGridUtil.DebugAssert(e+t<=this.recordCount);var r=this.GetClippedRangeInfo(e,t);r.clippedCount<1||this.UpdatePanes(r.clippedRelViewIdx,r.clippedCount,r.clippedRelViewIdx,r.clippedCount,!1)};e.prototype.NotifyUpdateProperty=function(e,t,n,r,i,s){if(null!=e)this.panes.each("NotifyUpdateProperty",e,t,n,r,i,s);else for(var o=0;o<this.rowData.length;o++){var u=this.rowData[o];null!=u&&this.panes.each("NotifyUpdateProperty",u.recordKey,t,n,r,i,s)}};e.prototype.NotifyInsertRows=function(e,t,r,i){var s=this;n.JsGridUtil.DebugAssert(e<=this.recordCount&&t>=0);this.editMgr.Unbind(function(){s.bDeletingOrInsertingRows=!0;var n=s.vertScrollBar.GetTopItemIdx(),o=n+(e<n?t:0);s.UpdateRecordCount(t,o);s.bDeletingOrInsertingRows=!1;var u=s.GetClippedRangeInfo(e,t);if(u.clippedCount<1)s.RebuildKeyToPosMap();else{var a=u.clippedRelViewIdx,f=u.clippedCount,l=s.vertScrollBar.GetItemDisplayCapacity()-s.rowData.length,c=Math.max(f-l,0),h=s.rowData.length-c;s.UpdatePanes(h,c,a,f,!0);r&&s.UpdateFocusAfterInsertOrDeleteRows(e,t-1,!0);null!=i&&i()}})};e.prototype.NotifyDeleteRows=function(e,t){var r=this;this.editMgr.Unbind(function(){var i=r.GetClippedRangeInfo(e,t);r.bDeletingOrInsertingRows=!0;var s=r.vertScrollBar.GetTopItemIdx(),o=s+Math.max(Math.min(e-s,0),-t);r.UpdateRecordCount(-t,o);n.JsGridUtil.DebugAssert(r.vertScrollBar.GetTopItemIdx()<=o,"the scroll bar should never auto scroll down");var u=Math.max(o-r.vertScrollBar.GetTopItemIdx(),0);o=r.vertScrollBar.GetTopItemIdx();r.bDeletingOrInsertingRows=!1;if(i.clippedCount<1)r.RebuildKeyToPosMap();else{var a=r.vertScrollBar.GetItemDisplayCapacity(),f=o+a==r.recordCount+1&&r.vertScrollBar.PartialRowPresent(),l=r.rowData.length!==a,c=i.clippedRelViewIdx,h=Math.max(Math.min(c+i.clippedCount,r.rowData.length)-c,0);r.UpdatePanes(c,h,0,u,!0);var p=Math.max(Math.min(i.clippedCount,r.recordCount-r.rowData.length+u),0),d=Math.min(r.recordCount-(o+r.rowData.length),p);n.JsGridUtil.DebugAssert(d>=0,"Insert bottom count should not be negative.");r.UpdatePanes(0,0,r.rowData.length,d,!0);var v=p-d-u;v>0&&!l&&f&&v--;r.UpdatePanes(0,0,0,v,!0);r.UpdateFocusAfterInsertOrDeleteRows(e,t,!1)}})};e.prototype.UpdateFocusAfterInsertOrDeleteRows=function(e,t,n){this.panes.each("UpdateFocusAfterInsertOrDeleteRows",e,t,n)};e.prototype.ScrollCellIntoView=function(e,t,n){var r=this.GetPane(n);null!=e&&this.vertScrollBar.ScrollIntoView(r.GetGridPaneConverter().RowIdxToViewIdx(e));null!=t&&r.ScrollColumnIntoViewHorizontally(t)};e.prototype.ScrollUpByOne=function(){this.vertScrollBar.ScrollUpByOne()};e.prototype.ScrollDownByOne=function(){this.vertScrollBar.ScrollDownByOne()};e.prototype.IsCellEditable=function(e,t,n){var r=this.GetPane(n).GetGridPaneConverter(),i=r.GetColumnByIdx(r.FieldKeyToColIdx(t));return this._objBag.editUtil.CanEditField(e,i,t)};e.prototype.Focus=function(){this.focusMgr.Focus()};e.prototype.GetMostRecentMouseDownCoordinates=function(){return this.mostRecentMouseDownCoords};e.prototype.StopEditing=function(e){this.editMgr.StopEditing(e)};e.prototype.UnbindEditing=function(e){this.editMgr.Unbind(e)};e.prototype.NotifyResize=function(){this.HandleParentResize()};e.prototype.GetTopRowIndex=function(e){return this.GetPane(e).BeginRowIdx()};e.prototype.GetLeftColumnIndex=function(e){return this.GetPane(e).BeginColIdx()};e.prototype.ShowColumn=function(e,t){this.gridPane.ShowColumn(e,t)};e.prototype.EnsurePaneWidth=function(){this.gridPane.EnsurePaneWidth()};e.prototype.HideColumn=function(e){this.gridPane.HideColumn(e)};e.prototype.RenameColumn=function(e,t){this.gridPane.RenameColumn(e,t)};e.prototype.DeleteColumn=function(e){this.gridPane.DeleteColumn(e)};e.prototype.UpdateColumns=function(e){this.gridPane.UpdateColumns(e)};e.prototype.GetColumns=function(e){return this.FilterColumns(this.GetPane(e).GetColumns(),[r.JsGridConstants.RecordIndicatorCheckboxColumnKey,"JSGrid_NewColumn"])};e.prototype.GetRecordIndicatorCheckBoxColumnIndex=function(){var e=this.GetPane(null);return e&&n.JsGridUtil.Internal.FindInArray(e.GetColumns(),function(e){return e.columnKey==r.JsGridConstants.RecordIndicatorCheckboxColumnKey})};e.prototype.ScrollToAndExpandNextError=function(e,t,n,i){var s=this,o=null==t?this._objBag.errorMgr.GetNextError(e,n):this._objBag.errorMgr.GetNextErrorForRecord(e,t,n);if(null!=o){var u,a=this.posConverter.RecordKeyToViewIdx(o.recordKey);if(null!=a){for(var f=0;f<this.panes.length&&null==u;f++){var l=this.panes[f];if((l.Id==r.JsGridConstants.PaneId.MainGrid||l.Id==r.JsGridConstants.PaneId.PivotedGrid)&&null==(u=o.type==y.ErrorType.Row?0:l.GetGridPaneConverter().FieldKeyToColIdx(o.fieldKey))){var c=l.FieldKeyToColumnKey(o.fieldKey);if(null!=c){l.ShowColumn(c,null);u=l.GetGridPaneConverter().FieldKeyToColIdx(o.fieldKey)}}}this.ScrollCellIntoView(a,u,l.Id);if(o.type==y.ErrorType.Cell&&null!=u){this.selectionMgr.SetFocusByKey(l,o.recordKey,o.fieldKey);!0!==i&&setTimeout(function(){s.editMgr.ExpandWidget(r.JsGridConstants.ErrorWidgetId)},0)}return o.id}}return null};e.prototype.FilterColumns=function(e,t){for(var n=0;n<t.length;n++)for(var r=0;r<e.length;r++)if(e[r].columnKey==t[n]){e.splice(r,1);break}return e};e.prototype.ClearAllChangeIndications=function(){this.panes.each("NotifyChangeIndicatorsClearing");this.changeHighlightMgr.Clear()};e.prototype.GetFocusedItemInfo=function(){var e=this.selectionMgr.GetFocus();return null==e?null:{recordKey:e.recordKey,fieldKey:e.fieldKey,paneId:e.gridPane.Id}};e.prototype.JumpToEntryRecord=function(){if(this.bNewRowEnabled){var e=this._objBag.entryRecordMgr.GetLastEntryKey(),t=this.gridPane.GetColumns()[0].columnKey;this.gridPane.SelectByKey(e,e,t,t,!1);this.ScrollCellIntoView(this.posConverter.RecordKeyToViewIdx(e),0,this.gridPane.Id)}};e.prototype.GetSplitterPosition=function(){return null!=this.rightPane?this.splitterPos:0};e.prototype.SetSplitterPosition=function(e){this.SetSplitterPositionCore(e);this.LayoutChildElements()};e.prototype.Select=function(e,t,n,r,i,s){this.GetPane(s).Select(e,t,n,r,i)};e.prototype.SelectByKey=function(e,t,n,r,i,s){this.GetPane(s).SelectByKey(e,t,n,r,i)};e.prototype.GetOrderedSelections=function(e,t){return this.selectionMgr.GetOrderedSelections(this.GetPane(e),t)};e.prototype.NotifyCanEditUpdated=function(){this.panes.each("NotifyCanEditUpdated")};e.prototype.GetGridPane=function(){return this.gridPane};e.prototype.GetPane=function(e){var t=e==r.JsGridConstants.PaneId.MainGrid||null==e?this.gridPane:null;n.JsGridUtil.DebugAssert(null!=t,"Invalid PaneId ("+e+")");return t};e.prototype.SetSplitterPositionCore=function(e){null!=this.rightPane&&(this.splitterPos=Math.min(Math.max(e,this.CONST_minPaneWidth),this.GetControlWidth()-o.GetSystemScrollBarThickness()-(this.rightPane?this.CONST_minPaneWidth+r.JsGridConstants.Internal.SplitterWidth:0)))};e.prototype.GetControlWidth=function(){return Math.max(this.lastParentSize.width-2,this.CONST_minControlWidth)};e.prototype.GetControlHeight=function(){return Math.max(this.lastParentSize.height-2,this.CONST_minControlHeight)};e.prototype.AddSentinalColumns=function(e,t){var n=e;this._objBag.showAddColumnMenu&&this._objBag.canUserAddColumn&&(n=this.AddCreateColumn(n));return this.TryAddRecordIndicatorCheckboxesToColumns(n,t)};e.prototype.AddCreateColumn=function(e){var t="JSGrid_NewColumn";(this.gridFieldMap[t]=new v.GridField(t,!1,!1,r.JsGridConstants.TextDirection.Default,null,r.JsGridConstants.EditMode.ReadOnly)).SetSingleValuePropType(d.PropertyType.Utils.GetPropType("String"));if(n.JsGridUtil.Internal.IsFeatureEnabled(S)){var i;(i=new v.ColumnInfo("",null,t,150)).isResizable=!0;i.isSortable=!1;i.isHidable=!1;i.isAutoFilterable=!1;i.isFooter=!0;i.name="+ "+b.default.L_AddColumn_Text;i.bOpenMenuOnContentClick=!0;return new v.ColumnInfoCollection(e.GetColumnArray().concat([i]))}(i=new v.ColumnInfo("",null,t,r.JsGridConstants.Internal.IconColumnWidth)).isResizable=!1;i.isSortable=!1;i.isHidable=!1;i.isAutoFilterable=!1;i.isFooter=!0;i.name=this._fnGetLocStr("AddColumn");i.imgSrc=n.JsGridUtil.Internal.SiteUrl+"/_layouts/images/createview.gif";i.iconName="CalculatorAddition";i.isIconOnly=!0;i.bOpenMenuOnContentClick=!0;return new v.ColumnInfoCollection(e.GetColumnArray().concat([i]))};e.prototype.TryAddRecordIndicatorCheckboxesToColumns=function(e,t){var i=this,s=e;if(t){var o=r.JsGridConstants.RecordIndicatorCheckboxColumnKey,u=this.gridFieldMap[o]=new v.GridField(o,!1,!1,r.JsGridConstants.TextDirection.Default,null,r.JsGridConstants.EditMode.ReadOnly),a=n.JsGridUtil.Internal.object(d.PropertyType.Utils.GetPropType("CheckBoxBoolean"));a.ID="RecordIndicatorCheckBoxBoolean";a.GetDisplayValue=function(e,t,n){return i._objBag.checkSelMgr.IsRecordIndicatorCheckboxChecked(e.key())?SP.JsGrid.Res.checkboxChecked:SP.JsGrid.Res.checkboxUnchecked};d.PropertyType.RegisterNewDerivedCustomPropType(a,"CheckBoxBoolean");u.SetSingleValuePropType(a);var f=new v.ColumnInfo("",null,o,r.JsGridConstants.Internal.MinColumnWidth);f.isResizable=f.isSortable=f.isHidable=f.isAutoFilterable=f.isAutoFilterable=!1;f.fnGetDisplayControlName=function(){return i._objBag.gridControls[r.JsGridConstants.RecordIndicatorControlId].Id};s=new v.ColumnInfoCollection([f].concat(e.GetColumnArray()))}return s};e.prototype.Init=function(){};e.prototype.ScrollIntoViewVertically=function(e){return this.vertScrollBar.ScrollIntoView(e)};e.prototype.ScrollVerticallyByTouch=function(e){e?this.ScrollUpByOne():this.ScrollDownByOne()};e.prototype.SetRecordCount=function(e,t){this.recordCount=this.cleared?0:e+(this.bNewRowEnabled?this._objBag.entryRecordMgr.GetEntryRecords().length:0);this.vertScrollBar.Update({itemCount:this.recordCount,topItemIdx:t});return this.recordCount};e.prototype.UpdateRecordCount=function(e,t){this.recordCount+=e;this.vertScrollBar.Update({itemCount:this.recordCount,topItemIdx:t});return this.recordCount};e.prototype.GetClippedRangeInfo=function(e,t){var n=e,r=e+t-1;n=Math.max(0,Math.min(this.recordCount-1,n));r=Math.max(0,Math.min(this.recordCount-1,r));var i=this.posConverter.ViewIdxToRelViewIdx(n),s=this.posConverter.ViewIdxToRelViewIdx(r);return{clippedRelViewIdx:i=Math.max(i,0),clippedCount:(s=Math.min(s,this.vertScrollBar.GetItemDisplayCapacity()-1))-i+1}};e.prototype.CreateBorderHtmlElements=function(){this._parentNode.style.direction=this._objBag.RTL.ltr;this.borderElement=document.createElement("div");this.borderElement.style.width="100%";this._parentNode.appendChild(this.borderElement);this.touchMgr=new m.GridTouchManager(this.borderElement)};e.prototype.CreateLeftPaneHtmlElements=function(){this.leftPaneParent=document.createElement("div");this.leftPaneParent.id=this._jsGridElementId+"_leftpane";this.leftPaneParent.gridItem=!0;this.borderElement.appendChild(this.leftPaneParent);this.vertScrollBarContainer=document.createElement("div");this.vertScrollBarContainer.gridItem=!0;this.vertScrollBarContainer.style.cssText="display:none;";this.borderElement.appendChild(this.vertScrollBarContainer)};e.prototype.CreateSelectionBorderHtmlElements=function(){var e=n.JsGridUtil.Internal.IsFeatureEnabled(E),t="position:absolute; visibility:hidden; top:0px; left:0px; width:0px; height:0px;",r=document.createElement("div");r.style.cssText=t;if(e){r.style.width=r.style.height="6px";r.classList.add(w.selectionDragHandle)}else{r.style.width=r.style.height="5px";r.style.cursor="crosshair"}this._objBag.parentNode.appendChild(r);var i={Top:document.createElement("div"),Right:document.createElement("div"),Bottom:document.createElement("div"),Left:document.createElement("div")};for(var s in i){var o=i[s];o.style.cssText=t;e&&this.AddFrameElementClassName(o,s);this._objBag.parentNode.appendChild(o)}var u={Top:document.createElement("div"),Right:document.createElement("div"),Bottom:document.createElement("div"),Left:document.createElement("div")};for(var s in u){var a=u[s];a.style.cssText=t;if(e){this.AddFrameElementClassName(a,s);a.style.borderWidth="2px";a.style.cursor="default"}else a.style["border"+s]=g.StyleUtil.MakeBorderString(1,"solid",this._objBag.styleMgr.gridPaneStyle.selectionRectBorderColor);this._objBag.parentNode.appendChild(a)}var f={Back:{Top:document.createElement("div"),Right:document.createElement("div"),Bottom:document.createElement("div"),Left:document.createElement("div")},Fore:{Top:document.createElement("div"),Right:document.createElement("div"),Bottom:document.createElement("div"),Left:document.createElement("div")}};for(var s in f){var l=void 0,c=void 0;e?c="Back"===s?w.solidBorder:w.dashedBorder:l="Back"==s?g.StyleUtil.MakeBorderString(2,"solid",this._objBag.styleMgr.gridPaneStyle.copyRectBackBorderColor):g.StyleUtil.MakeBorderString(2,"dashed",this._objBag.styleMgr.gridPaneStyle.copyRectForeBorderColor);for(var h in f[s]){var p=f[s][h];p.style.cssText=t;if(e){p.classList.add(c,w.copyFrame);this.AddFrameElementClassName(p,h)}else p.style["border"+h]=l;this._objBag.parentNode.appendChild(p)}}this.visualSelectionHtmlElements={selectionDragHandle:r,selectionFrames:i,focusFrames:u,copyFrames:f}};e.prototype.AddFrameElementClassName=function(e,t){switch(t){case"Top":e.classList.add(w.topFrameElement);break;case"Bottom":e.classList.add(w.bottomFrameElement);break;case"Left":e.classList.add(w.leftFrameElement);break;case"Right":e.classList.add(w.rightFrameElement)}};e.prototype.GetEffectiveHorizontalScrollBarHeight=function(){return this.bHorizontalScrollBarVisible?o.GetSystemScrollBarThickness():0};e.prototype.GetEffectiveVerticalScrollBarWidth=function(){return"none"!==this.vertScrollBarContainer.style.display?o.GetSystemScrollBarThickness():0};e.prototype.LayoutChildElements=function(e){this.SetSplitterPositionCore(this.splitterPos);var t=this.GetControlHeight();null!=this.vertScrollBar&&this.vertScrollBar.Update({physicalViewportSize:t-this.headerHeight-this.GetEffectiveHorizontalScrollBarHeight(),scrollbarSize:t});var n=this.GetControlWidth();if(null!=this.rightPaneParent){var i=this.splitterPos,s=n-(this.splitterPos+r.JsGridConstants.Internal.SplitterWidth+this.GetEffectiveVerticalScrollBarWidth());if(this._objBag.RTL.bEnabled){this.rightPane.paneSize.SetValues(s,this.GetEffectiveVerticalScrollBarWidth());this.gridPane.paneSize.SetValues(i,n-i)}else{this.gridPane.paneSize.SetValues(i,0);this.rightPane.paneSize.SetValues(s,n-this.GetEffectiveVerticalScrollBarWidth()-s)}}else{i=n-this.GetEffectiveVerticalScrollBarWidth();this.gridPane.paneSize.SetValues(i,this._objBag.RTL.bEnabled?this.GetEffectiveVerticalScrollBarWidth():0)}this.cleared||e||this.panes.each("OnResize");this.editMgr.NotifyMove()};e.prototype.HandleParentResize=function(){this.borderElement.style.display="none";if(!this.IsGridVisible()||this._parentNode.offsetHeight==this.lastParentSize.height&&this._parentNode.offsetWidth==this.lastParentSize.width)this.borderElement.style.display="";else{this.lastParentSize={height:this._parentNode.offsetHeight,width:this._parentNode.offsetWidth};this.borderElement.style.display="";n.JsGridUtil.Internal.DomElement.GetInstance().ForceIEZoomFactorRecomputation();var e=this.vertScrollBar.GetItemDisplayCapacity(),t=this.vertScrollBar.GetTopItemIdx();this.bResizingScrollbar=!0;this.LayoutChildElements();var r=this.GetControlHeight();this.vertScrollBar.SetViewportSize(r-this.headerHeight-this.GetEffectiveHorizontalScrollBarHeight(),!0,r-this.GetEffectiveHorizontalScrollBarHeight());this.bResizingScrollbar=!1;this.ModifyRowsForNewViewport(e,t)}};e.prototype.CoordinateHeights=function(){var e=this.headerHeight,t=this.rowHeight;this.headerHeight=this._minHeaderHeight?this._minHeaderHeight:0;this.headerHeight=Math.max(this.headerHeight,this.gridPane.GetMinHeaderHeight());if(this.rightPane){this.headerHeight=Math.max(this.headerHeight,this.rightPane.GetMinHeaderHeight());this.rightPane.SetHeaderHeight(this.headerHeight)}this.gridPane.SetHeaderHeight(this.headerHeight);this.rowHeight=this._minRowHeight?this._minRowHeight:0;this.rowHeight=Math.max(this.rowHeight,this.gridPane.GetMinRowHeight());if(this.rightPane){this.rowHeight=Math.max(this.rowHeight,this.rightPane.GetMinRowHeight());this.rightPane.SetRowHeight(this.rowHeight)}this.gridPane.SetRowHeight(this.rowHeight);e===this.headerHeight&&t===this.rowHeight||null==this.vertScrollBar||this.vertScrollBar.Update({physicalViewportSize:this.GetControlHeight()-this.headerHeight-this.GetEffectiveHorizontalScrollBarHeight(),scrollbarSize:this.GetControlHeight(),itemSize:this.rowHeight})};e.prototype.OnVerticalScrollbarVisibilityChanged=function(e){this.vertScrollBarContainer.style.display=e?"":"none";this.LayoutChildElements()};e.prototype.OnHorizontalGridPaneScrollBarVisibilityChange=function(e){this.bHorizontalScrollBarVisible=e;this.vertScrollBar.Update({bOtherScrollMeets:e,physicalViewportSize:this.GetControlHeight()-this.headerHeight-this.GetEffectiveHorizontalScrollBarHeight()})};e.prototype.OnVerticalScroll=function(e,t){var n=e.topIdx-t;0===n||this.bResizingScrollbar||this.bRefreshingAllRows||this.bDeletingOrInsertingRows||(n<0?this.ScrollUp(e.topIdx,-n):this.ScrollDown(e.topIdx,n))};e.prototype.ScrollDown=function(e,t){var n=this.vertScrollBar.GetItemDisplayCapacity(),r=e+n==this.recordCount+1&&this.vertScrollBar.PartialRowPresent(),i=Math.min(t,n),s=i-(r?1:0),o=n-i;this.UpdatePanes(0,i,o,s,!1)};e.prototype.ScrollUp=function(e,t){var n=this.vertScrollBar.GetItemDisplayCapacity(),r=this.rowData.length!==n,i=Math.min(Math.min(t,this.recordCount),n),s=i-(r?1:0),o=n-i;this.UpdatePanes(o,s,0,i,!1)};e.prototype.ModifyRowsForNewViewport=function(e,t){var r=this.vertScrollBar.GetItemDisplayCapacity(),i=r-e,s=this.vertScrollBar.GetTopItemIdx();if(i<0){var o=Math.max(this.rowData.length-r,0),u=this.rowData.length-o;this.UpdatePanes(u,o,null,0,!1)}else if(i>0){var a=t-s;n.JsGridUtil.DebugAssert(a>=0);this.UpdatePanes(null,0,0,a,!1);n.JsGridUtil.DebugAssert(i>=a);var f=i-a,l=this.rowData.length,c=this.posConverter.RelViewIdxToViewIdx(l);f=Math.min(c+f,this.recordCount)-c;this.UpdatePanes(null,0,l,f,!1)}};e.prototype.UpdatePanes=function(e,t,r,i,s){n.JsGridUtil.DebugAssert(t>=0&&i>=0);var o=null!=e&&t>0,u=null!=r&&i>0;if(o||u){var a=u&&i>0?this.posConverter.GetViewRecords(this.posConverter.RelViewIdxToViewIdx(r),i,this.RenderMissingRows).records:[];o&&this.rowData.splice(e,t);if(u){n.JsGridUtil.DebugAssert(null==this.rowData||0==this.rowData.length||null==a[0]||null==this.rowData[0]||this.rowData[0].recordKey!=a[0].recordKey,"Inserting duplicate key in rowData!");Array.prototype.splice.apply(this.rowData,[r,0].concat(a))}this.RebuildKeyToPosMap();this.panes.each("SpliceRows",e,t,r,a,s);this.editMgr.NotifyMove()}};e.prototype.RetryErrorRows=function(){this.RenderMissingRows(this.vertScrollBar.GetTopItemIdx(),this.rowData.length,!0)};e.prototype.RenderMissingRows=function(e,t,i,o){var u=this;if(void 0!==n.JsGridUtil.Internal.FindKey(this.rowData,function(e){return null==e})){var a=this.vertScrollBar.GetTopItemIdx(),f={};if(i&&a!=o){var l=this.posConverter.GetViewRecords(a,this.rowData.length,function(e,t,n){u.RenderMissingRows(e,t,n,a)}).records;for(h=0;h<this.rowData.length;h++)null==this.rowData[h]&&(f[h]=this.rowData[h]=l[h]);this.rowData=[].concat(this.rowData);this.RebuildKeyToPosMap()}else for(var c=new s.Range(e,e+t-1),h=0;h<this.rowData.length;h++)null==this.rowData[h]&&c.Contains(a+h)&&(f[h]=r.JsGridConstants.Internal.LoadErrorState);this.panes.each("RenderRows",f)}};e.prototype.RebuildKeyToPosMap=function(){this.keyToViewIdxMap={};for(var e=this.posConverter.GetTopViewIdx(),t=0;t<this.rowData.length;t++)null!=this.rowData[t]&&(this.keyToViewIdxMap[this.rowData[t].key()]=t+e)};e.prototype.GetCellValue=function(e,t,r){return{data:e.HasDataValue(t)?e.GetDataValue(t):n.JsGridUtil.EmptyValue,localized:null!=r&&null!=r.GetDisplayValue?r.GetDisplayValue(e,e.HasDataValue(t)?e.GetDataValue(t):null,e.HasLocalizedValue(t)?e.GetLocalizedValue(t):null):e.HasLocalizedValue(t)?e.GetLocalizedValue(t):n.JsGridUtil.EmptyValue}};e.prototype.IsGridVisible=function(){return this._parentNode.offsetHeight>0&&this._parentNode.offsetWidth>0};return e})();t.PaneManager=x;var T=(function(){function e(e,t){this._pangeMgr=t}e.prototype.SetValues=function(e,t){this.width=e;this.leftOffset=t};e.prototype.GetHeight=function(){return this._pangeMgr.GetControlHeight()};e.prototype.GetWidth=function(){return this.width};e.prototype.GetLeftOffset=function(){return this.leftOffset};e.prototype.Dispose=function(){};return e})();function N(e){for(var t=Array.prototype.slice.call(arguments,1),n=0;n<this.length;++n){var r=this[n][e];r&&r.apply(this[n],t)}}});
define("aQU",["require","exports","aPS","aQo","aQn","bt","X"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SelectionType=n.JsGridConstants.SelectionType;t.SelectOp={Set:0,Append:1,ReplaceLast:2};t.RowSelectOp={Select:3,Unselect:4};var u=s.Killswitch.isActivated("86CDDB78-0503-4987-9214-48BC92A7E039","8/1/2019","Allow more commands in command bar in quick edit"),a={ODB:1725},f={ODB:1439},l=(function(){function e(e){this._fnOnFocusedCellChanged=e;this.Clear(!0)}e.prototype.SetAllowedSelectionTypes=function(e){this._allowedSelectionTypes=e};e.prototype.GetLastSelectionEndpoints=function(){return{rowIdx1:this._lastSelEndpt1.rowIdx,colIdx1:this._lastSelEndpt1.colIdx,rowIdx2:this._lastSelEndpt2.rowIdx,colIdx2:this._lastSelEndpt2.colIdx}};e.prototype.GetLastSelectionRangeNormalized=function(){return this._lastSelectionType==t.SelectionType.None?null:{rowRange:new i.Range(this._lastSelectionType!==t.SelectionType.ColumnRange?Math.min(this._lastSelEndpt1.rowIdx,this._lastSelEndpt2.rowIdx):0,this._lastSelectionType!==t.SelectionType.ColumnRange?Math.max(this._lastSelEndpt1.rowIdx,this._lastSelEndpt2.rowIdx):this._curFocus.gridPane.GetGridPaneConverter().GetVirtualRowCount()-1),colRange:new i.Range(this._lastSelectionType!==t.SelectionType.RowRange?Math.min(this._lastSelEndpt1.colIdx,this._lastSelEndpt2.colIdx):0,this._lastSelectionType!==t.SelectionType.RowRange?Math.max(this._lastSelEndpt1.colIdx,this._lastSelEndpt2.colIdx):this._curFocus.gridPane.GetGridPaneConverter().GetVirtualColumnCount()-1)}};e.prototype.GetFocus=function(){return this.GetFocusForPaneInternal(null)};e.prototype.GetFocusForPane=function(e){return this.GetFocusForPaneInternal(e)};e.prototype.GetFocusedPane=function(){return this._curFocus.gridPane};e.prototype.SetFocusByKey=function(e,t,n){var r=e.GetGridPaneConverter().KeyToIdx(t,n);null!=r&&this.SetFocusByPos(e,r.rowIdx,r.colIdx)};e.prototype.SetFocusByPos=function(e,n,r){this.SelectRange(e,n,n,r,r,t.SelectOp.Set,!0,!1)};e.prototype.IsCellSelected=function(e,t,n){if(e!==this._curFocus.gridPane)return!1;for(var r=0;r<this._selectedRowRanges.length;r++)if(this._selectedRowRanges[r].Contains(t))return!0;for(r=0;r<this._selectedColRanges.length;r++)if(this._selectedColRanges[r].Contains(n))return!0;for(r=0;r<this._selectedCellRanges.length;r++)if(this._selectedCellRanges[r].rowRange.Contains(t)&&this._selectedCellRanges[r].colRange.Contains(n))return!0;return!1};e.prototype.IsRowSelected=function(e,t){if(e!==this._curFocus.gridPane)return!1;for(var n=0;n<this._selectedRowRanges.length;n++)if(this._selectedRowRanges[n].Contains(t))return!0;return!1};e.prototype.isRowContainsSelectedCell=function(e,t){if(e!==this._curFocus.gridPane)return!1;if(this.IsRowSelected(e,t))return!0;for(var n=0;n<this._selectedCellRanges.length;n++)if(this._selectedCellRanges[n].rowRange.Contains(t))return!0};e.prototype.IsOneCellSelected=function(e){return null!=e&&e.rowRange.begin==e.rowRange.end&&e.colRange.begin==e.colRange.end};e.prototype.GetComponentsWithin=function(e,t,n){if(e!==this._curFocus.gridPane)return new i.Set;for(var s={},o=function(e,t){if(!e.IsEmpty()&&!t.IsEmpty())for(var n=e.begin;n<=e.end;n++)for(var i=t.begin;i<=t.end;i++)s[r.JsGridUtil.Internal.MakeCellKey(n,i)]=1},u=0;u<this._selectedRowRanges.length;u++)o(this._selectedRowRanges[u].Intersect(t),n);for(u=0;u<this._selectedColRanges.length;u++)o(t,this._selectedColRanges[u].Intersect(n));for(u=0;u<this._selectedCellRanges.length;u++)o(this._selectedCellRanges[u].rowRange.Intersect(t),this._selectedCellRanges[u].colRange.Intersect(n));return new i.Set(s)};e.prototype.SelectRange=function(e,s,l,c,h,p,d,v){var m,g=this,y=!0;e.GetDelegateMgr().Apply(n.JsGridConstants.DelegateType.AllowSelectionChange,function(e){y=e});if(!y)return!1;null!=s&&s==l&&null!=c&&c==h&&d&&p==t.SelectOp.Set&&(m={rowIdx:s,colIdx:c});if(!(function(){var e=g._allowedSelectionTypes&n.JsGridConstants.SelectionTypeFlags._RowMask,r=g._allowedSelectionTypes&n.JsGridConstants.SelectionTypeFlags._ColMask,i=g._allowedSelectionTypes&n.JsGridConstants.SelectionTypeFlags._CellMask;do{var o=!1;switch(g.ComputeSelectionType(s,l,c,h)){case t.SelectionType.RowRange:switch(e){case n.JsGridConstants.SelectionTypeFlags.SingleRow:l=s;case n.JsGridConstants.SelectionTypeFlags.SingleRowRange:p=p==t.SelectOp.Append?t.SelectOp.Set:p;break;case n.JsGridConstants.SelectionTypeFlags.NoRows:return!1}break;case t.SelectionType.ColumnRange:switch(r){case n.JsGridConstants.SelectionTypeFlags.SingleCol:h=c;case n.JsGridConstants.SelectionTypeFlags.SingleColRange:p=p==t.SelectOp.Append?t.SelectOp.Set:p;break;case n.JsGridConstants.SelectionTypeFlags.NoCols:return!1}break;case t.SelectionType.CellRange:switch(i){case n.JsGridConstants.SelectionTypeFlags.SingleCell:l=s;h=c;case n.JsGridConstants.SelectionTypeFlags.SingleCellRange:p=p==t.SelectOp.Append?t.SelectOp.Set:p;break;case n.JsGridConstants.SelectionTypeFlags.NoCells:if(e!==n.JsGridConstants.SelectionTypeFlags.NoRows){c=h=null;o=!0}else{if(r===n.JsGridConstants.SelectionTypeFlags.NoCols)return!1;s=l=null;o=!0}}}}while(o);return!0})())return!1;g.ComputeSelectionType(s,l,c,h)==t.SelectionType.CellRange&&(Math.abs(c-h)+1==e.GetGridPaneConverter().GetVirtualColumnCount()?c=h=null:Math.abs(s-l)+1==e.GetGridPaneConverter().GetVirtualRowCount()&&(s=l=null));this._lastSelEndpt1={rowIdx:s,colIdx:c};this._lastSelEndpt2={rowIdx:l,colIdx:h};this.FirePreChangeNotifications(this._curFocus.gridPane,e);var b=this.GetFocus(),w=this.ComputeSelectionType(s,l,c,h);(function(n,i){if(e!==g._curFocus.gridPane){p=t.SelectOp.Set;g._curFocus.gridPane=e}if(v){var o=e.GetGridPaneConverter().KeyToIdx(n.recordKey,n.fieldKey);g._curFocus.rowIdx=o.rowIdx;g._curFocus.colIdx=o.colIdx}else if(null!=m){g._curFocus.rowIdx=m.rowIdx;g._curFocus.colIdx=m.colIdx}else{g._curFocus.rowIdx=i==t.SelectionType.ColumnRange?e.BeginRowIdx():s;g._curFocus.colIdx=i==t.SelectionType.RowRange?e.BeginColIdx():c}if(r.JsGridUtil.Internal.IsFeatureEnabled(a)&&r.JsGridUtil.Internal.IsFeatureEnabled(f))if(p===t.SelectOp.Set&&i===t.SelectionType.RowRange){g._rowSelectionFocusOrder=[];if(s<=l)for(var u=l;u>=s;u--)g._rowSelectionFocusOrder.push(u);else for(u=l;u<=s;u++)g._rowSelectionFocusOrder.push(u)}else if(p===t.RowSelectOp.Select)g._rowSelectionFocusOrder.push(s);else if(p===t.RowSelectOp.Unselect)if(n.rowIdx!==s){g._curFocus.rowIdx=n.rowIdx;g._rowSelectionFocusOrder.splice(g._rowSelectionFocusOrder.indexOf(s),1)}else{g._rowSelectionFocusOrder.pop();g._curFocus.rowIdx=g._rowSelectionFocusOrder[g._rowSelectionFocusOrder.length-1]}else g._rowSelectionFocusOrder=[]})(b,w);(function(n){r.JsGridUtil.DebugAssert(n!==t.SelectionType.None);var d,v=n==t.SelectionType.ColumnRange?null:new i.Range(s,l).Normalize(),m=n==t.SelectionType.RowRange?null:new i.Range(c,h).Normalize();if(p==t.SelectOp.Set){g._selectedRowRanges=[];g._selectedColRanges=[];g._selectedCellRanges=[];g._orderedSelections=[]}else if(p==t.SelectOp.ReplaceLast){g._lastSelectionType==t.SelectionType.RowRange?g._selectedRowRanges.pop():g._lastSelectionType==t.SelectionType.ColumnRange?g._selectedColRanges.pop():g._lastSelectionType==t.SelectionType.CellRange&&g._selectedCellRanges.pop();g._orderedSelections.pop()}if(n==t.SelectionType.RowRange){d=v;if(r.JsGridUtil.Internal.IsFeatureEnabled(a)&&r.JsGridUtil.Internal.IsFeatureEnabled(f))if(p===t.RowSelectOp.Select){g._selectedCellRanges=[];g._selectedRowRanges.push(d)}else if(p===t.RowSelectOp.Unselect){var y=v.begin;if(1===g._selectedRowRanges.length){var b=g._selectedRowRanges[0];if(y===b.begin){var w=new i.Range(b.begin+1,b.end);g._selectedRowRanges=[w];g._lastSelEndpt1.rowIdx=w.begin;g._lastSelEndpt2.rowIdx=w.end}else if(y===b.end){w=new i.Range(b.begin,b.end-1);g._selectedRowRanges=[w];g._lastSelEndpt1.rowIdx=w.begin;g._lastSelEndpt2.rowIdx=w.end}else g._selectedRowRanges=[new i.Range(b.begin,y-1),new i.Range(y+1,b.end)]}else{for(var E=void 0,S=0;S<g._selectedRowRanges.length;S++)if(g._selectedRowRanges[S].Contains(y)){E=S;break}var x=g._selectedRowRanges[E];g._selectedRowRanges.splice(E,1);if(x.Size()>1){w=void 0;x.begin===y?w=new i.Range(x.begin+1,x.end):x.end===y&&(w=new i.Range(x.begin,x.end-1));w?g._selectedRowRanges.push(w):g._selectedRowRanges.push(new i.Range(x.begin,y-1),new i.Range(y+1,x.end))}if(1===g._selectedRowRanges.length){g._lastSelEndpt1.rowIdx=g._selectedRowRanges[0].begin;g._lastSelEndpt2.rowIdx=g._selectedRowRanges[0].end}}}else g._selectedRowRanges.push(d);else g._selectedRowRanges.push(d)}else if(n==t.SelectionType.ColumnRange){d=m;g._selectedColRanges.push(d)}else if(n==t.SelectionType.CellRange){d={rowRange:v,colRange:m};g._selectedCellRanges.push(d)}g._orderedSelections.push({type:n,range:d});g._lastSelectionType=n;if(!u&&e._objBag&&e._objBag.onSelectionChanged&&e.tableMgr){var T=e._objBag.jsGridParams.telemetry,N=void 0;T&&(N=new(T(o.Qos))({name:"QuickEditUpdateSelectionForCommandBar"}));try{var C=[],k=e.GetGridPaneConverter();for(S=0;S<g._selectedRowRanges.length;S++)for(var L=g._selectedRowRanges[S],A=L.begin;A<=L.end;A++){var O=k.RowIdxToRecordKey(A),M=e.tableMgr.GetRecordByKey(O);M&&M.fieldRawDataMap&&M.fieldRawDataMap.csrInfo&&C.push(M.fieldRawDataMap.csrInfo.ID)}e._objBag.onSelectionChanged(C);N&&N.end({resultType:o.ResultTypeEnum.Success})}catch(e){N&&N.end({resultType:o.ResultTypeEnum.Failure,resultCode:"FailToUpdateSelection",error:e.message})}}})(w);this.FirePostChangeNotifications(b,d);return!0};e.prototype.GetRowRanges=function(e){return e==this._curFocus.gridPane?this._selectedRowRanges:[]};e.prototype.GetColumnRanges=function(e){return e==this._curFocus.gridPane?this._selectedColRanges:[]};e.prototype.GetCellRanges=function(e){return e==this._curFocus.gridPane?this._selectedCellRanges:[]};e.prototype.Clear=function(e){var n;if(!e){this.FirePreChangeNotifications(this._curFocus.gridPane,null);n=this.GetFocus()}this._selectedRowRanges=[];this._selectedColRanges=[];this._selectedCellRanges=[];this._orderedSelections=[];this._curFocus={};this._rowSelectionFocusOrder=[];this._lastSelEndpt1=this._lastSelEndpt2=null;this._lastSelectionType=t.SelectionType.None;e||this.FirePostChangeNotifications(n,!1)};e.prototype.GetLastSelectionType=function(){return this._lastSelectionType};e.prototype.GetOrderedSelections=function(e,n){var r=function(e){for(var t=new Array(e.Size()),n=e.begin;n<=e.end;n++)t[n-e.begin]=o.RowIdxToRecordKey(n);return{begin:e.begin,end:e.end,keys:t}},i=function(e){for(var t=new Array(e.Size()),n=e.begin;n<=e.end;n++)t[n-e.begin]=o.ColIdxToColKey(n);return{begin:e.begin,end:e.end,keys:t}},s=[];if(e==this._curFocus.gridPane)for(var o=e.GetGridPaneConverter(),u=0;u<this._orderedSelections.length;u++){var a=this._orderedSelections[u].type,f=this._orderedSelections[u].range;if(null==n||n==a)switch(a){case t.SelectionType.RowRange:s.push(r(f));break;case t.SelectionType.ColumnRange:s.push(i(f));break;case t.SelectionType.CellRange:var l=f;s.push({rowRange:r(l.rowRange),colRange:i(l.colRange)})}}return s};e.prototype.FirePreChangeNotifications=function(e,t){this._updatingReturnOld=null!=e?e.NotifySelectionUpdating():null;this._updatingReturnNew=null!=t?t!==e?t.NotifySelectionUpdating():this._updatingReturnOld:null};e.prototype.FirePostChangeNotifications=function(e,t){var n=this.GetFocus();null!=e&&e.gridPane.NotifySelectionUpdated(this._updatingReturnOld,t);null==n||null!=e&&n.gridPane===e.gridPane||n.gridPane.NotifySelectionUpdated(this._updatingReturnNew,t);(null==e&&null!=n||null!=e&&null==n||null!=e&&null!=n&&(e.recordKey!=n.recordKey||e.fieldKey!=n.fieldKey))&&this._fnOnFocusedCellChanged(r.JsGridUtil.EventArgs.CellFocusChanged(n&&n.recordKey,n&&n.fieldKey,e&&e.recordKey,e&&e.fieldKey))};e.prototype.ComputeSelectionType=function(e,n,r,i){return null==e||null==n?t.SelectionType.ColumnRange:null==r||null==i?t.SelectionType.RowRange:t.SelectionType.CellRange};e.prototype.GetFocusForPaneInternal=function(e){if(null==this._curFocus.gridPane||null!=e&&this._curFocus.gridPane!==e||this._curFocus.colIdx>=this._curFocus.gridPane.GetGridPaneConverter().GetVirtualColumnCount())return null;var t=this._curFocus.gridPane.GetGridPaneConverter().IdxToKey(this._curFocus.rowIdx,this._curFocus.colIdx);return null==t.recordKey||null==t.fieldKey||null==t.columnKey?null:{rowIdx:this._curFocus.rowIdx,colIdx:this._curFocus.colIdx,recordKey:t.recordKey,fieldKey:t.fieldKey,columnKey:t.columnKey,gridPane:this._curFocus.gridPane}};return e})();t.SelectionManager=l});
define("aQT",["require","exports","aQo","aPS"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,n,r,i,o,u,a){this._thickness=f();this._arrowBoxSize=this._thickness-1;this._itemSizes=[];this._disabled=!1;this._partialRowPresent=!1;this._middleBoxLength=0;this._middleBoxLocation=0;this._topItemIdx=0;this._primitiveMgr=new s(e==t.ScrollBarType.Vertical,this);this._bOtherScrollMeets=r;this._type=e;this._optUpdateParams=i;this._bRTL=u;this.Init()}e.prototype.Init=function(){null!=this._optUpdateParams&&this.Update(this._optUpdateParams)};e.prototype.ComputeValidTopItemIdx=function(e){return Math.max(0,Math.min(e,null!=this._scrollableRows?this._scrollableRows:0))};e.prototype.ComputeValidTopItemIdxFromBottomIdx=function(e){var t=Math.max(Math.min(e,this._itemCount-1),0);return t-this.ComputeNumberOfRowsOnPage(null,t).count};e.prototype.ScrollToIdx=function(e,t,n,r){var i=this._topItemIdx;if(this._topItemIdx!==e||n){this._topItemIdx=e;this.ComputeScrollPosition(this._topItemIdx);null==this._fnOnScroll||i===this._topItemIdx&&!n||r||this._fnOnScroll(t,i);return!0}return!1};e.prototype.ScrollToBottomIdx=function(e,t,n){var r=this.ComputeValidTopItemIdxFromBottomIdx(e);return this.ScrollToIdx(r,new o(r,e,u.Bottom),t,n)};e.prototype.ScrollToTopIdx=function(e,t,n){var r=this.ComputeValidTopItemIdx(e);return this.ScrollToIdx(r,new o(r,this.ComputeNumberOfRowsOnPage(r,null),u.Top),t,n)};e.prototype.ComputeRemainingSpace=function(){return Math.max(0,this.GetTotalScrollableDistance()-this._middleBoxLocation-this._middleBoxLength)};e.prototype.GetTotalScrollableDistance=function(){return this._length-2*this._arrowBoxSize-4};e.prototype.ComputeNumberOfRowsOnPage=function(e,t){for(var r,i=null!=e?e:t,s=null==e,o=0,u=0!==this._itemSizes.length?n.JsGridUtil.Internal.UpperBound(this._itemSizes,i,"pos")-1:-1;o<this._physicalViewportSize&&i>=0&&i<this._itemCount;){null==r&&-1!==u&&u<this._itemSizes.length&&(r=this._itemSizes[u]);o+=null!=r&&i==r.pos?r.size:this._itemSize;if(null!=r&&i==r.pos){u+=s?-1:1;r=null}i+=s?-1:1}var a=o!==this._physicalViewportSize;return{count:Math.max(Math.abs((null!=e?e:t)-i)-(a?1:0),0),partial:a}};e.prototype.GetPartialItemDisplayCapacity=function(){return this._itemCount};e.prototype.GetWholeItemDisplayCapacityInternal=function(){return this._itemCount};e.prototype.ComputeBottomIdx=function(){return this.ComputeNumberOfRowsOnPage(this._topItemIdx,null).count};e.prototype.TopIndexToPixelOffset=function(e){this._bRTL&&this._type==t.ScrollBarType.Horizontal&&(e=this._scrollableRows-e);return Math.floor(this._scrollablePixels/this._scrollableRows*e)};e.prototype.PixelOffsetToTopIndex=function(e){this._bRTL&&this._type==t.ScrollBarType.Horizontal&&(e=this._scrollablePixels-e);return this._scrollablePixels>0?this.ComputeValidTopItemIdx(Math.round(e/(this._scrollablePixels/this._scrollableRows))):0};e.prototype.ComputeScrollPosition=function(e){this._middleBoxLocation=this._scrollableRows>0?this.TopIndexToPixelOffset(e):0;this._primitiveMgr.UpdateBGDiv("bgAboveBox",this._middleBoxLocation+1);this._primitiveMgr.SetTop("middleBoxDiv",this._middleBoxLocation+this._arrowBoxSize);this._primitiveMgr.UpdateBGDiv("bgBelowBox",this.ComputeRemainingSpace()+1)};e.prototype.Dispose=function(){this._renderedBar&&n.JsGridUtil.ClearEventListeners(this._renderedBar);this._eventToDispose&&document.body.removeEventListener("mousemove",this._eventToDispose);this._primitiveMgr.Dispose();this._renderedBar=null};e.prototype.SetOnVisibilityChanged=function(e,t){this._fnOnVisibilityChanged=e;null!=this._fnOnVisibilityChanged&&t!==!this._disabled&&this._fnOnVisibilityChanged(!this._disabled)};e.prototype.Update=function(e){this._itemCount=null==e.itemCount?this._itemCount:e.itemCount;this._itemSize=null==e.itemSize?this._itemSize:e.itemSize;this._bOtherScrollMeets=null==e.bOtherScrollMeets?this._bOtherScrollMeets:e.bOtherScrollMeets;return!1};e.prototype.GetItemDisplayCapacity=function(){return this.GetPartialItemDisplayCapacity()};e.prototype.GetWholeItemDisplayCapacity=function(){return this.GetWholeItemDisplayCapacityInternal()};e.prototype.GetTopItemIdx=function(){return this._topItemIdx};e.prototype.Refresh=function(){this.ComputeScrollPosition(this._topItemIdx)};e.prototype.ScrollIntoView=function(e){e=Math.max(0,Math.min(this._itemCount-1,e));var n=this.GetItemDisplayInfo(e);if(n==t.ScrollBarRowDisplayInfo.Before){this.ScrollToTopIdx(e);return!0}if(n==t.ScrollBarRowDisplayInfo.After||n==t.ScrollBarRowDisplayInfo.Partial){this.ScrollToTopIdx(e+1-this.GetWholeItemDisplayCapacity());return!0}return!1};e.prototype.ScrollUpByOne=function(){this.Update({topItemIdx:this._topItemIdx-1})};e.prototype.ScrollDownByOne=function(){this.Update({topItemIdx:this._topItemIdx+1})};e.prototype.PartialRowPresent=function(){return this._partialRowPresent};e.prototype.GetVisibleItemCount=function(){};e.prototype.SetOnScroll=function(e){this._fnOnScroll=e};e.prototype.SetViewportSize=function(){};e.prototype.GetItemDisplayInfo=function(e){var n=this.GetWholeItemDisplayCapacity(),r=this.GetPartialItemDisplayCapacity();return n!==r?e<this._topItemIdx?t.ScrollBarRowDisplayInfo.Before:e>this._topItemIdx+r-1?t.ScrollBarRowDisplayInfo.After:e==this._topItemIdx+r-1?t.ScrollBarRowDisplayInfo.Partial:t.ScrollBarRowDisplayInfo.InView:e<this._topItemIdx?t.ScrollBarRowDisplayInfo.Before:e>this._topItemIdx+r-1?t.ScrollBarRowDisplayInfo.After:t.ScrollBarRowDisplayInfo.InView};return e})();t.ScrollBar=i;var s=(function(){function e(e,t){this._activeColors={outerBorder:{mouseDown:"#737A83",mouseOver:"#8A8D91",mouseOut:"#B7BABE"},innerBorder:{mouseDown:"#C3C6CA",mouseOver:"#DADBDD",mouseOut:"#F0F1F4"},shade:{mouseDown:"#969BA2",mouseOver:"#CACCD0",mouseOut:"#E8EBEE"},main:{mouseDown:"#868C93",mouseOver:"#B3B6BB",mouseOut:"#DFE3E8"}};this._renderedItemDivs={};this._bIsVert=e;this._scrollBar=t;this._thicknessCssString=e?"width":"height";this._lengthCssString=e?"height":"width";this._cssNamePreFix=e?"vert-":"horiz-";this._upSideCssName=e?"top":"left";this._leftSideCssName=e?"left":"top";this._arrowDivClass=e?"clip9x6":"clip6x9";this._upArrowInactiveImgClass="jsgridcluster_scrollbar-mouseout-"+(e?"uparrow":"leftarrow");this._downArrowInactiveImgClass="jsgridcluster_scrollbar-mouseout-"+(e?"downarrow":"rightarrow");this._upArrowActiveImgClass="jsgridcluster_scrollbar-mousein-"+(e?"uparrow":"leftarrow");this._downArrowActiveImgClass="jsgridcluster_scrollbar-mousein-"+(e?"downarrow":"rightarrow")}e.prototype.Dispose=function(){this._renderedItemDivs=null};e.prototype.GetThicknessCssString=function(e){return this._thicknessCssString+":"+e+"px;"};e.prototype.GetLengthCssString=function(e){return this._lengthCssString+":"+e+"px;"};e.prototype.GetLengthAndThicknessCssString=function(e,t){return this.GetLengthCssString(e)+this.GetThicknessCssString(t)};e.prototype.GetCssName=function(e,t){return this._cssNamePreFix+e+(t?" "+e:"")};e.prototype.RegisterPrimitives=function(e){for(var t=0;t<e.length;t++){var r=n.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(e[t],"elemid");null!=r&&(this._renderedItemDivs[r]=e[t])}};e.prototype.GetLocation=function(e){return n.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._renderedItemDivs[e])};e.prototype.GetHeight=function(e){return this._renderedItemDivs[e].offsetHeight};e.prototype.GetWidth=function(e){return this._renderedItemDivs[e].offsetWidth};e.prototype.GetDomElem=function(e){return this._renderedItemDivs[e]};e.prototype.AppendItem=function(e,t){this._renderedItemDivs[e].appendChild(t);this.RegisterPrimitives(n.JsGridUtil.Internal.DomElement.GetInstance().FindChildrenWithProperty(this._renderedItemDivs[e],"id"))};e.prototype.GenerateBGDivHTML=function(e,t,n){var r=(this._scrollBar._thickness-4)/2;return['<div class="'+this.GetCssName("scroll-bar-bg-block",null)+'" style="'+(n?"position:relative;":"")+this.GetLengthCssString(e)+'" '+this.GetOptionalElemString("elemid",t,null)+">",'<div class="'+this.GetCssName("scroll-bar-background-shade",!0)+'" style="'+this.GetLengthAndThicknessCssString(e,Math.ceil(r))+'" '+this.GetOptionalElemString("elemid",t,"_shade")+"></div>",'<div class="'+this.GetCssName("scroll-bar-background-main",!0)+'" style="'+this.GetLengthAndThicknessCssString(e,Math.floor(r))+'" '+this.GetOptionalElemString("elemid",t,"_main")+"></div></div>"].join("")};e.prototype.GetOptionalElemString=function(e,t,n){return null==t?"":e+'="'+t+(null==n?"":n)+'"'};e.prototype.GenerateMiddleScroll=function(e){var t=document.createElement("div"),n=(this._scrollBar._thickness-6)/2,r=(this._scrollBar._thickness-6-5)/2;t.innerHTML=['<div style="position:relative;',this.GetThicknessCssString(this._scrollBar._thickness-6),';margin-top:1px;margin-left:1px;">','<div elemid="',e,'_shade" class="',this.GetCssName("scroll-bar-inner-box-shade",!0),'" style="',this.GetThicknessCssString(Math.floor(n)),';"></div>','<div elemid="',e,'_main" class="',this.GetCssName("scroll-bar-inner-box-main",!0),'" style="',this.GetThicknessCssString(Math.ceil(n)),';"></div>','<div elemid="',e,'_gripTop" class="',this.GetCssName("scroll-bar-grip",!0),'" style="',this._leftSideCssName,":",Math.round(r),'px"></div>','<div elemid="',e,'_gripMiddle" class="',this.GetCssName("scroll-bar-grip",!0),'" style="',this._leftSideCssName,":",Math.round(r),'px;"></div>','<div elemid="',e,'_gripBottom" class="',this.GetCssName("scroll-bar-grip",!0),'" style="',this._leftSideCssName,":",Math.round(r),'px"></div></div>'].join("");t.elemid=e;t.className=this.GetCssName("scroll-bar-outer-box",!0);t.style.cssText=this.GetThicknessCssString(this._scrollBar._thickness-4);return t};e.prototype.GenerateArrowDiv=function(e,t,i){var s=document.createElement("div"),o=(this._scrollBar._thickness-4-(this._bIsVert?6:9))/2,u=(this._scrollBar._thickness-4-(this._bIsVert?9:6))/2,a=this._bIsVert?i?SP.JsGrid.Res.upScrollbarLabel:SP.JsGrid.Res.downScrollbarLabel:i?SP.JsGrid.Res.leftScrollbarLabel:SP.JsGrid.Res.rightScrollbarLabel;s.innerHTML=['<div elemid="'+e+'_inner" class="scroll-bar-inner-arrow-cell" style="'+this.GetLengthAndThicknessCssString(this._scrollBar._thickness-4,this._scrollBar._thickness-4)+'">','<div class="'+this._arrowDivClass+'" style="margin-top:'+(this._bIsVert?i?Math.floor(o):Math.ceil(o):Math.round(o))+"px;margin-left:"+(this._bIsVert?Math.round(u):i?Math.floor(u):Math.ceil(u))+'px;"><img elemid="'+e+'_img" src="'+n.JsGridUtil.Internal.SiteUrl+r.JsGridConstants.ImagesDirectory+'jsgridcluster.png" class="'+this.GetCssName("scroll-bar-arrow",null)+" "+(i?this._upArrowInactiveImgClass:this._downArrowInactiveImgClass)+'" role="button" aria-label="'+a+'" />',"</div>","</div>"].join("");s.elemid=e;s.className=this.GetCssName("scroll-bar-arrow-cell",!0);s.style.cssText=(this._bIsVert?"top:":"left:")+t+"px;"+this.GetLengthAndThicknessCssString(this._scrollBar._thickness-2,this._scrollBar._thickness-2);return s};e.prototype.UpdateBGDiv=function(e,t){this._renderedItemDivs[e].style[this._lengthCssString]=t+"px";this._renderedItemDivs[e+"_shade"].style[this._lengthCssString]=t+"px";this._renderedItemDivs[e+"_main"].style[this._lengthCssString]=t+"px"};e.prototype.UpdateMiddleScroll=function(e,t){this._renderedItemDivs[e].style[this._lengthCssString]=t-2+"px";var n=t-4;this._renderedItemDivs[e+"_main"].style[this._lengthCssString]=n+"px";this._renderedItemDivs[e+"_shade"].style[this._lengthCssString]=n+"px";var r=Math.round(Math.max(n-8,0)/2);this._renderedItemDivs[e+"_gripTop"].style[this._upSideCssName]=r+"px";this._renderedItemDivs[e+"_gripMiddle"].style[this._upSideCssName]=r+3+"px";this._renderedItemDivs[e+"_gripBottom"].style[this._upSideCssName]=r+6+"px"};e.prototype.UpdateDisplay=function(e,t){this._renderedItemDivs[e].style.display=t?"block":"none"};e.prototype.ActivateArrowDiv=function(e,t,n,r){this._renderedItemDivs[e+"_img"].className=this.GetCssName("scroll-bar-arrow",null)+" "+(n?this._upArrowActiveImgClass:this._downArrowActiveImgClass);this.ActivateDiv(e,r,t)};e.prototype.DeactivateArrowDiv=function(e,t,n){this._renderedItemDivs[e+"_img"].className=this.GetCssName("scroll-bar-arrow",null)+" "+(n?this._upArrowInactiveImgClass:this._downArrowInactiveImgClass);this.DeactivateDiv(e,t)};e.prototype.MarkMouseDown=function(e,t){this._renderedItemDivs[e].curStateName="mouseDownPending"};e.prototype.RemoveMouseDown=function(e,t,n){this._renderedItemDivs[e].curStateName=""};e.prototype.ActivateDiv=function(e,t,r){var i=this._renderedItemDivs[e];if("mouseDown"!=i.curStateName){var s="mouseDownPending"==i.curStateName?"mouseDown":n.JsGridUtil.Internal.DomElement.GetInstance().PointInDomElem(t.x,t.y,i,null)?"mouseOver":"mouseOut";if(i.curStateName!==s){i.style.borderColor=this._activeColors.outerBorder[s];e+"_inner"in this._renderedItemDivs?this._renderedItemDivs[e+"_inner"].style.borderColor=this._activeColors.innerBorder[s]:this._renderedItemDivs[e].style.backgroundColor=this._activeColors.innerBorder[s];this._renderedItemDivs[(null!=r?r:e)+"_shade"].style.backgroundColor=this._activeColors.shade[s];this._renderedItemDivs[(null!=r?r:e)+"_main"].style.backgroundColor=this._activeColors.main[s];i.curStateName=s}}};e.prototype.DeactivateDiv=function(e,t){this._renderedItemDivs[e].curStateName="";this._renderedItemDivs[e].style.borderColor="";e+"_inner"in this._renderedItemDivs?this._renderedItemDivs[e+"_inner"].style.borderColor="":this._renderedItemDivs[e].style.backgroundColor="";this._renderedItemDivs[(null!=t?t:e)+"_shade"].style.backgroundColor="";this._renderedItemDivs[(null!=t?t:e)+"_main"].style.backgroundColor=""};e.prototype.HighlightBGDiv=function(e){this._renderedItemDivs[e+"_main"].style.backgroundColor="#DEDFE2";this._renderedItemDivs[e+"_shade"].style.backgroundColor="#DEDFE2"};e.prototype.RestoreBGDiv=function(e){this._renderedItemDivs[e+"_shade"].style.backgroundColor="";this._renderedItemDivs[e+"_main"].style.backgroundColor=""};e.prototype.SetTop=function(e,t){this._renderedItemDivs[e].style[this._upSideCssName]=t+"px"};e.prototype.SetLength=function(e,t){this._renderedItemDivs[e].style[this._lengthCssString]=t+"px"};return e})(),o=function(e,t,n){this.topIdx=e;this.bottomIdx=t;this.userSetType=n},u={Bottom:0,Top:1},a=function(){this.itemSizes={};this.bClearItemSizes=!1;this.bMergeItemSizes=!1;this.bUpdateWhileDragging=!1};t.UpdateParams=a;t.ScrollBarType={Horizontal:0,Vertical:1};t.ScrollBarRowDisplayInfo={Before:-1,InView:0,Partial:1,After:2};function f(){var e=document.createElement("div"),t=document.createElement("div");e.style.cssText="overflow-x:scroll;position:absolute;visibility:hidden";t.style.cssText="height:50px;width:50px";e.appendChild(t);document.body.appendChild(e);var n=Math.max(e.offsetHeight-50,13);document.body.removeChild(e);f=function(){return n};return n}t.GetSystemScrollBarThickness=f;t.GetMinScrollBarLength=function(){return 2*f()+12+8+2}});
define("aQS",["require","exports","aQn"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){this.Clear()}e.prototype.AddCell=function(e,t){var n=this.Hash(e,t);this._cells.Add(n)};e.prototype.Clear=function(){this._cells=new n.Set};e.prototype.IsCellIn=function(e,t){return this._cells.Contains(this.Hash(e,t))};e.prototype.Hash=function(e,t){return[e,t].join()};return e})();t.ChangeHighlightManager=r});
define("aQQ",["require","exports","mU","aQo","aPS","aQR","aQp","bt","a2","ay","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c=l.panemgr_9;l=l.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var h=1,p=2,d=3,v={ODB:1725},m=u.Killswitch.isActivated("7735945e-c4b7-4456-bc23-590e84ff2ae8","4/09/2020","fix escape to actually close editors"),g=u.Killswitch.isActivated("8a1e846d-3209-4f04-b6f5-2b40e35f5724","4/09/2020","fix escape to close hyperlink editor"),y=u.Killswitch.isActivated("7e38e73e-5d98-4a58-859f-384c19175e94","4/09/2020","fix escape to close multiperson editor"),b=(function(){function e(e,t,n){this._curState=h;this._widgetIcons={};this._stateTransitionManager=new E(this);this._objBag=e;this._fnUpdateProperties=t;this._fnGetCellValue=n;this._telemetry=e&&e.jsGridParams&&e.jsGridParams.telemetry;this._baseEngagementData=e&&e.jsGridParams&&e.jsGridParams.baseEngagementData;this.errorMgr=e.errorMgr;this.actorsParentNode=e.parentNode;this._widgetDock=this.CreateWidgetDock();this._actorRegistrationManager=new s.EditActorsRegistrationManager(e,this.actorsParentNode,this.GetEditControlManagerAPI.bind(this),this.GetWidgetControlManagerAPI.bind(this),this.OnRegisterWidgetControl.bind(this));e.eventMgr.AttachEvent(i.JsGridConstants.EventType.OnCellErrorStateChanged,this.RecalculateWidgets.bind(this))}e.prototype.unBindEditors=function(){if(null!==this._curActorsAPI&&void 0!==this._curActorsAPI)for(var e=0;e<this._curActorsAPI.length;e++)this._curActorsAPI[e].actor.Unbind()};e.prototype.logEngagement=function(e){this._telemetry&&this._telemetry(a.default).logData(n.__assign(n.__assign({},this._baseEngagementData),{name:e,extraData:f.graft(this._baseEngagementData.extraData,{fieldType:this._curField.csrInfo.FieldType})}))};e.prototype.WidgetControlGridContext=function(e){return new S(e,this._objBag,this)};e.prototype.WidgetControlCellContext=function(e){var t=this,n=new x(e,this);n.NotifyExpandWidget=function(){t.NotifyExpandWidget(e)};n.NotifyCollapseWidget=function(){t.NotifyCollapseWidget(e)};n.NotifyEditComplete=function(n){n?t.NotifyWidgetEditCancel(e):t.NotifyEditCompleteInternal(n)};return n};e.prototype.GetWidgetControlManagerAPI=function(e,t){var n=this;return new T(e,t,function(){return n.WidgetControlGridContext(e)},function(){return n.WidgetControlCellContext(e)},this)};e.prototype.EditControlGridContext=function(e){var t=this,n=new S(e,this._objBag,this);n.OnActivateActor=function(){t.OnActivateActorInternal(e)};n.OnDeactivateActor=function(){t.OnDeactivateActorInternal(e)};return n};e.prototype.EditControlCellContext=function(e){var t=this,n=new x(e,this);n.NotifyExpandControl=function(){t.NotifyExpandControl(e)};n.NotifyEditComplete=function(e){t.NotifyEditCompleteInternal(e)};n.Show=function(e,n){r.JsGridUtil.DebugAssert(null!=t._curGridPane&&null!=t._curTd,"Show edit html element only after actor has been bound to a cell.");e.style.position="absolute";r.JsGridUtil.DebugAssert(e.offsetParent==t.actorsParentNode,"Edit control element needs to be added to the parentNode sent through OnGridAttach, and positioned relative to it.");t._objBag.RTL.bEnabled&&(e.style.right=e.offsetParent.offsetWidth-(t._curTdRect.x+t._curTdRect.width)+1+"px");if(r.JsGridUtil.Internal.IsFeatureEnabled(v)){var i=n?0:2;e.style.left=t._curTdRect.x+i+"px";e.style.top=t._curTdRect.y+i+"px"}else{e.style.left=t._curTdRect.x+1+"px";e.style.top=t._curTdRect.y+1+"px"}e.style.visibility="inherit"};n.Hide=function(e){t._objBag.focusMgr.ChangeTextInputElementToFocusElement()||(e.style.visibility="hidden")};n.GetCurrentRect=function(){return t._curTdRect};n.GetCurrentTd=function(){return t._curTd};return n};e.prototype.GetEditControlManagerAPI=function(e,t){var n=this;return new T(e,t,function(){return n.EditControlGridContext(e)},function(){return n.EditControlCellContext(e)},this)};e.prototype.NotifyEditCompleteInternal=function(e){if(this.IsEditing()||this._stateTransitionManager.GetCurrentEndingState()==d){this._curGridPane.useCustomSelFrames=!1;this._stateTransitionManager.HandleStateTransition(p,!0,null,[e])}else if(this.IsBound()){this.CollapseAll(null);if(!e){this.logEngagement("QuickEdit.OnCellEditBegin");this._objBag.eventMgr.FireEvent(i.JsGridConstants.EventType.OnCellEditBegin,r.JsGridUtil.EventArgs.CellEditBegin(this._curRecord.key(),this._curField.key));var t=this.ApplyUserUpdatedValue();this.logEngagement("QuickEdit.onCellEditCompleted");this._objBag.eventMgr.FireEvent(i.JsGridConstants.EventType.OnCellEditCompleted,r.JsGridUtil.EventArgs.CellEditCompleted(this._curRecord.key(),this._curField.key,t,e))}if("SPUser"===this._curPropType.ID||"DropdownBoolean"===this._curPropType.ID||this._curPropType.ID.endsWith("_Choice")||this._curPropType.ID.endsWith("_Lookup")||"Hyperlink"===this._curPropType.ID&&!g||"SPUser_MultiValue"===this._curPropType.ID&&!y){this._curGridPane.useCustomSelFrames=!1;this._curGridPane.HideSelectionFrames();this.Unbind(null);this._objBag.focusMgr.Focus()}}this._curActiveActorName=null};e.prototype.SetCellInfo=function(e,t){e.propType=this._curPropType;e.originalValue=this._originalValue;e.record=this._curRecord;e.column=this._curColumn;e.field=this._curField;e.fieldKey=this._curField.key;e.cellExpandSpace=this._curExpandSpace;if(t)e.cellRect=this._curTdRect;else{e.cellWidth=this._curTdRect.width-2;e.cellHeight=this._curTdRect.height-2;e.cellStyle=this._curStyle}};e.prototype.OnRegisterWidgetControl=function(e,t){var n=document.createElement("div");n.className=r.JsGridUtil.Internal.IsFeatureEnabled(v)?l.msGridWidgetCell:"jsgrid-widget-cell";n.appendChild(t.GetIcon());this._widgetIcons[e]=n;this._widgetDock.appendChild(n)};e.prototype.GetCurrentTdRect=function(){var e=null!=this._curTd.parentNode?this._curGridPane.GetTdCoordsRelativeToParentNode(this._curTd):null;return null!=e?{x:e.left,y:e.top,width:e.width,height:e.height}:null};e.prototype.GetCurrentViewportCoord=function(){return this._curGridPane.GetTableViewportRelativeToParentNode()};e.prototype.GetExpandSpace=function(e,t){return{top:e.y-t.top,right:t.right-e.x-e.width,bottom:t.bottom-e.y-e.height,left:e.x-t.left}};e.prototype.ApplyUserUpdatedValue=function(){var e,t=this,n=this.HaveNewLocalizedValue(),r=this.HaveNewDataValue();if(n||r){var i;i=n&&r?o.CreateValidatedPropertyUpdate(this._curRecord.key(),this._curField.key,this._userUpdatedValue.data,this._userUpdatedValue.localized):o.CreateUnvalidatedPropertyUpdate(this._curRecord.key(),this._curField.key,n?this._userUpdatedValue.localized:this._userUpdatedValue.data,n);this._userUpdatedValue={};e=this._fnUpdateProperties([i],"User Edit",null,function(e){t._lastChangeKey=e});this.RecalculateWidgets();this.UpdateOriginalValue(this.GetValueFromRecord())}else this._userUpdatedValue={};return e};e.prototype.HaveNewLocalizedValue=function(){var e=!1;if(this._originalValue.localized!==r.JsGridUtil.EmptyValue&&"localized"in this._userUpdatedValue){e=(null!=this._originalValue.localized?this._originalValue.localized:"")!==this._userUpdatedValue.localized}return e};e.prototype.HaveNewDataValue=function(){var e=!1;this._originalValue.data!==r.JsGridUtil.EmptyValue&&"data"in this._userUpdatedValue&&(e=!this._curField.CompareSingleDataEqual(this._userUpdatedValue.data,this._originalValue.data));return e};e.prototype.RecalculateWidgets=function(){if(this._curState>=p){var e=this._curWidgetControlsAPI.length>0&&this._curWidgetControlsAPI[0].name==i.JsGridConstants.ErrorWidgetId;if(e&&!this.errorMgr.CellHasError(this._curRecord.key(),this._curField.key)){(t=this._curWidgetControlsAPI[0]).name==this._expandedWidgetName&&this.CollapseWidget(t.name);t.actor.Unbind();this._curWidgetControlsAPI.splice(0,1);this.LayoutWidgets()&&(this._widgetIcons[t.name].style.visibility="hidden")}else if(!e&&this.TryAddErrorWidget(this._curRecord.key(),this._curField.key)){var t;(t=this._actorRegistrationManager.GetWidgetControlAPI(i.JsGridConstants.ErrorWidgetId)).SetCellInfo();t.actor.BindToCell(t.GetCellContext());this.LayoutWidgets()}}};e.prototype.UpdateOriginalValue=function(e){this._originalValue=e;this._curEditControlAPI.UpdateOriginalValue(e);for(var t in this._curWidgetControlsAPI)this._curWidgetControlsAPI[t].UpdateOriginalValue(e)};e.prototype.CreateWidgetDock=function(){var e=document.createElement("div");e.className=r.JsGridUtil.Internal.IsFeatureEnabled(v)?l.msGridWidgetDock:"jsgrid-widget-dock";e.style.display="none";this.actorsParentNode.appendChild(e);this._fnDisposeWidgetDockHandlers=r.JsGridUtil.Internal.DomElement.GetInstance().SetMouseHover(e,this.HighlightBorder.bind(this),this.ClearHighlightedWidgets.bind(this),this.HighlightWidgets.bind(this));e.addEventListener("click",this.OnClickWidgetDock.bind(this));e.addEventListener("mousedown",this.OnMouseDownWidgetDock.bind(this));return e};e.prototype.OnClickWidgetDock=function(e){if(e.button==i.JsGridConstants.MouseButton.leftButton)for(var t=r.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n=0;n<this._curWidgetControlsAPI.length;n++){var s=this._widgetIcons[this._curWidgetControlsAPI[n].name];if(r.JsGridUtil.Internal.DomElement.GetInstance().PointInDomElem(t.x,t.y,s,null)){r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);this._expandedWidgetName!==this._curWidgetControlsAPI[n].name?this.ExpandWidgetInternal(this._curWidgetControlsAPI[n].actor):this.CollapseWidget(this._expandedWidgetName);break}}};e.prototype.OnMouseDownWidgetDock=function(e){e.stopPropagation()};e.prototype.HighlightBorder=function(){this._widgetDock.style.borderColor=null!=this._objBag.styleMgr.widgetDockHoverStyle.borderColor?this._objBag.styleMgr.widgetDockHoverStyle.borderColor:"#768290"};e.prototype.ClearHighlightedWidgets=function(){null==this._expandedWidgetName&&(this._widgetDock.style.borderColor=null!=this._objBag.styleMgr.widgetDockStyle.borderColor?this._objBag.styleMgr.widgetDockStyle.borderColor:"");for(var e=0;e<this._curWidgetControlsAPI.length;e++)this._curWidgetControlsAPI[e].name!==this._expandedWidgetName&&(this._widgetIcons[this._curWidgetControlsAPI[e].name].style.backgroundColor=null!=this._objBag.styleMgr.widgetDockStyle.backgroundColor?this._objBag.styleMgr.widgetDockStyle.backgroundColor:"");this._highlightedWidgetName=null};e.prototype.HighlightWidgets=function(e){for(var t=r.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n=0;n<this._curWidgetControlsAPI.length;n++){var i=this._widgetIcons[this._curWidgetControlsAPI[n].name];if(r.JsGridUtil.Internal.DomElement.GetInstance().PointInDomElem(t.x,t.y,i,null)){if(this._highlightedWidgetName!==this._curWidgetControlsAPI[n].name){null!=this._highlightedWidgetName&&this._highlightedWidgetName!==this._expandedWidgetName&&(this._widgetIcons[this._highlightedWidgetName].style.backgroundColor=null!=this._objBag.styleMgr.widgetDockStyle.backgroundColor?this._objBag.styleMgr.widgetDockStyle.backgroundColor:"");this._highlightedWidgetName=this._curWidgetControlsAPI[n].name;this._curWidgetControlsAPI[n].name!==this._expandedWidgetName&&(i.style.backgroundColor=null!=this._objBag.styleMgr.widgetDockHoverStyle.backgroundColor?this._objBag.styleMgr.widgetDockHoverStyle.backgroundColor:"#C4C9CF")}break}}};e.prototype.LayoutWidgets=function(){if(null!=this._curTdRect&&null!=this._curPaneRect){var e=this._curTdRect,t=this._curPaneRect;if(this._curWidgetControlsAPI.length>0){for(var n=20*this._curWidgetControlsAPI.length,r=this._objBag.RTL.bEnabled?e.x-(n+2)>=t.left:e.x+e.width+5+(n+2)>t.right,i=e.y+Math.floor((e.height-22)/2),s=r?e.x-(n+2+5):e.x+5+e.width,o=0;o<this._curWidgetControlsAPI.length;o++){var u=this._widgetIcons[this._curWidgetControlsAPI[o].name];u.style.left=20*o+"px";u.style.visibility=""}this._widgetDock.style.top=i+"px";this._widgetDock.style.left=s+"px";this._widgetDock.style.width=n+"px";this._widgetDock.style.display="block"}else this._widgetDock.style.display="none";return!0}return!1};e.prototype.GetValueFromRecord=function(){return this._fnGetCellValue(this._curRecord,this._curField.key,this._curPropType)};e.prototype.TryAddErrorWidget=function(e,t){var n=!1;if(this.errorMgr.CellHasError(e,t)){this._curWidgetControlsAPI.unshift(this._actorRegistrationManager.RegisterWidgetControl(i.JsGridConstants.ErrorWidgetId));n=!0}return n};e.prototype.ExpandActor=function(e){return this._actorRegistrationManager.IsActorWidget(e.name)?this.ExpandWidgetInternal(e.actor):this.ExpandControlInternal(e.actor)};e.prototype.PrepareForExpandWidget=function(e){this._valueBeforeWidgetEdit=this._updatedValue;this.CollapseAll(e);null!=this._expandedWidgetName&&this._expandedWidgetName!==e&&(this._widgetIcons[this._expandedWidgetName].style.backgroundColor="");this._widgetIcons[e].style.backgroundColor=null!=this._objBag.styleMgr.widgetDockPressedStyle.backgroundColor?this._objBag.styleMgr.widgetDockPressedStyle.backgroundColor:"#8C8F93";null!=this._objBag.styleMgr.widgetDockPressedStyle.borderColor&&(this._widgetIcons[e].style.borderColor=this._objBag.styleMgr.widgetDockPressedStyle.borderColor);this._expandedWidgetName=this._lastExpandedActorName=e};e.prototype.CollapseWidget=function(e){this.ClearExpandedWidget(e);this._actorRegistrationManager.GetWidgetControlAPI(e).actor.Collapse()};e.prototype.ClearExpandedWidget=function(e){if(e==this._expandedWidgetName){this._widgetIcons[e].style.backgroundColor=null!=this._objBag.styleMgr.widgetDockStyle.backgroundColor?this._objBag.styleMgr.widgetDockStyle.backgroundColor:"";null!=this._objBag.styleMgr.widgetDockStyle.borderColor&&(this._widgetIcons[e].style.borderColor=this._objBag.styleMgr.widgetDockStyle.borderColor);this._expandedWidgetName=null}};e.prototype.ExpandWidgetInternal=function(e){if(null!=e.Expand){e.Expand();return!0}return!1};e.prototype.PrepareForExpandControl=function(e){this.CollapseAll(e);this._lastExpandedActorName=e};e.prototype.ExpandControlInternal=function(e){if(null!=e.Expand){e.Expand();return!0}return!1};e.prototype.CollapseAll=function(e){for(var t=0;t<this._curWidgetControlsAPI.length;t++)this._curWidgetControlsAPI[t].name!==e&&this.CollapseWidget(this._curWidgetControlsAPI[t].name);null!=this._curEditControlAPI.actor.Collapse&&this._curEditControlAPI.name!==e&&this._curEditControlAPI.actor.Collapse()};e.prototype.SetCurrentValueInternal=function(e,t,n){this._userUpdatedValue={};if("localized"in e&&e.localized!==r.JsGridUtil.EmptyValue){this._updatedValue.localized=e.localized;t==i.JsGridConstants.EditActorUpdateType.Uncommitted&&(this._userUpdatedValue.localized=e.localized)}if("data"in e&&e.data!==r.JsGridUtil.EmptyValue){this._updatedValue.data=e.data;t==i.JsGridConstants.EditActorUpdateType.Uncommitted&&(this._userUpdatedValue.data=e.data)}if(null!=this._curActorsAPI)for(var s=0;s<this._curActorsAPI.length;s++)n!==this._curActorsAPI[s].name&&this._curActorsAPI[s].actor.OnValueChanged(this._updatedValue,t)};e.prototype.OnActivateActorInternal=function(e){this.TrackActiveActor(!0,e)};e.prototype.OnDeactivateActorInternal=function(e){var t=this;setTimeout(function(){t.TrackActiveActor(!1,e)},0)};e.prototype.TrackActiveActor=function(e,t){e||null==this._curActiveActorName||t!=this._curActiveActorName?e&&(this._curActiveActorName=t):this.StopEditing(!1)};e.prototype.Unbind=function(e){this._stateTransitionManager.HandleStateTransition(h,!0,e,null)};e.prototype.StopEditing=function(e){var t=this._actorRegistrationManager.GetActorAPI(this._curActiveActorName)||this._curEditControlAPI;if(null!=t){t.NotifyEditComplete(e);r.JsGridUtil.Internal.IsFeatureEnabled(v)&&this._curGridPane&&this._curGridPane.selectionDragHandle.classList.remove(c.editorIsActive)}};e.prototype.BindToCell=function(e,t,n,r,i,s,o,u){this._stateTransitionManager.HandleStateTransition(p,!1,u,[e,t,n,r,i,s,o])};e.prototype.BeginEdit=function(e,t){this._isInQuickEditMode="keypress"==e.type;this._stateTransitionManager.HandleStateTransition(d,!1,t,[e]);r.JsGridUtil.Internal.IsFeatureEnabled(v)&&this._curGridPane.selectionDragHandle.classList.add(c.editorIsActive)};e.prototype.IsBoundToCell=function(e,t,n){return this._curState>=p&&this._curGridPane==e&&this._curRecord.key()==t&&this._curField.key==n};e.prototype.IsBound=function(){return this._curState>=p};e.prototype.IsEditing=function(){return this._curState>=d};e.prototype.NotifyMove=function(e){if((null==e||e===this._curGridPane)&&this._curState>=p){var t=this._curGridPane.GetFocusedCell(),n=t&&t.GetTd();if(null!=n&&null!=this._curTd&&this._curRecord.key()==t.GetRecordKey()&&this._curField.key==t.GetFieldKey()){this._curTd=n;this._curTdRect=this.GetCurrentTdRect();if(null!=this._curTdRect){this._curPaneRect=this.GetCurrentViewportCoord();this._curExpandSpace=this.GetExpandSpace(this._curTdRect,this._curPaneRect);this._curEditControlAPI.SetCellInfo();this._curEditControlAPI.actor.OnCellMove();for(var r=0;r<this._curWidgetControlsAPI.length;r++){this.CollapseWidget(this._curWidgetControlsAPI[r].name);this._curWidgetControlsAPI[r].SetCellInfo()}this.LayoutWidgets()}}else null==n&&null!=this._curTd&&this.Unbind(null)}};e.prototype.NotifyUpdateProperty=function(e,t,n,r,s){if(this.IsBoundToCell(e,t,n)){var o={};r.HasDataValue()&&(o.data=r.data);r.HasLocalizedValue()&&(o.localized=r.localized);this.UpdateOriginalValue(o);(null==this._lastChangeKey||null!=s&&0!==s.CompareTo(this._lastChangeKey))&&this.SetCurrentValueInternal(o,i.JsGridConstants.EditActorUpdateType.Committed,null)}};e.prototype.ExpandWidget=function(e){var t=r.JsGridUtil.Internal.FindInArray(this._curWidgetControlsAPI,function(t){return t.name==e});null!=t&&this.ExpandWidgetInternal(this._curWidgetControlsAPI[t].actor)};e.prototype.ExpandNextActor=function(){var e=this;if(this._curState>=p&&(null!=this._curEditControlAPI.actor.Expand||this._curWidgetControlsAPI.length)){var t=(function(t){if(0==e._curActorsAPI.length||null==e._curActorsAPI[0].actor.Expand&&1==e._curActorsAPI.length)return null;var n,r=null!=e._curActorsAPI[0].actor.Expand?0:1;if(null==e._lastExpandedActorName)n=e._curActorsAPI[r];else for(var i=r;i<e._curActorsAPI.length;i++)if(e._curActorsAPI[i].name==e._lastExpandedActorName){n=t?i==e._curActorsAPI.length-1?e._curActorsAPI[r]:e._curActorsAPI[i+1]:i==r?e._curActorsAPI[e._curActorsAPI.length-1]:e._curActorsAPI[i-1];break}return n})(!0);r.JsGridUtil.DebugAssert(null!=t&&null!=t.actor.Expand);return this.ExpandActor(t)}return!1};e.prototype.NotifyExpandWidget=function(e){this.OnActivateActorInternal(e);this.PrepareForExpandWidget(e)};e.prototype.NotifyCollapseWidget=function(e){this.OnDeactivateActorInternal(e);this.ClearExpandedWidget(e)};e.prototype.NotifyWidgetEditCancel=function(e){this._updatedValue=this._valueBeforeWidgetEdit;this._curActiveActorName=null;this.CollapseWidget(e);this.IsEditing()?this._curEditControlAPI.actor.Focus():this._objBag.focusMgr.Focus()};e.prototype.NotifyExpandControl=function(e){this.PrepareForExpandControl(e)};e.prototype.SetCurrentValue=function(e,t){this.SetCurrentValueInternal(t,i.JsGridConstants.EditActorUpdateType.Uncommitted,e)};e.prototype.OnActorKeyDown=function(e,t){var n=this;r.JsGridUtil.DebugAssert(this._curState>=p);if((function(){var t=!1;if(e.keyCode==i.JsGridConstants.Key.tab||e.keyCode==i.JsGridConstants.Key.enter){n.StopEditing(!1);n._objBag.focusMgr.HandleKeyDown(e);t=!0}else if(e.keyCode==i.JsGridConstants.Key.esc){n.StopEditing(!0);m||n.StopEditing(!0);t=!0}return t})())r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);else if(this._curState==p&&t==this._curEditControlAPI.name)this.BeginEdit(e,null);else{var s=!1,o=t==this._curEditControlAPI.name?this._curEditControlAPI:this._actorRegistrationManager.GetWidgetControlAPI(t);null!=o&&null!=o.actor&&null!=o.actor.OnKeyDown&&(e.StopInfiniteKeyDownLoop||(s=o.actor.OnKeyDown(e)));var u=this._isInQuickEditMode||null==o||o.IsLightFocus();!s&&u&&this._objBag.focusMgr.HandleKeyDown(e,!0)&&null!=this._curActiveActorName&&this._curActiveActorName==t&&this.StopEditing(!1)}};e.prototype.GetCurrentEditControlName=function(){return this._curEditControlAPI.name};e.prototype.IsCurrentEditControlUsingGridTextInputElement=function(){return this._curEditControlAPI.actor.IsCurrentlyUsingGridTextInputElement()};e.prototype.Dispose=function(){var e=this;this.Unbind(function(){e._actorRegistrationManager.Dispose();null!=e._fnDisposeWidgetDockHandlers&&e._fnDisposeWidgetDockHandlers();r.JsGridUtil.ClearEventListeners(e._widgetDock);e._widgetDock.innerHTML="";e._widgetDock=null})};return e})();t.EditManager=b;var w=function(e,t){this.fn=e;this.bArgsRequired=t},E=(function(){function e(e){this.rawStateMap=[[h,{promote:new w(this.ProcessBind.bind(this),!0)}],[p,{demote:new w(this.ProcessUnbind.bind(this),!1),promote:new w(this.ProcessBeginEdit.bind(this),!0)}],[d,{demote:new w(this.ProcessStopEdit.bind(this),!1)}]];this.stateMap=r.JsGridUtil.Internal.ConvertTableToMap(this.rawStateMap,"0","1");this._stateQueue=[];this.emptyArgs=[];this._editMgr=e}e.prototype.ProcessUnbind=function(){for(var e=0;e<this._editMgr._curWidgetControlsAPI.length;e++)this._editMgr.CollapseWidget(this._editMgr._curWidgetControlsAPI[e].name);this._editMgr._widgetDock.style.display="none";for(e=0;e<this._editMgr._widgetDock.childNodes.length;e++)this._editMgr._widgetDock.childNodes[e].style.visibility="hidden";this._editMgr._lastExpandedActorName=null;for(e=0;e<this._editMgr._curActorsAPI.length;e++)this._editMgr._curActorsAPI[e].actor.Unbind();this._editMgr._curRecord=null;this._editMgr._curColumn=null;this._editMgr._curField=null;this._editMgr._curGridPane=null;this._editMgr._curActorsAPI=null;this._editMgr._curEditControlAPI=null;this._editMgr._curWidgetControlsAPI=null;this._editMgr._curPropType=null;this._editMgr._curTd=null;this._editMgr._curTdRect=null;this._editMgr._curExpandSpace=null;this._editMgr._curPaneRect=null;this._editMgr._curStyle=null;this._editMgr._curActiveActorName=null;this._editMgr._updatedValue={};this._editMgr._userUpdatedValue={};this._editMgr._originalValue=null;this._editMgr._lastExpandedActorName=null};e.prototype.ProcessStopEdit=function(e){var t;this._editMgr._curEditControlAPI.actor.OnEndEdit();this._editMgr.CollapseAll();e||(t=this._editMgr.ApplyUserUpdatedValue());this._editMgr._isInQuickEditMode=!1;this._editMgr._updatedValue={};this._editMgr._userUpdatedValue={};this._editMgr._objBag.focusMgr.Focus();this._editMgr.logEngagement("QuickEdit.onCellEditCompleted");this._editMgr._objBag.eventMgr.FireEvent(i.JsGridConstants.EventType.OnCellEditCompleted,r.JsGridUtil.EventArgs.CellEditCompleted(this._editMgr._curRecord.key(),this._editMgr._curField.key,t,e))};e.prototype.ProcessBind=function(e,t,n,r,i,s,o,u){this._editMgr._curRecord=t;this._editMgr._curColumn=n;this._editMgr._curField=i[r];this._editMgr._curGridPane=e;this._editMgr._curPropType=null!=t.GetProp(r)?t.GetProp(r).propType:i[r].GetPropType();this._editMgr._originalValue=this._editMgr.GetValueFromRecord();this._editMgr._curActorsAPI=this._editMgr._actorRegistrationManager.GetEditAndWidgetControlsAPI(this._editMgr._curRecord,this._editMgr._curColumn,this._editMgr._curField.key,this._editMgr._curPropType);this._editMgr._curEditControlAPI=this._editMgr._curActorsAPI.editControlAPI;this._editMgr._curWidgetControlsAPI=this._editMgr._curActorsAPI.widgetControlsAPI;this._editMgr.TryAddErrorWidget(t.key(),r);this._editMgr._curActorsAPI=[this._editMgr._curEditControlAPI].concat(this._editMgr._curWidgetControlsAPI);this._editMgr._updatedValue={};this._editMgr._userUpdatedValue={};null!=s&&(this._editMgr._curTd=s.GetTd());null!=o&&(this._editMgr._curStyle=o);this._editMgr._curTdRect=this._editMgr.GetCurrentTdRect();this._editMgr._curPaneRect=this._editMgr.GetCurrentViewportCoord();this._editMgr._curExpandSpace=this._editMgr.GetExpandSpace(this._editMgr._curTdRect,this._editMgr._curPaneRect);this._editMgr._curEditControlAPI.SetCellInfo();this._editMgr._curEditControlAPI.actor.BindToCell(this._editMgr._curEditControlAPI.GetCellContext());for(var a in this._editMgr._curWidgetControlsAPI){this._editMgr._curWidgetControlsAPI[a].SetCellInfo();this._editMgr._curWidgetControlsAPI[a].actor.BindToCell(this._editMgr._curWidgetControlsAPI[a].GetCellContext())}this._editMgr.LayoutWidgets()};e.prototype.ProcessBeginEdit=function(e){this._editMgr._curActiveActorName=r.JsGridUtil.EmptyValue;this._editMgr.UpdateOriginalValue(this._editMgr.GetValueFromRecord());this._editMgr.logEngagement("QuickEdit.OnCellEditBegin");this._editMgr._objBag.eventMgr.FireEvent(i.JsGridConstants.EventType.OnCellEditBegin,r.JsGridUtil.EventArgs.CellEditBegin(this._editMgr._curRecord.key(),this._editMgr._curField.key));this._editMgr._curEditControlAPI.actor.OnBeginEdit(e);null==this._editMgr._curEditControlAPI.actor.OnKeyDown||"keypress"!=e.type&&"keydown"!=e.type||this._editMgr._curEditControlAPI.actor.OnKeyDown(e)};e.prototype.HandleStateTransition=function(e,t,n,i){var s=this,o=this._stateQueue.length>0?this._stateQueue[0].newState:this._editMgr._curState;if(t&&o<=e||!t&&o>=e)(function(e,t,n){for(var i=0;i<s._stateQueue.length;i++)if(s._stateQueue[i]==e){null!=t&&s._stateQueue[i].callbacks.push(t);r.JsGridUtil.DebugAssert(!s.stateMap[e].bArgsRequired||null==n);null!=n&&(s._stateQueue[i].args=n);return}null!=t&&t()})(e,n,i);else{for(var u=Math.abs(o-e),a=1;a<=u;a++){e=o+a*(t?-1:1);var f=1==a&&null!=i?i:this.emptyArgs,l=null!=n&&u==a?[n]:this.emptyArgs;r.JsGridUtil.DebugAssert(!this.stateMap[e].bArgsRequired||f==this.emptyArgs);this._stateQueue.unshift({newState:e,args:f,callbacks:l})}this._stateQueue.length==u&&(function(){for(;s._stateQueue.length>0;){var e=s._stateQueue[s._stateQueue.length-1];(s._editMgr._curState<e.newState?s.stateMap[s._editMgr._curState].promote.fn:s.stateMap[s._editMgr._curState].demote.fn).apply(null,e.args);s._editMgr._curState=e.newState;s._stateQueue.pop();for(var t=0;t<e.callbacks.length;t++)e.callbacks[t]()}})()}};e.prototype.GetCurrentEndingState=function(){return this._stateQueue.length>0?this._stateQueue[0].newState:this._editMgr._curState};return e})(),S=function(e,t,n){this.jsGridObj=t.jsGridObj;this.parentNode=n.actorsParentNode;this.styleManager=t.styleMgr;this.RTL=t.RTL;this.emptyValue=r.JsGridUtil.EmptyValue;this.bLightFocus=!1;this.peoplePickerDataSource=t.jsGridParams.peoplePickerDataSource;this.locationDataSource=t.jsGridParams.locationDataSource;this.taxonomyPickerDataSource=t.jsGridParams.taxonomyDataSource;this.pageContext=t.jsGridParams.pageContext;this.OnKeyDown=function(t){n.OnActorKeyDown(t,e)}};t.EditActorGridContext=S;var x=(function(){function e(e,t){this._name=e;this._editMgr=t}e.prototype.SetCurrentValue=function(e){this._editMgr.SetCurrentValue(this._name,e)};return e})(),T=function(e,t,n,r,i){var s=this;this._gridContext=n();this._cellContext=r();this.name=e;this.actor=t;this.SetCellInfo=function(){i.SetCellInfo(s._cellContext,i._actorRegistrationManager.IsActorWidget(s.name))};this.UpdateOriginalValue=function(e){s._cellContext.originalValue=e};this.IsLightFocus=function(){return s._gridContext.bLightFocus};this.NotifyEditComplete=function(e){s._cellContext.NotifyEditComplete(e)};this.GetGridContext=function(){return s._gridContext};this.GetCellContext=function(){return s._cellContext}};t.EditActorManagerAPI=T});
define("aQR",["require","exports","aPS","aPY"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t,n,r,i){this._registeredEditControlsAPI={};this._registeredWidgetControlsAPI={};this._objBag=e;this._fnGetEditControlManagerAPI=n;this._fnGetWidgetControlManagerAPI=r;this._fnOnRegisterWidgetControl=i}e.prototype.RegisterEditControl=function(e){e in this._registeredEditControlsAPI||this.CreateEditControlInstance(e);return this._registeredEditControlsAPI[e]};e.prototype.RegisterWidgetControl=function(e){e in this._registeredWidgetControlsAPI||this.CreateWidgetControlInstance(e);return this._registeredWidgetControlsAPI[e]};e.prototype.GetEditControlAPI=function(e){return this._registeredEditControlsAPI[e]};e.prototype.GetWidgetControlAPI=function(e){return this._registeredWidgetControlsAPI[e]};e.prototype.GetActorAPI=function(e){return this._registeredEditControlsAPI[e]||this._registeredWidgetControlsAPI[e]};e.prototype.IsActorWidget=function(e){return e in this._registeredWidgetControlsAPI};e.prototype.GetEditAndWidgetControlsAPI=function(e,t,n,i){var s={editControlAPI:null,widgetControlsAPI:[]},o=r.PropertyType.Internal.Property.GetInstance().GetEditAndWidgetControlNamesForProperty(e,t,n,i);s.editControlAPI=this.RegisterEditControl(o.editControlName);for(var u=0;u<o.widgetControlNames.length;u++)s.widgetControlsAPI.push(this.RegisterWidgetControl(o.widgetControlNames[u]));return s};e.prototype.Dispose=function(){for(var e in this._registeredEditControlsAPI)this._registeredEditControlsAPI[e].actor.Dispose();for(var e in this._registeredWidgetControlsAPI)this._registeredWidgetControlsAPI[e].actor.Dispose()};e.prototype.CreateEditControlInstance=function(e){var t=this._fnGetEditControlManagerAPI(e),n=[t.GetGridContext()],i=this._objBag.focusMgr.GetFocusElementForTextInput(e);null!=i&&n.push(i);t.actor=r.PropertyType.Internal.Property.GetInstance().GetEditControl(e,n);this._registeredEditControlsAPI[e]=t};e.prototype.CreateWidgetControlInstance=function(e){var t=this._fnGetWidgetControlManagerAPI(e),i=[t.GetGridContext()];e==n.JsGridConstants.ErrorWidgetId&&i.push(this._objBag.errorMgr);t.actor=r.PropertyType.Internal.Property.GetInstance().GetWidgetControl(e,i);this._fnOnRegisterWidgetControl(e,t.actor);this._registeredWidgetControlsAPI[e]=t};return e})();t.EditActorsRegistrationManager=i});
define("aQP",["require","exports","aPS","aQB","aQo","aQp","aQU","aQn","bt"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=a.Killswitch.isActivated("FAFFB0A4-381F-4ADF-A597-87E8C524145C","9/27/2019","Enable copy in non-IE browsers"),l=(function(){function e(e,t){this.SelectionType=n.JsGridConstants.SelectionType;this.hasClipBoardData=function(){return!!this._clipboardMgr.GetData()};this._objBag=e;this._fnGetLocStr=t;this._clipboardMgr=new c}e.prototype.GetLastOperation=function(){return this.copyOp&&{gridPane:this.copyOp.gridPane,rowRange:this.copyOp.rowRange,colRange:this.copyOp.colRange,selType:this.copyOp.selType,opType:this.copyOp.opType}};e.prototype.CheckClipboard=function(){null==this.copyOp||this.IsClipboardDataFromLastCopyOperation()||this.CancelMode()};e.prototype.IsSelectionCopyable=function(e){return this._objBag.selectionMgr.GetRowRanges(e).length+this._objBag.selectionMgr.GetColumnRanges(e).length+this._objBag.selectionMgr.GetCellRanges(e).length==1};e.prototype.CancelMode=function(){var e=this.copyOp&&this.copyOp.gridPane;this.copyOp=null;null!=e&&e.NotifyCopyOperationUpdated()};e.prototype.OnCopy=function(e){var t=this,r=this._objBag.selectionMgr.GetLastSelectionRangeNormalized();if(null!=r){var i,s=r.rowRange,o=r.colRange,u=e.GetGridPaneConverter();this._objBag.intDelegateMgr.Apply(n.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return i=u.GetRecordsInvolved(s.begin,s.Size(),function(t){i=t;e()})},function(){t.BaseCopy(e,i,s,o,"copy",!1)})}};e.prototype.OnCut=function(e){var t=this;if(this._objBag.editUtil.IsEditingEnabled()){var r=this._objBag.selectionMgr.GetLastSelectionRangeNormalized();if(null!=r){var i,s=r.rowRange,o=r.colRange,u=e.GetGridPaneConverter(),a=this._objBag.editUtil.IsNewRowEnabled()&&s.end==u.GetVirtualRowCount()-this._objBag.entryRecordMgr.GetEntryRecords().length,f=u.GetRecordKeysInvolved(s.begin,s.Size());if(a)alert(this._fnGetLocStr("OpNotSupportedOnEntryRow"));else{var l=this._objBag.selectionMgr.GetLastSelectionType()==this.SelectionType.RowRange&&this._objBag.delegateMgr.DelegatePresent(n.JsGridConstants.DelegateType.DeleteRecords);if(l){if(e.Id!==n.JsGridConstants.PaneId.MainGrid){alert(this._fnGetLocStr("NoCuttingRowsInPane"));return}var c=this._objBag.editUtil.ValidateAndExpandKeyList(f);if(null!=c){if(!c.bAllChildKeysInView){alert(this._fnGetLocStr("NoDeletingParentWithMissingChildren"));return}if(c.expandedKeys.length!==f.length){alert(this._fnGetLocStr("NoCuttingParentWithoutChildren"));return}}}this._objBag.intDelegateMgr.Apply(n.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return i=u.GetRecordsInvolved(s.begin,s.Size(),function(t){i=t;e()})},function(){if(l){if(t.ContainsReadOnlyRows(i)){alert(t._fnGetLocStr("NoCuttingReadOnlyRows"));return}}else if(t.ContainsReadOnlyCells(e,i,s,o)){alert(t._fnGetLocStr("NoCuttingReadOnlyCells"));return}t.BaseCopy(e,i,s,o,"cut",l)})}}}else alert(this._fnGetLocStr("GridNotEditable"))};e.prototype.OnPaste=function(e,t){var s=this,a=function(e){g?e():s._objBag.intDelegateMgr.Apply(n.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return T=w.GetRecordsInvolved(O.begin,O.Size(),function(t){T=t;e()})},e)},f=function(e){s._objBag.delegateMgr.DelegatePresent(n.JsGridConstants.DelegateType.TryBeginPaste)?s._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.TryBeginPaste,O.end-O.begin+1,l,e):l(e)},l=function(t){s._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnPasteBegin);s.CancelMode();if(null!=d)if(d.causesRowDelete){s._objBag.jsGridObj.DeleteRecords(i.JsGridUtil.Internal.ConvertSetKeysToArray(x));O.begin-=v;O.end-=v}else s._objBag.jsGridObj.UpdateProperties(s.BuildPropertyUpdatesForCut(d.gridPane,x,d.rowRange,d.colRange),n.JsGridConstants.UserAction.Paste);e.PutData(h,T,n.JsGridConstants.UserAction.Paste,"TL",O,M,t,g)},c=function(t){i.JsGridUtil.hasPasteStarted=!1;s._objBag.selectionMgr.SelectRange(e,O.begin,O.begin+Math.min(t,O.end-O.begin),M.begin,M.end,o.SelectOp.Set,!0,!1);s._objBag.commandMgr.CloseGroup(null!=d?"SP.JsGrid.UserAction.CutPaste":n.JsGridConstants.UserAction.Paste,r.CommandManagerConstants.CommandType.Explicit,!0);s._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnPasteEnd)};if(this._objBag.editUtil.IsEditingEnabled()){if(!this.IsSelectionCopyable(e)){alert(this._fnGetLocStr("MultipleSelections"));return!1}var h=this.GetParsedClipboardData(t);if(null!=h){var p=this._objBag.selectionMgr.GetLastSelectionRangeNormalized();if(null!=p){i.JsGridUtil.hasPasteStarted=!0;var d,v=0,m=0;if(null!=this.copyOp&&"cut"==this.copyOp.opType&&this.IsClipboardDataFromLastCopyOperation()&&(d={gridPane:this.copyOp.gridPane,rowRange:this.copyOp.rowRange,colRange:this.copyOp.colRange,causesRowDelete:this.copyOp.bCutCausesRowDelete}).causesRowDelete){v=d.gridPane==e&&d.rowRange.begin<p.rowRange.begin?d.rowRange.Size():0;m=d.rowRange.Size();if(e.Id!==n.JsGridConstants.PaneId.MainGrid){alert(this._fnGetLocStr("NoPastingRowsInPane"));return}if(new u.Range(p.rowRange.begin,p.rowRange.begin+d.rowRange.Size()-1).Overlaps(d.rowRange)){alert(this._fnGetLocStr("CutPasteRowOverlap"));return}}var g,y=p.colRange.Size(),b=p.rowRange.Size(),w=e.GetGridPaneConverter(),E=w.GetVirtualRowCount();if(this._objBag.editUtil.IsNewRowEnabled()){var S=this._objBag.entryRecordMgr.GetEntryRecords().length;g=p.rowRange.begin>=E-S;E-=S}if(p.colRange.begin+h.width>w.GetVirtualColumnCount()||!g&&p.rowRange.begin-v+h.height>E-m)alert(this._fnGetLocStr("NoRoomToPaste"));else{var x,T,N,C=y%h.width==0,k=b%h.height==0,L=null==d&&C&&(k||b<h.height)?y:h.width,A=null==d&&k&&(C||y<h.width)?b:h.height,O=new u.Range(p.rowRange.begin,p.rowRange.begin+A-1),M=new u.Range(p.colRange.begin,p.colRange.begin+L-1);this._objBag.commandMgr.OpenGroup();null!=d?(N=function(){a(function(){f(c)})},s._objBag.intDelegateMgr.Apply(n.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return x=d.gridPane.GetGridPaneConverter().GetRecordsInvolved(d.rowRange.begin,d.rowRange.Size(),function(t){x=t;e()})},N)):a(function(){f(c)})}}}}else alert(this._fnGetLocStr("GridNotEditable"))};e.prototype.BaseCopy=function(e,t,n,r,i,s){if(!this.IsSelectionCopyable(e)){alert(this._fnGetLocStr("MultipleSelections"));return!1}for(var o=e.GetData(t,n,r,!1),u=new Array(n.Size()),a=0;a<u.length;a++){u[a]=o.matrix[a].join("\t");u[a]=this.NormalizeCRLF(u[a]);u[a]=u[a].replace(/\n/g,"<br>")}this.CancelMode();var f=u.join("\r\n");if(this._clipboardMgr.SetData(f)){this.copyOp={clipboardText:f,rowRange:n,colRange:r,selType:this._objBag.selectionMgr.GetLastSelectionType(),gridPane:e,opType:i,bCutCausesRowDelete:s};e.NotifyCopyOperationUpdated();return!0}return!1};e.prototype.GetParsedClipboardData=function(e){var t=e||this._clipboardMgr.GetData();if(null==t||""==t)return null;var n=t.replace(/(\\r)(?!\\n)/g,"\n").split("\r\n");1===n.length&&(n=this.NormalizeCRLF(t).split("\n"));n.length>1&&""==n[n.length-1]&&n.pop();for(var r,s=n.length,o=0;o<s;o++){n[o]=n[o].split("\t");if(null==r)r=n[o].length;else if(r!==n[o].length){if(o==s-1&&1==n[o].length&&""==n[o][0]){s--;break}break}for(var u=0;u<n[o].length;u++){var a=n[o][u];if(a.indexOf("\n")>=0){a=(a=a.replace(/^\"+|\"+$/gm,"")).replace(/\"\"/gm,'"');a=(a=i.JsGridUtil.Internal.Encoding_STSHtmlEncode(a)).replace(/\n/g,"<br>");n[o][u]=a}}}if(o!==s){alert(this._fnGetLocStr("ClipboardDataNotSquare"));return null}return{matrix:n,width:r,height:s}};e.prototype.ContainsReadOnlyCells=function(e,t,n,r){for(var i=e.GetGridPaneConverter(),s=n.begin;s<=n.end;s++)for(var o=r.begin;o<=r.end;o++){var u=i.IdxToKey(s,o);if(!this._objBag.editUtil.CanEditField(t[u.recordKey],i.GetColumnByIdx(o),u.fieldKey))return!0}return!1};e.prototype.ContainsReadOnlyRows=function(e){for(var t in e)if(!this._objBag.editUtil.CanEditField(e[t],null,null))return!0;return!1};e.prototype.BuildPropertyUpdatesForCut=function(e,t,n,r){for(var i=e.GetGridPaneConverter(),o=new Array(n.Size()*r.Size()),u=0,a=n.begin;a<=n.end;a++)for(var f=r.begin;f<=r.end;f++){var l=i.IdxToKey(a,f);o[u++]=s.CreateUnvalidatedPropertyUpdate(l.recordKey,l.fieldKey,"",!0)}return o};e.prototype.NormalizeCRLF=function(e){return e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")};e.prototype.IsClipboardDataFromLastCopyOperation=function(){var e=this._clipboardMgr.GetData();return null==this.copyOp.clipboardText?null==e:(e&&this.NormalizeCRLF(e))==this.NormalizeCRLF(this.copyOp.clipboardText)};return e})();t.CutCopyPasteManager=l;var c=function(){var e=this;this.GetMimeType=function(){return null!=window.clipboardData&&null!=window.clipboardData.getData?"text":Sys.Browser.agent==Sys.Browser.Safari||Sys.Browser.agent==Sys.Browser.AppleWebKit?"text/plain":Sys.Browser.agent==Sys.Browser.Firefox?"text/unicode":"text"};this._mimeType=this.GetMimeType();this.SetData=function(t){if(window.clipboardData&&window.clipboardData.setData)window.clipboardData.setData(e._mimeType,t);else{e._clipboardContext={};e._clipboardContext[e._mimeType]=t;if(!f){i.JsGridUtil.Internal.GetFocusElement().addEventListener("copy",e.EventBasedCopy,!1);document.execCommand("copy")}}return!0};this.EventBasedCopy=function(t){t.stopImmediatePropagation();t.stopPropagation();t.preventDefault();t.clipboardData&&t.clipboardData.setData&&t.clipboardData.setData(e._mimeType,e._clipboardContext[e._mimeType])};this.GetData=function(){return null!=window.clipboardData&&null!=window.clipboardData.getData?window.clipboardData.getData(e._mimeType):e._clipboardContext&&e._clipboardContext[e._mimeType]}};t.ClipboardManager=c});
define("aQO",["require","exports","aQo","aPS","aQU","aQw","aQn","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u){"use strict";var a=u.panemgr_9;u=u.tablemgr_9;Object.defineProperty(t,"__esModule",{value:!0});var f={ODB:1725},l=(function(){function e(e,t){this._intDelegateMgr=e;this._styles=t;this._quickEditVisualRefreshFlightEnabled=n.JsGridUtil.Internal.IsFeatureEnabled(f)}e.prototype.OnMouseDown=function(e,t,r,i,o,f){e.preventDefault();this._tableMgr=o;this._selectionMgr=f;this._gridPane=t;this._parentNode=r;this._selDragHandle=i;this._selectionFrames=t.selectionFrames;this._mouseDownPos=n.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e);this._selDragHandlePos=n.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(i);this._finalRange=null;this._fillFrame=document.createElement("div");this._fillFrame.style.cssText="position:absolute;visibility:hidden;overflow:hidden;top:0px;left:0px";if(this._quickEditVisualRefreshFlightEnabled){this._gridPane.tableDiv.classList.add(u.tableHasMouseDown);this._fillFrame.classList.add(a.dragToFillFrame)}else this._fillFrame.style.border=s.StyleUtil.MakeBorderString(2,"solid",this._styles.gridPaneStyle.fillRectBorderColor);this._parentNode.appendChild(this._fillFrame);n.JsGridUtil.Internal.DomElement.GetInstance().SetCapture(i,this.OnMouseMove.bind(this),this.OnMouseUp.bind(this));this.OnMouseMove(e)};e.prototype.OnMouseMove=function(e){var t=this._selectionMgr.GetLastSelectionRangeNormalized(),i=this._selectionMgr.GetLastSelectionType(),s=this._tableMgr.GetRowIdxColIdxFromCoord(e);this._quickEditVisualRefreshFlightEnabled&&i===r.JsGridConstants.SelectionType.RowRange&&(s.colIdx=0);if(null!=s.rowIdx&&null!=s.colIdx){var u=n.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e);if(!(u.x>=this._selDragHandlePos.x&&u.x<=this._selDragHandlePos.x+this._selDragHandle.offsetWidth&&u.y>=this._selDragHandlePos.y&&u.y<=this._selDragHandlePos.y+this._selDragHandle.offsetHeight)){this._bFillHorizVsVert=Math.abs(u.x-this._mouseDownPos.x)>Math.abs(u.y-this._mouseDownPos.y);var f;if(this._bFillHorizVsVert){this._finalRange=new o.Range(Math.min(t.colRange.begin,s.colIdx),Math.max(t.colRange.end,s.colIdx));this._quickEditVisualRefreshFlightEnabled&&i===r.JsGridConstants.SelectionType.RowRange&&(this._finalRange.end=this._finalRange.end-1);f=this._gridPane.GetCellRangeBorderDrawingInfo(t.rowRange,this._finalRange,i)}else{this._finalRange=new o.Range(Math.min(t.rowRange.begin,s.rowIdx),Math.max(t.rowRange.end,s.rowIdx));this._quickEditVisualRefreshFlightEnabled&&i===r.JsGridConstants.SelectionType.RowRange&&(t.colRange.end=t.colRange.end-1);f=this._gridPane.GetCellRangeBorderDrawingInfo(this._finalRange,t.colRange,i)}if(null!=f){if(this._quickEditVisualRefreshFlightEnabled){this._fillFrame.style.left=f.left+"px";this._fillFrame.style.top=f.top+"px";this._fillFrame.style.width=f.width-4+"px";this._fillFrame.style.height=f.height-6+"px";if(n.JsGridUtil.Internal.IsStickyColumnEnabled())if(0===t.colRange.begin){this._fillFrame.classList.add(a.stickyFrame);this._fillFrame.style.zIndex=(r.JsGridConstants.Internal.zIndex.selectionFrame+r.JsGridConstants.Internal.zIndex.stickyZIndex).toString()}else{this._fillFrame.classList.remove(a.stickyFrame);this._fillFrame.style.zIndex=r.JsGridConstants.Internal.zIndex.selectionFrame.toString()}if(i===r.JsGridConstants.SelectionType.CellRange){this._selDragHandle.style.top=f.top+f.height-6+"px";this._gridPane._objBag.RTL.bEnabled?this._selDragHandle.style.left=f.left-2+"px":this._selDragHandle.style.left=f.right-5+"px"}else if(i===r.JsGridConstants.SelectionType.RowRange){this._selDragHandle.style.top=f.top+f.height-8+"px";this._gridPane._objBag.RTL.bEnabled?this._selDragHandle.style.left=f.right-7+"px":this._selDragHandle.style.left=f.left+"px"}for(var l in this._selectionFrames){this._selectionFrames[l].style.visibility="hidden"}}else{this._fillFrame.style.left=f.left-1+"px";this._fillFrame.style.top=f.top-1+"px";this._fillFrame.style.width=f.width-2+"px";this._fillFrame.style.height=f.height-2+"px"}this._fillFrame.style.visibility=""}else this._fillFrame.style.visibility="hidden"}}};e.prototype.OnMouseUp=function(e){if(null!=this._finalRange){this._quickEditVisualRefreshFlightEnabled&&this._gridPane.tableDiv.classList.remove(u.tableHasMouseDown);var t=this.ComputeFillParameters();this.Fill(t.repeatOrigin,t.srcRowRange,t.srcColRange,t.destRowRange,t.destColRange,t.trimmedDestRowRange,t.trimmedDestColRange);this._parentNode.removeChild(this._fillFrame);this._fillFrame=null}};e.prototype.ComputeFillParameters=function(){var e,t,n,r,i,s,u,a=this._selectionMgr.GetLastSelectionRangeNormalized();if(this._bFillHorizVsVert){t=r=s=a.rowRange;i=this._finalRange;var f=a.colRange.begin!==i.begin;e=f?"TR":"TL";var l=a.colRange.Size();n=f?new o.Range(i.end-l+1,i.end):new o.Range(i.begin,i.begin+l-1);u=f?new o.Range(i.begin,i.end-l):new o.Range(i.begin+l,i.end)}else{n=i=u=a.colRange;r=this._finalRange;var c=a.rowRange.begin!==r.begin;e=c?"BL":"TL";var h=a.rowRange.Size();t=c?new o.Range(r.end-h+1,r.end):new o.Range(r.begin,r.begin+h-1);s=c?new o.Range(r.begin,r.end-h):new o.Range(r.begin+h,r.end)}return{repeatOrigin:e,srcRowRange:t,srcColRange:n,destRowRange:r,destColRange:i,trimmedDestRowRange:s,trimmedDestColRange:u}};e.prototype.Fill=function(e,t,n,s,o,u,a){var f=this;if(t.Size()!=s.Size()||n.Size()!=o.Size()){var l,c=this._gridPane.GetGridPaneConverter();this._intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return l=c.GetRecordsInvolved(s.begin,s.Size(),function(t){l=t;e()})},function(){var c=f._gridPane.GetData(l,t,n,!1);f._gridPane.PutData(c,l,r.JsGridConstants.UserAction.Fill,e,u,a,function(){f._selectionMgr.SelectRange(f._gridPane,s.begin,s.end,o.begin,o.end,i.SelectOp.Set,!0,!1)})})}else if(this._quickEditVisualRefreshFlightEnabled)for(var h in this._selectionFrames){this._selectionFrames[h].style.visibility=""}};return e})();t.FillDownManager=l});
define("aQN",["require","exports","aPS","aQo","aPZ","aPY","aQp","aQU","di","bt","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";l=l.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var c=f.Killswitch.isActivated("CAF8B57F-023A-49B5-B7B6-A92006D95286","10/11/2019","Fix several issues with items positioned far off to the left causing RTL bugs."),h=f.Killswitch.isActivated("412EE39D-F6D7-4C5A-ABE0-499D90CC520E","12/09/2019","Fix flashing input on cell click by using hide css styles."),p=f.Killswitch.isActivated("9340DEC3-CF41-4D00-BDD8-2AA84E33D2C2","2/05/2020","Make headers accessible with keyboard only."),d=f.Killswitch.isActivated("E2B8D098-22B3-4FF6-973C-1CA708C3F688","03/06/2020","When changing focus from cell to cell clear contenteditable attribute to fix cursor styles."),v={ODB:1725},m=(function(){function e(e,t,n,r,i,s,o,u,a,f,l){this.FocusElementType={anchor:0,input:1,parentNode:2};this._focusElementType=this.FocusElementType.input;this._bUseInputFocusElementForTextInput=!0;this._supportChromePaste=!0;this._jsGridElementId=e;this._objBag=t;this._fnGetLocStr=r;this._fnIsGridEnabled=i;this._fnIsGridVisible=s;this._selectionMgr=o;this._editMgr=u;this._fnGetCellValue=a;this._fnRetryErrorRows=f;this._fnScrollIntoViewVertically=l;this._parentNode=n;this._outerGridParentNode=n.parentNode;this.Init()}e.prototype.SetView=function(e,t,n,r){this._paneLayout=e;this._gridPane=t;this._pivotedGridPane=n;this._gridFieldMap=r;this._ariaMgr.NotifyViewChange()};e.prototype.Dispose=function(){r.JsGridUtil.ClearEventListeners(this._skippedGridContentElement);this._focusElement.removeEventListener("focus",this.OnFocus);this._focusElement.removeEventListener("paste",this.onPaste);this._focusElement.removeEventListener("keydown",this.OnKeyDown);this._focusElement.removeEventListener("keypress",this.OnKeyPress);this._focusElement.removeEventListener("keyup",this.OnKeyUp);this._focusElement=this._skippedGridContentElement=null};e.prototype.Focus=function(){try{this._editMgr.IsEditing()&&this._editMgr.StopEditing(!1);this.SetStyleForFocusElementInput(!0)}catch(e){r.JsGridUtil.DebugAssert(!1,"The grid cannot be focused because it is hidden. Possible scenario: if the grid was editable, it might have been in edit; call grid.NotifyHide() or hide the grid using the fnContinue of grid.FinalizeEditing(fnContinue, fnError).")}};e.prototype.GetFocusElementForTextInput=function(e){return!this._bUseInputFocusElementForTextInput||this._focusElementType!=this.FocusElementType.input||e!=i.EditControlType.EditBox&&e!=i.EditControlType.PeoplePicker&&e!=i.EditControlType.LocationPicker?null:this._focusElement};e.prototype.ChangeTextInputElementToFocusElement=function(){if(this.FocusElementIsBeingUsedForTextInput()){this._focusElement.blur();this.SetStyleForFocusElementInput();return!0}return!1};e.prototype.HandleKeyDown=function(e,t){var i=this,a=e.ctrlKey&&!e.altKey&&!e.shiftKey,f=!e.ctrlKey&&e.altKey&&!e.shiftKey,l=!e.ctrlKey&&!e.altKey&&e.shiftKey,c=!e.ctrlKey&&e.altKey&&e.shiftKey,h=e.ctrlKey&&!e.altKey&&e.shiftKey,d=!e.ctrlKey&&!e.altKey&&!e.shiftKey,m=this._selectionMgr.GetFocus();if(!this._fnIsGridEnabled()||null==m)return!1;var g=m.gridPane,y=g.GetGridPaneConverter();if((function(){if(null==i._curFocusedDisplayControlInfo)return!1;if(e.target==i._curFocusedDisplayControlInfo.DOMElement&&(e.keyCode==n.JsGridConstants.Key.tab||e.keyCode==n.JsGridConstants.Key.shift)){if(e.keyCode==n.JsGridConstants.Key.tab){d?i._curFocusedDisplayControlInfo.DOMElement=i._curFocusedDisplayControlInfo.displayControl.FocusNext(i._curFocusedDisplayControlInfo.displayControlContent,i._curFocusedDisplayControlInfo.DOMElement):l&&(i._curFocusedDisplayControlInfo.DOMElement=i._curFocusedDisplayControlInfo.displayControl.FocusPrevious(i._curFocusedDisplayControlInfo.displayControlContent,i._curFocusedDisplayControlInfo.DOMElement));null==i._curFocusedDisplayControlInfo.DOMElement&&i.Focus()}return!0}i.Focus();return!1})()){r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}if(e.keyCode==n.JsGridConstants.Key.IMEInput&&g.TryBeginEdit(e))return!0;var b=(function(){if(e.keyCode==n.JsGridConstants.Key.esc){i._objBag.cutcopypasteMgr.CancelMode();i._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnRowEscape,r.JsGridUtil.EventArgs.OnRowEscape(m.recordKey));return!0}return!1})()||(function(){var t=function(e){var t=i._objBag.jsGridObj.GetContiguousRowSelectionWithoutEntryRecords(),n=null!=t?t.keys:[];if(n.length>0)if(e){if(i._objBag.jsGridObj.CanMoveRecordsDownByOne(n)){i._objBag.jsGridObj.MoveRecordsDownByOne(n);return!0}}else if(i._objBag.jsGridObj.CanMoveRecordsUpByOne(n)){i._objBag.jsGridObj.MoveRecordsUpByOne(n);return!0}};switch(e.keyCode){case n.JsGridConstants.Key.del:if(d||a){if(i._objBag.editUtil.IsEditingEnabled()){var r=i._objBag.jsGridObj.GetSelectedRowRanges();d&&0==r.length?(function(){var e=i._objBag.tableCache.GetCachedRecord(m.recordKey);null==e&&(e=i._objBag.jsGridObj.GetRecord(m.recordKey));if(null!=e&&i._objBag.editUtil.CanEditField(e,y.GetColumnByIdx(m.colIdx),m.fieldKey)){var t=o.CreateUnvalidatedPropertyUpdate(m.recordKey,m.fieldKey,null,!0);i._objBag.jsGridObj.UpdateProperties([t],n.JsGridConstants.UserAction.UserEdit)}})():i._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.DeleteRecords)}else alert(i._fnGetLocStr("GridNotEditable"));return!0}break;case n.JsGridConstants.Key.insert:if(d){i._objBag.editUtil.IsEditingEnabled()?i._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.InsertRecord):alert(i._fnGetLocStr("GridNotEditable"));return!0}break;case n.JsGridConstants.Key.down:if(f){g.ScrollCellIntoView(m.rowIdx,m.colIdx);var u=g.GetCellByIdx(m.rowIdx,m.colIdx);null!=u&&null!=u.GetRecord()&&i._editMgr.IsBound()&&i._editMgr.ExpandNextActor();return!0}if(c)return t(!0);break;case n.JsGridConstants.Key.up:if(f){(function(){g.ScrollCellIntoView(m.rowIdx,m.colIdx);var e=g.GetCellByIdx(m.rowIdx,m.colIdx);if(null!=e){var t=(function(e){var t=e.GetColumn(),n=e.GetRecord(),r=e.GetFieldKey();if(null!=n){var o=n.GetProp(r),u=null==o?i._gridFieldMap[r].GetPropType():o.propType;return s.PropertyType.Internal.Property.GetInstance().GetDisplayControlForProperty(u,t.fnGetDisplayControlName&&t.fnGetDisplayControlName(n,r))}return null})(e),n=e.GetTd().childNodes;if(n&&t&&t.FocusNext&&t.FocusPrevious){var r=t.FocusNext(n,null);if(null!=r){i._curFocusedDisplayControlInfo={};i._curFocusedDisplayControlInfo.displayControl=t;i._curFocusedDisplayControlInfo.displayControlContent=n;i._curFocusedDisplayControlInfo.DOMElement=r;i._focusElementType==i.FocusElementType.input&&i._parentNode.addEventListener("keydown",i.OnKeyDown.bind(i))}}}})();return!0}if(c)return t(!1);break;case n.JsGridConstants.Key.right:if(c){i._objBag.editUtil.IsEditingEnabled()?i._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.IndentRecords):alert(i._fnGetLocStr("GridNotEditable"));return!0}break;case n.JsGridConstants.Key.left:if(c){i._objBag.editUtil.IsEditingEnabled()?i._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.OutdentRecords):alert(i._fnGetLocStr("GridNotEditable"));return!0}break;case n.JsGridConstants.Key.comma:if(h)return g.TryShiftColumnSelectionGroup(m.rowIdx,m.colIdx,-1);break;case n.JsGridConstants.Key.dot:if(h)return g.TryShiftColumnSelectionGroup(m.rowIdx,m.colIdx,1);break;case n.JsGridConstants.Key.back_slash:if(f)return g.ExpandColumnMenu(m.colIdx);if(h){i._fnRetryErrorRows();return!0}break;case n.JsGridConstants.Key.F2:if(d)return g.TryBeginEdit(e)}return!1})()||(function(){var t=r.JsGridUtil.Internal.IsFeatureEnabled(v)?-1:0,s=function(r,s){switch(e.keyCode){case n.JsGridConstants.Key.enter:if(d)null!=r&&r++;else{if(!l)return null;null!=r&&--r}break;case n.JsGridConstants.Key.down:if(!(d||l||a||h))return null;e.ctrlKey?r=y.GetVirtualRowCount()-1:null!=r&&r++;break;case n.JsGridConstants.Key.up:if(!(d||l||a||h))return null;e.ctrlKey?r=0:null!=r&&r--;break;case n.JsGridConstants.Key.pageDown:if(!d&&!l)return null;if(null!=r){o=(o=y.RowIdxToRelRowIdx(r))!==(u=y.GetWholeRowDisplayCapacity()-1)?u:2*u;r=y.RelRowIdxToRowIdx(o)}break;case n.JsGridConstants.Key.pageUp:if(!d&&!l)return null;if(null!=r){var o=y.RowIdxToRelRowIdx(r),u=y.GetWholeRowDisplayCapacity()-1;o=0!==o?0:-u;r=y.RelRowIdxToRowIdx(o)}break;case n.JsGridConstants.Key.home:if(!(d||l||a||h))return null;s=0;e.ctrlKey&&(r=0);break;case n.JsGridConstants.Key.end:if(!(d||l||a||h))return null;s=y.GetVirtualColumnCount()-1+t;e.ctrlKey&&(r=y.GetVirtualRowCount()-1+t);break;case n.JsGridConstants.Key.right:if(!d&&!l)return null;if(null!=s){s+=i._objBag.RTL.bEnabled?-1:1;s=y.GetVirtualColumnCount()-1!==s||i._objBag.RTL.bEnabled?s:s+t}break;case n.JsGridConstants.Key.left:if(!d&&!l)return null;if(null!=s){s-=i._objBag.RTL.bEnabled?-1:1;s=y.GetVirtualColumnCount()-1===s&&i._objBag.RTL.bEnabled?s+t:s}break;case n.JsGridConstants.Key.six:if(!h)return null;s=0;r=y.GetVirtualRowCount()-1;break;default:return null}if(null!=r){p||-1===Math.min(y.GetVirtualRowCount()-1,r)&&i._gridPane.SetFocusToHeader(s+1);r=Math.max(0,Math.min(y.GetVirtualRowCount()-1,r))}null!=s&&(s=Math.max(0,Math.min(y.GetVirtualColumnCount()-1,s)));return{rowIdx:r,colIdx:s}};if(a||f||l||c||d||h)if(e.keyCode==n.JsGridConstants.Key.tab){if(null!=(o=(function(n,r){if(e.shiftKey){if(-1==--r){r=y.GetVirtualColumnCount()-1+t;if(-1==--n)return null}}else if(++r==y.GetVirtualColumnCount()+t){r=0;if(++n==y.GetVirtualRowCount())return null}return{rowIdx:n,colIdx:r}})(m.rowIdx,m.colIdx))){i._selectionMgr.SetFocusByPos(g,o.rowIdx,o.colIdx);return!0}}else if(!e.shiftKey||l&&e.keyCode==n.JsGridConstants.Key.enter){if(null!=(o=s(m.rowIdx,m.colIdx))){i._selectionMgr.SetFocusByPos(g,o.rowIdx,o.colIdx);return!0}}else{var o,b=i._selectionMgr.GetLastSelectionEndpoints();if(null!=(o=s(b.rowIdx2,b.colIdx2))){null!=o.rowIdx&&null!=o.colIdx?g.ScrollCellIntoView(o.rowIdx,o.colIdx):null!=o.rowIdx?i._fnScrollIntoViewVertically(o.rowIdx):null!=o.colIdx&&g.ScrollColumnIntoViewHorizontally(o.colIdx);i._selectionMgr.SelectRange(g,b.rowIdx1,o.rowIdx,b.colIdx1,o.colIdx,u.SelectOp.Set,!1,!1);return!0}}return!1})()||(function(){var t=i._gridPane.GetGridPaneConverter();if(e.keyCode==n.JsGridConstants.Key.tab){if(i._paneLayout==n.JsGridConstants.PaneLayout.GridAndPivotedGrid)if(d){if(g.Id==n.JsGridConstants.PaneId.MainGrid){i._selectionMgr.SetFocusByPos(i._pivotedGridPane,0,0);return!0}}else if(l&&g.Id==n.JsGridConstants.PaneId.PivotedGrid){var r=t.GetVirtualRowCount()-1,s=t.GetVirtualColumnCount()-1;i._selectionMgr.SetFocusByPos(i._gridPane,r,s);return!0}i._selectionMgr.Clear()}else if(e.keyCode==n.JsGridConstants.Key.F6&&!e.ctrlKey&&i._paneLayout==n.JsGridConstants.PaneLayout.GridAndPivotedGrid){if(g.Id==n.JsGridConstants.PaneId.MainGrid){i._selectionMgr.SetFocusByPos(i._pivotedGridPane,i._pivotedGridPane.GetGridPaneConverter().GetTopRowIdxForKey(m.recordKey),0);return!0}if(g.Id==n.JsGridConstants.PaneId.PivotedGrid){i._selectionMgr.SetFocusByPos(i._gridPane,t.GetTopRowIdxForKey(m.recordKey),0);return!0}}return!1})();b||t||(b=(function(){var t=i._objBag.cutcopypasteMgr;if((e.ctrlKey||e.rawEvent&&e.rawEvent.metaKey)&&!e.altKey&&!e.shiftKey)switch(String.fromCharCode(e.keyCode).toUpperCase()){case"X":t.OnCut(g);return!0;case"C":t.OnCopy(g);return!0;case"V":t.OnPaste(g);return!i._supportChromePaste||t.hasClipBoardData()}return!1})()||(function(){var t=g.GetCellByIdx(m.rowIdx,m.colIdx);if(null!=t){var n=t.GetRecord();if(null!=n){var r=t.GetColumn(),o=t.GetFieldKey(),u=i._gridFieldMap[o],a=n.GetProp(o),f=null==a?u.GetPropType():a.propType,l=s.PropertyType.Internal.Property.GetInstance().GetDisplayControlForProperty(f,r.fnGetDisplayControlName&&r.fnGetDisplayControlName(n,o));if(null!=l.OnKeyDown)return l.OnKeyDown(e,i._fnGetCellValue(n,o,f),n,r,u,f,i._objBag.jsGridObj)}}return!1})());b||(b=(function(t){if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&"Y"==String.fromCharCode(e.keyCode).toUpperCase()){var r=g.IsRowHeadersEnabled()?1:0;if(i._paneLayout==n.JsGridConstants.PaneLayout.GridAndPivotedGrid&&g.Id==n.JsGridConstants.PaneId.PivotedGrid){var s=g.GetVisibleColumns().length;i._pivotedGridPane.SetFocusToHeader(s+t+r)}else i._gridPane.SetFocusToHeader(t+r);return!0}return!1})(m.colIdx-g.BeginColIdx()));if(b){r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}!i._editMgr.IsEditing()&&i._selectionMgr.IsOneCellSelected(i._selectionMgr.GetLastSelectionRangeNormalized())&&i._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnSingleCellKeyDown,r.JsGridUtil.EventArgs.SingleCellKeyDown(e,m.recordKey,m.fieldKey));return!1};e.prototype.FocusElementIsBeingUsedForTextInput=function(){return this._editMgr.IsEditing()&&null!=this.GetFocusElementForTextInput(this._editMgr.GetCurrentEditControlName())&&this._editMgr.IsCurrentEditControlUsingGridTextInputElement()};e.prototype.OnFocus=function(){if(!this.FocusElementIsBeingUsedForTextInput()&&this._fnIsGridVisible()){var e=this._selectionMgr.GetFocus();if(null==e){if(null==this._gridPane)return;var t=this._gridPane.GetGridPaneConverter();if(0==t.GetVirtualRowCount())return;this._selectionMgr.SetFocusByPos(this._gridPane,t.GetTopRowIdx(),this._gridPane.GetLeftMostColumnIdx())}else e.gridPane.ShowFocus(!0);if(null!=this._curFocusedDisplayControlInfo){this._curFocusedDisplayControlInfo=null;this._focusElementType==this.FocusElementType.input&&this._parentNode.removeEventListener("keydown",this.OnKeyDown)}}};e.prototype.OnKeyDown=function(e){if(this.FocusElementIsBeingUsedForTextInput())this._editMgr.OnActorKeyDown(e,this._editMgr.GetCurrentEditControlName());else if(this._editMgr.IsEditing()){if(this._focusElementType!=this.FocusElementType.input)return;this._editMgr.StopEditing();this.HandleKeyDown(e)}else this.HandleKeyDown(e)};e.prototype.OnKeyPress=function(e){var t=this;if(!this._editMgr.IsEditing()){var n=this._selectionMgr.GetFocus();if(this._fnIsGridEnabled()&&null!=n){var i=n.gridPane;!r.JsGridUtil.Utility.IsChar(e)||e.altKey||e.ctrlKey||i.TryBeginEdit(e)&&!t.FocusElementIsBeingUsedForTextInput()&&r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)}}};e.prototype.OnKeyUp=function(e){this._editMgr.IsEditing()||this._focusElementType==this.FocusElementType.input&&(this._focusElement.value="")};e.prototype.CreateFocusElement=function(){switch(this._focusElementType){case this.FocusElementType.anchor:this._focusElement=this.CreateFocusElementAnchor();this.CreateSkipGridHtmlElements(this._focusElement,this._focusElement);break;case this.FocusElementType.input:this._focusElement=this.CreateFocusElementInput();this.SetStyleForFocusElementInput();this.CreateSkipGridHtmlElements(this._parentNode,this._parentNode);break;case this.FocusElementType.parentNode:this._focusElement=this.CreateFocusElementParentNode();this.CreateSkipGridHtmlElements(this._parentNode,this._parentNode);break;default:r.JsGridUtil.DebugAssert(!1,"Invalid focus element type")}this._focusElement.addEventListener("paste",this.onPaste.bind(this))};e.prototype.onPaste=function(e){if(!this._supportChromePaste)return!0;var t;e.rawEvent&&(e=e.rawEvent);if(e&&e.clipboardData&&e.clipboardData.types&&e.clipboardData.getData){var n=this._selectionMgr.GetFocus();t=e.clipboardData.getData("text/plain");this._objBag.cutcopypasteMgr.OnPaste(n.gridPane,t);return!1}return!0};e.prototype.CreateFocusElementAnchor=function(){var e=document.createElement("a");e.id=this._jsGridElementId+"_focusElement";e.href="#";this._outerGridParentNode.insertBefore(e,this._parentNode);e.appendChild(this._parentNode);return e};e.prototype.CreateFocusElementInput=function(){var e=document.createElement("input");e.id=this._jsGridElementId+"_focusElement";var t=r.JsGridUtil.Internal.IsFeatureEnabled(v)?l.spGridControlFocusElement:"jsgrid-control-editbox jsgrid-control-focuselement";e.className=t;this._parentNode.insertBefore(e,this._parentNode.firstChild);return e};e.prototype.SetStyleForFocusElementInput=function(e){var t=this,n=this._focusElement.style;if(!h){n.background="transparent";n.borderColor="transparent";n.color="transparent";n.outlineColor="transparent";n.borderWidth="0px";n.outlineWidth="0px";n.outline="none"}n.position="fixed";n.top="0px";n[this._objBag.RTL.left]="-10000px";n[this._objBag.RTL.right]="";this._focusElement.value="";if(e){var i=r.JsGridUtil.Internal.GetScrollParent(this._focusElement),s={x:i.scrollLeft+document.body.clientWidth/3,y:i.scrollTop+document.body.clientHeight/3};if(null!=s){n.top=String(s.y)+"px";c?n.left=String(s.x)+"px":n[this._objBag.RTL.left]=String(s.x)+"px"}this._focusElement.focus();null!=s&&window.setTimeout(function(){n.top="0px";c?n.left="-10000px":n[t._objBag.RTL.left]="-10000px"},0)}};e.prototype.CreateFocusElementParentNode=function(){this._parentNode.tabIndex=0;return this._parentNode};e.prototype.CreateSkipGridHtmlElements=function(e,t){var i=this,s=document.createElement("a");s.id=this._jsGridElementId+"_skipGridContent";s.href="javascript:;";s.className=c?"ms-accessible ms-acc-button":"ms-accessible-quickedit ms-acc-button";s.onclick=function(){document.getElementById(i._jsGridElementId+"_skippedGridContent").focus()};r.JsGridUtil.Internal.DomElement.GetInstance().SetText(s,SP.JsGrid.Res.skipGridContent);this._outerGridParentNode.insertBefore(s,e);this._skippedGridContentElement=document.createElement("a");this._skippedGridContentElement.id=this._jsGridElementId+"_skippedGridContent";this._skippedGridContentElement.href="javascript:;";this._skippedGridContentElement.className=c?"ms-accessible ms-acc-button":"ms-accessible-quickedit ms-acc-button";this._skippedGridContentElement.onclick=function(){document.getElementById(i._jsGridElementId+"_skipGridContent").focus()};r.JsGridUtil.Internal.DomElement.GetInstance().SetText(this._skippedGridContentElement,SP.JsGrid.Res.backToTopOfGridContent);this._outerGridParentNode.insertBefore(this._skippedGridContentElement,t.nextSibling);this._skippedGridContentElement.addEventListener("keydown",function(e){if(e.shiftKey&&e.keyCode==n.JsGridConstants.Key.tab){if(null==i._selectionMgr.GetFocus()){var t=i._paneLayout==n.JsGridConstants.PaneLayout.GridAndPivotedGrid?i._pivotedGridPane:i._gridPane,r=t.GetGridPaneConverter(),s=r.GetVirtualRowCount()-1,o=r.GetVirtualColumnCount()-1;i._selectionMgr.SetFocusByPos(t,s,o)}}})};e.prototype.Init=function(){r.JsGridUtil.DebugAssert(this._focusElementType==this.FocusElementType.input,"Focus element needs to be an input (see xbrowser+IME support req). This may change only if code branches to use the parentNode or the TDs for More Access. Mode.");this.CreateFocusElement();this._ariaMgr=this._objBag.ariaMgr=new g(this);this._focusElement.addEventListener("focus",this.OnFocus.bind(this));this._focusElement.addEventListener("paste",this.onPaste.bind(this));this._focusElement.addEventListener("keydown",this.OnKeyDown.bind(this));this._focusElement.addEventListener("keypress",this.OnKeyPress.bind(this));this._focusElement.addEventListener("keyup",this.OnKeyUp.bind(this))};return e})();t.FocusManager=m;var g=(function(){function e(e){this._focusMgr=e;this.Init()}e.prototype.Init=function(){this._focusMgr._focusElement.setAttribute("role","grid");var e=document.createElement("label");e.id=this._focusMgr._focusElement.id+"_labelFor";e.setAttribute("for",this._focusMgr._focusElement.id);e.appendChild(document.createTextNode(this._focusMgr._objBag.jsGridObj.name));e.style.cssText="display:none;";this._focusMgr._parentNode.appendChild(e);this._focusMgr._focusElement.setAttribute("aria-label",this._focusMgr._objBag.jsGridObj.name);this._focusMgr._focusElement.setAttribute("aria-labelledby",this._focusMgr._focusElement.id+"_labelFor");this._focusMgr._focusElement.setAttribute("aria-multiselectable","true");this._focusMgr._focusElementType==this._focusMgr.FocusElementType.input&&this._focusMgr._focusElement.setAttribute("aria-owns",this._focusMgr._jsGridElementId)};e.prototype.NotifyViewChange=function(){this.EnableGrid(this._focusMgr._fnIsGridEnabled());this.EnableGridEditing(this._focusMgr._objBag.editUtil.IsEditingEnabled())};e.prototype.EnableGrid=function(e){this._focusMgr._focusElement.setAttribute("aria-disabled",(!e).toString())};e.prototype.EnableGridEditing=function(e){this._focusMgr._focusElement.setAttribute("aria-readonly",(!e).toString())};e.prototype.OnFocusCell=function(e,t,n,r,i){if(null!=t){(s=t.GetTd()).removeAttribute("id");s.removeAttribute("aria-describedby");d||s.removeAttribute("contenteditable");this.SetSelected(s,!1);if(null!=n){(l=n.GetTd()).removeAttribute("id")}}if(null!=r){var s=r.GetTd(),o=a.format("{0}_{1}_{2}_{3}",this._focusMgr._jsGridElementId,e,r.GetRowIdx(),r.GetColIdx());s.setAttribute("id",o);this._focusMgr._focusElement.setAttribute("aria-activedescendant",o);this.SetSelected(s,!0);var u=r.GetRecord(),f=null!=u&&this._focusMgr._objBag.editUtil.CanEditField(u,r.GetColumn(),r.GetFieldKey());s.setAttribute("aria-readonly",(!f).toString());s.setAttribute("contenteditable",f.toString());if(null!=i){var l=i.GetTd(),c=a.format("{0}_{1}_{2}",this._focusMgr._jsGridElementId,e,i.GetColIdx());l.setAttribute("id",c);s.setAttribute("aria-describedby",c)}}else this._focusMgr._focusElement.removeAttribute("aria-activedescendant")};e.prototype.OnInsertTableRow=function(e,t,r){e.setAttribute("role","row");if(null!=t||-1!=r){null!=t&&t!==n.JsGridConstants.Internal.LoadErrorState||e.setAttribute("aria-busy",null==t?"true":"error");var i=this._focusMgr._selectionMgr.GetFocusedPane(),s=this._focusMgr._selectionMgr.IsRowSelected(i,r);this.SetSelected(e,s)}};e.prototype.OnInsertRowHeaderCell=function(e){e.setAttribute("role","presentation")};e.prototype.OnInsertColHeaderCell=function(e){e.setAttribute("scope","col");e.setAttribute("role","columnheader");e.setAttribute("tabindex","0")};e.prototype.OnInsertGridCell=function(e){e.setAttribute("role","gridcell")};e.prototype.SetSelected=function(e,t){e.setAttribute("aria-selected",t.toString())};return e})();t.ARIAManager=g});
define("aQI",["require","exports","mU","aPS","aQo","aQU","aQw","aQn","aQB","aQp","aQL","aQJ","aQT","aPY","a2","bt","X","aPW","OneDriveLightspeedItemsScopeDeferred_mini_css","v"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,E){"use strict";var b=y.tablemgr_9,w=y.panemgr_9;y=y.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var S=v.Killswitch.isActivated("983CF6BF-776A-4753-92FC-1D8F1F1C6DAA","10/17/2019","make quick edit compatible with dark themes"),x=v.Killswitch.isActivated("DF3D86D3-26B1-480B-A71B-8E0F3C310A1A","3/12/2020","update columns after a resize so that pictures fix their size"),T=v.Killswitch.isActivated("FD94E2D1-B4A1-486C-A34E-AF51AEF22FA2","4/13/2020","Prevent unnecessary updates when just clicking on the resize bar without moving"),N={ODB:1725},C={ODB:1439},k=r.JsGridConstants.Internal.zIndex.selectionFrame,L={ChangeHighlight:"jsgrid-changehighlight"},A=(function(){function e(e,t,n,s,o,a,f,l,c,h,p,d,v,m,g,y){this.const_BlurBorderColor="#B0B5BA";this.gridPane=this;this.bIsDisposed=!1;this.focusedColHeaderIndex=0;this.lastClientSize={width:-1,height:-1};this.reorderableRows=new u.Set;this.disposeMap={};this._selectionDragHandleOffset=0;this.Id=r.JsGridConstants.PaneId.MainGrid;this.ExecuteTouchAction=null;this.ShouldUpdateTouchStartPosition=null;this._lastSelectionRangeNormalized=null;this._parentNode=e;this._objBag=t;this.ScrollVerticallyByTouch=s;this._fnNotifyScrollBarVisibilityChange=o;this._commandMgr=a;this._selectionMgr=f;this._changeHighlightMgr=l;this._editMgr=c;this._cutcopypasteMgr=h;this._fillDownMgr=p;this._paneSize=d;this._fnGetCellValue=v;this._fnGetLocStr=m;this._fnRetryErrorRows=g;this.styles=t.styleMgr;this.jsGridObj=t.jsGridObj;this.delegateMgr=t.delegateMgr;this.ariaMgr=t.ariaMgr;this.selectionDragHandle=y.selectionDragHandle;this.selectionFrames=y.selectionFrames;this.focusFrames=y.focusFrames;this.copyFrames=y.copyFrames;this.quickEditVisualRefreshFlightEnabled=i.JsGridUtil.Internal.IsFeatureEnabled(N);this._cellsWithBorder=[];this._cellsWithCopyBorder=[];this.Init()}e.prototype.GetDelegateMgr=function(){return this.delegateMgr};e.prototype.SetEventSinks=function(e){};e.prototype.GetLeftMostColumnIdx=function(){return this.horizScrollBar.GetTopItemIdx()};e.prototype.GetLeftMostColHeaderIdx=function(){return-1};e.prototype.Dispose=function(){this.bIsDisposed=!0;null!=this.disposeRenderedObjectsJobKey&&i.JsGridUtil.AsynchronousCellUpdater.GetInstance().FlushJob(this.disposeRenderedObjectsJobKey);this.gridPane.ClearView();i.JsGridUtil.ClearEventListeners(this._parentNode);i.JsGridUtil.ClearEventListeners(this.tableDiv);this.mouseHandlers.Dispose();this.headerMgr.Dispose();this.tableMgr.Dispose();this.horizScrollBar.Dispose();this._paneSize.Dispose();this.tableDiv=this.selectionDragHandle=this.selectionFrames=this.focusFrames=this.copyFrames=this.ghostHeader=this.ghostHeader.textDiv=this.columnDropIndic=this.ghostCells=this.rowDropIndic=this._parentNode=null};e.prototype.ClearView=function(){this.UpdatePositionedElements();this.mouseHandlers.ClearHeaderEvents();this.tableMgr.ClearTable()};e.prototype.SetView=function(e,t,n,r,i,s,o,u,a,f,l,c){var h=Math.max(0,this._paneSize.GetHeight()-this.GetEffectiveHorizontalScrollBarHeight());this.operationalUtil=t;this.fnGetGridRowStyleId=i;this.bMovableColumns=s;this.bResizableColumns=o;this.bHidableColumns=u;this.bSortableColumns=a;this.bAutoFilterableColumns=f;this.bRowHeadersEnabled=l;this.gridFieldMap=r;this.tableMgr.SetPosConverterObj(e);this._selectAllCell=this.tableMgr.InitTable(this.bRowHeadersEnabled);this.InitColumns(n,!0);var p=this._paneSize.GetWidth();this.horizScrollBar.Update({physicalViewportSize:p-this.tableMgr.GetRowHeaderWidth(),scrollbarSize:p,topItemIdx:0,bScrollNotifiy:!1});this.RecomputeTableViewportRelativeToParentNode(h);this.mouseHandlers.SetupHeaderEvents()};e.prototype.GetGridPaneConverter=function(){return this.paneConverter};e.prototype.ShowFocus=function(e){this.UpdateSelectionFrames(!e)};e.prototype.OnResize=function(){var e={width:this._paneSize.GetWidth(),height:this._paneSize.GetHeight()};if(e.width!==this.lastClientSize.width||e.height!==this.lastClientSize.height){this.tableMgr.OptimizeTableColumns();var t=this._paneSize.GetWidth();this.horizScrollBar.Update({physicalViewportSize:t-this.tableMgr.GetRowHeaderWidth(),scrollbarSize:t});this.UpdatePositionedElements();this._editMgr.NotifyMove(this.gridPane);this.lastClientSize=e}};e.prototype.SetRowHeight=function(e){this.rowHeight=e;this.tableMgr.SetRowHeight(this.rowHeight)};e.prototype.GetMinRowHeight=function(){return 30};e.prototype.SpliceRows=function(e,t,n,r,i){this.tableMgr.SpliceRows(e,t,n,r);null!=this.activeRowIdx&&this.activeRowIdx>=e&&this.activeRowIdx<=e+t-1&&(this.activeRowIdx=null);i?this.ResetSelection():this.UpdatePositionedElements(!0)};e.prototype.SetSortState=function(e){this.headerMgr.SetSortState(e)};e.prototype.SetFilterState=function(e){this.headerMgr.SetFilterState(e)};e.prototype.NotifyCanEditUpdated=function(){this.BindEditControl();this.UpdateSelectionFrames(!1)};e.prototype.NotifyCopyOperationUpdated=function(){this.UpdateCopyFrames(!0);this.HideSelectionFrames()};e.prototype.UpdateFocusAfterInsertOrDeleteRows=function(e,t,n){var r=this._selectionMgr.GetFocusForPane(this.gridPane);null!=r&&(n?r.rowIdx>=e&&this._selectionMgr.SetFocusByPos(this.gridPane,r.rowIdx+t,r.colIdx):r.rowIdx>=e&&r.rowIdx<e+t?this._selectionMgr.SetFocusByPos(this.gridPane,Math.max(e-1,0),r.colIdx):r.rowIdx>=e+t&&this._selectionMgr.SetFocusByPos(this.gridPane,r.rowIdx-t,r.colIdx))};e.prototype.ChangeKeys=function(e,t){this.tableMgr.ChangeKeys(e,t)};e.prototype.RenderRows=function(e){this.bIsDisposed||this.tableMgr.RenderRows(e)};e.prototype.NotifyChangeIndicatorsClearing=function(){for(var e=this.tableMgr.GetAllDataCells(),t=0;t<e.length;t++){var n=e[t];null!=n.GetRecord()&&this._changeHighlightMgr.IsCellIn(n.GetRecordKey(),n.GetFieldKey())&&this.RefreshCellStyle(n,!0,!1)}};e.prototype.Select=function(e,t,n,r,i){this._selectionMgr.SelectRange(this.gridPane,e,t,n,r,i?s.SelectOp.Append:s.SelectOp.Set,!0,!1)};e.prototype.SelectByKey=function(e,t,n,r,i){var s,o,u,a;if(null!=e&&null!=t){s=null!=n?this.paneConverter.KeyToIdx(e,n).rowIdx:this.paneConverter.GetTopRowIdxForKey(e);o=null!=r?this.paneConverter.KeyToIdx(t,r).rowIdx:this.paneConverter.GetTopRowIdxForKey(t)}if(null!=n&&null!=r){u=this.paneConverter.FieldKeyToColIdx(n);a=this.paneConverter.FieldKeyToColIdx(r)}this.Select(s,o,u,a,i)};e.prototype.NotifySelectionUpdating=function(){var e={rowRange:new u.Range(this.tableMgr.BeginRowIdx(),this.tableMgr.EndRowIdx()-1),colRange:new u.Range(this.tableMgr.BeginColIdx(),this.tableMgr.EndColIdx()-1)};return{visibleRanges:e,clearedCells:this._selectionMgr.GetComponentsWithin(this.gridPane,e.rowRange,e.colRange),oldFocus:this._selectionMgr.GetFocusForPane(this.gridPane)}};e.prototype.ScrollCellIntoView=function(e,t){var n=this.gridPane.GetCellByIdx(e,t);if(n){var r=n.GetTd();if(r){var s=r.offsetTop,o=r.offsetLeft,u=r.offsetHeight,a=r.offsetWidth,f=document.getElementById("s4-workspace"),l=i.JsGridUtil.Internal.GetScrollParent(r);if(l){if(f){s-=i.JsGridUtil.Internal.DOM_AbsTop(f);o-=i.JsGridUtil.Internal.DOM_AbsLeft(f);l=f}s<l.scrollTop?l.scrollTop=s-45:s+u>l.scrollTop+l.clientHeight-10&&(l.scrollTop=s+u+45-l.clientHeight);this._objBag.RTL.bEnabled?this._objBag.RTL.bEnabled&&(i.JsGridUtil.Internal.DomElement.GetInstance().BrowserIsIE?o<0&&(0==l.scrollLeft||l.scrollLeft>0&&Math.abs(o)>l.scrollLeft)?l.scrollLeft=Math.abs(o+45):l.clientWidth-o-a<l.scrollLeft&&(l.scrollLeft=l.clientWidth-o-a-45):o<l.scrollLeft?l.scrollLeft=o-45:o+a>l.scrollLeft+l.clientWidth+i.JsGridUtil.Internal.DOM_AbsLeft(this.tableDiv)&&(l.scrollLeft=o+a+45-(l.clientWidth+i.JsGridUtil.Internal.DOM_AbsLeft(this.tableDiv)))):o<l.scrollLeft?l.scrollLeft=o-45:o+a>l.scrollLeft+l.clientWidth&&(l.scrollLeft=o+a+45-l.clientWidth)}}}return!1};e.prototype.GetCellByIdx=function(e,t){return this.tableMgr.GetCellByIdx(e,t)};e.prototype.NotifySelectionUpdated=function(e,t){var n=this,r=this._selectionMgr.GetFocusForPane(this.gridPane),s=this._selectionMgr.GetComponentsWithin(this.gridPane,e.visibleRanges.rowRange,e.visibleRanges.colRange),u=function(e,t){if(n._objBag.editUtil.IsEditingEnabled()&&n._objBag.editUtil.CanEditField(e.GetRecord(),e.GetColumn(),e.GetFieldKey())){var r=e.GetTd(),s=n.quickEditVisualRefreshFlightEnabled?y.msGridCellSelectedEditable:"ms-jsgrid-cell-selected-editable";t?i.JsGridUtil.Internal.AddCssClass(r,s):i.JsGridUtil.Internal.RemoveCssClass(r,s)}};(function(e,t,r,s){var o=e.SymmetricDifference(t),u=function(e){var t=n.tableMgr.GetCellByIdx(e.rowIdx,e.colIdx);null!=t?n.RefreshCellStyle(t,!1,!0):n.ApplyGridComputedCellStyle(e.recordKey,e.fieldKey,null,!1)};if(null!=r){o.Remove(i.JsGridUtil.Internal.MakeCellKey(r.rowIdx,r.colIdx));u(r)}if(null!=s){o.Remove(i.JsGridUtil.Internal.MakeCellKey(s.rowIdx,s.colIdx));u(s)}for(var a in o.GetCollection()){var f=i.JsGridUtil.Internal.CrackCellKey(a),l=n.tableMgr.GetCellByIdx(f.rowIdx,f.colIdx);null!=l&&n.RefreshCellStyle(l,!1,!0)}})(e.clearedCells,s,e.oldFocus,r);(function(){var e;e=n.tableMgr.GetColumnHeaders();if(n.quickEditVisualRefreshFlightEnabled)for(var t=0;t<e.length-1;t++)n.headerMgr.ApplyHeaderClassnames(e[t]);else for(t=0;t<e.length;t++)n.headerMgr.ApplyHeaderStyle(e[t].GetTd(),n.GetHeaderStyle(e[t].GetColIdx(),!1),e[t].GetColIdx()==n.activeColIdx);e=n.tableMgr.GetRowHeaders();for(t=0;t<e.length;t++){var r=e[t].GetTd();n.quickEditVisualRefreshFlightEnabled||o.StyleUtil.ApplyRowHeaderStyle(r,n.GetHeaderStyle(e[t].GetRowIdx(),!0),n.GetRowHeaderSibling);var i=n._selectionMgr.IsRowSelected(n.gridPane,e[t].GetRowIdx());if(n.quickEditVisualRefreshFlightEnabled&&i){r.classList.add(b.cellIsSelected);r.parentNode.classList.add(b.rowIsSelected)}else{r.classList.remove(b.cellIsSelected);r.parentNode.classList.remove(b.rowIsSelected)}n.ariaMgr.SetSelected(r.parentNode,i)}})();var a,f,l,c,h=!1;r&&t&&(h=this.gridPane.ScrollCellIntoView(r.rowIdx,r.colIdx));h||this.UpdatePositionedElements();this.BindEditControl();if(this.quickEditVisualRefreshFlightEnabled)for(var p in this.copyFrames)for(var d in this.copyFrames[p])"Fore"===p&&this.copyFrames[p][d].classList.add(w.dashedBorderUnfocused);if(null!=e.oldFocus){a=this.tableMgr.GetCellByIdx(e.oldFocus.rowIdx,e.oldFocus.colIdx);f=this.tableMgr.GetColumnHeader(e.oldFocus.colIdx);null!=a&&u(a,!1)}if(null!=r){l=this.tableMgr.GetCellByIdx(r.rowIdx,r.colIdx);c=this.tableMgr.GetColumnHeader(r.colIdx);null!=l&&u(l,!0)}this.ariaMgr.OnFocusCell(this.Id,a,f,l,c)};e.prototype.GetMinHeaderHeight=function(){return 31};e.prototype.SetHeaderHeight=function(e){this.tableMgr.SetHeaderHeight(e)};e.prototype.ScrollColumnIntoViewHorizontally=function(e){if(e<=this.tableMgr.BeginColIdx())return this.horizScrollBar.Update({topItemIdx:e});var t=this.tableMgr.GetColumnHeader(e),n=t&&t.GetTd(),r=n&&(this._objBag.RTL.bEnabled?this.tableMgr.GetTdCoords(n).left<0:this.tableMgr.GetTdCoords(n).right>this._paneSize.GetWidth());if(!n||r){for(var i=this.tableMgr.GetSelectAllSquare()?this.tableMgr.GetSelectAllSquare().GetTd().offsetWidth:0,s=this._paneSize.GetWidth()-i-this.paneConverter.GetColumnByIdx(e).width;e>0&&(s-=this.paneConverter.GetColumnByIdx(e-1).width)>=0;e--);return this.horizScrollBar.Update({topItemIdx:e})}return!1};e.prototype.NotifyUpdateProperty=function(e,t,n,i,s,o){n&&this._changeHighlightMgr.AddCell(e,t);var u=this.tableMgr.GetCellByKey(e,t);if(null!=u){null!=i&&s==r.JsGridConstants.ValidationState.Valid&&this._editMgr.NotifyUpdateProperty(this,e,t,i,o);this.tableMgr.RefreshCell(u);this.UpdatePositionedElements();this._editMgr.NotifyMove(this.gridPane)}};e.prototype.BeginRowIdx=function(){return this.tableMgr.BeginRowIdx()};e.prototype.BeginColIdx=function(){return this.tableMgr.BeginColIdx()};e.prototype.ShowColumn=function(e,t){null==this.paneConverter.GetColumnByKey(e)&&this.ShowColumnInternal(this.allColumns.GetColumnByKey(e),t)};e.prototype.HideColumn=function(e){var t=this.paneConverter.GetColumnByKey(e);null!=t&&this.HideColumnInternal(t)};e.prototype.RenameColumn=function(e,t){this._editMgr.Unbind();this.headerMgr.RenameColumn(e,t)};e.prototype.DeleteColumn=function(e){var t=this.paneConverter.GetColumnByKey(e);if(null!=t){this.HideColumn(t);this.allColumns.RemoveColumn(e)}};e.prototype.UpdateColumns=function(e){this.InitColumns(e,!1)};e.prototype.GetVisibleColumns=function(){for(var e=[],t=this.GetAllColumns().GetColumnArray(),n=0;n<t.length;n++)t[n].isVisible&&e.push({columnKey:t[n].columnKey,width:t[n].width});return e};e.prototype.GetAllColumns=function(){return this.allColumns};e.prototype.GetColumns=function(){for(var e=[],t=this.allColumns.GetColumnArray(),n=0;n<t.length;n++)e.push(t[n]);return e};e.prototype.GetFocusedCell=function(){var e=this._selectionMgr.GetFocusForPane(this.gridPane),t=e&&this.tableMgr.GetCellByIdx(e.rowIdx,e.colIdx);return null!=t&&t.GetCellType()==this.tableMgr.CellType.Cell?t:null};e.prototype.GetData=function(e,t,n,r){for(var i=new Array(t.Size()),s=t.begin;s<=t.end;s++){for(var o=new Array(n.Size()),u=n.begin;u<=n.end;u++){var a;null!=(a=r?this.paneConverter.FullDataIdxToKey(s,u):this.paneConverter.IdxToKey(s,u)).recordKey&&(o[u-n.begin]=this._objBag.editUtil.GetFieldValueForCopy(e[a.recordKey],a.fieldKey))}i[s-t.begin]=o}return{matrix:i,height:t.Size(),width:n.Size()}};e.prototype.PutData=function(e,t,n,s,o,u,l,c){var h=this,p=new Array(o.Size()*u.Size()),d=e.height,v=e.width,m=-o.begin+("TL"==s||"TR"==s?0:d-o.Size()%d),g=-u.begin+("TL"==s||"BL"==s?0:v-u.Size()%v),y=this._objBag.controller.CreateDataUpdateCmd(!0),b=y.GetChangeKey();this._objBag.commandMgr.Execute(y,n,a.CommandManagerConstants.CommandType.Explicit);var w=o.begin,E=o.begin,S=o.Size()*u.Size(),x=0;this._objBag.intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.DoLargeTask,S,100,function(n,r){for(var s;E<=o.end;){s=!1;for(var a=u.begin;a<=u.end;a++){var l=h.paneConverter.IdxToKey(w,a);if(h._objBag.editUtil.CanEditField(c?h._objBag.entryRecordMgr.GetEntryRecord(l.recordKey):t[l.recordKey],h.paneConverter.GetColumnByIdx(a),l.fieldKey)){var y=i.JsGridUtil._locationFilldownKillswitchIsActive||!h._objBag.controller.GetPropType(l.recordKey,l.fieldKey).ForceDataCopy;p[x++]=f.CreateUnvalidatedPropertyUpdate(l.recordKey,l.fieldKey,e.matrix[(E+m)%d][(a+g)%v],y);!s&&c&&l.recordKey==h._objBag.entryRecordMgr.GetLastEntryKey()&&h._objBag.entryRecordMgr.CreateEntryRows(1,E!==o.end,b);s=!0}}c&&!s||w++;E++;if((n+=u.Size())>=r)break}return n},function(){x>0&&h._objBag.controller.UpdateProperties(p.slice(0,x),n,b);y.NotifyInitialUpdateComplete();l(w-o.begin)},r.JsGridConstants.Priority.SuperHigh)};e.prototype.FieldKeyToColumnKey=function(e){for(var t=this.allColumns.GetColumnArray(),n=0;n<t.length;n++)if(null!=i.JsGridUtil.Internal.FindInArray(t[n].fieldKeys,function(t){return t==e},null))return t[n].columnKey;return null};e.prototype.EnsurePaneWidth=function(){var e=this.tableMgr.GetTableWidth()+40;e>this.gridPane._paneSize.GetWidth()&&this.gridPane._paneSize.SetValues(e,this.gridPane._paneSize.GetLeftOffset())};e.prototype.ScrollHorizontallyByTouch=function(e){e?this.horizScrollBar.ScrollUpByOne():this.horizScrollBar.ScrollDownByOne()};e.prototype.SetFocusToHeader=function(e){var t=this._objBag.parentNode.id;document.getElementById(t).getElementsByTagName("th")[e+1].focus()};e.prototype.IsRowHeadersEnabled=function(){return this.bRowHeadersEnabled};e.prototype.Init=function(){var e,t=this;this.headerMgr=new c.HeaderManager(this._objBag,this.styles,this._fnGetLocStr,this.UpdatePositionedElements.bind(this));var n=function(n){null!=e&&clearTimeout(e);e=setTimeout(function(){if(!t.bIsDisposed){t.tableMgr.UpdateCoordCache();t.UpdatePositionedElements()}},75)};this.computeGridCellStyleJobKey=i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterJob(this.ApplyGridComputedCellStyle.bind(this));this.computeGridROStyleJobKey=i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterJob(this.ApplyReadOnlyStyle.bind(this));this.disposeRenderedObjectsJobKey=i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterJob(this.DisposeContents.bind(this));this.CreateTopLevelHtmlElements();this.CreateColumnConfigurationHtmlElements();this.tableMgr=new l.TableManager(this.tableDiv,this._parentNode.id,this._paneSize,this._fnGetLocStr,this._objBag,this.OnInsertedRow.bind(this),this.OnInsertedColumns.bind(this),function(){null==t.curColUpdateTimeOut&&(t.curColUpdateTimeOut=setTimeout(t.UpdateFirstDisplayColumn.bind(t),0))}.bind(this),function(e){t.headerMgr.DisposeHeader(e)}.bind(this),function(){},this.BuildCellContent.bind(this),this._fnRetryErrorRows,this.TryDisposeRow.bind(this));this.paneConverter=this.tableMgr.GetGridPaneConverter();this.mouseHandlers=new O(this.gridPane);window.addEventListener("resize",n);this.onResizeHandler=n};e.prototype.CreateTopLevelHtmlElements=function(){this._parentNode.style.verticalAlign="top";this.tableDiv=document.createElement("div");this.tableDiv.style.cssText="position:relative;text-align:"+this._objBag.RTL.left;this.tableDiv.name="tableDiv";this._parentNode.appendChild(this.tableDiv);this.horizScrollBarContainer=document.createElement("div");this.horizScrollBarContainer.style.height=h.GetSystemScrollBarThickness()+"px";this.horizScrollBarContainer.style.display="none";this._parentNode.appendChild(this.horizScrollBarContainer);this.horizScrollBar=new h.ScrollBar(h.ScrollBarType.Horizontal,this.horizScrollBarContainer,!1,{itemSize:100},this.styles.scrollBarStyle,this._objBag.RTL.bEnabled,this._objBag);null!=this._fnNotifyScrollBarVisibilityChange&&this.horizScrollBar.SetOnVisibilityChanged(this.OnHorizontalScrollbarVisibilityChanged.bind(this),!0)};e.prototype.GetEffectiveHorizontalScrollBarHeight=function(){return"none"==this.horizScrollBarContainer.style.display?0:h.GetSystemScrollBarThickness()};e.prototype.OnHorizontalScrollbarVisibilityChanged=function(e){this.horizScrollBarContainer.style.display=e?"":"none";this._fnNotifyScrollBarVisibilityChange(e)};e.prototype.InitColumns=function(e,t){var n=this._selectionMgr.GetFocusForPane(this.gridPane);this.allColumns=e;var r=this.allColumns.GetColumnArray();this.itemSizes=[];for(var i=[],s=0;s<r.length;s++){var o=r[s];this.headerMgr.AdjustColumnWidth(o);this.itemSizes.push(o.width);i.push(o)}this.horizScrollBar.Update({itemCount:i.length,itemSizes:this.itemSizes});this.tableMgr.SetColumns(i,t);if(!t){this.TryRestoreFocusAfterInsertOrDeleteColumns(n);this.UpdatePositionedElements();this._editMgr.NotifyMove(this.gridPane)}};e.prototype.ActivateRow=function(e){null!=this.activeRowIdx&&this.DeactivateRow();this.activeRowIdx=e};e.prototype.DeactivateRow=function(){null!=this.activeRowIdx&&(this.activeRowIdx=null)};e.prototype.ActivateColumn=function(e){if(this.activeColIdx!==e){this.DeactivateColumn();this.activeColIdx=e;this.headerMgr.ApplyHeaderStyle(this.tableMgr.GetColumnHeader(e).GetTd(),this.GetHeaderStyle(e,!1),!0)}var t=this.tableMgr.GetColumnHeader(e),n=t.GetColumn(),r=t.GetTd(),s=n.columnKey,o=this.headerMgr.GetChildObjects(s);PositionCtxImg(o.menu,r);var u=this.getWidthFromPxString(o.menu.style.height);o.menuImg.style.top=(u-6)/2+"px";var a=this.getWidthFromPxString(i.JsGridUtil.Internal.GetCurrentStyle(o.menu,"width","width"));o.menuImg.style.left=(a-9)/2+"px";i.JsGridUtil.Internal.AddCssClass(o.menu,"s4-ctx-show");if(!n.bOpenMenuOnContentClick){o.menu.style.visibility="visible";o.menuImg.style.visibility="visible"}};e.prototype.getWidthFromPxString=function(e){if("string"!=typeof e)return 0;var t=e.trim(),n=Number(t.substring(0,t.length-2).trim());return isNaN(n)?0:n};e.prototype.DeactivateColumn=function(){if(null!=this.activeColIdx&&(null==this.lockedColIdx||this.activeColIdx!==this.lockedColIdx)){var e=this.activeColIdx;this.activeColIdx=null;var t=this.tableMgr.GetColumnHeader(e);null!=t&&this.headerMgr.ApplyHeaderStyle(t.GetTd(),this.GetHeaderStyle(e,!1));var n=this.tableMgr.GetColumnHeader(e).GetColumn().columnKey,r=this.headerMgr.GetChildObjects(n);if(r.menu&&r.menuImg){i.JsGridUtil.Internal.RemoveCssClass(r.menu,"s4-ctx-show");r.menuImg.style.visibility="hidden";r.menu.style.visibility="hidden"}}};e.prototype.CreateColumnConfigurationHtmlElements=function(){this.ghostHeader=document.createElement("table");this.ghostHeader.style.cssText="position:absolute; visibility:hidden; table-layout:fixed;z-index:1;padding-"+this._objBag.RTL.left+":7px;";this.tableDiv.appendChild(this.ghostHeader);this.ghostHeader.cellPadding=this.ghostHeader.cellSpacing=0;var e=this.ghostHeader.insertRow(-1).appendChild(document.createElement("th"));this.ghostHeader.textDiv=e.appendChild(document.createElement("div"));this.ghostHeader.textDiv.style.cssText="text-overflow:none; width:100%; margin-"+this._objBag.RTL.left+":-1px;";this.columnDropIndic=document.createElement("div");this.columnDropIndic.style.cssText="visibility:hidden; width:3px; position:absolute";this.tableDiv.appendChild(this.columnDropIndic);this.rowDropIndic=document.createElement("div");this.rowDropIndic.style.cssText="visibility:hidden; height:3px; background-color:"+this.styles.gridPaneStyle.rowDropIndicatorColor+"; position:absolute";this.tableDiv.appendChild(this.rowDropIndic)};e.prototype.DisposeContents=function(e,t,n){if(n)for(var r=0;r<n.length;r++)n[r]()};e.prototype.ApplyReadOnlyStyle=function(e,t,n){var s=this.tableMgr.GetCellByKey(e,t);if(null!=s&&this._objBag.editUtil.IsEditingEnabled()&&!this._objBag.editUtil.CanEditField(s.GetRecord(),s.GetColumn(),t)&&(null==this.focusedReadOnlyCell||this.focusedReadOnlyCell.rk!==e||this.focusedReadOnlyCell.fk!==t)){if(this._objBag.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState)&&this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState,t)==r.JsGridConstants.ReadOnlyActiveState.ReadOnlyActive)return;var u=o.StyleUtil.MergeCellStyles(n,this.styles.readOnlyCellStyle);if(null!=u.backgroundColor){var a=s.GetTd(),f=i.JsGridUtil.Internal.DomElement.GetInstance().GetComputedStyle(a,"backgroundColor","background-color"),l=a.computedBackgroundColor;a.computedBackgroundColor=u.backgroundColor;this.quickEditVisualRefreshFlightEnabled&&delete u.textColor;if(l!==f){this.ApplyGridComputedCellStyle(e,t,s);delete u.backgroundColor}o.StyleUtil.ApplyCellStyle(s.GetTd(),u)}else o.StyleUtil.ApplyCellStyle(s.GetTd(),u)}};e.prototype.RemoveComputedCellStyles=function(e){for(var t=Object.keys(L),n=0;n<t.length;n++)e.classList.remove(L[t[n]])};e.prototype.ApplyGridComputedCellStyle=function(e,t,n,s){var u,a,f,c=null==n?this.tableMgr.GetCellByKey(e,t):n;if(null!=c){u=c.GetTd();S||this.RemoveComputedCellStyles(u)}if(null!=this.focusedReadOnlyCell&&this.focusedReadOnlyCell.rk==e&&this.focusedReadOnlyCell.fk==t){f=this.focusedReadOnlyCell;this.focusedReadOnlyCell=null}if(null!=u&&null!=c){var h=this.tableMgr.GetRowHeader(c.GetRowIdx()),p=i.JsGridUtil.Internal.DomElement.GetInstance().GetPrevElement(u),d=c.GetRecord();a=c.GetTr();if(this.quickEditVisualRefreshFlightEnabled){u.classList.remove(b.cellIsSelected);u.classList.remove(b.cellIsFocusedAndSelected);h&&h.GetTd()===p&&p.classList.remove(b.cellIsFocusedAndSelected);!l.addNewItemVisualRefreshKillswitchIsActive&&a&&d.bIsNewRow&&a.classList.remove(b.rowIsActive)}var v=this._changeHighlightMgr.IsCellIn(e,t),m=this.paneConverter.KeyToIdx(e,t),g=this._selectionMgr.GetFocusForPane(this.gridPane),y=null!=m&&this._selectionMgr.IsCellSelected(this.gridPane,m.rowIdx,m.colIdx),w=null!=m&&null!=g&&m.rowIdx==g.rowIdx&&m.colIdx==g.colIdx,E=y&&!w,x=null;if(this.quickEditVisualRefreshFlightEnabled&&y&&w){h&&h.GetTd()===p&&p.classList.add(b.cellIsFocusedAndSelected);u.classList.add(b.cellIsFocusedAndSelected)}if(this.quickEditVisualRefreshFlightEnabled&&!l.addNewItemVisualRefreshKillswitchIsActive&&a&&d.bIsNewRow){var T=null!=m&&this._selectionMgr.isRowContainsSelectedCell(this.gridPane,m.rowIdx),N=null!=m&&null!=g&&m.rowIdx==g.rowIdx;T&&N&&a.classList.add(b.rowIsActive)}if(null==u.computedBackgroundColor&&w&&this._objBag.editUtil.IsEditingEnabled()&&!this._objBag.editUtil.CanEditField(c.GetRecord(),c.GetColumn(),c.GetFieldKey())){this.focusedReadOnlyCell={rk:e,fk:t,textColor:null!=f?f.textColor:u.style.color,backgroundColor:null!=f?f.backgroudColor:u.style.backgroundColor};if(!this._objBag.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState)||this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState,t)!==r.JsGridConstants.ReadOnlyActiveState.ReadOnlyActive){u.style.backgroundColor=this.styles.readOnlyFocusedCellStyle.backgroundColor;u.style.color=this.styles.readOnlyFocusedCellStyle.textColor;x=!0}}else if(null!=f){u.style.color=f.textColor;u.style.backgroundColor=f.backgroundColor}if(!x&&(v||E)){var C=u.computedBackgroundColor,k=i.JsGridUtil.Internal.Color.HexStringToColor("transparent"==C||null==C?null!=this.styles.defaultCellStyle.backgroundColor?this.styles.defaultCellStyle.backgroundColor:o.StyleUtil.GetCellStyleDefaultBackgroundColor():C);if(v&&!s){null!=(A=this.styles.gridPaneStyle.changeHighlightCellBgColor)&&(k=A);if(!S){k=null;u.classList.add(L.ChangeHighlight)}}if(E){var A;null!=(A=this.styles.gridPaneStyle.selectedCellBgColor)&&(k=A)}null!=k&&(this.quickEditVisualRefreshFlightEnabled?u.classList.add(b.cellIsSelected):u.style.backgroundColor=i.JsGridUtil.Internal.Color.ColorToHexString(i.JsGridUtil.Internal.Color.RemoveAlphaChannel(k)))}this.ariaMgr.SetSelected(u,y)}};e.prototype.GetCurrentCellStyle=function(e,t,n,i){var s={};i&&(s=o.StyleUtil.MergeCellStyles(this.styles.defaultCellStyle,s));var u,a=null==e;if(a)u=this.gridFieldMap[n].GetPropType();else{var f=e.GetProp(n);u=null!=f?f.propType:null}if(null!=u&&null!=u.GetStyleId){null!=(d=u.GetStyleId(a?null:e.GetDataValue(n)))&&(s=o.StyleUtil.MergeCellStyles(this.styles.GetCellStyle(d),s))}if(!a){var l=this.fnGetGridRowStyleId&&this.fnGetGridRowStyleId(e);if(null!=(l=null!=l?l:this.operationalUtil.GetValue(e,r.JsGridConstants.OperationalConstants.GridRowStyleId))){var c=this.styles.GetCellStyle(l);null!=c&&(s=o.StyleUtil.MergeCellStyles(c,s))}}var h=this.gridFieldMap[n].GetDefaultCellStyleId();null!=h&&(s=o.StyleUtil.MergeCellStyles(this.styles.GetCellStyle(h),s));if(null!=t.fnGetCellStyleId&&!a){var p=t.fnGetCellStyleId(e,n,e.HasDataValue(n)?e.GetDataValue(n):null);if(null!=p){var d;null!=(d=this.styles.GetCellStyle(p))&&(s=o.StyleUtil.MergeCellStyles(d,s))}}return s};e.prototype.RefreshCellStyle=function(e,t,n){var r=e.GetRecord(),s=e.GetColumn(),u=e.GetFieldKey(),a=e.GetTd(),f=null!=r?r.recordKey:e.GetRecordKey();""!==a.style.backgroundColor&&(a.style.backgroundColor="");var l=this.GetCurrentCellStyle(r,s,u,!1);if(!i.JsGridUtil.Internal.IsAssocArrayEmpty(l)){o.StyleUtil.ApplyCellStyle(a,l);if(null!=this.focusedReadOnlyCell&&this.focusedReadOnlyCell.rk==f&&this.focusedReadOnlyCell.fk==u){this.focusedReadOnlyCell.textColor=null!=l.textColor?l.textColor:null!=this.styles.defaultCellStyle.textColor?this.styles.defaultCellStyle.textColor:"";this.focusedReadOnlyCell.backgroundColor=null!=l.backgroundColor?l.backgroundColor:null!=this.styles.defaultCellStyle.backgroundColor?this.styles.defaultCellStyle.backgroundColor:""}}a.computedBackgroundColor=l.backgroundColor;n?this.ApplyGridComputedCellStyle(f,u,e,t):i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterCell(this.computeGridCellStyleJobKey,f,u);this._objBag.editUtil.IsEditingEnabled()&&i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterCell(this.computeGridROStyleJobKey,f,u);return l};e.prototype.ResetSelection=function(){var e=this._selectionMgr.GetFocusForPane(this.gridPane);this._objBag.bUpdateCoordCache=!0;null!=e&&this._selectionMgr.SelectRange(this.gridPane,e.rowIdx,e.rowIdx,e.colIdx,e.colIdx,s.SelectOp.Set,!1,!1)};e.prototype.BindEditControl=function(){var e=this,t=this._selectionMgr.GetFocusForPane(this.gridPane),n=function(t,n,r,i){if(!e._editMgr.IsBound()&&null!=n&&e._objBag.editUtil.CanBindToField(n,r,i)){e.useCustomSelFrames=!1;e._editMgr.BindToCell(e.gridPane,n,r,i,e.gridFieldMap,t,e.RefreshCellStyle(t,!1,!0))}};if(null!=t){var r=this.tableMgr.GetCellByIdx(t.rowIdx,t.colIdx);if(null!=r&&r.GetCellType()==this.tableMgr.CellType.Cell){var i=r.GetRecord(),s=r.GetColumn(),o=r.GetFieldKey();if(!this._editMgr.IsBound()||null!=i&&this._editMgr.IsBoundToCell(this.gridPane,i.key(),o))n(r,i,s,o);else{this.useCustomSelFrames=!1;this._editMgr.Unbind(function(){n(r,i,s,o)})}}}};e.prototype.TryShiftColumnSelectionGroup=function(e,t,n){var s=!1;if(this.bMovableColumns){i.JsGridUtil.DebugAssert(0!==n);var o=this._selectionMgr.GetRowRanges(this.gridPane),u=this._selectionMgr.GetColumnRanges(this.gridPane),f=this._selectionMgr.GetCellRanges(this.gridPane),l=null==o||0==o.length,c=null==u||0==u.length,h=null==f||0==f.length;if(l&&(c||h)&&(c||1==u.length)&&(h||1==f.length)){var p=c?f[0].colRange:u[0],d=n>0?p.end+1:p.begin-1;if(d>=0&&d<this.paneConverter.GetVirtualColumnCount()){for(var v=c?r.JsGridConstants.SelectionType.CellRange:r.JsGridConstants.SelectionType.ColumnRange,m=[this.CreateSingleSelectionCmd(e,t,c?f[0]:u[0],v,!0,!1)],g=p.begin;g<=p.end;g++){var y=d+(n>0?-1:1);m.push(this.CreateMoveColumnCommand(d,y));d=y}var b=n>0?1:-1;p.begin+=b;p.end+=b;t+=b;m.push(this.CreateSingleSelectionCmd(e,t,c?f[0]:u[0],v,!1,!0));this._commandMgr.Execute(new a.AggregateCommand(m,!0),"Column Reorder",a.CommandManagerConstants.CommandType.Explicit);s=!0}}}return s};e.prototype.CreateSingleSelectionCmd=function(e,t,n,i,o,u){var a,f,l,c,h=this;if(i==r.JsGridConstants.SelectionType.ColumnRange){l=n.begin;c=n.end}if(i==r.JsGridConstants.SelectionType.CellRange){l=n.colRange.begin;c=n.colRange.end;a=n.rowRange.begin;f=n.rowRange.end}var p=function(){h._selectionMgr.SetFocusByPos(h.gridPane,e,t);h._selectionMgr.SelectRange(h.gridPane,a,f,l,c,s.SelectOp.Set,!0)};return{Apply:o?function(){}:p,Undo:u?function(){}:p}};e.prototype.RecomputeTableViewportRelativeToParentNode=function(e){this.tableViewportRelativeToParentNode={left:1+this._paneSize.GetLeftOffset(),top:1+this.tableMgr.GetHeaderHeight(),right:1+this._paneSize.GetLeftOffset()+this._paneSize.GetWidth(),bottom:1+e};var t=this.tableMgr.GetRowHeaderWidth()?this.tableMgr.GetRowHeaderWidth():0;this._objBag.RTL.bEnabled?this.tableViewportRelativeToParentNode.right-=t:this.tableViewportRelativeToParentNode.left+=t};e.prototype.GetTdCoordsRelativeToParentNode=function(e){var t;if(null!=e.parentNode){(t=this.tableMgr.GetTdCoords(e)).left+=1+this._paneSize.GetLeftOffset();t.right+=1+this._paneSize.GetLeftOffset();t.top+=1;t.bottom+=1}return t};e.prototype.GetTableViewportRelativeToParentNode=function(){var e=Math.max(this.tableDiv.offsetHeight,400);this.RecomputeTableViewportRelativeToParentNode(e);return this.tableViewportRelativeToParentNode};e.prototype.GetCellRangeBorderDrawingInfo=function(e,t,n){var i,s,o=this.tableMgr.BeginRowIdx(),u=this.tableMgr.EndRowIdx()-1,a=this.tableMgr.BeginColIdx(),f=this.tableMgr.EndColIdx()-1,l=e.begin<o,c=t.begin<a,h=e.begin>u,p=t.begin>f,d=e.end<o,v=e.end>u,m=t.end<a;if(h||p||d||m)return null;i=this.quickEditVisualRefreshFlightEnabled&&n===r.JsGridConstants.SelectionType.RowRange?this._objBag.RTL.bEnabled?this.tableMgr.GetCellByIdx(Math.max(o,e.begin),this._objBag.RTL.bEnabled?Math.min(f,t.end):Math.max(a,t.begin)):this.tableMgr.GetRowHeader(e.begin):this.tableMgr.GetCellByIdx(Math.max(o,e.begin),this._objBag.RTL.bEnabled?Math.min(f,t.end):Math.max(a,t.begin));s=this.quickEditVisualRefreshFlightEnabled&&n===r.JsGridConstants.SelectionType.RowRange&&this._objBag.RTL.bEnabled?this.tableMgr.GetRowHeader(e.end):this.tableMgr.GetCellByIdx(Math.min(u,e.end),this._objBag.RTL.bEnabled?Math.max(a,t.begin):Math.min(f,t.end));var g=this.GetTdCoordsRelativeToParentNode(i.GetTd()),y=this.GetTdCoordsRelativeToParentNode(s.GetTd()),b=this.quickEditVisualRefreshFlightEnabled&&this._objBag.RTL.bEnabled?1:0,w=g.left-b,E=g.top,S=y.right-b,x=v?E+this._paneSize.GetHeight()+1:y.bottom;return{left:w,top:E,right:S,bottom:x,width:S-w-(this.quickEditVisualRefreshFlightEnabled?1:2),height:x-E-(this.quickEditVisualRefreshFlightEnabled?1:2),bBeginsBeforeColumnHeader:l,bBeginsBeforeRowHeader:c}};e.prototype.UpdatePositionedElements=function(e){e&&(this._objBag.bUpdateCoordCache=!0);this.UpdateSelectionFrames(!1);this.UpdateFocusFrames();this.UpdateCopyFrames();this.tableMgr.UpdateErrorFrames()};e.prototype.SetSelectionFrameOnNonTdElement=function(e,t){this.useCustomSelFrames=!0;this.ClearPseudoElementFrame(this._cellsWithBorder,b.cellHasSelectionBorder);this._cellsWithBorder.push(e);e.classList.add(b.selectedEditor);var n=e.getBoundingClientRect();this.PositionGridSelectionDragHandle(t.y+n.height-5,t.x+(n.width-3),"")};e.prototype.PositionGridSelectionFrameAroundNonstandardElement=function(e,t){var n=this.quickEditVisualRefreshFlightEnabled,r={Top:{top:t.y,left:t.x,width:e.width-(n?0:1),zIndex:n?"":k},Bottom:{top:t.y+e.height-1,left:t.x,width:e.width-(n?0:4),zIndex:n?"":k},Right:{top:t.y,left:t.x+e.width-(n?2:1),height:e.height-(n?-1:4),zIndex:n?"":k},Left:{top:t.y,left:t.x,height:e.height-(n?-1:1),zIndex:n?"":k}};this.useCustomSelFrames=!0;this.PositionGridSelectionFrame(r);n?this.PositionGridSelectionDragHandle(t.y+e.height-5,t.x+(e.width-3),""):this.PositionGridSelectionDragHandle(t.y+e.height-1-1,t.x+e.width-1-1,(k+1).toString());this.UnhideSelectionFrames()};e.prototype.PositionGridSelectionFrame=function(e,t){for(var n in this.selectionFrames){this.selectionFrames[n].style.visibility=e[n].visibility;delete e[n].visibility;for(var r in e[n])"zIndex"!==r&&e[n][r]?this.selectionFrames[n].style[r]=e[n][r]+"px":this.selectionFrames[n].style[r]=e[n][r];this.quickEditVisualRefreshFlightEnabled?t?this.selectionFrames[n].classList.add(w.readonlySelectionRect):this.selectionFrames[n].classList.remove(w.readonlySelectionRect):this.selectionFrames[n].style["border"+n]=o.StyleUtil.MakeBorderString(2,"solid",t?this.styles.gridPaneStyle.readonlySelectionRectBorderColor:this.styles.gridPaneStyle.selectionRectBorderColor)}};e.prototype.PositionGridSelectionDragHandle=function(e,t,n){this.selectionDragHandle.style.visibility="";this.selectionDragHandle.style.top=e+"px";this.selectionDragHandle.style.left=t+"px";i.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._selectionDragHandleOffset=t);n&&(this.selectionDragHandle.style.zIndex=n)};e.prototype.HideSelectionFrames=function(e){e||(this.selectionDragHandle.style.visibility="hidden");for(var t in this.selectionFrames)this.selectionFrames[t].style.visibility="hidden"};e.prototype.UnhideSelectionFrames=function(){this.selectionDragHandle.style.visibility="";for(var e in this.selectionFrames)this.selectionFrames[e].style.visibility=""};e.prototype.UpdateDragHandleForScroll=function(e){this.selectionDragHandle.classList.contains(w.stickyHandle)&&(this.selectionDragHandle.style.left=(this._selectionDragHandleOffset-32+Math.max(e.scrollLeft,32)).toString()+"px")};e.prototype.ClearPseudoElementFrame=function(e,t){for(;e.length>0;){e[0].classList.remove(b.readOnlySelectionFrame);e[0].classList.remove(t);e[0].classList.remove(b.cellTopBorder);e[0].classList.remove(b.cellBottomBorder);e[0].classList.remove(b.cellLeftBorder);e[0].classList.remove(b.cellRightBorder);e.splice(0,1)}};e.prototype.ApplyPseudoElementFrame=function(e,t,n,r){var i=E.deepCopy(e.colRange);r&&(i.begin=-1);for(var s=i.begin;s<=i.end;s++){var o=void 0;if(-1!=s)o=this.GetCellByIdx(e.rowRange.begin,s).GetTd();else{o=this.GetCellByIdx(e.rowRange.begin,0).GetTd().previousElementSibling}o.classList.add(b.cellTopBorder);o.classList.add(n);t.push(o);if(-1!=s)o=this.GetCellByIdx(e.rowRange.end,s).GetTd();else{o=this.GetCellByIdx(e.rowRange.end,0).GetTd().previousElementSibling}o.classList.add(b.cellBottomBorder);o.classList.add(n);t.push(o)}for(s=e.rowRange.begin;s<=e.rowRange.end;s++){o=void 0;if(-1!=i.begin)o=this.GetCellByIdx(s,i.begin).GetTd();else{o=this.GetCellByIdx(s,0).GetTd().previousElementSibling}o.classList.add(b.cellLeftBorder);o.classList.add(n);t.push(o);(o=this.GetCellByIdx(s,i.end).GetTd()).classList.add(b.cellRightBorder);o.classList.add(n);t.push(o)}};e.prototype.UpdateSelectionFrames=function(e){var t=this;i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this.ClearPseudoElementFrame(this._cellsWithBorder,b.cellHasSelectionBorder);if(e)(function(){t.selectionDragHandle.style.backgroundColor=t.const_BlurBorderColor;for(var e in t.selectionFrames)t.selectionFrames[e].style.borderColor=t.const_BlurBorderColor})();else if(null!=this._selectionMgr.GetFocusForPane(this.gridPane)&&this.paneConverter.GetVirtualRowCount()&&this.paneConverter.GetVirtualColumnCount()&&this._cutcopypasteMgr.IsSelectionCopyable(this.gridPane)){var n=this._selectionMgr.GetLastSelectionRangeNormalized();if(null!=n){var s=!1;if(this._objBag.editUtil.IsEditingEnabled()&&this._selectionMgr.IsOneCellSelected(n)){var o=this.tableMgr.GetCellByIdx(n.rowRange.begin,n.colRange.begin);null==o||this._objBag.editUtil.CanEditField(o.GetRecord(),o.GetColumn(),o.GetFieldKey())||this._objBag.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState)&&this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState,o.GetFieldKey())===r.JsGridConstants.ReadOnlyActiveState.ReadOnlyActive||(s=!0)}var u=this._selectionMgr.GetLastSelectionType();this.quickEditVisualRefreshFlightEnabled&&u===r.JsGridConstants.SelectionType.RowRange&&(n.colRange.end=n.colRange.end-1);var a=this.gridPane.GetCellRangeBorderDrawingInfo(n.rowRange,n.colRange,u);if(null!=a){var f=this.quickEditVisualRefreshFlightEnabled?a.width:a.width+2+2,l=this.quickEditVisualRefreshFlightEnabled?a.height:a.height+2+2,c=this.quickEditVisualRefreshFlightEnabled?{Top:{left:a.left,top:a.top,width:f,visibility:""},Right:{left:a.right-3,top:a.top,height:l-2,visibility:""},Bottom:{left:a.left,top:a.bottom-5,width:f,visibility:""},Left:{left:a.left,top:a.top,height:l-2,visibility:""}}:{Top:{left:a.left-1,top:a.top-1,width:f-2,visibility:""},Right:{left:a.right-3,top:a.top-1,height:l-2,visibility:""},Bottom:{left:a.left-1,top:a.bottom-3,width:f-2,visibility:""},Left:{left:a.left-1,top:a.top-1,height:l-2,visibility:""}};a.bBeginsBeforeRowHeader&&(c[this._objBag.RTL.Left].visibility="hidden");a.bBeginsBeforeColumnHeader&&(c.Top.visibility="hidden");if(!this.useCustomSelFrames||!this._lastSelectionRangeNormalized||this._lastSelectionRangeNormalized.rowRange&&this._lastSelectionRangeNormalized.colRange&&(this._lastSelectionRangeNormalized.rowRange.IsDifferent(n.rowRange)||this._lastSelectionRangeNormalized.colRange.IsDifferent(n.colRange))){this.selectionDragHandle.style.visibility="hidden";if(this._objBag.editUtil.IsEditingEnabled()&&this._objBag.jsGridParams.tableViewParams.bFillControlEnabled){if(this.quickEditVisualRefreshFlightEnabled){if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&n){this.ApplyPseudoElementFrame(n,this._cellsWithBorder,b.cellHasSelectionBorder,u===r.JsGridConstants.SelectionType.RowRange);s&&n.colRange.begin===n.colRange.end&&n.rowRange.begin===n.rowRange.end&&this._cellsWithBorder[0].classList.add(b.readOnlySelectionFrame)}s?this.selectionDragHandle.classList.add(w.readonlySelectionRect):this.selectionDragHandle.classList.remove(w.readonlySelectionRect);if(u===r.JsGridConstants.SelectionType.RowRange){this.selectionDragHandle.classList.add(w.rowSelectionHandle);this.selectionDragHandle.style.visibility="";this.selectionDragHandle.style.top=a.bottom-9+"px";if(this._objBag.RTL.bEnabled)this.selectionDragHandle.style.left=a.right-7+"px";else{this.selectionDragHandle.style.left=a.left+"px";if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){this._selectionDragHandleOffset=a.left;this.selectionDragHandle.classList.add(w.stickyHandle)}}}else if(u===r.JsGridConstants.SelectionType.CellRange){this.selectionDragHandle.classList.remove(w.rowSelectionHandle);this.selectionDragHandle.style.visibility="";this.selectionDragHandle.style.top=a.bottom-7+"px";if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){this._selectionDragHandleOffset=a.right-5;this.selectionDragHandle.style.left=this._selectionDragHandleOffset+"px";0===n.colRange.begin?this.selectionDragHandle.classList.add(w.stickyHandle):this.selectionDragHandle.classList.remove(w.stickyHandle)}else this._objBag.RTL.bEnabled?this.selectionDragHandle.style.left=a.left-2+"px":this.selectionDragHandle.style.left=a.right-5+"px"}}else{this.selectionDragHandle.style.backgroundColor=s?this.styles.gridPaneStyle.readonlySelectionRectBorderColor:this.styles.gridPaneStyle.selectionRectBorderColor;if(u==r.JsGridConstants.SelectionType.RowRange){this.selectionDragHandle.style.visibility="";this.selectionDragHandle.style.top=a.bottom-3+"px";c[this._objBag.RTL.Left].height-=5;c.Bottom.width-=9;if(this._objBag.RTL.bEnabled)this.selectionDragHandle.style.left=a.right-7+"px";else{this.selectionDragHandle.style.left=a.left+2+"px";c.Bottom.left+=9}}else if(u==r.JsGridConstants.SelectionType.ColumnRange);else{this.selectionDragHandle.style.visibility="";this.selectionDragHandle.style.top=a.bottom-4+"px";c[this._objBag.RTL.Right].height-=5;c.Bottom.width-=5;if(this._objBag.RTL.bEnabled){this.selectionDragHandle.style.left=a.left-2+"px";c.Bottom.left+=5}else this.selectionDragHandle.style.left=a.right-4+"px"}}this.PositionGridSelectionFrame(c,s)}}this._lastSelectionRangeNormalized=n;i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this.HideSelectionFrames(!0)}else this.HideSelectionFrames()}else this.HideSelectionFrames()}else this.HideSelectionFrames()};e.prototype.UpdateCopyFrames=function(e){var t=this,n=function(){for(var e in t.copyFrames)for(var n in t.copyFrames[e]){t.copyFrames[e][n].style.visibility="hidden";t.quickEditVisualRefreshFlightEnabled&&"Fore"===e&&t.copyFrames[e][n].classList.remove(w.dashedBorderUnfocused)}};i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this.ClearPseudoElementFrame(this._cellsWithCopyBorder,b.cellHasCopyBorder);var s=this._cutcopypasteMgr.GetLastOperation(),o=this._selectionMgr.GetLastSelectionType();this.quickEditVisualRefreshFlightEnabled&&o===r.JsGridConstants.SelectionType.RowRange&&s&&e&&(s.colRange.end=s.colRange.end-1);var u=null!=s&&s.gridPane==this.gridPane?this.gridPane.GetCellRangeBorderDrawingInfo(s.rowRange,s.colRange,s.selType):null;if(null!=u){i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this.ApplyPseudoElementFrame(s,this._cellsWithCopyBorder,b.cellHasCopyBorder);var a=u.width+2,f=u.height+2,l=this.quickEditVisualRefreshFlightEnabled?{Top:{left:u.left,top:u.top,width:a-2,visibility:""},Right:{left:u.right-3,top:u.top,height:f-4,visibility:""},Bottom:{left:u.left,top:u.bottom-5,width:a-2,visibility:""},Left:{left:u.left,top:u.top,height:f-4,visibility:""}}:{Top:{left:u.left,top:u.top,width:a,visibility:""},Right:{left:u.right-2,top:u.top,height:f,visibility:""},Bottom:{left:u.left,top:u.bottom-2,width:a,visibility:""},Left:{left:u.left,top:u.top,height:f,visibility:""}};u.bBeginsBeforeRowHeader&&(l[this._objBag.RTL.Left].visibility="hidden");u.bBeginsBeforeColumnHeader&&(l.Top.visibility="hidden");for(var c in this.copyFrames)for(var h in this.copyFrames[c])for(var p in l[h]){this.copyFrames[c][h].style[p]="visibility"==p?l[h][p]:l[h][p]+"px";this.quickEditVisualRefreshFlightEnabled&&"Fore"===c&&this.copyFrames[c][h].classList.remove(w.dashedBorderUnfocused);i.JsGridUtil.Internal.IsStickyColumnEnabled()&&(0===s.colRange.begin?this.copyFrames[c][h].classList.add(w.stickyFrame):this.copyFrames[c][h].classList.remove(w.stickyFrame))}i.JsGridUtil.Internal.IsStickyColumnEnabled()&&n()}else n()};e.prototype.UpdateFocusFrames=function(){var e=this,t=function(){for(var t in e.focusFrames)e.focusFrames[t].style.visibility="hidden"},n=this._selectionMgr.GetFocusForPane(this.gridPane);if(null==n||this._cutcopypasteMgr.IsSelectionCopyable(this.gridPane))t();else{var r,s=new u.Range(n.rowIdx,n.rowIdx).Normalize(),o=new u.Range(n.colIdx,n.colIdx).Normalize(),a=this._selectionMgr.GetLastSelectionType();if(null!=(r=this.quickEditVisualRefreshFlightEnabled&&i.JsGridUtil.Internal.IsFeatureEnabled(C)?this.gridPane.GetCellRangeBorderDrawingInfo(s,o,a):this.gridPane.GetCellRangeBorderDrawingInfo(s,o))){var f=r.width,l=r.height,c=this.quickEditVisualRefreshFlightEnabled?{Top:{left:r.left,top:r.top,width:f},Right:{left:r.right-3,top:r.top,height:l-2},Bottom:{left:r.left,top:r.bottom-5,width:f},Left:{left:r.left,top:r.top,height:l-2}}:{Top:{left:r.left+1,top:r.top+1,width:f},Right:{left:r.right-2,top:r.top+1,height:l},Bottom:{left:r.left+1,top:r.bottom-2,width:f},Left:{left:r.left+1,top:r.top+1,height:l}};for(var h in this.focusFrames){for(var p in c[h])this.focusFrames[h].style[p]=c[h][p]+"px";this.focusFrames[h].style.visibility=""}}else t()}};e.prototype.CreateHideShowColumnCommand=function(e,t,n){var r=this;n=null!=n?n:this.paneConverter.ColKeyToColIdx(t.columnKey);var i=function(){var e=r._selectionMgr.GetFocusForPane(r.gridPane);r.HideImpl(t,n);r.TryRestoreFocusAfterInsertOrDeleteColumns(e);r.UpdatePositionedElements();r._editMgr.NotifyMove(r.gridPane)},s=function(){var e=r._selectionMgr.GetFocusForPane(r.gridPane);r.ShowImpl(t,n);r.TryRestoreFocusAfterInsertOrDeleteColumns(e);r.gridPane.ScrollColumnIntoViewHorizontally(n);r.UpdatePositionedElements();r._editMgr.NotifyMove(r.gridPane)};return"hide"==e?{Apply:i,Undo:s}:{Apply:s,Undo:i}};e.prototype.TryRestoreFocusAfterInsertOrDeleteColumns=function(e){if(null!=e)if(null!=this.paneConverter.KeyToIdx(e.recordKey,e.fieldKey))this._selectionMgr.SetFocusByKey(this.gridPane,e.recordKey,e.fieldKey);else{var t=e.colIdx>=this.paneConverter.GetVirtualColumnCount()?this.paneConverter.GetVirtualColumnCount()-1:e.colIdx;this._selectionMgr.Clear();this._selectionMgr.SetFocusByPos(this.gridPane,e.rowIdx,t)}};e.prototype.HideImpl=function(e,t){this.ResetSelection();this.tableMgr.RemoveColumns(t,1);this.itemSizes.splice(t,1);this.horizScrollBar.Update({itemCount:this.itemSizes.length,itemSizes:this.itemSizes});e.isVisible=!1};e.prototype.ShowImpl=function(e,t){t<this.paneConverter.GetVirtualColumnCount()&&this.gridPane.ScrollColumnIntoViewHorizontally(t);this.ResetSelection();this.headerMgr.AdjustColumnWidth(e);this.tableMgr.InsertColumns(t,[e]);this.itemSizes.splice(t,0,e.width);this.horizScrollBar.Update({itemCount:this.itemSizes.length,itemSizes:this.itemSizes});e.isVisible=!0};e.prototype.HandleUpdateInAllColumns=function(e,t){for(var n=this.allColumns.GetColumnArray(),r=0;r<n.length&&!(r>e&&r>t);r++)if(!n[r].isVisible){r<=e&&e++;r<=t&&t++}i.JsGridUtil.Internal.MoveItemInArray(n,e,t)};e.prototype.CreateMoveColumnCommand=function(e,t){var n=this,r=function(e,t){if(e!==t){var r=n._selectionMgr.GetFocusForPane(n.gridPane),i=n.horizScrollBar.GetTopItemIdx(),s=n.paneConverter.GetColumnByIdx(e);n.HideImpl(s,e);n.ShowImpl(s,t);null!=r&&n._selectionMgr.SetFocusByKey(n.gridPane,r.recordKey,r.fieldKey);n.UpdatePositionedElements();n.horizScrollBar.Update({topItemIdx:i});n.HandleUpdateInAllColumns(e,t);n._editMgr.NotifyMove(n.gridPane)}};return{Apply:function(){r(e,t)},Undo:function(){r(t,e)}}};e.prototype.ShowColumnInternal=function(e,t){if(null==t)for(var n=0,r=this.allColumns.GetColumnArray(),s=0;s<r.length;s++){if(r[s]==e){t=s-n;break}r[s].isVisible||n++}i.JsGridUtil.DebugAssert(null!=t);this._commandMgr.Execute(this.CreateHideShowColumnCommand("show",e,t),"Show Column",a.CommandManagerConstants.CommandType.Implicit)};e.prototype.HideColumnInternal=function(e){1!==this.paneConverter.GetVirtualColumnCount()&&this._commandMgr.Execute(this.CreateHideShowColumnCommand("hide",e,null),"Hide Column",a.CommandManagerConstants.CommandType.Implicit)};e.prototype.MoveColumn=function(e,t){var n=e<t?t-1:t;this._commandMgr.Execute(this.CreateMoveColumnCommand(e,n),"Move Column",a.CommandManagerConstants.CommandType.Explicit)};e.prototype.ExpandColumnMenuInternal=function(e){var t=this,n=function(){t.lockedColIdx=null;t.headerMgr.SetColumnMenuCollapsed(e);t.DeactivateColumn();t._objBag.focusMgr.Focus()};if(null==this.lockedColIdx){var i=this.paneConverter.GetColumnByKey(e);if(null==i)return!1;var s;if(null==(s=this.headerMgr.GetColumnHeaderPosition(e)))return!1;this.lockedColIdx=this.paneConverter.ColKeyToColIdx(e);var o=this.headerMgr.GetColumnHeaderElement(e);if(this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.ExpandColumnMenu)){this.delegateMgr.Apply(r.JsGridConstants.DelegateType.ExpandColumnMenu,e,s,n);this.headerMgr.SetColumnMenuExpanded(e)}else this._objBag.columnMenuMgr.ExpandMenu(i,s,n,this.bHidableColumns,this.bSortableColumns,this.bAutoFilterableColumns,o)&&this.headerMgr.SetColumnMenuExpanded(e);return!0}return!1};e.prototype.OnColumnMenuClick=function(e,t){this.ExpandColumnMenuInternal(t)&&i.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)};e.prototype.ExpandColumnMenu=function(e){if(this._objBag.columnMenuMgr.CanExpandMenu(this.paneConverter.GetColumnByIdx(e),this.bHidableColumns,this.bSortableColumns,this.bAutoFilterableColumns,this.bResizableColumns)){this.gridPane.ScrollColumnIntoViewHorizontally(e);this.ActivateColumn(e);return this.ExpandColumnMenuInternal(this.paneConverter.ColIdxToColKey(e))}return!1};e.prototype.OnInsertedRow=function(e,t){null!=e&&this.reorderableRows.Contains(e.GetRecordKey())&&(e.GetTd().style.cursor="move")};e.prototype.OnInsertedColumns=function(e,t,n){for(var r=0;r<e.length;r++){var i=this._objBag.columnMenuMgr.CanExpandMenu(e[r].GetColumn(),this.bHidableColumns,this.bSortableColumns,this.bAutoFilterableColumns,this.bResizableColumns),s=e[r].GetTd();this.headerMgr.CreateTableHeaderCell(e[r].GetColumn(),s,n,this.bMovableColumns,this.bResizableColumns,this.bSortableColumns,!0,i?this.OnColumnMenuClick.bind(this):null,this.GetColumnHeaderSibling.bind(this),e[r].GetColIdx());this.headerMgr.ShowMenuOnColumn(this.tableMgr.GetColumnHeader(e[r].GetColIdx()).GetTd());this.headerMgr.ApplyHeaderStyle(s,this.GetHeaderStyle(e[r].GetColIdx(),!1))}null==this.curColUpdateTimeOut&&(this.curColUpdateTimeOut=setTimeout(this.UpdateFirstDisplayColumn.bind(this),0))};e.prototype.UpdateFirstDisplayColumn=function(){if(!this.bIsDisposed){var e=this.tableMgr.GetColumnHeader(this.tableMgr.BeginColIdx());null!=e&&this.headerMgr.NotifyColumnHeaderOrderSet(e.GetTd())}this.curColUpdateTimeOut=null};e.prototype.GetDisplayControlAndContentForCell=function(e,t,n,r,i){var s=t.GetProp(n);if(s){var o=null==s?this.gridFieldMap[n].GetPropType():s.propType;if(o){var u=p.PropertyType.Internal.Property.GetInstance().GetDisplayControlForProperty(o,i);return{content:u.Render(this._fnGetCellValue(t,n,o),t,e,this.gridFieldMap[n],o,r,this.jsGridObj,this._objBag.RTL,this.tableMgr.GetCellByKey(t.key(),n).GetTd()),displayControl:u}}}return{content:null,displayControl:null}};e.prototype.GetContentForCell=function(e,t,n,r,i){return this.GetDisplayControlAndContentForCell(e,t,n,r,i).content};e.prototype.BuildCellContent=function(e){var t,n,r=this,s=e.GetRecord(),o=function(e){if(null!=e.fnDispose){null==r.disposeMap[c]&&(r.disposeMap[c]={});null==r.disposeMap[c][a]&&(r.disposeMap[c][a]=[]);r.disposeMap[c][a].push(e.fnDispose);e=e.elem}n.appendChild(e)};if(null!=s){var u=e.GetColumn(),a=e.GetFieldKey(),f=u.fnGetDisplayControlName&&u.fnGetDisplayControlName(s,a);t=this.GetDisplayControlAndContentForCell(u,s,a,this.RefreshCellStyle(e),f).content}if(null!=t){n=e.GetTd();var c=s.key();if(null!=t.multipleChildren)for(var h=0;h<t.multipleChildren.length;h++)o(t.multipleChildren[h]);else o(t);return!0}if(!l.addNewItemVisualRefreshKillswitchIsActive&&this.quickEditVisualRefreshFlightEnabled&&s.bIsNewRow&&e&&e.tableColIdx<=2&&"DocIcon"!==e.fieldKey){n=e.GetTd();if(2===e.tableColIdx){if(i.JsGridUtil.Internal.DomElement.GetInstance().GetPrevElement(n).firstChild)return!1}var p=document.createElement("span");p.classList.add(b.inlineNewItemPlaceHolder);p.textContent=g.default.addNewItemPlaceHolder;n.appendChild(p);return!0}return!1};e.prototype.TryDisposeRow=function(e){if(e in this.disposeMap){for(var t in this.disposeMap[e])i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterCell(this.disposeRenderedObjectsJobKey,e,t);delete this.disposeMap[e]}};e.prototype.TryBeginEdit=function(e){i.JsGridUtil.DebugAssert("keypress"==e.type||"mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&(e.keyCode==r.JsGridConstants.Key.F2||e.keyCode==r.JsGridConstants.Key.IMEInput));var t=this._selectionMgr.GetFocusForPane(this.gridPane);if(null==t)return!1;this.gridPane.ScrollCellIntoView(t.rowIdx,t.colIdx);if(this._editMgr.IsBound()){this._cutcopypasteMgr.CancelMode();this._editMgr.BeginEdit(e);return!0}return!1};e.prototype.GetColumnHeaderSibling=function(e,t){return t?e.previousSibling:e.nextSibling};e.prototype.GetRowHeaderSibling=function(e,t){var n=t?e.parentNode.previousSibling:e.parentNode.nextSibling;return n&&n.firstChild};e.prototype.GetHeaderStyle=function(e,t,n){var r=t?this.styles.rowHeaderStyleCollection:this.styles.columnHeaderStyleCollection;if(n)return r.normal;for(var i=e==(t?this.activeRowIdx:this.activeColIdx),s=t?[this._selectionMgr.GetRowRanges(this.gridPane),this._selectionMgr.GetColumnRanges(this.gridPane)]:[this._selectionMgr.GetColumnRanges(this.gridPane),this._selectionMgr.GetRowRanges(this.gridPane)],o=0;o<s[0].length;o++)if(s[0][o].Contains(e))return i?r.allSelectedHover:r.allSelected;if(0!==s[1].length)return i?r.partSelectedHover:r.partSelected;var u=this._selectionMgr.GetCellRanges(this.gridPane);for(o=0;o<u.length;o++)if((t?u[o].rowRange:u[o].colRange).Contains(e))return i?r.partSelectedHover:r.partSelected;return i?r.normalHover:r.normal};return e})();t.GridPane=A;var O=(function(){function e(e){this.resizingColIdx=null;this.movingColIdx=null;this.startMovingColIdx=null;this.bColumnSelection=!1;this.bRowReordering=!1;this.bHeaderEventHandlersSetup=!1;this.bScrollTimerActive=!1;this.cachedMouseMoveEventInfo=null;this.cachedMouseDownCellInfo={cellType:null,recordKey:null,fieldKey:null,bPendingClick:!1,bPendingDoubleClick:!1};this._lastResize=Date.now();this._resizeDeltaOnMouseMove=0;this._gridPane=e;this.cachedMouseDownCellInfo={cellType:null,recordKey:null,fieldKey:null,bPendingClick:!1,bPendingDoubleClick:!1};this._gridPane.tableDiv.addEventListener("mousedown",this.OnTableMouseDown.bind(this));this._gridPane.tableDiv.addEventListener("mousemove",this.OnTableMouseMove.bind(this));this._gridPane.tableDiv.addEventListener("mouseup",this.OnTableMouseUp.bind(this));this._gridPane.tableDiv.addEventListener("dblclick",this.OnTableDoubleClick.bind(this));this._gridPane.selectionDragHandle.addEventListener("mousedown",this.OnFillHandleMouseDown.bind(this));this._gridPane.tableDiv.addEventListener("contextmenu",this.onContextMenu.bind(this))}e.prototype.SetupHeaderEvents=function(){if(!this.bHeaderEventHandlersSetup){this.topTr=this._gridPane.tableMgr.GetColumnHeaderTr();this.topTr.addEventListener("mousedown",this.OnColumnHeaderMouseDown.bind(this));this.topTr.addEventListener("mousemove",this.OnColumnHeaderMouseMove.bind(this));this.topTr.addEventListener("mouseout",this.OnColumnHeaderMouseOut.bind(this));this.topTr.addEventListener("keydown",this.OnColumnHeaderKeyDown.bind(this))}this.bHeaderEventHandlersSetup=!0};e.prototype.ClearHeaderEvents=function(){this.bHeaderEventHandlersSetup&&i.JsGridUtil.ClearEventListeners(this.topTr);this.bHeaderEventHandlersSetup=!1};e.prototype.Dispose=function(){window.removeEventListener("resize",this._gridPane.onResizeHandler);this.ClearHeaderEvents();i.JsGridUtil.ClearEventListeners(this._gridPane.tableDiv);i.JsGridUtil.ClearEventListeners(this._gridPane.selectionDragHandle);this.topTr=null};e.prototype.ShiftSelect=function(e,t){var n=t.GetCellType(),r=e.ctrlKey?s.SelectOp.ReplaceLast:s.SelectOp.Set,i=this._gridPane._selectionMgr.GetFocusForPane(this._gridPane);null!=i&&(this.cachedMouseDownCellInfo.cellType!=this._gridPane.tableMgr.CellType.RowHeader||n!=this._gridPane.tableMgr.CellType.RowHeader&&n!=this._gridPane.tableMgr.CellType.Cell?this.cachedMouseDownCellInfo.cellType!=this._gridPane.tableMgr.CellType.ColumnHeader||n!=this._gridPane.tableMgr.CellType.ColumnHeader&&n!=this._gridPane.tableMgr.CellType.Cell?this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.Cell&&n==this._gridPane.tableMgr.CellType.Cell&&this._gridPane._selectionMgr.SelectRange(this._gridPane,i.rowIdx,t.GetRowIdx(),i.colIdx,t.GetColIdx(),r,!1,!0):this._gridPane._selectionMgr.SelectRange(this._gridPane,null,null,i.colIdx,t.GetColIdx(),r,!1,!0):this._gridPane._selectionMgr.SelectRange(this._gridPane,i.rowIdx,t.GetRowIdx(),null,null,r,!1,!0))};e.prototype.OnFillHandleMouseDown=function(e){if(i.JsGridUtil.Internal.IsFeatureEnabled(N)&&this._gridPane._editMgr.IsEditing()){e.preventDefault();e.stopPropagation()}else e.button==r.JsGridConstants.MouseButton.leftButton&&this._gridPane._selectionMgr.GetFocusedPane()==this._gridPane&&this._gridPane._fillDownMgr.OnMouseDown(e,this._gridPane,this._gridPane._objBag.parentNode,this._gridPane.selectionDragHandle,this._gridPane.tableMgr,this._gridPane._selectionMgr)};e.prototype.OnTableDoubleClick=function(e){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);(t&&t.GetCellType())==this._gridPane.tableMgr.CellType.ColumnHeader&&this.AutoResizeActiveColumn();this.FireClickEvent(e,t,r.JsGridConstants.EventType.OnDoubleClick)};e.prototype.OnTableMouseDown=function(e){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);this.cachedMouseDownCellInfo={cellType:null,recordKey:null,fieldKey:null,bPendingClick:!1,bPendingDoubleClick:!1};if(!i.JsGridUtil.Internal.DomElement.GetInstance().AttributeOnElementOrAncestor(e.target,"ms-jsgrid-click-passthrough","true")&&e.button==r.JsGridConstants.MouseButton.leftButton){if(t&&null==t.GetRowIdx()&&!this.bColumnSelection)return;i.JsGridUtil.Internal.IsFeatureEnabled(N)&&this._gridPane.tableDiv.classList.add(b.tableHasMouseDown);this.bColumnSelection=!1;this.HandleTableLeftClick(t,e)}};e.prototype.onContextMenu=function(e){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);this.cachedMouseDownCellInfo={cellType:null,recordKey:null,fieldKey:null,bPendingClick:!1,bPendingDoubleClick:!1};if(!i.JsGridUtil.Internal.DomElement.GetInstance().AttributeOnElementOrAncestor(e.target,"ms-jsgrid-click-passthrough","true")){this.FireClickEvent(e,t,r.JsGridConstants.EventType.OnRightClick);return!1}};e.prototype.HandleTableLeftClick=function(e,t){var n=this;if(null!=e){this.cachedMouseDownCellInfo.cellType=e.GetCellType();this.cachedMouseDownCellInfo.recordKey=e.GetRecordKey();this.cachedMouseDownCellInfo.fieldKey=e.GetFieldKey();i.JsGridUtil.Internal.IsFeatureEnabled(N)&&i.JsGridUtil.Internal.IsFeatureEnabled(C)&&this._gridPane._selectAllCell.GetTd().classList.remove(b.allRowsSelected);if(this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.RowHeader&&this._gridPane.reorderableRows.Contains(this.cachedMouseDownCellInfo.recordKey)){this.StartRowReorder(t);return}var r=this._gridPane._selectionMgr.GetFocusForPane(this._gridPane);if(this.cachedMouseDownCellInfo.cellType!==this._gridPane.tableMgr.CellType.SelectAllSquare){t.preventDefault();this.lastMouseMoveCell=e;i.JsGridUtil.Internal.DomElement.GetInstance().SetCapture(this._gridPane.tableDiv,this.OnTableMouseMoveForSelect.bind(this),function(){setTimeout(n.UpdateRowHeadersForReorder.bind(n),0)})}if(t.shiftKey)this.ShiftSelect(t,e);else{var o=e.GetRowIdx(),u=e.GetColIdx(),a=t.ctrlKey?s.SelectOp.Append:s.SelectOp.Set;this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.RowHeader?i.JsGridUtil.Internal.IsFeatureEnabled(N)&&i.JsGridUtil.Internal.IsFeatureEnabled(C)?this.FilterRowHeaderSelection(o,e):this._gridPane._selectionMgr.SelectRange(this._gridPane,o,o,null,null,a,!0,!1):this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.ColumnHeader?this._gridPane._selectionMgr.SelectRange(this._gridPane,null,null,u,u,a,!0,!1):this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.Cell&&this._gridPane._selectionMgr.SelectRange(this._gridPane,o,o,u,u,a,!0,!1);i.JsGridUtil.Internal.IsFeatureEnabled(N)&&i.JsGridUtil.Internal.IsFeatureEnabled(C)&&this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.RowHeader?this.lastMouseMoveCell=e=this._gridPane.tableMgr.GetRowHeaderByKey(this.cachedMouseDownCellInfo.recordKey):this.lastMouseMoveCell=e=this._gridPane.tableMgr.GetCellByKey(this.cachedMouseDownCellInfo.recordKey,this.cachedMouseDownCellInfo.fieldKey);this.cachedMouseDownCellInfo.bPendingClick=this.cachedMouseDownCellInfo.bPendingDoubleClick=!0}if(this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.Cell&&null!=r&&r.recordKey==this.cachedMouseDownCellInfo.recordKey&&r.fieldKey==this.cachedMouseDownCellInfo.fieldKey&&this._gridPane.TryBeginEdit(t)){i.JsGridUtil.Internal.IsFeatureEnabled(N)&&this._gridPane.tableDiv.classList.remove(b.tableHasMouseDown);t.stopPropagation()}}};e.prototype.FilterRowHeaderSelection=function(e,t){var n=t.GetRecord();if(!l.addNewItemVisualRefreshKillswitchIsActive&&n&&n.bIsNewRow){var r=t.GetTr();if(r&&r.classList&&!r.classList.contains(b.rowIsActive))return}var i=this._gridPane._selectionMgr,o=i.GetRowRanges(this._gridPane),u=i.IsRowSelected(this._gridPane,e),a=u?s.RowSelectOp.Unselect:s.RowSelectOp.Select,f=a!==s.RowSelectOp.Unselect;1===o.length&&o[0].begin===o[0].end&&u?i.SelectRange(this._gridPane,e,e,0,0,s.SelectOp.Set,!0,!1):i.SelectRange(this._gridPane,e,e,null,null,a,f,!1)};e.prototype.OnTableMouseUp=function(e){if(this.cachedMouseDownCellInfo.bPendingClick){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);null!=t&&!this._gridPane._editMgr.IsEditing()&&this._gridPane._selectionMgr.IsOneCellSelected(this._gridPane._selectionMgr.GetLastSelectionRangeNormalized())&&t.GetCellType()==this._gridPane.tableMgr.CellType.Cell&&this.cachedMouseDownCellInfo.recordKey==t.GetRecordKey()&&this.cachedMouseDownCellInfo.fieldKey==t.GetFieldKey()&&this._gridPane._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnSingleCellClick,i.JsGridUtil.EventArgs.SingleCellClick(e,this.cachedMouseDownCellInfo.recordKey,this.cachedMouseDownCellInfo.fieldKey));this.cachedMouseDownCellInfo.bPendingClick=!1}i.JsGridUtil.Internal.IsFeatureEnabled(N)&&this._gridPane.tableDiv.classList.remove(b.tableHasMouseDown)};e.prototype.FireClickEvent=function(e,t,n){var s=t&&t.GetCellType(),o=t&&t.GetRecord(),u=o&&o.key(),a=t&&t.GetFieldKey(),f=s==this._gridPane.tableMgr.CellType.SelectAllSquare?r.JsGridConstants.ClickContext.SelectAllSquare:s==this._gridPane.tableMgr.CellType.RowHeader?r.JsGridConstants.ClickContext.RowHeader:s==this._gridPane.tableMgr.CellType.ColumnHeader?r.JsGridConstants.ClickContext.ColumnHeader:s==this._gridPane.tableMgr.CellType.Cell?r.JsGridConstants.ClickContext.Cell:r.JsGridConstants.ClickContext.Other;if(n==r.JsGridConstants.EventType.OnRightClick||f!==r.JsGridConstants.ClickContext.Cell||this.cachedMouseDownCellInfo.bPendingDoubleClick&&this.cachedMouseDownCellInfo.cellType==s&&this.cachedMouseDownCellInfo.recordKey==u&&this.cachedMouseDownCellInfo.fieldKey==a){this._gridPane._objBag.eventMgr.FireEvent(n,i.JsGridUtil.EventArgs.Click(e,f,u,a));this.cachedMouseDownCellInfo.bPendingDoubleClick=!1}i.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)};e.prototype.OnTableMouseMoveForSelect=function(e){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);if(null!=t&&(null==this.lastMouseMoveCell||!this.lastMouseMoveCell.Equals(t))){this.ShiftSelect(e,t);this.lastMouseMoveCell=t}};e.prototype.OnTableMouseMove=function(e){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);t&&t.GetCellType()==this._gridPane.tableMgr.CellType.RowHeader&&!this.bRowReordering?this._gridPane.ActivateRow(t.GetRowIdx()):this._gridPane.DeactivateRow()};e.prototype.GetActiveReorderableRecordKeys=function(e){var t=this._gridPane.jsGridObj.GetSelectedRowRanges();if(1==t.length){var n,i,s=t[0].keys;null==i&&(i={bAllChildKeysInView:!0,bGroupingRowFound:!1,bLevelZeroFound:!1,expandedKeys:s});if(i.bGroupingRowFound||i.bLevelZeroFound)return[];for(var o=0;o<i.expandedKeys.length;o++)if(this._gridPane.jsGridObj.IsEntryRecordKey(i.expandedKeys[o])||this._gridPane.jsGridObj.IsProvisionalRecordKey(i.expandedKeys[o]))return[];n=i.expandedKeys;if(this._gridPane.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.CanReorderRecords)&&this._gridPane.delegateMgr.Apply(r.JsGridConstants.DelegateType.CanReorderRecords,n))return e?i.expandedKeys:s}return[]};e.prototype.UpdateRowHeadersForReorder=function(){if(!this._gridPane.bIsDisposed){for(var e=this._gridPane.tableMgr.GetRowHeaders(),t=0;t<e.length;t++)e[t].GetTd().style.cursor="";var n=this.GetActiveReorderableRecordKeys(!1);for(t=0;t<n.length;t++)this._gridPane.tableMgr.GetRowHeaderByKey(n[t]).GetTd().style.cursor="move";this._gridPane.reorderableRows.Clear();this._gridPane.reorderableRows.AddArray(n)}};e.prototype.StartRowReorder=function(e){if(this.ExpandSelectionForReorder()){this.bRowReordering=!0;this.mouseDownY=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e).y;var t=e.target,n=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(t),r=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane.tableDiv);this.origGhostY=n.y-r.y;this._gridPane.rowDropIndic.style.top=this.origGhostY+"px";this._gridPane.rowDropIndic.style.width=t.offsetWidth+"px";this._gridPane.rowDropIndic.style.visibility="";this._gridPane.tableDiv.style.cursor="move";i.JsGridUtil.Internal.DomElement.GetInstance().SetCapture(t,this.OnRowReorderMouseMove.bind(this),this.OnRowReorderMouseUp.bind(this));this.OnRowReorderMouseMove(e)}};e.prototype.PositionReorderElements=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane.tableDiv),n=this.RowHeaderHitTest(e);if(n.insertRowIdx!==this._gridPane.tableMgr.EndRowIdx()&&null!=n.insertRowIdx){var r=this._gridPane.tableMgr.GetRowHeader(n.insertRowIdx).GetTd(),s=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(r).y;this._gridPane.rowDropIndic.style.top=s-t.y-2+"px";this._gridPane.rowDropIndic.style.visibility=""}};e.prototype.OnRowReorderMouseMove=function(e){this.cachedMouseMoveEventInfo=e;this.PositionReorderElements(e);var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane.tableDiv);t.y>=n.y+this._gridPane.tableDiv.offsetHeight-50?this.StartTimerScroll(!1):t.y<=n.y+50?this.StartTimerScroll(!0):this.StopTimerScroll()};e.prototype.TimerScroll=function(e){var t=this;e?this._gridPane._objBag.paneMgr.ScrollUpByOne():this._gridPane._objBag.paneMgr.ScrollDownByOne();this.PositionReorderElements(this.cachedMouseMoveEventInfo);this.bScrollTimerActive&&(this.timer=setTimeout(function(){t.TimerScroll(e)},100))};e.prototype.StartTimerScroll=function(e){var t=this;if(!this.bScrollTimerActive){this.bScrollTimerActive=!0;this.timer=setTimeout(function(){t.TimerScroll(e)},0)}};e.prototype.StopTimerScroll=function(){clearTimeout(this.timer);this.bScrollTimerActive=!1};e.prototype.OnRowReorderMouseUp=function(e){this.StopTimerScroll();this._gridPane.rowDropIndic.style.visibility="hidden";this.bRowReordering=!1;this._gridPane.tableDiv.style.cursor="";var t=this.RowHeaderHitTest(e);if(t.insertRowIdx!==this._gridPane.tableMgr.EndRowIdx()&&null!=t.insertRowIdx){var n=this._gridPane.tableMgr.GetRowHeader(t.insertRowIdx).GetRecordKey();if(this._gridPane.reorderableRows.Contains(n))return;this._gridPane.jsGridObj.IsEntryRecordKey(n)&&(n=null);var s=this.GetSelectionRange();i.JsGridUtil.DebugAssert(!s.bInvalid);this._gridPane.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.OnBeforeRecordReordered)&&!this._gridPane.delegateMgr.Apply(r.JsGridConstants.DelegateType.OnBeforeRecordReordered,s.selectedKeys)||this._gridPane.jsGridObj.ReorderRecords(s.topRecordKey,s.bottomRecordKey,n,!0)}};e.prototype.RowHeaderHitTest=function(e){for(var t,n=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e).y,r=this._gridPane.tableMgr.GetRowHeaders(),s=0;s<r.length;s++){var o=r[s].GetTd(),u=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(o);if(0==s&&n<u.y||n>=u.y&&n<u.y+o.offsetHeight){if(this._gridPane.reorderableRows.Contains(r[s].GetRecordKey())||s>0&&this._gridPane.reorderableRows.Contains(r[s-1].GetRecordKey())){var a=this._gridPane.tableMgr.GetRowHeaderByKey(this._gridPane.jsGridObj.GetSelectedRowRanges()[0].keys[0]);t=null!=a?a.GetRowIdx():r[s].GetRowIdx()}else t=r[s].GetRowIdx();break}}null==t&&(t=this._gridPane.tableMgr.EndRowIdx());return{insertRowIdx:t}};e.prototype.GetSelectionRange=function(){var e=this.GetActiveReorderableRecordKeys(!0);if(null==e||0==e.length)return{bInvalid:!0};for(var t=[],n=0;n<e.length;n++)this._gridPane.paneConverter.IsRecordOnScreen(e[n])&&t.push(e[n]);var r=this._gridPane.paneConverter.GetTopRowIdxForKey(t[0]),i=r,s=r,o=t[0],u=t[0];for(n=1;n<t.length;n++)if((r=this._gridPane.paneConverter.GetTopRowIdxForKey(t[n]))<i){i=r;o=t[n]}else if(r>s){s=r;u=t[n]}return{topIdx:i,bottomIdx:s,topRecordKey:o,bottomRecordKey:u,selectedKeys:e}};e.prototype.ExpandSelectionForReorder=function(){var e=this.GetSelectionRange();if(e.bInvalid)return!1;this._gridPane.jsGridObj.SelectRowRange(e.topIdx,e.bottomIdx,!1);this._gridPane.reorderableRows.Clear();this._gridPane.reorderableRows.AddArray(e.selectedKeys);return!0};e.prototype.DetermineHeaderElementInfo=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"colAction",null),n=null;null!=t&&(n=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(t.elem,"thColumnKey",null));return{colAction:null!=t?i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(t.elem,"colAction"):null,thElem:null!=n?n.elem:null}};e.prototype.OnColumnHeaderMouseDown=function(e){if(e.button===r.JsGridConstants.MouseButton.leftButton){this._gridPane._editMgr.StopEditing(!1);this._gridPane._editMgr.StopEditing(!1);this._gridPane.headerMgr.HeaderMouseDown(e);var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e);this.mouseDownX=t.x;var n=this.DetermineHeaderElementInfo(e),s=this._gridPane.headerMgr.InColumnHeaderEditMode()&&"sort"!==n.colAction;if(null==this._gridPane.lockedColIdx&&!s)if("sort"==n.colAction){var o=this.HeaderHitTest(e,!0);if(null!=o.colIdx){var u=this._gridPane.tableMgr.GetColumnHeader(o.colIdx).GetColumn();this._gridPane.headerMgr.OnSort(e,u.columnKey)}}else if("resize"==n.colAction||"resize-current"==n.colAction){e.preventDefault();var a=this._gridPane._objBag.jsGridParams.telemetry;a&&(this._qos=new(a(m.Qos))({name:"QuickEditColumnResize"}));var f="resize"==n.colAction?this._gridPane.GetColumnHeaderSibling(n.thElem,!0):n.thElem;if(null!=f&&null!=f.thColumnKey){i.JsGridUtil.Internal.DomElement.GetInstance().SetCapture(this.topTr,this.OnColumnHeaderMouseMoveForColumnResize.bind(this),this.OnColumnHeaderMouseUpForColumnResize.bind(this));this.resizingColIdx=this._gridPane.paneConverter.ColKeyToColIdx(f.thColumnKey);this.origWidth=parseInt(this._gridPane.paneConverter.GetColumnByKey(f.thColumnKey).width,10);this._gridPane.headerMgr.SetColumnResizing(f.thColumnKey)}}else if("select"==n.colAction)this.bColumnSelection=!0;else if(i.JsGridUtil.Internal.IsFeatureEnabled(N)&&i.JsGridUtil.Internal.IsFeatureEnabled(C)){var l=this._gridPane.tableMgr.GetCellByChildElement(e.target);(l&&l.GetCellType())===this._gridPane.tableMgr.CellType.SelectAllSquare&&this.SelectAllRows()}}};e.prototype.SelectAllRows=function(){var e=this._gridPane._objBag.paneMgr,t=this._gridPane.jsGridObj,n=this._gridPane._selectionMgr.GetLastSelectionType(),i=e.RecordKeyToViewIdx(e.GetLastRecordKey());if(void 0!==i){var s=t.GetSelectedRecordKeys();if(null==s||0===i&&n!==r.JsGridConstants.SelectionType.RowRange||s.length!==i-0+1){t.SelectRowRange(0,i,!1);this._gridPane._selectAllCell.GetTd().classList.add(b.allRowsSelected)}else{t.SelectCellRange(0,0,0,0,!1);this._gridPane._selectAllCell.GetTd().classList.remove(b.allRowsSelected)}}};e.prototype.OnColumnHeaderKeyDown=function(e){if(!e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==r.JsGridConstants.Key.tab){e.preventDefault();e.stopPropagation();this._gridPane._objBag.focusMgr.Focus()}e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==r.JsGridConstants.Key.space&&this._gridPane.ExpandColumnMenu(this._gridPane.focusedColHeaderIndex-1)};e.prototype.OnColumnHeaderMouseMoveForColumnResize=function(e){try{var t,n=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane._parentNode).x,s=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),o=Math.max(n,s.x);this._resizeDeltaOnMouseMove=(o-this.mouseDownX)*(this._gridPane._objBag.RTL.bEnabled?-1:1);t="Title"===this._gridPane.tableMgr.columns[this.resizingColIdx].columnKey?Math.max(this.origWidth+this._resizeDeltaOnMouseMove,200):Math.max(this.origWidth+this._resizeDeltaOnMouseMove,r.JsGridConstants.Internal.MinColumnWidth);var u=this._gridPane.tableMgr.GetColumnHeader(this.resizingColIdx).GetTd();this._gridPane.paneConverter.GetColumnByKey(u.thColumnKey).width=t;this._gridPane.headerMgr.ResizeColumn(u,t);this._gridPane.itemSizes[this.resizingColIdx]=t;this._gridPane.tableMgr.columns[this.resizingColIdx].width=t;u.style.width=t+"px";this._gridPane.tableMgr.ResizeColCoordCache(u.cellIndex,t);this._gridPane.UpdatePositionedElements();this._gridPane._editMgr.NotifyMove(this._gridPane)}catch(e){if(this._qos){this._qos.end({resultType:m.ResultTypeEnum.Failure,resultCode:"FailToMoveElementForColumnResize",error:e.message});this._qos=void 0}}};e.prototype.OnColumnHeaderMouseUpForColumnResize=function(e){var t=this;try{if(null!=this.resizingColIdx){var i=this._gridPane.tableMgr.GetColumnHeader(this.resizingColIdx).GetTd();this._gridPane.headerMgr.SetColumnResized(i.thColumnKey);this._gridPane.tableMgr.OptimizeTableColumns();this._gridPane.horizScrollBar.Update({itemSizes:this._gridPane.itemSizes});if(this._gridPane._objBag.setColumnWidthsToLocalStorage){var s=this._gridPane.GetAllColumns().GetColumnByKey(i.thColumnKey);this._gridPane._objBag.setColumnWidthsToLocalStorage(s.name,s.width-r.JsGridConstants.Internal.ColumnWidthOffset)}var o=this._gridPane._objBag.jsGridParams,u=o.telemetry,a=o.baseEngagementData;u&&a&&u(d.Engagement).logData(n.__assign(n.__assign({},a),{component:"SPGrid",name:"ColumnResize",isIntentional:!0}));if(this._qos){this._qos.end({resultType:m.ResultTypeEnum.Success});this._qos=void 0}this.resizingColIdx=null;if(!T&&!this._resizeDeltaOnMouseMove)return;if(!x){this._lastResize=Date.now();window.setTimeout(function(){if(Date.now()-t._lastResize>450){t._gridPane.UpdateColumns(t._gridPane.allColumns);t._gridPane.jsGridObj.EnsurePaneWidth();t._gridPane.jsGridObj.NotifyDataAvailable()}},500)}}}catch(e){if(this._qos){this._qos.end({resultType:m.ResultTypeEnum.Failure,resultCode:"FailToDropElementForColumnResize",error:e.message});this._qos=void 0}}};e.prototype.AutoResizeActiveColumn=function(){if(null!=this._gridPane.activeColIdx&&this._gridPane.activeColIdx!==this._gridPane.lockedColIdx){var e=this._gridPane.paneConverter.GetColumnByIdx(this._gridPane.activeColIdx);if(e.isResizable){this._gridPane.headerMgr.SetColumnResizing(e.columnKey);var t=this._gridPane.tableMgr.GetColumnHeader(this._gridPane.activeColIdx).GetTd(),n=Math.max(this._gridPane.headerMgr.GetColumnHeaderAutoResizeWidth(t),this._gridPane.tableMgr.GetColumnAutoResizeWidth(this._gridPane.activeColIdx));if(n!==e.width){e.width=n;this._gridPane.headerMgr.ResizeColumn(t,n);this._gridPane.itemSizes[this._gridPane.activeColIdx]=n;this._gridPane.UpdatePositionedElements();this._gridPane._editMgr.NotifyMove(this._gridPane);this._gridPane.tableMgr.OptimizeTableColumns();this._gridPane.horizScrollBar.Update({itemSizes:this._gridPane.itemSizes})}this._gridPane.headerMgr.SetColumnResized(t.thColumnKey)}}};e.prototype.OnCellsMouseMoveForCopy=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n=t.x-this.mouseDownX,r=t.y-this.mouseDownY;this._gridPane.ghostCells.style.top=this.origGhostY+r+"px";this._gridPane.ghostCells.style.left=this.origGhostX+n+"px"};e.prototype.OnColumnHeaderMouseUpForColumnMove=function(e){this._gridPane.ghostHeader.style.visibility=this._gridPane.columnDropIndic.style.visibility="hidden";var t=this._gridPane.tableMgr.GetColumnHeader(this.movingColIdx).GetTd().thColumnKey;this._gridPane.headerMgr.SetColumnMoved(t);if(this.startMovingColIdx!==this.movingColIdx){var n=this.startMovingColIdx<this.movingColIdx?this.movingColIdx+1:this.movingColIdx;this._gridPane.delegateMgr.Apply(r.JsGridConstants.DelegateType.ReorderColumnPositionInView,t,n)}this.movingColIdx=this.startMovingColIdx=null};e.prototype.OnCellsMouseUpForCopy=function(e){this._gridPane._cutcopypasteMgr.OnCopy(this._gridPane);this.hitTest=this.RowHitTest(e);this._gridPane._selectionMgr.SetFocusByPos(this._gridPane,this.hitTest.row,this.hitTest.col);this._gridPane._cutcopypasteMgr.OnPaste(this._gridPane);if(null!=this._gridPane.ghostCells){this._gridPane.ghostCells.parentNode.removeChild(this._gridPane.ghostCells);this._gridPane.ghostCells=null}this._gridPane.UpdatePositionedElements()};e.prototype.OnColumnHeaderMouseMove=function(e){if(null==this.resizingColIdx&&null==this.movingColIdx){var t=this.HeaderHitTest(e,!0);if(null!=t.colIdx){var n=this._gridPane.tableMgr.GetColumnHeader(t.colIdx).GetColumn().columnKey;if(this._gridPane.headerMgr.ColumnCurrentlyEditing(n))return}null!=t.colIdx&&t.bInVertical&&null==this._gridPane.lockedColIdx&&this._gridPane.headerMgr.HeaderMouseMove(e)}};e.prototype.OnColumnHeaderMouseOut=function(e){var t=this.HeaderHitTest(e,!0);if(null!=t.colIdx){var n=this._gridPane.tableMgr.GetColumnHeader(t.colIdx).GetColumn().columnKey;if(this._gridPane.headerMgr.ColumnCurrentlyEditing(n)||t.bInVertical&&t.colIdx==this._gridPane.activeColIdx)return}this._gridPane.headerMgr.HeaderMouseOut(e)};e.prototype.RowHitTest=function(e){for(var t,n,r,s,o=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane._parentNode),u=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),a=u.x,f=u.y,l=t=0,c=n=0,h=this._gridPane.tableMgr.GetRowHeaders(),p=0;p<h.length;p++){var d=h[p].GetTd(),v=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(d);if(d.offsetHeight+v.y>f){t=p;n=v.y-o.y;break}}var m=this._gridPane.tableMgr.GetColumnHeaders();for(p=0;p<m.length;p++){r=m[p].GetTd();if((s=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(r)).x+r.offsetWidth>a){l=p;c=s.x-o.x;break}}return{row:t,col:l,x:c,y:n}};e.prototype.HeaderHitTest=function(e,t){var n,r,s,o,u=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane.tableDiv),a=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),f=a.x,l=a.y,c=this._gridPane.tableMgr.GetColumnHeaders(),h=c.length>0&&l>=u.y+c[0].GetTd().offsetTop&&l<=u.y+c[0].GetTd().offsetHeight,p=h&&l-u.y<this._gridPane.headerMgr.constEyeBrowHeight?0:(this._gridPane.headerMgr.constResizeWidth+2)*(this._gridPane._objBag.RTL.bEnabled?-1:1);if(!t||h&&i.JsGridUtil.Internal.DomElement.GetInstance().PointInDomElem(f,l,this._gridPane._parentNode,null)){for(var d=0;d<c.length;d++){r=c[d].GetTd();if(f>=(s=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(r)).x+(0!==d?p:0)&&f<s.x+r.offsetWidth+(d!==c.length?p:0)){n=c[d].GetColIdx();break}}var v=0;if(null!=r){var m=f-s.x;v=s.x+r.offsetWidth-f<m?this._gridPane._objBag.RTL.bEnabled?0:1:this._gridPane._objBag.RTL.bEnabled?1:0}var g=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(c[0].GetTd());o=null!=n?n+v:(this._gridPane._objBag.RTL.bEnabled?f>g.x+r.offsetWidth:f<g.x)?this._gridPane.tableMgr.BeginColIdx():this._gridPane.tableMgr.EndColIdx()}return{colIdx:n,insertColIdx:o,bInVertical:h}};return e})()});
define("aQL",["require","exports","g","f","aQo","aPS","aQM","aPY","aQw","ji","jm","LK","bt","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";p=p.tablemgr_9;Object.defineProperty(t,"__esModule",{value:!0});t.addNewItemVisualRefreshKillswitchIsActive=h.Killswitch.isActivated("0599934F-435D-4947-863A-B165DD60BCF5","04/09/2020","update inline new item row style");var d={ODB:1725},v={ODB:1439},m={ODB:1757},g=(function(){function e(e,t,n,r,s,u,a,f,c,h,p,d,v){this.leftmostColIdx=0;this.columns=[];this.rowRecords=[];this.tableColCount=0;this.loadingRects=[];this.errorDivs={};this.rowHeaderStateDivs={};this.tableMgr=this;this.tdCoordsHorizontalAdjustment=null;this.rowCoordCache=[];this.colCoordCache=[];this.CellType={SelectAllSquare:0,RowHeader:1,ColumnHeader:2,Cell:3};this._parentDiv=e;this._baseId=t;this._paneSize=n;this._fnGetLocStr=r;this._objBag=s;this._fnInsertedRow=u;this._fnInsertedColumns=a;this._fnRemovedColumns=f;this._fnRemovedHeaderCell=c;this._fnSetHeaderHeight=h;this._fnPopulateCell=p;this._fnRetryErrorRows=d;this._fnTryDisposeRow=v;this.cellErrorJobKey=i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterJob(this.AddOrUpdateCellError.bind(this));this.paneConverter=new o.GridPaneConverter(s);this.ariaMgr=s.ariaMgr;this.renderCtx=s.jsGridObj.GetSpCsrRenderCtx();this.selectionMgr=s.selectionMgr;this._selectionCircleIcon=l.getIcon("CircleRing");this._selectionCheckmarkIcon=l.getIcon("StatusCircleCheckmark");this._addNewItemIcon=l.getIcon("Add");this.Init()}e.prototype.GetGridPaneConverter=function(){return this.paneConverter};e.prototype.Dispose=function(){this.DisposeLoadingRects();this.tableElem=this._parentDiv=null};e.prototype.SetPosConverterObj=function(e){this.posConverter=e;this.paneConverter.SetPosConverterObj(e)};e.prototype.GetHeaderHeight=function(){i.JsGridUtil.DebugAssert(0!==this.tableElem.rows.length);return this.tableElem.rows[0].offsetHeight};e.prototype.SetHeaderHeight=function(e){this.headerHeight=e;if(this.tableElem.rows.length>0){this.tableElem.rows[0].style.height=this.headerHeight-1+"px";this._fnSetHeaderHeight(this.headerHeight)}};e.prototype.SetRowHeight=function(e){this.rowHeight=i.JsGridUtil.Internal.DomElement.GetInstance().BrowserIsIEAndRenderingModeIs7?e-1:e};e.prototype.GetTdDefaultCssText=function(){return this.styleForTd};e.prototype.InitTable=function(e){this.ClearTable();this.tableColCount=0;this.bRowHeadersEnabled=e;this.tableColIdxOfFirstDataCol=this.bRowHeadersEnabled?1:0;var t,o=i.JsGridUtil.Internal.IsFeatureEnabled(d),u=i.JsGridUtil.Internal.IsFeatureEnabled(v),a=this.tableElem.insertRow(-1);a.recordKey="__colheaders";this.ariaMgr.OnInsertTableRow(a,null,-1);if(this.bRowHeadersEnabled){var l=document.createElement("th");l.scope="col";l.nowrap="nowrap";if(o){l.className=p.gridSelectAllIconContainer;var c=this.renderCtx&&this.renderCtx.ListSchema&&this.renderCtx.ListSchema.Field,h=(c?c.length:0)+2,m=s.JsGridConstants.Internal.zIndex.tableHeader+h;l.style.zIndex=m}else{l.className=p.spGridSelectAllIconContainer;l.style.borderBottom="1px solid "+this._objBag.styleMgr.gridPaneStyle.horizontalBorderColor}if(u&&o){l.classList.add(p.selectAllCheckMarkCell);l.innerHTML=this.GetSelectionCheckElement("all")}else n.render(r.createElement(f.Icon,{iconName:"CheckMark",className:p.spGridSelectAllIcon}),l);var g=document.createElement("div");g.setAttribute("colid","dropHint");if(o){g.style.position="absolute";g.style.right="1px";g.style.top="2px"}else{g.style.cssFloat=this._objBag.RTL.right;g.style.position="relative";g.style.left="1px";g.style.top="7px"}g.style.zIndex="1";n.render(this._objBag.dragDropMgr.renderDropHint(0),g);l.appendChild(g);if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){l.classList.add(p.gridStickyCheckColumn);l.classList.add(p.gridStickyCheckColumnHeader)}this.tableElem.rows[0].appendChild(l);this.tableColCount++;t=new y(0,0,this);this.ariaMgr.OnInsertRowHeaderCell(l)}a.className="ms-viewheadertr ms-vhltr";a.classList.add(p.tableColumnHeadersRow);a.vAlign="top";return t};e.prototype.SetColumns=function(e,t){if(this.columns.length){this.RemoveTableColumns(this.tableColIdxOfFirstDataCol,this.GetDataColCount());this.leftmostColIdx=0}this.columns=e;t?this.paneConverter.SetView(this.columns):this.paneConverter.NotifyColumnsChanged(this.columns);this.OptimizeTableColumns()};e.prototype.ClearTable=function(){this.rowRecords.length>0&&this.SpliceRows(0,this.rowRecords.length,null,0);this.RemoveTableColumns(this.tableColIdxOfFirstDataCol,this.GetDataColCount());this.leftmostColIdx=0;for(;this.tableElem.rows.length>0;)this.tableElem.deleteRow(0);i.JsGridUtil.DebugAssert(0==this.tableElem.rows.length)};e.prototype.SpliceRows=function(e,t,n,r){var i=r.length,s=i>1;s&&this._parentDiv.removeChild(this.tableElem);if(null!=e&&0!==t){this.rowRecords.splice(e,t);for(var o=t-1;o>=0;o--)this.DeleteTableRow(e+o)}if(null!=n&&0!==i){Array.prototype.splice.apply(this.rowRecords,[n,0].concat(r));for(o=0;o<i;o++)this.InsertTableRow(n+o,this.rowRecords[n+o],s)}s&&this._parentDiv.appendChild(this.tableElem);this.RefreshLoadingRects()};e.prototype.RenderRows=function(e){for(var t in e){var n=e[t],r=parseInt(t,10);this.DeleteTableRow(r);this.rowRecords[r]=n;this.InsertTableRow(r,n)}i.JsGridUtil.Internal.IsAssocArrayEmpty(e)||(this.rowRecords=[].concat(this.rowRecords));this.RefreshLoadingRects()};e.prototype.InsertColumns=function(e,t){var n=this.ColIdxToTableColIdx(e);Array.prototype.splice.apply(this.columns,[e,0].concat(t));this.paneConverter.NotifyColumnsChanged(this.columns);n>=this.tableColIdxOfFirstDataCol&&n<=this.tableColCount&&this.InsertTableColumns(n,t.length);for(var r=0;r<t.length;r++)for(var i=t[r],s=0;s<this.rowRecords.length;s++)if(null==this.rowRecords[s].properties[i.columnKey]){var o=this._objBag.tableCache.GetCachedRecord(s);if(null!=o){var a=o.GetProp(i.columnKey);null!=a&&(this.rowRecords[s].properties[i.columnKey]=u.PropertyType.Property.prototype.MakeProperty(void 0,void 0,a.HasDataValue(),a.HasLocalizedValue(),a.propType))}}this.OptimizeTableColumns()};e.prototype.RefreshCell=function(e){var t=e.GetRecordKey(),n=e.GetFieldKey();this.ClearCellError(t,n);e.GetTd().innerHTML="";this._fnPopulateCell(e);this.UpdateCoordCache();this._objBag.errorMgr.CellHasError(t,n)&&this.AddOrUpdateCellError(t,n)};e.prototype.RemoveColumns=function(e,t){var n=this.ColIdxToTableColIdx(e);if(n>=this.tableColIdxOfFirstDataCol&&n<this.tableColCount){var r=t;n+t>this.tableColCount&&(r-=n+t-this.tableColCount);this.RemoveTableColumns(n,r)}this.columns.splice(e,t);this.paneConverter.NotifyColumnsChanged(this.columns);this.OptimizeTableColumns()};e.prototype.ScrollColumns=function(e){var t=this.CalcOptimalDataColumnCount(e),n=this.GetDataColCount(),r=this.leftmostColIdx;this.UpdateCoordCache();if(e>r){this.RemoveTableColumns(this.tableColIdxOfFirstDataCol,Math.min(n,e-r));this.leftmostColIdx=e}else if(e<r){this.leftmostColIdx=e;this.InsertTableColumns(this.tableColIdxOfFirstDataCol,Math.min(t,r-e))}this.OptimizeTableColumns()};e.prototype.ChangeKeys=function(e,t){if(this.paneConverter.IsRecordOnScreen(e))for(var n=this.tableElem.rows.length-1;n>=0;n--)if(this.tableElem.rows[n].recordKey==e){this.tableElem.rows[n].recordKey=t;break}if(e in this.errorDivs){this.errorDivs[t]=this.errorDivs[e];delete this.errorDivs[e]}if(e in this.rowHeaderStateDivs){this.rowHeaderStateDivs[t]=this.rowHeaderStateDivs[e];delete this.rowHeaderStateDivs[e]}};e.prototype.OptimizeTableColumns=function(){var e=this.CalcOptimalDataColumnCount(this.leftmostColIdx),t=this.GetDataColCount()-e;t<0?this.InsertTableColumns(this.tableColCount,-t):t>0&&this.RemoveTableColumns(this.tableColCount-t,t);this.RefreshLoadingRects()};e.prototype.UpdateErrorFrames=function(){for(var e in this.errorDivs)for(var t in this.errorDivs[e])this.AddOrUpdateCellError(e,t,!0)};e.prototype.GetAllDataCells=function(){for(var e=[],t=1;t<this.tableElem.rows.length;t++)for(var n=this.tableColIdxOfFirstDataCol;n<this.tableColCount;n++)e.push(new y(t,n,this));return e};e.prototype.GetSelectAllSquare=function(){return this.bRowHeadersEnabled?new y(0,0,this):null};e.prototype.GetRowHeaderByKey=function(e){if(this.bRowHeadersEnabled&&this.paneConverter.IsRecordOnScreen(e))return new y(this.RowIdxToTableRowIdx(this.paneConverter.GetTopRowIdxForKey(e)),0,this)};e.prototype.GetRowHeader=function(e){if(this.bRowHeadersEnabled){var t=new y(this.RowIdxToTableRowIdx(e),0,this,!0,!1);return t.bIsInvalid?null:t}return null};e.prototype.GetRowHeaders=function(){var e=[];if(this.bRowHeadersEnabled)for(var t=this.tableElem.rows.length,n=1;n<t;n++)e.push(new y(n,0,this));return e};e.prototype.GetColumnHeader=function(e){var t=new y(0,this.ColIdxToTableColIdx(e),this,!0,!1);return t.bIsInvalid||null==t.GetColIdx()?null:t};e.prototype.GetColumnHeaders=function(){for(var e=[],t=this.tableColIdxOfFirstDataCol;t<this.tableColCount;t++)e.push(new y(0,t,this));return e};e.prototype.GetColumnHeaderTr=function(){return this.tableElem.rows[0]};e.prototype.GetRowHeaderWidth=function(){return this.bRowHeadersEnabled?i.JsGridUtil.Internal.IsFeatureEnabled(d)?s.JsGridConstants.Internal.RowHeaderWidthNewStyles:s.JsGridConstants.Internal.RowHeaderWidth:0};e.prototype.GetRowIdxColIdxFromCoord=function(e){for(var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n={},r=this.tableElem.rows,s=1;s<r.length;s++){var o=r[s],u=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(o);if(t.y>=u.y&&t.y<u.y+o.offsetHeight){n.rowIdx=this.TableRowIdxToRowIdx(s);n.top=u.y;n.bottom=u.y+o.offsetHeight;break}}var a=this.tableElem.rows[0].cells;for(s=this.bRowHeadersEnabled?1:0;s<a.length;s++){var f=a[s];u=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(f);if(t.x>=u.x&&t.x<u.x+f.offsetWidth){n.colIdx=this.TableColIdxToColIdx(s);n.left=u.x;n.right=u.x+f.offsetWidth;break}}return n};e.prototype.UpdateCoordCache=function(){this._objBag.bUpdateCoordCache=!0};e.prototype.ResizeColCoordCache=function(e,t){var n,r=this.colCoordCache[e];if(null!=r){if(0!=(n=(t+=1)-r.width)){r.width=t;this._objBag.RTL.bEnabled?r.left+=n:r.right+=n;for(var i=e+1;i<this.colCoordCache.length;i++)if(null!=(r=this.colCoordCache[i])){r.left+=n;r.right+=n}}}else this.ClearColCoordCache(e)};e.prototype.GetTdCoords=function(e){var t={},n=e.cellIndex,r=e.parentNode.rowIndex;this.UpdateCoordCacheInternal();if(!0!==window.disableGetTdCoordsCache&&null!=this.rowCoordCache[r])this.CopyRowCoords(r,t);else{t.top=this.tableElem.offsetTop+e.offsetTop-1;t.bottom=this.tableElem.offsetTop+e.offsetTop+e.offsetHeight;t.height=t.bottom-t.top;this.InsertIntoCoordCacheArray(this.rowCoordCache,r,this.CloneRowCoords(t))}if(!0!==window.disableGetTdCoordsCache&&null!=this.colCoordCache[n])this.CopyColCoords(n,t);else{if(this._objBag.RTL.bEnabled){t.left=this.tableElem.offsetLeft+e.offsetLeft;t.right=this.tableElem.offsetLeft+e.offsetLeft+e.offsetWidth+1}else{t.left=this.tableElem.offsetLeft+e.offsetLeft-1;t.right=this.tableElem.offsetLeft+e.offsetLeft+e.offsetWidth}if(null!=e.previousSibling){if(null==this.tdCoordsHorizontalAdjustment){var s=this.tableElem.rows[0].cells,o=s[this._objBag.RTL.bEnabled?0:s.length-1],u=o.offsetWidth-(i.JsGridUtil.Internal.DomElement.GetInstance().BrowserIsIEAndRenderingModeIs7&&!this._objBag.RTL.bEnabled?1:0);this.tdCoordsHorizontalAdjustment=this.tableElem.offsetWidth-(o.offsetLeft+u)}t.left+=this.tdCoordsHorizontalAdjustment;t.right+=this.tdCoordsHorizontalAdjustment}t.width=t.right-t.left;this.InsertIntoCoordCacheArray(this.colCoordCache,n,this.CloneColCoords(t))}return t};e.prototype.GetCellByKey=function(e,t){if(!this.posConverter.IsRecordOnScreen(e))return null;var n=this.paneConverter.KeyToIdx(e,t);return n&&this.GetCellByIdx(n.rowIdx,n.colIdx)};e.prototype.GetCellByIdx=function(e,t){var n=new y(this.RowIdxToTableRowIdx(e),this.ColIdxToTableColIdx(t),this,!0,!0);return n.bIsInvalid?null:n};e.prototype.GetCellByChildElement=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e,"recordKey");if(null==t)return null;var n=t.elem,r=t.child,s=(function(e,t){return i.JsGridUtil.Internal.FindInArray(e.rows,function(e){return e==t})})(this.tableElem,n),o=(function(e,t){for(var n=null,r=e.cells.length-1;r>=0;r--)if(e.cells[r]==t){n=r;break}return n})(n,r);return null!=s&&null!=o?new y(s,o,this):null};e.prototype.GetRowCount=function(){return this.rowRecords.length};e.prototype.GetColumnCount=function(){return this.GetDataColCount()};e.prototype.BeginRowIdx=function(){return this.paneConverter.RelRowIdxToRowIdx(0)};e.prototype.EndRowIdx=function(){return this.BeginRowIdx()+this.rowRecords.length};e.prototype.BeginColIdx=function(){return this.leftmostColIdx};e.prototype.EndColIdx=function(){return this.leftmostColIdx+this.GetDataColCount()};e.prototype.GetRecordByKey=function(e){for(var t in this.rowRecords)if(this.rowRecords[t].recordKey===e)return this.rowRecords[t];return null};e.prototype.GetColumnAutoResizeWidth=function(e){for(var t=this.ColIdxToTableColIdx(e),n=this.tableElem.rows,r=0,i=0;i<n.length;i++)r=Math.max(r,n[i].cells[t].scrollWidth);return r};e.prototype.GetTableWidth=function(){for(var e=this.tableMgr.GetRowHeaderWidth(),t=this.tableMgr.BeginColIdx();t<this.tableMgr.EndColIdx();t++)e+=this.columns[t].width;return e};e.prototype.InitStyleRules=function(e){var t=e.defaultCellStyle,n=e.gridPaneStyle;this.styleForTd=";vertical-align:middle;border-"+this._objBag.RTL.right+":"+a.StyleUtil.MakeBorderString(1,n.verticalBorderStyle,n.verticalBorderColor)+";border-bottom:"+a.StyleUtil.MakeBorderString(1,n.horizontalBorderStyle,n.horizontalBorderColor)+";color:"+t.textColor+(null!=t.font?";font-family:"+t.font:"")+";font-size:"+t.fontSize+";font-weight:"+t.fontWeight+";font-style:"+t.fontStyle+";text-align:"+t.textAlign+";overflow:hidden;text-overflow:ellipsis"};e.prototype.InsertIntoCoordCacheArray=function(e,t,n){if(t>=e.length){for(var r=e.length;r<t;r++)e.push(null);e.push(n)}else e[t]=n};e.prototype.Init=function(){this._objBag.eventMgr.AttachEvent(s.JsGridConstants.EventType.OnCellErrorStateChanged,this.DispatchCellError.bind(this));this._objBag.intEventMgr.AttachEvent(s.JsGridConstants.Internal.EventType.OnRowHeaderStateChanged,this.DispatchRowStateChange.bind(this));this.InitStyleRules(this._objBag.styleMgr);this.tableElem=document.createElement("table");this.tableElem.cellPadding=this.tableElem.cellSpacing=0;this.tableElem.style.width="1px";this.tableElem.border="0";this.tableElem.cellSpacing="0";this.tableElem.cellPadding="1";this.tableElem.className="ms-listviewtable ms-listviewgrid";this.tableElem.style.borderCollapse="separate";this.tableElem.style.tableLayout="fixed";this.tableElem.id=this._baseId+"_mainTable";this._parentDiv.style.marginRight="3px";this._parentDiv.appendChild(this.tableElem)};e.prototype.DispatchCellError=function(e){this.paneConverter.IsRecordOnScreen(e.recordKey)&&(!e.bCellCurrentlyHasError||e.recordKey in this.errorDivs&&e.fieldKey in this.errorDivs[e.recordKey]?e.bCellCurrentlyHasError||this.ClearCellError(e.recordKey,e.fieldKey):this.AddOrUpdateCellError(e.recordKey,e.fieldKey))};e.prototype.AddOrUpdateCellError=function(e,t,n){var r=this.tableMgr.GetCellByKey(e,t);if(null!=r){var s=r.GetTd();e in this.errorDivs||(this.errorDivs[e]={});null==this.errorDivs[e][t]&&(this.errorDivs[e][t]=n?null:this.CreateCellErrorFrames(s));null!=this.errorDivs[e][t]&&(i.JsGridUtil.Internal.IsFeatureEnabled(d)||this.PositionCellErrorFrames(s,this.errorDivs[e][t]))}};e.prototype.CreateCellErrorFrames=function(e){var t={};if(i.JsGridUtil.Internal.IsFeatureEnabled(d)){e.classList.add(p.cellHasError);return e}t.Top=document.createElement("div");t.Right=document.createElement("div");t.Bottom=document.createElement("div");t.Left=document.createElement("div");for(var n in t){var r=t[n];r.style.cssText="position:absolute; top:0px; left:0px; width:0px; height:0px;";r.style["border"+n]=a.StyleUtil.MakeBorderString(1,"solid",this._objBag.styleMgr.gridPaneStyle.errorRectBorderColor);e.appendChild(r)}return t};e.prototype.PositionCellErrorFrames=function(e,t){var n=this.tableMgr.GetTdCoords(e),r={Top:{left:n.left+1,top:n.top+1,width:n.width-2},Right:{left:n.right-2,top:n.top+1,height:n.height-2},Bottom:{left:n.left+1,top:n.bottom-2,width:n.width-2},Left:{left:n.left+1,top:n.top+1,height:n.height-2}};for(var i in t){var s=t[i];for(var o in r[i])s.style[o]=r[i][o]+"px"}};e.prototype.ClearAllErrorsForRecord=function(e){var t=this.errorDivs[e];if(null!=t){for(var n in t)this.ClearErrorCore(e,n,!1);delete this.errorDivs[e]}};e.prototype.ClearCellError=function(e,t){e in this.errorDivs&&t in this.errorDivs[e]&&this.ClearErrorCore(e,t,!0)};e.prototype.ClearErrorCore=function(e,t,n){if(i.JsGridUtil.Internal.IsFeatureEnabled(d))this.errorDivs[e][t].classList.remove(p.cellHasError);else for(var r in this.errorDivs[e][t])if(null!=r){var s=i.JsGridUtil.Internal.DomElement.GetInstance().GetParentElement(this.errorDivs[e][t][r]);i.JsGridUtil.DebugAssert(null!=s);null!=s&&s.removeChild(this.errorDivs[e][t][r])}delete this.errorDivs[e][t];n&&i.JsGridUtil.Internal.IsAssocArrayEmpty(this.errorDivs[e])&&delete this.errorDivs[e]};e.prototype.DispatchRowStateChange=function(e){this.bRowHeadersEnabled&&this.paneConverter.IsRecordOnScreen(e.recordKey)&&(null!=e.rowHeaderState?this.SetRowHeaderState(e.recordKey,e.rowHeaderState):this.ClearRowHeaderState(e.recordKey))};e.prototype.SetRowHeaderState=function(e,t){null!=this.rowHeaderStateDivs[e]&&this.ClearRowHeaderState(e);var n=this.tableMgr.GetRowHeaderByKey(e);i.JsGridUtil.DebugAssert(null!=n);var r=n.GetTd(),s=t.GetOnClick(),o=t.GetImg().Render(t.GetTooltip(),null!=s?function(t){s(t,e);t.stopPropagation();t.preventDefault()}:null,!0);if(i.JsGridUtil.Internal.IsFeatureEnabled(d)){var u=r.firstElementChild;if(u){u.classList.add(p.hasStateElements);u.appendChild(o)}}else{r.innerHTML="";r.appendChild(o)}this.rowHeaderStateDivs[e]=o};e.prototype.ClearRowHeaderState=function(e,t){if(e in this.rowHeaderStateDivs){var n=this.tableMgr.GetRowHeaderByKey(e);i.JsGridUtil.DebugAssert(null!=t||null!=n);var r=null==t?n.GetTd():t;this.ClearHandlers(r);if(i.JsGridUtil.Internal.IsFeatureEnabled(d)){var s=r.firstElementChild;if(s){s.classList.remove(p.hasStateElements);s.removeChild(this.rowHeaderStateDivs[e])}}else r.removeChild(this.rowHeaderStateDivs[e]);delete this.rowHeaderStateDivs[e]}};e.prototype.GetDataColCount=function(){return this.tableColCount-this.tableColIdxOfFirstDataCol};e.prototype.TableRowIdxToRowIdx=function(e){return this.paneConverter.RelRowIdxToRowIdx(e-1)};e.prototype.RowIdxToTableRowIdx=function(e){return this.paneConverter.RowIdxToRelRowIdx(e)+1};e.prototype.TableColIdxToColIdx=function(e){return this.leftmostColIdx+e-this.tableColIdxOfFirstDataCol};e.prototype.ColIdxToTableColIdx=function(e){return e-this.leftmostColIdx+this.tableColIdxOfFirstDataCol};e.prototype.InsertTableRow=function(e,n,r){var o,u=i.JsGridUtil.Internal.IsFeatureEnabled(d),f=[],l=e+1,h=this.tableElem.insertRow(l);h.style.height=this.rowHeight+"px";var v,m=null!=n&&n!==s.JsGridConstants.Internal.LoadErrorState,g=m?n.key():null;h.recordKey=m?g.toString():null;if(m&&!n.bIsNewRow){n.rowIndex=e;var b=this._objBag&&this._objBag.jsGridParams&&this._objBag.jsGridParams.customFormatterProps,w=b?b.additionalRowClass:"";if(w){var E=b&&b.customFormatterSchema,S=this._objBag.jsGridParams.pageContext,x=n&&n.fieldRawDataMap&&n.fieldRawDataMap.csrInfo,T=new c.CustomFormatter({rowIndex:n?n.rowIndex:-1,fieldRendererFormat:void 0,row:x,currentFieldName:"Title",rowSchema:E,errorStrings:{},pageContextInfo:S}).evalExpression(w);T&&(h.className+=T)}}if(u){h.classList.add(p.gridRow);!t.addNewItemVisualRefreshKillswitchIsActive&&n.bIsNewRow&&h.classList.add(p.inLineNewItemRow)}this.ariaMgr.OnInsertTableRow(h,n,this.TableRowIdxToRowIdx(l));if(this.bRowHeadersEnabled){var N=h.insertCell(-1);if(u){i.JsGridUtil.Internal.IsStickyColumnEnabled()?N.className="ms-vb-itmcbx ms-vb-firstCell "+p.gridCell+" "+p.firstCell+" "+p.gridStickyCheckColumn:N.className="ms-vb-itmcbx ms-vb-firstCell "+p.gridCell+" "+p.firstCell;var C=this.selectionMgr.GetFocusedPane();this.selectionMgr.IsRowSelected(C,e)&&h.classList.add(p.rowIsSelected)}else{N.className="ms-vb-itmcbx ms-vb-firstCell "+p.spGridCell;N.style.cssText=this.styleForTd+";border-"+this._objBag.RTL.left+":"+a.StyleUtil.MakeBorderString(1,this._objBag.styleMgr.gridPaneStyle.verticalBorderStyle,this._objBag.styleMgr.gridPaneStyle.verticalBorderColor)+";padding-"+this._objBag.RTL.left+":4px"}N.setAttribute("data-automationid","spgridcell_"+e.toString()+"_firstCell");o=new y(l,0,this);if(u){var k=document.createElement("div");k.classList.add(p.headerStateContainer);var L=document.createElement("div");L.classList.add(p.headerStateBar);k.appendChild(L);var A=document.createElement("div");A.classList.add(p.selectionCheckMark);A.innerHTML=this.GetSelectionCheckElement(e.toString());N.appendChild(k);N.appendChild(A);if(!t.addNewItemVisualRefreshKillswitchIsActive&&n.bIsNewRow){var O=h.previousSibling;O&&O.classList.remove(p.inLineNewItemRow);var M=document.createElement("div");M.classList.add(p.inlineNewItemAddIconContainer);M.innerHTML=this.GetAddNewItemIconElement();N.appendChild(M)}}this.ariaMgr.OnInsertRowHeaderCell(N)}for(var _=this.tableColIdxOfFirstDataCol;_<this.tableColCount;_++){(N=h.insertCell(-1)).setAttribute("data-automationid","spgridcell_"+e.toString()+"_"+_.toString());v=new y(l,_,this);f.push(v);var D=_-1,P="ms-vb2";if(D>=0&&D<this.columns.length){var H=this.columns[D].fieldKeys[0],B=this._objBag.jsGridParams.tableViewParams.gridFieldMap[H].csrInfo;i.JsGridUtil.DebugAssert(null!=this.renderCtx);null!=B&&(P=i.JsGridUtil.Internal.GetCSSClassForFieldTd(B))}if(u){N.className=p.gridCell+" "+P;i.JsGridUtil.Internal.IsStickyColumnEnabled()&&0===D&&(N.className+=" "+p.gridStickyDataColumn)}else{N.style.cssText=this.styleForTd;N.className=p.spGridCell+" "+P}if(_===this.tableColCount-1){N.className+=" ms-vb-lastCell";u&&(N.className+=" "+p.lastCell)}this.ariaMgr.OnInsertGridCell(N)}this._fnInsertedRow(o,f);var j=!1;for(_=0;_<f.length;_++){j=this._fnPopulateCell(f[_])||j;if(null!=g&&this._objBag.errorMgr.CellHasError(g,f[_].GetFieldKey())){this.AddOrUpdateCellError(g,f[_].GetFieldKey(),r);r&&i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterCell(this.cellErrorJobKey,g,f[_].GetFieldKey())}}var F=this._objBag.rowHeaderStateMgr.GetRowHeaderState(g);this.bRowHeadersEnabled&&null!=F&&this.SetRowHeaderState(g,F);if(!j&&i.JsGridUtil.Internal.DomElement.GetInstance().BrowserIsIEAndRenderingModeIs7){var I=h.cells.length>0?h.cells[0]:null;null!=I&&null!=I.innerHTML&&0==I.innerHTML.length&&(I.innerHTML="&nbsp;")}};e.prototype.ClearHandlers=function(e){i.JsGridUtil.ClearEventListeners(e);for(var t=e.childNodes,n=0;n<t.length;n++)this.ClearHandlers(t[n])};e.prototype.DeleteTableRow=function(e){var t=this.tableElem.rows[e+1].recordKey;this.bRowHeadersEnabled&&null!=this.rowHeaderStateDivs[t]&&this.ClearRowHeaderState(t,this.tableElem.rows[e+1].cells[0]);this.ClearAllErrorsForRecord(t);var n=this.tableElem.rows[e+1];this._fnTryDisposeRow(n.recordKey);n.recordKey=null;this.ClearRowCoordCache(e+1);this.tableElem.deleteRow(e+1)};e.prototype.CalcOptimalDataColumnCount=function(e){return this.paneConverter.GetVirtualColumnCount()};e.prototype.InsertTableColumns=function(e,t){var n=[],r=[],o=this.tableElem.rows[0],u=s.JsGridConstants.Internal.zIndex.tableHeader+t;this.ClearColCoordCache(e);this.ClearRowCoordCache(0);for(var a=0;a<t;a++){var f=document.createElement("th");f.style.textOverflow="ellipsis";e+a==o.cells.length?o.appendChild(f):o.insertBefore(f,o.cells[e+a]);this.tableColCount++;var l=new y(0,e+a,this);n.push(l);var c=l.GetColumn();if(c&&c.width){var h=c.width;f.style.width=h+"px"}if(i.JsGridUtil.Internal.IsFeatureEnabled(m)&&i.JsGridUtil.Internal.IsFeatureEnabled(d)){f.style.zIndex=u;u--}this.ariaMgr.OnInsertColHeaderCell(f);for(var p=0;p<this.rowRecords.length;p++){var v=this.tableElem.rows[p+1].insertCell(e+a);v.style.cssText=this.styleForTd;r.push(new y(p+1,e+a,this));this.ariaMgr.OnInsertGridCell(v)}}this._fnInsertedColumns(n,r,this.headerHeight);for(a=0;a<r.length;a++){this._fnPopulateCell(r[a]);this._objBag.errorMgr.CellHasError(r[a].GetRecordKey(),r[a].GetFieldKey())&&this.AddOrUpdateCellError(r[a].GetRecordKey(),r[a].GetFieldKey())}};e.prototype.RemoveTableColumns=function(e,t){var n=this.TableColIdxToColIdx(e);this.ClearColCoordCache(e);this.ClearRowCoordCache(0);for(;t-- >0;){for(var r=this.columns[n].fieldKeys,i=this.rowRecords.length;i>=0;i--){var s=this.tableElem.rows[i],o=s.cells[e];if(s.recordKey in this.errorDivs)for(var u=0;u<r.length;u++)this.ClearCellError(s.recordKey,r[u]);0==i&&this._fnRemovedHeaderCell(o,n);s.removeChild(o)}n++;this.tableColCount--}this._fnRemovedColumns()};e.prototype.RefreshLoadingRects=function(){var e=this;this.DisposeLoadingRects();for(var t=null,n=[],r=-1,o=0;o<this.rowRecords.length;o++){var u=null==this.rowRecords[o]?1:this.rowRecords[o]==s.JsGridConstants.Internal.LoadErrorState?2:0;if(0!==u)if(u!==r){t={type:u,startIdx:o,count:1};n.push(t)}else t.count++;r=u}if(n.length){var a=this.tableMgr.GetRowHeaderWidth(),f=this._objBag.RTL.bEnabled?Math.max(0,this.tableElem.offsetLeft+1):a,l=Math.min(this.tableMgr.GetTableWidth()-1,this._paneSize.GetWidth())-a,c='<table cellpadding="0" cellspacing="0" style="height:100%;width:100%"><tr><td style="border:0px;text-align:center">',h=c+this._fnGetLocStr("LoadingMsg")+"</td></tr></table>",p=c+'<a href="#" tabIndex="-1" title="'+this._fnGetLocStr("RecordFetchError")+'">'+this._fnGetLocStr("RecordFetchError")+"</a></td></tr></table>";for(o=0;o<n.length;o++){t=n[o];var d=document.createElement("div");i.JsGridUtil.Internal.DomElement.GetInstance().SetOpacity(d,.75);d.style.position="absolute";d.style.top=this.rowHeight*t.startIdx+this.headerHeight+2-this._parentDiv.offsetTop+"px";d.style.left=f+"px";d.style.width=l+"px";d.style.height=this.rowHeight*t.count-1+"px";d.style.zIndex="100";if(1==t.type){d.innerHTML=h;this.loadingRects.push({div:d})}else{d.innerHTML=p;var v=d.firstChild.firstChild.firstChild.firstChild.firstChild;v.addEventListener("click",function(){e._fnRetryErrorRows();return!1});this.loadingRects.push({div:d,anchor:v})}this._parentDiv.appendChild(d)}}};e.prototype.DisposeLoadingRects=function(){for(var e=0;e<this.loadingRects.length;e++){this.loadingRects[e].anchor&&i.JsGridUtil.ClearEventListeners(this.loadingRects[e].anchor);this._parentDiv.removeChild(this.loadingRects[e].div)}this.loadingRects=[]};e.prototype.UpdateCoordCacheInternal=function(){if(this._objBag.bUpdateCoordCache){this.UpdateColCoordCache();this.UpdateRowCoordCache()}this._objBag.bUpdateCoordCache=!1};e.prototype.UpdateRowCoordCache=function(){for(var e,t,n,r=0,i=this.tableElem.rows,s=0;s<this.rowCoordCache.length;s++){if(null==(t=this.rowCoordCache[s])){this.ClearRowCoordCache(s);break}if(0!==(e=(n=i[s].cells[0].offsetHeight+1)-t.height)){t.height=n;t.bottom+=e}if(0!==r){t.top+=r;t.bottom+=r}0!==e&&(r+=e)}};e.prototype.UpdateColCoordCache=function(){for(var e,t,n=0,r=this.tableElem.rows[0],i=0;i<this.colCoordCache.length;i++)if(null!=(e=this.colCoordCache[i])){t=r.cells[i].offsetWidth;t+=1;e.width=t;0!==(n+=t-e.width)&&(this._objBag.RTL.bEnabled?e.left+=n:e.right+=n)}else if(this._objBag.bUpdateCoordCache){this.ClearColCoordCache(i);break}};e.prototype.ClearColCoordCache=function(e){this.colCoordCache.length>e&&this.colCoordCache.splice(e,this.colCoordCache.length-e)};e.prototype.ClearRowCoordCache=function(e){this.rowCoordCache.length>e&&this.rowCoordCache.splice(e,this.rowCoordCache.length-e)};e.prototype.CloneRowCoords=function(e){return{top:e.top,bottom:e.bottom,height:e.height}};e.prototype.CopyRowCoords=function(e,t){var n=this.rowCoordCache[e];t.top=n.top;t.bottom=n.bottom;t.height=n.height};e.prototype.CloneColCoords=function(e){return{left:e.left,right:e.right,width:e.width}};e.prototype.CopyColCoords=function(e,t){var n=this.colCoordCache[e];t.left=n.left;t.right=n.right;t.width=n.width};e.prototype.GetSelectionCheckElement=function(e){var t=this._selectionCircleIcon,n=this._selectionCheckmarkIcon,r='<i class="'+t.subset.className+" "+p.selectionCircleIcon+'">'+t.code+"</i>",i='<i class="'+n.subset.className+" "+p.selectionCheckIcon+'">'+n.code+"</i>";return['<div class="'+p.selectionCheckIconsWrapper+'" data-automationid="row-selection-checkmark-'+e+'">',r,i,"</div>"].join("")};e.prototype.GetAddNewItemIconElement=function(){var e=this._addNewItemIcon;return'<i class="'+e.subset.className+" "+p.inlineNewItemAddIcon+'">'+e.code+"</i>"};e.prototype.IsTableRowIdxValid=function(e,t){return e>=(t?1:0)&&e<this.tableElem.rows.length};e.prototype.IsTableColIdxValid=function(e,t){return e>=(t&&this.bRowHeadersEnabled?1:0)&&e<this.tableColCount};return e})();t.TableManager=g;var y=(function(){function e(e,t,n,r,i){this.fieldKey=null;this.tableRowIdx=e;this.tableColIdx=t;this._tableMgr=n;if(!r||this._tableMgr.IsTableRowIdxValid(e,i)&&this._tableMgr.IsTableColIdxValid(t,i)){this.tableRowIdx=e;this.tableColIdx=t}else this.bIsInvalid=!0}e.prototype.GetTr=function(){return this._tableMgr.tableElem.rows[this.tableRowIdx]};e.prototype.GetTd=function(){return this._tableMgr.tableElem.rows[this.tableRowIdx].cells[this.tableColIdx]};e.prototype.GetRecordKey=function(){if(this.tableRowIdx<1)return null;var e=this._tableMgr.rowRecords[this.tableRowIdx-1];return null!=e&&null!=e.recordKey?e.recordKey:this.GetTr().recordKey};e.prototype.GetRecord=function(){var e=0==this.tableRowIdx?null:this._tableMgr.rowRecords[this.tableRowIdx-1];return e==s.JsGridConstants.Internal.LoadErrorState?null:e};e.prototype.GetFieldKey=function(){if(0==this.tableColIdx&&this._tableMgr.bRowHeadersEnabled||this.tableRowIdx<1)return null;this.fieldKey||(this.fieldKey=this._tableMgr.paneConverter.IdxToFieldKey(this._tableMgr.TableRowIdxToRowIdx(this.tableRowIdx),this._tableMgr.TableColIdxToColIdx(this.tableColIdx)));return this.fieldKey};e.prototype.GetColumn=function(){return 0==this.tableColIdx&&this._tableMgr.bRowHeadersEnabled?null:this._tableMgr.columns[this.GetColIdx()]};e.prototype.GetColIdx=function(){return 0==this.tableColIdx&&this._tableMgr.bRowHeadersEnabled?null:this._tableMgr.TableColIdxToColIdx(this.tableColIdx)};e.prototype.GetRowIdx=function(){return this.tableRowIdx<1?null:this._tableMgr.TableRowIdxToRowIdx(this.tableRowIdx)};e.prototype.Equals=function(e){return this.tableRowIdx==e.tableRowIdx&&this.tableColIdx==e.tableColIdx};e.prototype.GetCellType=function(){return 0==this.tableColIdx&&this._tableMgr.bRowHeadersEnabled?this.tableRowIdx<1?this._tableMgr.CellType.SelectAllSquare:this._tableMgr.CellType.RowHeader:this.tableRowIdx<1?this._tableMgr.CellType.ColumnHeader:this._tableMgr.CellType.Cell};return e})();t.CellInfo=y});
define("aQM",["require","exports","aQo"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this._objBag=e}e.prototype.SetPosConverterObj=function(e){this._posConverter=e};e.prototype.SetView=function(e){this.UpdateColumns(e,!0)};e.prototype.NotifyColumnsChanged=function(e){this.UpdateColumns(e,!1)};e.prototype.FullDataIdxToKey=function(e,t){return{recordKey:this._posConverter.RecordIdxToRecordKey(Math.floor(e/this._rowMultiple)),fieldKey:this.IdxToFieldKey(e,t),columnKey:this._columns[t].columnKey}};e.prototype.IdxToKey=function(e,t){return{recordKey:this._posConverter.ViewIdxToRecordKey(Math.floor(e/this._rowMultiple)),fieldKey:this.IdxToFieldKey(e,t),columnKey:this._columns[t].columnKey}};e.prototype.IdxToFieldKey=function(e,t){return this._columns[t].fieldKeys[e%this._rowMultiple]};e.prototype.KeyToIdx=function(e,t){var n=this._fieldKeyToRowOffset[t];if(null!=n){var r=this._posConverter.RecordKeyToViewIdx(e)*this._rowMultiple+n,i=this._fieldKeyToColIdx[t];if(null!=i)return{rowIdx:r,colIdx:i}}return null};e.prototype.GetTopRowIdxForKey=function(e){return this._posConverter.RecordKeyToViewIdx(e)*this._rowMultiple};e.prototype.GetTopRowIdx=function(){return this._posConverter.GetTopViewIdx()*this._rowMultiple};e.prototype.RowIdxToViewIdx=function(e){return Math.floor(e/this._rowMultiple)};e.prototype.RowIdxToRelRowIdx=function(e){return e-this._posConverter.GetTopViewIdx()*this._rowMultiple};e.prototype.RowIdxToRecordKey=function(e){return this._posConverter.ViewIdxToRecordKey(this.RowIdxToViewIdx(e))};e.prototype.RelRowIdxToRowIdx=function(e){return e+this._posConverter.GetTopViewIdx()*this._rowMultiple};e.prototype.ColKeyToColIdx=function(e){return this._colKeyToColIdx[e]};e.prototype.ColIdxToColKey=function(e){return this._columns[e].columnKey};e.prototype.ColKeyToFieldKeys=function(e){return this._columns[this._colKeyToColIdx[e]].fieldKeys};e.prototype.FieldKeyToColIdx=function(e){return this._fieldKeyToColIdx[e]};e.prototype.GetWholeRowDisplayCapacity=function(){return this._posConverter.GetWholeRowDisplayCapacity()*this._rowMultiple};e.prototype.GetRowMultiple=function(){return this._rowMultiple};e.prototype.GetRecordsInvolved=function(e,t,n){var r=this,i=(e-e%this._rowMultiple)/this._rowMultiple,s=Math.ceil((t+e%this._rowMultiple)/this._rowMultiple),o=this._posConverter.GetViewRecords(i,s,function(){var i=r.GetRecordsInvolved(e,t,n);null!=i&&n(i)});return o.recordSetComplete?(function(e){for(var t={},n=0;n<e.length;n++)t[e[n].key()]=e[n];return t})(o.records):null};e.prototype.IsRecordOnScreen=function(e){return this._posConverter.IsRecordOnScreen(e)};e.prototype.GetRecordKeysInvolved=function(e,t){for(var n=(e-e%this._rowMultiple)/this._rowMultiple,r=Math.ceil((t+e%this._rowMultiple)/this._rowMultiple),i=new Array(r),s=0;s<r;s++)i[s]=this._posConverter.ViewIdxToRecordKey(n+s);return i};e.prototype.GetVirtualRowCount=function(){return(this._posConverter.GetViewRecordCount()+this._objBag.entryRecordMgr.GetEntryRecords().length)*this._rowMultiple};e.prototype.GetVirtualColumnCount=function(){return this._columns.length};e.prototype.GetColumnByIdx=function(e){return this._columns[e]};e.prototype.GetColumnByKey=function(e){var t=this._colKeyToColIdx[e];return null==t?null:this._columns[t]};e.prototype.UpdateColumns=function(e,t){this._columns=e;this._fieldKeyToColIdx={};this._fieldKeyToRowOffset={};this._colKeyToColIdx={};for(var r=0;r<e.length;r++){this._colKeyToColIdx[e[r].columnKey]=r;var i=e[r].fieldKeys;t&&(this._rowMultiple=i.length);n.JsGridUtil.DebugAssert(i.length==this._rowMultiple);for(var s=0;s<this._rowMultiple;s++){this._fieldKeyToColIdx[i[s]]=r;this._fieldKeyToRowOffset[i[s]]=s}this._objBag.columnKeys&&("JSGrid_NewColumn"!=e[r].columnKey&&"Title"!=e[r].columnKey?this._objBag.columnKeys[r]='{"spField_216":["'+e[r].columnKey+'"]}':"Title"==e[r].columnKey&&(this._objBag.columnKeys[r]='{"spField_216":["LinkTitle"]}'))}};return e})();t.GridPaneConverter=r});
define("aQJ",["require","exports","g","f","aQo","aPS","aQw","di","qv","pE","bt","aPM","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";var p=h.tablemgr_9;h=h.headermgr_6;Object.defineProperty(t,"__esModule",{value:!0});var d={ODB:1725},v=s.JsGridConstants.Internal.ColumnHeaderHeight,m=l.Killswitch.isActivated("9340DEC3-CF41-4D00-BDD8-2AA84E33D2C2","2/05/2020","Make headers accessible with keyboard only."),g=l.Killswitch.isActivated("D132AFD6-52B6-4C09-98A9-18CE1F461F78","4/13/2020","Making sure not to hide the resize bar to early on mouse move."),y=(function(){function e(e,t,s,o){var u=this;this.ElementState={Normal:1,Hover:2,Clicked:3};this._headerChildObjects={};this._columnInfoMap={};this._partsEnabled={};this._initalColorMap={};this._styles={};this._lockedElements={};this._sortStates={};this._filterStates={};this._activeColumn=null;this._dropDownMenuVisible=!1;this._currentEditColumnKey=null;this.constMenuWidth=15;this.constEyeBrowHeight=5;this.constResizeWidth=5;this.RenderDetailsColumn=function(e){var t=u._columnInfoMap[e],s=u._headerChildObjects[e],o=s?s.coreContent:null,l=s?s.dropHint:null;if(t&&o){var c=t.column,h=t.columnIndex,p=c.isSortable?u._sortStates[e]:void 0,v=!!p,m=-1===p,g=u._filterStates.hasOwnProperty(e);n.render(r.createElement(a.DetailsColumn,{column:{name:c.name,key:c.columnKey,columnActionsMode:f.ColumnActionsMode.hasDropdown,minWidth:c.width,isSorted:v,isSortedDescending:m,isFiltered:g,isIconOnly:c.isIconOnly,iconName:c.iconName},columnIndex:h+1,styles:{root:[{padding:0,lineHeight:32,width:"100%",overflow:c.isIconOnly?"hidden":void 0},i.JsGridUtil.Internal.IsFeatureEnabled(d)&&{display:"flex",alignItems:"center"}],cellTooltip:[{position:"relative"},i.JsGridUtil.Internal.IsFeatureEnabled(d)&&{minWidth:0}],cellTitle:{paddingLeft:c.isFooter?4:12,paddingRight:8}},isDraggable:!c.isFooter,updateDragInfo:u._dragDropMgr._updateDragInfo,dragDropHelper:u._dragDropMgr.getDragDropHelper(),isDropped:u._dragDropMgr._onDropIndexInfo?u._dragDropMgr._onDropIndexInfo.targetIndex===h:null}),o);l&&u._dragDropMgr.renderDropHint&&n.render(u._dragDropMgr.renderDropHint(h+1),l)}};this.constCoreContentPadding=0;this.borderMap={menu:e.RTL.Left,resize:e.RTL.Right,eyeBrow:"Bottom"};this._objBag=e;this._styleMgr=t;this._fnGetLocStr=s;this._fnUpdatePositionedElements=o;this._dragDropMgr=this._objBag.dragDropMgr;this._focusMgr=this._objBag.focusMgr;this.CreateCoreContentMeasuringElement()}e.prototype.CreateCoreContentMeasuringElement=function(){var e=this._styleMgr.columnHeaderStyleCollection.normal,t=null!=e.font?"font-family:"+e.font+";":"";this._coreContentBaseCssText=u.format("text-align:{0};padding-{0}:{1}px;{2}font-size:{3};font-weight:{4};",this._objBag.RTL.left,this.constCoreContentPadding,t,e.fontSize,e.fontWeight);var n=document.createElement("table");n.style.cssText="position:absolute;visibility:hidden;top:0px;left:0px;width:0px;height:0px;";n.insertRow(-1);var r=document.createElement("th");n.rows[0].appendChild(r);this._coreContentWidthMeasuringElement=document.createElement("div");this._coreContentWidthMeasuringElement.className=i.JsGridUtil.Internal.IsFeatureEnabled(d)?h.spGridHeaderCoreContent:"jsgrid-header-core-content";this._coreContentWidthMeasuringElement.style.cssText=this._coreContentBaseCssText;r.appendChild(this._coreContentWidthMeasuringElement);this._objBag.parentNode.appendChild(n)};e.prototype.CalculateChildObjects=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetChildrenWithCustomAttribute(e,"colid");t.th=e;return t};e.prototype.CreateTableHeaderCell=function(e,t,n,r,o,u,a,f,l,c){var g=this,y=r&&!e.bOpenMenuOnContentClick&&!e.isFooter,b=y?"move":"default",w=o&&e.isResizable,E=e.bOpenMenuOnContentClick,S=(null!=e.imgSrc||!!e.iconName)&&E;this._columnInfoMap[e.columnKey]={column:e,columnIndex:c};var x,T,N,C,k,L=[];if(i.JsGridUtil.Internal.IsFeatureEnabled(d)){x=v;T="position:absolute;right:1px";N='class="'+h.resizeContainer+'" ';C="";k="height:"+v+"px"}else{x=32;T="float:"+this._objBag.RTL.right+";position:relative";C='<div style="width:1px;height:100%;left:9px;position:relative;background-color:#c8c8c8;"></div>';N="";k="left:1px;top:7px"}L.push('<div colid="resizeRight" ');L.push(N);L.push((w?'colAction="resize-current"':"")+'style="'+T);L.push(";cursor:"+(w?"w-resize":"default"));L.push(w?";width:16px;height:"+x+"px;margin-left:-8px;margin-right:-8px":"");L.push(';z-index:1;opacity:0">');L.push((w?C:"")+"</div>");if(!e.isFooter){L.push('<div colid="dropHint" ');L.push('style="float:');L.push(this._objBag.RTL.right);L.push(";z-index:1;position:relative;"+k+'">');L.push("</div>")}L.push('<div colid="move" '+(y?'colAction="move"':"")+' style="white-space:nowrap;overflow:auto;" class="ms-positionRelative">');L.push('<div colid="resize" ');L.push('style="float:');L.push(this._objBag.RTL.left+";");L.push("position:absolute;");L.push('"></div>');L.push('<div colid="content" ');L.push('style="cursor:'+b+';"><div colid="coreContent" coltype="text" ');L.push('style="'+this._coreContentBaseCssText+"cursor:"+b+';" unselectable="true">');L.push("</div>");L.push("</div></div>");L.push("</div>");t.innerHTML=L.join("");var A=e.columnKey,O=this._headerChildObjects[A]=this.CalculateChildObjects(t);this._partsEnabled[A]={selection:a,move:y,resize:w};if(null!=f){t.addEventListener("click",function(e){var t=i.JsGridUtil.Internal.GetEventSrcElement(e);if(null!=t&&null==t.getAttribute("colAction")){var n=t.getAttribute("colid");"resize"!=n&&"resizeRight"!=n&&f(e,A)}});if(!m){t.addEventListener("keydown",function(e){if(null===document.getElementById(A+"_"+g._focusMgr._gridPane.Id+"_focusElement")){e.keyCode!==s.JsGridConstants.Key.enter&&e.keyCode!==s.JsGridConstants.Key.space||f(e,A);if(e.keyCode===s.JsGridConstants.Key.right){for(var t=0,n=Object.keys(g._columnInfoMap),r=0;r<n.length;r++)g._columnInfoMap.hasOwnProperty(n[r])&&g._columnInfoMap[n[r]].columnIndex>t&&(t=g._columnInfoMap[n[r]].columnIndex);if(c<t){g._focusMgr._gridPane.SetFocusToHeader(c+2);e.preventDefault();e.stopPropagation()}}if(e.keyCode===s.JsGridConstants.Key.left&&c>=1){g._focusMgr._gridPane.SetFocusToHeader(c);e.preventDefault();e.stopPropagation()}e.keyCode===s.JsGridConstants.Key.down&&g._focusMgr.Focus()}})}}if(S){O.menuImg&&(O.menuImg.style.display="none");O.menu&&(O.menu.style.visibility="hidden")}if("DocIcon"===e.columnKey){e.iconName="page";e.isIconOnly=!0}this.RenderDetailsColumn(e.columnKey);null!=e.name&&(t.title=e.name);this._fnGetHeaderSibling=l;i.JsGridUtil.DebugAssert(null!=e.width&&e.width>=e.isIconOnly?s.JsGridConstants.Internal.IconColumnWidth:s.JsGridConstants.Internal.MinColumnWidth,"Column width should have been adjusted via headerMgr.AdjustColumnWidth(column)!");t.thColumnKey=A;t.nowrap="nowrap";null!=this._activeColumn&&this._activeColumn.thColumnKey==A&&(this._activeColumn=null);if(i.JsGridUtil.Internal.IsStickyColumnEnabled())if(0===c){t.classList.add(p.gridStickyDataColumn);t.classList.add(p.gridStickyDataColumnHeader);e.isSticky=!0}else e.isSticky=!1;return t=O=null};e.prototype.UpdateHeader=function(e,t){var n=this._headerChildObjects[e.thColumnKey].resize;if(null!=t&&this._partsEnabled[t.thColumnKey].resize){n.colAction="resize";n.style.cursor="w-resize"}else if(this._partsEnabled[e.thColumnKey].move){n.colAction="move";n.style.cursor="move"}else{n.colAction=null;n.style.cursor="default"}};e.prototype.NotifyColumnHeaderOrderSet=function(e){for(var t=e,n=null;null!=t;){this.UpdateHeader(t,n);n=t;t=this._fnGetHeaderSibling(t,!1)}};e.prototype.DisposeHeader=function(e){null!=this._curHighlightedElem&&this._curHighlightedElem.columnKey==e.thColumnKey&&(this._curHighlightedElem=null);null!=this._curActingColumnInfo&&this._curActingColumnInfo.key==e.thColumnKey&&(this._curActingColumnInfo=null);var t=this._headerChildObjects[e.thColumnKey]&&this._headerChildObjects[e.thColumnKey].menu;null!=t&&i.JsGridUtil.ClearEventListeners(t);delete this._headerChildObjects[e.thColumnKey];delete this._styles[e.thColumnKey];delete this._initalColorMap[e.thColumnKey];delete this._partsEnabled[e.thColumnKey];delete this._lockedElements[e.thColumnKey];e.thColumnKey=null};e.prototype.Dispose=function(){var e=[];for(var t in this._headerChildObjects)e.push(this._headerChildObjects[t].th);for(var n=e.length-1;n>=0;n--){delete this._sortStates[e[n].thColumnKey];this.DisposeHeader(e[n])}this._activeColumn=this._headerChildObjects=this._curActingColumnInfo=this._curHighlightedElem=this._lockedElements=this._partsEnabled=this._sortStates=null};e.prototype.ApplyHeaderStyle=function(e,t,n){var r=this._headerChildObjects[e.thColumnKey],s=i.JsGridUtil.Internal.IsFeatureEnabled(d);if(null==this._curActingColumnInfo||this._curActingColumnInfo.key!=e.thColumnKey){if(e.headerStyleType!==t.type){this._initalColorMap[e.thColumnKey]={};s?e.className+=" "+h.gridHeaderCell:e.style["border"+this._objBag.RTL.Right]=o.StyleUtil.MakeBorderString(1,"solid ",t.innerBorderColor);if(null!=r){null!=t.font&&(r.coreContent.style.fontFamily=t.font);r.coreContent.style.fontSize=t.fontSize;r.coreContent.style.fontWeight=t.fontWeight;r.coreContent.style.color=t.textColor;null!=r.sortA&&null!=r.sortA.style&&(r.sortA.style.color=t.textColor);e.style.backgroundColor=r.resize.style.backgroundColor=t.backgroundColor;r.resize.style["border"+this._objBag.RTL.Right]=o.StyleUtil.MakeBorderString(1,"solid ",t.backgroundColor)}if(null!=r&&null!=r.eyeBrow){this._initalColorMap[e.thColumnKey].eyeBrow={};this._initalColorMap[e.thColumnKey].eyeBrow.bg=r.eyeBrow.style.backgroundColor=t.eyeBrowColor;this._initalColorMap[e.thColumnKey].eyeBrow.border=r.eyeBrow.style["border"+this.borderMap.eyeBrow+"Color"]=t.eyeBrowBorderColor}else{delete this._initalColorMap[e.thColumnKey].eyeBrow;null!=t.innerBorderColor&&(e.style.borderTop=o.StyleUtil.MakeBorderString(1,"solid ",t.innerBorderColor))}s||(e.style.borderBottom=o.StyleUtil.MakeBorderString(1,"solid ",t.outerBorderColor));this._initalColorMap[e.thColumnKey].move=e.style.backgroundColor=t.backgroundColor;if(null!=r&&null!=r.menu){this._initalColorMap[e.thColumnKey].menu={};this._initalColorMap[e.thColumnKey].menu.bg=r.menu.style.backgroundColor=t.menuColor;null!=t.menuBorderColor&&(this._initalColorMap[e.thColumnKey].menu.border=r.menu.style.borderColor=t.menuBorderColor)}else delete this._initalColorMap[e.thColumnKey].menu;null!=r&&(r.resizeRight.style.backgroundColor=null!=r.menu&&"inline-block"==r.menu.style.display?t.menuColor:t.backgroundColor);this._styles[e.thColumnKey]=t}e.headerStyleType=t.type;e.headerStyleBorderString=o.StyleUtil.MakeBorderString(1,"solid",t.outerBorderColor);e.headerStyleInnerBorderString=o.StyleUtil.MakeBorderString(1,"solid",t.innerBorderColor);var u=this._fnGetHeaderSibling(e,!0);null==u||s||(null!=t.innerBorderColor?u.style["border"+this._objBag.RTL.Right]=l(u,e).headerStyleInnerBorderString:u.style["border"+this._objBag.RTL.Right]=l(u,e).headerStyleBorderString);if(null!=this._partsEnabled[e.thColumnKey]&&null!=this._partsEnabled[e.thColumnKey].resize){var a=this._fnGetHeaderSibling(e,!1);if(null!=a&&null!=this._headerChildObjects[a.thColumnKey]&&null!=this._initalColorMap[a.thColumnKey]){s||(null!=t.innerBorderColor?e.style["border"+this._objBag.RTL.Right]=l(a,e).headerStyleInnerBorderString:e.style["border"+this._objBag.RTL.Right]=l(a,e).headerStyleBorderString);var f=this._headerChildObjects[a.thColumnKey].resize;if(n){this._initalColorMap[a.thColumnKey].resize={};this._initalColorMap[a.thColumnKey].resize.bg=f.style.backgroundColor=this._styles[a.thColumnKey].resizeColor;this._initalColorMap[a.thColumnKey].resize.border=f.style["border"+this.borderMap.resize+"Color"]=this._styles[a.thColumnKey].resizeBorderColor}else{this._initalColorMap[a.thColumnKey].resize={};this._initalColorMap[a.thColumnKey].resize=f.style.backgroundColor=f.style["border"+this.borderMap.resize+"Color"]=this._styles[a.thColumnKey].backgroundColor}}}}else this._curActingColumnInfo.curStyle=t;function l(e,t){i.JsGridUtil.DebugAssert(null!=e.headerStyleType||null!=t.headerStyleType);return null==e.headerStyleType?t:null==t.headerStyleType||e.headerStyleType>t.headerStyleType?e:t}};e.prototype.ApplyHeaderClassnames=function(e){for(var t=this._objBag.paneMgr.GetGridPane(),n=this._objBag.selectionMgr,r=e.GetColIdx(),i=n.GetRowRanges(t),s=!1,o=0;o<i.length;o++)i[o].Contains(0)&&(s=!0);if(0===i.length||s){for(var u=n.GetCellRanges(t),a=0;a<u.length;a++)if(u[a].colRange.Contains(r)&&!u[a].rowRange.Contains(0)){e.GetTd().classList.add(h.columnIsActive);return}e.GetTd().classList.remove(h.columnIsActive)}else e.GetTd().classList.add(h.columnIsActive)};e.prototype.GetColumnHeaderAutoResizeWidth=function(e){var t=this._headerChildObjects[e.thColumnKey];return null!=t.coreContent?e.offsetWidth+Math.max(t.coreContent.scrollWidth-t.coreContent.offsetWidth,0):e.offsetWidth};e.prototype.AdjustColumnWidth=function(e){if(null==e.width||e.width<=0){e.width=s.JsGridConstants.Internal.MinColumnWidth;if(null!=e.name){i.JsGridUtil.Internal.DomElement.GetInstance().SetText(this._coreContentWidthMeasuringElement,e.name);var t=this._dropDownMenuVisible?this.constMenuWidth+10:0;e.width=this._coreContentWidthMeasuringElement.scrollWidth+this.constResizeWidth+this.constResizeWidth+t}}"JSGrid_NewColumn"===e.columnKey?e.width=Math.max(e.width,s.JsGridConstants.Internal.IconColumnWidth):i.JsGridUtil.Internal.IsFeatureEnabled(d)&&"DocIcon"===e.columnKey?e.width=Math.max(e.width,s.JsGridConstants.Internal.IconColumnNewWidth):e.width=Math.max(e.width,s.JsGridConstants.Internal.MinColumnWidth)};e.prototype.ResizeColumn=function(e,t){this._objBag.bUpdateCoordCache=!0};e.prototype.ShowMenuOnColumn=function(e){if(this._activeColumn!==e&&null!=e.thColumnKey){null!=this._headerChildObjects[e.thColumnKey].menu&&(this._activeColumn=e)}};e.prototype.GetChildObjects=function(e){return this._headerChildObjects[e]};e.prototype.GetColumnHeaderElement=function(e){var t=this._headerChildObjects[e];return null!=t?t.th:null};e.prototype.GetColumnHeaderPosition=function(e){var t=this._headerChildObjects[e],n=null;null!=t&&(n=t.th);if(null==n)return null;var r=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(n);return{left:r.x,width:n.offsetWidth,top:r.y+(this._objBag.RTL.bEnabled?4:0),height:n.offsetHeight}};e.prototype.GetColumnMenuElementPosition=function(e){var t=this._headerChildObjects[e].menu;if(null==t)return null;var n=this._headerChildObjects[e].resizeRight,r=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(t),s=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(n);return{left:Math.min(r.x,s.x),width:t.offsetWidth+n.offsetWidth,top:r.y+(this._objBag.RTL.bEnabled?4:0),height:t.offsetHeight}};e.prototype.OnSort=function(e,t){i.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);e.preventDefault();this._objBag.delegateMgr.Apply(s.JsGridConstants.DelegateType.Sort,[{columnName:t,isDescending:1==this._sortStates[t]}])};e.prototype.RenameColumn=function(e,t){var n,r=this,o=i.JsGridUtil.Internal.IsFeatureEnabled(d),u=null,a=function(e){null==u&&(u=setTimeout(function(){f(e)},50))},f=function(o){var u=c.TrimSpaces(n.value);r.SetColumnEdited(e);n.removeEventListener("blur",a);n.removeEventListener("keydown",l);if(u.length<1){alert(r._fnGetLocStr("RenameColumn_BlankColumnName"));u=N}T.name=u;r._columnInfoMap[T.columnKey].column.name=u;r.RenderDetailsColumn(T.columnKey);E.title=u;E.style.width=S;E.style.minWidth=x;y.className=b;n.parentNode.replaceChild(w,n);if(u!==N){T.width=null;r.AdjustColumnWidth(T);r.ResizeColumn(E,T.width)}r._objBag.bUpdateCoordCache=!0;i.JsGridUtil.DebugAssert(null!=r._fnUpdatePositionedElements);null!=r._fnUpdatePositionedElements&&r._fnUpdatePositionedElements();r._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnEndRenameColumn,i.JsGridUtil.EventArgs.OnEndRenameColumn(e,N,u));t&&t();E.focus()},l=function(e){e&&e.keyCode==s.JsGridConstants.Key.esc&&(n.value=N);!e||e.keyCode!=s.JsGridConstants.Key.tab&&e.keyCode!=s.JsGridConstants.Key.enter||n.blur()},p=function(e){null!=u&&clearTimeout(u);e.stopPropagation()};this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnBeginRenameColumn);this._objBag.selectionMgr.Clear(!1);var v=this._objBag.paneMgr.GetGridPane(),m=v.GetGridPaneConverter(),g=this._headerChildObjects[e],y=g.content,b=y.className,w=g.coreContent,E=(function(e){for(;e&&"TH"!==e.tagName;)e=e.parentNode;return e})(w),S=E.style.width,x=E.style.minWidth,T=m.GetColumnByKey(e),N=T.name;this.SetColumnEditing(e);(function(){(n=document.createElement("input")).id=e+"_"+v.Id+"_focusElement";n.className="jsgrid-control-header-editbox";n.value=N;n.style.width=E.clientWidth-(o?24:20)+"px";n.setAttribute("type","text");n.setAttribute("colAction","rename");n.addEventListener("blur",a.bind(r));n.addEventListener("keydown",l.bind(r));n.addEventListener("mousedown",p.bind(r));n.addEventListener("mouseup",p.bind(r));n.addEventListener("click",p.bind(r));var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetComputedStyle(E,"width","width");E.style.width=t;E.style.minWidth=t;y.className=o?h.renameInputContainer:"ms-spGrid-HeaderContentStyle-Rename";w.parentNode.replaceChild(n,w);n.focus()})();n.select()};e.prototype.ColumnIsPresent=function(e){return e in this._headerChildObjects};e.prototype.UpdateColorFromEventInfo=function(e,t){var n=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"thColumnKey");if(null!=n&&this.ColumnIsPresent(n.elem.thColumnKey)){var r=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"colid");if(null!=r&&this.UpdateColor(n.elem.thColumnKey,r.elem,t))return r.elem}return null};e.prototype.UpdateColor=function(e,t,n){var r=i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(t,"colid");if("move"==i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(t,"colAction"))return!1;if("resizeRight"==r){var s=this._fnGetHeaderSibling(this._headerChildObjects[e].th,!1);if(null!=s){r="resize";e=s.thColumnKey}else r="menu"}null==r||!(e in this._initalColorMap)||!(r in this._initalColorMap[e])||e in this._lockedElements&&r in this._lockedElements[e]||("eyeBrow"!==r||this._partsEnabled[e].selection)&&(n==this.ElementState.Normal?this.ApplyColorToElem(e,r,this._initalColorMap[e][r].bg,this._initalColorMap[e][r].border):n==this.ElementState.Hover?this.ApplyColorToElem(e,r,this._styles[e][r+"HoverColor"],this._styles[e][r+"HoverBorderColor"]):n==this.ElementState.Clicked&&this.ApplyColorToElem(e,r,this._styles[e].elementClickColor,this._styles[e].elementClickBorderColor));return!0};e.prototype.ApplyColorToElem=function(e,t,n,r){if(null!=n){this._headerChildObjects[e][t].style.backgroundColor=n;"menu"==t&&(this._headerChildObjects[e].resizeRight.style.backgroundColor=n)}null!=r&&(this._headerChildObjects[e][t].style["border"+this.borderMap[t]+"Color"]=r)};e.prototype.ClearSort=function(e){delete this._sortStates[e];this.RenderDetailsColumn(e)};e.prototype.SetColumnSortState=function(e,t){delete this._sortStates[e];if(1==t||-1==t){this._sortStates[e]=t;null!=this._headerChildObjects[e]&&this.RenderDetailsColumn(e)}else this.ClearSort(e)};e.prototype.ClearColumnFiltered=function(e){delete this._filterStates[e];this.RenderDetailsColumn(e)};e.prototype.SetColumnFiltered=function(e){this._filterStates[e]=null;this.RenderDetailsColumn(e)};e.prototype.SetSortState=function(e){for(var t in this._sortStates)this.ClearSort(t);if(null!=e)for(var n=0;n<e.length;n++)this.SetColumnSortState(e[n].fieldKey,e[n].isDescending?-1:1)};e.prototype.SetFilterState=function(e){for(var t in this._filterStates)this.ClearColumnFiltered(t);if(null!=e)for(var n=0;n<e.length;n++)this.SetColumnFiltered(e[n])};e.prototype.HeaderMouseDown=function(e){this.UpdateColorFromEventInfo(e,this.ElementState.Clicked)};e.prototype.HeaderMouseUp=function(e){this.UpdateColorFromEventInfo(e,this.ElementState.Normal)};e.prototype.HeaderMouseMove=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"thColumnKey");if(null!=t&&this.ColumnIsPresent(t.elem.thColumnKey)){var n=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"colid");if(null!=n&&null!=n.elem){var r=i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(n.elem,"colid");"resizeRight"===r&&(this._headerChildObjects[t.elem.thColumnKey][r].style.opacity=1)}}};e.prototype.HeaderMouseOut=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"thColumnKey");if(null!=t&&this.ColumnIsPresent(t.elem.thColumnKey)){var n=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"colid");if(null!=n&&null!=n.elem){var r=i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(n.elem,"colid");"resizeRight"===r&&(g?this._headerChildObjects[t.elem.thColumnKey][r].style.opacity=0:this._columnIsResizing||(this._headerChildObjects[t.elem.thColumnKey][r].style.opacity=0))}}};e.prototype.InColumnHeaderEditMode=function(){return null!=this._currentEditColumnKey};e.prototype.ColumnCurrentlyEditing=function(e){return this._currentEditColumnKey==e};e.prototype.SetColumnSelected=function(e){this.LockItem(e,"eyebrow")};e.prototype.SetColumnUnselected=function(e){this.UnlockItem(e,"eyebrow")};e.prototype.SetColumnMenuExpanded=function(e){};e.prototype.SetColumnMenuCollapsed=function(e){};e.prototype.SetColumnMoving=function(e){this.LockItem(e,"move",!0)};e.prototype.SetColumnMoved=function(e){this.UnlockItem(e,"move",!0)};e.prototype.SetColumnResizing=function(e){this._columnIsResizing=!0;this.LockItem(e,"resize",!0)};e.prototype.SetColumnEdited=function(e){this._currentEditColumnKey=null;this.UnlockItem(e,"coreContent",!0)};e.prototype.SetColumnEditing=function(e){this._currentEditColumnKey=e;this.LockItem(e,"coreContent",!0)};e.prototype.SetColumnResized=function(e){this._columnIsResizing=!1;this.UnlockItem(e,"resize",!0)};e.prototype.LockColumn=function(e){null!=this._curActingColumnInfo&&i.JsGridUtil.DebugAssert(!1);this._curActingColumnInfo={};this._curActingColumnInfo.key=e};e.prototype.UnLockColumn=function(){if(null!=this._curActingColumnInfo){var e=this._curActingColumnInfo;this._curActingColumnInfo=null;null!=e.curStyle&&this.ApplyHeaderStyle(this._headerChildObjects[e.key].th,e.curStyle)}};e.prototype.LockItem=function(e,t,n){this.UpdateColor(e,this._headerChildObjects[e][t],this.ElementState.Clicked);null==this._lockedElements[e]&&(this._lockedElements[e]={});this._lockedElements[e][t]="";n&&this.LockColumn(e)};e.prototype.UnlockItem=function(e,t,n){i.JsGridUtil.DebugAssert(e in this._lockedElements&&t in this._lockedElements[e]);if(e in this._lockedElements&&t in this._lockedElements[e]){delete this._lockedElements[e][t];i.JsGridUtil.Internal.IsAssocArrayEmpty(this._lockedElements[e])&&delete this._lockedElements[e];null!=this._curActingColumnInfo&&this._curActingColumnInfo.key==e&&this.UnLockColumn();this.ColumnIsPresent(e)&&this.UpdateColor(e,this._headerChildObjects[e][t],this._headerChildObjects[e][t]==this._curHighlightedElem?this.ElementState.Hover:this.ElementState.Normal)}};return e})();t.HeaderManager=y});
define("aQH",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t){this._touchableActions=t||{};this.Init()}e.prototype.Init=function(){};e.prototype.RegisterTouchableAction=function(e,t){this._touchableActions[e]=t};e.prototype.UnregisterTouchableAction=function(e){delete this._touchableActions[e]};e.prototype.Dispose=function(){null!=this._touchManager&&this._touchManager.Dispose()};return e})();t.GridTouchManager=n});
define("aQE",["require","exports","aQo","aPS","aPY","aQA","aQz","di"],function(require,exports,gridutil_1,constants_1,property_1,jsgridobj_1,tablecache_1,StringHelper){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var QuickEditVisualRefreshFlight={ODB:1725};function AdjustPrintPreviewGridDivWidth(e,t,n,r){for(var i=0,s=0;s<e.length;++s)e[s].isVisible&&(i+=e[s].width);i+=t?gridutil_1.JsGridUtil.Internal.IsFeatureEnabled(QuickEditVisualRefreshFlight)?constants_1.JsGridConstants.Internal.RowHeaderWidthNewStyles:constants_1.JsGridConstants.Internal.RowHeaderWidth:0;i+=n?constants_1.JsGridConstants.Internal.SplitterWidth+r:0;i+=2;document.getElementById("jsgrid_div_element").style.width=i+"px";return i}var PrintPreviewGrid=(function(){function e(){this._bLimitRecordSize=!1;this._enableGantt=!1;this._ganttDelegateNames=null}e.prototype.Init=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g=this;this._enableGantt=c;this._ganttDelegateNames=h;this._ganttPaneWidth=p;this._ganttZoomLevel=d;this._groupingStyles=n;property_1.PropertyType.Internal.Property.GetInstance().RegisterDefaultPropTypesFromDefaultDisplayControlMap(s,o);var y=this.CallGlobalFunc(u,[a]);this._jsGridControl=e;this._jsGridParams=new jsgridobj_1.JsGridControlParameters;this._jsGridParams.name=StringHelper.format(SP.JsGrid.Res.printPreviewName,this._jsGridControl.name);this._jsGridParams.tableViewParams=t;for(var b in this._jsGridParams.tableViewParams.gridFieldMap){var w=this._jsGridParams.tableViewParams.gridFieldMap[b];null!=w._propType&&(w._propType.ID in o||!w._propType.bMultiValue?property_1.PropertyType.Internal.Property.GetInstance().PropTypeExists(w._propType.ID)&&(w._propType=property_1.PropertyType.Internal.Property.GetInstance().GetPropType(w._propType.ID)):w._propType.bMultiValue&&(w._propType=new property_1.PropertyType.MultiValuePropType(w._propType.singleValuePropType.ID,w._propType.separator,!property_1.PropertyType.Internal.Property.GetInstance().PropTypeExists(w._propType.singleValuePropType.ID))))}null!=y&&"function"==typeof y&&y(this._jsGridParams,this._jsGridControl);this.CallGlobalFunc(f,[this._jsGridParams.tableViewParams,l]);this.CallGlobalFunc(v,[this._jsGridParams.tableViewParams,this._jsGridControl,m]);this._tableCache=new tablecache_1.TableCache(null,function(e,t){var n=new Array(t.length);for(var r in t){var i=e[t[r]],s=g._recordFactory.MakeRecord(i.data,i.localized,g._bLimitRecordSize);s.fieldRawDataMap=i.fieldRawDataMap;s.fieldRawLocMap=i.fieldRawLocMap;n[t[r]]=s}return n});this.LoadDataIntoTableCache(r,t.gridFieldMap,i);this._jsGridParams.tableCache=this._tableCache;this.SetJsGridParameters();this._jsGridControl.Init(this._jsGridParams);window.document.body.addEventListener("mouseup",function(){var e=document.getElementById("jsgrid_div_element").clientWidth,t=AdjustPrintPreviewGridDivWidth(g._jsGridControl.GetColumns(),g._jsGridParams.tableViewParams.bRowHeadersEnabled,g._enableGantt,g._ganttPaneWidth);g._jsGridControl.NotifyResize();if(g._enableGantt){var n=g._jsGridControl.GetSplitterPosition();g._jsGridControl.SetSplitterPosition(n+(t-e))}});setTimeout(function(){window.print()},0)};e.prototype.CallGlobalFunc=function(e,t){if(null==e)return null;for(var n=e.split("."),r=window,i=0;i<n.length;++i){if(i==n.length-1&&n[i]in r&&"function"==typeof r[n[i]])return r[n[i]].apply(null,t);if(!(n[i]in r))break;r=r[n[i]]}return null};e.prototype.LoadDataIntoTableCache=function(e,t,n){this._tableCache.Clear();this._tableCache.AddRawDataToCache(gridutil_1.JsGridUtil.Internal.ConvertSetKeysToArray(e),e);this._recordFactory=new property_1.PropertyType.RecordFactory(t,n)};e.prototype.SetJsGridParameters=function(){this._jsGridParams.styleManager.groupingStyles=this._groupingStyles;if(this._enableGantt){this._jsGridParams.tableViewParams.splitterPos=document.getElementById("jsgrid_div_element").clientWidth,this._ganttPaneWidth,constants_1.JsGridConstants.Internal.SplitterWidth;this._jsGridParams.tableViewParams.ganttParams.ganttZoomLevel=this._ganttZoomLevel;if(null!=this._ganttDelegateNames){null!=this._ganttDelegateNames.fnGetGanttBarDate&&this._ganttDelegateNames.fnGetGanttBarDate in window&&(this._jsGridParams.tableViewParams.ganttParams.fnGetGanttBarDate=window[this._ganttDelegateNames.fnGetGanttBarDate]);null!=this._ganttDelegateNames.fnGetGanttBarStyleIds&&this._ganttDelegateNames.fnGetGanttBarStyleIds in window&&(this._jsGridParams.tableViewParams.ganttParams.fnGetGanttBarStyleIds=window[this._ganttDelegateNames.fnGetGanttBarStyleIds]);null!=this._ganttDelegateNames.fnRenderGanttRow&&this._ganttDelegateNames.fnRenderGanttRow in window&&(this._jsGridParams.tableViewParams.ganttParams.fnRenderGanttRow=window[this._ganttDelegateNames.fnRenderGanttRow]);null!=this._ganttDelegateNames.fnGetPredecessors&&this._ganttDelegateNames.fnGetPredecessors in window&&(this._jsGridParams.tableViewParams.ganttParams.fnGetPredecessors=window[this._ganttDelegateNames.fnGetPredecessors])}}else{this._jsGridParams.tableViewParams.ganttParams=null;this._jsGridParams.tableViewParams.paneLayout=constants_1.JsGridConstants.PaneLayout.GridOnly}this._jsGridParams.tableViewParams.bMovableColumns=!0;this._jsGridParams.tableViewParams.bResizableColumns=!0;this._jsGridParams.tableViewParams.bEditingEnabled=!1;this._jsGridParams.tableViewParams.allowedSelectionTypes=0;this._jsGridParams.tableViewParams.bNewRowEnabled=!1;this._jsGridParams.tableViewParams.bSortableColumns=!1;this._jsGridParams.tableViewParams.bHidableColumns=!1;this._jsGridParams.tableViewParams.bAutoFilterableColumns=!1;this._jsGridParams.tableViewParams.bRecordIndicatorCheckboxesEnabled=!1};return e})();exports.PrintPreviewGrid=PrintPreviewGrid;function CreatePrintPreviewBlobFromRecords(e){for(var t={},n=0;n<e.length;++n){var r=e[n],i={},s={};for(var o in r.properties){i[o]=r.properties[o].dataValue;r.properties[o].HasLocalizedValue()&&(s[o]=r.properties[o].localizedValue)}t[r.key()]={data:i,localized:s,fieldRawDataMap:r.fieldRawDataMap,fieldRawLocMap:r.fieldRawLocMap}}return t}function GetSerializedUnfilteredHierarchyManagerClone(e){return JSON.stringify({unfilteredHierMap:e.rowViewParams.unfilteredHierarchyMgr.GetUnfilteredHierarchyMap(),topNodeKey:e.rowViewParams.unfilteredHierarchyMgr.GetTopNodeKey()})}function GetSerializedTableViewParametersClone(e){var t={};for(var n in e.gridFieldMap)t[n]=GetSerializedGridFieldClone(e.gridFieldMap[n]);return JSON.stringify({simpleFields:{messageOverrides:e.messageOverrides,operationalConstantsFieldKeyMap:e.operationalConstantsFieldKeyMap,defaultEditMode:e.defaultEditMode,allowedSelectionTypes:e.allowedSelectionTypes,bMovableColumns:e.bMovableColumns,bResizableColumns:e.bResizableColumns,bHidableColumns:e.bHidableColumns,bSortableColumns:e.bSortableColumns,bAutoFilterableColumns:e.bAutoFilterableColumns,bRowHeadersEnabled:e.bRowHeadersEnabled,bRecordIndicatorCheckboxesEnabled:e.bRecordIndicatorCheckboxesEnabled,checkSelectionCheckboxHiddenRecordKeys:e.checkSelectionCheckboxHiddenRecordKeys,checkSelectionCheckboxDisabledRecordKeys:e.checkSelectionCheckboxDisabledRecordKeys,checkSelectionCheckedRecordKeys:e.checkSelectionCheckedRecordKeys,bEditingEnabled:e.bEditingEnabled,bNewRowEnabled:e.bNewRowEnabled,hierarchyKey:e.hierarchyKey,splitterPos:e.splitterPos,paneLayout:e.paneLayout,rowViewParams:e.rowViewParams},gridFieldMap:JSON.stringify(t),columns:GetSerializedColumnInfoCollectionClone(e.columns),pivotedGridParams_columns:null==e.pivotedGridParams?null:GetSerializedColumnInfoCollectionClone(e.pivotedGridParams.columns),ganttParams:null==e.ganttParams?null:GetSerializedGanttParametersClone(e.ganttParams),unfilteredHierarchyMgr:null==e.rowViewParams.unfilteredHierarchyMgr?null:GetSerializedUnfilteredHierarchyManagerClone(e)})}function GetSerializedGanttParametersClone(e){return JSON.stringify({dateRange:e.dateRange,ganttBarStyles:e.ganttBarStyles,ganttZoomLevel:e.ganttZoomLevel})}function GetSerializedGridFieldClone(e){return JSON.stringify({key:e.key,hasDataValue:e.hasDataValue,hasLocalizedValue:e.hasLocalizedValue,textDirection:e.textDirection,_defaultCellStyleId:e._defaultCellStyleId,_editMode:e._editMode,_propType:e._propType,_multiValue:e._multiValue})}function GetSerializedCloneFromColumnInfo(e){return"column"==e.ColumnType()?JSON.stringify({name:e.name,imgSrc:e.imgSrc,columnKey:e.columnKey,fieldKeys:e.fieldKeys,width:e.width,isVisible:e.isVisible,isHidable:e.isHidable,isResizable:e.isResizable,isSortable:e.isSortable,isAutoFilterable:e.isAutoFilterable,pivoted:!1}):"pivotedColumn"==e.ColumnType()?JSON.stringify({name:e.name,imgSrc:e.imgSrc,columnKey:e.columnKey,fieldKeys:e.fieldKeys,width:e.width,pivoted:!0}):void 0}function GetSerializedColumnInfoCollectionClone(e){for(var t=[],n=e.GetColumnArray(),r=0;r<n.length;++r)t.push(GetSerializedCloneFromColumnInfo(n[r]));return JSON.stringify(t)}function FinishLaunchPrintPreview(records,jsGridParams,additionalScriptFiles,beforeInitFnName,beforeInitFnArgsObj,initTableViewParamsFnName,initTableViewParamsFnArgsObj,title,bEnableGantt,optGanttDelegateNames,ganttPaneWidth,ganttZoomLevel,initGanttStylesFnName,initGanttStylesFnArgsObj){var newWin,cssLinkScripts=[],AJAXScripts=[],scripts=[],requiredScriptFiles=["scriptresx.ashx","SP.JsGrid.Res.js","jsgrid.js","sp.datetimeutil.js","jsgrid.gantt.js","init.js","strings.js"],requiredAJAXFiles=["scriptresource.axd","webresource.axd","msajaxbundle.js","msformbundle.js"];function MatchNodeWithSourceFiles(node,requiredFilesArray,htmlElementArray,attrib){var nodeStr=eval("node."+attrib).toLowerCase();if(null!=requiredFilesArray)for(var idx=0;idx<requiredFilesArray.length;++idx){var fileName=requiredFilesArray[idx].toLowerCase();if(-1!==nodeStr.indexOf(fileName)||fileName.indexOf(".js")==fileName.length-3&&-1!==nodeStr.indexOf(fileName.substr(0,fileName.length-3)+".debug.js")){htmlElementArray.push(gridutil_1.JsGridUtil.Internal.DomElement.GetInstance().GetOuterHtml(node));return!0}}}function CopyRequiredDOMElements(e){for(var t=0;t<e.childNodes.length;++t){var n=e.childNodes[t];1==n.nodeType&&CopyRequiredDOMElements(n)}"stylesheet"==e.rel||e.type;if("LINK"==e.nodeName)cssLinkScripts.push(gridutil_1.JsGridUtil.Internal.DomElement.GetInstance().GetOuterHtml(e));else if("SCRIPT"==e.nodeName){if(MatchNodeWithSourceFiles(e,requiredScriptFiles,scripts,"src"))return;if(MatchNodeWithSourceFiles(e,additionalScriptFiles,scripts,"src"))return;if(MatchNodeWithSourceFiles(e,requiredAJAXFiles,AJAXScripts,"src"))return}}function RenderHTMLElementArray(e){for(var t=0;t<e.length;++t)newWin.document.writeln(e[t])}function RenderPrintPreviewDocument(){(newWin=window.open()).document.writeln('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"');newWin.document.writeln('"http www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">');newWin.document.writeln('<html style="height:100%;margin:0px;">');newWin.document.writeln("<head>");newWin.document.writeln("<title>"+gridutil_1.JsGridUtil.Utility.HTMLEncode(title)+"</title>");RenderHTMLElementArray(cssLinkScripts);RenderHTMLElementArray(AJAXScripts);newWin.document.writeln("</head>");newWin.document.writeln('<body style="overflow:auto;height:100%;margin:0px;">');newWin.document.writeln('<div id="jsgrid_div_element" style="width:100%; min-height:100%;height:570px;" display="block"/>');newWin.document.writeln(StringHelper.format(["<script>","var JsGridUtil.SpRegionalSettings={0}","<\/script>"].join("\n"),JSON.stringify(gridutil_1.JsGridUtil.SpRegionalSettings)));RenderHTMLElementArray(scripts);newWin.document.writeln(StringHelper.format(["<script>","Sys.Application.initialize();","var printPreviewGrid = new SP.JsGrid.PrintPreviewGrid();","Sys.Application.add_init(function()","{{",'    var jsGridDiv = $get("jsgrid_div_element");','    jsGridDiv.style.backgroundColor = "white";','    var defaultDisplayControlMap = SP.JsGrid.Internal.JSONParse(unescape("{0}"));','    var lookupPropTypeMap = SP.JsGrid.Internal.JSONParse(unescape("{8}"));','    var tableViewParams = new SP.JsGrid.JsGridControl.TableViewParameters.CreateFromSerializedClone(unescape("{1}"));','    var dataBlob = SP.JsGrid.Internal.JSONParse(unescape("{2}"));',"    var recordCount = {3};",'    jsGridDiv.style.height = (recordCount * 22 + 50) + "px";',"    AdjustPrintPreviewGridDivWidth(tableViewParams.columns.GetColumnArray(), tableViewParams.bRowHeadersEnabled, {9}, {11});",'    var keyColumnName = unescape("{4}");',"    printPreviewGrid.Init(","        new SP.JsGrid.JsGridControl(jsGridDiv, false),","        tableViewParams,",'        SP.JsGrid.Internal.JSONParse(unescape("{7}")),',"        dataBlob,","        keyColumnName,","        defaultDisplayControlMap,","        lookupPropTypeMap,","        {5},",'        SP.JsGrid.Internal.JSONParse(unescape("{6}")),',"        {13},",'        SP.JsGrid.Internal.JSONParse(unescape("{14}")),',"        {9},",'        SP.JsGrid.Internal.JSONParse(unescape("{10}")),',"        {11},","        {12},","        {16},",'        SP.JsGrid.Internal.JSONParse(unescape("{17}"))',"    );","}});","Sys.CultureInfo.CurrentCulture = (","function(a)","{{","   return new Sys.CultureInfo(a.name,a.numberFormat,a.dateTimeFormat)","}}",')(SP.JsGrid.Internal.JSONParse(unescape("{15}")));',"<\/script>","</body>","</html>"].join("\n"),escape(JSON.stringify(property_1.PropertyType.Internal.Property.GetInstance().GetDefaultDisplayControlMap())),escape(GetSerializedTableViewParametersClone(jsGridParams.tableViewParams)),escape(JSON.stringify(CreatePrintPreviewBlobFromRecords(records))),records.length,escape(jsGridParams.tableViewParams.keyFieldName),beforeInitFnName?['"',beforeInitFnName,'"'].join(""):"null",escape(JSON.stringify(beforeInitFnArgsObj)),escape(JSON.stringify(jsGridParams.styleManager.groupingStyles)),escape(JSON.stringify(property_1.PropertyType.Internal.Property.GetInstance().GetLookupPropTypeMap())),bEnableGantt?"true":"false",escape(JSON.stringify(optGanttDelegateNames)),ganttPaneWidth,ganttZoomLevel,initTableViewParamsFnName?['"',initTableViewParamsFnName,'"'].join(""):"null",escape(JSON.stringify(initTableViewParamsFnArgsObj)),escape(constants_1.JsGridConstants.SUPERTEMPORARY_defaultCultureStringify),initGanttStylesFnName?['"',initGanttStylesFnName,'"'].join(""):"null",escape(JSON.stringify(initGanttStylesFnArgsObj))));newWin.document.close()}CopyRequiredDOMElements(document);RenderPrintPreviewDocument()}exports.FinishLaunchPrintPreview=FinishLaunchPrintPreview});
define("aQz",["require","exports","aQo"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t,n){this.dataPageSize=300;this.optMaxRecordCount=null;this.bConvertAllBlobsToRecords=!1;this.bKeepDataInBlobCache=!1;this.backgroundConversionSize=10;this.blobKeys=[];this.curRequestGeneration=0;this.blobConvertIdx=0;this._fnRequestData=e;this._fnConvertDataToRecords=t;this._fnComputeDataRangeRequest=n;this.InitCache()}e.prototype.ChangeKeys=function(e,t){if(e in this.recordCache){this.recordCache[t]=this.recordCache[e];delete this.recordCache[e]}if(e in this.blobCache){this.blobCache[t]=this.blobCache[e];delete this.blobCache[e]}if(e in this.columnCache){this.columnCache[t]=this.columnCache[e];delete this.columnCache[e]}for(var n=0;n<this.blobKeys.length;n++)if(e in this.blobKeys[n]){this.blobKeys[n][t]=this.blobKeys[n][e];delete this.blobKeys[n][e]}this.view.ChangeKeys(e,t);null!=this.sizeMgr&&this.sizeMgr.ChangeKeys(e,t)};e.prototype.SetDataPageSize=function(e){this.dataPageSize=e};e.prototype.GetDataPageSize=function(){return this.dataPageSize};e.prototype.GetRecordCacheSize=function(){var e,t=0;for(e in this.recordCache)t++;return t};e.prototype.GetRecordCache=function(){return this.recordCache};e.prototype.GetRawDataRecords=function(){this.ConvertBlobsToRecords()};e.prototype.SetMaxRecordCount=function(e){this.optMaxRecordCount=e;n.JsGridUtil.DebugAssert(null==this.sizeMgr||null==this.optMaxRecordCount||n.JsGridUtil.Internal.IsAssocArrayEmpty(this.recordCache));this.TryInitSizeMgr(!1)};e.prototype.GetMaxRecordCount=function(){return this.optMaxRecordCount};e.prototype.SetConvertAllBlobsToRecords=function(e){this.bConvertAllBlobsToRecords=e};e.prototype.GetConvertAllBlobsToRecords=function(){return this.bConvertAllBlobsToRecords};e.prototype.SetBackgroundConversionSize=function(e){this.backgroundConversionSize=e};e.prototype.GetBackgroundConversionSize=function(){return this.backgroundConversionSize};e.prototype.SetKeepDataInBlobCache=function(e){this.bKeepDataInBlobCache=e};e.prototype.GetKeepDataInBlobCache=function(){return this.bKeepDataInBlobCache};e.prototype.MakeRange=function(e,t){return{pos:e,count:t}};e.prototype.GetCachedRecord=function(e){e in this.blobCache&&!(e in this.recordCache)&&this.AddRecordsToCache(this._fnConvertDataToRecords(this.blobCache[e],[e]));return this.recordCache[e]};e.prototype.GetRecordsByKey=function(e,t){var r=this,i=function(){for(var t=new Array(e.length),n=0;n<e.length;n++){var i=r.view.GetPosFromKey(e[n]);if(null==i)return null;t[n]={pos:i,count:1}}return t},s=function(i){var s=r.GetRecords(i,o);if(s.recordSetComplete){var u=n.JsGridUtil.Internal.Flatten2LevelArray(s.records);setTimeout(function(){t(e,u,!0)},0)}},o=function(n,r){var o=i();r&&null!=n?s(o):t(e,null,!1)},u=i();if(null==u)return!1;s(u);return!0};e.prototype.GetRecords=function(e,t){var n=this,r=[],i=[],s=[];for(var o in e)r[o]=this.GetAvailability(e[o],s,i);this.LoadBlobs(s);if(i.length>0){var u,a,f=!0;a=function(n){f=f&&n;0==--u&&null!=t&&setTimeout(function(){t(e,f)},0)};if("function"==typeof this._fnComputeDataRangeRequest){var l=this._fnComputeDataRangeRequest(a);this.outstandingRequestRanges.AppendRangeObject(l.totalRanges[0])}else l=this.FindAndRegisterRanges(i,a);u=l.rangesToFillRequest;var c=l.totalRanges;if(c.length>0){var h=this.curRequestGeneration;this._fnRequestData(c,function(e){n.RequestResultDispatch(c,e,h)})}}return{recordSetComplete:0==i.length,records:r}};e.prototype.AddRecordsToCache=function(e){for(var t in e){var n=e[t];this.recordCache[t]=n;null!=this.sizeMgr&&this.sizeMgr.AddRecord(t);null!=this.fnApplyUpdatesToNewRecord&&this.fnApplyUpdatesToNewRecord(n);if((null==this.optMaxRecordCount||!this.bKeepDataInBlobCache)&&t in this.blobCache){delete this.blobCache[t];t in this.columnCache&&delete this.columnCache[t]}}};e.prototype.AddColumn=function(e,t,n){this.IncrementRequestGeneration();for(var r in this.recordCache)null!=t[r]?this.recordCache[r].AddFieldValue(e,t[r]):null!=n&&this.recordCache[r].AddFieldValue(e,n());for(var r in this.blobCache)if(null!=t[r]){null==this.columnCache[r]&&(this.columnCache[r]={});this.columnCache[r][e]=t[r]}};e.prototype.RemoveColumn=function(e){this.IncrementRequestGeneration();for(var t in this.recordCache)this.recordCache[t].RemoveFieldValue(e);for(var t in this.columnCache){delete this.columnCache[t][e];n.JsGridUtil.Internal.IsAssocArrayEmpty(this.columnCache[t])&&delete this.columnCache[t]}};e.prototype.ClearRecords=function(e){for(var t=0;t<e.length;t++){delete this.recordCache[e[t]];delete this.blobCache[e[t]]}};e.prototype.SetView=function(e,t){this.ClearOutstandingRequestRanges();this.view.SetViewMap(e,t)};e.prototype.GetView=function(){return this.view.GetKeys(0,this.view.GetRecordCount())};e.prototype.RecordIdxToKey=function(e){return this.view.GetKeyFromPos(e)};e.prototype.KeyToRecordIdx=function(e){return this.view.GetPosFromKey(e)};e.prototype.UpdateProperty=function(e,t,n){e.SetProp(t,n)};e.prototype.SeedInsertedRecord=function(e){e.key()in this.recordCache||(this.recordCache[e.key()]=e)};e.prototype.InsertRecord=function(e,t){this.ClearOutstandingRequestRanges();this.view.InsertRecord(e,t)};e.prototype.DeleteRecord=function(e){this.ClearOutstandingRequestRanges();this.view.DeleteRecord(e)};e.prototype.GetRecordCount=function(){return this.view.GetRecordCount()};e.prototype.IsKeyInView=function(e){return this.view.IsKeyPresent(e)};e.prototype.BulkMoveRecords=function(e,t,n){this.ClearOutstandingRequestRanges();null==n&&(n=this.view.GetRecordCount());this.view.BulkMoveRecords(e,t,n)};e.prototype.AddRawDataToCache=function(e,t,n){var r=!1;for(var i in e)if(!(e[i]in this.recordCache)){this.blobCache[e[i]]=t;r=!0}if(this.bConvertAllBlobsToRecords&&r){this.blobKeys.push(e);null!=n&&this.ConvertBlobsToRecords()}};e.prototype.AddRawViewToCache=function(e,t,n){this.AddRawDataToCache(e,t,n);this.view.SpliceView(n)};e.prototype.Clear=function(){this.InitCache()};e.prototype.ConvertBlobsToRecords=function(){if(this.blobKeys.length>0){for(var e=[];this.blobConvertIdx<this.blobKeys[0].length&&e.length<this.backgroundConversionSize;this.blobConvertIdx++)this.blobKeys[0][this.blobConvertIdx]in this.blobCache&&e.push(this.blobKeys[0][this.blobConvertIdx]);if(this.blobConvertIdx==this.blobKeys[0].length){this.blobConvertIdx=0;this.blobKeys.shift()}e.length>0&&this.AddRecordsToCache(this._fnConvertDataToRecords(this.blobCache[e[0]],e))}return this.blobKeys.length>0};e.prototype.IncrementRequestGeneration=function(){this.ClearOutstandingRequestRanges();this.curRequestGeneration++};e.prototype.ClearOutstandingRequestRanges=function(){if(null!=this.outstandingRequestRanges)for(var e=this.outstandingRequestRanges.GetAllCallbacks(),t=0;t<e.length;t++)e[t](!1);this.outstandingRequestRanges=new i};e.prototype.InitCache=function(){this.recordCache={};this.blobCache={};this.columnCache={};this.IncrementRequestGeneration();this.view=new o;this.TryInitSizeMgr(!0)};e.prototype.TryInitSizeMgr=function(e){null==this.sizeMgr||null==this.optMaxRecordCount||e?this.sizeMgr=null!=this.optMaxRecordCount?new u(20,this.optMaxRecordCount,this):null:this.sizeMgr.SetMaxSize(this.optMaxRecordCount)};e.prototype.GetAvailability=function(e,t,r){var i=e.pos,s=e.count,o=this.view.GetKeys(i,s),u=new Array(s);n.JsGridUtil.DebugAssert(i>=0&&i+s<=this.view.GetRecordCount());for(var a=0;a<s;a++){var f=o[a],l=this.recordCache[f];null!=this.sizeMgr&&this.sizeMgr.TouchRecord(f);if(null!=l)u[a]=l;else{u[a]=null;var c=this.blobCache[f];null!=c?t.push({key:f,blob:c,destArray:u,destIdx:a}):r.push({pos:i+a,key:f})}}return u};e.prototype.LoadBlobs=function(e){var t,r=[];for(var i in e){t=e[i];var s=n.JsGridUtil.Internal.Find(r,function(e){return e.blob==t.blob});if(null==s){s={blob:t.blob,keys:[]};r.push(s)}s.keys.push(t.key)}for(var i in r)this.AddRecordsToCache(this._fnConvertDataToRecords(r[i].blob,r[i].keys));for(var i in e)(t=e[i]).destArray[t.destIdx]=this.recordCache[t.key]};e.prototype.RequestResultDispatch=function(e,t,n){if(n==this.curRequestGeneration){if(null!=t)for(var r=0;r<t.length;r++)this.AddRawDataToCache(t[r].keys,t[r].data,null);for(r=0;r<e.length;r++){var i=this.outstandingRequestRanges.FindRangeObject(e[r].pos);if(null!=i){for(var s in i.callbacks)i.callbacks[s](null!=t);this.outstandingRequestRanges.RemoveRangeObject(i)}}}};e.prototype.FindAndRegisterRanges=function(e,t){for(var n,r=0,i=[],s=null,o=0;o<e.length;o++){n=e[o].pos;if(null==(s=this.outstandingRequestRanges.FindRangeObject(n))){var u=this.CreateRanges(n,.75);for(var a in u)this.outstandingRequestRanges.AppendRangeObject(u[a]);i=i.concat(u)}}s=null;for(o=0;o<e.length;o++){n=e[o].pos;if(null==s||!this.outstandingRequestRanges.IsPosInRange(n,s)){r++;null==(s=this.outstandingRequestRanges.FindRangeObject(n))&&(s={});null==s.callbacks?s.callbacks=[t]:s.callbacks.push(t)}}return{rangesToFillRequest:r,totalRanges:i}};e.prototype.CreateRanges=function(e,t){for(var n,r=250,i=250,s=e-1,o=e,u=[],a=this.dataPageSize*(1-t),f=!0,l=!0,c=!0;c&&u.length<this.dataPageSize;){c=!1;if(f&&r>0){r-=(n=this.FindMissingRecords(s,a,r,-1)).scanned;s-=n.scanned+1;f=n.shouldContinue;u=u.concat(n.positions);a=this.dataPageSize-u.length;c=!0}if(l&&i>0){i-=(n=this.FindMissingRecords(o,a,i,1)).scanned;o+=n.scanned+1;l=n.shouldContinue;u=u.concat(n.positions);a=this.dataPageSize-u.length;c=!0}}return this.MakeRangesFromList(u)};e.prototype.MakeRangesFromList=function(e){var t=[];e.sort(function(e,t){return e-t});for(var n=e.length,r=Number.NEGATIVE_INFINITY,i=null,s=0;s<n;s++){if(e[s]!==r+1){i=this.MakeRange(e[s],1);t.push(i)}else i.count++;r=e[s]}return t};e.prototype.FindMissingRecords=function(e,t,n,r){for(var i,s={positions:[],shouldContinue:!0,scanned:0},o=this.view.GetRecordCount(),u=0;u<n;u++){if((i=e+u*r)<0||i>o){s.shouldContinue=!1;break}var a=this.view.GetKeyFromPos(i);if(!(a in this.recordCache)&&!(a in this.blobCache)&&null==this.outstandingRequestRanges.FindRangeObject(i)){s.positions.push(i);if(--t<=0)break}}s.scanned=u;return s};return e})();t.TableCache=r;var i=(function(){function e(){this.ranges=[]}e.prototype.FindRangeObject=function(e){var t=null,n=this.FindRangeIdx(e);n<this.ranges.length&&this.IsPosInRange(e,this.ranges[n])&&(t=this.ranges[n]);return t};e.prototype.AppendRangeObject=function(e){var t=this.FindRangeIdx(e.pos);this.ranges.splice(t,0,e)};e.prototype.RemoveRangeObject=function(e){var t=this.FindRangeIdx(e.pos);n.JsGridUtil.DebugAssert(0==this.GetRangePosInfo(e.pos,this.ranges[t]));this.ranges.splice(t,1)};e.prototype.IsPosInRange=function(e,t){return 0==this.GetRangePosInfo(e,t)};e.prototype.IsEmpty=function(){return 0==this.ranges.length};e.prototype.GetAllCallbacks=function(){for(var e=[],t=0;t<this.ranges.length;t++)null!=this.ranges[t].callbacks&&(e=e.concat(this.ranges[t].callbacks));return e};e.prototype.FindRangeIdx=function(e){var t=this;return n.JsGridUtil.Internal.LowerBoundCompare(this.ranges,e,function(e,n){return t.GetRangePosInfo(n,t.ranges[e])})};e.prototype.GetRangePosInfo=function(e,t){return e<t.pos?1:t.pos+t.count<=e?-1:0};return e})(),s=(function(){function e(){this.bIsFakeKey=1}e.prototype.toString=function(){null==this.tempKey&&(this.tempKey="TempKey"+this.tempKeyIdx++);return this.tempKey};return e})(),o=(function(){function e(){}e.prototype.SetViewMap=function(e,t){this.keyPosMap=null;if(null!=t){n.JsGridUtil.DebugAssert(e.length<=t);this.posKeyMap=new Array(t);for(var r=0;r<e.length;r++)this.posKeyMap[r]=e[r];for(r=e.length;r<t;r++)this.posKeyMap[r]=new s}else this.posKeyMap=e};e.prototype.ChangeKeys=function(e,t){null==this.keyPosMap&&this.InitKeyPosMap();if(e in this.keyPosMap){this.keyPosMap[t]=this.keyPosMap[e];delete this.keyPosMap[e];this.posKeyMap[this.keyPosMap[t]]=t}};e.prototype.GetKeys=function(e,t){for(var n=new Array(t),r=0;r<t;r++)n[r]=this.GetKeyFromPos(e+r);return n};e.prototype.InsertRecord=function(e,t){this.posKeyMap.splice(e,0,t);this.keyPosMap=null};e.prototype.DeleteRecord=function(e){this.posKeyMap.splice(e,1);this.keyPosMap=null};e.prototype.BulkMoveRecords=function(e,t,n){var r=t-e+1,i=this.posKeyMap.splice(e,r);n=n<e?n:n-r;Array.prototype.splice.apply(this.posKeyMap,[n,0].concat(i));this.keyPosMap=null};e.prototype.SpliceView=function(e){for(var t in e)this.InsertRecord(t+this.GetRecordCount(),e[t])};e.prototype.GetRecordCount=function(){return null!=this.posKeyMap?this.posKeyMap.length:0};e.prototype.IsKeyPresent=function(e){null==this.keyPosMap&&this.InitKeyPosMap();return e in this.keyPosMap};e.prototype.GetKeyFromPos=function(e){var t;null!=this.posKeyMap&&(t=this.posKeyMap[e]);return t};e.prototype.GetPosFromKey=function(e){null==this.keyPosMap&&this.InitKeyPosMap();return e in this.keyPosMap?this.keyPosMap[e]:null};e.prototype.InitKeyPosMap=function(){this.keyPosMap={};for(var e=this.posKeyMap.length-1;e>=0;e--)this.keyPosMap[this.posKeyMap[e]]=e};return e})(),u=(function(){function e(e,t,r){this.generationOrder=[];this.generationCountMap={};this.numberOfRecordsToProcessPerTimeout=10;this.recordList=[];this.recordGenerationMap={};this.pageCount=0;n.JsGridUtil.DebugAssert(e<=t/5);this._genSize=e;this._maxSize=t;this.tableCache=r;this.Init()}e.prototype.ChangeKeys=function(e,t){if(e in this.recordGenerationMap){this.recordGenerationMap[t]=this.recordGenerationMap[e];delete this.recordGenerationMap[e]}};e.prototype.Init=function(){var e=this,t=function(t){var n=e.GenerateGenerationName();e.generationOrder.push(n);e.generationCountMap[n]=0};this.deleteQuota=new a(this.RemoveFromGeneration,this);t();t();this.curInsertIdx=0};e.prototype.GenerateGenerationName=function(){return this.pageCount++};e.prototype.IncrementRecordCount=function(e){var t=this.deleteQuota.TotalRemaingToDelete(),n=this.recordList.length-this._maxSize-t;n>0&&this.deleteQuota.AddToDeleteCount(n+this._genSize);this.recordList.push(e)};e.prototype.AddRecord=function(e){if(null==this.recordGenerationMap[e]){this.curInsertIdx=this.AddToGeneration(e,this.curInsertIdx,Math.ceil((this.generationOrder.length-1)/2));this.IncrementRecordCount(e)}};e.prototype.SetMaxSize=function(e){this._maxSize=e};e.prototype.TouchRecord=function(e){if(this.recordGenerationMap[e]!==this.generationOrder[this.generationOrder.length-1]){null!=this.recordGenerationMap[e]?this.RemoveFromGeneration(e):this.IncrementRecordCount(e);this.AddToGeneration(e,this.generationOrder.length-1,null)}};e.prototype.AddToGeneration=function(e,t,n){if(this.generationCountMap[this.generationOrder[t]]==this._genSize){var r=this.GenerateGenerationName();t=null!=n?n:t+1;this.generationOrder.splice(t,0,r);this.generationCountMap[r]=0}this.generationCountMap[this.generationOrder[t]]++;this.recordGenerationMap[e]=this.generationOrder[t];return t};e.prototype.RemoveFromGeneration=function(e){var t=this.recordGenerationMap[e];if(1==this.generationCountMap[t]){for(var r=0;r<this.generationOrder.length&&this.generationOrder[r]!=t;r++);n.JsGridUtil.DebugAssert(r!==this.generationOrder.length);delete this.generationCountMap[t];this.generationOrder.splice(r,1);this.recordGenerationMap[e]=-1}else this.generationCountMap[t]--};return e})(),a=(function(){function e(e,t){this.toDeleteCount=0;this.nScheduledForDeletion=0;this.curPos=0;this._fnRemoveRecordFromGen=e;this._tableSizeManager=t}e.prototype.AddToDeleteCount=function(e){n.JsGridUtil.AsynchronousTaskManager.GetInstance().TaskRegistered(this.processKey)||(this.processKey=n.JsGridUtil.AsynchronousTaskManager.GetInstance().RegisterTask(this.DeleteRecords));this.toDeleteCount=this.ComputeGensToDelete(this.nScheduledForDeletion+e)};e.prototype.TotalRemaingToDelete=function(){return this.nScheduledForDeletion};e.prototype.ComputeGensToDelete=function(e){this.gensToDelete={};this.nScheduledForDeletion=0;for(var t=0;t<this._tableSizeManager.generationOrder.length-3&&this.nScheduledForDeletion<e;t++){this.nScheduledForDeletion+=this._tableSizeManager.generationCountMap[this._tableSizeManager.generationOrder[t]];this.gensToDelete[this._tableSizeManager.generationOrder[t]]=null}};e.prototype.DeleteRecords=function(){for(var e=0;e<this._tableSizeManager.numberOfRecordsToProcessPerTimeout;e++)if(this._tableSizeManager.recordGenerationMap[this._tableSizeManager.recordList[this.curPos]]in this.gensToDelete){var t=this._tableSizeManager.recordList[this.curPos],n=this._tableSizeManager.recordGenerationMap[t];delete this._tableSizeManager.tableCache.recordCache[t];1==this._tableSizeManager.generationCountMap[n]&&delete this.gensToDelete[n];this._fnRemoveRecordFromGen(t);delete this._tableSizeManager.recordGenerationMap[t];this._tableSizeManager.recordList.splice(this.curPos,1);this.nScheduledForDeletion--}else this.curPos=(this.curPos+1)%(this._tableSizeManager.recordList.length-1);return 0!==this.nScheduledForDeletion};return e})()});
define("aQD",["require","exports","aQo"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t){this._tableCache=e;this._objBag=t}e.prototype.SetScrollBarObj=function(e){this.vertScrollBar=e};e.prototype.SetPaneMgrObj=function(e){this.paneMgr=e};e.prototype.GetTopViewIdx=function(){return this.vertScrollBar.GetTopItemIdx()};e.prototype.GetWholeRowDisplayCapacity=function(){return this.vertScrollBar.GetWholeItemDisplayCapacity()};e.prototype.RecordIdxToRecordKey=function(e){var t;if(this._objBag.editUtil.IsNewRowEnabled()&&e>=this._tableCache.GetRecordCount()){var n=this._objBag.entryRecordMgr.GetEntryRecords();n.length>0&&(t=n[Math.min(e-this._tableCache.GetRecordCount(),n.length-1)].key())}else t=this._tableCache.RecordIdxToKey(e);return t};e.prototype.RecordIdxToViewIdx=function(e){return e};e.prototype.ViewIdxToRecordIdx=function(e){return e};e.prototype.ViewIdxToRelViewIdx=function(e){return e-this.vertScrollBar.GetTopItemIdx()};e.prototype.RelViewIdxToViewIdx=function(e){return e+this.vertScrollBar.GetTopItemIdx()};e.prototype.IsRecordOnScreen=function(e){return null!=this.paneMgr.RecordKeyToViewIdx(e)};e.prototype.GetLastRecordKey=function(){return this._tableCache.RecordIdxToKey(this._tableCache.GetRecordCount()-1)};e.prototype.RecordKeyToViewIdx=function(e){var t,n=this.paneMgr.RecordKeyToViewIdx(e);return null!=n?n:null==(t=this._objBag.entryRecordMgr.IsEntryRecordKey(e)?this._objBag.entryRecordMgr.GetEntryRecordIdx(e)+this.GetViewRecordCount():this._tableCache.KeyToRecordIdx(e))?null:this.RecordIdxToViewIdx(t)};e.prototype.RecordKeyToRelViewIdx=function(e){var t=this.RecordKeyToViewIdx(e);return null!=t?this.ViewIdxToRelViewIdx(t):null};e.prototype.RecordKeyToRecordIdx=function(e){var t=this.paneMgr.RecordKeyToViewIdx(e);return null!=t?this.ViewIdxToRecordIdx(t):this._tableCache.KeyToRecordIdx(e)};e.prototype.ViewIdxToRecordKey=function(e){return this.RecordIdxToRecordKey(this.ViewIdxToRecordIdx(e))};e.prototype.GetViewRecordCount=function(){return this._tableCache.GetRecordCount()};e.prototype.GetViewRecords=function(e,t,r){var i=0;this._objBag.editUtil.IsNewRowEnabled()&&(i=Math.min(Math.max(e+t-this.GetViewRecordCount(),0),t));var s=0==(t-=i)?null:this._tableCache.GetRecords([{pos:e,count:t}],function(n,i){r(e,t,i)});null==s?s={recordSetComplete:!0,records:[]}:s.records=n.JsGridUtil.Internal.Flatten2LevelArray(s.records);if(i>0){var o=Math.max(e-this.GetViewRecordCount(),0);s.records=s.records.concat(this._objBag.entryRecordMgr.GetEntryRecords().slice(o,o+i))}return s};return e})();t.PositionConverter=r});
define("aQ4",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.JSONParse=function(e){var t=!1,n=JSON.parse(e,r);t&&(function e(t,n){if(null!=t&&"object"==typeof t)for(var r in t)if(t.hasOwnProperty(r)){e(t[r],n);t[r]=n(r,t[r])}})(n,r);return n;function r(e,n){(function(e,n){t=t||null==n&&/^\d+$/.test(e)})(e,n);if("string"==typeof n){var r=/^\/Date\((-?\d+\))\/$/g.exec(n);if(null!=r){var i=parseInt(r[1]);return new Date(i)}}return n}}});
define("aQq",["require","exports","mU","f","g","aQo","aPS","aQy","aPY","aQn","aPZ","aQA","aQw","aQp","aQv","kI","aQu","a2","ay","C1","aQt","GO","bt","aPQ","aPO","X","aQs","aQr","aPT","yl"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var O={ODB:1310},M={ODB:1746},_={ODB:1806},D={ODB:1170},P={ODB:1725},H=S.Killswitch.isActivated("8DAECEAF-4AEF-45B5-A606-9A3034CC2124","10/18/2019","Use modern taxonomy editor in quick edit."),B=S.Killswitch.isActivated("91C4DDB5-64CC-4DD8-A3E5-BB6D7E38971E","10/2/2019","Batch the csom calls so that they dont hit the csom limit."),j=S.Killswitch.isActivated("0432E43E-C631-4773-A94E-2E508B1B7769","11/20/2019","Add some QOS to SPGantt."),F=S.Killswitch.isActivated("D1EB03FD-9CB4-47AA-83E2-BC9D730B6DB1","12/31/2019","Add a better check for an email being null."),I=S.Killswitch.isActivated("79AF3379-785D-4527-8C2E-79CAC8F796D2","3/12/2020","Get rid of open editors when a column moves"),q="QuickEditWriteChange",R="QuickEditRenameColumn",U="QuickEditDeleteItems",z="QuickEditMoveColumn",W="QuickEditAddColumn",X="QuickEditCreateItem";t.csomJsFilesLoader=new s.JsGridUtil.Utility.LoadExternalJsFiles(4);t.taxonomyLoadCallback=function(){SP.Taxonomy||(function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["byF"],t,n)})];case 1:return[2,t.sent()]}})})})().then(function(e){SP.Taxonomy={TaxonomyFieldValue:e.TaxonomyFieldValue,TaxonomyFieldValueCollection:e.TaxonomyFieldValueCollection}})};var V={};t.OnJsGridIframeLoad=function(e){V[e].OnAutoFilterReturn()};var $=function(e,t){this.name=e;this.fnGenerateArgs=t};t.WebMethod=$;var J=(function(){function e(e){var t=this;this._serverWriteTimeout=null;this._hierarchyEnabled=!1;this._rowLevelErrors={};this._GridValueToSPListValueConverters={};this._SPListValueToGridValueConverters={};this._selfReferencingLookupPropTypes={};this._propChangesPendingValidation=new f.Set;this._changeKeysPendingValidation={};this._changesToSend={};this._currentlyRenamingColumn=!1;this._fnCallbacksByChangeKey=new s.JsGridUtil.ChangeKeyOnCompleteMap;this._isFullLoadCompleted=!1;this._fnCallbackCompleteFullLoad=[];this._fnRowChanged=[];this.addColumnOnCompleteCallback=function(){var e=t._jsGridControl.GetSpCsrRenderCtx();t._ensureExternalJsFilesLoaded(function(){T.SPGridFetchSchema(e.listName,e.view,function(e){for(var n=t._jsGridControl.GetSpCsrRenderCtx(),r=e.Field.length,i=0;i<r;i++){for(var s=e.Field[i],o=!1,u=0;u<n.ListSchema.Field.length;u++)if(s.RealFieldName===n.ListSchema.Field[u].RealFieldName){o=!0;break}if(!o){var a=t.createNewColumn(s);t._dataSource.AddColumn(a);var f=t.createColumnInfo(s);t._jsGridControl.AddColumn(f,a);t._jsGridControl.ShowColumn(s.RealFieldName);t._jsGridControl.EnsurePaneWidth();t._jsGridControl.NotifyDataAvailable()}}n.ListSchema=e})})};this.editColumnOnCompleteCallback=function(){var e=t._jsGridControl.GetSpCsrRenderCtx();t._ensureExternalJsFilesLoaded(function(){T.SPGridFetchSchema(e.listName,e.view,function(e){var n=t._jsGridControl.GetSpCsrRenderCtx();if(t._currentEditColumnInternalName){for(var r,i=!1,s=0;s<e.Field.length;s++)if(e.Field[s].RealFieldName===t._currentEditColumnInternalName){i=!0;r=e.Field[s];break}i?t.editColumnInternal(e,n,r):t.deleteColumnInternal(n)}})})};window.OnJsGridIframeLoad=function(e){V[e].OnAutoFilterReturn()};this._disposeDialogContainer=document.createElement("div");j||(this._telemetry=e)}Object.defineProperty(e,"Instances",{get:function(){return this._instances},enumerable:!0,configurable:!0});Object.defineProperty(e,"FnGanttCreationCallback",{get:function(){return this._FnGanttCreationCallback},enumerable:!0,configurable:!0});e.WaitForGanttCreation=function(e){for(var t=this.Instances,n=0;n<t.length;n++)e(t[n]);this.FnGanttCreationCallback.push(e)};e.prototype.get_Api=function(){return this._api};e.prototype.AttachFullLoadCallback=function(e){this._fnCallbackCompleteFullLoad.push(e);this._isFullLoadCompleted&&e(this._gridFieldMap)};e.prototype.AttachRowChanged=function(e){this._fnRowChanged.push(e)};e.prototype.GetListId=function(){return this._params.listId};e.prototype.UpdateProperties=function(e){this._jsGridControl.UpdateProperties(e,null,null)};e.prototype.IsParseAndSetFields=function(e){return e in this._params.parseAndSetFields};e.prototype.UpdateDisplayAndEditControls=function(){a.PropertyType.Utils.UpdateEditControlForPropType("String",this._editBoxControlId);a.PropertyType.Utils.UpdateEditControlForPropType("Hyperlink",this._hyperlinkControlId);for(var e=a.PropertyType.Utils.GetPropTypes(),t=0;t<e.length;t++){var n=e[t];"SPUser"===n||"SPUser_MultiValue"==n?a.PropertyType.Utils.UpdateDisplayControlForPropType(n,l.DisplayControlType.User):"SPImageThumbnail"===n?a.PropertyType.Utils.UpdateDisplayControlForPropType(n,l.DisplayControlType.ImageThumbnail):a.PropertyType.Utils.UpdateDisplayControlForPropType(n,l.DisplayControlType.CSR)}};e.prototype.Init=function(t,n,r){var i,f,h=this;this._jsGridControl=t;V[this._jsGridControl.parentNode.id]=this;this._params=r;if(this._params.viewSelectorId){var p=RenderViewSelectorPivotMenu({wpq:this._params.viewSelectorId,viewTitle:this._params.viewTitle,ListSchema:{ViewSelectorPivotMenuOptions:this._params.ViewSelectorPivotMenuOptions}});document.getElementById(this._params.viewSelectorId).innerHTML='<div class="ms-csrlistview-controldiv">'+p+"</div>"}if(null!=n){if(null!=n.SortState&&1==n.SortState.length){var d=n.SortState;this._sortState={sortField:d[0].fieldKey,isDescending:d[0].isDescending}}this.ResolveAutoFilterState(n.AutoFilterState);var v=r.spCsrRenderCtx;if(v){v.inGridMode=!1;var m=new s.JsGridUtil.Internal.List_QstringStruct(v.clvp.PagingString());for(var g in m.filterParams)delete m.filterParams[g];for(var y in m.nonFilterParams)"Paged"!==y&&"PagedPrev"!==y&&"PageFirstRow"!==y&&"PageLastRow"!==y&&"FirstRow"!==y&&0!==y.indexOf("p_")&&delete m.nonFilterParams[y];this._pagingInfo=m.toString();v.inGridMode=!0}}this._infoFetched=new Array(this._params.totalItemCount);this.InitSPListValueConversion(this._params.splookupFieldInfo);this.customFieldInfo=this._params.customFieldInfo;this._gridParams=new c.JsGridControlParameters;this._gridParams.canUserAddColumn=this._params.canUserAddColumn;this._gridParams.showAddColumn=this._params.showAddColumn;this._gridParams.spGrid=this._params.spGrid;this._gridParams.spCsrRenderCtx=this._params.spCsrRenderCtx;this._gridParams.qualifier=this._params.qualifier;this._gridParams.peoplePickerDataSource=this._params.peoplePickerDataSource;this._gridParams.locationDataSource=this._params.locationDataSource;this._gridParams.taxonomyPickerDataSource=this._params.taxonomyPickerDataSource;this._gridParams.pageContext=this._params.pageContext;this._gridParams.customFormatterProps=this._params.customFormatterProps;this._gridParams.telemetry=this._params.telemetry;this._gridParams.onLaunchFilterPanel=this._params.onLaunchFilterPanel;this._gridParams.onSort=this._params.onSort;this._gridParams.onLaunchColumnManagementPanel=this._params.onLaunchColumnManagementPanel;this._gridParams.onColumnChangeSucceeded=this._params.onColumnChangeSucceeded;this._gridParams.baseEngagementData=this._params.baseEngagementData;if(null!=this._gridParams.tableViewParams){"boolean"==typeof this._params.bHidableColumns&&(this._gridParams.tableViewParams.bHidableColumns=this._params.bHidableColumns);"boolean"==typeof this._params.bMovableColumns&&(this._gridParams.tableViewParams.bMovableColumns=this._params.bMovableColumns)}this._editBoxControlId=l.EditControlType.EditBox;this._peoplePickerControlId=l.EditControlType.PeoplePicker;this._locationPickerControlId=l.EditControlType.LocationPicker;this._editBoxControlId="EDIT_SPGRIDEDITBOX";a.PropertyType.Utils.RegisterEditControl(this._editBoxControlId,function(e){return k.GetEditBoxEditControl(e)},[]);this._peoplePickerControlId="EDIT_SPGPEOPLEPICKER";a.PropertyType.Utils.RegisterEditControl(this._peoplePickerControlId,function(e){return k.GetPeoplePickerEditControl(e)},[]);this._locationPickerControlId="EDIT_SPGLOCATIONPICKER";a.PropertyType.Utils.RegisterEditControl(this._locationPickerControlId,function(e){return k.GetLocationPickerEditControl(e)},[]);a.PropertyType.RegisterNewCustomPropType(new C.TextMaxLengthPropertyType(this.BuildMaxLengthTable(this._params.customFieldInfo)),l.DisplayControlType.Text,this._editBoxControlId);a.PropertyType.RegisterNewCustomPropType(new C.DatePropertyType,l.DisplayControlType.Text,this._editBoxControlId,[l.WidgetControlType.Date]);a.PropertyType.RegisterNewCustomPropType(new C.EditPropertyType,l.DisplayControlType.Image,this._editBoxControlId);a.PropertyType.RegisterNewCustomPropType(new C.UserPropertyType(this),l.DisplayControlType.Text,this._peoplePickerControlId);a.PropertyType.RegisterNewCustomPropType(new C.PercentCompletePropertyType,l.DisplayControlType.Text,this._editBoxControlId);if(s.JsGridUtil.Internal.IsFeatureEnabled(_)){this._hyperlinkControlId=l.EditControlType.Hyperlink;a.PropertyType.Utils.RegisterEditControl(this._hyperlinkControlId,function(e){return k.GetHyperlinkEditControl(e)},[])}else{this._hyperlinkControlId="EDIT_SPGHYPERLINK";a.PropertyType.Utils.RegisterEditControl(this._hyperlinkControlId,function(e){return k.GetEditBoxEditControl(e,!0)},[])}var b=null!=this._params.spCsrRenderCtx;if(b){i="EDIT_SPGMULTILINEPLAINTEXT";a.PropertyType.Utils.RegisterEditControl(i,function(e){return new k.MultilinePlainTextEditControl(e)},[]);f="EDIT_SPGENHANCEDRICHTEXT";a.PropertyType.Utils.RegisterEditControl(f,function(e){return new k.EnhancedRichTextEditControl(e,h._params.qualifier)},[])}a.PropertyType.RegisterNewCustomPropType(new C.MultilineTextPropertyType,l.DisplayControlType.Text,b?i:this._editBoxControlId);a.PropertyType.RegisterNewCustomPropType(new C.EnhancedRichTextPropertyType,l.DisplayControlType.Text,b?f:this._editBoxControlId);S.Killswitch.isActivated("9328df4d-1b7a-4a12-a64f-036d20af969b","01/10/2020","Render thumbnail in quick edit")||a.PropertyType.RegisterNewCustomPropType(new C.ImageThumbnailPropertyType,l.DisplayControlType.ImageThumbnail,this._editBoxControlId);if(H)SP.UI.Taxonomy.ControlRegistration.RegisterGridControls(this,this.customFieldInfo,b);else{if(s.JsGridUtil.Internal.IsFeatureEnabled(M)){a.PropertyType.RegisterNewCustomPropType(new x.Taxonomy.TaxonomyFieldPropertyType(this.customFieldInfo),"","EDIT_TAXONOMY");this.RegisterGridValueToSPListValueConverter("TaxonomyField",x.Taxonomy.DataConverters.GridValueToInputValue);this.RegisterSPListValueToGridValueConverter("TaxonomyField",x.Taxonomy.DataConverters.SPListValueToGridValue);this.RegisterGridValueToSPListValueConverter("TaxonomyField_MultiValue",x.Taxonomy.DataConverters.GridValueToInputValue);this.RegisterSPListValueToGridValueConverter("TaxonomyField_MultiValue",x.Taxonomy.DataConverters.SPListValueCollectionToGridValue)}else SP.UI.Taxonomy.ControlRegistration.RegisterGridControls(this,this.customFieldInfo,b);this._taxonomyPickerControlId="EDIT_TAXONOMY";a.PropertyType.Utils.RegisterEditControl(this._taxonomyPickerControlId,function(e){return k.GetTaxonomyPickerEditControl(e,h.customFieldInfo)},[]);a.PropertyType.Internal.Property.GetInstance().UpdateWidgetControlsForPropType("TaxonomyField",[])}var w=this._params.siteUrl+"/";for(var E in this._params.splookupFieldInfo){var T=this._params.splookupFieldInfo[E],N=new C.LookupPropertyType(E,T,w);a.PropertyType.RegisterNewCustomPropType(N,l.DisplayControlType.Text,l.EditControlType.ComboBox);if(T.listId.toUpperCase()==this._params.listId.toUpperCase()){null==this._selfReferencingLookupPropTypes[T.field]&&(this._selfReferencingLookupPropTypes[T.field]=[]);this._selfReferencingLookupPropTypes[T.field].push(N)}}this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.GetFieldEditMode,this.GetFieldEditMode.bind(this));this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState,this.GetFieldReadOnlyActiveState.bind(this));var L=this._gridParams.styleManager,A=L.columnHeaderStyleCollection;L.UpdateHeaderStyleFromCss(A,{normal:{base:"ms-spgrid-col-header-normal"},normalHover:{base:"ms-spgrid-col-header-normal-hover",elementColor:"ms-spgrid-col-header-elem-bg-colors-normal-hover",elementHoverColor:"ms-spgrid-col-header-elem-hover-bg-colors-normal-hover",elementClickColor:"ms-spgrid-col-elem-colors-click-normal-hover"},partSelected:{base:"ms-spgrid-col-header-part-selected"},partSelectedHover:{base:"ms-spgrid-col-header-part-selected-hover",elementColor:"ms-spgrid-col-header-elem-bg-colors-part-selected-hover",elementHoverColor:"ms-spgrid-col-header-elem-hover-bg-colors-part-selected-hover",elementClickColor:"ms-spgrid-col-elem-colors-click-part-selected-hover"},allSelected:{base:"ms-spgrid-col-header-all-selected"},allSelectedHover:{base:"ms-spgrid-col-header-all-selected-hover",elementColor:"ms-spgrid-col-header-elem-bg-colors-all-selected-hover",elementHoverColor:"ms-spgrid-col-header-elem-hover-bg-colors-all-selected-hover",elementClickColor:"ms-spgrid-col-elem-colors-click-all-selected-hover"}});this._dataSource=new u.SharePointDataSource(new $("Populate",function(){return{}}),new $("Init",function(){return{}}),new $("ComputeDataRange",function(){return{}}),{Populate:function(e,t,n){var r=h.GetCLVPQString().toArray();r.push("ShowInGrid=True");var i=h._jsGridControl.GetSpCsrRenderCtx(),s="?"+r.join("&");i.queryString=s;i.clvp.RefreshPaging(s)},Init:function(e,t,r){t(n);h.SetItemInfoPresent(h._jsGridControl.GetTopRowIndex())},ComputeDataRange:function(e){return h.ComputeSPDataRange(e)}},this._jsGridControl,function(){},this.UpdateDisplayAndEditControls.bind(this));this._dataSource.BeginFullLoad(this.FinishFullLoad.bind(this),function(){},this._gridParams);e.Instances.push(this);for(var O=e.FnGanttCreationCallback,D=0;D<O.length;D++)O[D](this)};e.prototype.GetUnfilteredHierarchyMap=function(){return null};e.prototype.GetCLVPQString=function(){var e=this._jsGridControl.GetSpCsrRenderCtx();s.JsGridUtil.DebugAssert(null!=e);var t=null;null!=this._sortState&&(t="SortField="+this._sortState.sortField+"&SortDir="+(this._sortState.isDescending?"Desc":"Asc"));var n=new s.JsGridUtil.Internal.List_QstringStruct(s.JsGridUtil.Internal.List_ReconcileQstringFilters(s.JsGridUtil.Internal.List_ReconcileQstringFilters(this._pagingInfo,this._filterUrl),t));null!=n.nonFilterParams.SortField&&(n.nonFilterParams.SortField=this.GetCSRFieldKeyFromJsGridFieldKey(n.nonFilterParams.SortField));for(var r in n.filterParams){var i="FilterField",o=n.filterParams[r][i];if(null==o){i="FilterFields";o=n.filterParams[r][i]}s.JsGridUtil.DebugAssert(null!=o);n.filterParams[r][i]=this.GetCSRFieldKeyFromJsGridFieldKey(o)}this._params.viewRootFolder&&(n.nonFilterParams.RootFolder=s.JsGridUtil.Internal.EscapeProperly(this._params.viewRootFolder));return n};e.prototype.TryDispose=function(e){var t=this,n=function(){t.TryDisposeInternal(e)};this._jsGridControl.FinalizeEditing(n,n)};e.prototype.TryDisposeInternal=function(e,t){var n=this,r=function(){n._currentlyShowingDisposeDialog=!1;n.Dispose();e();i.unmountComponentAtNode(n._disposeDialogContainer)},o=this._currentlyWritingChangesToList||this._currentlyCreatingNewListItem||this._currentlyDeletingListItems||this._currentlyRenamingColumn;if(!(t&&!this._currentlyDisposing||this._isDisposed)){if(this._jsGridControl.AnyUncomittedEntryRecords()){this._jsGridControl.JumpToEntryRecord();o=!0}if(!s.JsGridUtil.Internal.IsAssocArrayEmpty(this._changesToSend)){B?this.WriteChangesToListCore():this.BatchedWriteChangesToListCore();o=!0}if(this._jsGridControl.AnyErrors()){this._currentlyShowingDisposeDialog&&i.unmountComponentAtNode(this._disposeDialogContainer);this._currentlyShowingDisposeDialog=!0;this._showDisposeDialog(Strings.STS.L_SPGanttDisposeErrorDialogTitle,Strings.STS.L_SPGanttDisposeErrorDialogBody,Strings.STS.L_SPGanttDisposeErrorDialogFixButton,Strings.STS.L_SPGanttDisposeDialogDiscardButton,function(){n._currentlyShowingDisposeDialog=!1;n._currentlyDisposing=!1;i.unmountComponentAtNode(n._disposeDialogContainer)},r)}else if(o){if(!this._currentlyShowingDisposeDialog){this._currentlyDisposing=!0;this._currentlyShowingDisposeDialog=!0;this._showWarningDialog(Strings.STS.L_SPGanttDisposeSavingDialogTitle,Strings.STS.L_SPGanttDisposeSavingDialogBody,Strings.STS.L_SPGanttDisposeDialogLeaveButton,r)}this._currentlyDisposing&&setTimeout(function(){n.TryDisposeInternal(e,!0)},200)}else{var u=SP.UI.ModalDialog.get_childDialog();if(this._currentlyShowingDisposeDialog){s.JsGridUtil.DebugAssert(null!=u);r()}else{s.JsGridUtil.DebugAssert(null==u);r()}}}};e.prototype.Dispose=function(){this._isDisposed=!0;this._jsGridControl.Dispose();this._api=null};e.prototype._showDisposeDialog=function(e,t,n,s,o,u){i.render(r.createElement(b.ConfirmationDialog,{title:e,prompt:t,noText:n,yesText:s,onCancel:o,onConfirm:u,maxWidth:"450px"}),this._disposeDialogContainer)};e.prototype._showWarningDialog=function(e,t,n,s){i.render(r.createElement(w.WaitingDialog,{title:e,prompt:t,maxWidth:"450px"}),this._disposeDialogContainer)};e.prototype._logEngagement=function(e,t){this._gridParams.telemetry&&this._gridParams.telemetry(g.default).logData(y.graft(this._gridParams.baseEngagementData,{name:e,extraData:t}))};e.prototype.FinishFullLoad=function(e,t){var n=this;this._tableViewParams=e.tableViewParams;this._bGrouped=!1;this._gridFieldMap=e.tableViewParams.gridFieldMap;SP.Res?e.name=SP.Res.ganttListName:e.name="";s.JsGridUtil.Internal.IsFeatureEnabled(P)||e.enabledRowHeaderAutoStates.Add(o.JsGridConstants.RowHeaderAutoStyleId.Dirty);this._newRowEnabled=e.tableViewParams.bNewRowEnabled=!this._bGrouped&&this._params.listPermissions&o.JsGridConstants.SPGPermissions.addListItems&&(null==this._params.spCsrRenderCtx||"1"!==this._params.spCsrRenderCtx.ListSchema.IsDocLib);if(null!=e.tableViewParams.ganttParams){e.tableViewParams.ganttParams.fnGetGanttBarDate=this.GetGanttBarDate.bind(this);e.tableViewParams.ganttParams.fnGetGanttBarStyleIds=function(){s.JsGridUtil.DebugAssert(!1,"Oh no!  We've disabled hierarchy")};e.tableViewParams.ganttParams.fnGetPredecessors=this.GetPredecessors.bind(this)}e.styleManager.RegisterCellStyle("CheckmarkStyle",h.StyleUtil.CreateStyle(h.StyleType.Cell,{textAlign:"center"}));var r=e.tableViewParams.columns.GetColumnByKey("Checkmark");null!=r&&(r.fnGetCellStyleId=function(){return"CheckmarkStyle"});null!=e.tableViewParams.ganttParams&&e.styleManager.RegisterCellStyle("Summary",h.StyleUtil.CreateStyle(h.StyleType.Cell,{fontWeight:"bold"}));this._editRowEnabled=e.tableViewParams.bEditingEnabled=this._params.listPermissions&o.JsGridConstants.SPGPermissions.editListItems;this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.GetRecordEditMode,this.GetRecordEditMode.bind(this));this._jsGridControl.AttachEvent(o.JsGridConstants.EventType.OnRightClick,this.OnRightClick.bind(this));var i=e.tableViewParams.columns.GetColumnByKey("Edit");if(null!=i){i.fnShouldLinkSingleValue=function(){return!0};i.fnSingleValueClicked=this.OnEditCellContentsClicked}var u=e.tableViewParams.columns.GetColumnByKey("Title");if(null!=u){u.fnShouldLinkSingleValue=this.ShouldLinkTitleCell;u.fnSingleValueClicked=this.OnTitleCellContentsClicked}this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.AutoFilter,this.OnAutoFilter.bind(this));this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.Sort,this.OnSort.bind(this));this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.NextPage,this.OnNextPage.bind(this));this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.AddNewColumn,this.AddNewColumn.bind(this));this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.GetAutoFilterEntries,this.GetAutoFilterEntries.bind(this));this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.LaunchFilterDialog,this.LaunchFilterDialog.bind(this));this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.CreateEntryRecord,this.CreateEntryRecord.bind(this));this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.TryInsertEntryRecord,this.CreateNewListItem.bind(this));this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.TryCreateProvisionalRecord,this.CreateNewListItem.bind(this));this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.DeleteRecords,this.DeleteSelectedRecords.bind(this));this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.RemoveColumnFromView,this.RemoveColumnFromView.bind(this));this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.GetGridRowStyleId,null);this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.CanReorderRecords,function(){return n._params.canShowReorderUI});this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.OnBeforeRecordReordered,function(){s.JsGridUtil.DebugAssert("Oh no!  We've disabled hierarchy.")});this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.EditColumn,this.EditColumn.bind(this));s.JsGridUtil.Internal.IsFeatureEnabled(D)?this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.AddNewColumnMenuItems,this.PopulateAddNewColumnMenuItemsV2.bind(this)):this._jsGridControl.SetDelegate(o.JsGridConstants.DelegateType.AddNewColumnMenuItems,this.PopulateAddNewColumnMenuItems.bind(this));this._jsGridControl.AttachEvent(o.JsGridConstants.EventType.OnRowEscape,this.OnRowEscape.bind(this));this._jsGridControl.AttachEvent(o.JsGridConstants.EventType.OnRowFocusChanged,this.OnRowFocusChanged.bind(this));this._jsGridControl.AttachEvent(o.JsGridConstants.EventType.OnPropertyChanged,this.OnPropertyChanged.bind(this));this._jsGridControl.AttachEvent(o.JsGridConstants.EventType.OnRecordInserted,this.OnRecordInsertedOrDeleted.bind(this));this._jsGridControl.AttachEvent(o.JsGridConstants.EventType.OnRecordDeleted,this.OnRecordInsertedOrDeleted.bind(this));this._jsGridControl.AttachEvent(o.JsGridConstants.EventType.OnRecordsReordered,function(){s.JsGridUtil.DebugAssert("Oh no!  We've disabled hierarchy.")});this._jsGridControl.AttachEvent(o.JsGridConstants.EventType.OnBeforePropertyChanged,this.OnBeforePropertyChanged.bind(this));this._jsGridControl.AttachEvent(o.JsGridConstants.EventType.OnBeginRenameColumn,this.OnBeginRenameColumn.bind(this));this._jsGridControl.AttachEvent(o.JsGridConstants.EventType.OnEndRenameColumn,this.OnEndRenameColumn.bind(this));this._jsGridControl.AttachEvent(o.JsGridConstants.EventType.OnSingleCellKeyDown,this.OnSingleCellKeyDown.bind(this));if(null!=this._params.spCsrRenderCtx&&null!=this._params.spCsrRenderCtx.ListData&&this._params.spCsrRenderCtx.ListData.ForceNoHierarchy){this._hierarchyEnabled=!1;e.tableViewParams.rowViewParams.hierarchyMode=o.JsGridConstants.HierarchyMode.None}"rtl"==this._params.listDirection?e.isRTL=!0:"ltr"==this._params.listDirection&&(e.isRTL=!1);this.CustomizeGridStyles(e);this._jsGridControl.Init(e);this._commandMgr=e.commandMgr;for(var a=0;a<this._fnCallbackCompleteFullLoad.length;a++)this._fnCallbackCompleteFullLoad[a](this._gridFieldMap);this._isFullLoadCompleted=!0};e.prototype.CustomizeGridStyles=function(e){var t=e.styleManager;t.groupingStyles=null;t.gridPaneStyle.backgroundColor="transparent";t.defaultCellStyle.textAlign=e.isRTL?"right":"left";t.defaultCellStyle.backgroundColor="transparent";var n=t.columnHeaderStyleCollection;n.normal.innerBorderColor="transparent";n.normal.eyeBrowColor="transparent";n.partSelected.innerBorderColor="transparent";n.partSelected.eyeBrowColor="transparent";n.allSelected.innerBorderColor="transparent";n.allSelected.eyeBrowColor="transparent"};e.prototype.ZoomInGantt=function(){this._jsGridControl.SetGanttZoomLevel(this._jsGridControl.GetGanttZoomLevel()-1)};e.prototype.ZoomOutGantt=function(){this._jsGridControl.SetGanttZoomLevel(this._jsGridControl.GetGanttZoomLevel()+1)};e.prototype.ScrollGanttToFocusedItem=function(){var e=this.GetFocusedRecord();if(null!=e){var t=e.GetDataValue(this._params.startColumnName);null==t&&(t=e.GetDataValue(this._params.finishColumnName));null!=t&&this._jsGridControl.ScrollGanttToDate(t)}};e.prototype.get_SelectedItems=function(){for(var e=this._jsGridControl.GetSelectedRecordKeys(),t=[],n=0;n<e.length;n++){var r=e[n];this._jsGridControl.IsGroupingRecordKey(r)||this._jsGridControl.IsEntryRecordKey(r)||this._jsGridControl.IsProvisionalRecordKey(r)||t.push(e[n])}return t};e.prototype.get_SelectedItemsIncludingProvisionalItems=function(){for(var e=this._jsGridControl.GetSelectedRecordKeys(),t=[],n=0;n<e.length;n++){var r=e[n];this._jsGridControl.IsGroupingRecordKey(r)||this._jsGridControl.IsEntryRecordKey(r)||t.push(e[n])}return t};e.prototype.AddItemsToTimeline=function(e){if(null!=e&&e.length&&e.length>0){for(var t=[],n=0;n<e.length;n++){var r={};r.id=e[n];t.push(r)}this.AddItemsToTimeline(t)}};e.prototype.DeleteSelectedItems=function(){this.DeleteSelectedRecords()};e.prototype.LaunchEditItemFormForItem=function(e){this.ViewOrEditItem(!0,e)};e.prototype.LaunchViewItemFormForItem=function(e){this.ViewOrEditItem(!1,e)};e.prototype.ViewOrEditItem=function(e,t){var n=GetCurrentCtx(),r=e?n.editFormUrl:n.displayFormUrl,i=-1==r.indexOf("?")?"?":"&",s=this._dataSource.tableCache.GetCachedRecord(t).GetDataValue("_ContentTypeId");r=r+i+"ID="+t+(null!=s&&""!==s?"&ContentTypeID="+s:"");r=AddSourceToUrl(r)+GetRootFolder(n);EditItem2(null,r)};e.prototype.GetCSRFieldFromJsGridFieldKey=function(e){for(var t=this._jsGridControl.GetSpCsrRenderCtx().ListSchema.Field,n=0;n<t.length;n++){var r=t[n];if(r.RealFieldName==s.JsGridUtil.Internal.UnescapeProperly(e))return r}};e.prototype.GetCSRFieldKeyFromJsGridFieldKey=function(e){var t=this.GetCSRFieldFromJsGridFieldKey(e);return null==t?e:s.JsGridUtil.Internal.EscapeProperly(t.Name)};e.prototype.GetFocusedRecord=function(){var e,t=this._jsGridControl.GetFocusedItem();null!=t&&(e=this._dataSource.tableCache.GetCachedRecord(t.recordKey));return e};e.prototype.GetRecordKeysToSend=function(){var e=new f.Set;for(var t in this._changesToSend)if(!this._jsGridControl.AnyErrorsInRecord(t)||t in this._rowLevelErrors&&this._rowLevelErrors[t].bCommunicationsError){var n=this._changesToSend[t];for(var r in n)if(n[r].changeKey.GetVersionNumber()in this._changeKeysPendingValidation){e.Add(t);break}}else e.Add(t);return new f.Set(this._changesToSend).Difference(e).GetCollection()};e.prototype.CanDiscardChangesForRow=function(e){return e in this._changesToSend};e.prototype.DiscardChangesForRow=function(e){var t=this;if(e in this._changesToSend){this._showDisposeDialog(Strings.STS.L_SPGanttDiscardChangesDialogTitle,Strings.STS.L_SPGanttDiscardChangesDialogMessage,Strings.STS.L_SPNo,Strings.STS.L_SPYes,function(){t._jsGridControl.Focus();i.unmountComponentAtNode(t._disposeDialogContainer)},function(){t._jsGridControl.Focus();var n=t._changesToSend[e];delete t._changesToSend[e];var r=t.GetMostRecentChangeKey(n),s=[];for(var o in n){var u=n[o];s.push(p.CreateValidatedPropertyUpdate(e,o,u.oldProp.data,u.oldProp.localized))}t._jsGridControl.UpdateProperties(s,null,r);i.unmountComponentAtNode(t._disposeDialogContainer)})}};e.prototype.OnRowEscape=function(e){var t=e.recordKey;this.CanDiscardChangesForRow(t)&&this.DiscardChangesForRow(t)};e.prototype.OnBeforePropertyChanged=function(e){var t=e.recordKey,n=this._jsGridControl.GetRecord(t),r=e.fieldKey;if(null!=n.properties[r]){var i=n.properties[r].propType;if("SPMultilineText"!=i.ID&&"SPEnhancedRichText"!=i.ID&&"TaxonomyField"!=i.ID&&"TaxonomyField_MultiValue"!=i.ID){var o=n.fieldRawDataMap.csrInfo;if(null!=o&&(null==this._changesBeingSent||null==this._changesBeingSent[t])&&!s.JsGridUtil.Internal.IsNoOpChange(e,n)){o.stale=o.stale||{};o.stale[r]=!0}}}};e.prototype.OnPropertyChanged=function(e,t){var n=this;if(!this._jsGridControl.IsProvisionalRecordKey(e.recordKey)&&!(e.fieldKey in this._params.computedFields)){(function(t){var r=n._selfReferencingLookupPropTypes[e.fieldKey];if(null!=r)for(var i=0;i<r.length;i++)r[i].InvalidateCache()})();if(e.changeKey!=this._cascadingChangeKey){null==this._rowLevelErrors[e.recordKey]||this._rowLevelErrors[e.recordKey].bCommunicationsError||this.ClearRowLevelError(e.recordKey);t||(function(e){var t={},r=n._jsGridControl.GetRecord(e.recordKey).fieldRawDataMap._ContentTypeId;if(null!=r&&r in n._params.contentTypes)for(var i=n._params.contentTypes[r].RequiredFields,s=0;s<i.length;s++){t[i[s]]=1}e.validationState==o.JsGridConstants.ValidationState.Valid&&(e.fieldKey in n._params.requiredFields||e.fieldKey in t)&&(e.newProp.HasLocalizedValue()&&(""==e.newProp.localized||null==e.newProp.localized)||e.newProp.HasDataValue()&&null==e.newProp.data)&&n._jsGridControl.SetCellError(e.recordKey,e.fieldKey,SP.Res.requiredField15)})(e);(function(e){if(e.validationState==o.JsGridConstants.ValidationState.Valid&&"Title"==e.fieldKey&&n._dataSource.tableCache.GetCachedRecord(e.recordKey).GetDataValue("_FolderLink")){var t=p.CreateValidatedPropertyUpdate(e.recordKey,"FileLeafRef",e.newProp.data,e.newProp.localized);n._jsGridControl.UpdateProperties([t],null,e.changeKey)}})(e);(function(e){var t=e.changeKey.GetVersionNumber(),r=[e.recordKey,e.fieldKey,t].join();if(e.validationState==o.JsGridConstants.ValidationState.Pending){n._propChangesPendingValidation.Add(r);t in n._changeKeysPendingValidation||(n._changeKeysPendingValidation[t]=0);n._changeKeysPendingValidation[t]++}else if(n._propChangesPendingValidation.Contains(r)){n._propChangesPendingValidation.Remove(r);n._changeKeysPendingValidation[t]--;0==n._changeKeysPendingValidation[t]&&delete n._changeKeysPendingValidation[t]}})(e);(function(e){if(e.validationState==o.JsGridConstants.ValidationState.Pending||e.validationState==o.JsGridConstants.ValidationState.Valid){null==(t=n._changesToSend[e.recordKey])&&(n._changesToSend[e.recordKey]=t={});null!=t[e.fieldKey]&&t[e.fieldKey].changeKey.Release();t[e.fieldKey]=e;e.changeKey.Reserve()}else{var t;if(null!=(t=n._changesToSend[e.recordKey])&&null!=t[e.fieldKey]){t[e.fieldKey].changeKey.Release();delete t[e.fieldKey]}}})(e);var r=this._jsGridControl.GetFocusedItem();e.validationState==o.JsGridConstants.ValidationState.Valid&&(null!=r&&e.recordKey!=r.recordKey||this._dataSource.tableCache.GetRecordCount()+(this._tableViewParams.bNewRowEnabled?1:0)==1)&&this.WriteChangesToList()}}};e.prototype.OnRecordInsertedOrDeleted=function(){for(var e in this._selfReferencingLookupPropTypes)for(var t=this._selfReferencingLookupPropTypes[e],n=0;n<t.length;n++)t[n].InvalidateCache()};e.prototype.OnRowFocusChanged=function(e){this.WriteChangesToList()};e.prototype.OnSort=function(e){this._pagingInfo=null;this._sortState={sortField:e[0].columnName,isDescending:e[0].isDescending};this.ClearItemInfoPresent();this._dataSource.RefreshRowView(!1,this.RefreshRowView.bind(this))};e.prototype.RefreshRowView=function(e,t){this._jsGridControl.SetRowView(e);RefreshCommandUI()};e.prototype.RemoveColumnFromView=function(e){var t=this;function n(){}function r(){throw"Failed to delete column "+e}this._ensureExternalJsFilesLoaded(function(){var i=t.InitContext(n,r);i.view.get_viewFields().remove(e);i.view.update();i.context.executeQueryAsync()})};e.prototype.OnBeginRenameColumn=function(){this._currentlyRenamingColumn=!0};e.prototype.OnSingleCellKeyDown=function(e){if("Checkmark"==e.fieldKey&&window.CheckMarkFieldTemplate&&e&&e.eventInfo&&32==e.eventInfo.keyCode){var t=document.getElementById(window.CheckMarkFieldTemplate.GetCheckMarkId(this._jsGridControl.GetSpCsrRenderCtx(),e.recordKey));t&&t.OnClickCheckmark()}};e.prototype.OnEndRenameColumn=function(e){var t,n=this;j||(t=new(this._telemetry(N.Qos))({name:R}));var r=function(){n._currentlyRenamingColumn=!1;var e=n._jsGridControl.GetSpCsrRenderCtx();null!=e&&T.SPGridFetchSchema(e.listName,e.view,function(t){e.ListSchema=t});j||t.end({resultType:N.ResultTypeEnum.Success})},i=function(){n._currentlyRenamingColumn=!1;if(j)throw"Failed to rename column "+s+" with name "+o;var e="Failed to rename column "+s+" with name "+o;t.end({resultType:N.ResultTypeEnum.Failure,resultCode:"FailToRenameColumn",error:e});throw e},s=e.columnKey,o=e.newColumnTitle,u=e.originalColumnTitle;o!=u?this._ensureExternalJsFilesLoaded(function(){var e=n.InitContext(r,i),t=e.list.get_fields().getByInternalNameOrTitle(s);t.set_title(o);t.update();e.context.executeQueryAsync()}):this._currentlyRenamingColumn=!1};e.prototype.MoveColumn=function(e){var t,n=this;I||this._jsGridControl.StopEditing();j||(t=new(this._telemetry(N.Qos))({name:z}));var r=e.columnInfo,i=e.dragDropDetails,s=e.onColumnChangeSucceeded,o=i.draggedIndex,u=i.targetIndex,a=r.columnKey,f=function(){var e=n._jsGridControl.GetSpCsrRenderCtx();null!=e&&T.SPGridFetchSchema(e.listName,e.view,function(t){e.ListSchema=t});s&&s();j||t.end({resultType:N.ResultTypeEnum.Success})},l=function(){if(j)throw"Failed to move column "+a+" to position "+u;var e="Failed to move column "+a+" to position "+u;t.end({resultType:N.ResultTypeEnum.Failure,resultCode:"FailToMoveColumn",error:e});throw MessageChannel};this._ensureExternalJsFilesLoaded(function(){var e=n._jsGridControl._GetPaneManager(),t=e.GetGridPane().GetAllColumns();t.RemoveColumn(a);t.InsertColumnAt(u,r);e.UpdateColumns(t);n._jsGridControl.EnsurePaneWidth();n._jsGridControl.NotifyDataAvailable();var i=n.InitContext(f,l),s=i.view;s.get_viewFields().moveFieldTo("Title"===a?"LinkTitle":a,u>o?u+1:u);s.update();i.context.executeQueryAsync()})};e.prototype.AddNewColumn=function(e,t,n,r){var i,u,f=this;j||(u=new(this._telemetry(N.Qos))({name:W}));var l=function(){var e,n=function(){var t=f._jsGridControl.GetSpCsrRenderCtx();if(null!=t){T.SPGridFetchSchema(t.listName,t.view,function(n){for(var r=n.Field.length,o=0;o<r&&(i=n.Field[o]).RealFieldName!=s;o++);e.csrInfo=i;t.ListSchema=n});r&&r()}},s=i.get_internalName(),o=a.PropertyType.Internal.Property.GetInstance().GetPropType(t.propType);if("SPDateTime"==o.ID){e=new d.GridField(s,t.hasData,t.hasLocalized,null,null,null,!1,null);f._params.parseAndSetFields[s]=1}else e=new d.GridField(s,t.hasData,t.hasLocalized);"SPUser"==o.ID&&o.SetPeoplePickerDefaultSettings(s);e.SetSingleValuePropType(o);f._dataSource.AddColumn(e);var l=new d.ColumnInfo(p,null,s,100);f._jsGridControl.AddColumn(l,e);f._jsGridControl.ShowColumn(s);f._jsGridControl.EnsurePaneWidth();f._jsGridControl.NotifyDataAvailable();f._jsGridControl.RenameColumn(s);if(null!=v){var h=f.InitContext(n,c),m=h.view;m.get_viewFields().add(s);m.update();h.context.executeQueryAsync()}else n();j||u.end({resultType:N.ResultTypeEnum.Success})},c=function(){if(j)throw"Failed to add new column "+p+" to view";var e="Failed to add new column "+p+" to view";u.end({resultType:N.ResultTypeEnum.Failure,resultCode:"FailToAddColumn",error:e});throw e},h=function(e){if(e==o.JsGridConstants.DialogResult.OK){var t=f._jsGridControl.GetSpCsrRenderCtx();T.SPGridFetchSchema(t.listName,t.view,function(e){for(var t=f._jsGridControl.GetSpCsrRenderCtx(),n=e.Field.length,r=0;r<n;r++){for(var i=e.Field[r],s=!1,u=0;u<t.ListSchema.Field.length;u++)i.RealFieldName===t.ListSchema.Field[u].RealFieldName&&(s=!0);if(!s){var l,c=i.RealFieldName,h=a.PropertyType.Internal.Property.GetInstance().GetPropType(o.JsGridConstants.FieldTypeToJsGridType[i.Type]);if("SPDateTime"==h.ID){l=new d.GridField(c,!0,!0,null,null,null,!1,null);f._params.parseAndSetFields[c]=1}else l=new d.GridField(c,!0,!0);"SPUser"==h.ID&&h.SetPeoplePickerDefaultSettings(c);"1"==i.AllowMultipleValues?l.SetIsMultiValue(";"):l.SetSingleValuePropType(h);l.csrInfo=i;f._dataSource.AddColumn(l);var v=new d.ColumnInfo(p,null,c,100);v.name=i.Name;f._jsGridControl.AddColumn(v,l);f._jsGridControl.ShowColumn(c);f._jsGridControl.EnsurePaneWidth();f._jsGridControl.NotifyDataAvailable()}}t.ListSchema=e})}},p=null!=n&&n.length>0?n:e,v=null,m=String.fromCharCode(97+Math.floor(26*Math.random()))+Math.random().toString(36).substring(2,5);this._ensureExternalJsFilesLoaded(function(){switch(e){case"Text":case"Note":case"Number":case"Currency":case"DateTime":case"Boolean":case"URL":case"User":case"Location":var t=f.InitContext(l,c),n="<Field Name='"+m+"' DisplayName='"+s.JsGridUtil.Internal.Encoding_STSHtmlEncode(p)+"' Type='"+e+"'";"User"==e&&(n+=" List='UserInfo'");n+=" />";i=t.list.get_fields().addFieldAsXml(n,!1,o.JsGridConstants.AddFieldOptions.defaultValue|o.JsGridConstants.AddFieldOptions.addFieldInternalNameHint);v=t.view;i.update();t.context.load(i);t.context.load(v);t.context.executeQueryAsync();return;case"Choice":case"Lookup":case"Calculated":case"BusinessData":case"MoreColumnTypes":var r={};r.title=SP.JsGrid.Res.addColumnName;r.dialogReturnValueCallback=h;var u="Choice"==e||"Calculated"==e?"FldNew.aspx":"FldNewEx.aspx";r.url=(function(e,t){var n=[];n.push(s.JsGridUtil.Internal.SiteUrl+"/_layouts/15/"+e);n.push("?List=");n.push(f._params.listId);n.push("&AddToView=");n.push(f._params.viewId);n.push("&FieldTypeParam=");n.push(t);n.push("&IsDlg=");n.push(1);return n.join("")})(u,e);SP.UI.ModalDialog.showModalDialog(r);return}})};e.prototype.onLaunchColumnManagementPanelAction=function(e,t,n){this.onLaunchColumnManagementPanelActionInternal(e,!1,t,n)};e.prototype.onLaunchColumnManagementPanelActionWithLink=function(e,t,n){this.onLaunchColumnManagementPanelActionInternal(e,!0,t,n)};e.prototype.onLaunchColumnManagementPanelActionInternal=function(e,t,n,r){n({createField:{fieldType:e,fieldToInsertAfter:r},isHyperlink:t},this.addColumnOnCompleteCallback)};e.prototype.editColumnInternal=function(e,t,n){for(var r=this._jsGridControl._GetPaneManager(),i=r.GetGridPane().GetAllColumns(),s=0;s<t.ListSchema.Field.length;s++)if(t.ListSchema.Field[s].RealFieldName===this._currentEditColumnInternalName){var o=t.ListSchema.Field[s],u=i.RemoveColumn(o.RealFieldName),a=this.createColumnInfo(n);i.InsertColumnAt(u,a);if("Location"!==n.FieldType){r.UpdateColumns(i);this._jsGridControl.EnsurePaneWidth();this._jsGridControl.NotifyDataAvailable();t.ListSchema=e;return}break}for(var l=new f.Set,c=new f.Set,h=n.ID,p=0;p<t.ListSchema.Field.length;p++){(d=t.ListSchema.Field[p].StaticName)&&d.indexOf(h)>=0&&l.Add(d)}for(p=0;p<e.Field.length;p++){var d;(d=e.Field[p].StaticName)&&d.indexOf(h)>=0&&c.Add(d)}var v=l.Difference(c);for(s=0;s<t.ListSchema.Field.length;s++){var m=t.ListSchema.Field[s];v.Contains(m.StaticName)&&i.RemoveColumn(m.RealFieldName)}var g=c.Difference(l);for(s=0;s<e.Field.length;s++){var y=e.Field[s];if(g.Contains(y.StaticName)){var b=this.createNewColumn(y);this._dataSource.AddColumn(b);var w=this.createColumnInfo(y);this._jsGridControl.AddColumn(w,b);this._jsGridControl.ShowColumn(y.RealFieldName)}}r.UpdateColumns(i);this._jsGridControl.EnsurePaneWidth();this._jsGridControl.NotifyDataAvailable();t.ListSchema=e};e.prototype.deleteColumnInternal=function(e){for(var t=0;t<e.ListSchema.Field.length;t++)if(e.ListSchema.Field[t].RealFieldName===this._currentEditColumnInternalName){var n=this._jsGridControl._GetPaneManager(),r=n.GetGridPane().GetAllColumns(),i=e.ListSchema.Field[t],s=i.ID;r.RemoveColumn(i.RealFieldName);if("Location"===i.FieldType)for(var o=0;o<e.ListSchema.Field.length;o++){var u=e.ListSchema.Field[o].StaticName;u&&u.indexOf(s)>=0&&r.RemoveColumn(e.ListSchema.Field[o].RealFieldName)}n.UpdateColumns(r);this._jsGridControl.EnsurePaneWidth();this._jsGridControl.NotifyDataAvailable();break}};e.prototype.createNewColumn=function(e){var t,n=e.Name,r=a.PropertyType.Internal.Property.GetInstance().GetPropType(o.JsGridConstants.FieldTypeToJsGridType[e.Type]);if(r&&"SPDateTime"==r.ID){t=new d.GridField(n,!0,!0,null,null,null,!1,null);this._params.parseAndSetFields[n]=1}else t=new d.GridField(n,!0,!0);r&&"SPUser"==r.ID&&r.SetPeoplePickerDefaultSettings(n);"1"==e.AllowMultipleValues?t.SetIsMultiValue(";"):t.SetSingleValuePropType(r);t.csrInfo=e;return t};e.prototype.createColumnInfo=function(e){var t=new d.ColumnInfo(e.DisplayName,null,e.RealFieldName,100),n=!("FALSE"===e.Filterable||"TRUE"===e.FilterDisable||"Note"===e.FieldType||"URL"===e.FieldType||"FileSizeDisplay"===e.Name||"_IsRecord"===e.Name),r=e.Name,i="TRUE"!==e.FromBaseType,s=e.FieldType,o="Calculated"===e.role;t.isFilterable=n;t.internalName=r;t.isEditable=i;t.fieldType=s;t.isCalculated=o;return t};e.prototype.PopulateAddNewColumnMenuItems=function(e,t){var n=this,r={propType:"SPUser",hasData:!0,hasLocalized:!0},i={propType:"String",hasData:!1,hasLocalized:!0},s={propType:"SPDateTime",hasData:!1,hasLocalized:!0},o={propType:"Location",hasData:!0,hasLocalized:!0},u={Text:{Desc:Strings.STS.L_AddColumnDefaultName_Text,FnOnClick:function(){n.AddNewColumn("Text",i,Strings.STS.L_AddColumnDefaultName_Text,t)}},Number:{Desc:Strings.STS.L_AddColumnDefaultName_Number,FnOnClick:function(){n.AddNewColumn("Number",i,Strings.STS.L_AddColumnDefaultName_Number,t)}},DateTime:{Desc:Strings.STS.L_AddColumnDefaultName_DateAndTime,FnOnClick:function(){n.AddNewColumn("DateTime",s,Strings.STS.L_AddColumnDefaultName_DateAndTime,t)}},User:{Desc:Strings.STS.L_AddColumnDefaultName_PersonOrGroup,FnOnClick:function(){n.AddNewColumn("User",r,Strings.STS.L_AddColumnDefaultName_PersonOrGroup,t)}},Location:{Desc:L.default.L_AddColumnDefaultName_Location,FnOnClick:function(){n.AddNewColumn("Location",o,L.default.L_AddColumnDefaultName_Location,t)}},MoreColumnTypes:{Desc:Strings.STS.L_AddColumnDefaultName_MoreColumnTypes,FnOnClick:function(){n.AddNewColumn("MoreColumnTypes",null,null,t)}}};for(var a in u){var f=u[a];e.InsertMenuItem({key:f.Desc,text:f.Desc,onClick:f.FnOnClick})}};e.prototype.PopulateAddNewColumnMenuItemsV2=function(e,t,n,r){var i=this,o={Text:{Desc:L.default.L_AddColumnDefaultName_Text,FnOnClick:function(){i.onLaunchColumnManagementPanelAction(A.default.Text,n,r)}},Note:{Desc:L.default.L_AddColumnDefaultName_Note,FnOnClick:function(){i.onLaunchColumnManagementPanelAction(A.default.Note,n,r)}},Location:{Desc:L.default.L_AddColumnDefaultName_Location,FnOnClick:function(){i.onLaunchColumnManagementPanelAction(A.default.Location,n,r)}},Number:{Desc:L.default.L_AddColumnDefaultName_Number,FnOnClick:function(){i.onLaunchColumnManagementPanelAction(A.default.Number,n,r)}},Boolean:{Desc:L.default.L_AddColumnDefaultName_Boolean,FnOnClick:function(){i.onLaunchColumnManagementPanelAction(A.default.Boolean,n,r)}},User:{Desc:L.default.L_AddColumnDefaultName_PersonOrGroup,FnOnClick:function(){i.onLaunchColumnManagementPanelAction(A.default.User,n,r)}},DateTime:{Desc:L.default.L_AddColumnDefaultName_DateAndTime,FnOnClick:function(){i.onLaunchColumnManagementPanelAction(A.default.DateTime,n,r)}},Choice:{Desc:L.default.L_AddColumnDefaultName_Choice,FnOnClick:function(){i.onLaunchColumnManagementPanelAction(A.default.Choice,n,r)}},URL:{Desc:L.default.L_AddColumnDefaultName_URL,FnOnClick:function(){i.onLaunchColumnManagementPanelActionWithLink(A.default.URL,n,r)}},Picture:{Desc:L.default.L_AddColumnDefaultName_Picture,FnOnClick:function(){i.onLaunchColumnManagementPanelAction(A.default.URL,n,r)}},Currency:{Desc:L.default.L_AddColumnDefaultName_Currency,FnOnClick:function(){i.onLaunchColumnManagementPanelAction(A.default.Currency,n,r)}},Thumbnail:{Desc:L.default.L_AddColumnDefaultName_Thumbnail,FnOnClick:function(){i.onLaunchColumnManagementPanelAction(A.default.Thumbnail,n,r)}},MoreColumnTypes:{Desc:L.default.L_AddColumnDefaultName_MoreColumnTypes,FnOnClick:function(){i.AddNewColumn("MoreColumnTypes")}}};for(var u in o){var a=o[u];("Thumbnail"!==u||s.JsGridUtil.Internal.IsFeatureEnabled(O))&&e.InsertMenuItem({key:a.Desc,text:a.Desc,onClick:a.FnOnClick})}};e.prototype.EditColumn=function(e,t,n,r){var i=this;if(s.JsGridUtil.Internal.IsFeatureEnabled(D)){this._currentEditColumnInternalName=r;e.InsertMenuItem({key:"ColumnManagement",text:L.default.L_EditColumn,onClick:function(){i._ensureExternalJsFilesLoaded(function(){t({editField:{fieldName:r,fieldType:A.default[n]},isHyperlink:"Hyperlink"===n.toString()},i.editColumnOnCompleteCallback)})}})}};e.prototype.OnNextPage=function(e){var t=this._jsGridControl.GetTopRowIndex(),n=this._jsGridControl.GetVisibleRecordCount(),r=t+n-1;if(r!=this._params.totalItemCount){var i=r+n;this._jsGridControl.ScrollCellIntoView(Math.min(i,this._params.totalItemCount))}};e.prototype.ResolveAutoFilterState=function(e){var t=1;for(var n in e){var r="FilterField",i="FilterValue";if(-1!==e[n].indexOf(";#")){r="FilterFields";i="FilterValues"}null==this._filterUrl&&(this._filterUrl="");this._filterUrl+="&"+r+t+"="+s.JsGridUtil.Internal.EscapeProperly(n)+"&"+i+t+"="+s.JsGridUtil.Internal.EscapeProperly(e[n]);t++}};e.prototype.OnAutoFilter=function(e){this._filterUrl=null;this._pagingInfo=null;this.ResolveAutoFilterState(e);this.ClearItemInfoPresent();this._dataSource.RefreshRowView(!1,this.RefreshRowView.bind(this))};e.prototype.GetAutoFilterEntries=function(e,t,n,r,i){var o,u=document.getElementById(this._params.iframeId),a="",f=0,l=this._params.filterLink;l||(l=null!=this._params.spCsrRenderCtx?this._params.spCsrRenderCtx.queryString:window.location.href);do{f++;null!=(o=l.match("FilterField"+f+"=[^&]*&FilterValue"+f+"=[^&]*"))&&(a=a+"&"+o)}while(o);var c=l.match("MembershipGroupId=[^&]*");null!=c&&(a+="&"+c);var h=l.match("RootFolder=[^&]*");null!=h&&(a+="&"+h);var p=l.match("InstanceID=[^&]*");null!=p&&(a+="&"+p);this._autoFilterContext={FieldName:t,OnSuccess:r,OnFailure:i};u.src=this._params.siteUrl+"/_layouts/15/filter.aspx?ListId="+this._params.listId+"&FieldInternalName="+s.JsGridUtil.Internal.EscapeProperly(t)+"&ViewId="+this._params.viewId+"&FilterOnly=1&Filter=1"+a+"&CallbackFn=OnJsGridIframeLoad&CallbackParam="+this._jsGridControl.parentNode.id};e.prototype.OnAutoFilterReturn=function(){var e;if(null!=(e=document.getElementById(this._params.iframeId))){var t=null;e.contentDocument?t=e.contentDocument:e.contentWindow&&e.contentWindow.document?t=e.contentWindow.document:e.document&&(t=e.document);if(null!=t){var n=t.getElementById("diidFilter"+this._autoFilterContext.FieldName);if(null!=n){var r=n.childNodes.length;if(r<=500){for(var i=n.childNodes,s=void 0,o=[],u=1;u<r;u++){s=i[u].innerText?i[u].innerText:i[u].textContent?i[u].textContent:i[u].innerHTML;o.push({displayString:s,dataValue:i[u].value})}var a={};a[this._autoFilterContext.FieldName]=o;this._autoFilterContext.OnSuccess(a);this._autoFilterContext=null;return}}}}this._autoFilterContext.OnFailure();this._autoFilterContext=null};e.prototype.LaunchFilterDialog=function(e){alert("launch filter dialog here")};e.prototype.WriteChangesToList=function(){null!=this._serverWriteTimeout&&clearTimeout(this._serverWriteTimeout);this._serverWriteTimeout=B?setTimeout(this.WriteChangesToListCore.bind(this),500):setTimeout(this.BatchedWriteChangesToListCore.bind(this),500)};e.prototype.RetrieveCSRData=function(e,t){var n=null,r=this._jsGridControl.GetSpCsrRenderCtx();if(null!=r){for(var i=['<FieldRef Name="ID"/>'],s=r.ListSchema.Field,o=0;o<s.length;o++)i.push('<FieldRef Name="'+s[o].Name+'"/>');var u=[],a=0,f=0;for(var l in e){a++;u.push(["<Eq>",'<FieldRef Name="ID" />','<Value Type="Number">',l,"</Value>","</Eq>"].join(""));if(a>1){u.push("</Or>");f++}}for(var c=[];f>0;){c.push("<Or>");f--}u=c.concat(u).join("");var h=['<View Scope="RecursiveAll">',"<ViewFields>"].concat(i).concat(["</ViewFields>","<Query>","<OrderBy>",'<FieldRef Name="ID"/>',"</OrderBy>","<Where>"]).concat(u).concat(["</Where>","</Query>","</View>"]).join("");n=t.renderListData(h)}return n};e.prototype.HandleCSRData=function(e,t,n){for(var r=e.get_value(),i=JSON.parse(r),o=null,u=0;u<i.Row.length;u++)if(i.Row[u].ID==n){o=i.Row[u];break}s.JsGridUtil.DebugAssert(null!=o,"Should be able to find the row we're querying for");this._jsGridControl.GetRecord(t).fieldRawDataMap.csrInfo=o;var a=this._jsGridControl.GetSpCsrRenderCtx();a.ListData=T.MergeListData(a.ListData,i)};e.prototype.PostCSRRender=function(){this._jsGridControl.GetSpCsrRenderCtx()};e.prototype.GetMostRecentChangeKey=function(e){var t=null;for(var n in e){var r=e[n].changeKey;t=null==t||r.GetVersionNumber()>t.GetVersionNumber()?r:t}return t};e.prototype.SetErrorFromCSOMException=function(e,t,n,r,i){var u=null;switch(t){case o.JsGridConstants.ClientErrorCodes.InvalidFieldValue:this._jsGridControl.SetCellError(e,n.split(",")[1],r);break;case o.JsGridConstants.ClientErrorCodes.DocAlreadyExists:this._jsGridControl.SetCellError(e,"Title",SP.Res.docAlreadyExists);break;case o.JsGridConstants.ClientErrorCodes.FieldValueFailedValidation:var a=i.get_fieldFailures();s.JsGridUtil.DebugAssert(a.length>0);for(var f=0;f<a.length;f++)this._jsGridControl.SetCellError(e,a[f].get_name(),a[f].get_message());break;case o.JsGridConstants.ClientErrorCodes.ItemValueFailedValidation:var l=i.get_itemFailure(),c=l?l.get_message():r;u=this.SetRowLevelError(e,c,!1);break;default:u=this.SetRowLevelError(e,r,!1)}return u};e.prototype.WriteChangesToListCore=function(){var e=this,t=function(){for(var t in i){var n=f[t].scope;if(n.get_hasException()){e.SetErrorFromCSOMException(t,n.get_serverErrorCode(),n.get_serverErrorValue(),n.get_errorMessage(),n.get_serverErrorDetails());for(var a in e._changesBeingSent[t])e._fnCallbacksByChangeKey.CallFunctions(e._changesBeingSent[t][a].changeKey.GetVersionNumber(),!1)}else{var l=f[t].item,c=l.get_fieldValuesAsText().get_fieldValues();null!=e._jsGridControl.GetSpCsrRenderCtx()&&e.HandleCSRData(u,t,l.get_id());var h=e._changesBeingSent[t],d=e.GetMostRecentChangeKey(h),v={};for(var a in e._gridFieldMap)if(a in c){var m=h[a]&&h[a].changeKey,g=e._gridFieldMap[a].csrInfo?e._gridFieldMap[a].csrInfo.StaticName:"",y=!1;for(var b in h)if(0===g.indexOf(e._gridFieldMap[b].csrInfo.ID)){y=!0;break}var w=null!=m;if(w||y||a in e._params.computedFields){var E=e.SPListValueToGridValue(l.get_item(a),l.get_fieldValuesAsText().get_item(a),e._gridFieldMap[a].GetPropType(),a),S=p.CreateValidatedPropertyUpdate(t,a,E&&E.data,E&&E.localized);e._cascadingChangeKey=w?m:d;e._jsGridControl.UpdateProperties([S],null,e._cascadingChangeKey);if(w){e._cascadingChangeKey.Release();var x=void 0;if("SPDateTime"==e._gridFieldMap[a].GetPropType().ID){x=null==l.get_item(a)?c[a]:SP.DateTimeUtil.IntlDate.createFromJsUtcDate(E.data,s.JsGridUtil.SpRegionalSettings.calendarType).toJsDate()._toFormattedString("s",JSON.parse(o.JsGridConstants.SUPERTEMPORARY_invariantCultureStringify))}else x=c[a];v[a]={localizedValue:x}}e._cascadingChangeKey=null}}for(var a in h)e._fnCallbacksByChangeKey.CallFunctions(h[a].changeKey.GetVersionNumber(),!0,l.get_id());e._jsGridControl.GetRecord(t);for(var T=0;T<e._fnRowChanged.length;T++)e._fnRowChanged[T](t,v,!1);delete e._changesBeingSent[t];e.ClearRowLevelError(t)}}r(i);e.PostCSRRender()},n=function(t,n){for(var s in i)e.SetRowLevelError(s,SP.Res.serverCommError,!0);for(var s in e._changesBeingSent)for(var o in e._changesBeingSent[s])e._fnCallbacksByChangeKey.CallFunctions(a[o].changeKey.GetVersionNumber(),!1);r(i)},r=function(t){e._currentlyWritingChangesToList=!1;e._queuedWriteChangesRequest&&setTimeout(e.WriteChangesToList.bind(e),0);for(var n in t)e._jsGridControl.RemoveRowHeaderState(n,o.JsGridConstants.RowHeaderStyleId.Transfer);if(s.JsGridUtil.Internal.IsAssocArrayEmpty(e._changesToSend))e._changesToSend=e._changesBeingSent;else for(var n in e._changesBeingSent)if(null==e._changesToSend[n])e._changesToSend[n]=e._changesBeingSent[n];else for(var r in e._changesBeingSent[n]){null!=e._changesToSend[n][r]&&e._changesToSend[n][r].changeKey.Release();e._changesToSend[n][r]=e._changesBeingSent[n][r]}e._changesBeingSent=null},i=this.GetRecordKeysToSend();if(!s.JsGridUtil.Internal.IsAssocArrayEmpty(i)&&(function(t){if(e._currentlyWritingChangesToList){e._queuedWriteChangesRequest=!0;return!1}e._currentlyWritingChangesToList=!0;e._queuedWriteChangesRequest=!1;for(var n in t){e._jsGridControl.RemoveRowHeaderState(n,o.JsGridConstants.RowHeaderAutoStyleId.Dirty);e._jsGridControl.AddBuiltInRowHeaderState(n,o.JsGridConstants.RowHeaderStyleId.Transfer)}e._changesBeingSent=e._changesToSend;e._changesToSend={};return!0})(i)){var u,a,f={};this._ensureExternalJsFilesLoaded(function(){var r=e.InitContext(t,n);for(var s in i){var o=new SP.ExceptionHandlingScope(r.context),l=o.startScope(),c=r.list.getItemById(s);a=e._changesBeingSent[s];for(var h in a){var p=a[h],d=e.GridValueToSPListValue(p.newProp,p.propType);if(h in e._params.parseAndSetFields){c.parseAndSetFieldValue(h,d);null!=e._params.spCsrRenderCtx&&106===e._params.spCsrRenderCtx.ListTemplateType&&("EndDate"===h&&!a.EventDate&&null!=e._params.spCsrRenderCtx.CurrentItem&&e._params.spCsrRenderCtx.CurrentItem.EventDate?c.parseAndSetFieldValue("EventDate",e._params.spCsrRenderCtx.CurrentItem.EventDate):"EventDate"===h&&!a.EndDate&&null!=e._params.spCsrRenderCtx.CurrentItem&&e._params.spCsrRenderCtx.CurrentItem.EndDate&&c.parseAndSetFieldValue("EndDate",e._params.spCsrRenderCtx.CurrentItem.EndDate))}else if(null==p.propType||"TaxonomyField"!=p.propType.ID&&"TaxonomyField_MultiValue"!=p.propType.ID)c.set_item(h,d);else{r.list.get_fields().getByInternalNameOrTitle(h).validateSetValue(c,d)}}c.update();c.get_fieldValuesAsText().retrieve();c.retrieve();l.dispose();f[s]={item:c,scope:o}}u=e.RetrieveCSRData(i,r.list);r.context.executeQueryAsync();var m=Object.keys(i);v.EventGroup.raise(document,E.SPGridEvents.quickEditWriteChangesToListEventName,{itemIds:m});e._logEngagement("QuickEdit.WriteChangesToListCore",{itemIds:m})})}};e.prototype.BatchedWriteChangesToListCore=function(){var e=this,t=this.GetRecordKeysToSend();if(!s.JsGridUtil.Internal.IsAssocArrayEmpty(t)&&(function(t){if(e._currentlyWritingChangesToList){e._queuedWriteChangesRequest=!0;return!1}e._currentlyWritingChangesToList=!0;e._queuedWriteChangesRequest=!1;for(var n in t){e._jsGridControl.RemoveRowHeaderState(n,o.JsGridConstants.RowHeaderAutoStyleId.Dirty);e._jsGridControl.AddBuiltInRowHeaderState(n,o.JsGridConstants.RowHeaderStyleId.Transfer)}e._changesBeingSent=e._changesToSend;e._changesToSend={};return!0})(t)){var n=Object.keys(t),r=0;this._ensureExternalJsFilesLoaded(function(){for(var i=function(i){var u;j||(u=new(e._telemetry(N.Qos))({name:q}));for(var a={},f=0;f<50&&i+f<n.length;f++){var l=n[i+f];a[l]=t[l]}var c,h=function(t){e._currentlyWritingChangesToList=!1;e._queuedWriteChangesRequest&&setTimeout(e.WriteChangesToList.bind(e),0);for(var n in t)e._jsGridControl.RemoveRowHeaderState(n,o.JsGridConstants.RowHeaderStyleId.Transfer);if(s.JsGridUtil.Internal.IsAssocArrayEmpty(e._changesToSend))e._changesToSend=e._changesBeingSent;else for(var n in e._changesBeingSent)if(null==e._changesToSend[n])e._changesToSend[n]=e._changesBeingSent[n];else for(var r in e._changesBeingSent[n]){null!=e._changesToSend[n][r]&&e._changesToSend[n][r].changeKey.Release();e._changesToSend[n][r]=e._changesBeingSent[n][r]}e._changesBeingSent=null},d=e.InitContext(function(){r+=Object.keys(a).length;for(var i in a){var f=m[i].scope;if(f.get_hasException()){e.SetErrorFromCSOMException(i,f.get_serverErrorCode(),f.get_serverErrorValue(),f.get_errorMessage(),f.get_serverErrorDetails());for(var l in e._changesBeingSent[i])e._fnCallbacksByChangeKey.CallFunctions(e._changesBeingSent[i][l].changeKey.GetVersionNumber(),!1)}else{var c=m[i].item,d=c.get_fieldValuesAsText().get_fieldValues();null!=e._jsGridControl.GetSpCsrRenderCtx()&&e.HandleCSRData(C,i,c.get_id());var v=e._changesBeingSent[i],g=e.GetMostRecentChangeKey(v),y={};for(var l in e._gridFieldMap)if(l in d){var b=v[l]&&v[l].changeKey,w=e._gridFieldMap[l].csrInfo?e._gridFieldMap[l].csrInfo.StaticName:"",E=!1;for(var S in v)if(0===w.indexOf(e._gridFieldMap[S].csrInfo.ID)){E=!0;break}var x=null!=b;if(x||E||l in e._params.computedFields){var T=e.SPListValueToGridValue(c.get_item(l),c.get_fieldValuesAsText().get_item(l),e._gridFieldMap[l].GetPropType(),l),k=p.CreateValidatedPropertyUpdate(i,l,T&&T.data,T&&T.localized);e._cascadingChangeKey=x?b:g;e._jsGridControl.UpdateProperties([k],null,e._cascadingChangeKey);if(x){e._cascadingChangeKey.Release();var L=void 0;if("SPDateTime"==e._gridFieldMap[l].GetPropType().ID){L=null==c.get_item(l)?d[l]:SP.DateTimeUtil.IntlDate.createFromJsUtcDate(T.data,s.JsGridUtil.SpRegionalSettings.calendarType).toJsDate()._toFormattedString("s",JSON.parse(o.JsGridConstants.SUPERTEMPORARY_invariantCultureStringify))}else L=d[l];y[l]={localizedValue:L}}e._cascadingChangeKey=null}}for(var l in v)e._fnCallbacksByChangeKey.CallFunctions(v[l].changeKey.GetVersionNumber(),!0,c.get_id());e._jsGridControl.GetRecord(i);for(var A=0;A<e._fnRowChanged.length;A++)e._fnRowChanged[A](i,y,!1);delete e._changesBeingSent[i];e.ClearRowLevelError(i)}}r>=n.length&&h(t);e.PostCSRRender();j||u.end({resultType:N.ResultTypeEnum.Success})},function(i,s){r+=Object.keys(a).length;for(var o in a)e.SetRowLevelError(o,SP.Res.serverCommError,!0);if(r>=n.length){for(var o in e._changesBeingSent)for(var f in e._changesBeingSent[o])e._fnCallbacksByChangeKey.CallFunctions(c[f].changeKey.GetVersionNumber(),!1);h(t)}j||u.end({resultType:N.ResultTypeEnum.Failure,resultCode:"FailToWriteChange",error:SP.Res.serverCommError})}),m={};for(var g in a){var y=new SP.ExceptionHandlingScope(d.context),b=y.startScope(),w=d.list.getItemById(g);c=e._changesBeingSent[g];for(var S in c){var x=c[S],T=e.GridValueToSPListValue(x.newProp,x.propType);if(S in e._params.parseAndSetFields){w.parseAndSetFieldValue(S,T);null!=e._params.spCsrRenderCtx&&106===e._params.spCsrRenderCtx.ListTemplateType&&("EndDate"===S&&!c.EventDate&&null!=e._params.spCsrRenderCtx.CurrentItem&&e._params.spCsrRenderCtx.CurrentItem.EventDate?w.parseAndSetFieldValue("EventDate",e._params.spCsrRenderCtx.CurrentItem.EventDate):"EventDate"===S&&!c.EndDate&&null!=e._params.spCsrRenderCtx.CurrentItem&&e._params.spCsrRenderCtx.CurrentItem.EndDate&&w.parseAndSetFieldValue("EndDate",e._params.spCsrRenderCtx.CurrentItem.EndDate))}else if(null==x.propType||"TaxonomyField"!=x.propType.ID&&"TaxonomyField_MultiValue"!=x.propType.ID)w.set_item(S,T);else{d.list.get_fields().getByInternalNameOrTitle(S).validateSetValue(w,T)}}w.update();w.get_fieldValuesAsText().retrieve();w.retrieve();b.dispose();m[g]={item:w,scope:y}}var C=e.RetrieveCSRData(a,d.list);d.context.executeQueryAsync();var k=Object.keys(a);v.EventGroup.raise(document,E.SPGridEvents.quickEditWriteChangesToListEventName,{itemIds:k});e._logEngagement("QuickEdit.WriteChangesToListCore",{itemIds:k})},u=0;u<n.length;u+=50)i(u)})}};e.prototype._ensureExternalJsFilesLoaded=function(e){if(!H&&s.JsGridUtil.Internal.IsFeatureEnabled(M)){var n=[t.taxonomyLoadCallback],r=this._params.siteUrl+"/",i=[r+"_layouts/15/sp.init.js",r+"_layouts/15/mquery.js",r+"_layouts/15/sp.runtime.js",r+"_layouts/15/sp.js"];t.csomJsFilesLoader._ensureExternalJsFilesLoaded(i,e,n)}else e()};e.prototype.SetRowLevelError=function(e,t,n){this.ClearRowLevelError(e);var r=this._jsGridControl.SetRowError(e,t);this._rowLevelErrors[e]={id:r,bCommunicationsError:n};return r};e.prototype.ClearRowLevelError=function(e){if(e in this._rowLevelErrors){this._jsGridControl.ClearRowError(e,this._rowLevelErrors[e].id);delete this._rowLevelErrors[e]}};e.prototype.SetItemInfoPresent=function(e){for(var t=this._jsGridControl._GetPaneManager().GetGridPane().GetGridPaneConverter(),n=Math.min(e+this._params.viewRowLimit,this._infoFetched.length),r=e;r<n;r++)this._infoFetched[r]=t.RowIdxToRecordKey(r)};e.prototype.ClearItemInfoPresent=function(){this._infoFetched=new Array(this._params.totalItemCount)};e.prototype.ComputeSPDataRange=function(e){var t,n={pos:-1,count:0},r={rangesToFillRequest:1,totalRanges:[]},i=this._params.viewRowLimit,s=this._params.totalItemCount,o=this._jsGridControl.GetTopRowIndex(),u=this._jsGridControl.GetVisibleRecordCount(),a=Math.min(o+u,s);for(t=o;t<a;t++)if(!this._infoFetched[t]){n.pos=t;break}if(t==o)for(var f=a;f>=o;f--)if(!this._infoFetched[f]){n.pos=Math.max(0,f-i+1);for(;n.pos<this._infoFetched.length&&this._infoFetched[n.pos];)n.pos++;break}n.callbacks=[e];n.count=Math.min(s-n.pos,i);r.totalRanges.push(n);return r};e.prototype.CreateEntryRecord=function(){return this._dataSource.recordFactory.MakeRecord({},{})};e.prototype.CreateNewListItem=function(e,t,n,r){var i,s,u=this;j||(s=new(this._telemetry(N.Qos))({name:X}));var a=function(){var r=i.get_fieldValues(),a=i.get_fieldValuesAsText().get_fieldValues();r&&r.ID&&v.EventGroup.raise(document,E.SPGridEvents.quickEditWriteChangesToListEventName,{itemIds:[r.ID]});var f=function(i){var f={},l={},c=S.Killswitch.isActivated("EC4AE4F1-A4D6-4A7D-B010-0F14A2EFA541","10/15/2019","Fix issue with sending raw CSOM objects down into cell renderers.");for(var h in u._gridFieldMap)if(h in r){var p=null==e[h]?null:u.SPListValueToGridValue(c?r[h]:e[h].data,c?a[h]:e[h].value,u._gridFieldMap[h].GetPropType(),h);p&&p.hasOwnProperty("data")&&(l[h]=p.data);p&&p.hasOwnProperty("localized")&&(f[h]=p.localized)}var d=i.get_id();l.ID=f.ID=d;l.ContentType=f.ContentType=i.get_contentType().get_name();l.Edit=o.JsGridConstants.SPGPermissions.editListItems|o.JsGridConstants.SPGPermissions.deleteListItems;u._jsGridControl.RemoveRowHeaderState(e.key(),o.JsGridConstants.RowHeaderStyleId.Transfer);null!=n&&n(d,f,l);u._currentlyCreatingNewListItem=!1;u._jsGridControl.GetRecord(d);for(h=0;h<u._fnRowChanged.length;h++)u._fnRowChanged[h](d,f,!1);if(null!=t)for(var v=0;v<t.length;v++)u._fnCallbacksByChangeKey.CallFunctions(t[v].changeKey.GetVersionNumber(),!0,d);j||s.end({resultType:N.ResultTypeEnum.Success})},l=u._jsGridControl.GetSpCsrRenderCtx();null!=l?(function(e,t){var n=u.InitContext(function(){u.HandleCSRData(i,t.recordKey,e.get_id());f(e);var n=t.fieldRawDataMap.csrInfo;l.ListData.Row.push(n);u.PostCSRRender()}),r={};r[e.get_id()]=1;var i=u.RetrieveCSRData(r,n.list);n.context.executeQueryAsync()})(i,e):f(i)},f=function(n,i,a){u._jsGridControl.RemoveRowHeaderState(e.key(),o.JsGridConstants.RowHeaderStyleId.Transfer);var f=a;null!=i&&(f=u.SetErrorFromCSOMException(e.key(),i.get_errorCode(),i.get_errorValue(),i.get_message(),i.get_errorDetails()));null!=r&&r(i&&i.get_message(),f);u._currentlyCreatingNewListItem=!1;if(null!=t)for(var l=0;l<t.length;l++)u._fnCallbacksByChangeKey.CallFunctions(t[l].changeKey.GetVersionNumber(),!1);j||s.end({resultType:N.ResultTypeEnum.Failure,resultCode:"FailToCreateItem",error:i&&i.get_message()})};this._jsGridControl.RemoveRowHeaderState(e.key(),o.JsGridConstants.RowHeaderAutoStyleId.Dirty);this._jsGridControl.AddBuiltInRowHeaderState(e.key(),o.JsGridConstants.RowHeaderStyleId.Transfer);var l={},c={};if(null!=t)for(var h=0;h<t.length;h++){c[t[h].fieldKey]=t[h];l[t[h].fieldKey]=t[h].newProp}var p=(function(t){var n,r=!1,i=null,s=function(t){null==u._jsGridControl.GetColumnByFieldKey(t)?i=u.SetRowLevelError(e.recordKey,SP.Res.requiredFieldNotInEditView,!1):u._jsGridControl.SetCellError(e.recordKey,t,SP.Res.requiredField15);r=!0};for(var o in u._params.requiredFields)(null==(n=t[o])||n.HasLocalizedValue()&&(""==n.localized||null==n.localized)||n.HasDataValue()&&null==n.data)&&s(o);if(null!=e.fieldRawDataMap&&null!=e.fieldRawDataMap._ContentTypeId){var a=e.fieldRawDataMap._ContentTypeId;if(null!=a&&a in u._params.contentTypes)for(var f=u._params.contentTypes[a].RequiredFields,l=0;l<f.length;l++){(null==(n=t[o=f[l]])||n.HasLocalizedValue()&&(""==n.localized||null==n.localized)||n.HasDataValue()&&null==n.data)&&s(o)}}return{fieldsMissing:r,errorId:i}})(l);p.fieldsMissing?f(0,null,p.errorId):this._ensureExternalJsFilesLoaded(function(){var e,t=u.InitContext(a,f);null!=u._params.viewRootFolder&&(e=new SP.ListItemCreationInformation).set_folderUrl(u._params.viewRootFolder);i=t.list.addItem(e);for(var n in c){var r=c[n],s=u.GridValueToSPListValue(r.newProp,r.propType);if(n in u._params.parseAndSetFields)i.parseAndSetFieldValue(n,s);else if(null==r.propType||"TaxonomyField"!=r.propType.ID&&"TaxonomyField_MultiValue"!=r.propType.ID)i.set_item(n,s);else{t.list.get_fields().getByInternalNameOrTitle(n).validateSetValue(i,s)}}i.update();i.get_fieldValuesAsText().retrieve();i.retrieve();i.get_contentType().retrieve();t.context.executeQueryAsync();u._currentlyCreatingNewListItem=!0})};e.prototype.InitContext=function(e,t){var n=new SP.ClientContext(this._params.siteUrl);n.add_requestSucceeded(function(t,n){setTimeout(function(){e(t,n)},0)});n.add_requestFailed(function(e,n){setTimeout(function(){t&&t(e,n)},0)});var r=n.get_web(),i=r.get_lists().getById(this._params.listId),s=i.get_views().getById(this._params.viewId);return{context:n,web:r,list:i,view:s}};e.prototype.InitSPListValueConversion=function(e){var t=this;this._GridValueToSPListValueConverters.Hyperlink=function(e){if(null==e.data)return null;var t=new SP.FieldUrlValue;t.set_url(e.data.address);t.set_description(e.data.display);return t};this._SPListValueToGridValueConverters.Hyperlink=function(e,t,n){return null==e?null:{data:{address:e.get_url(),display:e.get_description()},localized:e.get_description()}};this._SPListValueToGridValueConverters.SPEnhancedRichText=function(e,t,n){return null==e||""==e?null:{data:e,localized:e}};this._GridValueToSPListValueHelper=function(e){return F?null!=e&&e.hasOwnProperty("email")&&""!==e.email?-1==e.email.indexOf("@")&&e.email!==e.display?e.email+";#"+e.display:"-1;#"+e.email:"-1;#"+e.display:null!=e&&e.hasOwnProperty("email")&&e.email?-1==e.email.indexOf("@")&&e.email!==e.display?e.email+";#"+e.display:"-1;#"+e.email:"-1;#"+e.display};this._GridValueToSPListValueConverters.SPUser=function(e){var n=null==e.data||e.data==s.JsGridUtil.EmptyValue?"":t._GridValueToSPListValueHelper(e.data);return""!==n?n:null==e.localized||""==e.localized?null:"-1;#"+e.localized};this._SPListValueToGridValueConverters.SPUser=function(e,t,n){return{data:[e],localized:e.get_lookupValue()}};this._GridValueToSPListValueConverters.SPUser_MultiValue=function(e){var n=e.localized,r=e.data,i="";if(!(null==r||r==s.JsGridUtil.EmptyValue))if(r.hasOwnProperty("email"));else if("undefined"!==r.length)for(var o=0;o<r.length;o++){i=i+(""==i?"":";#")+t._GridValueToSPListValueHelper(r[o])}return""!==i?i:null==n||""==n?null:"-1;#"+s.JsGridUtil.Internal.TokenizeString(n,";").join(";#-1;#")};this._SPListValueToGridValueConverters.SPUser_MultiValue=function(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(e[i].get_lookupValue());return{data:e,localized:r.join("; ")}};this._GridValueToSPListValueConverters.Location=function(e){return JSON.stringify(e.data)};this._SPListValueToGridValueConverters.Location=function(e,t,n){var r=JSON.parse(e);return{data:r,localized:r.DisplayName}};this._GridValueToSPListValueConverters.DropdownBoolean=function(e){return e.data?1:0};this._SPListValueToGridValueConverters.SPDateTime=function(e,t,n){return{data:new Date(e.valueOf()+60*s.JsGridUtil.SpRegionalSettings.timeZoneInHours*60*1e3),localized:t}};var n=function(e){return e.data&&e.data+";#"},r=function(e,t,n){return{data:e.get_lookupId(),localized:t}},i=function(e){return e.data&&e.data.join(";#;#")+";#"},o=function(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(e[i].get_lookupId());return{data:r,localized:t}};for(var u in e){var a=u+"_Lookup";this._GridValueToSPListValueConverters[a]=n;this._SPListValueToGridValueConverters[a]=r;a=u+"_Lookup_MultiValue";this._GridValueToSPListValueConverters[a]=i;this._SPListValueToGridValueConverters[a]=o}};e.prototype.RegisterSPListValueToGridValueConverter=function(e,t){this._SPListValueToGridValueConverters[e]=t};e.prototype.RegisterGridValueToSPListValueConverter=function(e,t){this._GridValueToSPListValueConverters[e]=t};e.prototype.GridValueToSPListValue=function(e,t){var n;return""===(n=null==t?e.HasDataValue()?e.data:e.localized:null!=this._GridValueToSPListValueConverters[t.ID]?this._GridValueToSPListValueConverters[t.ID](e):t.bMultiValue?t.LocStrToLocStrArray(e.localized).join(";#"):e.localized)?null:n};e.prototype.SPListValueToGridValue=function(e,t,n,r){return null==e?null:n&&null!=this._SPListValueToGridValueConverters[n.ID]?this._SPListValueToGridValueConverters[n.ID](e,t,r):{data:e,localized:n&&n.bMultiValue?n.LocStrArrayToLocStr(this.isArray(e)?e:s.JsGridUtil.Internal.TokenizeString(e,";#")):t}};e.prototype.isArray=function(e){return e&&e.constructor==Array};e.prototype.GetGanttBarDate=function(e,t,n){var r,i=e.GetDataValue(this._params.startColumnName),s=e.GetDataValue(this._params.finishColumnName);if(null!=i&&null!=s&&i>s){var u=i;i=s;s=u}if(n==o.JsGridConstants.GanttBarDateType.End&&1==t&&null!=i&&null!=s){var a=null!=this._params.pctCompleteColumnName?e.GetDataValue(this._params.pctCompleteColumnName):null;a=Math.min(null==a?0:a,1);if(isNaN(a))r=null;else{s instanceof Date||(s=new Date(s));i instanceof Date||(i=new Date(i));var f=Math.abs(s.getTime()-i.getTime());r=0!==a?new Date(i.getTime()+f*a):null}}else r=n==o.JsGridConstants.GanttBarDateType.Start?i:s;return r};e.prototype.GetPredecessors=function(e,t){if(null==t)return null;for(var n=[],r=0;r<t.length;r++)n.push({key:t[r],type:o.JsGridConstants.LinkType.FinishStart});return n};e.prototype.GetFieldReadOnlyActiveState=function(e){var t=this.GetCSRFieldFromJsGridFieldKey(e);return null==t||null==t.GridActiveAndReadOnly?null:"TRUE"==t.GridActiveAndReadOnly?o.JsGridConstants.ReadOnlyActiveState.ReadOnlyActive:o.JsGridConstants.ReadOnlyActiveState.ReadOnlyDisabled};e.prototype.GetFieldEditMode=function(e){var t=this.GetCSRFieldFromJsGridFieldKey(e);return null==t?o.JsGridConstants.EditMode.ReadOnly:(S.Killswitch.isActivated("ae71ac90-2661-4917-9476-c1542f2e6849","12/23/2019","Make new image columns read only in quick edit")||"Thumbnail"!==t.FieldType||"Thumbnail"===t.RealFieldName||"ThumbnailOnForm"===t.RealFieldName)&&"TRUE"==t.AllowGridEditing&&"TRUE"!==t.ReadOnly&&"1"!==t.XSLRender?o.JsGridConstants.EditMode.ReadWriteDefer:o.JsGridConstants.EditMode.ReadOnly};e.prototype.GetRecordEditMode=function(e){return e.GetDataValue("Edit")&o.JsGridConstants.SPGPermissions.editListItems?o.JsGridConstants.EditMode.ReadWriteDefer:o.JsGridConstants.EditMode.ReadOnly};e.prototype.ShouldLinkTitleCell=function(e,t,n,r){return null!=e.GetDataValue("_FolderLink")};e.prototype.OnTitleCellContentsClicked=function(e,t,n,r){var i=SP.Utilities.UrlBuilder.urlCombine(SP.PageContextInfo.get_webServerRelativeUrl(),e.GetDataValue("_FolderLink"));window.location.href=SP.Utilities.UrlBuilder.urlCombine(SP.PageContextInfo.get_webServerRelativeUrl(),this._params.viewUrl+"?RootFolder="+s.JsGridUtil.Internal.EscapeProperly(i)+"&FolderCTID="+this._params.folderContentTypeId)};e.prototype.OnEditCellContentsClicked=function(e,t,n,r){var i=GetCurrentCtx().editFormUrl,o=-1==i.indexOf("?")?"?":"&";window.location.href=i+o+"ID="+e.GetDataValue("ID")+"&Source="+s.JsGridUtil.Internal.EscapeProperly(window.location.href)};e.prototype.DeleteSelectedRecords=function(e){for(var t=this._jsGridControl.GetSelectedRecordKeys(),n=!1,r=0;r<t.length;r++)if(t[r]==e){n=!0;break}n&&0!=t.length||null==e||(t=[e]);this.DeleteItems(t)};e.prototype.IsParent=function(e){return!1};e.prototype.DeleteItems=function(e,t){var n,r=this,i=[];j||(n=new(this._telemetry(N.Qos))({name:U}));var u=function(e){return function(){for(var e=0;e<i.length;e++)for(var s=i[e],o=r._jsGridControl.GetRecord(s),u=0;u<r._fnRowChanged.length;u++)r._fnRowChanged[u](s,o.properties,!0);null!=i&&r._jsGridControl.DeleteRecords(i);r._currentlyDeletingListItems=!1;null!=t&&t(!0);j||n.end({resultType:N.ResultTypeEnum.Success})}},a=function(e){return function(){e&&alert(SP.Res.deleteFailed);r._currentlyDeletingListItems=!1;null!=t&&t(!1);j||n.end({resultType:N.ResultTypeEnum.Failure,resultCode:"FailToDeleteItemsd",error:SP.Res.deleteFailed})}};this._ensureExternalJsFilesLoaded(function(){for(var n=0;n<e.length;n++)r._jsGridControl.IsEntryRecordKey(e[n])||i.push(e[n]);var f=[];for(n=0;n<i.length;n++)r._jsGridControl.IsProvisionalRecordKey(i[n])?r._jsGridControl.DeleteRecords([i[n]]):f.push(i[n]);for(n=0;n<i.length;n++){var l=i[n];null!=r._changesToSend[l]&&delete r._changesToSend[l]}var c=r._jsGridControl.GetSpCsrRenderCtx();if(null==c){if(null!=r._jsGridControl.DeleteRecords(i))if(0!==f.length){r._currentlyDeletingListItems=!0;var h=r.InitContext(u(),a(!0)),p="1"==ctx.RecycleBinEnabled&&!ctx.ExternalDataList;for(n=0;n<f.length;n++){if(r._dataSource.tableCache.GetCachedRecord(f[n]).GetDataValue("Edit")&o.JsGridConstants.SPGPermissions.deleteListItems){var d=h.list.getItemById(f[n]);p?d.recycle():d.deleteObject()}}h.context.executeQueryAsync()}else null!=t&&t(!0)}else s.JsGridUtil.Internal.IsFeatureEnabled(M)?T.inplview.DeleteSelectedItemsCore(c,f,u(),a(!1)):window.inplview.DeleteSelectedItemsCore(c,f,u(),a(!1))})};e.prototype.get_ItemCount=function(){return this._jsGridControl.GetViewRecordCount()};e.prototype.GetViewIndexOfItem=function(e){return this._jsGridControl.GetViewIndexOfRecord(e)};e.prototype.TrySelectItem=function(e){this._jsGridControl.SelectRowRangeByKey(e,e,!1)};e.prototype.ToggleAllItems=function(){var e=this._jsGridControl._GetPaneManager().RecordKeyToViewIdx(this._jsGridControl.GetLastRecordKey()),t=this._jsGridControl.GetSelectedRecordKeys();null==t||t.length!==e-0+1?this._jsGridControl.SelectRowRange(0,e,!1):this._jsGridControl.SelectCellRange(0,0,0,0,!1)};e.prototype.ReadValue=function(e,t,n){this._dataSource.tableCache.GetRecordsByKey([e],function(e,r,i){if(i){var s=r[0],o={hasDataValue:s.HasDataValue(t),hasLocalizedValue:s.HasLocalizedValue(t)};o.hasDataValue&&(o.dataValue=s.GetDataValue(t));o.hasLocalizedValue&&(o.localizedValue=s.GetLocalizedValue(t));if(n)return n(!0,o)}else null!=n&&n(!1)})};e.prototype.GetOutlineLevel=function(e,t){var n=this;this._dataSource.tableCache.GetRecordsByKey([e],function(e,r,i){if(i){var s=n._jsGridControl.GetOutlineLevel(r[0]);if(t)return t(!0,s)}else null!=t&&t(!1)})};e.prototype.get_Columns=function(){return this._jsGridControl.GetColumns()};e.prototype.get_RequiredColumnKeys=function(){var e=[];for(var t in this._params.requiredFields)e.push(t);return e};e.prototype.get_IsInsertProvisionalChildOfFocusedItemEnabled=function(){return!!(null!=this._jsGridControl.GetFocusedItem()&&this._hierarchyEnabled&&this._params.listPermissions&o.JsGridConstants.SPGPermissions.addListItems)};e.prototype.get_IsReadOnly=function(){return(this._params.listPermissions&o.JsGridConstants.SPGPermissions.editListItems)!==o.JsGridConstants.SPGPermissions.editListItems};e.prototype.get_ContiguousSelectedItemsWithoutEntryItems=function(){var e=this._jsGridControl.GetContiguousRowSelectionWithoutEntryRecords();return null==e?null:e.keys};e.prototype.GetNodeExpandCollapseState=function(e){return this._jsGridControl.GetNodeExpandCollapseState(e)};e.prototype.ToggleExpandCollapse=function(e){this._jsGridControl.ToggleExpandCollapse(e)};e.prototype.MakeRecord=function(e,t){return this._dataSource.recordFactory.MakeRecord(e,t)};e.prototype.IsRWTimelineAwareOfList=function(e,t){if(void 0===SP.UI.Timeline)return!1;var n=!1;RunOperationOnTimelineData(function(){n=SP.UI.Timeline.ListTimelineDatasource.IsRWTimelineAwareOfList(e,t)});return n};e.prototype.OnRightClick=function(e){var t=this;if(e.context==o.JsGridConstants.ClickContext.RowHeader&&(this._params.listPermissions&o.JsGridConstants.SPGPermissions.deleteListItems||this._params.listPermissions&o.JsGridConstants.SPGPermissions.addListItems||this._params.listPermissions&o.JsGridConstants.SPGPermissions.editListItems)){var n=new m.ContextMenuWrapper(e.eventInfo,this._jsGridControl.parentNode.id+"_rowcontextmenu");this._params.listPermissions&o.JsGridConstants.SPGPermissions.deleteListItems&&n.InsertMenuItem({key:"deleteItem",text:SP.Res.deleteText,onClick:function(){t.DeleteSelectedRecords(e.recordKey)},disabled:this._jsGridControl.IsGroupingRecordKey(e.recordKey)||this._jsGridControl.IsEntryRecordKey(e.recordKey)});if(this._params.listPermissions&o.JsGridConstants.SPGPermissions.editListItems){this._jsGridControl.GetSpCsrRenderCtx();this.IsRWTimelineAwareOfList(this._params.listId,this._params.selectedTimelineView)&&n.InsertMenuItem({key:"addToTimeLine",text:Strings.STS.L_TimelineAddToTimeline,onClick:function(){var n=!1,r=t._jsGridControl.GetSelectedRecordKeys(),i=[];if(null!=r&&r.length&&r.length>0)for(var s=0;s<r.length;s++){(o={}).id=r[s];i.push(o);o.id==e.recordKey&&(n=!0)}if(0==n){var o;(o={}).id=e.recordKey.toString();i=[o]}t.AddItemsToTimeline(i)},disabled:this._bGrouped||this._jsGridControl.IsEntryRecordKey(e.recordKey)});this.CanDiscardChangesForRow(e.recordKey)&&n.InsertMenuItem({key:"discardChange",text:Strings.STS.L_SPGanttDiscardChangesMenuItem,onClick:function(){t.DiscardChangesForRow(e.recordKey)}})}n.Show()}};e.prototype.BuildMaxLengthTable=function(e){var t={};for(var n in e)"number"==typeof e[n]&&(t[n]=e[n]);return t};e._instances=[];e._FnGanttCreationCallback=[];return e})();t.GanttControl=J});
define("aQy",["require","exports","aPS","aQo","aQA","aQ3","aQz","aPY"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e,t,n,r,i,s,o){this.groupingRecords=null;this.rememberedRecordKeyHash=null;this.inVirtualMode=!1;this.populatingWebMethod=e;this.initWebMethod=t;this.computeDataRangeWebMethod=n;this._webMethodMgr=r;this._jsGridControl=i;this._fnRefreshRowViewCallback=s;this._fnUpdateDisplayAndEditControls=o}e.prototype.RefreshTableView=function(e,t,r){var o=this,u=new i.TableViewParameters,a=n.JsGridConstants.DeserializationMode.TableView;return this._webMethodMgr[this.initWebMethod.name](this.GetArguments(this.initWebMethod,a),function(n){var r=new s.Deserializer(n,a,o.keyColumnName);o.rememberedRecordKeyHash=r.recordKeyHash;if(!e){o._jsGridControl.ClearTableView();o.tableCache.Clear()}o.ProcessNewTableView(r,u,!0);null!=t&&t(u,r.additionalParams)},r)};e.prototype.RefreshRowView=function(e,t,r){var i=this,o=n.JsGridConstants.DeserializationMode.RowView;return this._webMethodMgr[this.populatingWebMethod.name](this.GetArguments(this.populatingWebMethod,o),function(n){var r=new s.Deserializer(n,o,i.keyColumnName);i.rememberedRecordKeyHash=r.recordKeyHash;var u=r.InitJsGridRowViewParams();e||i.tableCache.Clear();i.ProcessNewRowView(r,u);null!=t&&t(u,r.additionalParams)},r)};e.prototype.GetAutoFilterEntries=function(e,t,r){var i=this,o=n.JsGridConstants.DeserializationMode.AutoFilter;return this._webMethodMgr[this.populatingWebMethod.name](this.GetArguments(this.populatingWebMethod,o,e),function(e){var n=new s.Deserializer(e,o,i.keyColumnName);t(n.autoFilterEntries)},r)};e.prototype.BeginFullLoad=function(e,t,r){var i=this,u=n.JsGridConstants.DeserializationMode.Full;return this._webMethodMgr[this.initWebMethod.name](this.GetArguments(this.initWebMethod,u),function(t){var n=new s.Deserializer(t,u);null!=n.minimalInfo&&(i.inVirtualMode=!0);i.rememberedRecordKeyHash=n.recordKeyHash;i.keyColumnName=n.keyColumnName;i.jsGridParams=n.InitJsGridParams(r);i.jsGridParams.tableCache=i.tableCache=new o.TableCache(i.GetData.bind(i),i.ConvertDataToRecords.bind(i),i._webMethodMgr[i.computeDataRangeWebMethod.name]);i.tableCache.SetConvertAllBlobsToRecords(!0);i.tableCache.SetKeepDataInBlobCache(!1);i.tableCache.SetMaxRecordCount(1e3);i.ProcessNewTableView(n,i.jsGridParams.tableViewParams,!1);e(i.jsGridParams,n.additionalParams)},t)};e.prototype.HasColumnName=function(e){return null!=this.recordFactory.gridFieldMap[e]};e.prototype.AddColumn=function(e){this.recordFactory.gridFieldMap[e.key]=e;var t={},n=this.tableCache.GetView(),r=function(){return{isProp:!0,prop:u.PropertyType.Property.prototype.MakeProperty(void 0,void 0,e.hasDataValue,e.hasLocalizedValue,e.GetPropType())}};for(var i in n)t[n[i]]=r();this.tableCache.AddColumn(e.key,t,r)};e.prototype.ProcessNewTableView=function(e,t,n){n&&e.InitJsGridTableViewParams(t);this.keyColumnName!=e.keyColumnName&&(this.keyColumnName=e.keyColumnName);this.recordFactory=new u.PropertyType.RecordFactory(e.gridFieldMap,this.keyColumnName);this.ProcessNewRowView(e,t.rowViewParams)};e.prototype.ProcessNewRowView=function(e,t){null!=this.groupingRecords&&this.tableCache.ClearRecords(this.groupingRecords);this.tableCache.AddRawDataToCache(r.JsGridUtil.Internal.ConvertSetKeysToArray(e.data),e.data);this.groupingRecords=e.viewDependentKeys;e.InitCellStyles(this.jsGridParams.styleManager);this._fnUpdateDisplayAndEditControls()};e.prototype.GetArguments=function(e,t,n,r){var i=e.fnGenerateArgs(t),s=null==i.gridSerializerArgs?{}:i.gridSerializerArgs;this.inVirtualMode?null==s.PagingInfo&&(s.PagingInfo=null!=r?{pos:r[0].pos,count:r[0].count}:{pos:0,count:100}):null==s.PagingInfo&&(s.PagingInfo=null!=r?this.GenerateRangeStrings(r):["FirstVisible:100"]);s.RequestType=t;null!=this.rememberedRecordKeyHash&&(s.RememberedRecordKeyHash=this.rememberedRecordKeyHash);null!=n&&(s.AutoFilterColumnKeys=n);i.gridSerializerArgs=s;return i};e.prototype.ConvertDataToRecords=function(e,t){var n={};for(var r in t)if(t[r]in e){var i=e[t[r]];n[t[r]]=this.recordFactory.MakeRecord(i.data,i.localized)}return n};e.prototype.GetData=function(e,t){var i=this;return this._webMethodMgr[this.populatingWebMethod.name](this.GetArguments(this.populatingWebMethod,n.JsGridConstants.DeserializationMode.Slice,null,e),function(o){var u=new s.Deserializer(o,n.JsGridConstants.DeserializationMode.Slice,i.keyColumnName);i.rememberedRecordKeyHash=u.recordKeyHash;if(u.recordKeyOrderChanged){var a=(u=new s.Deserializer(o,n.JsGridConstants.DeserializationMode.RowView,i.keyColumnName)).InitJsGridRowViewParams();i.ProcessNewRowView(u,a);null!=i._fnRefreshRowViewCallback&&i._fnRefreshRowViewCallback(a,u.additionalParams)}else null==u.minimalInfo&&null!=u.viewDependentKeys&&(i.groupingRecords=null==i.groupingRecords?u.viewDependentKeys:i.groupingRecords.concat(u.viewDependentKeys));var f=r.JsGridUtil.Internal.ConvertSetKeysToArray(u.data);if(i.inVirtualMode)for(var l=0;l<f.length;l++){var c=i.tableCache.RecordIdxToKey(e[0].pos+l);i._jsGridControl.ChangeKeys(c,f[l])}t([{data:u.data,keys:f}])},function(){t(null)})};e.prototype.GenerateRangeStrings=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].pos+","+e[n].count);return t};return e})();t.SharePointDataSource=a});
define("aQt",["require","exports","f","B8","Cs","oJ"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WaitingDialog=function(e){var t=e.title,o=e.prompt;return n.createElement(r.Dialog,{hidden:!1,title:t,maxWidth:e.maxWidth},n.createElement(i.Label,null,o),n.createElement(r.DialogFooter,null,n.createElement(s.Spinner,{size:s.SpinnerSize.large})))}});
define("aPO",["require","exports","aQo","aPN","aPM","bt"],function(require,exports,gridutil_1,core_1,init_1,Killswitch_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var reconcileQstringFiltersKillSwitchIsActive=Killswitch_1.Killswitch.isActivated("B05B33FA-F6BB-43C4-9503-F2BD4EF272A6","4/23/2020","Use existing reconcileQstringFilters function in JsGridUtil rather then rely on a global variable"),focusAcc,SPListOperationType;function global_inplview(){"undefined"==typeof g_all_modules&&(g_all_modules={});g_all_modules["inplview.js"]={version:{rmj:16,rmm:0,rup:19430,rpr:12013}};"function"==typeof spWriteProfilerMark&&spWriteProfilerMark("perfMarkBegin_inplview.js");window.g_SPGridInitInfo={};ServerData.prototype.GetValue=function(e){};ServerData.prototype.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",SPRequestDuration:"SPRequestDuration",SPIisLatency:"SPIisLatency"};CLVP_InitializePrototype();FocusInfo_InitializePrototype();focusAcc=null;SPListOperationType={Default:0,Sort:1,PagingRight:2,PagingLeft:3};exports.inplview={CLVPFromCtx:CLVPFromCtx,InitAllClvps:InitAllClvps,DeleteSelectedItemsCore:DeleteSelectedItemsCore};ListModule.Settings.SupportsInplHash&&init_1.AjaxNavAddNavigate(RestoreAllClvpsNavigation);InitAllClvps();"undefined"!=typeof Sys&&null!=Sys&&void 0!==Sys.Application&&null!=Sys.Application&&"function"==typeof Sys.Application.notifyScriptLoaded&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("inplview.js");"function"==typeof spWriteProfilerMark&&spWriteProfilerMark("perfMarkEnd_inplview.js")}exports.global_inplview=global_inplview;function SPGridMakeInplviewRequest(e,t,n,r,i,s,o){var u=new XMLHttpRequest,a=[];a.push(SP.Utilities.Utility.getLayoutsPageUrl("inplview.aspx"));a.push("?Cmd=");a.push(e);a.push("&List=");a.push(t);a.push("&View=");a.push(n);a.push("&IsXslView=TRUE&Grid=True");if(Boolean(r)){a.push("&");a.push(r)}else{if(i){a.push("&SortField=");a.push(escapeProperly(i.sortField));a.push("&SortDir=");a.push(i.isDescending?"Desc":"Asc")}Boolean(s)&&a.push(s)}u.open("POST",a.join(""),!0);u.onreadystatechange=o(u);u.send(null)}function SPGridFetchSchema(e,t,n){window.g_SPGridInitInfo[t].stale=!0;SPGridMakeInplviewRequest("Schema",e,t,null,null,null,function(e){return function(){if(4==e.readyState&&!init_1.IsXhrAborted(e)){try{e.onreadystatechange=null}catch(e){}var t=e.responseText;if(601==e.status)throw t;var r=JSON.parse(t);n(r)}}})}exports.SPGridFetchSchema=SPGridFetchSchema;function ExitGrid(e,t,n,r){var i=window.g_SPGridInitInfo[e],s=GetCtxFromView(e),o=window[i.controllerId],u=o.GetCLVPQString(),a=o.GetUnfilteredHierarchyMap();o.TryDispose(function(e){if(null==window.OffSwitch||OffSwitch.IsActive("7265707D-3E1D-4281-8FF2-B3AB155897ED")||!PageMinimized()||r){i.initialized=!1;s.inGridMode=!1;s.leavingGridMode=!0;var o=null;if(null!=e&&e.markGridSerializerAsStale)i.stale=!0;else if(null!=a){var f=[{Key:0}],l={0:0},c=function(e){for(var t=0;t<e.length;t++){var n=e[t],r={};r.Key=Number(n);if(null!=a[n].parentKey){var i=l[a[n].parentKey];Sys.Debug.assert(null!=i);r.Parent=i}null!=a[n].tag&&(r.Tag=a[n].tag);Sys.Debug.assert(null==l[n]);l[n]=f.length;f.push(r);null!=a[n].childKeys&&c(a[n].childKeys)}};c(a[0].childKeys);o=f}window[i.controllerId]=null;i.unfilteredHierarchyInfo=o;var h=document.getElementById("js-listviewthead-"+s.wpq);null!=h&&(h.style.display="");var p=document.getElementById("agg"+s.wpq);null!=p&&(p.style.display="");t||s.clvp.RefreshPaging(u.toString());null!=n&&n()}else parent.postMessage("ExitGrid","*")})}function ServerData(){}function ServerConnection(){var e=null,t=null;this.abort=function(){if(null!=e){e.isCancelled;e.abort();e=null}if(null!=t){t.Abort();t=null}};this.isRequestActive=function(){return Boolean(e)||Boolean(t)};this.getServerData=function(s,o,u,a,f,l){var c=s();return ListModule.Settings.SupportsDatapipes&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(216)?(function(e,n,s,o){var u=new r(e,n,s),a=new i(e,o),f="";"undefined"!=typeof MSOWebPartPageFormName&&(f=document.forms[MSOWebPartPageFormName].__REQUESTDIGEST.value);var l=new SPTouchData.DatapipeFactoryParameters("",f,"/"),c=new SPTouchData.DatapipeFactory(l).GetDatapipe(SPTouchData.DatapipeType.ObjectDatapipe);c.Initialize(a);c.SetCallbackObj(u);var h=c.CreateSession();h.GetData();t=h;return})(c,o,u,f):(function(t,r,i,s,o,u){var a=new s;a.open("POST",t,!0);u?a.setRequestHeader("Content-Type","application/json;odata=verbose"):a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");u&&("undefined"!=typeof MSOWebPartPageFormName?a.setRequestHeader("x-requestdigest",document.forms[MSOWebPartPageFormName].__REQUESTDIGEST.value):"string"==typeof pageDigest&&a.setRequestHeader("x-requestdigest",pageDigest));a.onreadystatechange=function(){n(a,t,r,i)};e=a;a.send(o);return})(c,o,u,a,f,l)};var n=function(e,t,n,r){if(4==e.readyState){this._currentXhrRequest=null;if(!init_1.IsXhrAborted(e)&&(void 0===e.isCancelled||1!=e.isCancelled)){var i=new ServerData;i.GetValue=function(n){var r=void 0,s=i;switch(n){case s.DataValueKeys.SourceURL:r=t;break;case s.DataValueKeys.CorrelationId:r=e.getResponseHeader("SPRequestGuid");break;case s.DataValueKeys.Status:try{r=e.status}catch(e){}break;case s.DataValueKeys.AuthenticationRedirect:r=e.getResponseHeader("X-Forms_Based_Auth_Required");break;case s.DataValueKeys.ResponseText:r=e.responseText;break;case s.DataValueKeys.SPRequestDuration:r=e.getResponseHeader(s.DataValueKeys.SPRequestDuration);break;case s.DataValueKeys.SPIisLatency:r=e.getResponseHeader(s.DataValueKeys.SPIisLatency)}return r};200===e.status?n(i):r(i);try{e.onreadystatechange=null}catch(e){}}}};function r(e,n,r){this.OnDataAvailable=function(r){t=null;var i=new ServerData;i.GetValue=function(t){var n=void 0,s=i;switch(t){case s.DataValueKeys.SourceURL:n=e;break;case s.DataValueKeys.CorrelationId:n=void 0;break;case s.DataValueKeys.Status:n=200;break;case s.DataValueKeys.AuthenticationRedirect:n=void 0;break;case s.DataValueKeys.ResponseText:n=r.GetValue("json")}return n};n(i)};this.OnDataError=function(e){t=null;var n=new ServerData;n.GetValue=function(t){var r=void 0,i=n;switch(t){case i.DataValueKeys.SourceURL:r=e.Url;break;case i.DataValueKeys.CorrelationId:r=e.ServerCorrelationId;break;case i.DataValueKeys.Status:r=e.XHRResponseStatus;break;case i.DataValueKeys.AuthenticationRedirect:r=void 0;break;case i.DataValueKeys.ResponseText:r=e.ErrorMessage}return r};r(n)};this.OnPreAuthenticationRedirect=function(){return!1}}function i(e,t){this.RestUrl=e;this.MakeData=function(e){return new s(e)};this.AdditionalHeaders={};this.HttpMethod="POST";this.IsWrite=!1;this.PostBody=t}function s(e){this.GetValue=function(t){var n;"json"==t&&(n=JSON.stringify(e));return n}}}function SharePointListRestUrlBuilder(){var e;this.setHttpRoot=function(t){e=t};var t=!1;this.setUseRest=function(e){t=e};var n=!1;this.setIsClientRendering=function(e){n=e};var r,i,s,o,u=!1;this.setIsEcbInfo=function(e){u=e};this.setListName=function(e){r=e};this.setListUrl=function(e){i=e};this.setView=function(e){s=e};this.setCtxId=function(e){o=e};var a,f,l,c,h=!1;this.setIsXslView=function(e){h=e};this.setOverrideSelectCommand=function(e){a=e};this.setOverrideFilterQstring=function(e){f=e};this.setOverrideScope=function(e){l=e};this.setSearchTerm=function(e){c=e};var p=!1;this.setIsFullListSearch=function(e){p=e};var d,v,m,g=!1;this.setIsRealHttpRoot=function(e){g=e};this.setRootFolder=function(e){d=e};this.setInGridMode=function(e){v=e};this.setCmd=function(e){m=e};var y,b,w,E,S,x=!1;this.setShouldCascadeDeleteWarningMessage=function(e){x=e};this.setWebPartID=function(e){y=e};this.setGroupString=function(e){b=e};this.setPagingParams=function(e){w=e};this.setSortField=function(e){E=e};this.setSortDir=function(e){S=e};var T=!1;this.setIgnoreQString=function(e){T=e};this.buildUrl=function(){var N=new URI(URI_Encoding.escapeUrlForCallback(e)),C=N.getPath();if(t)if(g)N.setPath(C+"/_api/SP.Requestcontext.Current/GetRemoteContext/list/RenderListDataAsStream");else{Boolean(r)?C+="/_api/web/lists/getById('"+r:C+="/_api/web/GetList('"+i;N.setPath(C+"')/RenderListDataAsStream");Boolean(s)&&N.setQueryParameter("View",s)}else{N.setPath(C+"/_layouts/15/inplview.aspx");N.setQueryParameter("List",r);null!=s&&N.setQueryParameter("View",s);N.setQueryParameter("ViewCount",o);h&&N.setQueryParameter("IsXslView","TRUE");n&&N.setQueryParameter("IsCSR","TRUE")}a&&N.setQueryParameter("HasOverrideSelectCommand","TRUE");var k=null;void 0!==f&&(k=f.match(RegExp("OverrideScope=[^&]*")));void 0!==l&&null==k&&N.setQueryParameter("OverrideScope",l);void 0!==f&&M(N,f);if(n){var L=new URI(Nav.ajaxNavigate.get_href(),{disableEncodingDecodingForLegacyCode:!0});N.setQueryParameter("ListViewPageUrl",URI_Encoding.encodeURIComponent(L.getStringWithoutQueryAndFragment(),!1))}void 0!==c&&null!=c&&N.setQueryParameter("InplaceSearchQuery",URI_Encoding.encodeURIComponent(c,!0));p&&N.setQueryParameter("InplaceFullListSearch","true");if(g){M(N,ListModule.Util.makeMountedFolderQueryStrParams(!0,!1))}n&&u&&N.setQueryParameter("IsRibbon","TRUE");Boolean(d)&&N.setQueryParameter("RootFolder",URI_Encoding.encodeURIComponent(d,!0));Boolean(m)&&N.setQueryParameter("Cmd",m);var A=!1;if(Boolean(w))for(var O in w)if("List"!=O&&"View"!=O&&"ID"!=O)if("ShowInGrid"==O){A=!0;N.setQueryParameter("ShowInGrid",Boolean(v)?"True":"False")}else"GroupString"!=O||!Boolean(b)&&""!=b?N.setQueryParameter(O,w[O]):N.setQueryParameter("GroupString",b);Boolean(v)&&!A&&N.setQueryParameter("ShowInGrid","True");Boolean(y)&&N.setQueryParameter("WebPartID",y);x&&N.setQueryParameter("CascDelWarnMessage","1");if(Boolean(b)||""==b){w.hasOwnProperty("IsGroupRender")||N.setQueryParameter("IsGroupRender","TRUE");N.setQueryParameter("DrillDown","1");w.hasOwnProperty("GroupString")||N.setQueryParameter("GroupString",b)}Boolean(E)&&N.setQueryParameter("SortField",E);Boolean(S)&&N.setQueryParameter("SortDir",S);T&&N.setQueryParameter("IgnoreQString","TRUE");return N.getString();function M(e,t){if(Boolean(t))for(var n=t.split("&"),r=0,i=n.length;r<i;r++){var s=n[r].split("=");Boolean(s[0])&&e.setQueryParameter(s[0],s[1])}}}}function CLVP_InitializePrototype(){CLVP.prototype={outstandingServerConnection:void 0,cctx:void 0,ctx:void 0,dsrc:null,fnEcbCallbacks:{},fRestore:!1,inplUrl_deprecated:null,cachedUrlBuilder:null,fRest:!1,isEcbInfo:!1,hasEcbInfo:!1,isInserting:!1,pagingTab:null,queueEcbInfo:[],rgehs:void 0,rgpag:null,rgpaging:null,rootFolder:null,rootFolderGuid:null,strGroupCache:null,strGroupName:null,tBody:null,currentTBody:null,tab:null,trEmpty:null,wpid:null,wpq:null,strHash:"",xmlHttpCtr:window.XMLHttpRequest,CancelAnyOutstandingRequest:CLVPCancelAnyOutstandingRequest,Init:CLVPInit,PagingString:CLVPPagingString,RefreshPagingEx:CLVPRefreshPagingEx,IsServerConnectionRequestActive:CLVPIsServerConnectionRequestActive,FindTab:CLVPFindTab,EnsureChangeContext:CLVPEnsureChangeContext,DeleteItemCore:CLVPDeleteItemCore,ShowErrorDialog:CLVPShowErrorDialog,InplViewUrl:CLVPInplViewUrl}}function CLVP(e){this.ctx=e;e.clvp=this}function CLVPInit(){if(null!=this.FindTab()){this.pagingTab=document.getElementById("bottomPagingCell"+this.wpq.substr(7));if(null!=this.tab&&"ms-emptyView"==this.tab.className){var e=gridutil_1.JsGridUtil.Internal.DomElement.GetInstance().GetAncestorByTag(this.tab,"TR");this.trEmpty=e.nextSibling}null!=this.ctx.rootFolder&&(this.rootFolder=URI.decodeURIComponent(this.ctx.rootFolder));Boolean(this.rootFolder)||(this.rootFolder=Nav.getUrlKeyValue("RootFolder"));0==this.rootFolder.length&&(this.rootFolder=null);var t=this.GetQueryStringFromHash();null===t&&void 0===t||(this.ctx.queryString=t)}}function CLVPFindTab(){var e=1==this.ctx.listBaseType,t=this.ctx.listName+"-"+this.ctx.view,n=DOM.GetElementsByName(t);if(0==n.length&&e){t="onetidDoclibViewTbl0";n=DOM.GetElementsByName(t)}var r,i=null;0!=n.length||e||(n=DOM.GetElementsByName("onetidDoclibViewTbl0"));0==n.length&&(n=DOM.GetElementsByName("onetidDoclibViewTbl"+this.ctx.ctxId));for(r=0;r<n.length;r++){var s=n[r],o=(i=s).getAttribute("view");if(!Boolean(o))for(;null!=i&&("DIV"!=i.tagName||null==(o=i.getAttribute("WebPartID")))&&null!=i.parentNode;)i=i.parentNode;if(null!=i&&null!=o&&1==this.ctx.view.indexOf(o.toUpperCase())){this.tab=s;this.wpq="WebPart"+this.ctx.wpq;break}}if(null==i||null==this.tab)return null;this.tab.clvp=this;return i}function CLVPPagingString(e){if(null==this.rgpaging)return null;var t,n=[],r=!0;for(t in this.rgpaging){var i=!1;if(null==e)i=!0;else for(var s in e)if(0==t.indexOf(s)){i=!0;break}if(i)if(r)r=!1;else{n.push("&");n.push(t);n.push("=");n.push(this.rgpaging[t])}}return n.join("")}function CLVPIsServerConnectionRequestActive(){var e=this.outstandingServerConnection;return Boolean(e)&&e.isRequestActive()}function CLVPRefreshPagingEx(e,t,n,r,i){var s=this;"1"==Nav.getUrlKeyValue("PageFirstRow",!1,e)&&(e=ListModule.Util.removeOnlyPagingArgs(e));var o=new URI(Boolean(i)?i:e,{disableEncodingDecodingForLegacyCode:!0}),u=document.getElementById("GroupByWebPartID"+s.ctx.ctxId),a=null;null!=u&&(a=u.getAttribute("webPartID"));var f=1==s.ctx.HasRelatedCascadeLists&&null==s.ctx.CascadeDeleteWarningMessage,l=null;null!=s.strGroupName&&(l=ListModule.Util.groupStringFromGroupName(s.strGroupName));var c=Nav.getUrlKeyValue("RootFolder",!0,e);s.ctx.startTime=(new Date).getTime();var h,p,d,v,m=o.getQuery();(t||void 0===s.rgpaging||null==s.rgpaging)&&(s.rgpaging=getPagingQueryParams(m));h=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(216)?(function(){var e=Nav.getUrlKeyValue("SortField",!0,window.location.href),t=Nav.getUrlKeyValue("SortDir",!0,window.location.href);s.fRest=ListModule.Settings.SupportsRest&&!s.isEcbInfo;var r=__CreateSharePointListRestUrlBuilder(s);Boolean(s.rgpaging.RootFolder)||r.setRootFolder(c);r.setInGridMode(s.ctx.inGridMode);r.setCmd(n);r.setShouldCascadeDeleteWarningMessage(f);r.setWebPartID(a);r.setGroupString(l);r.setSortField(e);r.setSortDir(t);r.setPagingParams(s.rgpaging);return r})():(p=buildQueryParams(s.rgpaging,n,f,a,l),d=buildServerDataEndpoint(s.InplViewUrl(!0),o,c,p,s.ctx.inGridMode),v={buildUrl:function(){var e=d;v._ignoreQString&&(e=SetUrlKeyValue("IgnoreQString","TRUE",!1,e));null==v._rootFolder&&(e=URI.removeKeyValue("RootFolder",e));return e},setIgnoreQString:function(e){v._ignoreQString=e},_ignoreQString:!1,setRootFolder:function(e){v._rootFolder=e},_rootFolder:""});if(r)return h.buildUrl();var g=new ServerConnection;ListModule.Settings.SupportsPopup&&"undefined"!=typeof ctxFilter&&null==ctxFilter&&MenuHtc_hide&&MenuHtc_hide();var y="",b=!1,w=!1;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(168)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(424)&&null!=window.groupContextData){b=Boolean(s.ctx.hasRootFolder);w=Boolean(s.ctx.mountPointUrl)}if(s.fRest){y="{'parameters': {'__metadata': { 'type': 'SP.RenderListDataParameters' }, 'ViewXml': ''";w&&(y+=", 'RenderOptions': '7'");y+="}}"}else{if(void 0!==s.ctx.overrideSelectCommand){y="&OverrideSelectCommand="+s.ctx.overrideSelectCommand;h.setIgnoreQString(!0)}if(c.length>0){y=y+"&InplRootFolder="+c;h.setRootFolder(null)}}s.ctx.hasRootFolder=!1;s.ctx.mountPointUrl=null;var E=!1;if(s.isEcbInfo){E=!0;s.isEcbInfo=!1;s.hasEcbInfo=!0}var S=s.tBody,x=s.currentTBody;s.tBody=null;s.CancelAnyOutstandingRequest();var T=null;null!=focusAcc&&null!=focusAcc.focusInCLVPTab&&(T=focusAcc);if(!s.ctx.enteringGridMode||s.fRestore){var N={},C=h.buildUrl().indexOf("?"),k=Boolean(s.ctx)&&void 0!==s.ctx.ListTemplateType&&700==s.ctx.ListTemplateType;N.action=h.buildUrl().substr(C+1);WriteStart(k?"OneDriveAjaxStarted":"ListAjaxStarted",N);var L=new Date,A=function(){var e=function(e){var t=e.GetValue(e.DataValueKeys.Status),n=e.GetValue(e.DataValueKeys.ResponseText),r=e.GetValue(e.DataValueKeys.AuthenticationRedirect),i=e.GetValue(e.DataValueKeys.SourceURL);s.OnReadyStateChangeCallback(t,n,i,r,E,x,S,T,c,b,w)};g.getServerData(h.buildUrl,function(t){var n=t.GetValue(t.DataValueKeys.CorrelationId);N.correlationId=n;if("function"==typeof GetRUMWSA){var r=GetRUMWSA();Boolean(r)&&r.SetCorrelationId(n)}var i=Number((new Date).getTime()-L.getTime());WriteSuccess(k?"OneDriveAjaxSuccess":"ListAjaxSuccess",N,0,i);var s=-1,o=-1;try{s=Number(t.GetValue(t.DataValueKeys.SPRequestDuration));o=Number(t.GetValue(t.DataValueKeys.SPIisLatency))}catch(e){}EnsureScriptFunc("sp.core.js","SP.SlapiInternal",function(){var e=PerformanceLogger?PerformanceLogger.GetLogger():null;if(e){e.ResetPerformanceLogger();e.WriteServerCorrelationId(n);e.WritePageTransitionType(0);e.WriteServerSideLatency(s,o);e.CollectW3CPerfTimings()}});e(t)},function(t){var n=t.GetValue(t.DataValueKeys.CorrelationId);N.correlationId=n;var r=Number((new Date).getTime()-L.getTime());WriteFailure(k?"OneDriveAjaxFailure":"ListAjaxFailure",N,0,r);e(t)},s.xmlHttpCtr,y,s.fRest);s.outstandingServerConnection=g};s.ctx.inGridMode&&!s.ctx.enteringGridMode&&!E&&ListModule.Settings.SupportsInPlaceEdit?ExitGrid(s.ctx.view,!0,function(){s.ctx.inGridMode=!0;s.ctx.leavingGridMode=!1;A()},!0):A()}else window.ReRenderListView(s.ctx,h.buildUrl(),null,null)}exports.CLVPRefreshPagingEx=CLVPRefreshPagingEx;function CLVPInplViewUrl(e){var t=this;return Flighting.VariantConfiguration.IsExpFeatureClientEnabled(216)&&!Boolean(e)?(function(){if(null!=t.cachedUrlBuilder){t.cachedUrlBuilder.setIsClientRendering(t.ctx.IsClientRendering);t.cachedUrlBuilder.setIsEcbInfo(t.isEcbInfo)}else{t.fRest=ListModule.Settings.SupportsRest&&!t.isEcbInfo;t.cachedUrlBuilder=__CreateSharePointListRestUrlBuilder(t)}return t.cachedUrlBuilder})():(function(){var e="undefined"!=typeof ctx?ctx:t.ctx,n=ListModule.Settings.SupportsRest&&!t.isEcbInfo,r=void 0!==t.ctx.IsClientRendering&&t.ctx.IsClientRendering,i=t.isEcbInfo;if(null==t.inplUrl_deprecated){var s=new SharePointListRestUrlBuilder;s.setHttpRoot(Boolean(e.RealHttpRoot)?e.RealHttpRoot:e.HttpRoot);s.setUseRest(n);s.setIsClientRendering(r);s.setListName(t.ctx.listName);s.setView(t.ctx.view);s.setCtxId(String(t.ctx.ctxId));s.setIsXslView(void 0!==t.ctx.isXslView&&t.ctx.isXslView);s.setOverrideSelectCommand(void 0!==t.ctx.overrideSelectCommand);s.setOverrideFilterQstring(t.ctx.overrideFilterQstring);s.setOverrideScope(t.ctx.overrideScope);s.setSearchTerm(t.ctx.searchTerm);s.setIsFullListSearch(void 0!==t.ctx.fullListSearch&&null!=t.ctx.fullListSearch&&t.ctx.fullListSearch);s.setIsRealHttpRoot(Boolean(t.ctx.RealHttpRoot));t.inplUrl_deprecated=s.buildUrl();t.fRest=n}return t.inplUrl_deprecated+(r&&i?"&IsRibbon=TRUE":"")})()}function CLVPCancelAnyOutstandingRequest(){if(this.IsServerConnectionRequestActive()){if(this.isEcbInfo){this.isEcbInfo=!1;this.strGroupName=null}this.outstandingServerConnection.abort();this.outstandingServerConnection=void 0}return!1}function CLVPEnsureChangeContext(){null==this.cctx&&(this.cctx=new SP.ClientContext(null))}function CLVPDeleteItemCore(e,t){ListModule.Settings.SupportsItemDelete&&core_1._CLVPDeleteItemCore(this,e,t)}function CLVPShowErrorDialog(e,t){ListModule.Settings.SupportsErrorDlg&&core_1._CLVPShowErrorDialog(this,e,t)}function __CreateSharePointListRestUrlBuilder(e){var t="undefined"!=typeof ctx?ctx:e.ctx,n=void 0!==e.ctx.IsClientRendering&&e.ctx.IsClientRendering,r=e.isEcbInfo,i=new SharePointListRestUrlBuilder;i.setHttpRoot(Boolean(t.RealHttpRoot)?t.RealHttpRoot:t.HttpRoot);i.setUseRest(e.fRest);i.setIsClientRendering(n);i.setIsEcbInfo(r);i.setListName(e.ctx.listName);i.setView(e.ctx.view);i.setCtxId(String(e.ctx.ctxId));i.setIsXslView(void 0!==e.ctx.isXslView&&e.ctx.isXslView);i.setOverrideSelectCommand(void 0!==e.ctx.overrideSelectCommand);i.setOverrideFilterQstring(e.ctx.overrideFilterQstring);i.setOverrideScope(e.ctx.overrideScope);i.setSearchTerm(e.ctx.searchTerm);i.setIsFullListSearch(void 0!==e.ctx.fullListSearch&&null!=e.ctx.fullListSearch&&e.ctx.fullListSearch);i.setIsRealHttpRoot(Boolean(e.ctx.RealHttpRoot));return i}function InitCLVPs(){if("undefined"!=typeof g_ViewIdToViewCounterMap){var e;for(e in g_ViewIdToViewCounterMap){var t=window["ctx"+g_ViewIdToViewCounterMap[e]];if(Boolean(t)){new CLVP(t).Init()}}}}function getPagingQueryParams(e){var t=e.split("&"),n=[],r=0;for(r=0;r<t.length;r++){var i=t[r].split("=");"List"!=i[0]&&"View"!=i[0]&&"ID"!=i[0]&&(i.length>1&&(n[i[0]]=i[1]))}return n}function buildQueryParams(e,t,n,r,i){var s,o=[];null!=t&&o.push("&Cmd="+t);n&&o.push("&CascDelWarnMessage=1");for(s in e)if("List"!=s&&"View"!=s&&"ID"!=s){o.push("&");o.push(s);o.push("=");o.push(e[s])}Boolean(r)&&o.push("&WebPartID="+r);null!=i&&o.push("&IsGroupRender=TRUE&DrillDown=1&GroupString="+i);return o.join("")}function buildServerDataEndpoint(e,t,n,r,i){var s,o=new URI(e,{disableEncodingDecodingForLegacyCode:!0}),u=o.getStringWithoutQueryAndFragment(),a=o.getQuery();s=reconcileQstringFiltersKillSwitchIsActive?u+"?"+ListModule.Util.reconcileQstringFilters(a,r):u+"?"+gridutil_1.JsGridUtil.Internal.List_ReconcileQstringFilters(a,r);if(0==Nav.getUrlKeyValue("SortField",!0,s).length){var f=Nav.getUrlKeyValue("SortField",!0,window.location.href);f.length>0&&(s=SetUrlKeyValue("SortField",f,!1,s));var l=Nav.getUrlKeyValue("SortDir",!0,window.location.href);l.length>0&&(s=SetUrlKeyValue("SortDir",l,!1,s))}n.length>0&&0==Nav.getUrlKeyValue("RootFolder",!0,s).length&&(s=SetUrlKeyValue("RootFolder",n,!1,s));var c=Nav.getUrlKeyValue("ShowInGrid",!0,s);"True"!=c||i?"True"!=c&&i&&(s=SetUrlKeyValue("ShowInGrid","True",!0,s)):s=SetUrlKeyValue("ShowInGrid","False",!0,s);return s}function ReRenderListView(e,t,n,r){var i=e.clvp,s=EnableListAnimation(e),o=!1,u=!1;s&&(o=0==e.ListData.Row.length||Boolean(e.ListData.NextHref));var a=e.bNoDelete?n:null;s&&(u=0==e.ListData.Row.length||Boolean(e.ListData.NextHref));var f=s&&u&&!o,l=null;null!=i&&i.fRestore||e.enteringGridMode||e.leavingGridMode||(l=document.getElementById("scriptBody"+e.wpq));ReRenderHeroButton(e);RenderListView(e,e.wpq,l,s,f);FixSortOrderIcon(e,e.ListData,e.ListSchema);FixAggregate(e,e.ListData,e.ListSchema);if(null==i){i=new CLVP(e);e.clvp=i}null==i.tab?i.Init():null==l&&i.FindTab();if(i.fRestore||e.enteringGridMode||e.leavingGridMode){i.fRestore=!1;null!=i.tab&&init_1.CSSUtil.RemoveClass(i.tab,"s4-hide-tr")}if(!Boolean(i.ctx.loadingAsyncData)&&!i.fRestore&&!Boolean(i.ctx.bNoDelete)||i.ctx.enteringGridMode||i.ctx.leavingGridMode||null!=r&&!Boolean(i.ctx.bNoDelete)){var c={},h=i.InplViewUrlHash(t,r);c["InplviewHash"+i.WebPartId()]=h;ListModule.Settings.SupportsInplHash&&AjaxNavUpdate(c);i.strHash=h}i.ctx.bNoDelete=!1;Boolean(i.ctx.loadingAsyncData)&&(i.ctx.loadingAsyncData=!1);if(null==a){ListModule.Util.ctxInitItemState(e);ListModule.Util.clearSelectedItemsDict(e)}null==i.tab||void 0!==i.tab.onmouseover&&null!=i.tab.onmouseover||(i.tab.onmouseover=i.ctx.TableMouseoverHandler);null==e.SelectAllCbx||void 0!==e.SelectAllCbx.onfocus&&null!=e.SelectAllCbx.onfocus||(e.SelectAllCbx.onfocus=e.TableCbxFocusHandler);if(null==a){i.InvalidateEcbInfo();i.ResetSelection();i.SyncPagingTables()}if(ListModule.Settings.SupportsAnimation&&s&&null!=l)AnimateListDelta(e,l.parentNode);else if("undefined"!=typeof ProcessImn&&"undefined"!=typeof imnCount&&"undefined"!=typeof bIMNOnloadAttached){imnCount=0;bIMNOnloadAttached=!1;ProcessImn()}var p=e.qcb;Boolean(p)&&p.Poll();if("function"==typeof i.ctx.onViewReRenderCompleted){var d=i.ctx.onViewReRenderCompleted;i.ctx.onViewReRenderCompleted=null;null!=d&&d(i.ctx)}e.operationType=SPListOperationType.Default;e.leavingGridMode&&(e.leavingGridMode=!1);if(null!=a){e.ListData=MergeListData(a,e.ListData);"function"==typeof scrollManager.ScrollHandler&&scrollManager.ScrollHandler();null!=l&&null!=(l=l.parentNode.lastChild)&&l.setAttribute("url",t)}}exports.ReRenderListView=ReRenderListView;function FixAggregate(e,t,n){if(null!=t&&null!=n){var r=n.Aggregate;if(null!=r&&!n.groupRender&&!e.inGridMode){var i=document.getElementById("aggr"+e.wpq),s="<table>"+RenderAggregate(e,null,t.Row[0],n,null,!0,r)+"</table>",o=document.createElement("div");o.innerHTML=s;var u=o.firstChild.firstChild;i.replaceChild(u.firstChild,i.firstChild)}}}function FixSortOrderIcon(e,t,n){if(null!=e&&null!=t&&null!=n)if(e.IsClientRendering){var r,i,s;if(null!=t.SortField&&null!=(r=document.getElementById("diidSortArrowSpan"+e.ctxId+t.SortField))){var o=r.getElementsByTagName("img")[0];if(null!=o){if("ascending"==t.SortDir){r.className="ms-sortarrowup-iconouter";o.className="ms-sortarrowup-icon";o.alt=window.ListView.Strings.L_viewedit_onetidSortAsc}else{r.className="ms-sortarrowdown-iconouter";o.className="ms-sortarrowdown-icon";o.alt=window.ListView.Strings.L_viewedit_onetidSortDesc}r.style.display=""}}for(var u in n.Field){var a=n.Field[u];if(null==a.GroupField){a.Name!=t.SortField&&null!=(r=document.getElementById("diidSortArrowSpan"+e.ctxId+a.Name))&&(r.style.display="none");if(null!=(s=document.getElementById("diidFilterSpan"+e.ctxId+a.Name))){i=null!=t.FilterFields&&t.FilterFields.indexOf(";"+a.Name+";")>=0;s.style.display=i?"":"none"}}}}else FixSortOrderIcon_NonCSR(e,t,n)}function FixSortOrderIcon_NonCSR(e,t,n){var r="/_layouts/15/images/sort.gif",i="/_layouts/15/images/rsort.gif";if(null!=t&&null!=n){if(null!=t.SortField){var s=document.getElementById("diidSort"+e.ctxId+t.SortField);if(null!=s){var o=s.lastChild;if(null!=o){var u=o.previousSibling;null==u||"IMG"!=u.tagName||u.src.substr(u.src.length-r.length)!=r&&u.src.substr(u.src.length-i.length)!=i||u.parentNode.removeChild(u);var a=document.createElement("IMG");a.border=0;if("ascending"==t.SortDir){a.alt=window.ListView.Strings.L_viewedit_onetidSortAsc;a.src="/_layouts/15/images/sort.gif?rev=47"}else{a.alt=window.ListView.Strings.L_viewedit_onetidSortDesc;a.src="/_layouts/15/images/rsort.gif?rev=47"}if("IMG"!=o.tagName){var f=document.createElement("IMG");f.border=0;f.src="/_layouts/15/images/blank.gif";o=s.appendChild(f)}s.insertBefore(a,o)}}}for(var l in n.Field){var c=n.Field[l];if(null==c.GroupField){s=document.getElementById("diidSort"+e.ctxId+c.Name);c.Name!=t.SortField&&null!=s&&null!=(o=s.lastChild)&&(null==(u=o.previousSibling)||"IMG"!=u.tagName||u.src.substr(u.src.length-r.length)!=r&&u.src.substr(u.src.length-i.length)!=i||u.parentNode.removeChild(u));if(null!=s){var h=s.nextSibling;if(null==h){(h=document.createElement("IMG")).border=0;s.parentNode.appendChild(h)}var p=null!=t.FilterFields&&t.FilterFields.indexOf(";"+c.Name+";")>=0;h.src=p?"/_layouts/15/images/filter.gif":"/_layouts/15/images/blank.gif"}}}}}function AnimateListDelta(e,t){var n=ListModule.Settings.SupportsAnimation&&g_fAnimateListCSR&&IsVisible(t),r=e.ctxId,i=FetchTableBodies(t),s=i.oldbody,o=i.newbody,u=document.getElementById("scriptPaging"+e.wpq);if(null!=s||null!=o){if(e.operationType==SPListOperationType.PagingRight||e.operationType==SPListOperationType.PagingLeft)if(n){new SPAnimationUtility.TableAnimator(t).AnimatePaging(e.operationType==SPListOperationType.PagingRight,u,function(){FixupTable(null,o,u,r)})}else FixupTable(s,o,u,r);else if(Boolean(o)&&n){new SPAnimationUtility.TableAnimator(t).AnimateSort(s,o,function(){FixupTable(null,o,u,r)})}else FixupTable(s,o,u,r);ListModule.Settings.SupportsAnimation&&(g_fAnimateListCSR=!0)}}function IsVisible(e){return!(0==e.offsetWidth||0==e.offsetHeight||"hidden"==e.style.visibility)}function FixupTable(e,t,n,r){var i=Boolean(e)?e.parentNode:t.parentNode;if(null!=i&&"TABLE"==i.nodeName){Boolean(e)&&"TBODY"==e.nodeName&&i.removeChild(e);Boolean(t)&&"TBODY"==t.nodeName&&(t.style.display="");EnsureSelectionHandler(null,i,r)}if("undefined"!=typeof ProcessImn&&"undefined"!=typeof imnCount&&"undefined"!=typeof bIMNOnloadAttached){imnCount=0;bIMNOnloadAttached=!1;ProcessImn()}null!=n&&"none"==n.style.display&&(n.style.display="")}function FetchTableBodies(e){for(var t,n=e.firstChild;null!=n&&"TBODY"!=n.nodeName;)n=n.nextSibling;if(null==n)t=null;else if("none"==n.style.display){t=n;n=null}else t=n.nextSibling;return{oldbody:n,newbody:t}}function FocusInfo_InitializePrototype(){FocusInfo.prototype={elem:null,id:null,tagName:null,focusInCLVPTab:null,fromRibbon:void 0,setActive:void 0}}function FocusInfo(){}function MergeListData(e,t){if(ListModule.Settings.SupportsMQuery)for(var n in t.Row){var r=!1;for(var i in e.Row)if(t.Row[n].ID!=e.Row[i].ID);else{r=!0;m$.extend(e.Row[i],t.Row[n])}r||e.Row.push(t.Row[n])}return e}exports.MergeListData=MergeListData;function EnableListAnimation(e){var t=!1;if(ListModule.Settings.SupportsAnimation){t=SPAnimation.Settings.IsAnimationEnabled()&&gridutil_1.JsGridUtil.Internal.IsNullOrUndefined(e.ListSchema.group1)&&gridutil_1.JsGridUtil.Internal.IsNullOrUndefined(e.ListSchema.group2)&&gridutil_1.JsGridUtil.Internal.IsNullOrUndefined(e.ListSchema.Aggregate)&&e.Templates.Body===RenderBodyTemplate&&(1==e.BaseViewID||101==e.ListTemplateType&&"1"==e.ListSchema.IsDocLib&&50==e.BaseViewID||700==e.ListTemplateType&&(51==e.BaseViewID||52==e.BaseViewID)||Boolean(e.RealHttpRoot)&&51==e.BaseViewID&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Boolean(e.RealHttpRoot)&&56==e.BaseViewID&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&!e.clvp.fRestore&&!e.skipNextAnimation&&!e.bNoDelete&&!e.inGridMode&&!e.leavingGridMode;e.skipNextAnimation=!1}return t}function InitAllClvps(){InitCLVPs()}function DeleteSelectedItemsCore(e,t,n,r,i){ListModule.Settings.SupportsItemDelete&&core_1.deleteSelectedItemsCore(e,t,n,r,i)}function RestoreAllClvpsNavigation(){EnumCLVPs(RestoreClvpNavigation)}function CLVPFromCtx(e,t){Boolean(t)&&EnsureCLVP(e);return void 0!==e.clvp?e.clvp:null}function EnsureCLVP(e){if(void 0===e.clvp){e.clvp=new CLVP(e);e.clvp.Init()}}function CLVPFromEventReal(e){return null==e?null:void 0!==e.currentCtx&&Boolean(e.currentCtx)?CLVPFromCtx(e.currentCtx,!0):"function"==typeof CLVPFromEventToolbar?CLVPFromEventToolbar(e):null}exports.CLVPFromEventReal=CLVPFromEventReal;function EnumCLVPs(callback){var fRet=!1;if("undefined"!=typeof g_ViewIdToViewCounterMap){var vid;for(vid in g_ViewIdToViewCounterMap){var ctxT;eval("ctxT = ctx"+g_ViewIdToViewCounterMap[vid]+";");var clvp=ctxT.clvp;if(null!=clvp){callback(clvp);fRet=!0}}}return fRet}function RestoreClvpNavigation(e){e.RestoreNavigation()}});
define("aPN",["require","exports","aQo","aPP","aPM","di"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.global_core=function(){"undefined"==typeof g_all_modules&&(g_all_modules={});g_all_modules["core.js"]={version:{rmj:16,rmm:0,rup:19511,rpr:12755}};(function(){var e=null,t=null,r=-1;function s(){if(null===e){e=new a;(function(){if(null!=t)return t;var e=(function(){var e=document.getElementById("notificationArea");if(null==e){(e=document.createElement("div")).id="notificationArea";var t=document.getElementById("contentBox");null!=t?t.appendChild(e):document.body.appendChild(e)}e.style.display="none";return(function(e){var t=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div");t.className="ms-trcnoti-border";n.className="ms-fullWidth";r.className="ms-trcnoti-host ms-fullWidth";n.appendChild(r);t.appendChild(n);e.appendChild(t);return{ctr:e,root:t,host:r}})(e)})(),r=e.ctr,i=e.host;t=new l(u.ContainerID.Basic,i,50);var s=function(e){((function(e,t){var r=e.elm,i=e.onclickHandler,s=e.strTooltip,o=e.bNoAnimate;r.className="ms-trcnoti-base";e.bNoAnimate||n.JsGridUtil.Internal.DomElement.GetInstance().SetOpacity(r,0);var u=document.createElement("div");u.className="ms-trcnoti-bg";AttachEvent("click",function(){null!=i&&i();c(r.id,o);return!1},u);var a=document.createElement("div");a.className=t;u.appendChild(a);r.appendChild(u);Boolean(s)&&(r.title=s);r.setAttribute("role","alert");if(Boolean(e.ariaLiveAttribute)&&Boolean(e.container)){var f=e.container.element;Boolean(f)&&f.setAttribute("aria-live",e.ariaLiveAttribute)}return a})(e,"ms-trcnoti-toast")).innerHTML=e.strHtml};t.SetEventHandler(u.EventID.OnHide,function(e){r.style.display="none";e()});t.SetEventHandler(u.EventID.OnShow,function(e){r.setAttribute("aria-live","polite");r.setAttribute("aria-relevant","all");r.style.display="block";e()});t.SetEventHandler(u.EventID.OnDisplayNotification,function(e,t){s(e);var n=e.elm;n.style.top="0px";i.appendChild(n);t()});t.SetEventHandler(u.EventID.OnRemoveNotification,function(e,t){t()})})()}return e}a.prototype={Initialized:!1,Notifications:void 0,Containers:void 0,Initialize:void 0,AddNotification:void 0,AddContainer:void 0,DisposeNotification:void 0,SetExpireTimer:void 0,RetireNotificationInternal:void 0};a.prototype.Initialize=function(){if(!this.Initialized){this.Notifications={};this.Containers={};this.Initialized=!0}};a.prototype.Reset=function(){var e,t;for(t in this.Containers){(e=this.Containers[t]).Dispose();e.UnblockUpdatesInternal()}var n=r;r=-1;window.clearInterval(n)};a.prototype.AddNotification=function(e,t){var n=this.Containers[e];Sys.Debug.assert(null!=n,"[NotificationEngine.AddNotification] : Container ID is invalid ("+String(e)+")");t.container=n;this.Notifications[t.id]=t};a.prototype.AddContainer=function(e){this.Containers[e.id]=e};a.prototype.DisposeNotification=function(e){null!=this.Notifications[e.id]&&delete this.Notifications[e.id]};a.prototype.SetExpireTimer=function(e,t){var n=new Date;e.expires=n.valueOf()+t;-1==r&&(r=window.setInterval(function(){s().RetireNotificationInternal()},750))};a.prototype.RetireNotificationInternal=function(){var e=(new Date).valueOf(),t=!0,n=[];for(var i in this.Notifications){null!=(s=this.Notifications[i]).expires&&(e>s.expires?n.push(s):t=!1)}for(;n.length>0;){var s;(o=(s=n.shift()).container).RemoveNotification(s);o.pendingUpdate=!0}for(var i in this.Containers){var o;(o=this.Containers[i]).items.length>0&&(t=!1);if(Boolean(o.pendingUpdate)){o.Update();delete o.pendingUpdate}}if(t){var u=r;r=-1;window.clearInterval(u)}};f.prototype={id:void 0,elm:void 0,strHtml:void 0,strTooltip:void 0,bSticky:void 0,bIsAdd:void 0,bNoAnimate:void 0,bHidden:void 0,onclickHandler:void 0,container:void 0,extraData:void 0,expires:void 0,ariaLiveAttribute:void 0};f.prototype.Initialize=function(e,t,n,r,o,u,a){var f="notification_"+String(i.getUniqueIndex()),l=document.createElement("span");l.id=f;this.id=f;this.bIsAdd=!0;this.elm=l;this.strHtml=t;this.extraData=u;this.bSticky=n;this.strTooltip=r;this.onclickHandler=o;this.bHidden=!1;this.ariaLiveAttribute=a;s().AddNotification(e,this)};f.prototype.Show=function(e){1==Boolean(e)&&(this.bNoAnimate=!0);this.container.AddNotification(this)};f.prototype.Hide=function(e){1==Boolean(e)&&(this.bNoAnimate=!0);this.container.RemoveNotification(this)};l.prototype={id:void 0,element:void 0,bIsShown:void 0,bIsBlocked:void 0,nDisposalState:void 0,nNotificationLayer:25,notificationDisplayDuration:7e3,nMaxNotifications:20,events:void 0,items:void 0,pending:void 0,blockedUpdates:void 0};l.prototype.Initialize=function(e,t,n,r){this.id=e;this.element=t;this.events=new Array(o);this.bIsShown=!1;this.nNotificationLayer=n;this.bIsBlocked=!1;this.items=[];this.pending=[];this.blockedUpdates=[];this.nDisposalState=0;var i=this;this.items.add=function(e){this.push(e);i.FireEvent(u.EventID.OnNotificationCountChanged)};this.items.remove=function(e){var t,n;for(t=0,n=this.length;t<n;t++)if(e.id==this[t].id){this.splice(t,1);i.FireEvent(u.EventID.OnNotificationCountChanged);return!0}return!1};null!=r&&(this.nMaxNotifications=r);s().AddContainer(this)};l.prototype.Dispose=function(){if(!(this.nDisposalState>0)){this.nDisposalState=1;this.Clear()}};l.prototype.AddNotification=function(e){Sys.Debug.assert(e.container.id==this.id,"[AddNotification] : Notification does not match container! Expected: "+String(this.id)+"; Actual: "+String(e.container.id));var t,n;for(t=0,n=this.items.length;t<n;t++)if(e.id==this.items[t].id)return;if(this.GetCount()<this.nMaxNotifications){e.bHidden=!1;e.elm.style.display=""}else{e.bHidden=!0;e.elm.style.display="none"}this.items.add(e);var r=this,i=function(){Boolean(e.bSticky)||s().SetExpireTimer(e,r.notificationDisplayDuration);r.bIsShown||r.Show();r.FireEvent(u.EventID.OnDisplayNotification,e,function(){r.Update();return!0});r.Update()};this.bIsBlocked&&0===this.nDisposalState?this.pending.push(i):i()};l.prototype.RemoveNotification=function(e){if(!1!==e.bIsAdd){e.bIsAdd=!1;Sys.Debug.assert(e.container.id==this.id,"[RemoveNotification] : Notification does not match container! Expected: "+String(this.id)+"; Actual: "+String(e.container.id));var t,n,r=!1;for(t=0,n=this.pending.length;t<n;t++)if(e.id==this.pending[t].id){this.pending.splice(t,1);r=!0}if(r)this.items.remove(e);else{var i=this,o=function(){i.FireEvent(u.EventID.OnRemoveNotification,e,function(){try{i.items.remove(e);var t=e.elm;i.element.removeChild(t)}catch(e){}s().DisposeNotification(e);i.Update();return!0});i.Update()};this.bIsBlocked&&0===this.nDisposalState?this.pending.push(o):o()}}};l.prototype.ShowAllNotifications=function(){var e,t,n=this.items;for(e=0,t=n.length;e<t;e++){var r=n[e];if(r.bHidden){r.bHidden=!1;r.elm.style.display=""}}};l.prototype.Update=function(){this.element.hasChildNodes()||0!=this.items.length||this.Hide();if(this.bIsShown)for(var e in s().Containers)this.BlockUpdatesInternal(s().Containers[e])};l.prototype.Clear=function(e){for(var t=this.items,n=t.length-1;n>=0;n--){var r=t[n];if(Boolean(r)&&r.bIsAdd){Boolean(e)&&(r.bNoAnimate=!0);this.RemoveNotification(r)}}};l.prototype.GetCount=function(){return this.items.length};l.prototype.GetHiddenCount=function(){var e,t,n=0,r=this.items;for(e=0,t=r.length;e<t;e++){r[e].bHidden&&n++}return n};l.prototype.SetEventHandler=function(e,t){if(null!=this.events[e])throw"Event handler already specified for eventId "+String(e)+". ContainerId: "+String(this.id);this.events[e]=t};l.prototype.FireEvent=function(e){if(e>o)throw"Invalid eventId "+String(e)+". ContainerId: "+String(this.id);if(null!=this.events[e]){var t=this.events[e];Array.prototype.shift.call(arguments);Sys.Debug.assert(arguments.length<=2,"[FireEvent] : Too many arguments passed to callback. Expected <= 2; Actual: "+String(arguments.length));t.apply(null,arguments)}};l.prototype.Show=function(){if(!this.bIsShown){this.bIsShown=!0;var e=this;this.FireEvent(u.EventID.OnShow,function(){e.Update();return!0})}};l.prototype.Hide=function(){if(this.bIsShown){this.bIsShown=!1;for(;this.element.hasChildNodes();)this.element.removeChild(this.element.firstChild);var e=this;this.FireEvent(u.EventID.OnHide,function(){if(0==e.nDisposalState){e.UnblockUpdatesInternal();e.Update()}else if(1==e.nDisposalState){e.nDisposalState=2;e.FireEvent(u.EventID.OnDisposing)}return!0})}};l.prototype.BlockUpdatesInternal=function(e){if(!(e.nNotificationLayer>this.nNotificationLayer||e.id==this.id)){var t,n,r=!1;for(t=0,n=this.blockedUpdates.length;t<n;t++)if(e.id==this.blockedUpdates[t].id){r=!0;break}if(!r){e.bIsBlocked=!0;this.blockedUpdates.push(e)}}};l.prototype.UnblockUpdatesInternal=function(){for(;this.blockedUpdates.length>0;){var e=this.blockedUpdates.shift();e.bIsBlocked=!1;for(;e.pending.length>0;){e.pending.shift()()}e.Update()}};function c(e,t){var n=s().Notifications[e];Boolean(n)&&n.Hide(t)}window.addNotification=function(e,t,n,r,i){var s=new f(u.ContainerID.Basic,e,t,n,r);s.Show(i);return s.id};window.removeNotification=c})()};var o=5,u={ContainerID:{Basic:0,Status:1},EventID:{OnShow:0,OnHide:1,OnDisplayNotification:2,OnRemoveNotification:3,OnNotificationCountChanged:4,OnDisposing:5}};function a(){this.Initialize()}function f(e,t,n,r,i,s,o){this.Initialize(e,t,n,r,i,s,o)}function l(e,t,n,r){this.Initialize(e,t,n,r)}t.deleteSelectedItemsCore=function(e,t,n,i,o){e=(function(e){if(Boolean(e)&&void 0===e.clvp&&void 0!==e.ctxId){var t=window["ctx"+e.ctxId];if(t)return t}return e})(e);var u=t.length,a=e.clvp;a.EnsureChangeContext();var f=null,l=null;if(!((function(e){for(var t in e){var n=e[t];if(Boolean(n)&&void 0!==n.id&&Boolean(n.id)){var r=n.id;if(-1!=r.indexOf(".0.")||-1!=r.indexOf(".1.")||-1!=r.indexOf(".2."))return!0}}return!1})(t)||u<=0)){if(!Boolean(o)){var c="undefined"!=typeof Strings?Strings.STS.L_STSRecycleConfirm_Text:"";Boolean(e.RecycleBinEnabled)&&!e.ExternalDataList||(c="undefined"!=typeof Strings?Strings.STS.L_STSDelConfirm_Text:"");null!=e.overrideDeleteConfirmation&&(c=e.overrideDeleteConfirmation);Boolean(e.HasRelatedCascadeLists)&&null!=e.CascadeDeleteWarningMessage&&(c=e.CascadeDeleteWarningMessage+c);if(Boolean(e.HasRelatedCascadeLists)&&171==e.listTemplate){var h=!1,p=0;if(e.inGridMode){var d=window[g_SPGridInitInfo[e.view].controllerId];Sys.Debug.assert(null!=d);for(p=0;p<u;p++)if(d.IsParent(t[p])){h=!0;break}}else{var v=null!=r.GetClientHierarchyManagerForWebpart?r.GetClientHierarchyManagerForWebpart(e.wpq):null;if(null!=v)for(p=0;p<u;p++)if(v.IsParent(t[p])){h=!0;break}}c=h?"undefined"!=typeof Strings?Strings.STS.L_STSDelConfirmParentTask:"":"undefined"!=typeof Strings?Strings.STS.L_STSDelConfirm_Text:""}var m=(function(e,t){if(Boolean(ctx)&&Boolean(t)&&t.length>0&&Boolean(e)&&Boolean(e.ListData)){var n={},r=e.ListData.Row;if(Boolean(r)){for(var i=0;i<r.length;i++){var s=r[i];IsMountPoint(s)&&(n[s.ID]=s["FileLeafRef.Name"])}var o=null;for(var u in t){var a=t[u];if(Boolean(n[a])){null==o&&(o={});o[a]=n[a]}}return o}}return null})(a.ctx,t);if(Boolean(m)&&1===u){var g=m[t[0]];c=s.format("undefined"!=typeof Strings?Strings.STS.L_RemoveMountPointConfirmation:"",g)}if(!confirm(c))return}if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(a.ctx.RealHttpRoot)){l=new SP.ExceptionHandlingScope(a.cctx).startScope();f=new SP.RemoteWeb(a.cctx,a.ctx.HttpRoot);l.dispose()}for(var y=0;y<u;y++){var b=t[y];a.DeleteItemCore(String(b),f)}a.pendingItems=[];if(u>0){var w="undefined"!=typeof Strings?Strings.STS.L_Notification_Delete:"",E=addNotification(w,!0);a.cctx.executeQueryAsync(function(){if(void 0!==a.rgehs){if(1==a.rgehs.length&&a.rgehs[0].get_serverErrorCode()==SP.ClientErrorCodes.redirect){GoToPage(a.rgehs[0].get_serverErrorValue());return}removeNotification(E);a.ShowErrorDialog(n)}else null!=n&&n()},function(e,t){removeNotification(E);void 0!==a.rgehs&&a.ShowErrorDialog(i)})}}};t._CLVPDeleteItemCore=function(e,t,n){var r=1==e.ctx.listBaseType;e.EnsureChangeContext();var i,s,o=null;void 0===e.rgehs&&(e.rgehs=[]);i=new SP.ExceptionHandlingScope(e.cctx);e.rgehs.push(i);s=i.startScope();e.cctx.get_pendingRequest().set_navigateWhenServerRedirect(!0);var u=null;u=(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(e.ctx.RealHttpRoot)?n.getListById(e.ctx.listName):e.cctx.get_web().get_lists().getById(e.ctx.listName);o=e.ctx.ExternalDataList?u.getItemById(String(t)):u.getItemById(parseInt(t));if(r){o.retrieve("FileLeafRef");i.itmContext=o}Boolean(e.ctx.RecycleBinEnabled)&&!e.ctx.ExternalDataList?o.recycle():o.deleteObject();e.changePending=!0;s.dispose()};t._CLVPShowErrorDialog=function(e,t,n){var r,i=[],s=null,o=!1;function u(e,t,n){var r="s4-dlg-err-itm";if(!t){r="s4-dlg-err-firstitm";n.push(SP.Res.dlgTitleError)}var i=e.get_errorMessage();n.push('<div class="'+r+'">');if(void 0!==e.itmContext)try{n.push('<div class="s4-dlg-err-itmName">');n.push(e.itmContext.get_item("FileLeafRef"));n.push("</div>")}catch(e){n.push("</div>")}n.push('<div class="s4-dlg-err-itmMsg">');n.push(i);n.push("</div>");n.push("</div>")}if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(n)&&n.get_hasException()){u(n,o,i);o=!0}for(r in e.rgehs){var a=e.rgehs[r];if(a.get_hasException()&&(171!=e.ctx.listTemplate||-2147024809!=a.get_serverErrorCode())){u(a,o,i);o=!0}}if(o){i.push("<div class='ms-core-form-bottomButtonBox' id='dlgDivButton'><button id='ms-OKBtnDismissDlg' class='ms-ButtonHeightWidth' onclick='DismissErrDlg(this)'>");i.push(SP.Res.okButtonCaption);i.push("</button></div>")}var f=i.join("");if(f.length>0){var l=document.createElement("DIV");l.className="s4-dlg-err";l.innerHTML=f;var c={html:l,title:"undefined"!=typeof Strings?Strings.STS.L_ErrorDialog_Title:"",dialogReturnValueCallback:t};SP.UI.ModalDialog.showModalDialog(c);s=document.getElementById("ms-OKBtnDismissDlg");Boolean(s)&&s.focus()}else"function"==typeof t&&t();e.rgehs=[]}});
define("aQs",["require","exports","aQo","aPS","aPY","aQq","di","bt"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u.Killswitch.isActivated("8DAECEAF-4AEF-45B5-A606-9A3034CC2124","10/18/2019","Use modern taxonomy editor in quick edit."),f=u.Killswitch.isActivated("7B1ACA6D-A5F4-4412-BE1E-93F3F72B1A4F","3/10/2020","Fix XSS issue in some text columns."),l={ODB:1746},c=(function(){function e(e){this.ID="SPTextMaxLength";this.maxLengthTable=e;f||(this.LocalizedValueToCSRValue=function(e){return null==e?null:n.JsGridUtil.Internal.Encoding_STSHtmlEncode(e.replace(/\n/g,"<br>"))})}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){r=null!=r&&0==r.length?null:r;r=n.JsGridUtil.SPUserValueOnPasteFixup(r);var u=this.maxLengthTable[t];null!=r&&null!=u&&0!==u&&(r=r.substr(0,u));s({isValid:!0,dataValue:r,normalizedLocValue:r})};e.prototype.GetMaxLength=function(e){return this.maxLengthTable[e]};e.prototype.toString=function(){return this.ID};return e})();t.TextMaxLengthPropertyType=c;var h=(function(){function e(){this.ID="SPDateTime"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){n.JsGridUtil.DebugAssert(i);n.JsGridUtil.DebugAssert("string"==typeof r);r=n.JsGridUtil.SPUserValueOnPasteFixup(r);s({isValid:!0,dataValue:n.JsGridUtil.EmptyValue,normalizedLocValue:r.toUpperCase()})};return e})();t.DatePropertyType=h;var p=(function(){function e(){this.ID="SPPercentComplete"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){n.JsGridUtil.DebugAssert(i);s({isValid:!0,dataValue:null,normalizedLocValue:r=n.JsGridUtil.SPUserValueOnPasteFixup(r)})};return e})();t.PercentCompletePropertyType=p;var d=(function(){function e(){this.ID="SPEdit"}e.prototype.GetImageSource=function(e,t){return t&r.JsGridConstants.SPGPermissions.editListItems?n.JsGridUtil.Internal.SiteUrl+"/_layouts/images/edititem.gif":null};e.prototype.DataToLocalized=function(e){return e&r.JsGridConstants.SPGPermissions.editListItems?SP.Res.editColEditable:SP.Res.editColReadOnly};return e})();t.EditPropertyType=d;var v=(function(){function e(e){this.ID="SPUser";this.spGanttControl=e}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){n.JsGridUtil.hasPasteStarted=!1;var u=i?this.LocalizedToData(r):r,a=null!=u&&u!==n.JsGridUtil.EmptyValue&&u!==n.JsGridUtil.InvalidValue&&(Boolean(u.display!==u.email)||Boolean(u.length>1));s({isValid:!0,dataValue:u,normalizedLocValue:i&&!a?r:this.DataToLocalized(u)})};e.prototype.GetPeoplePickerSettings=function(e){return this.spGanttControl.customFieldInfo[e]};e.prototype.SetPeoplePickerDefaultSettings=function(e){this.spGanttControl.customFieldInfo[e]="User,SecGroup,SPGroup;#0;#false"};e.prototype.LocalizedToData=function(e){return this.Deserialize(e)};e.prototype.DataToLocalized=function(e){if(null==e)return null;var t=null;if(void 0===e.length)t=e.display;else{for(var r=[],i=0;i<e.length;i++)r.push(e[i].display);t=n.JsGridUtil.Internal.URI_ConvertMultiColumnValueToString(r,n.JsGridUtil.multiValSeparator,!1)}return t};e.prototype.IsDataEqual=function(e,t){if(null==e||null==t)return e==t;var n=function(e,t){return e.display==t.display&&e.email==t.email},r=!1;if(!e.hasOwnProperty("length")||!t.hasOwnProperty("length"))return n(e,t);if(e.length!==t.length)return!1;for(var i=0;i<e.length&&(r=n(e[i],t[i]));i++);return r};e.prototype.GetCopyValue=function(e,t,r){n.JsGridUtil.lastCopiedValueType_SPUser=!0;return null==t?r:this.Serialize(t)};e.prototype.SetSeparator=function(e){null!=e&&(n.JsGridUtil.multiValSeparator=1==e.length?e+" ":e)};e.prototype.deserializeSingleVal=function(e){var t=e.split(n.JsGridUtil.serializedFieldSeparator);return{display:t[0],email:void 0!==t[1]?t[1]:t[0]}};e.prototype.Deserialize=function(e){if(e==n.JsGridUtil.EmptyValue||""==e)return null;var t=e.split(n.JsGridUtil.multiValSeparator);if(1==t.length)return this.deserializeSingleVal(t[0]);for(var r=[],i=0;i<t.length;i++)r.push(this.deserializeSingleVal(t[i]));return r};e.prototype.svSerialize=function(e){return void 0===e.display||void 0===e.email?o.format("{0}{1}{2}",e.get_lookupValue(),n.JsGridUtil.serializedFieldSeparator,e.get_email()):o.format("{0}{1}{2}",e.display,n.JsGridUtil.serializedFieldSeparator,e.email)};e.prototype.Serialize=function(e){if(null==e)return null;var t=[];if(e.hasOwnProperty("email"))t.push(this.svSerialize(e));else if(e.hasOwnProperty("length"))for(var r=0;r<e.length;r++)null!=e[r].data?t.push(this.svSerialize(e[r].data)):t.push(this.svSerialize(e[r]));return n.JsGridUtil.Internal.URI_ConvertMultiColumnValueToString(t,n.JsGridUtil.multiValSeparator,!1)};return e})();t.UserPropertyType=v;var m=(function(){function e(e,t,n){var r=this;this.GetItems=function(e){r.EnsureEntriesCached(function(){for(var t=[],n=0;n<r._entries.length;n++)t.push(i.PropertyType.Property.prototype.MakeProperty(r._entries[n].id,r._entries[n].locValue,!0,!0,r));e(t)},function(){e(null)})};this.ID=e+"_Lookup";this._lookupFieldInfo=t;this._fileLoadUrl=n}e.prototype.InvalidateCache=function(){this._entries=null};e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){var u=this;this.EnsureEntriesCached(function(){if(!u._lookupFieldInfo.required&&i&&""==r||!i&&null==r)s({isValid:!0,dataValue:[],normalizedLocValue:""});else{var e=n.JsGridUtil.Internal.FindInArray(u._entries,i?function(e){return r==e.locValue}:function(e){return r==e.id});s(null==e?{isValid:!1}:{isValid:!0,dataValue:u._entries[e].id,normalizedLocValue:u._entries[e].locValue})}},o)};e.prototype.EnsureEntriesCached=function(e,t){var n=this;null==this._entries?this.GetFieldValues(this._lookupFieldInfo.webUrl,this._lookupFieldInfo.listId,this._lookupFieldInfo.field,function(r){if(null==r)t();else{n._entries=r;e()}}):e()};e.prototype.GetFieldValues=function(e,t,r,i){var o,u=function(){for(var e=[],t=o.get_count(),s=0;s<t;s++){var u=o.itemAt(s),a=u.get_fieldValues(),f=u.get_fieldValuesAsText().get_fieldValues();n.JsGridUtil.Internal.IsStrNullOrEmpty(f[r])||e.push({id:a.ID,locValue:f[r]})}i(e)},f=function(){i(null)},c=['<View Scope="RecursiveAll">',"<ViewFields>",'<FieldRef Name="ID"/>','<FieldRef Name="'+escape(r)+'"/>',"</ViewFields>",'<Query><OrderBy><FieldRef Name="'+escape(r)+'"/></OrderBy></Query>',"</View>"].join(""),h=function(){var n=new SP.ClientContext(e),i=n.get_web().get_lists().getById(t),s=new SP.CamlQuery;s.set_viewXml(c);var a=(o=i.getItems(s)).retrieveItems();a.retrieve("ID");a.retrieveObject("FieldValuesAsText").retrieve(r);n.add_requestSucceeded(u);n.add_requestFailed(f);n.executeQueryAsync()};if(!a&&n.JsGridUtil.Internal.IsFeatureEnabled(l)){var p=[s.taxonomyLoadCallback],d=[this._fileLoadUrl+"_layouts/15/sp.init.js",this._fileLoadUrl+"_layouts/15/mquery.js",this._fileLoadUrl+"_layouts/15/sp.runtime.js",this._fileLoadUrl+"_layouts/15/sp.js"];s.csomJsFilesLoader._ensureExternalJsFilesLoaded(d,h,p)}else h()};return e})();t.LookupPropertyType=m;var g=(function(){function e(){this.ID="SPMultilineText"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){r=null!=r&&0==r.length?null:r.replace(/<br>/g,"\n");s({isValid:!0,dataValue:r=n.JsGridUtil.SPUserValueOnPasteFixup(r),normalizedLocValue:r})};e.prototype.LocalizedValueToCSRValue=function(e){return null==e?null:n.JsGridUtil.Internal.Encoding_STSHtmlEncode(e.replace(/\n/g,"<br>"))};return e})();t.MultilineTextPropertyType=g;var y=(function(){function e(){this.ID="SPEnhancedRichText"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){r=null!=r&&0==r.length?null:r;s({isValid:!0,dataValue:r=n.JsGridUtil.SPUserValueOnPasteFixup(r),normalizedLocValue:r})};e.prototype.LocalizedValueToCSRValue=function(e){return e};return e})();t.EnhancedRichTextPropertyType=y;var b=(function(){function e(){this.ID="SPImageThumbnail"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){r=null!=r&&0==r.length?null:r;s({isValid:!0,dataValue:r=n.JsGridUtil.SPUserValueOnPasteFixup(r),normalizedLocValue:r})};e.prototype.LocalizedValueToCSRValue=function(e){return e};return e})();t.ImageThumbnailPropertyType=b});
define("aQr",["require","exports","aPS","aQo","aPZ","bt","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o){"use strict";o=o.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var u=s.Killswitch.isActivated("CAF8B57F-023A-49B5-B7B6-A92006D95286","10/11/2019","Fix several issues with items positioned far off to the left causing RTL bugs."),a=s.Killswitch.isActivated("983CF6BF-776A-4753-92FC-1D8F1F1C6DAA","10/17/2019","make quick edit compatible with dark themes"),f=s.Killswitch.isActivated("6BD41586-EA3C-4EDB-B381-53736E836DEA","03/04/2020","Fix when first element in a RTE editor is a <p> tag that collapses margins causing the editor to shift down in relation to the cell."),l={ODB:1725},c=(function(){function e(e){var t=this;this.SupportedWriteMode=n.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=n.JsGridConstants.EditActorReadType.LocalizedOnly;this.id="jsgrid_multilineeditbox";this.OnMouseDown=function(e){e.stopPropagation()};this.OnKeyDown=function(e){if(13!=e.keyCode&&"function"==typeof t.gridContext.OnKeyDown){e.StopInfiniteKeyDownLoop=!0;t.gridContext.OnKeyDown(e)}};this.gridContext=e;this.parentNode=e.parentNode;this.textArea=document.createElement("textarea");this.textArea.id=this.id;this.textArea.className=a?"jsgrid-control-multiline":r.JsGridUtil.Internal.IsFeatureEnabled(l)?o.jsgridControlMultilineTextarea:"jsgrid-control-multiline-quickedit";this.textArea.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;";this.textArea.tabIndex=-1;this.textArea.style.direction=e.RTL.ltr;this.parentNode.appendChild(this.textArea)}e.prototype.SizeToCellOrDefault=function(){var e,t;if(r.JsGridUtil.Internal.IsFeatureEnabled(l)){e=this.cellContext.cellWidth-3;t=this.cellContext.cellHeight-5}else{e=this.cellContext.cellWidth-6;t=this.cellContext.cellHeight-6}this.textArea.style.width=e+"px";this.textArea.style.height=t+"px"};e.prototype.SetupHandlers=function(e){if(e){this.textArea.addEventListener("focus",this.gridContext.OnActivateActor);this.textArea.addEventListener("blur",this.gridContext.OnDeactivateActor);this.textArea.addEventListener("keydown",this.OnKeyDown);this.textArea.addEventListener("mousedown",this.OnMouseDown)}else{this.textArea.removeEventListener("focus",this.gridContext.OnActivateActor);this.textArea.removeEventListener("blur",this.gridContext.OnDeactivateActor);this.textArea.removeEventListener("keydown",this.OnKeyDown);this.textArea.removeEventListener("mousedown",this.OnMouseDown)}};e.prototype.GetCSRFieldValue=function(){var e=this.cellContext.field.key;if(null!=this.cellContext.record.fieldRawDataMap.csrInfo){var t=this.cellContext.record.fieldRawDataMap.csrInfo[e];null!=t&&(t=(t=r.JsGridUtil.Internal.Encoding_STSHtmlDecode(t)).replace(/<br>/g,"\n"));return t}return null};e.prototype.SetCSRFieldValue=function(e){var t=e;null!=e&&(t=(t=r.JsGridUtil.Internal.Encoding_STSHtmlDecode(t)).replace(/\n/g,"<br>"));var n=this.cellContext.field.key;null==this.cellContext.record.fieldRawDataMap.csrInfo&&(this.cellContext.record.fieldRawDataMap.csrInfo={});this.cellContext.record.fieldRawDataMap.csrInfo[n]=t;this.cellContext.SetCurrentValue({localized:e})};e.prototype.Dispose=function(){r.JsGridUtil.ClearEventListeners(this.textArea)};e.prototype.Focus=function(e){var t,i=this;try{this.textArea.focus();if(null==e)this.textArea.value=this.textArea.value;else if("mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&e.keyCode==n.JsGridConstants.Key.F2)t=i.GetCSRFieldValue(),i.textArea.value=null==t||t==r.JsGridUtil.EmptyValue?"":t;else if(r.JsGridUtil.Utility.IsChar(e)){this.textArea.value=String.fromCharCode(e.charCode);this.SetCSRFieldValue(this.textArea.value)}}catch(e){r.JsGridUtil.DebugAssert(!1,"Incorrectly trying to focus the MultilineEditControl while hidden?")}};e.prototype.BindToCell=function(e){this.cellContext=e;this.SizeToCellOrDefault();this.cellContext.field.textDirection!==n.JsGridConstants.TextDirection.Default&&(this.textArea.style.direction=this.cellContext.field.textDirection==n.JsGridConstants.TextDirection.RightToLeft?"rtl":"ltr");var t=this.GetCSRFieldValue();this.textArea.value=null==t||t==r.JsGridUtil.EmptyValue?"":t};e.prototype.OnBeginEdit=function(e){var t=this;this.cellContext.Show(this.textArea);this.bInEdit=!0;this.SetupHandlers(!0);"mousedown"==e.type?setTimeout(function(){t.Focus(e)},0):this.Focus(e)};e.prototype.Unbind=function(){this.textArea.value=""};e.prototype.OnEndEdit=function(){this.SetupHandlers(!1);var e=this.GetCSRFieldValue();e=null==e||e==r.JsGridUtil.EmptyValue?"":e;this.textArea.value!==e&&this.SetCSRFieldValue(this.textArea.value);this.cellContext.Hide(this.textArea);this.bInEdit=!1};e.prototype.OnCellMove=function(){this.SizeToCellOrDefault();this.bInEdit&&this.cellContext.Show(this.textArea)};e.prototype.OnValueChanged=function(e){this.textArea.value=null==e.localized||e.localized==r.JsGridUtil.EmptyValue?"":e.localized};return e})();t.MultilinePlainTextEditControl=c;var h=(function(){function e(e,t){var i=this;this.SupportedWriteMode=n.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=n.JsGridConstants.EditActorReadType.LocalizedOnly;this.id="jsgrid_richtexteditbox";this.rteMinHeight=84;this.OnMouseDown=function(e){e.stopPropagation()};this.OnKeyDown=function(e){if(13!=e.keyCode&&"function"==typeof i.gridContext.OnKeyDown){e.StopInfiniteKeyDownLoop=!0;i.gridContext.OnKeyDown(e)}};this.gridContext=e;this.parentNode=e.parentNode;this.outerSpan=document.createElement("span");this.outerSpan.id=this.id;this.outerSpan.className=a?"jsgrid-control-rte":r.JsGridUtil.Internal.IsFeatureEnabled(l)?o.jsgridControlRteContainer:"jsgrid-control-rte-quickedit";this.outerSpan.style.cssText=u?"visibility:hidden;position:absolute;top:-10000px;left:-10000px;":"visibility:hidden;position:absolute;top:-10000px;"+e.RTL.left+":-10000px;";this.outerSpan.tabIndex=-1;this.divRteStateField=document.createElement("div");this.divRteStateField.className="ms-rtestate-field ms-rtefield ms-shadow";this.divRteStateField.style.minWidth="0px";this.divRteStateField.id=this.id+"_topDiv";var s=document.createElement("div");s.id=this.id+"_label";s.style.display="none";this.divRteStateWriteId=this.id="_rte"+(t||"");this.divRteStateWrite=null;this.divRteExtra=document.createElement("div");this.divRteExtra.style.clear="both";this.divRteStateField.appendChild(s);this.divRteStateField.appendChild(this.divRteExtra);this.outerSpan.appendChild(this.divRteStateField);var f=document.createElement("span");this.saveInputId=this.id+"_saveInput";this.saveInput=document.createElement("input");this.saveInput.id=this.saveInputId;this.saveInput.type="hidden";var c=document.createElement("input");c.id="ms-rtefocuselementid";c.name="ms-rtefocuselementid";c.type="hidden";f.appendChild(this.saveInput);f.appendChild(c);this.outerSpan.appendChild(f);this.parentNode.appendChild(this.outerSpan)}e.prototype.SizeToCellOrDefault=function(){var e,t;if(r.JsGridUtil.Internal.IsFeatureEnabled(l)){e=this.cellContext.cellWidth-5+"px";t=this.cellContext.cellHeight+"px"}else{e=this.cellContext.cellWidth-6+"px";t=this.cellContext.cellHeight-6+"px"}this.outerSpan.style.minWidth=e;this.outerSpan.style.minHeight=t;this.divRteStateWrite.style.minWidth=e;this.divRteStateWrite.style.minHeight=t};e.prototype.SetupHandlers=function(e){if(e){this.divRteStateWrite.addEventListener("focus",this.gridContext.OnActivateActor);this.divRteStateWrite.addEventListener("keydown",this.OnKeyDown);this.divRteStateWrite.addEventListener("mousedown",this.OnMouseDown)}else{this.divRteStateWrite.removeEventListener("focus",this.gridContext.OnActivateActor);this.divRteStateWrite.removeEventListener("keydown",this.OnKeyDown);this.divRteStateWrite.removeEventListener("mousedown",this.OnMouseDown)}};e.prototype.GetCSRFieldValue=function(){var e=this.cellContext.field.key;return null!=this.cellContext.record.fieldRawDataMap.csrInfo?this.cellContext.record.fieldRawDataMap.csrInfo[e]:null};e.prototype.SetCSRFieldValue=function(e){var t=this.cellContext.field.key;null==this.cellContext.record.fieldRawDataMap.csrInfo&&(this.cellContext.record.fieldRawDataMap.csrInfo={});this.cellContext.record.fieldRawDataMap.csrInfo[t]=e;this.cellContext.SetCurrentValue({localized:e})};e.prototype.Dispose=function(){r.JsGridUtil.ClearEventListeners(this.divRteStateWrite)};e.prototype.Focus=function(e){var t=this;try{this.divRteStateWrite.focus();if(null==e){RTE.Cursor.get_range().moveToEndOfNode(this.divRteStateWrite);RTE.Cursor.update()}else if("mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&e.keyCode==n.JsGridConstants.Key.F2)(function(){var e=t.GetCSRFieldValue();t.saveInput.value=null==e||e==r.JsGridUtil.EmptyValue?"":e;t.divRteStateWrite.innerHTML=t.saveInput.value;RTE.Cursor.get_range().moveToEndOfNode(t.divRteStateWrite);RTE.Cursor.update()})();else if(r.JsGridUtil.Utility.IsChar(e)){this.divRteStateWrite.innerHTML="";this.saveInput.value=String.fromCharCode(e.charCode);this.SetCSRFieldValue(this.saveInput.value);var i=document.createTextNode(this.saveInput.value);RTE.Cursor.get_range().moveToEndOfNode(this.divRteStateWrite);RTE.Cursor.get_range().insertNode(i);RTE.Cursor.get_range().moveToEndOfNode(this.divRteStateWrite);RTE.Cursor.update()}}catch(e){r.JsGridUtil.DebugAssert(!1,"Incorrectly trying to focus the MultilineEditControl while hidden?")}};e.prototype.BindToCell=function(e){this.cellContext=e;this.RecreateDivRteStateWrite();this.SizeToCellOrDefault();this.cellContext.field.textDirection!==n.JsGridConstants.TextDirection.Default&&(this.divRteStateWrite.style.direction=this.cellContext.field.textDirection==n.JsGridConstants.TextDirection.RightToLeft?"rtl":"ltr");var t=this.GetCSRFieldValue();this.saveInput.value=null==t||t==r.JsGridUtil.EmptyValue?"":t;this.divRteStateWrite.innerHTML=this.saveInput.value};e.prototype.OnBeginEdit=function(e){var t=this;r.JsGridUtil.Internal.IsFeatureEnabled(l)?this.cellContext.Show(this.outerSpan,!0):this.cellContext.Show(this.outerSpan);this.bInEdit=!0;this.SetupHandlers(!0);"mousedown"==e.type?setTimeout(function(){t.Focus(e)},0):this.Focus(e)};e.prototype.Unbind=function(){this.saveInput.value="";this.divRteStateWrite.innerHTML=""};e.prototype.OnEndEdit=function(){this.SetupHandlers(!1);var e=this.GetCSRFieldValue();e=null==e||e==r.JsGridUtil.EmptyValue?"":e;RTE.RichTextEditor.transferContentsToInputField(this.divRteStateWriteId,!1);this.saveInput.value!==e&&this.SetCSRFieldValue(this.saveInput.value);this.cellContext.Hide(this.outerSpan);this.outerSpan.style.top="-10000px";u?this.outerSpan.style.left="-10000px":this.outerSpan.style[this.gridContext.RTL.left]="-10000px";this.bInEdit=!1};e.prototype.OnCellMove=function(){this.SizeToCellOrDefault();this.bInEdit&&(r.JsGridUtil.Internal.IsFeatureEnabled(l)?this.cellContext.Show(this.outerSpan,!0):this.cellContext.Show(this.outerSpan))};e.prototype.OnValueChanged=function(e){this.saveInput.value=null==e.localized||e.localized==r.JsGridUtil.EmptyValue?"":e.localized;this.divRteStateWrite.innerHTML=this.saveInput.value};e.prototype.RecreateDivRteStateWrite=function(){if(null!=this.divRteStateWrite){this.divRteStateField.removeChild(this.divRteStateWrite);this.divRteStateWrite=null}this.divRteStateWrite=document.createElement("div");this.divRteStateWrite.className="ms-rtestate-write ms-rteflags-0 "+(f?"":o.msRteStateField);this.divRteStateWrite.id=this.divRteStateWriteId;this.divRteStateWrite.style.minHeight=this.rteMinHeight+"px";this.divRteStateWrite.setAttribute("aria-labelledby",this.id+"_label");this.divRteStateWrite.setAttribute("contentEditable","true");this.divRteStateWrite.style.direction=this.gridContext.RTL.ltr;this.divRteStateWrite.style.paddingLeft="3px";this.divRteStateWrite.style.paddingRight="3px";this.divRteStateField.appendChild(this.divRteStateWrite);null!=this.divRteStateWrite&&(this.divRteStateWrite.InputFieldId=this.saveInputId);null!=this.saveInput&&""==this.saveInput.value&&(this.saveInput.value=this.divRteStateWrite.innerHTML);RTE.Canvas.fixRegion(this.divRteStateWriteId,!1)};return e})();t.EnhancedRichTextEditControl=h;t.GetEditBoxEditControl=function(e,t){var n=t?i.EditControl.GetHyperlinkEditControl(e):new i.EditControl.EditBoxEditControl(e),r=n.BindToCell;n.BindToCell=function(e){r.call(this,e);var t=this.GetInputElement();"function"==typeof e.propType.GetMaxLength&&t.setAttribute("MaxLength",e.propType.GetMaxLength(e.fieldKey))};var s=n.Unbind;n.Unbind=function(){s.call(this);this.GetInputElement().setAttribute("MaxLength",null)};return n};t.GetPeoplePickerEditControl=function(e){var t=new i.EditControl.PeoplePickerEditControl(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t};t.GetLocationPickerEditControl=function(e){var t=new i.EditControl.LocationPickerEditControl(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t};t.GetTaxonomyPickerEditControl=function(e,t){var n=new i.EditControl.TaxonomyPickerEditControl(e,t),r=n.BindToCell;n.BindToCell=function(e){r.call(this,e)};var s=n.Unbind;n.Unbind=function(){s.call(this)};return n};t.GetHyperlinkEditControl=function(e){var t=new i.EditControl.HyperlinkEditControlV2(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t}});
define("aPR",["require","exports","mU","f","qq","qm","k9","a2","ay","ji","OneDriveLightspeedItemsScopeDeferred_mini_css","X","aQo","bt"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";l=l.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var d=p.Killswitch.isActivated("9F26415E-BD34-4DD5-905E-D4067CB79A3F","3/05/2020","Correctly calculate drop hint element locations when sticky headers are on."),v=[],m={ODB:1757},g={ODB:1725},y=(function(){function e(e){var t=this;this._draggedColumnIndex=-1;this._dropHintDetails={};this._updateDroppingState=function(e,n){t._draggedColumnIndex>=0&&"drop"!==n.type&&(e||t._resetDropHints())};this._onDragOver=function(e,n){if(t._draggedColumnIndex>=0){n.stopPropagation();try{t._computeDropHintToBeShown(n.clientX)}catch(e){if(t._qos){t._qos.end({resultType:c.ResultTypeEnum.Failure,resultCode:"FailToComputeDropHintToShow",error:e.message});t._qos=void 0}}}};this._onDrop=function(e,n){var r=t._columnReorderProps;if(t._draggedColumnIndex>=0&&n){var i=t._draggedColumnIndex>t._currentDropHintIndex?t._currentDropHintIndex:t._currentDropHintIndex-1,s=t._isValidCurrentDropHintIndex();n.stopPropagation();if(s){t._onDropIndexInfo.sourceIndex=t._draggedColumnIndex;t._onDropIndexInfo.targetIndex=i;if(r&&r.onColumnDrop){var o={draggedIndex:t._draggedColumnIndex,targetIndex:i};try{r.onColumnDrop(o);if(t._qos){t._qos.end({resultType:c.ResultTypeEnum.Success});t._qos=void 0}}catch(e){if(t._qos){t._qos.end({resultType:c.ResultTypeEnum.Failure,resultCode:"FailToDropColumn",error:e.message});t._qos=void 0}}}else r&&r.handleColumnReorder&&r.handleColumnReorder(t._draggedColumnIndex,i)}}t._resetDropHints();t._dropHintDetails={};t._draggedColumnIndex=-1};this._updateDragInfo=function(e,n){var r=t._columnReorderProps,i=e.itemIndex;if(i>=0){t._telemetry&&(t._qos=new(t._telemetry(c.Qos))({name:"QuickEditColumnReorder"}));t._draggedColumnIndex=i-1;try{t._getDropHintPositions()}catch(e){if(t._qos){t._qos.end({resultType:c.ResultTypeEnum.Failure,resultCode:"FailToGetDropHintPositions",error:e.message});t._qos=void 0}}r&&r.onColumnDragStart&&r.onColumnDragStart(!0)}else if(n&&t._draggedColumnIndex>=0){t._resetDropHints();t._draggedColumnIndex=-1;t._dropHintDetails={};if(r&&r.onColumnDragEnd){var s=t._isEventOnHeader(n);r.onColumnDragEnd({dropLocation:s},n)}}};this._onColumnDragStart=function(e){t.logEngagement({name:"ColumnDragStart",isIntentional:!0})};this._onColumnDragEnd=function(e,n){var r=t._columnReorderProps,i=s.ColumnDragEndLocation.outside;if(r&&r.onDragEnd){if(e.dropLocation&&e.dropLocation!==s.ColumnDragEndLocation.header)i=e.dropLocation;else if(t._rootElement){var o=t._rootElement.getBoundingClientRect();n.clientX>o.left&&n.clientX<o.right&&n.clientY>o.top&&n.clientY<o.bottom&&(i=s.ColumnDragEndLocation.surface)}r.onDragEnd(i)}};this._onDragEnd=function(e){t.logEngagement({name:"ColumnDragEnd",extraData:{DragEndLocation:s.ColumnDragEndLocation[e]},isIntentional:!0})};this._onColumnDrop=function(e,n){var r=t.getColumns()[n.draggedIndex];if(t.ganttControl){t.ganttControl.MoveColumn({columnInfo:r,dragDropDetails:n,onColumnChangeSucceeded:e.onColumnChangeSucceeded});t.logEngagement({name:"ReorderColumn",isIntentional:!0})}};this._telemetry=e.telemetry;this._baseEngagementData=e.baseEngagementData;this._events=e.events;this._dragDropHelper=new i.DragDropHelper({selection:{getSelection:function(){}}});this._currentDropHintIndex=-1;this._columnReorderProps={frozenColumnCountFromStart:0,frozenColumnCountFromEnd:0,onColumnDragStart:this._onColumnDragStart,onColumnDragEnd:this._onColumnDragEnd,onColumnDrop:this._onColumnDrop.bind(this,e),onDragEnd:this._onDragEnd};this._onDropIndexInfo={sourceIndex:-1,targetIndex:-1}}e.prototype.subscribe=function(){if(this._columnReorderProps)!this._subscriptionObject&&this._dragDropHelper&&this._rootElement&&(this._subscriptionObject=this._dragDropHelper.subscribe(this._rootElement,this._events,this._getHeaderDragDropOptions()));else if(this._subscriptionObject){this._subscriptionObject.dispose();delete this._subscriptionObject}};e.prototype.dispose=function(){if(this._subscriptionObject){this._subscriptionObject.dispose();delete this._subscriptionObject}this._dragDropHelper&&this._dragDropHelper.dispose()};e.prototype.setPaneManager=function(e){this.paneMgr=e;this._rootElement=this.paneMgr.GetGridPane().tableMgr.GetColumnHeaderTr();this.subscribe()};e.prototype.setGanttControl=function(e){this.ganttControl=e};e.prototype.getDragDropHelper=function(){return this._dragDropHelper};e.prototype._getHeaderDragDropOptions=function(){return{selectionIndex:1,context:{data:this,index:0},canDrag:function(){return!1},canDrop:function(){return!0},onDragStart:function(){},updateDropState:this._updateDroppingState,onDrop:this._onDrop,onDragEnd:function(){},onDragOver:this._onDragOver}};e.prototype._isValidCurrentDropHintIndex=function(){return this._currentDropHintIndex>=0};e.prototype._resetDropHints=function(){if(this._currentDropHintIndex>=0){this._updateDropHintElement(this._dropHintDetails[this._currentDropHintIndex].dropHintElementRef,"none");this._currentDropHintIndex=-1}};e.prototype._updateDropHintElement=function(e,t){e.childNodes[1].style.display=t;e.childNodes[0].style.display=t};e.prototype._getDropHintPositions=function(){for(var e,t=this.getColumns(),n=this._columnReorderProps,r=0,i=0,s=n&&n.frozenColumnCountFromStart?n.frozenColumnCountFromStart:0,o=n&&n.frozenColumnCountFromEnd?n.frozenColumnCountFromEnd:0,u=0,a=s;a<t.length-o+1;a++)if(this._rootElement){var f=this._rootElement.querySelectorAll("#columnDropHint_"+a)[0];if(f){var l=f.offsetParent,c=f.offsetLeft+l.offsetLeft;if(a===s){r=c;i=c;e=f}else{!d&&h.JsGridUtil.Internal.IsFeatureEnabled(m)&&l&&l.parentElement&&(c=u+l.parentElement.clientWidth);var p=(c+r)/2;this._dropHintDetails[a-1]={originX:r,startX:i,endX:p,dropHintElementRef:e};i=p;e=f;r=c;a===t.length-o&&(this._dropHintDetails[a]={originX:r,startX:i,endX:c,dropHintElementRef:e})}!d&&h.JsGridUtil.Internal.IsFeatureEnabled(m)&&l&&l.parentElement&&(u+=l.parentElement.clientWidth)}}};e.prototype._liesBetween=function(e,t,n){return o.getRTL()?e<=t&&e>=n:e>=t&&e<=n};e.prototype._isBefore=function(e,t){return o.getRTL()?e>=t:e<=t};e.prototype._isAfter=function(e,t){return o.getRTL()?e<=t:e>=t};e.prototype._computeDropHintToBeShown=function(e){if(this._rootElement){var t=e-this._rootElement.getBoundingClientRect().left,n=this._currentDropHintIndex;if(this._isValidCurrentDropHintIndex()&&this._liesBetween(t,this._dropHintDetails[n].startX,this._dropHintDetails[n].endX))return;var r=this.getColumns(),i=this._columnReorderProps,s=i&&i.frozenColumnCountFromStart?i.frozenColumnCountFromStart:0,o=i&&i.frozenColumnCountFromEnd?i.frozenColumnCountFromEnd:0,u=s,a=r.length-o,f=-1;this._isBefore(t,this._dropHintDetails[u].endX)?f=u:this._isAfter(t,this._dropHintDetails[a].startX)?f=a:this._isValidCurrentDropHintIndex()&&(this._dropHintDetails[n+1]&&this._liesBetween(t,this._dropHintDetails[n+1].startX,this._dropHintDetails[n+1].endX)?f=n+1:this._dropHintDetails[n-1]&&this._liesBetween(t,this._dropHintDetails[n-1].startX,this._dropHintDetails[n-1].endX)&&(f=n-1));if(-1===f)for(var l=s,c=a;l<c;){var h=Math.ceil((c+l)/2);if(this._liesBetween(t,this._dropHintDetails[h].startX,this._dropHintDetails[h].endX)){f=h;break}this._isBefore(t,this._dropHintDetails[h].originX)?c=h:this._isAfter(t,this._dropHintDetails[h].originX)&&(l=h)}if(f===this._draggedColumnIndex||f===this._draggedColumnIndex+1)this._isValidCurrentDropHintIndex()&&this._resetDropHints();else if(n!==f&&f>=0){this._resetDropHints();this._updateDropHintElement(this._dropHintDetails[f].dropHintElementRef,"inline-block");this._currentDropHintIndex=f}}};e.prototype._isEventOnHeader=function(e){if(this._rootElement){var t=this._rootElement.getBoundingClientRect();if(e.clientX>t.left&&e.clientX<t.right&&e.clientY>t.top&&e.clientY<t.bottom)return s.ColumnDragEndLocation.header}};e.prototype.logEngagement=function(e){this._telemetry&&this._telemetry(u.default).logData(n.__assign(n.__assign({},this._baseEngagementData),{component:"SPGrid",name:e.name,extraData:a.graft(this._baseEngagementData.extraData,e.extraData),isIntentional:e.isIntentional}))};e.prototype.getColumns=function(){var e=this.paneMgr.GetColumns(null);e||(e=v);return e};e.prototype.renderDropHint=function(e){var t=h.JsGridUtil.Internal.IsFeatureEnabled(g),n=t?" "+l.containerRefreshed:"",i=t?" "+l.caretRefreshed:"",s=t?" "+l.lineRefreshed:"";return r.createElement("div",{key:"dropHintKey",className:""+l.dropHintStyle+n,id:"columnDropHint_"+e},r.createElement(f.Icon,{key:"dropHintCaretKey","aria-hidden":!0,"data-is-focusable":!1,"data-sizer-index":e,className:""+l.dropHintCaretStyle+i,iconName:"CaretUpSolid8"}),r.createElement("div",{key:"dropHintLineKey","aria-hidden":!0,"data-is-focusable":!1,"data-sizer-index":e,className:""+l.dropHintLineStyle+s}))};return e})();t.ColumnDragDropManager=y});
define("aQ5",["require","exports","mU","f","nK","l1","aQ6","tC","tA","AH","cO","pE","z5"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=u.withItemSetSelection(void 0,{isPrivate:!0})(a.withSelectedItemsContextMenu()(f.ItemSetTilesList)),d=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.itemKey,t=n.__assign({},s.itemSetTilesListControl.pack(v));return r.createElement(l.ControlHandlerProvider,{controlHandlers:t},r.createElement(p,{itemKey:e,selectionMode:c.SelectionMode.multiple,doNotRenderShimmerTile:!0,disableMarqueeSelection:!0,ariaLabel:h.default.pinnedItemRegionLabel,"data-automationid":"PinnedItemsCardList"}))};return t})(r.PureComponent);t.PinnedItemCardListDefer=d;function v(e,t){var n=t.responsiveMode,r=void 0===n?i.ResponsiveMode.xxLarge:n,s=r<=i.ResponsiveMode.xLarge?216:259,u=r<=i.ResponsiveMode.xLarge?180:190;return{tileRenderer:o.PinnedItemCardRenderer,tileControlHandler:function(){return{desiredSize:{width:s,height:u}}},grid:{minRowHeight:u}}}});
define("aQ6",["require","exports","mU","f","N6","vI","AZ","nB","bv","gv","gu","pr","OneDriveLightspeedItemsScopeDeferred_mini_css","i1","yR","po","cL"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";h=h.PinnedItemsCardRenderer_0;Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKey;return r.createElement(u.WithItemCache,null,function(n){var o=n.itemCache,u=o.demandItemFacet(p.friendlyDateModifiedFacet,t),a=!1,f=m.evaluateItemCacheComponent(o,r.createElement(s.ItemActivityField,{itemKey:t,isCompact:!0,hideDate:!0}));if(null===f){a=!0;f=u?r.createElement(d.DateField,{text:u}):r.createElement("div",null)}var l=v.getLifeCycleSignals(o,t,3,!0),h=l&&l.map(function(e){return e.signal}),g=a?f:r.createElement(c.SignalField,{signalsFieldMode:"compact",after:h},f);return r.createElement(i.ItemCard,{key:t,telemetryPrefix:"PinnedItemCardRenderer",itemActivityElement:g,folderCoverElement:e._renderFolderCoverElement(),itemKey:t,cardIndex:e.props.selectionIndex||0,itemSetKey:t,selection:e.props.selection,selectionIndex:e.props.selectionIndex,isSelectable:!0,hideThumbnail:!1,inlineFileIcon:!1})})};t.prototype._renderFolderCoverElement=function(){var e=this,t=this.props.itemKey;return r.createElement(u.WithItemCache,null,function(n){var i=n.itemCache.demandItem({isFolder:a.folderFacet,count:f.countFacet,oneNote:l.oneNoteFacet,isShared:a.isSharedFacet},t),s=i.isFolder,u=i.count,c=i.oneNote,p=i.isShared;if(s&&!c){var d=r.createElement(o.FolderCover,{key:"folder",className:h.folderCover,folderCoverSize:"large",folderCoverType:"default",metadata:u,signal:e._getFolderCoverSignal(p),isFluent:!0}),v=o.getFolderCoverLayout(d).contentSize;return o.renderFolderCoverWithLayout(d,{children:u?r.createElement("span",{className:h.blankFolderCover,style:{width:v.width+"px",height:v.height+"px"}}):null})}return null})};t.prototype._getFolderCoverSignal=function(e){return e?r.createElement(c.SharedSignal,null):null};return t})(r.PureComponent);t.PinnedItemCardRenderer=g});
define("aQ8",["require","exports","mU","iU","e3","aB","i1","al","W4","W2","dc","c9","iV","bv","gH","ds","aQ9","bt","bc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemSyncDialogControlHandler=i.createControlHandler()(function(){return function(t){var i=(function(e){var t;t=e.isMac?"https://go.microsoft.com/fwlink/p/?LinkId=248255":e.isWindows?"https://go.microsoft.com/fwlink/p/?LinkId=248256":"https://go.microsoft.com/fwlink/?LinkID=708540";return t})(new v.PlatformDetection);return function(t,v){var w=this,E=t.demandItemFacet(r.spItemKeyFacet,v.itemKey);if(!E)return{};var S=E&&r.spPageContextKeyFacet.serialize(E),x=t.demandItemFacet(o.spPageContextFacet,S);if(!x)return{};var T=r.spListKeyFacet.serialize(E),N=t.demandItemFacet(o.listFacet,T);if(!N)return{};var C=Number(x.webTemplate)===u.WebTemplateType.mySite,k=new d.SimpleUri(E.webAbsoluteUrl).authority,L=r.spTenantKeyFacet.serialize({tenantRootUrl:k}),A=t.demandItemFacet(p.folderFacet,v.itemKey),O=t.demandItemFacet(o.spDataSourceConfigurationFacet,h.configurationItemKey);return{userLoginName:x.userLoginName,clientDownloadUrl:i,isTenantAdmin:s.createAsyncActionCreator(function(t){return function(t){return n.__awaiter(w,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,new Promise(function(t,n){e(["Db"],t,n)})];case 1:r=n.sent().demandItems;return[4,t(r(function(e){return e.demandItemFacet(o.spTenantAdminFacet,L)}))];case 2:return[2,!!n.sent()];case 3:n.sent();return[2,!1];case 4:return[2]}})})}}),getSyncInfo:s.createAsyncActionCreator(function(t){return function(t){return n.__awaiter(w,void 0,void 0,function(){var r,i,s,o,u,h,p=this;return n.__generator(this,function(d){switch(d.label){case 0:r=new a.SyncDataSource({},{pageContext:x,dataRequestorType:(function(e){n.__extends(t,e);function t(t){return e.call(this,t,{pageContext:x})||this}return t})(l.DataRequestor),getAuthToken:O&&O.ensureAuthToken,apiUrlHelperType:c.ApiUrlHelperBasic});return[4,f.getSyncQueryParams({getUserInfo:function(){return n.__awaiter(p,void 0,void 0,function(){var i,s,o,u,a,f;return n.__generator(this,function(l){switch(l.label){case 0:i=x&&g.getKillSwitch(x).isActivated("8CCCA24D-26C2-4FBD-85EF-734251D8E89A","4/20/2020","Avoid OneDrive lookup for guest users.");s=!i&&(x.isAnonymousGuestUser||x.isExternalGuestUser||x.isEmailAuthenticationGuestUser);if(!C||s)return[3,5];l.label=1;case 1:l.trys.push([1,4,,5]);return[4,new Promise(function(t,n){e(["Db"],t,n)})];case 2:u=l.sent().demandItems;return[4,t(u(function(e){return m.getUserOneDriveUrl(e,{tenantRootUrl:k})}))];case 3:o=l.sent();return[3,5];case 4:a=l.sent();y.default.logError(a);return[3,5];case 5:f=[{}];return[4,r.getSyncUserInfo({webUrl:E.webAbsoluteUrl})];case 6:return[2,n.__assign.apply(void 0,[n.__assign.apply(void 0,f.concat([l.sent()])),{oneDriveWebUrl:o}])]}})})},getWebInfo:function(){return n.__awaiter(p,void 0,void 0,function(){return n.__generator(this,function(e){if(!x.siteId)throw new Error("Unknown siteId for Sync.");if(!x.webId)throw new Error("Unknown webId for Sync.");return[2,{onPrem:!x.isSPO,siteId:x.siteId,webId:x.webId,webLogoUrl:x.webLogoUrl,webTemplateType:Number(x.webTemplate),webTitle:x.webTitle,webUrl:E.webAbsoluteUrl}]})})},getListInfo:function(){return n.__awaiter(p,void 0,void 0,function(){return n.__generator(this,function(e){if(!N.id)throw new Error("Unknown listId for Sync.");if(!N.title)throw new Error("Unknown list title for Sync.");return[2,{listId:N.id,listTemplateType:N.templateType,listTitle:N.title}]})})},getFolderInfo:function(){return n.__awaiter(p,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return A&&E.rootFolder?[4,t(b({itemKey:v.itemKey,spItem:E}))]:[2,void 0];case 1:return[2,e.sent()]}})})}},x)];case 1:i=d.sent();s=!g.getKillSwitch(x).isActivated("7b4719be-2180-47f6-8e5e-af8d3ac9a5e4","08/23/2019","siteSubscriptionID is diff from AADtenantID");o=x&&x.siteSubscriptionId||"";u=x&&x.aadTenantId||"";return s&&o!==u?[4,f.getSyncConfigParams(u,i)]:[3,3];case 2:h=d.sent();return[3,5];case 3:return[4,f.getSyncConfigParams(o,i)];case 4:h=d.sent();d.label=5;case 5:return[2,{protocolUrl:f.getSyncProtocolUrl(i),syncConfigParams:h}]}})})}})}}}});function b(t){var r=this,i=t.itemKey,s=t.spItem;return function(t){return n.__awaiter(r,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["Db"],t,n)})];case 1:r=n.sent().demandItems;return[2,t(r(function(e){var t=e.demandItemFacet(p.fileNameFacet,i),n=t&&t.name,r=e.demandItemFacet(o.uniqueIdFacet,i),u=e.demandItemFacet(o.folderPathFacet,i);if(!r)throw new Error("Unable to determine folderId for Sync.");if(!n)throw new Error("Unable to determine folderName for Sync.");return{folderName:n,folderId:r,folderUrl:""+new d.SimpleUri(s.webAbsoluteUrl).authority+u}}))]}})})}}});
define("aQ9",["require","exports","iU"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getUserOneDriveUrl=function(e,t){var r=t.tenantRootUrl,i=e.demandItemFacet(n.spItemKeyFacet,n.spOneDriveDocumentLibraryKeyFacet.serialize({tenantRootUrl:r}),{suppressGetItems:!1});return i&&i.webAbsoluteUrl}});
define("aRa",["require","exports","mU","f","e3","ak9","alf","bv","yM","Rg","c2"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0});function h(e,t){var n=e.activity,i=e.hoverCardElementsPerUser,o=e.personKeyByEmail;if(n){var u,a=(u=n.type,p[u]);return a?new a({activity:n,canOpenItem:function(){return!1},containingItem:{absolutePath:"",isFolder:!1,name:t,graphItemUrl:""},onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),s=e.user,u=s.email||"",a=i[u],f=o[u];return a?r.cloneElement(a,{displayValue:s.displayName,personKey:f,user:s},n):n},currentUserEmail:"",isSingleLevel:!0,onItemClick:function(){},strings:s.default}):void 0}}var p=((c={})[0]=o.EditItemActivity,c[1]=o.MoveItemActivity,c[2]=o.CommentItemActivity,c[3]=o.CommentResponseItemActivity,c[4]=o.MentionItemActivity,c[5]=o.VersionItemActivity,c[6]=o.RestoreItemActivity,c[9]=o.RenameItemActivity,c[10]=o.DeleteItemActivity,c[11]=o.CreateItemActivity,c[12]=o.ShareItemActivity,c);t.driveItemActivityFieldControlHandler=i.createControlHandler()(function(){return function(){return function(e,t){var r=t.itemKey,i=t.activity,s={},o={};if(l.driveItemKeyFacet.matches(r)){var c=l.driveItemKeyFacet.deserialize(r).endpoint,p=i&&i.actors||[],d=i&&i.action,v=d&&d.mention&&d.mention.mentionees||[],m=d&&d.share&&d.share.recipients||[],g=d&&d.commentResponse&&d.commentResponse.commentAuthor,y=n.__spreadArrays(p,v,m);g&&y.push(g);for(var b=0,w=y;b<w.length;b++){var E=w[b];if(E.email){var S=f.userByEmailKeyFacet.serialize({email:E.email,endpoint:c}),x={itemKey:S,displayValue:E.displayName},T=a.getHoverCardElement(e,x).hoverCardElement;s[E.email]=T;o[E.email]=S}}}var N=e.demandItemFacet(u.fileNameFacet,r);return{itemActivity:i&&N&&h({activity:i,hoverCardElementsPerUser:s,personKeyByEmail:o},N.name)}}}})});
define("aRb",["require","exports","aRD","aRA","aRo","aRn","aRg","aRc","iX","e3","td","sn","vg"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentAddon=a.createAddon(function(){return function(e){e(i.recentAddonDataOnly);e(f.registerControlHandler(n.recentRootItemSetKeyFacet,l.itemSetDetailsListControl)(r.recentRootItemSetDetailsListControlHandler));e(f.registerControlHandler(s.recentRootItemKeyFacet,c.itemsCommandBarControl)(o.recentRootItemCommandBarControlHandler));e(f.registerControlHandler(n.recentRootItemSetKeyFacet,h.itemSetColumnsControl)(u.recentRootItemSetColumnsControlHandler))}})});
define("aRD",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetKeyFacet=new n.KeyFacet("recentRootItemSet",{filters:n.arrayPart(n.stringPart())})});
define("aRA",["require","exports","aRB","pE","e3"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetDetailsListControlHandler=i.createControlHandler()(function(){return function(e){return s}});function s(){return{groupHeaderRenderer:n.RecentGroupItemDetailsHeader,groupProps:{collapseAllVisibility:r.CollapseAllVisibility.hidden}}}});
define("aRB",["require","exports","mU","f","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i){"use strict";i=i.RecentGroupItemDetailsHeader_9;Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?r.createElement("div",{className:i.root},this.props.group.name):null};return t})(r.PureComponent);t.RecentGroupItemDetailsHeader=s});
define("aRo",["require","exports","aRn","aRz","aRD","aRk","aRw","aRu","aRq","iX","iW","e3","gR","aRp"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentAddonDataOnly=f.createAddon(function(){return function(e){e(f.registerOperationHandler(n.recentRootItemKeyFacet,l.getItemsOperation)(u.recentRootItemGetItemsOperationHandler));e(f.registerOperationHandler(i.recentRootItemSetKeyFacet,l.getItemsOperation)(o.recentRootItemSetGetItemsOperationHandler));e(f.registerOperationHandler(r.recentItemKeyFacet,s.changePinStateOperation)(a.recentItemChangePinStateOperationHandler));e(c.registerControlHandler(i.recentRootItemSetKeyFacet,h.filteredItemSetControl)(p.recentRootItemSetFilteredItemSetControlHandler))}})});
define("aRn",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemKeyFacet=new n.KeyFacet("recent",{})});
define("aRz",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentItemKeyFacet=new n.KeyFacet("recentItem",{mru_id:n.stringPart()})});
define("aRk",["require","exports","H","cg"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.changePinStateOperation=new n.Facet("pinItems");t.changePinState=r.implementOperation({operationTypeFacet:t.changePinStateOperation})});
define("aRw",["require","exports","mU","aRv","aRn","aRy","aRz","aRt","aRr","iX","cu","bv","gt","es","gv","gu","N","hS","aRv","iU","aRx","di","fw","DZ","cc","i1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetGetItemsOperationHandler=f.createSingleItemOperationHandler()(function(e){var t=this,f=e.itemKey,x=i.recentRootItemKeyFacet.serialize({});return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me;return n.__generator(this,function(ge){switch(ge.label){case 0:t=e(T.readConfiguration({enableSharePointItemMapping:N.enableSharePointItemMappingConfigurationFacet})).enableSharePointItemMapping,i=void 0===t||t;return[4,e(a.getData({path:"/recent",method:"GET"}))];case 1:k=ge.sent();(L=new g.ItemResolver).resolveItems({items:(he={},he[x]=n.__assign(n.__assign({},l.defaultChildItemSetFacet.pack({itemKey:f})),c.displayNameFacet.pack(y.default.Recent)),he)});A=s.recentGroupKeyFacet.serialize({relativeTime:"today"});O=s.recentGroupKeyFacet.serialize({relativeTime:"yesterday"});M=s.recentGroupKeyFacet.serialize({relativeTime:"thisWeek"});_=s.recentGroupKeyFacet.serialize({relativeTime:"lastWeek"});D=s.recentGroupKeyFacet.serialize({relativeTime:"twoWeeksAgo"});P=s.recentGroupKeyFacet.serialize({relativeTime:"threeWeeksAgo"});H=s.recentGroupKeyFacet.serialize({relativeTime:"lastMonth"});B=s.recentGroupKeyFacet.serialize({relativeTime:"twoMonthsAgo"});j=[];F=[];I=[];q=[];R=[];U=[];z=[];W=[];X="";for(V=0,$=k.documents.items;V<$.length;V++){J=$[V];K=o.recentItemKeyFacet.serialize({mru_id:J.mru_id});Q=J.title,G=J.display_path,Y=void 0===G?[]:G,Z=J.category,ee=J.app,te=J.url,ne=J.type,re=J.time_stamp;ie=new Date(re);switch(w.getRelativeDateBucketByDate(ie)){case w.RelativeDateGroups.today:j.push(K);break;case w.RelativeDateGroups.yesterday:F.push(K);break;case w.RelativeDateGroups.thisWeek:I.push(K);break;case w.RelativeDateGroups.lastWeek:q.push(K);break;case w.RelativeDateGroups.twoWeeksAgo:R.push(K);break;case w.RelativeDateGroups.threeWeeksAgo:U.push(K);break;case w.RelativeDateGroups.lastMonth:z.push(K);break;case w.RelativeDateGroups.twoMonthsAgo:W.push(K);X=w.getMonthString[ie.getMonth()]}se=decodeURIComponent(te);oe={itemFullUrl:se};ue=Q||Y&&Y[Y.length-1]||te||"";ae=C(se),fe=ae.parentItemKey,le=ae.parentItemUrl;L.mapKeys({mappings:(pe={},pe[b.spItemFullUrlKeyFacet.serialize(oe)]=K,pe[b.spItemFullUrlKeyFacet.serialize({itemFullUrl:le})]=fe,pe)});L.resolveItems({items:(de={},de[K]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(ue)),c.fileNameFacet.pack({name:ue,extension:J.extension?""+J.extension:"OneNote"===ee?"one":""})),c.fileSizeFacet.pack(Q?J.file_size:void 0)),c.dateModifiedFacet.pack(new Date(J.time_stamp).getTime())),v.oneNoteFacet.pack("OneNote"===ee?{}:void 0)),i?n.__assign({},m.preferredKeyFacetFacet.pack(b.spItemFullUrlKeyFacet)):{}),b.spItemFullUrlKeyFacet.pack(oe)),c.openUrlFacet.pack(J.url)),u.mruFacet.pack({category:Z,app:ee,url:te,type:ne})),c.canonicalUrlFacet.pack(se)),h.thumbnailFacet.pack(void 0)),c.parentFolderItemFacet.pack({itemKey:fe})),p.getInvalidationFacet().pack()),de[fe]=n.__assign(n.__assign(n.__assign({},c.folderFacet.pack({})),c.canonicalUrlFacet.pack(le)),c.openUrlFacet.pack(le)),de)})}L.resolveItems({items:(ve={},ve[A]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.today)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:j})),ve[O]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.yesterday)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:F})),ve[M]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.thisWeek)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:I})),ve[_]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.lastWeek)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:q})),ve[D]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.twoWeeksAgo)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:R})),ve[P]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.threeWeeksAgo)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:U})),ve[H]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.lastMonth)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:z})),ve[B]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(E.format(r.default.twoMonthsAgo,X))),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:W})),ve)});ce=[];j.length>0&&ce.push(A);O.length>0&&ce.push(O);I.length>0&&ce.push(M);q.length>0&&ce.push(_);R.length>0&&ce.push(D);U.length>0&&ce.push(P);z.length>0&&ce.push(H);W.length>0&&ce.push(B);L.resolveItems({items:(me={},me[f]=n.__assign(n.__assign(n.__assign({},l.childItemsFacet.pack({itemKeys:ce})),p.getInvalidationFacet().forFacet(l.childItemsFacet).thenInvalidate(S.clearCacheIfNotOffline).pack()),l.parentItemFacet.pack({itemKey:x})),me[x]=n.__assign({},p.getInvalidationFacet().forFacet(l.defaultChildItemSetFacet).thenInvalidate(f,l.childItemsFacet).pack()),me)});e(L.execute());return[2]}})})}});function C(e){var t=x.getParentItemUrl(e),n={itemFullUrl:t};return{parentItemUrl:t,parentItemKey:b.spItemFullUrlKeyFacet.serialize(n)}}});
define("aRy",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentGroupKeyFacet=new n.KeyFacet("recentGroup",{relativeTime:n.stringPart()})});
define("aRt",["require","exports","H"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mruFacet=new n.Facet("mru")});
define("aRr",["require","exports","mU","aRs","cc"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(){var e=this;return function(t){return n.__awaiter(e,void 0,void 0,function(){var e,s;return n.__generator(this,function(n){switch(n.label){case 0:e=t(i.readConfiguration({tokenFetcher:r.tokenFetcherConfigurationFacet})).tokenFetcher;return(s=e)?[4,e.getToken("https://officeapps.live.com")]:[3,2];case 1:s=n.sent();n.label=2;case 2:return[2,s]}})})}}t.getAuthToken=s;t.getData=function(e){var t=this,r=e.method,i=e.path,o=e.body;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,a;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(s())];case 1:t=n.sent();u=new Headers;o&&u.set("Content-Type","application/json");t&&u.set("Authorization","Bearer "+t);a={headers:u,credentials:"omit",method:r,mode:"cors",cache:"default",body:o?JSON.stringify(o):void 0};return[4,fetch("https://ocws.officeapps.live.com/ocs/v2"+i,a)];case 2:return[4,n.sent().json()];case 3:return[2,n.sent()]}})})}}});
define("aRs",["require","exports","H"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tokenFetcherConfigurationFacet=new n.Facet("tokenFetcher")});
define("aRx",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.twoMonthsAgo="Two months ago";e.older="Older"})(n=t.RelativeDateGroups||(t.RelativeDateGroups={}));t.getRelativeDateBucketByDate=function(e){var t=new Date;return(function(e,t){return r(t,e)})(e,t)?n.today:(function(e,t){return r(new Date(t.getTime()-864e5),e)})(e,t)?n.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*t.getDay();return e.getTime()>n})(e,t)?n.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*(t.getDay()+7);return e.getTime()>n})(e,t)?n.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n})(e,t)?n.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n})(e,t)?n.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?n.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?n.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?n.twoMonthsAgo:""};function r(e,t){return e.toDateString()===t.toDateString()}t.getMonthString=["January","February","March","April","May","June","July","August","September","October","November","December"]});
define("aRu",["require","exports","mU","aRD","iX","cu","bv","hS","aRv"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemGetItemsOperationHandler=i.createSingleItemOperationHandler()(function(e){var t=this,i=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,f,l;return n.__generator(this,function(c){t=r.recentRootItemSetKeyFacet.serialize({});(f=new u.ItemResolver).resolveItems({items:(l={},l[i]=n.__assign(n.__assign(n.__assign({},s.defaultChildItemSetFacet.pack({itemKey:t})),o.displayNameFacet.pack(a.default.Recent)),o.parentFolderItemFacet.pack(void 0)),l)});e(f.execute());return[2]})})}})});
define("aRq",["require","exports","mU","aRz","aRt","aRl","aRr","iX","cd","es"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentItemChangePinStateOperationHandler=u.createSingleItemOperationHandler()(function(e){var t=this,u=e.itemKey,l=e.options.targetPinState,c=r.recentItemKeyFacet.deserialize(u).mru_id;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,h,p;return n.__generator(this,function(d){switch(d.label){case 0:t=e(a.readItem({mru:i.mruFacet},u));r=t&&t.mru;h=n.__assign({mru_id:c,is_pinned:2===l},r||{});return[4,e(o.getData({path:"/recent",method:"POST",body:h}))];case 1:d.sent();e(f.invalidateItems({items:(p={},p[u]=[s.pinStateFacet],p)}));return[2]}})})}})});
define("aRl",["require","exports","H"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.unpinned=1]="unpinned";e[e.pinned=2]="pinned"})(t.PinState||(t.PinState={}));t.pinStateFacet=new n.Facet("pinState")});
define("aRp",["require","exports","mU","aRD","e3","gP","gQ"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetFilteredItemSetControlHandler=i.createControlHandler()(function(){return function(e){return u}});function u(e,t){var i=t.handlers,u=t.itemKey,a=e.demandItemFacet(r.recentRootItemSetKeyFacet,u);if(i&&a){for(var f=[],l=0,c=i;l<c.length;l++){var h=c[l];if(h.key===o.itemPhotoTypeFilterHandler.key)f.push("photo");else if(h.key===o.itemVideoTypeFilterHandler.key)f.push("video");else if(h.key===o.itemFolderTypeFilterHandler.key)f.push("folder");else if(h.key===o.itemOneNoteFilterHandler.key)f.push("onenote");else if(h.key===o.itemNonPhotoTypeFilterHandler.key)f.push("!photo");else if(h.key===o.itemNonVideoTypeFilterHandler.key)f.push("!video");else if(h.key===o.itemNonFolderTypeFilterHandler.key)f.push("!folder");else if(h.key===o.itemNonOneNoteFilterHandler.key)f.push("!onenote");else{var p=s.getExtensionFilterFromFilterHandler(h);p&&f.push(p)}}return{itemKey:r.recentRootItemSetKeyFacet.serialize(n.__assign(n.__assign({},a),{filters:f}))}}return{}}});
define("aRg",["require","exports","mU","e3","aRm","aRh"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemCommandBarControlHandler=r.createControlHandler()(function(){return function(e){return o}});t.default=t.recentRootItemCommandBarControlHandler;function o(e,t){var r=t.commands;return r?{commands:n.__spreadArrays(r,[i.pinItemsCommand,s.unpinItemsCommand])}:{}}});
define("aRm",["require","exports","f","aRj","aRi","H"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pinItemsCommand={key:new s.Facet("pin").id,name:i.default.pinCommandText,action:n.createElement(r.PinItemsAction,null),iconProps:{iconName:"pin"}}});
define("aRj",["require","exports","mU","aRl","aRk","cL","fa","P","nM","fl","ff"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ChangePinStateAction=s.connectToItemCache(function(e,t){for(var i=t.itemKeys,s=t.targetPinState,o=i.length>0,u=0,a=i;u<a.length;u++){var f=a[u],c=e.demandItem({pinState:r.pinStateFacet},f).pinState;if(!c||c===s){o=!1;break}}return n.__assign({isAvailable:o},l.getItemActionEngagement(e,{itemKey:i[0],engagement:{name:"ChangePinState",isIntentional:!0}}))},function(e,t){var r=t.itemKeys,s=t.targetPinState;return{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var t;return n.__generator(this,function(n){t={targetPinState:s};e(i.changePinState({items:u.makeObject(r,function(){return t})}));return[2]})})}}})(o.Action);t.PinItemsAction=a.injectProps(function(){return{targetPinState:2}})(f.withSelectedItems()(t.ChangePinStateAction));t.UnpinItemsAction=a.injectProps(function(){return{targetPinState:1}})(f.withSelectedItems()(t.ChangePinStateAction))});
define("aRh",["require","exports","f","aRj","aRi","H"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.unpinItemsCommand={key:new s.Facet("unpin").id,name:i.default.unpinCommandText,action:n.createElement(r.UnpinItemsAction,null),iconProps:{iconName:"unpin"}}});
define("aRc",["require","exports","e3","aRf","D4","aRd"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return u}});var o=[r.fileTypeIconColumn,i.nameAndPathColumn,s.dateAccessedColumn];function u(e,t){return{columns:o}}});
define("aRf",["require","exports","mU","pB","H"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileTypeIconColumn=n.__assign(n.__assign({},r.fileTypeIconColumn),{key:new i.Facet("fileTypeIconColumn").id,minWidth:32,maxWidth:32})});
define("aRd",["require","exports","mU","yP","H","aRe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateAccessedColumn=n.__assign(n.__assign({},r.dateModifiedColumn),{name:s.default.lastAccessedColumnHeaderText,key:new i.Facet("dateAccessedColumn").id,minWidth:200})});
define("aRE",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddToQuickLaunchAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.AddToQuickLaunchAction))})});
define("aRF",["require","exports","mU","f","hT","fa","bw","M6","MC","My","mx","sV"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=e("module").id;t.createItemsScopeActionFromKnockout=function(e,t){void 0===t&&(t={});function n(n){return r.createElement(c.WithKnockoutResourceScope,null,r.createElement(p,{createKnockoutAction:e,options:t,actionProps:n}))}return l.default.isActivated("DB243761-5E52-4E84-8204-175D856F50DE","9/4/2019","Always use ItemCache selection shim for actions")?n:o.withChildResources(function(e){e.exposeFactory(a.typeResourceKey,new i.AliasResourceFactory(f.typeResourceKey))},{owner:h})(n)};function p(e){var t=this,i=e.createKnockoutAction,a=e.options,f=e.actionProps,l=a.isToggleable,c=void 0!==l&&l,h=a.isExecutorOnly,p=void 0!==h&&h,d=o.useResourceScope(),v=r.useRef(),m=v.current||(v.current=i(d,f));r.useEffect(function(){return function(){m.dispose()}},[]);var g=u.useObservableValue(!!p||m.isAvailable),y=u.useObservableValue(c?m.isToggled:void 0);return r.createElement(s.ActionBase,{isAvailable:g,onExecute:function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,m.execute(e.event)];case 1:t.sent();return[2]}})})},isToggled:y})}});
define("aRG",["require","exports","mU","aRY","aRX","aRW","aRV","aRU","aRR","aRQ","aRP","aRO","aRN","aRM","aRL","aRK","aRJ","aRI","aRH"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t);n.__exportStar(c,t);n.__exportStar(h,t);n.__exportStar(p,t);n.__exportStar(d,t);n.__exportStar(v,t);n.__exportStar(m,t);n.__exportStar(g,t);n.__exportStar(y,t)});
define("aRY",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AlertAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.AlertAction))(t)})});
define("aRX",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CancelEditAtion=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CancelEditAction))})});
define("aRW",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ComplianceDetailsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ComplianceDetailsAction))})});
define("aRV",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateShortcutAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchCreateShortcutPanel))})});
define("aRU",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditNewMenuAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EditNewMenuAction))({templates:[]})})});
define("aRR",["require","exports","cV","aRF","T4","aRS"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddFlowAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.AddFlowAction))});t.LaunchConfigureFlowsPanelAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchConfigureFlowsPanelAction))});t.ShowExistingFlowsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowExistingFlowsAction))});t.SetUpApprovalFlowAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SetUpApprovalFlowAction))});t.SetUpReminderFlowAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.SetUpReminderFlowAction))({columnName:t.columnName,columnDisplayName:t.columnDisplayName})});t.TriggerFlowAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap),s=t?i.default.getAction(t.flow,r):r.TriggerFlowAction;return new(e.injected(s))({flow:t.flow})});t.TriggerFlowItemAction=s.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap),s=t?i.default.getAction(t.flow,r,!0):r.TriggerFlowByIdAction;return new(e.injected(s))({item:t.item,userInvokedItem:!0,flow:t.flow,noCache:t.noCache})})});
define("aRS",["require","exports","aRF","aRT"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createItemsScopeItemActionFromKnockout=function(e,t){void 0===t&&(t={});var i=n.createItemsScopeActionFromKnockout(e);return r.withKnockoutStoreItem(function(e){return{item:e}})(i)}});
define("aRT",["require","exports","mU","f","cL","M6","mG"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withKnockoutStoreItem=function(e){return function(t){var u=t;return i.connectToItemCache(function(e,t){return{storeItem:e.demandItemFacet(o.knockoutStoreItemFacet,t.itemKey)}})(function(t){var i=t.storeItem,o=s.useObservableValue(i),a=s.useObservable(o);return r.createElement(u,n.__assign({},t,e(a,t)))})}};t.withKnockoutStoreItems=function(){return function(e){var t=e;return i.connectToItemCache(function(e,t){return{items:t.itemKeys.map(function(t){return e.demandItemFacet(o.knockoutStoreItemFacet,t)})}})(t)}}});
define("aRQ",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MakeHomePageAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.MakeHomepageAction))})});
define("aRP",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchFormatViewPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchFormatViewPaneAction))})});
define("aRO",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInPowerBIAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInPowerBIAction))})});
define("aRN",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchQuickEditAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EditAction))})});
define("aRM",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CustomizeFormsNavigationAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CustomizeFormsNavigationAction))});t.LaunchCreateAppViewPanelAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchCreateAppViewPanelAction))});t.SeeAllAppsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SeeAllAppsAction))})});
define("aRL",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TeamChannelAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchTeamChannelAction))})});
define("aRK",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VersionHistoryAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowVersionHistoryAction))})});
define("aRJ",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInSharePointAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInSharePointAction))})});
define("aRI",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditItemAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EditItemAction))})});
define("aRH",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewItemAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ViewItemAction))})});
define("aRZ",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchMoveCopyPanelAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.LaunchMoveCopyPanelAction))({isMove:t.isMove})})});
define("aR0",["require","exports","VS","cV","aRF"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UploadFileAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.UploadAction))({uploadProcessorType:n.UploadProcessorType.Html5file})},{isExecutorOnly:!0});t.UploadFolderAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.UploadAction))({uploadProcessorType:n.UploadProcessorType.Folder})},{isExecutorOnly:!0})});
define("aR1",["require","exports","mU","aRS","cV","Kq","mx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(i.actionMap);n._action=new(n.managed(r.DefaultClickAction))(t);n._item=t.item;return n}t.prototype.onIsAvailable=function(){var e=this.observables.unwrap(this._item);return!(!e||e.isPlaceholder)&&this._action.isAvailable()};t.prototype.onExecute=function(e){return this._action.execute(e)};return t})(s.default);t.DefaultClickAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(i.actionMap),r=o.default.isActivated("9FCD7B65-390C-4C59-9913-FC1D9D8D79E1","9/9/2019","Restore original DefaultClickAction behavior thanks to deferred execution")?u:n.DefaultClickAction;return new(e.injected(r,{injectChildResourceScope:!0}))({item:t.item,userInvokedItem:!0,sourceEngagement:"ItemRow.Click"})})});
define("aR2",["require","exports","aRS","cV"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditItemAction=n.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(r.actionMap);return new(e.injected(n.EditItemAction))({item:t.item,userInvokedItem:!0})})});
define("aR3",["require","exports","aRS","cV"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ExternalNavigateAction=n.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(r.actionMap);return new(e.injected(n.ExternalNavigateAction))({item:t.item})})});
define("aR4",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateClassicColumnAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CreateColumnAction))({fieldType:null})})});
define("aR5",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RenameColumnAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.RenameColumnAction))(t)})});
define("aR6",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchColumnManagementPanelAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.LaunchColumnManagementPanelAction))(t)})});
define("aR7",["require","exports","mU","f","cy","fa","aR8","cL","fm","ex","bw","WN","WQ","WO","iU","i1","iU","cu","aM","dG","a0","fl","If","cd"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=function(e,t,n,s,u){return i.renderComponentOnExecute(function(i){var a=i.resolve;i.reject;return r.createElement(o.ContentTypeManagementPanelContainer,{resolve:a,pageContext:e,views:t,onSuccess:n,getOAuthToken:s,updateViewWithNewColumns:u})})},N=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.onSuccess=function(e){var t=n._columnActionsHelper.getAddOrRemoveFromViewAction(void 0,e);new(n.props.resources.injected(t.action))(t.params).execute(null).done(function(){n._columnActionsHelper.invalidateInfoPaneCache()},function(){});n._isItemsScopeEnabled()&&n.props.resources.consumeAsync(h.resourceKey).then(function(e){e.invalidateCurrentItemSet();e.invalidateCurrentView();e.invalidateAvailableViews();e.invalidateListContentTypes()})};n.getOAuthToken=function(){return n.props.resources.consumeAsync(y.identity.bypass).then(function(e){if(!e.getSharePointToken){n._engagement.logData({name:"LaunchContentTypeManagementPanelAction.ErrorInGettInGettingIdentityDataSource"});return"No IdentityDataSource"}return e.getSharePointToken(b.getServerUrl(n.props.pageContext||{})).then(function(e){return e.accessToken})})};n._isItemsScopeEnabled=t.resources.consume(c.isItemsScopeEnabledResourceKey.lazy);n._columnActionsHelper=t.resources.consume(p.resourceKey);n._engagement=t.resources.consume(w.resourceKey);return n}t.prototype.render=function(){var e=this.props,t=e.pageContext,n=e.contentTypesEnabled,i=e.updateViewWithNewColumns,o=e.views;return t?r.createElement(s.Action,{isAvailable:n,onExecute:T(t,o,this.onSuccess,this.getOAuthToken,i)}):null};return t})(r.PureComponent);t.LaunchContentTypeManagementPanelActionBase=N;t.LaunchContentTypeManagementPanelAction=u.connectToItemCache(function(e){var t=a.getCurrentItemKey(e),n=E.getCurrentItemSetKey(e),r=e.demandItemFacet(d.spItemKeyFacet,t),i=r&&m.spListViewsSetKeyFacet.serialize(r),s=r&&d.spListKeyFacet.serialize(r),o=e.demandItemFacet(v.listFacet,s),u=e.dispatch,l=void 0;if(r){var c={webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl},h=m.spListViewsSetKeyFacet.serialize(c),p=e.demandItemFacet(g.childItemsFacet,h),y=p&&p.itemKeys;l=y&&y.map(function(t){return e.demandItemFacet(v.serverViewFacet,t)})}return{pageContext:f.getPageContextFromItemCache(e,t),contentTypesEnabled:o&&o.contentTypesEnabled,views:l,updateViewWithNewColumns:function(e,r){var s=d.spViewKeyFacet.serialize({viewId:e}),o=u(x.readItem({derivedView:v.currentDerivedViewFacet},s)).derivedView;if(o){o.replaceFields(r);n&&t&&i&&u(S.saveView({itemsScopeItemKey:t,itemSetKey:n,listViewSetKey:i,currentViewKey:s}))}}}})(l.withResources()(N))});
define("aR8",["require","exports","mU","f","a2","aSh","aSb","aSa","aR9"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;i.Engagement.logData({name:"ContentTypeManagementPanel.PanelOpened"});r._state=new s.ContentTypeManagementPanelContainerStateManager({contentTypeManagementPanelContainer:r,strings:n.__assign({},u.default),errorStrings:n.__assign({},a.default)});return r}t.prototype.render=function(){var e=this._state.getRenderProps();return r.createElement(o.ContentTypeManagementPanel,n.__assign({},e))};return t})(r.Component);t.ContentTypeManagementPanelContainer=f;t.default=f});
define("aSh",["require","exports","mU","BU","aSp","aSo","aSl","aSi","Za","Y6","W","Hl"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h;(function(e){e[e.NO_VIEW=0]="NO_VIEW";e[e.DIRTY_VIEW=1]="DIRTY_VIEW";e[e.CLEAN_VIEW=2]="CLEAN_VIEW"})(h||(h={}));var p=(function(){function e(e){var t=this;this._onDismiss=function(){t._params.contentTypeManagementPanelContainer.state.isPanelOpen&&t._params.contentTypeManagementPanelContainer.setState({isPanelOpen:!1});t._params.contentTypeManagementPanelContainer.props.resolve()};this._getSiteContentTypesAvailableForList=function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this.contentTypeProvider.loadContentTypesDetailedAvailableForList()]})})};this._getSiteContentType=function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.contentTypeProvider.loadContentType(e)]})})};this._getListContentTypes=function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this.contentTypeProvider.loadListContentTypesDetailed()]})})};this._getContentTypeColumns=function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.contentTypeProvider.loadContentTypeColumns(e)]})})};this._getListContentTypeColumns=function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.contentTypeProvider.loadListContentTypeColumns(e)]})})};this._addContentTypesToList=function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,i,s,o,u,a,f,p,d,v,m,g,y,b,w,E,S;return n.__generator(this,function(x){switch(x.label){case 0:t=[];r=[];i=[];s=0,o=e;x.label=1;case 1:if(!(s<o.length))return[3,5];b=o[s];t.push(b.id);b.createNewView&&r.push(b);if(!b.addColumnsToCurrentView)return[3,4];if(b.columns)return[3,3];u=b;return[4,this._getContentTypeColumns(b.id)];case 2:u.columns=x.sent();x.label=3;case 3:b.columns.forEach(function(e){return i.push(e.name)});x.label=4;case 4:s++;return[3,1];case 5:a=new l.Qos({name:"ContentTypeManagementPanel.addContentTypesToList"});f=[];x.label=6;case 6:x.trys.push([6,8,,9]);return[4,this.contentTypeProvider.addContentTypesToList(t)];case 7:f=x.sent();a.end({resultType:l.ResultTypeEnum.Success});return[3,9];case 8:p=x.sent();this.handleError(a,p);return[2];case 9:if(!((r=this._updateToListContentTypes(r,f))&&r.length>=0))return[3,20];d=new l.Qos({name:"ContentTypeManagementPanel.CreateNewView"});v=new Map;m={};this._params.contentTypeManagementPanelContainer.props.views&&this._params.contentTypeManagementPanelContainer.props.views.forEach(function(e){v.set(e.Title,e.Id);m[e.Id]=n.__assign(n.__assign({},e),{arrangedColumns:c.parseView(e.ListViewXml).fieldNames})});x.label=10;case 10:x.trys.push([10,19,,20]);g=0,y=r;x.label=11;case 11:if(!(g<y.length))return[3,18];b=y[g];w=b;return[4,this._getListContentTypeColumns(b.id)];case 12:w.columns=x.sent();E=this.getExistingViewInfo(b,v,m);switch(E.status){case h.NO_VIEW:return[3,13];case h.DIRTY_VIEW:return[3,15]}return[3,17];case 13:return[4,this._createContentTypeView(b)];case 14:x.sent();return[3,17];case 15:return[4,this.updateViewWithNewColumns(m[v.get(b.name)],E.newColumnsNeeded)];case 16:x.sent();return[3,17];case 17:g++;return[3,11];case 18:d.end({resultType:l.ResultTypeEnum.Success});return[3,20];case 19:S=x.sent();this.handleError(d,S);return[2];case 20:this._onDismiss();this._params.contentTypeManagementPanelContainer.props.onSuccess&&this._params.contentTypeManagementPanelContainer.props.onSuccess(i);return[2]}})})};this._createContentTypeView=function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.contentTypeProvider.createContentTypeView(e)]})})};this._deleteContentType=function(e){return n.__awaiter(t,void 0,void 0,function(){var t=this;return n.__generator(this,function(n){return[2,this.contentTypeProvider.deleteListContentType(e).then(function(){t._params.contentTypeManagementPanelContainer.props.onSuccess([])})]})})};this._updateToListContentTypes=function(e,t){return t=t.filter(function(t){for(var n=0,r=e;n<r.length;n++){if(r[n].id===t.parentReference.id)return!0}return!1})};this.handleError=function(e,n){e.end({resultType:l.ResultTypeEnum.Failure,error:n});t._params.contentTypeManagementPanelContainer.setState({hasError:!0})};this.getExistingViewInfo=function(e,t,n){if(!t.has(e.name))return{status:h.NO_VIEW};var r=new Set;n[t.get(e.name)].arrangedColumns.forEach(function(e){return r.add(e)});for(var i=[],s=0,o=e.columns;s<o.length;s++){var u=o[s];r.has(u.name)||i.push(u.name)}return i.length>0?{status:h.DIRTY_VIEW,newColumnsNeeded:i}:{status:h.CLEAN_VIEW}};this.updateViewWithNewColumns=function(e,r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(i){if(r&&r.length>0){t=n.__spreadArrays(e.arrangedColumns,r);this._params.contentTypeManagementPanelContainer.props.updateViewWithNewColumns&&this._params.contentTypeManagementPanelContainer.props.updateViewWithNewColumns(e.Id,t)}return[2]})})};this._params=e;var r=this._params.contentTypeManagementPanelContainer.props.pageContext;this.contentTypeProvider=new u.default(new s.default({pageContext:r,oAuthTokenProvider:new a.default({},{oAuthTokenDataSource:new f.default(r)})}),new o.default(r,e.contentTypeManagementPanelContainer.props.getOAuthToken),r);this._params.contentTypeManagementPanelContainer.state={isPanelOpen:!0,hasError:!1}}e.prototype.getRenderProps=function(){var e=this._params.contentTypeManagementPanelContainer.state,t=i.fillInContentTypeManagementPanelStrings(this._params.strings),n=i.fillInContentTypeManagementPanelErrorStrings(this._params.errorStrings);return{panelProps:{type:r.PanelType.custom,isOpen:e.isPanelOpen,customWidth:"70%",onDismiss:this._onDismiss,isLightDismiss:!0,hasCloseButton:!1,onRenderNavigation:function(){return null},styles:{content:{padding:"0px",margin:"0px"}}},strings:t,errorStrings:n,hasErrorOccurred:e.hasError,onDismiss:this._onDismiss,getSiteContentTypes:this._getSiteContentTypesAvailableForList,getSiteContentType:this._getSiteContentType,getListContentTypes:this._getListContentTypes,getContentTypeColumns:this._getContentTypeColumns,getListContentTypeColumns:this._getListContentTypeColumns,addContentTypesToList:this._addContentTypesToList,removeContentType:this._deleteContentType}};return e})();t.ContentTypeManagementPanelContainerStateManager=p});
define("aSp",["require","exports","mU"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MockContentTypeManagementPanelStrings={title:null,closeButtonAriaLabel:null,dropdownNoneLabel:null,dropdownLabel:null,dropdownTitleSelectedLabel:null,addedContentTypes:null,selectedContentTypesColumnKey:null,nameLabel:null,parentLabel:null,descriptionLabel:null,columnsLabel:null,cancelButtonLabel:null,applyButtonLabel:null,addColumnCurrentViewLabel:null,createNewViewLabel:null,defaultSecondaryPanelLabel:null,contentTypeInformationLabel:null,secondaryPanelFieldsListNameDisplayName:null,secondaryPanelFieldsListTypeDisplayName:null,secondaryPanelFieldsListStatusDisplayName:null,secondaryPanelFieldsListSourceDisplayName:null,removeContentTypeButtonLabel:null,loadingContentTypesSpinner:null,applyingContentTypesSpinner:null,tooltipReadonlyCT:null};t.MockContentTypeManagementPanelErrorStrings={cannotRemoveContentType:null,genericErrorMessage:null};t.fillInContentTypeManagementPanelStrings=function(e){var r=n.__assign({},t.MockContentTypeManagementPanelStrings);for(var i in t.MockContentTypeManagementPanelStrings)r[i]=e[i]?e[i]:i;return r};t.fillInContentTypeManagementPanelErrorStrings=function(e){var r=n.__assign({},t.MockContentTypeManagementPanelErrorStrings);for(var i in t.MockContentTypeManagementPanelErrorStrings)r[i]=e&&e[i]?e[i]:i;return r}});
define("aSo",["require","exports","mU","bl","EI"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,{dataSourceName:"GraphContentTypeInfo"},t)||this;n._oAuthTokenProvider=t.oAuthTokenProvider;n._canUseGraph=n._pageContext.isSPO;return n}t.prototype.getSiteIdfromUrl=function(e){var t=this;return this._canUseGraph?this._oAuthTokenProvider.getToken(this._pageContext.msGraphEndpointUrl).then(function(n){return t._getSiteId(n,t._pageContext.msGraphEndpointUrl+e)}).catch(function(){return null}):r.default.resolve(null)};t.prototype._getSiteId=function(e,t){return this.dataRequestor.getData({url:t,authToken:e,qosName:"GetSiteId",method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){return JSON.parse(e).id.split(",")[1]}})};return t})(i.DataSource);t.default=s});
define("aSl",["require","exports","mU","dG","Za","EI","Y6","aSk","aSn","dh","bl","aSm"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h,p;(function(e){e.JSON="application/json";e.octetStream="application/octet-stream";e.multipartBoundary="multipart/related; boundary="})(h||(h={}));(function(e){e.metadata="metadata";e.content="content"})(p||(p={}));var d=(function(e){n.__extends(t,e);function t(t,n){var s=e.call(this,{dataSourceName:"ContentTypeDataSource"},{pageContext:t})||this;s.contentTypeUrlTemplate="{0}/_api/v2.1/sites/{1}/contentTypes";s.listContentTypeDetailedUrlTemplate="{0}/_api/v2.1/sites/{1}/lists/{2}/contentTypes";s.contentTypeColumnsUrlTemplate="{0}/_api/v2.1/sites/{1}/contentTypes/{2}/columns";s.sharedPackageUrlTemplate="{0}/_api/v2.1/sites/{1}/lists/Shared Packages/items?expand=fields";s.availableContentTypesForListUrlTemplate="{0}/_api/v2.1/sites/{1}/oneDrive.getApplicableContentTypesForList(listId='{2}')";s.siteColumnsUrlTemplate="{0}/_api/v2.1/sites/{1}/columns";s.currencyListUrlTemplate="{0}/_api/SP.CurrencyList.GetList";s.regionalDateTimeUrlTemplate="{0}/_api/web/GetRegionalDateTimeSchema";s.siteListsUrlTemplate="{0}/_api/v2.1/sites/{1}/lists?$select=system,id,name,displayName,list";s.listFieldsUrlTemplate="{0}/_api/v2.1/sites/{1}/lists/{2}/columns";s.createContentTypeViewUrl="{0}/_api/v2.1/sites/{1}/lists/{2}/views";s.listContentTypeColumnsUrlTemplate="{0}/_api/v2.1/sites/{1}/lists/{2}/contentTypes/{3}/columns";s.publishContentTypeUrlTemplate="{0}/_api/v2.1//sites/{1}/contentTypes/{2}/oneDrive.publish";s.unpublishContentTypeUrlTemplate="{0}/_api/v2.1/sites/{1}/contentTypes/{2}/oneDrive.unpublish";s.updateContentTypeColumnUrlTemplate="{0}/_api/v2.1/sites/{1}/contentTypes/{2}/columns/{3}";s.updateContentTypeUrlTemplate="{0}/_api/v2.1/sites/{1}/contentTypes/{2}";s.contentTypeListViewUrl=f.format("/_api/web/lists/GetByTitle('{0}')",u.contentTypeViewName);s.createListUrlTemplate="{0}/_api/v2.1/sites/{1}/lists";s.fetchCustomCTProperty="$filter=custom ne null";s.selectDocTemplateProperty="$select=documentTemplate";s.reorderColumns="$select=columnOrder";s.getContentTypeColumnsHiddenParam="$select=*,hidden";s.getContentTypeAncestorsParam="$expand=ancestors";s.getContentTypeEnforcemenetParam="$select=*,enforcement";s.getToken=function(){var e=r.getServerUrl(s._pageContext);return s._getOAuthToken?s._getOAuthToken():s._tokenProvider.getToken(e)};s._tokenProvider=new i.default(null,{oAuthTokenDataSource:new o.default(t)});s._getOAuthToken=n;return s}t.prototype.getContentTypes=function(e){return this.dataRequestor.getData({url:this.getUrl(this.contentTypeUrlTemplate,e),qosName:"GetSiteContentType",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getContentTypeAncestors=function(e,t){return this.dataRequestor.getData({url:this.getUrl(this.updateContentTypeUrlTemplate+"?"+this.getContentTypeAncestorsParam,e,t),qosName:"GetSiteContentTypeAncestors",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).ancestors},noRedirect:!0})};t.prototype.getContentType=function(e,t){return this.dataRequestor.getData({url:this.getUrl(this.contentTypeUrlTemplate+"/"+t,e),qosName:"GetSiteContentType",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e)}catch(e){return}},noRedirect:!0})};t.prototype.getContentTypesDetailedAvailableForList=function(e,t){return this.dataRequestor.getData({url:this.getUrl(this.availableContentTypesForListUrlTemplate+"?"+this.fetchCustomCTProperty,e,void 0,t),qosName:"GetSiteContentTypeForList",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getListContentTypesDetailed=function(e,t){return this.dataRequestor.getData({url:this.getUrl(this.listContentTypeDetailedUrlTemplate+"?"+this.fetchCustomCTProperty,e,void 0,t),qosName:"GetListContentType",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getContentTypeColumns=function(e,t){return this.dataRequestor.getData({url:this.getUrl(this.contentTypeColumnsUrlTemplate+"?"+this.getContentTypeColumnsHiddenParam,e,t),qosName:"GetContentTypeColumns",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getListContentTypeColumns=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(f.format(this.listContentTypeColumnsUrlTemplate,r.getServerUrl(this._pageContext),e,t,n)),qosName:"GetContentTypeColumns",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getEnforcedHubSites=function(e,t){return this.dataRequestor.getData({url:encodeURI(f.format(this.updateContentTypeUrlTemplate+"?"+this.getContentTypeEnforcemenetParam,r.getServerUrl(this._pageContext),e,t)),qosName:"GetContentTypeEnforcedHubSites",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e)}catch(e){return{}}},noRedirect:!0})};t.prototype.publishContentType=function(e,t){return this.dataRequestor.getData({url:this.getUrl(this.publishContentTypeUrlTemplate,e,t),qosName:"GetContentTypePublish",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})};t.prototype.unpublishContentType=function(e,t){return this.dataRequestor.getData({url:this.getUrl(this.unpublishContentTypeUrlTemplate,e,t),qosName:"GetContentTypeUnpublish",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})};t.prototype.getSiteColumns=function(e,t){return this.dataRequestor.getData({url:t?this.getUrl(this.siteColumnsUrlTemplate,e)+"?select="+t.join(","):this.getUrl(this.siteColumnsUrlTemplate,e),qosName:"GetSiteColumns",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.addContentTypesToList=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:r.getUrl(r.listContentTypeDetailedUrlTemplate,e,void 0,t),authToken:i,qosName:"AddContentTypeToList",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:r.constructContentTypeAddToListPostBody(n),parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})})};t.prototype.createContentType=function(e,t,n,r,i,s){var o=this;return this.getToken().then(function(u){return o.dataRequestor.getData({url:o.getUrl(o.contentTypeUrlTemplate,i),authToken:u,qosName:"CreateContentType",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:o.constructContentTypeBody(e,t,n,r,void 0,void 0,s),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.updateContentType=function(e,t,n,r,i,s,o,u,a,f){var l=this,h=JSON.parse(this.constructContentTypeBody(n,r,i,s,o,u,f)),p=void 0,d=1;if(void 0!==a){h.documentTemplate={name:a.name};if(void 0!==a.content){h.documentTemplate["@microsoft.graph.sourceUrl"]="cid:content"+d;p=c.getBatchContentHeader("A100x","content"+d,"application/octet-stream");d+=1}}var v,m=c.getBatchContent("A100x","metadata","application/json",JSON.stringify(h));if(void 0!==p){m+=p;v=new Blob([m,a.content,"\r\n--A100x--"])}else v=new Blob([m,"--A100x--"]);return this.getToken().then(function(n){return l.dataRequestor.getData({url:l.getUrl(l.updateContentTypeUrlTemplate,e,t),authToken:n,qosName:"UpdateContentType",method:"PATCH",contentType:"multipart/related; boundary=A100x",additionalHeaders:void 0,additionalPostData:v,parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.createOrAddContentTypeColumns=function(e,t,r,i){var s=this;return this.getToken().then(function(o){return s.dataRequestor.getData({url:s.getUrl(s.contentTypeColumnsUrlTemplate,e,t),authToken:o,qosName:"CreateContentTypeColumn",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({value:n.__spreadArrays(r,i)}),parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})})};t.prototype.createContentTypeView=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:r.getUrl(r.createContentTypeViewUrl,e,void 0,t),authToken:i,qosName:"CreateContentTypeView",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:r.constructCreateContentTypeViewPostBody(n),parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return""}},noRedirect:!0})})};t.prototype.getSharedPackages=function(e){return this.dataRequestor.getData({url:this.getUrl(this.sharedPackageUrlTemplate,e),qosName:"GetSharedPackages",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getCurrencyList=function(e){var t=this;return this.getToken().then(function(n){return t.dataRequestor.getData({url:encodeURI(f.format(t.currencyListUrlTemplate,e)),authToken:n,qosName:"SP.CurrencyList.GetList",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e).Items}catch(e){return[]}},noRedirect:!0})})};t.prototype.getRegionalDateTimeSchema=function(e){var t=this;return this.getToken().then(function(n){return t.dataRequestor.getData({url:encodeURI(f.format(t.regionalDateTimeUrlTemplate,e)),authToken:n,qosName:"GetRegionalDateTimeSchema",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{var t=JSON.parse(e);return JSON.parse(t.value)}catch(e){return{}}},noRedirect:!0})})};t.prototype.loadViews=function(e){var t=this;return this.dataRequestor.getData({url:""+e+this.contentTypeListViewUrl+"/Views",qosName:"GetContentTypeViews",method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){return t._parseReturnedViews(JSON.parse(e))},noRedirect:!0})};t.prototype.updateView=function(e,t,n,r,i){var s=this,o=""+i+this.contentTypeListViewUrl+"/Views('"+e+"')/SetViewXml()",u=this._translateColumnKeysToFieldRefNames(r),f=new a.default(n,u).generateCamlQueryString().replace("<View>",'<View Name="'+e+'" DisplayName="'+t+'">');return this.getToken().then(function(e){return s.dataRequestor.getData({url:o,authToken:e,qosName:"UpdateContentTypeView",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({viewXml:f}),parseResponse:function(e){},noRedirect:!0})})};t.prototype.createView=function(e,t,n,r){var i=this,s=""+r+this.contentTypeListViewUrl+"/Views/Add",o=this._translateColumnKeysToFieldRefNames(n),u=new a.default(t).generateCamlQueryString();return this.getToken().then(function(t){return i.dataRequestor.getData({url:s,authToken:t,qosName:"CreateContentTypeView",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({parameters:{Title:e,ViewFields:o,Query:u,Paged:!1,PersonalView:!1}}),parseResponse:function(e){return JSON.parse(e).Id},noRedirect:!0})})};t.prototype.setDefaultView=function(e,t){return n.__awaiter(this,void 0,l.default,function(){var r,i=this;return n.__generator(this,function(n){r=""+e+this.contentTypeListViewUrl+"/Views('"+t+"')";return[2,this.getToken().then(function(e){return i.dataRequestor.getData({url:r,authToken:e,qosName:"UpdateContentTypeView",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({DefaultView:!0}),parseResponse:function(e){},noRedirect:!0})})]})})};t.prototype.createContentTypeViewList=function(e,t){var n=this;return this.getToken().then(function(r){return n.dataRequestor.getData({url:n.getUrl(n.createListUrlTemplate,e),authToken:r,qosName:"CreateContentTypeViewList",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify(t),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.getAllSitesLists=function(e){return this.dataRequestor.getData({url:this.getUrl(this.siteListsUrlTemplate,e),qosName:"GetAllSitesLists",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getListFields=function(e,t){return this.dataRequestor.getData({url:this.getUrl(this.listFieldsUrlTemplate,e,null,t),qosName:"GetListFields",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getContentTypeDocTemplate=function(e,t){return this.dataRequestor.getData({url:encodeURI(f.format(this.contentTypeUrlTemplate+"/"+t+"?"+this.selectDocTemplateProperty,this._pageContext.siteAbsoluteUrl,e)),qosName:"GetContentTypeDocTemplate",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).documentTemplate}catch(e){return{}}},noRedirect:!0})};t.prototype.deleteContentTypeFromList=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:r.getUrl(r.listContentTypeDetailedUrlTemplate+"/"+n,e,void 0,t),authToken:i,qosName:"DeleteContentTypeList",method:"DELETE",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e)}catch(e){return""}},noRedirect:!0})})};t.prototype.deleteContentTypeFromSite=function(e,t){var n=this;return this.getToken().then(function(r){return n.dataRequestor.getData({url:encodeURI(f.format(n.contentTypeUrlTemplate+"/"+t,n._pageContext.siteAbsoluteUrl,e)),authToken:r,qosName:"DeleteContentTypeSite",method:"DELETE",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e)}catch(e){return""}},noRedirect:!0})})};t.prototype.deleteContentTypeColumn=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:r.getUrl(r.updateContentTypeColumnUrlTemplate,e,t,void 0,n),authToken:i,qosName:"DeleteContentTypeColumn",method:"DELETE",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e)}catch(e){return""}},noRedirect:!0})})};t.prototype.updateContentTypeColumn=function(e,t,n,r,i,s){var o=this;return this.getToken().then(function(u){return o.dataRequestor.getData({url:o.getUrl(o.updateContentTypeColumnUrlTemplate,e,t,void 0,n),authToken:u,qosName:"UpdateContentTypeColumn",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({pushDownChanges:r,hidden:i,required:s}),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.reorderContentTypeColumn=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:r.getUrl(r.updateContentTypeUrlTemplate+"?"+r.reorderColumns,e,t),authToken:i,qosName:"ReorderContentTypeColumns",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({columnOrder:n}),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.updateSiteColumn=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:encodeURI(f.format(r.siteColumnsUrlTemplate,r._pageContext.siteAbsoluteUrl,e)+"/"+t),authToken:i,qosName:"UpdateSiteColumn",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({customFormatter:n}),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype._translateColumnKeysToFieldRefNames=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];i in u.contentTypeColumnFields&&t.push(u.contentTypeColumnFields[i].fieldRefName)}return t};t.prototype._parseReturnedViews=function(e){if(!e||!e.value||0===e.value.length)throw new Error("ContentTypeDataSource.parseReturnedViews: viewsData is null or undefined!");for(var t={},n=0,r=e.value;n<r.length;n++){var i=r[n],s=void 0;s=i.ViewQuery.indexOf("<View>")>-1?a.default.parseCamlQueryString(i.ViewQuery):a.default.parseCamlQueryString("<View><Query>"+i.ViewQuery+"</Query></View>");t[i.Id]={id:i.Id,title:i.Title,isDefault:i.DefaultView,query:s}}return t};t.prototype.getUrl=function(e,t,n,i,s){var o=r.getServerUrl(this._pageContext);return n?i?void 0:s?encodeURI(f.format(e,o,t,n,s)):encodeURI(f.format(e,o,t,n)):i?encodeURI(f.format(e,o,t,i)):encodeURI(f.format(e,o,t))};t.prototype.constructContentTypeBody=function(e,t,n,r,i,s,o){var u={name:e,description:t,group:n,readOnly:i,pushDownChanges:s,enforcement:o};r&&(u.parentReference={id:r});return JSON.stringify(u)};t.prototype.constructContentTypeAddToListPostBody=function(e){var t=[];e.forEach(function(e){return t.push({id:e})});return JSON.stringify({value:t})};t.prototype.constructCreateContentTypeViewPostBody=function(e){var t={columns:e.columns,isDefault:!1,isPersonalView:!1,title:e.name};return JSON.stringify(t)};return t})(s.default);t.default=d});
define("aSk",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.NONE=0]="NONE";e[e.ASC=1]="ASC";e[e.DESC=2]="DESC"})(t.QueryDirection||(t.QueryDirection={}));(function(e){e.id="id";e.reorderable="reorderable"})(t.ColumnProperties||(t.ColumnProperties={}));t.contentTypeColumnFields={name:{fieldRefName:"Name",valueType:"TEXT"},parent:{fieldRefName:"Parent",valueType:"TEXT"},group:{fieldRefName:"Group",valueType:"TEXT"},lastPublished:{fieldRefName:"LastPublished",valueType:"TEXT"}};t.contentTypeViewName="DO_NOT_DELETE_SPLIST_TENANTADMIN_AGGREGATED_CONTENTTYPES"});
define("aSn",["require","exports","gK","Hl","aSk"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e){this._children=e}e.prototype.generateCamlQueryString=function(){var e=this._children.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<Where>"+e+"</Where>":""};return e})(),o=(function(){function e(e,t){this._fieldName=e;this._fieldValue=t}e.prototype.generateCamlQueryString=function(){var e=n.default.encodeText(i.contentTypeColumnFields[this._fieldName].fieldRefName),t=n.default.encodeText(this._fieldValue),r=n.default.encodeText(i.contentTypeColumnFields[this._fieldName].valueType);return t?"<Eq><FieldRef Name='"+e+"'/><Value Type='"+r+"'>"+t+"</Value></Eq>":"<IsNull><FieldRef Name='"+e+"'/></IsNull>"};return e})(),u=(function(){function e(e,t){this._filterFieldValueCamlQueries=[];for(var n=0,r=t;n<r.length;n++){var i=r[n];this._filterFieldValueCamlQueries.push(new o(e,i))}}e.prototype.generateCamlQueryString=function(){for(var e="",t=0,n=this._filterFieldValueCamlQueries;t<n.length;t++){var r=n[t].generateCamlQueryString();e=e?"<Or>"+e+r+"</Or>":r}return e};return e})(),a=(function(){function e(e){var t=this,n=e||new Map;this._filterByFieldCamlQueries=[];n.forEach(function(e,n){0!==e.length&&t._filterByFieldCamlQueries.push(new u(n,e))})}e.prototype.generateCamlQueryString=function(){for(var e="",t=0,n=this._filterByFieldCamlQueries;t<n.length;t++){var r=n[t].generateCamlQueryString();e=e?"<And>"+e+r+"</And>":r}return e};return e})(),f=(function(){function e(e){this._condition=e}e.prototype.generateCamlQueryString=function(){if(0===this._condition.direction)throw new Error("OrderBy query direction is set to NONE which is unexpected!");var e=2===this._condition.direction;return"<OrderBy><FieldRef Name='"+n.default.encodeText(i.contentTypeColumnFields[this._condition.field].fieldRefName)+"' Ascending='"+!e+"' /></OrderBy>"};return e})(),l=(function(){function e(e){this._condition=e}e.prototype.generateCamlQueryString=function(){return"<GroupBy><FieldRef Name='"+n.default.encodeText(i.contentTypeColumnFields[this._condition.field].fieldRefName)+"' /></GroupBy>"};return e})(),c=(function(){function e(e){e=e||{};this._queryCamlQueryElements=[];var t=[];t.push(new a(e.filterBys));this._queryCamlQueryElements.push(new s(t));e.orderBy&&this._queryCamlQueryElements.push(new f(e.orderBy));e.groupBy&&this._queryCamlQueryElements.push(new l(e.groupBy))}e.prototype.generateCamlQueryString=function(){var e=this._queryCamlQueryElements.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<Query>"+e+"</Query>":""};return e})(),h=(function(){function e(e){this._fieldRefName=e}e.prototype.generateCamlQueryString=function(){return'<FieldRef Name="'+this._fieldRefName+'"/>'};return e})(),p=(function(){function e(e){this._contentTypeCamlQueryElements=[];for(var t=0,n=e;t<n.length;t++){var r=n[t];this._contentTypeCamlQueryElements.push(new h(r))}}e.prototype.generateCamlQueryString=function(){var e=this._contentTypeCamlQueryElements.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<ViewFields>"+e+"</ViewFields>":""};return e})(),d=(function(){function e(e,t){this._contentTypeCamlQueryElements=[];e&&this._contentTypeCamlQueryElements.push(new c(e));t&&this._contentTypeCamlQueryElements.push(new p(t))}e.parseCamlQueryString=function(e){var t=r.parseView(e),n={};if(t.filters){n.filterBys=new Map;for(var i=0,s=t.filters;i<s.length;i++){var o=s[i];if(this._instanceOfIFilter(o)){var u=this._getColumnKeyFromFieldRefName(o.fieldName);u&&(n.filterBys[u]=o.values)}}}if(t.sorts){var a=this._getColumnKeyFromFieldRefName(t.sorts[0].fieldName);a&&(n.orderBy={field:a,direction:t.sorts[0].isAscending?1:2})}if(t.groupBy){var f=this._getColumnKeyFromFieldRefName(t.groupBy.group1.fieldName);f&&(n.groupBy={field:f})}return n};e._instanceOfIFilter=function(e){return"fieldName"in e};e._getColumnKeyFromFieldRefName=function(e){for(var t in i.contentTypeColumnFields)if(i.contentTypeColumnFields[t].fieldRefName===e)return t};e.prototype.generateCamlQueryString=function(){var e=this._contentTypeCamlQueryElements.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<View>"+e+"</View>":""};return e})();t.default=d});
define("aSm",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getBatchContent=function(e,n,r,i){var s=t.getBatchContentHeader(e,n,r);return s+=i+"\r\n"};t.getBatchContentHeader=function(e,t,n){var r="--"+e+"\r\n";r+="Content-ID: "+t+"\r\n";return r+="Content-Type: "+n+"\r\n\r\n"}});
define("aSi",["require","exports","mU","aSk","dG","aSj","bl"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=[{name:"Name",displayName:"Name",required:!1,text:{textType:""}},{name:"Group",displayName:"Group",required:!1,text:{textType:""}},{name:"Parent",displayName:"Parent",required:!1,text:{textType:""}},{name:"LastPublished",displayName:"LastPublished",required:!1,text:{textType:""}}],a=(function(){function e(t,n,r,i,s){this.contentTypeHubPath="/sites/contenttypehub";this._graphDataSource=t;this._contentTypeDataSource=n;this._pageContext=r;this._isAdmin=void 0!==i&&!1!==i;this._siteId=void 0!==s?s:e.removeParenthesisIfExist(this._pageContext.siteId)}e.prototype.loadContentTypes=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this._contentTypeDataSource.getContentTypes(this._siteId).then(function(e){return e})]})})};e.prototype.loadContentType=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.getContentType(e.removeParenthesisIfExist(this._pageContext.siteId),t).then(function(e){return e})]})})};e.prototype.loadContentTypesDetailedAvailableForList=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getContentTypesDetailedAvailableForList(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId)).then(function(e){return e})]})})};e.prototype.loadListContentTypesDetailed=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getListContentTypesDetailed(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId)).then(function(e){return e})]})})};e.prototype.addContentTypesToList=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.addContentTypesToList(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.loadContentTypeColumns=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getContentTypeColumns(this._siteId,e).then(function(e){return e})]})})};e.prototype.loadListContentTypeColumns=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.getListContentTypeColumns(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.loadSiteColumns=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getSiteColumns(this._siteId,e).then(function(e){return e})]})})};e.prototype.createContentType=function(e,t,r,i,s){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.createContentType(e,t,r,i,this._siteId,s).then(function(e){return e})]})})};e.prototype.updateContentType=function(e,t,r,i,s,o,u,a,f){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.updateContentType(this._siteId,e,t,r,i,s,o,u,a,f).then(function(e){return e})]})})};e.prototype.publishContentType=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.publishContentType(this._siteId,e).then(function(e){return e})]})})};e.prototype.unpublishContentType=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.unpublishContentType(this._siteId,e).then(function(e){return e})]})})};e.prototype.deleteContentTypeColumn=function(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.deleteContentTypeColumn(this._siteId,e,t).then(function(e){return e})]})})};e.prototype.createOrAddContentTypeColumns=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.createOrAddContentTypeColumns(this._siteId,e,t,r).then(function(e){return e})]})})};e.prototype.createContentTypeView=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){t.columns;return[2,this._contentTypeDataSource.createContentTypeView(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.getSharedPackages=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this._contentTypeDataSource.getSharedPackages(this._siteId).then(function(e){return e})]})})};e.prototype.getCurrencyList=function(){return n.__awaiter(this,void 0,o.default,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=this._isAdmin?i.getServerUrl(this._pageContext):this._pageContext.webAbsoluteUrl;return[4,this._contentTypeDataSource.getCurrencyList(e)];case 1:return[2,t.sent()]}})})};e.prototype.getRegionalDateTimeSchema=function(){return n.__awaiter(this,void 0,o.default,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=this._isAdmin?i.getServerUrl(this._pageContext):this._pageContext.webAbsoluteUrl;return[4,this._contentTypeDataSource.getRegionalDateTimeSchema(e)];case 1:return[2,t.sent()]}})})};e.prototype.getAllSitesLists=function(){return n.__awaiter(this,void 0,o.default,function(){return n.__generator(this,function(e){return[2,this._contentTypeDataSource.getAllSitesLists(this._siteId).then(function(e){return e})]})})};e.prototype.getListFields=function(t){return n.__awaiter(this,void 0,o.default,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return this._isAdmin?[4,this.getContentTypeHubSiteId()]:[3,2];case 1:r=n.sent();return[3,3];case 2:r=e.removeParenthesisIfExist(this._pageContext.siteId);n.label=3;case 3:return[2,this._contentTypeDataSource.getListFields(r,t).then(function(e){return e})]}})})};e.prototype.getContentTypeDocTemplate=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getContentTypeDocTemplate(this._siteId,e).then(function(e){return e})]})})};e.prototype.getContentTypeEnforcedHubSites=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getEnforcedHubSites(this._siteId,e).then(function(e){return e})]})})};e.prototype.deleteListContentType=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.deleteContentTypeFromList(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.updateContentTypeColumn=function(e,t,r,i,s){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.updateContentTypeColumn(this._siteId,e,t,r,i,s).then(function(e){return e})]})})};e.prototype.reorderContentTypeColumn=function(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.reorderContentTypeColumn(this._siteId,e,t).then(function(e){return e})]})})};e.prototype.getContentTypeAncestors=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getContentTypeAncestors(this._siteId,e).then(function(e){return e})]})})};e.prototype.updateSiteColumn=function(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.updateSiteColumn(this._siteId,e,t).then(function(e){return e})]})})};e.prototype.deleteSiteContentType=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.deleteContentTypeFromSite(this._siteId,e).then(function(e){return e})]})})};e.prototype.updateView=function(e,t,r,i){return n.__awaiter(this,void 0,o.default,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._contentTypeDataSource.updateView(e,t,r,i,this._pageContext.webAbsoluteUrl)];case 1:return[2,n.sent()]}})})};e.prototype.createView=function(e,t,r){return n.__awaiter(this,void 0,o.default,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._contentTypeDataSource.createView(e,t,r,this._pageContext.webAbsoluteUrl)];case 1:return[2,n.sent()]}})})};e.prototype.setDefaultView=function(e){return n.__awaiter(this,void 0,o.default,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,this._contentTypeDataSource.setDefaultView(this._pageContext.webAbsoluteUrl,e)];case 1:return[2,t.sent()]}})})};e.prototype.loadViews=function(){return n.__awaiter(this,void 0,o.default,function(){var t,i,s,o,a,f,l,c;return n.__generator(this,function(n){switch(n.label){case 0:t=this._pageContext.webAbsoluteUrl;i=e.removeParenthesisIfExist(this._pageContext.siteId);n.label=1;case 1:n.trys.push([1,3,,10]);return[4,this._contentTypeDataSource.loadViews(t)];case 2:return[2,n.sent()];case 3:if(404!==(s=n.sent()).status)return[3,8];o={displayName:r.contentTypeViewName,list:{hidden:!0,template:"genericList"},columns:u};a={orderBy:{field:"name",direction:1}};f=["name","parent","group","lastPublished"];return[4,this._contentTypeDataSource.createContentTypeViewList(i,o)];case 4:n.sent();return[4,this._contentTypeDataSource.loadViews(t)];case 5:l=n.sent();c=Object.keys(l)[0];return[4,this._contentTypeDataSource.updateView(c,l[c].title,a,f,this._pageContext.webAbsoluteUrl)];case 6:n.sent();return[4,this._contentTypeDataSource.loadViews(t)];case 7:return[2,n.sent()];case 8:throw s;case 9:return[3,10];case 10:return[2]}})})};e.prototype.getContentTypeHubSiteId=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:e=new s.ContentTypeUrlHelper({path:this.contentTypeHubPath,authority:i.getServerUrl(this._pageContext).replace("-admin","")});t=e.getSiteByPathUrl();return[4,this._graphDataSource.getSiteIdfromUrl(t)];case 1:return[2,n.sent()]}})})};e.removeParenthesisIfExist=function(e){return e.indexOf("{")>=0&&e.lastIndexOf("}")===e.length-1?e.substring(1,e.length-1):e};return e})();t.default=a});
define("aSj",["require","exports","aL"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this.uri=new n.default(""+e.authority+e.path)}e.prototype.getSiteByPathUrl=function(){return"/v1.0/sites/"+this.uri.domain+":"+this.uri.path};e.prototype.getWebAbsoluteUrlValue=function(){return""+this.uri.value};return e})();t.ContentTypeUrlHelper=r});
define("aSb",["require","exports","mU","aSc","aSc"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.ContentTypeManagementPanel});
define("aSc",["require","exports","mU","aSg","aSe","aSd"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("aSg",["require","exports","mU","f","BU","oJ","aSe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r.addContentTypesToList=function(e){r.setState(n.__assign(n.__assign({},r.state),{showSpinner:!0,spinnerText:r.props.strings.applyingContentTypesSpinner}));r.props.addContentTypesToList(e)};r.state={showSpinner:!0,spinnerText:t.strings.loadingContentTypesSpinner,hasErrorOccurred:r.props.hasErrorOccurred,siteContentTypes:[],listContentTypes:[]};return r}t.prototype.componentDidMount=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,this.props.getSiteContentTypes()];case 1:e=n.sent();return[4,this.props.getListContentTypes()];case 2:t=n.sent();e.forEach(function(e){e.createNewView=!0;e.addColumnsToCurrentView=!1});this.setState({showSpinner:!1,spinnerText:"",siteContentTypes:e,listContentTypes:t});return[3,4];case 3:n.sent();this.setState({showSpinner:!1,hasErrorOccurred:!0});return[3,4];case 4:return[2]}})})};t.getDerivedStateFromProps=function(e,t){return{showSpinner:!e.hasErrorOccurred&&t.showSpinner,spinnerText:t.spinnerText,hasErrorOccurred:t.hasErrorOccurred||e.hasErrorOccurred,siteContentTypes:t.siteContentTypes,listContentTypes:t.listContentTypes}};t.prototype.render=function(){return r.createElement("div",null,r.createElement(i.Panel,n.__assign({},this.props.panelProps),this.state.showSpinner&&r.createElement(s.Spinner,{size:s.SpinnerSize.large,label:this.state.spinnerText}),!this.state.showSpinner&&r.createElement(o.ContentTypeManagementPanelContent,{availableContentTypes:this.state.siteContentTypes,addedContentTypes:this.state.listContentTypes,strings:this.props.strings,errorStrings:this.props.errorStrings,hasErrorOccurred:this.state.hasErrorOccurred,getContentType:this.props.getSiteContentType,getContentTypeColumns:this.props.getContentTypeColumns,getListContentTypeColumns:this.props.getListContentTypeColumns,removeContentType:this.props.removeContentType,addContentTypesToList:this.addContentTypesToList,onDismiss:this.props.onDismiss})))};return t})(r.PureComponent);t.ContentTypeManagementPanel=u});
define("aSe",["require","exports","mU","f","Zy","Jp","aSd","n4","JK","aPh","W","v","a2","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._onRenderDropdownTitle=function(e){var t="",n=e.filter(function(e){return e.selected}).length;t=n>0?n+" "+i.props.strings.dropdownTitleSelectedLabel:i.props.strings.dropdownNoneLabel;return r.createElement("div",null,t)};i._handleDropdownChange=function(e,t){var r=n.__spreadArrays(i.state.selectedContentTypesIds),s=i.state.selectedContentTypeToViewInfoId;if(t.selected)r.push(t.key);else{r=r.filter(function(e){return e!==t.key});s&&s===t.key&&(s=void 0)}i.setState(n.__assign(n.__assign({},i.state),{selectedContentTypesIds:r,selectedContentTypeToViewInfoId:s}))};i._handleAddedContentTypeSelectWrapper=function(e){return function(t){return i._handleAddedContentTypeSelect(e)}};i._handleAddedContentTypeSelect=function(e){if(e.columns)i.setState(n.__assign(n.__assign({},i.state),{isLoadingContentTypeColumn:!1,selectedContentTypeToViewInfoId:e.id,isSelectedAnAddedContentType:!0,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}));else{i._updateColumnsOfAddedContentType(e);i.setState(n.__assign(n.__assign({},i.state),{isLoadingContentTypeColumn:!0,selectedContentTypeToViewInfoId:e.id,isSelectedAnAddedContentType:!0,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))}};i._handleSelectWrapper=function(e){return function(t){return i._handleSelect(e)}};i._handleSelect=function(e){return n.__awaiter(i,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(s){t=c.deepCopy(this.state.availableContentTypes);r=void 0;for(i=0;i<t.length;i++)if(t[i].id===e){r=i;break}if(t[r].columns)this.setState(n.__assign(n.__assign({},this.state),{selectedContentTypeToViewInfoId:e,isLoadingContentTypeColumn:!1,isSelectedAnAddedContentType:!1,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}));else{this._updateColumns(t,r);this.setState(n.__assign(n.__assign({},this.state),{isLoadingContentTypeColumn:!0,selectedContentTypeToViewInfoId:e,isSelectedAnAddedContentType:!1,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))}return[2]})})};i._updateColumnsOfAddedContentType=function(e){return n.__awaiter(i,void 0,void 0,function(){var t=this;return n.__generator(this,function(r){this.props.getListContentTypeColumns(e.id).then(function(r){for(var i=c.deepCopy(t.state.addedContentTypes),s=0;s<i.length;s++)if(i[s].id===e.id){i[s].columns=r;break}t.setState(n.__assign(n.__assign({},t.state),{addedContentTypes:n.__spreadArrays(i),isLoadingContentTypeColumn:!1,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))}).catch(function(e){return t.setState({hasError:!0})});return[2]})})};i._updateColumns=function(e,t){return n.__awaiter(i,void 0,void 0,function(){var r=this;return n.__generator(this,function(i){this.props.getContentTypeColumns(e[t].id).then(function(i){e[t].columns=i;r.setState(n.__assign(n.__assign({},r.state),{availableContentTypes:n.__spreadArrays(e),isLoadingContentTypeColumn:r.state.selectedContentTypeToViewInfoId!==e[t].id&&r.state.isLoadingContentTypeColumn,isSelectedAnAddedContentType:r.state.selectedContentTypeToViewInfoId!==e[t].id&&r.state.isSelectedAnAddedContentType,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))}).catch(function(e){return r.setState({hasError:!0})});return[2]})})};i._handleListCheckboxChangeWrapper=function(e){return function(t,n){return i._handleListCheckboxChange(n,e)}};i._handleListCheckboxChange=function(e,t){if(!e){var r=n.__spreadArrays(i.state.selectedContentTypesIds),s=i.state.selectedContentTypeToViewInfoId;r=r.filter(function(e){return e!==t});s&&s===t&&(s=void 0);i.setState(n.__assign(n.__assign({},i.state),{selectedContentTypesIds:r,selectedContentTypeToViewInfoId:s}))}};i._handleCreateNewViewToggle=function(e){h.Engagement.logData({name:"ContentTypeManagementPanel.CreateNewViewToggle."+(e?"Enabled":"Disabled")});for(var t=c.deepCopy(i.state.availableContentTypes),r=0;r<t.length;r++)if(t[r].id===i.state.selectedContentTypeToViewInfoId){t[r]=n.__assign({},t[r]);t[r].createNewView=e;break}i.setState(n.__assign(n.__assign({},i.state),{availableContentTypes:n.__spreadArrays(t)}))};i._handleAddColumnsToCurrentViewToggle=function(e){h.Engagement.logData({name:"ContentTypeManagementPanel.AddColumnsToCurrentViewToggle."+(e?"Enabled":"Disabled")});for(var t=c.deepCopy(i.state.availableContentTypes),r=0;r<t.length;r++)if(t[r].id===i.state.selectedContentTypeToViewInfoId){t[r]=n.__assign({},t[r]);t[r].addColumnsToCurrentView=e;break}i.setState(n.__assign(n.__assign({},i.state),{availableContentTypes:n.__spreadArrays(t)}))};i._handleRemoveContentTypeClick=function(e,t){h.Engagement.logData({name:"ContentTypeManagementPanel.DeleteClick"});var r=new l.Qos({name:"ContentTypeManagementPanel.DeleteContentType"});i.props.removeContentType(e).then(function(){return n.__awaiter(i,void 0,void 0,function(){var i,s,o;return n.__generator(this,function(u){switch(u.label){case 0:r.end({resultType:l.ResultTypeEnum.Success,extraData:{contentTypeId:e}});i=(i=c.deepCopy(this.state.addedContentTypes)).filter(function(t){return t.id!==e});return[4,this.props.getContentType(t)];case 1:(s=u.sent()).createNewView=!1;s.addColumnsToCurrentView=!1;(o=c.deepCopy(this.state.availableContentTypes)).push(s);this.setState(n.__assign(n.__assign({},this.state),{availableContentTypes:n.__spreadArrays(o),addedContentTypes:n.__spreadArrays(i),selectedContentTypeToViewInfoId:void 0,isSelectedAnAddedContentType:!1,hasCannotBeRemovedError:void 0,cannotBeRemovedError:void 0}));return[2]}})})}).catch(function(t){if(400===t.status){r.end({resultType:l.ResultTypeEnum.ExpectedFailure,error:t,extraData:{contentTypeId:e}});i.setState(n.__assign(n.__assign({},i.state),{hasCannotBeRemovedError:!0,cannotBeRemovedError:t.message}))}else{r.end({resultType:l.ResultTypeEnum.Failure,error:t,extraData:{contentTypeId:e}});i.setState(n.__assign(n.__assign({},i.state),{hasError:!0}))}})};i._dismissError=function(){i.setState(n.__assign(n.__assign({},i.state),{hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))};i._renderFooterButtons=function(){return r.createElement(r.Fragment,null,r.createElement(u.PrimaryButton,{className:"ms-ContentTypeManagementPanel-Button",onClick:i._handleApplyClick,disabled:i.state.hasError||0===i.state.selectedContentTypesIds.length},i.props.strings.applyButtonLabel),r.createElement(u.DefaultButton,{className:"ms-ContentTypeManagementPanel-Button ms-ContentTypeManagementPanel-CancelButton",onClick:i._handleCancelClick},i.props.strings.cancelButtonLabel))};i._handleApplyClick=function(){var e=[];n.__spreadArrays(i.state.availableContentTypes).forEach(function(t){i.state.selectedContentTypesIds.find(function(e){return e===t.id})&&e.push(c.deepCopy(t))});h.Engagement.logData({name:"ContentTypeManagementPanel.ApplyClick",extraData:{countContentTypes:e.length}});i.props.addContentTypesToList(e)};i._handleCancelClick=function(){h.Engagement.logData({name:"ContentTypeManagementPanel.CancelClick"});i.props.onDismiss()};i.state={availableContentTypes:c.deepCopy(i.props.availableContentTypes),selectedContentTypesIds:[],addedContentTypes:c.deepCopy(i.props.addedContentTypes),selectedContentTypeToViewInfoId:void 0,isLoadingContentTypeColumn:!0,isSelectedAnAddedContentType:!1,hasError:i.props.hasErrorOccurred,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0};return i}t.getDerivedStateFromProps=function(e,t){return n.__assign(n.__assign({},t),{hasError:t.hasError||e.hasErrorOccurred})};t.prototype.render=function(){var e=this,t=this.props.strings;if(this.state.hasError&&!this.state.hasCannotBeRemovedError)return r.createElement(r.Fragment,null,r.createElement(a.MessageBar,{isMultiline:!1,messageBarType:a.MessageBarType.error},this.props.errorStrings.genericErrorMessage),r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-Buttons"},this._renderFooterButtons()));var u=[],l=void 0;this.state.availableContentTypes.forEach(function(t){e.state.selectedContentTypesIds.find(function(e){return e===t.id})&&u.push(c.deepCopy(t));e.state.isSelectedAnAddedContentType||t.id!==e.state.selectedContentTypeToViewInfoId||(l=c.deepCopy(t))});if(this.state.isSelectedAnAddedContentType)for(var h=0;h<this.state.addedContentTypes.length;h++)if(this.state.addedContentTypes[h].id===this.state.selectedContentTypeToViewInfoId){l=c.deepCopy(this.state.addedContentTypes[h]);break}var p=this.state.availableContentTypes.map(function(t){return{key:t.id,text:t.name,selected:void 0!==e.state.selectedContentTypesIds.find(function(e){return e===t.id})}});return r.createElement("div",{className:"ms-ContentTypeManagementPanel"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-Title"},t.title),r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-Dropdown"},r.createElement(i.Dropdown,{placeholder:t.dropdownNoneLabel,label:t.dropdownLabel,selectedKeys:n.__spreadArrays(this.state.selectedContentTypesIds),onChange:this._handleDropdownChange,multiSelect:!0,options:p,onRenderTitle:this._onRenderDropdownTitle,disabled:0===this.props.availableContentTypes.length})),r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-ContentTypes-Container"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentTypes"},u.map(function(t){return r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-container"+(void 0!==e.state.selectedContentTypeToViewInfoId&&t.id===e.state.selectedContentTypeToViewInfoId?" ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-container-selected":""),key:t.id},r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-row-checkbox"},r.createElement(s.Checkbox,{onChange:e._handleListCheckboxChangeWrapper(t.id),checked:!0})),r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-row-text",role:"button",onClick:e._handleSelectWrapper(t.id)},t.name))})),this.state.addedContentTypes.length>0&&r.createElement(r.Fragment,null,r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes-Label"},r.createElement("b",null,t.addedContentTypes)),r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes"},this.state.addedContentTypes.map(function(t){return r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container"+(void 0!==e.state.selectedContentTypeToViewInfoId&&t.id===e.state.selectedContentTypeToViewInfoId?" ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container-selected":""),role:"button",onClick:e._handleAddedContentTypeSelectWrapper(t),key:t.id},t.name)})))),r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-Buttons"},this._renderFooterButtons())),r.createElement(f.Separator,{vertical:!0}),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel"},r.createElement(o.SecondaryPanel,{selectedContentTypeToViewInfo:l||void 0,isSelectedAnAddedContentType:this.state.isSelectedAnAddedContentType,strings:this.props.strings,errorStrings:this.props.errorStrings,handleCreateNewViewToggle:this._handleCreateNewViewToggle,handleAddColumnsToCurrentViewToggle:this._handleAddColumnsToCurrentViewToggle,removeContentType:this._handleRemoveContentTypeClick,dismissErrorMessage:this._dismissError})))};return t})(r.PureComponent);t.ContentTypeManagementPanelContent=p});
define("aSd",["require","exports","mU","f","lD","oJ","ab0","n4","sx","v","o1"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.renderPanelContent=function(){var e=f.deepCopy(t.props.selectedContentTypeToViewInfo),n=t.props.strings;return r.createElement(r.Fragment,null,!t.props.selectedContentTypeToViewInfo.columns&&r.createElement(s.Spinner,{size:s.SpinnerSize.large}),t.props.selectedContentTypeToViewInfo.columns&&r.createElement("div",null,!t.props.isSelectedAnAddedContentType&&r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-createNewViewToggle"},r.createElement(o.Toggle,{onText:n.createNewViewLabel,offText:n.createNewViewLabel,onChange:t._onCreateNewViewToggle,checked:!!t.props.selectedContentTypeToViewInfo.createNewView})),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-column"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-row"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},t.renderKeyValueText(n.nameLabel,e.name)),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},t.renderKeyValueText(n.parentLabel,e.parentReference.name))),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-row"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},t.renderKeyValueText(n.descriptionLabel,e.description)))),!t.props.isSelectedAnAddedContentType&&r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-addColumnsToCurrentView"},r.createElement(o.Toggle,{onText:n.addColumnCurrentViewLabel,offText:n.addColumnCurrentViewLabel,onChange:t._onAddColumnsToCurrentViewToggle,checked:!!t.props.selectedContentTypeToViewInfo.addColumnsToCurrentView})),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-Columns"},r.createElement("b",null,n.columnsLabel)),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable"},t.renderFieldsTable()),t.props.isSelectedAnAddedContentType&&r.createElement(l.Fabric,null,r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-Buttons ms-ContentTypeManagementPanel-Button"},t.renderDeleteWithTooltip()))))};t._onCreateNewViewToggle=function(e,n){t.props.handleCreateNewViewToggle(n)};t._onAddColumnsToCurrentViewToggle=function(e,n){t.props.handleAddColumnsToCurrentViewToggle(n)};t._onRemoveContentTypeWrapper=function(e){t.props.removeContentType(t.props.selectedContentTypeToViewInfo.id,t.props.selectedContentTypeToViewInfo.parentReference.id)};t.renderKeyValueText=function(e,t,n){return r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-column"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},r.createElement("b",null,e)),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},n?r.createElement(i.Link,{href:n}):t))};t.renderFieldsTable=function(){var e=t.props.strings;return r.createElement(r.Fragment,null,r.createElement("table",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,e.secondaryPanelFieldsListNameDisplayName),r.createElement("th",null,e.secondaryPanelFieldsListTypeDisplayName),r.createElement("th",null,e.secondaryPanelFieldsListStatusDisplayName),r.createElement("th",null,e.secondaryPanelFieldsListSourceDisplayName))),r.createElement("tbody",null,t.props.selectedContentTypeToViewInfo.columns.map(function(e){return r.createElement("tr",{key:e.id},r.createElement("td",null,e.name),r.createElement("td",null,e.typeDisplayName),r.createElement("td",null,e.required?"Required":"Optional"),r.createElement("td",null,e.sourceContentType?e.sourceContentType.name:""))}))))};t.renderDeleteWithTooltip=function(){return t.props.selectedContentTypeToViewInfo?t.props.selectedContentTypeToViewInfo.readOnly?r.createElement(a.TooltipHost,{content:t.props.strings.tooltipReadonlyCT},t.renderDeleteButton()):t.renderDeleteButton():r.createElement(r.Fragment,null," ")};t.renderDeleteButton=function(){return r.createElement("div",null,r.createElement(u.PrimaryButton,{onClick:t._onRemoveContentTypeWrapper,disabled:t.props.selectedContentTypeToViewInfo&&t.props.selectedContentTypeToViewInfo.readOnly},t.props.strings.removeContentTypeButtonLabel))};return t}t.prototype.render=function(){return r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-Content"},void 0===this.props.selectedContentTypeToViewInfo?this.props.strings.defaultSecondaryPanelLabel:this.props.strings.contentTypeInformationLabel,r.createElement("br",null),void 0!==this.props.selectedContentTypeToViewInfo?this.renderPanelContent():"")};return t})(r.PureComponent);t.SecondaryPanel=c});
define("aSq",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchColumnCustomizationPaneAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.LaunchColumnCustomizationPaneAction))(t)})});
define("aSr",["require","exports","mU","f","fa","bw","Px","avO","WU","Kt","iU","Fo","cv","mJ","WT","WN","QL","QE","QM","bc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._panelProvider=n.props.resources.consume(o.resourceKey);n._updateItemsScopeCurrentDerivedView=n.props.resources.consume(a.itemsScopeCurrentDerivedViewUpdatorResourceKey);n._operationProvider=n.props.resources.consume(g.resourceKey);return n}t.prototype.render=function(){var e=this;return r.createElement(i.Action,{isAvailable:!0,onExecute:function(){return n.__awaiter(e,void 0,void 0,function(){var e,t=this;return n.__generator(this,function(n){e=this._panelProvider.requestPanel({hasCommandBar:!0,component:{name:u.default.tagName,params:{onComplete:function(n){var r=!1;t._updateItemsScopeCurrentDerivedView(function(e){r=e.isDirty();e.replaceFields(n);return e});var i=t.props.resources.consume(v.isItemsScopeEnabledResourceKey);if(f.isFeatureEnabled(f.ColumnFieldsAutoSave)&&i){var s=t._operationProvider.register({name:"",type:m.default.editViewColumns,payloads:{}});s.state(y.default.started);t.props.resources.consumeAsync(p.resourceKey).then(function(e){t.props.resources.consumeAsync(d.resourceKey).then(function(n){var i,o,u=e.dispatch(h.readItems(function(e){var t=e.demandItemFacet(l.spFolderItemSetKeyFacet,n.peek());return{setKey:t,viewKey:t&&t.viewKey&&l.spViewKeyFacet.serialize(t.viewKey)}}));u.setKey&&u.viewKey&&e.dispatch(c.saveViewCore({items:(i={},i[l.spListViewsSetKeyFacet.serialize(u.setKey)]={views:(o={},o[u.viewKey]={shouldSaveViewFieldsOnly:!0},o),qosName:"autoSaveShowHide"},i)})).then(function(){!1===r&&t._updateItemsScopeCurrentDerivedView(function(e){e.baseViewXml=e.getEffectiveViewXml();return e});s.state(y.default.completed)},function(e){b.default.logError(e,{eventName:"ShowHideAutoSave",feature:"ColumnFieldsAutoSave",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});t._updateItemsScopeCurrentDerivedView(function(e){e.setIsDirty(!0);return e});s.state(y.default.failed);throw e})})})}e.state(1)}}}});return[2]})})}})};return t})(r.PureComponent);t.LaunchColumnsEditorPanelAction=s.withResources()(w)});
define("aSs",["require","exports","cV","aRS"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchNewItemListFormInPanelAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.LaunchListFormAction))({item:t.item,type:2,contentTypeId:t.contentTypeId,url:t.formUrl})})});
define("aSt",["require","exports","mU","fl","cx","vx","iN"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchMoveCopyPanelAction=r.withSelectedItems()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRZ"],t,n)})];case 1:return[2,t.sent().LaunchMoveCopyPanelAction]}})})},function(e,t){var n=t.itemKeys;if(!n||n.length<1)return!1;var r=e.demandItemFacet(s.launchMoveCopyPanelActionControl,o.odspNextAppItemKey);return!!s.launchMoveCopyPanelActionControl.evaluate(r)(e,t).isAvailable}))});
define("aSu",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ModifyShowInFiltersPaneAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ModifyShowInFiltersPaneAction))(t)})});
define("aSv",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PreviewAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.PreviewAction))})});
define("aSw",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SyncAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SyncAction))})});
define("aSx",["require","exports","cV","aRF","Kt"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ToggleInfoPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowPropertiesAction))({useToggleBehavior:!0,allowMultiSelect:i.isFeatureEnabled(i.SPListBulkEditItemProperties)})},{isToggleable:!0})});
define("aSy",["require","exports","cV","aRS"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SharedColumnClickAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ShowPermissionsAction))({item:t.item})})});
define("aSz",["require","exports","mU","f","aSx","rc","cL","cy","aS"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowDetailsPaneAction=o.createItemCacheComponent(function(e,t){var f=a.getItemsScope(e).itemsScopeItemKey,l=t.itemKey;if(!l||!f)return null;var c=e.dispatch,h=o.evaluateItemCacheComponent(e,r.createElement(i.ToggleInfoPaneAction,null));return r.createElement(u.WithAction,{action:h},function(e){var t=e.isToggled,i=e.execute;return r.createElement(u.ActionBase,{onExecute:function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:c(s.selectItems({itemsScopeItemKey:f,selectedItemKeys:[l],currentSelectionKey:void 0}));return t?[3,2]:[4,i(e)];case 1:n.sent();n.label=2;case 2:return[2]}})})}})})})});
define("aSA",["require","exports","cV","aRS"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowItemAnalyticsAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ShowItemAnalyticsAction))({item:t.item})})});
define("aSB",["require","exports","cV","aRS"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowKeyPointsPaneAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ShowKeyPointsAction))({item:t.item,showFeedbackPanel:t.showFeedbackPanel})})});
define("aSC",["require","exports","aRS","cV"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PolicyTipAction=n.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(r.actionMap);return new(e.injected(n.PolicyTipAction))({item:t.item})})});
define("aSD",["require","exports","mU","f","bw","awh","aSE","aM","fa","mG","cL","h7"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=l.createItemCacheComponent(function(e,t){var i=t.itemKey,l=t.itemKeys,h=t.isMove,p=t.resources;if(!i||0===l.length)return null;var d=e.dispatch,v={name:h?"Move":"Copy",isIntentional:!0,extraData:{count:l.length}};return r.createElement(a.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,r,i,a,l,v,m,g,y;return n.__generator(this,function(n){switch(n.label){case 0:return[4,Promise.all([p.consumeAsync(s.resourceKey),p.consumeAsync(o.resourceKey)])];case 1:e=n.sent(),r=e[0],i=e[1];return[4,d(c.demandItems(function(e){return(function(e,t){var n=e.demandItemFacet(f.knockoutStoreItemFacet,t.itemKey),r=t.itemKeys.map(function(t){return e.demandItemFacet(f.knockoutStoreItemFacet,t)});return{item:n,items:r}})(e,t)}))];case 2:a=n.sent(),l=a.item,v=a.items;m=(function(e,t){var n=e&&e.peek(),r=[],i=!1;if(n){var s=n.key;n.remoteItem||t.forEach(function(e){var t=e&&e.peek();if(t){var n=t.key,o=t.parentKey;t.remoteItem?i=!0:n!==s&&o!==s&&r.push(t)}})}return{targetItem:n,sourceItems:i?[]:r}})(l,v),g=m.targetItem,y=m.sourceItems;return g&&y&&y.length>0&&r&&i?[4,r.copyItems({items:y,parentKey:g.parentKey,targetId:g.id,targetKey:g.key,cid:i.getOwnerId(),group:g.isGroup?1:0,isAsync:!1,isMove:h})]:[3,5];case 3:n.sent();return[4,p.consumeAsync(u.itemInvalidator)];case 4:n.sent().invalidateItems(g.key);n.label=5;case 5:return[2]}})})},engagement:v})});t.MoveCopyAction=i.withResources()(h)});
define("aSE",["require","exports","mU","avn","eG","an","dg","hT"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getAppSubfolder=function(e){return e?"odb":"splist"};t.prototype.getDefaultClickUrl=function(t,n){void 0===n&&(n={});return t?s.isGenericList(this._listContext().listTemplateType)&&t.type===i.default.File?this.getDisplayFormUrl(t):e.prototype.getDefaultClickUrl.call(this,t,n):""};t.prototype.getRecycleBinQueryUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/RecycleBin.aspx"};t.prototype.getUriWithAdjustForCurrentRootFolder=function(e){var t=new o.default(e),n=this.getCurrentItemKey();if(n){var r=this.getKeyParams(n).id;t.setQueryParameter("RootFolder",r)}return t};t.prototype.getNewFormUrl=function(t){var n=e.prototype._getListItemFormUrl.call(this,this._listContext().newFormUrl),r=this.getUriWithAdjustForCurrentRootFolder(n);t&&r.setQueryParameter("ContentTypeId",t);return r.toString()};t.prototype.getQuickLaunchSettingsUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/quiklnch.aspx"};t.prototype.getAreaNavigationSettingsUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/AreaNavigationSettings.aspx"};t.prototype.getTopNavSettingsUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/topnav.aspx"};t.prototype.getWACResourcesPreloadUrl=function(){return e.prototype.getWACResourcesPreloadUrl.call(this)};t.prototype.getWopiDocUrl=function(){return e.prototype.getWopiDocUrl.call(this)};t.prototype.getSitePagesUrl=function(){return this.getWebUrl()+"/SitePages/Forms/AllPages.aspx"};t.prototype.getMyRestorePageUrl=function(){return Promise.resolve("")};t.prototype.getNavLinkClickUrl=function(e){return this._urlDataSourceLite.getNavLinkClickUrl(e)};return t})(r.default);t.default=a;t.resourceKey=u.createResolvedResourceKey(e("module").id,a)});
define("aSF",["require","exports","mU","f","bw","cL","fl","mG","fa","cV","VR","VS","iU","FF","Es","VO","i6","cM","b1","ct","cv","bv","eG","d0","i1","H","ay"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=new m.ProgressKeyFacet("shimUpload");function L(e){var t=this,s=g.useItemCacheDispatch(),o=i.useResourceScope(),u=o.consume(f.currentItemSet.optional),p=o.consume(x.resourceKey),d=e.item,w=e.webAbsoluteUrl,T=e.listFullUrl,N=e.onItemUploaded,C=e.onUploadStarted,L=e.onUploadCompleted;return r.createElement(a.Action,{onExecute:function(e){return n.__awaiter(t,void 0,void 0,function(){function t(e){var t,r=null===(t=e.properties)||void 0===t?void 0:t.ID,i=e.type===S.default.Folder;if(i||r){var s=p.getItemUrlParts(e.key),o=s.serverRelativeItemUrl,u=o===s.serverRelativeListUrl?"":o;return h.spItemKeyFacet.serialize(n.__assign({webAbsoluteUrl:w,listFullUrl:T},i?{rootFolder:u}:{itemId:r}))}}var r,i,a,f,g,x,A,O;return n.__generator(this,function(h){r=e&&e.event&&e.event;if(!(i=r&&r.dataTransfer)||!i.files)return[2];a=!1;f=[];for(g=0;g<i.files.length;g++){x=i.files[g];f.push(x);a||!0!==x.isFolder&&!0!==x.isDirectory||(a=!0)}A=m.progressBatchKeyFacet.serializeNext();O=k.serializeBatchKey(A);o.consumeAsync(l.asyncTypeResourceKey).then(function(e){var r=new e({files:f,parentItem:d.peek(),itemSet:u&&u.peek(),wasDragAndDropped:!0,type:a?c.default.Folder:c.default.Html5file,skipInvalidation:!0,onItemUploaded:function(e){var r,i=e.type===S.default.Folder,u=t(e);if(u){var a=e.parent?t(e.parent):void 0,f=k.serializeTaskKey(A,u,{});s(y.resolveItems({items:(r={},r[f]=b.createdItemFacet.pack({itemKey:u}),r[u]=n.__assign(n.__assign(n.__assign({},E.displayNameFacet.pack(e.displayName)),E.parentFolderItemFacet.pack(a?{itemKey:a}:void 0)),E.folderFacet.pack(i?{}:void 0)),r)}));N&&s(N({progressItemKey:f}));o.consumeAsync(v.resourceKey).then(function(t){return t(e)})}}});r.start();C&&s(C({progressItemKey:O}));return r.wait().catch(function(){}).then(function(){L&&s(L({progressItemKey:O}))})});return[2]})})},engagement:{name:"Upload",isIntentional:!0}})}t.UploadItemsAction=s.createItemCacheComponent(function(e,t){var i=t.itemKey,s=t.onItemUploaded,a=t.onUploadStarted,f=t.onUploadCompleted,l=e.dispatch,c=i,v=e.demandItemFacet(h.spItemGroupKeyFacet,i),m=o.getCurrentItemSetKey(e),g=e.demandItemFacet(h.spFolderItemSetKeyFacet,m)||v&&v.itemSetKey;if(!i||!m||!g)return null;var E=g.webAbsoluteUrl,S=g.listFullUrl,x=g.rootFolder;v&&(c=h.spItemKeyFacet.serialize({webAbsoluteUrl:E,listFullUrl:S,rootFolder:x}));var k=e.demandItemFacet(u.knockoutStoreItemFacet,c);if(!k)return null;return r.createElement(L,{item:k,onItemUploaded:function(e){return function(){var t,n=l(w.readItems(function(t){var n=t.demandItemFacet(b.createdItemFacet,e.progressItemKey);return n&&n.itemKey}));n&&v&&l(p.assignItemToGroup({items:(t={},t[n]={groupKey:i},t)})).then(function(){var e,t;l(d.refreshItemsInSet({items:(e={},e[m]=(t={},t[n]={},t),e)}))});s&&l(s(e))}},onUploadStarted:function(e){var t=e.progressItemKey;return function(){var r,s;l(y.resolveItems({items:(r={},r[i]=n.__assign({},T.activeUploadProjectionFoldersFacet.pack((s={},s[t]={},s))),r)}));a&&l(a(e))}},onUploadCompleted:function(e){var t=e.progressItemKey;return function(){var n,r;l(y.resolveItems({items:(n={},n[i]=N.pack({activeUploadProjectionFolders:T.activeUploadProjectionFoldersFacet},{activeUploadProjectionFolders:(r={},r[t]=new C.Delete,r)}),n)}));f&&l(f(e))}},webAbsoluteUrl:E,listFullUrl:S})})});
define("aSG",["require","exports","mU","f","Jy","BU","oJ","Zy","B8","ajg","Cs","ji","lD","n4","JK","sx","acc","aiZ","CO","aSJ","aSI","dh","iP","bc","mx","Kt","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=["Document","Folder"],k=(function(e){n.__extends(t,e);function t(t){var s=e.call(this,t)||this;s._renderAdvancedSettings=function(){var e=s.state.showAdvancedSettings;return r.createElement("div",null,s._renderAdvancedSettingsHeader(),e&&s._renderAdvancedSettingsContent())};s._toggleAdvancedSettings=function(){s.setState({showAdvancedSettings:!s.state.showAdvancedSettings})};s._renderAdvancedSettingsHeader=function(){var e=s.state.showAdvancedSettings;return r.createElement("div",{onClick:s._toggleAdvancedSettings,className:"advancedSettingsHeader"},r.createElement("div",{className:"advancedSettingsHeaderText"},b.default.AdvancedSettingsText),r.createElement(p.IconButton,{style:{fontSize:"13px",color:"black"},iconProps:{iconName:e?"ChevronUp":"ChevronDown"},title:b.default.AdvancedSettingsText,ariaLabel:b.default.AdvancedSettingsText}))};s._renderAdvancedSettingsContent=function(){return r.createElement("div",{className:"advancedSettingsExpandedMargin"},s._renderDescriptionText(),s._renderAssociatedContentTypeHeader(),s._renderChoiceGroup())};s._renderDescriptionText=function(){return r.createElement(g.Text,null," ",b.default.CreateModelInstructionText4)};s._renderAssociatedContentTypeHeader=function(){return r.createElement(l.Label,null,r.createElement(m.Stack,{horizontal:!0,verticalAlign:"center"},r.createElement("span",null,b.default.ContentTypeHeader," "),r.createElement(v.TooltipHost,{content:b.default.ContentTypeDescription,directionalHint:v.DirectionalHint.topCenter,styles:{root:{position:"relative",top:"-4px",left:"12px"}},componentRef:s._tooltipRef}),r.createElement("span",{className:"infoIcon"},r.createElement(c.Icon,{iconName:"info","aria-label":b.default.ContentTypeDescription,tabIndex:0,onClick:function(){var e;null===(e=s._tooltipRef.current)||void 0===e||e.show()},onFocus:function(){var e;null===(e=s._tooltipRef.current)||void 0===e||e.show()}}))))};s._renderChoiceGroup=function(){var e=[{key:"create",text:b.default.createContentType},{key:"select",text:b.default.selectContentType}];return r.createElement(i.ChoiceGroup,{options:e,onChange:s.onChoiceGroupSelectedChange,selectedKey:s.state.contentTypeSelected})};s.onMessageBarDismiss=function(){s.setState({isMessageBarHidden:!0})};s.onTextFieldChange=function(e,t){s.setState({modelName:t||"",classifierErrorMessage:"",isMessageBarHidden:!0})};s.onChoiceGroupSelectedChange=function(e,t){s.setState({contentTypeSelected:t.key,classifierSelected:"select"===t.key?{key:"",value:""}:s.state.classifierSelected,classifierErrorMessage:"",isMessageBarHidden:!0})};s._onDialogViewClicked=function(){return n.__awaiter(s,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,this._createOrReviewModel()];case 1:e.sent();return[2]}})})};s._onDialogCancelClicked=function(){s.setState({isDialogHidden:!0})};s.onDropdownSelectionChange=function(){return function(e,t,n,r){var i=t&&t.key||"",o=t&&t.text||r;s.setState({classifierSelected:{key:i,value:o},classifierErrorMessage:"",isMessageBarHidden:!0,modelName:o})}};s.onComboBoxSelectionChange=function(){return function(e,t,n,r){var i=t&&t.key||"",o=t&&t.text||r;s.setState({classifierSelected:{key:i,value:o}})}};s.onRenderFooterContent=function(){return r.createElement(r.Fragment,null,r.createElement(p.PrimaryButton,{onClick:s.onCreateClick,style:{marginRight:"8px"},disabled:s.state.isSaving},b.default.NextText),r.createElement(p.DefaultButton,{onClick:s.props.onDismiss},b.default.CancelText))};s.onCreateClick=function(){return n.__awaiter(s,void 0,void 0,function(){var e,t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:e=this.state,t=e.classifierSelected,r=e.contentTypeSelected,i=e.modelName;if(N.isFeatureEnabled(N.ContentCenterUIGAFeatures)&&"create"===r){t.key=i;t.value=i}if(""===t.value){this.setState({classifierErrorMessage:b.default.ClassifierNameInvalidText});return[2]}if(!N.isFeatureEnabled(N.ContentCenterUIGAFeatures)&&!T.default.isActivated("39a8e75d-c9a5-49df-96dd-955a423ea33f","02/06/2020","notDisplayingNewModelCreateError"))return[3,4];if(!(this._loadedContentTypes.filter(function(e){return e.name.toUpperCase()===t.value.toUpperCase()&&"Intelligent Document Content Types"===e.group}).length>0))return[3,1];this.setState({isDialogHidden:!1,isMessageBarHidden:!1});return[3,3];case 1:return[4,this._createOrReviewModel()];case 2:n.sent();n.label=3;case 3:return[3,6];case 4:return[4,this._createOrReviewModel()];case 5:n.sent();n.label=6;case 6:return[2]}})})};s._createOrReviewModel=function(){return n.__awaiter(s,void 0,void 0,function(){var e,t=this;return n.__generator(this,function(n){e=this.state.classifierSelected;this.setState({isSaving:!0});this._contentCenterDataSource.createOrUpdateModel(e.value,e.key,"","").then(function(e){t.setState({isSaving:!1});if(e.d.DriveId&&e.d.ObjectId){var n=e.d.UniqueId;t.props.onDismiss();t._contentCenterDataSource.navigateToModelHomePage(n);t.props.onComplete(!0)}else{x.default.log("[ccui] create or retrieve model failed, empty modelId");t.setState({classifierErrorMessage:b.default.EmptyModelPathErrorText})}}).catch(function(e){x.default.log("[ccui] create model api call failed "+e.message.value);t.setState({isSaving:!1,classifierErrorMessage:e.message.value});t.props.onComplete(!1)});return[2]})})};s.state={contentTypeSelected:"create",classifierErrorMessage:"",classfierDropdownOptions:[],classifierOptions:[],classifierSelected:{key:"",value:""},isLoading:!0,isSaving:!1,isDialogHidden:!0,isMessageBarHidden:!0,modelName:"",showAdvancedSettings:!1};s._contentCenterDataSource=s.props.resources.consume(w.resourceKey);s._pageContext=s.props.resources.consume(S.pageContext);s._tooltipRef=r.createRef();return s}t.prototype.componentDidMount=function(){var e=this;this._contentCenterDataSource.getSiteContentTypes(this._pageContext.webAbsoluteUrl,this._pageContext.webServerRelativeUrl,this._pageContext.siteId||"").then(function(t){if(N.isFeatureEnabled(N.ContentCenterUIGAFeatures)){var n=[];e._loadedContentTypes=t;(t=t.filter(function(e){return-1===C.indexOf(e.name)&&e.id.startsWith("0x0101")})).sort(function(e,t){return e.name.toUpperCase()>t.name.toUpperCase()?1:-1});t.forEach(function(e){n.push({key:e.id,text:e.name})});e.setState({classifierOptions:n,isLoading:!1})}else{var r=[];e._loadedContentTypes=t;(t=(t=t.filter(function(e){return-1===C.indexOf(e.name)})).filter(function(e){return"Intelligent Document Content Types"!==e.group})).sort(function(e,t){return e.name.toUpperCase()>t.name.toUpperCase()?1:-1});t.forEach(function(e){r.push({key:e.id,text:e.name})});e.setState({classifierOptions:r,isLoading:!1})}}).catch(function(t){x.default.log("[ccui] fetching content type failed "+t.message.value);e.setState({isLoading:!1})})};t.prototype.render=function(){var e=this.state,t=e.contentTypeSelected,n=e.classifierErrorMessage,i=e.classifierOptions,l=e.classifierSelected,c=e.isDialogHidden,v=e.isLoading,w=e.isSaving,S=e.isMessageBarHidden,x=e.modelName;return N.isFeatureEnabled(N.ContentCenterUIGAFeatures)?r.createElement(s.Panel,{closeButtonAriaLabel:b.default.CloseText,headerText:b.default.CreateModelHeader,isOpen:!0,isFooterAtBottom:!0,isLightDismiss:!0,onDismiss:this.props.onDismiss,onRenderFooterContent:this.onRenderFooterContent,type:s.PanelType.smallFixedFar},!S&&r.createElement("div",{className:"warningMassage"},r.createElement(d.MessageBar,{messageBarType:d.MessageBarType.warning,isMultiline:!0,onDismiss:this.onMessageBarDismiss,dismissButtonAriaLabel:b.default.CloseText},b.default.ContentTypeExistsMessageBarText1,r.createElement(h.Link,{onClick:this._createOrReviewModel},b.default.ContentTypeExistsMessageBarText2),b.default.ContentTypeExistsMessageBarText3)),r.createElement(m.Stack,{gap:20},r.createElement(m.Stack.Item,null,r.createElement(g.Text,null,b.default.CreateModelInstructionText3," ")),r.createElement(m.Stack.Item,{styles:{root:{marginBottom:"20px"}}},r.createElement(y.TextField,{ariaLabel:b.default.PlacerholderInput,errorMessage:"select"===t?"":n,placeholder:b.default.PlacerholderInput,value:x,disabled:"select"===t,label:b.default.ModelInputTextFieldLabel,onChange:this.onTextFieldChange})),r.createElement(m.Stack.Item,{className:"advancedSettingsContainer"},this._renderAdvancedSettings(),"select"===t&&this.state.showAdvancedSettings&&r.createElement(r.Fragment,null,r.createElement(u.Dropdown,{ariaLabel:b.default.selectContentTypeIndicator,className:"ContentCenterCreateModelPanel-dropdown",errorMessage:n,onChange:this.onDropdownSelectionChange(),options:i,placeholder:b.default.selectContentTypeIndicator}),v&&r.createElement(o.Spinner,{className:"spinner-topMargin",size:o.SpinnerSize.small,ariaLive:"assertive",labelPosition:"right",label:b.default.LoadingText}))),w&&r.createElement(m.Stack.Item,null,r.createElement(o.Spinner,{className:"spinner-topMargin",size:o.SpinnerSize.small,ariaLive:"assertive",ariaLabel:E.format(b.default.CreateNewModelArialabel,this.state.modelName),role:"status",labelPosition:"right",label:b.default.UpdatingModelFileText})))):r.createElement(s.Panel,{headerText:b.default.CreateModelHeaderText,isOpen:!0,isFooterAtBottom:!0,isLightDismiss:!0,onDismiss:this.props.onDismiss,onRenderFooterContent:this.onRenderFooterContent,type:s.PanelType.smallFixedFar},r.createElement("div",{className:"ContentCenterCreateModelPanel-bottomMargin"},r.createElement(f.ComboBox,{allowFreeform:!0,errorMessage:n,label:b.default.NameYourModelText,onChange:this.onComboBoxSelectionChange(),options:i,placeholder:b.default.PlacerholderText,required:!0,text:l.value})),v&&r.createElement(o.Spinner,{size:o.SpinnerSize.small,ariaLive:"assertive",labelPosition:"right",label:b.default.LoadingText}),w&&r.createElement(o.Spinner,{size:o.SpinnerSize.small,ariaLive:"assertive",labelPosition:"right",label:b.default.UpdatingModelFileText}),r.createElement(a.Dialog,{hidden:c,dialogContentProps:{type:a.DialogType.normal,title:b.default.ModelExistsDialogTitleText,subText:b.default.ModelExistsDialogContentText},modalProps:{isBlocking:!1,styles:{main:{maxWidth:250}}}},r.createElement(a.DialogFooter,null,r.createElement(p.PrimaryButton,{onClick:this._onDialogViewClicked},b.default.ViewModelButtonText),r.createElement(p.DefaultButton,{onClick:this._onDialogCancelClicked},b.default.CancelText))))};return t})(r.Component);t.default=k});
define("aSI",["require","exports","mU","PZ","Uh","hT","iP","aC","bu","GQ","bc"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,n.pageContext)||this;r.extractFileName=function(e){var t=e.split("/");return t[t.length-1]};r._apiUrlHelper=n.apiUrlHelper;r._navigation=n.navigation;r._pageContext=n.pageContext;return r}t.prototype.getWebFields=function(e){var t=e+"/_api/web/fields?$select=Id,Title&$filter=(Hidden eq false) and (ReadOnlyField eq false) and (TypeDisplayName ne 'Managed Metadata') and (Group ne '_Hidden')";return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getWebFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getSiteContentTypes=function(e,t,n,r){void 0===r&&(r="Intelligent Document Content Types");var i=e.substr(0,e.indexOf(t)),s=i.replace("https://",""),o=i+"/_api/V2.0/sites/"+s+","+(n=n.replace("{","").replace("}",""))+"/ContentTypes";return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){var t=JSON.parse(e).value;r&&(t=t.filter(function(e){return e.group===r}));return t},qosName:"getSiteContentTypes",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getColumnsForSiteContentType=function(e,t,n,r){var i=e.substr(0,e.indexOf(t)),s=i.replace("https://",""),o=i+"/_api/V2.0/sites/"+s+","+(n=n.replace("{","").replace("}",""))+"/ContentTypes/"+r+"/columnLinks";return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){return JSON.parse(e).value.map(function(e){return a.default.normalizeLower(e.id)})},qosName:"getColumnsForSiteContentType",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.runModel=function(e){var t=this._apiUrlHelper.build().segment("machinelearning").segment("workItems");return this.runModelBatchRequest(t.toString(),function(e){return e},"runModel",function(){return e})};t.prototype.createOrUpdateModel=function(e,t,n,r,i){void 0===i&&(i="Intelligent Document Content Types");var s={__metadata:{type:"Microsoft.Office.Server.ContentCenter.SPMachineLearningModelEntityData"},ColumnId:r,ColumnName:n,ContentTypeGroup:i,ContentTypeId:t,ContentTypeName:e,Schemas:""},o=this._apiUrlHelper.build().segment("machinelearning").segment("models");return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"createContentTypeAndModel",additionalPostData:JSON.stringify(s),method:"POST"})};t.prototype.navigateToTrainingPage=function(e){var t=[];t.push(this._pageContext.webAbsoluteUrl);t.push(this._pageContext.layoutsUrl);t.push("training.aspx");var n=t.join("/")+e;this._navigation.navigateTo(n)};t.prototype.navigateToModelHomePage=function(e){var t="?v=modelHome&modelUniqueId="+e,n=[];n.push(this._pageContext.webAbsoluteUrl);n.push(this._pageContext.layoutsUrl);n.push("training.aspx");var r=n.join("/")+t;this._navigation.navigateTo({url:r,frameId:"_blank"})};t.prototype.runModelBatchRequest=function(e,t,n,r){var i=this;if(!r)return Promise.reject("failed");for(var s=a.default.generate(),o="multipart/mixed; boundary=batch_"+s,u=[],c=Math.ceil(r().length/30),h=0;h<c;h++){var p=r().slice(30*h,30*(h+1)),d=this.getConvertedData(p,e,s);u.push(this.dataRequestor.getData({url:f.DataBatchOperationHelper.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:t,qosName:this.getDataSourceName()+"."+n,additionalPostData:d,method:"POST",contentType:o}).then(function(e){return f.DataBatchOperationHelper.getBatchResponseText(e)}).catch(function(e){var t,n;l.default.log("[ccui] fetching content type failed "+(null===(n=null===(t=e)||void 0===t?void 0:t.message)||void 0===n?void 0:n.value));Promise.reject(e)}))}return Promise.all(u).then(function(e){var t=[].concat.apply([],e);return new Set(t.map(function(e){var t,n,r,s;if((null===(n=null===(t=e=JSON.parse(e))||void 0===t?void 0:t.d)||void 0===n?void 0:n.Created)&&(null===(s=null===(r=e)||void 0===r?void 0:r.d)||void 0===s?void 0:s.TargetServerRelativeUrl))return i.extractFileName(e.d.TargetServerRelativeUrl)}))})};t.prototype.getConvertedData=function(e,t,n){void 0===t&&(t="");void 0===n&&(n="");if(!e)return e;var r=f.DataBatchOperationHelper.defaultBatchAcceptData,i=[],s=[],o=[],u=f.DataBatchOperationHelper.defaultBatchRequestPostData,a=1;e.forEach(function(e){o.push(""+a++);i.push(t);s.push(JSON.stringify(e))});return f.DataBatchOperationHelper.getBatchContentExtended(n,i,"POST",u,s,r)};t.dependencies={pageContext:o.pageContext,apiUrlHelper:r.resourceKey,navigation:u.navigation};return t})(i.default);t.default=c;t.resourceKey=s.createResolvedResourceKey(e("module").id,c)});
define("aSK",["require","exports","mU","f","dM","ab0","BU","JK","aA7","QM","Um","iU","d0","mJ","iQ","aSM","dh","lD","aY","mx","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.learnMore_link=r.createElement(g.Link,{key:"learn_more_link",href:"https://go.microsoft.com/fwlink/?linkid=2112547",target:"_blank"},v.default.LearnMore);n._onChange=function(e,t){n._webDataSource.setSchedulingFeature(t).then(function(e){n.setState({schedulingOn:e.isFeatureActivated});var r=n._resources.consume(h.resourceKey).getUrlParts({}),i=c.spPageContextKeyFacet.serialize({webAbsoluteUrl:n.props.pageContext.webAbsoluteUrl,listFullUrl:r.fullListUrl}),s=n._getUpdatedPageContext(t);if(s){n._resources.consumeAsync(p.resourceKey).then(function(e){e.dispatch(d.updatePageContext({itemKey:i,options:{pageContext:s}}))});if(!b.default.isActivated("f08f5202-8ed8-49bf-8d00-c5504a67dbb0","4/16/2020","use clearPageCache when scheduling is toggled")){var o=n._resources.consume(y.resourceKey);o.clearPageCache&&o.clearPageCache()}}},function(e){n._operation.state(f.default.failed);n._operation.error(new l.default({message:"Error",payloads:e}))})};n._onDismiss=function(){n.setState({isOpen:!1})};n._resources=n.props.resources;n._webDataSource=n._resources.consume(a.resourceKey);n.state={schedulingOn:n._isSchedulingTurnedOn(n.props.pageContext&&n.props.pageContext.featureInfo),isOpen:!0};n.message=m.formatToArray(v.default.SchedulingDescription,n.learnMore_link);return n}t.prototype.render=function(){return r.createElement(o.Panel,{"data-automationid":"SchedulingPanel",isOpen:this.state.isOpen,type:o.PanelType.smallFixedFar,headerText:v.default.Scheduling,isLightDismiss:!0,onDismiss:this._onDismiss,closeButtonAriaLabel:v.default.SchedulingPanelCloseLabel},r.createElement("div",null,this.message),r.createElement(s.Toggle,{className:"SchedulingComponentToggle-topPadding",label:v.default.EnableScheduling,checked:this.state.schedulingOn,onChange:this._onChange,onText:v.default.SchedulingOnToggleText,offText:v.default.SchedulingOffToggleText}),r.createElement("div",null,this.state.schedulingOn&&r.createElement(u.MessageBar,{ariaLabel:v.default.DisableSchedulingWarning,messageBarType:u.MessageBarType.warning},v.default.DisableSchedulingWarning)))};t.prototype._getUpdatedPageContext=function(e){if(this.props.pageContext&&this.props.pageContext.featureInfo){var t=n.__assign({},this.props.pageContext.featureInfo);t.SitePagesScheduling.Enabled=e;return n.__assign(n.__assign({},this.props.pageContext),{featureInfo:t})}};t.prototype._isSchedulingTurnedOn=function(e){if(!e)return!1;var t=new i.default(e);if(t){var n=t.get("SitePagesScheduling");return!!n&&n.enabled}return!1};return t})(r.PureComponent);t.SchedulingComponent=w});
define("aSN",["require","exports","mU","f","nO","cO","sn","aAx","o1","Ox","hT","akq","Kl","a6","axY","aAE","dX","mD","aSQ","aSP","iN","bv","S9","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S={commands:[],farCommands:[],overflowCommands:[]},x=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._itemsCommandBarControlHandler=function(e,t){var n=t.itemKey;if(!e.isItemFacetResolved(E.displayNameFacet,n))return S;var r=e.demandItemFacet(b.extendedCommandBarControl,w.odspNextAppItemKey);return r?b.extendedCommandBarControl.evaluate(r)(e,t):S};r._scope=new p.default;var i=r._scope.attach(new(r.context.dependencies.resources.injected(c.default))({renderLabel:1})).command;r._observables=r._scope.attach(new r.context.dependencies.observablesFactoryType({owner:r}));r._reactCommandManager=r._scope.attach(new r.context.dependencies.reactCommandManagerType({commandSet:{commands:r._observables.createArray([i])}}));r.state={farItems:r._reactCommandManager.commandBarItems.peek().farItems};r._itemsScopeManager=n.dependencies.itemsScopeManager;r._controlHandlers=o.itemsCommandBarControl.pack(r._itemsCommandBarControlHandler);return r}t.prototype.componentDidMount=function(){var e=this;this._observables.subscribe(this._reactCommandManager.commandBarItems,function(t){e.setState({farItems:n.__spreadArrays(t.farItems)})});this.props.handleRenderComplete(m.now(),this._itemsScopeManager)};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.render=function(){var e=this.context.dependencies,t=e.currentItemsScope,n=e.actionControlHandlers,o=this.state.farItems,u=r.createElement(n,null,r.createElement(s.ControlHandlerProvider,{controlHandlers:this._controlHandlers},r.createElement(t,null,r.createElement("div",{style:{display:"flex"}},r.createElement("div",{style:{display:"block",width:"100%"}},r.createElement(i.ItemsCommandBar,{farItems:o}))))));return r.createElement(a.Fabric,null,u)};t.contextTypes=f.RESOLVED_COMPONENT_CONTEXT_TYPES;return t})(r.PureComponent);t.ItemsScopeCommandBar=x;t.resourceKey=f.createResolvedComponentTypeResourceKey(e("module").id,x,{resources:l.resourceScopeKey,observablesFactoryType:h.observablesFactoryTypeResourceKey,reactCommandManagerType:d.typeResourceKey,currentItemsScope:v.resourceKey.local,itemsScopeManager:g.resourceKey,actionControlHandlers:y.resourceKey});t.knockoutResourceKey=u.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-scope-command-bar",name:e("module").id+".knockout"})});
define("aSQ",["require","exports","mU","cO","Ox","f","aSR"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=r.context.dependencies;r._controlHandlers=i.controlHandlers;return r}t.prototype.render=function(){return s.createElement(r.ControlHandlerProvider,{controlHandlers:this._controlHandlers},this.props.children)};t.contextTypes=i.RESOLVED_COMPONENT_CONTEXT_TYPES;return t})(s.Component);t.ActionControlHandlers=u;t.resourceKey=i.createResolvedComponentTypeResourceKey(e("module").id,u,{controlHandlers:o.resourceKey})});
define("aSR",["require","exports","mU","aO6","LJ","LH","zF","vh","vc","ow","wS","hs","vd","rh","ve","hT","wP","vf","aSX","fi","bs","aSU","aP","aST","aSS","aQ"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C={defaultClickActionControlHandler:S.defaultClickHandler,openActionControlHandler:x.resourceKey,downloadItemsActionControlHandler:w.resourceKey,openInOfficeOnlineActionControlHandler:T.resourceKey,itemEngagementControlHandler:N.resourceKey,uploadItemsActionControlHandler:S.uploadItemsAction.optional,sharedFieldClickActionControlHandler:S.sharedFieldClickAction.optional,itemExecuteFlowActionControlHandler:S.itemExecuteFlowAction.optional,itemEditPropsActionControlHandler:S.itemEditPropsAction.optional,followActionControlHandler:E.resourceKey.optional,createListItemActionControlHandler:S.createListItemAction.optional,syncActionControlHandler:y.asyncSyncActionControlHandlerKey,asyncSwitchLayoutActionControlHandler:y.asyncSwitchLayoutActionControlHandlerKey,hoverCardCommandsControlHandler:S.hoverCardCommands.optional,asyncMoveCopyActionControlHandler:y.asyncMoveCopyActionControlHandlerKey.optional};t.resourceKey=new v.ResourceKey({name:e("module").id,factory:{dependencies:C,create:function(e){return{instance:n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},c.openActionControl.pack(e.openActionControlHandler)),u.defaultClickActionControl.pack(e.defaultClickActionControlHandler)),a.downloadItemsActionControlFacet.pack(e.downloadItemsActionControlHandler)),d.uploadItemsActionControl.pack(e.uploadItemsActionControlHandler)),o.openInOfficeOnlineActionControl.pack(e.openInOfficeOnlineActionControlHandler)),b.itemEngagementControl.pack(e.itemEngagementControlHandler)),h.sharedFieldClickActionControl.pack(e.sharedFieldClickActionControlHandler)),s.itemExecuteFlowActionControl.pack(e.itemExecuteFlowActionControlHandler)),i.itemEditPropsActionControl.pack(e.itemEditPropsActionControlHandler)),f.followItemActionControl.pack(e.followActionControlHandler)),r.createListItemActionControl.pack(e.createListItemActionControlHandler)),l.itemSyncControl.pack(e.syncActionControlHandler)),p.switchLayoutActionControl.pack(e.asyncSwitchLayoutActionControlHandler)),m.hoverCardCommandsControl.pack(e.hoverCardCommandsControlHandler)),g.moveCopyActionControl.pack(e.asyncMoveCopyActionControlHandler))}}}})});
define("aSX",["require","exports","e3","Ox","hT","mJ","aP"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createAsyncControlHandlerResourceKey=function(e){return new r.ResourceKey({name:e.name+".async",factory:{dependencies:{resources:i.resourceScopeKey,itemCacheStore:s.resourceKey},create:function(t){var r=t.resources,i=t.itemCacheStore;return{instance:r.isDefined(e)?i.dispatch(n.asAsyncControlHandler(function(){return r.consumeAsync(e)})):void 0}}}}).local};t.asyncSyncActionControlHandlerKey=t.createAsyncControlHandlerResourceKey(o.syncAction);t.asyncSwitchLayoutActionControlHandlerKey=t.createAsyncControlHandlerResourceKey(o.switchLayoutAction);t.asyncMoveCopyActionControlHandlerKey=t.createAsyncControlHandlerResourceKey(o.moveCopyAction)});
define("aSU",["require","exports","hT","aSW","aSV","cv"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{resources:n.resourceScopeKey},create:function(e){var t=e.resources;return{instance:function(e,n){return{onFollow:function(){return function(e){e(s.readItems(function(e){return i.hasNoSavedItemsForLater(e)}))&&t.consumeAsync(r.hasFollowedAnItemKey).then(function(e){e(!0)})}}}}}}}})});
define("aSW",["require","exports","hT"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hasFollowedAnItemKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["ako"],t,n)}).then(function(e){return e.hasFollowedAnItemKey})})})});
define("aSV",["require","exports","iN","en","cu"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hasNoSavedItemsForLater=function(e){var t=e.demandItemFacet(n.defaultGraphEndpointFacet,n.odspNextAppItemKey),s=t&&r.savedForLaterRootItemKeyFacet.serialize({endpoint:t}),o=e.demandItemFacet(i.defaultChildItemSetFacet,s),u=o&&o.itemKey,a=e.demandItemFacet(i.childItemsFacet,u),f=a&&a.itemKeys;return!!f&&0===f.length}});
define("aST",["require","exports","mU","hT","eQ","aR","iN","cv","aC","mF","aM","eo","mG","mx","eH"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v={resourceScope:r.resourceScopeKey,navigation:a.navigation};t.resourceKey=new r.ResourceKey({name:e("module").id,factory:{dependencies:v,create:function(e){return{instance:m(e)}}}});function m(t){var r=this,a=t.resourceScope,v=t.navigation;return function(t,m){var g=m.openItem;return{openItem:function(t){var m=t.currentItemKey,y=t.itemsScopeItemKey;return function(b){return n.__awaiter(r,void 0,void 0,function(){var r,w,E,S,x,T,N,C,k=this;return n.__generator(this,function(L){switch(L.label){case 0:if(!(r=b(u.readItems(function(e){var t=e.demandItemFacet(s.currentViewParamsFacet,y),n=e.demandItemFacet(i.itemKeyToStoreKeyControl,o.odspNextAppItemKey);return i.itemKeyToStoreKeyControl.evaluate(n)(e,{itemKey:m,viewParams:t||{}})})).storeKey)||!r.key)return[3,5];w=r.viewParams;return p.default.isActivated("E3BC5253-7975-44D7-9B27-986192109612","1/29/2020","Use KnockoutStoreItemFacet to obtain item data for default click")?[3,2]:[4,Promise.all([n.__awaiter(k,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["h7"],t,n)})];case 1:t=n.sent().demandItems;return[2,b(t(function(e){return e.demandItemFacet(h.knockoutStoreItemFacet,d.getItemKey(e,{itemKey:m}))}))]}})}),a.consumeAsync(l.url)])];case 1:E=L.sent(),S=E[0],T=E[1];if(S){N=S.peek();C=T.getDefaultClickUrl(N,{viewParams:w});v.navigateTo({url:C})}return[3,4];case 2:return[4,a.load({itemProvider:f.resourceKey,urlDataSource:l.url})];case 3:L.sent();x=a.consume(f.resourceKey);T=a.consume(l.url);N=x.getItemSync({parentKey:r.key,ignoreChildren:!0}).item;C=T.getDefaultClickUrl(N.peek(),{viewParams:w});v.navigateTo({url:C});L.label=4;case 4:return[3,6];case 5:if(g){b(c.loadRequiredAddon(t));b(g(t))}L.label=6;case 6:return[2]}})})}}}}}});
define("aSS",["require","exports","hT","bU","mx"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{},create:function(e){return{instance:function(e,t){return!i.default.isActivated("B879845E-BDDE-49F3-B911-820CAF3529CA","6/10/2019","Teams open Office document in same window")&&r.isTeamsWebView()?{forceInSameWindow:!0}:{}}}}}})});
define("aSP",["require","exports","aU"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.extendedCommandBarControl=new n.ControlFacet("extendedCommandBar")});
define("aSY",["require","exports","mU","f","cM","bw","cv","bv","c6","Xh"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DesktopAppDownloader=function(e){var t=this,l=e.resolve,c=e.reject,h=i.useItemCacheDispatch(),p=s.useResourceScope();r.useLayoutEffect(function(){n.__awaiter(t,void 0,void 0,function(){var t,r,i,s,d,v;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,e.getDownloadData()];case 1:t=n.sent();r=e.itemKeys[0];i=h(o.readItems(function(e){return e.demandItemFacet(u.displayNameFacet,r)}));return[4,p.consumeAsync(a.resourceKey)];case 2:s=n.sent();d={command:"Download",type:f.WinAppDownloadType.DownloadSingleFile,downloadUrl:t.url,zipFileName:i,postBody:JSON.stringify({})};if("POST"===t.method){d.postBody=JSON.stringify({request:t.postData});d.zipFileName=t.postData.zipFileName;d.type=f.WinAppDownloadType.DownloadMultiFile}s.sendCommand({command:JSON.stringify({DownloadCommand:d})});l();return[3,4];case 3:v=n.sent();c(v);return[3,4];case 4:return[2]}})})},[]);return null}});
define("aSZ",["require","exports","mU","f","cv","aV","Mw","Kt","cM","bw"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DownloaderWithRecents=function(e){var t=this,l=e.defaultRender,c=n.__rest(e,["defaultRender"]),h=e.itemKeys,p=a.useItemCacheDispatch(),d=f.useResourceScope();r.useLayoutEffect(function(){if(u.isFeatureEnabled(u.WriteMruSignalWhenMediaDownloaded)){var e=p(i.readItems(function(e){return h.map(function(t){return e.demandItemFacet(o.oneDriveItemFacet,t)})}));n.__awaiter(t,void 0,void 0,function(){var t,r,i,o,u;return n.__generator(this,function(n){switch(n.label){case 0:return[4,d.consumeAsync(s.mruRecent.optional)];case 1:if(!(t=n.sent()))return[3,3];r=[];for(i=0,o=e;i<o.length;i++)(u=o[i])&&r.push(t.recordDocumentView(u));return[4,Promise.all(r)];case 2:n.sent();n.label=3;case 3:return[2]}})})}},[]);return l?r.createElement(l,n.__assign({},c)):null}});
define("aS0",["require","exports","mU","aTd","rV","r8","rx","F3","FW","e3","w5","aS2","Kt","an","MH","iU","cZ","i1","aS1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.extendedItemsContextMenuControlHandler=f.createControlHandler()(function(){return function(e){return b}});function b(e,t){var f=0,b=t.itemKey,w=e.demandItemFacet(v.spItemKeyFacet,b),E=e.demandItemFacet(m.SharedByMeRootItemKeyFacet,b);if(w){var S={webAbsoluteUrl:"",listFullUrl:""};w&&(S={webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl});var x=v.spListKeyFacet.serialize(S),T=e.demandItemFacet(g.listFacet,x),N=!!T&&!T.isDocumentLibrary,C=!1,k=!1;if(T){C=T.templateType===p.default.publishingAsset;k=T.templateType===p.default.mySiteDocumentLibrary}var L=e.demandItemFacet(g.spPageContextFacet,v.spPageContextKeyFacet.serialize({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl})),A=l.isCrossOrigin(),O=c.getFlowCommand(e,b),M=L&&T&&h.isFeatureEnabled(h.WexSitePagesContentApproval)&&T.templateType===p.default.webPageLibrary&&T.isModerated,_=M?n.__assign(n.__assign({},r.approveRejectCommand),{name:d.default.ReviewApprovals}):r.approveRejectCommand,D=M?n.__assign(n.__assign({},r.PublishCommand),{name:d.default.Submit}):r.PublishCommand,P=y.isManageAccessItemsScopeOn();return N?{contextMenuOverride:[{command:i.copyLinkCommand,followupCommands:P?[r.copyFieldCommand,r.ManageAccessCommand,y.divider(f++)]:[r.copyFieldCommand,y.divider(f++)]},{command:o.deleteCommand,followupCommands:O?[O,y.divider(f++)]:[y.divider(f++)]},{command:a.MoreCommands,beforeCommands:A?[r.moveToCommand,y.divider(f++),r.versionHistoryCommand]:[r.moveToCommand,y.divider(f++),r.captureVersionCommand,r.versionHistoryCommand,r.alertMeCommand],beforeChildrenCommands:[r.WorkflowCommand,r.ComplianceDetailsCommand],followupChildrenCommands:n.__spreadArrays(h.isFeatureEnabled(h.BulkApproveReject)?[]:[_])},{command:null,followupCommands:[y.divider(f++),r.detailsMenuCommand],bottomCommand:!0},{command:null,followupCommands:[r.ViewItemCommand,r.EditItemCommand],topCommand:!0}]}:k?{contextMenuOverride:[{command:o.deleteCommand,followupCommands:[r.moveToCommand,r.copyToCommand]},{command:i.copyLinkCommand,followupCommands:P?[r.FileRequestCommand,r.ManageAccessCommand,y.divider(f++)]:[r.FileRequestCommand,y.divider(f++)]},{command:a.MoreCommands,beforeCommands:n.__spreadArrays([y.divider(f++)],O?[O]:[],[r.versionHistoryCommand]),beforeChildrenCommands:[r.WorkflowCommand,r.ComplianceDetailsCommand],followupChildrenCommands:n.__spreadArrays(C?[r.EditRenditionsCommand]:[],[D,r.UnPublishCommand,r.CancelPublishCommand])},{command:null,followupCommands:[y.divider(f++),r.detailsMenuCommand],bottomCommand:!0},{command:s.openCommand,followupCommands:[r.previewCommand],topCommand:!0}]}:{contextMenuOverride:[{command:u.editPinnedItemCommand,followupCommands:n.__spreadArrays([r.moveToCommand,r.copyToCommand],h.isFeatureEnabled(h.SPBulkEditItemCommand)?[r.bulkEditDocumentPropertyCommand]:[])},{command:i.copyLinkCommand,followupCommands:P?[r.ManageAccessCommand,y.divider(f++)]:[y.divider(f++)]},{command:o.deleteCommand,followupCommands:O?[O,y.divider(f++)]:[y.divider(f++)]},{command:a.MoreCommands,beforeCommands:A?[y.divider(f++),r.versionHistoryCommand,r.makeHomePageCommand]:[y.divider(f++),r.captureVersionCommand,r.versionHistoryCommand,r.alertMeCommand,r.makeHomePageCommand],beforeChildrenCommands:[r.ViewDocumentPropertyCommand,r.WorkflowCommand,r.ComplianceDetailsCommand],followupChildrenCommands:n.__spreadArrays(C?[r.EditRenditionsCommand]:[],[D,r.UnPublishCommand,r.CancelPublishCommand],h.isFeatureEnabled(h.BulkApproveReject)?[]:[_])},{command:null,followupCommands:[y.divider(f++),r.detailsMenuCommand],bottomCommand:!0},{command:s.openCommand,followupCommands:[r.previewCommand],topCommand:!0}]}}return E?{contextMenuOverride:[{command:s.openCommand,followupCommands:[r.previewCommand],topCommand:!0},{command:i.copyLinkCommand,followupCommands:[y.divider(f++)]},{command:null,followupCommands:[y.divider(f++),r.detailsMenuCommand],bottomCommand:!0}]}:{contextMenuOverride:void 0}}});
define("aTd",["require","exports","mU","f","MH","H","ra","aUw","aUv","aUu","aUt","aUs","aUr","aUq","aUp","aUo","aUn","aUm","aUl","aUj","aUi","aUh","aUg","Fk","sd","aUf","r","YW","si","rN","r8","aT5","aT3","aT2","aT0","aTX","aTW","aTV","aTT","aTJ","aTH","aTF","aTD","aTC","aTB","aTA","aTz","aTy","aTx","aTv","aTt","aTr","aTp","aTn","aTl","aTk","aTi","aTg","aTe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var se={iconName:void 0,styles:{root:{display:"none!important"}}};t.alertMeCommand=M.alertMeCommand;t.manageAlertCommand=M.manageAlertCommand;t.versionHistoryCommand=M.versionHistoryCommand;t.powerAppsCommand=M.powerAppsCommand;t.aibuilderCommand=M.aibuilderCommand;t.captureVersionCommand=_.captureVersionCommand;t.detailsCommand=D.detailsCommand;t.detailsMenuCommand=P.detailsMenuCommand;t.filtersPaneCommand=H.filtersPaneCommand;t.moveToCommand=B.moveToCommand;t.copyToCommand=j.copyToCommand;t.runModelCommand=F.runModelCommand;t.fullscreenCommand=I.fullscreenCommand;t.addToOneDriveCommand=q.addToOneDriveCommand;t.quickEditCommand=R.quickEditCommand;t.cancelEditCommand=U.cancelEditCommand;t.copyFieldCommand={key:new s.Facet("CopyField").id,name:i.default.CopyField,action:r.createElement(y.CopyFieldAction,null),hasLaunchTarget:!0};t.EditItemCommand={key:new s.Facet("EditProperties").id,name:i.default.editProperties,action:r.createElement(y.EditItemAction,null),iconProps:{iconName:"Edit"},automationId:"editProperties"};t.ViewItemCommand={key:new s.Facet("ViewProperties").id,name:i.default.Open,action:r.createElement(y.ViewItemAction,null)};t.bulkEditDocumentPropertyCommand={key:new s.Facet("bulkEditDocumentProperties").id,name:i.default.viewProperties,action:r.createElement(y.EditItemAction,null),iconProps:{iconName:"Edit"}};t.ViewDocumentPropertyCommand={key:new s.Facet("ViewProperties").id,name:i.default.viewProperties,action:r.createElement(y.ViewItemAction,null),iconProps:{iconName:"Edit"}};t.makeHomePageCommand={key:new s.Facet("MakeHomePage").id,name:i.default.MakeHomepage,action:r.createElement(h.MakeHomePageAction,null),iconProps:{iconName:"Home"}};t.rotateCommand={key:new s.Facet("rotate").id,name:i.default.rotate,action:r.createElement(p.RotateAction,null),iconProps:{iconName:"rotate"}};t.orderPrintsCommand={key:new s.Facet("orderPrints").id,name:i.default.OrderPrints,action:r.createElement(d.OrderPrintsAction,null),iconProps:{iconName:"Print"}};t.embedCommand={key:new s.Facet("embed").id,automationId:"embed",name:i.default.Embed,action:r.createElement(v.EmbedAction,null),iconProps:{iconName:"Embed"}};t.createMountPointCommand={key:new s.Facet("createMountPoint").id,automationId:"createMountPoint",name:i.default.CreateMountPoint,action:r.createElement(w.CreateMountPointAction,null),iconProps:{iconName:"OneDriveAdd"}};t.removeMountPointCommand={key:new s.Facet("removeMountPoint").id,name:i.default.RemoveMountPoint,action:r.createElement(w.RemoveMountPointAction,null),iconProps:{iconName:"Cancel"}};t.reportAbuseCommand={key:new s.Facet("reportAbuse").id,name:i.default.reportAbuse,action:r.createElement(c.ReportAbuseAction,null),iconProps:{iconName:"EditNote"}};t.approveRejectCommand={key:new s.Facet("ApproveReject").id,name:i.default.ApproveReject,action:r.createElement(S.ApproveRejectAction,null),iconProps:se};t.previewCommand=z.previewCommand;t.WorkflowCommand=W.workflowCommand;t.ComplianceDetailsCommand=X.complianceDetailsCommand;t.EditRenditionsCommand={key:new s.Facet("EditRenditions").id,name:i.default.EditRenditions,action:r.createElement(b.EditRenditionsAction,null)};t.PublishCommand=V.publishCommand;t.UnPublishCommand=$.unPublishCommand;t.CancelPublishCommand=J.cancelPublishCommand;t.CreateShortcutCommand=K.createShortcutCommand;t.createWordCommand={key:new s.Facet("createWord").id,automationId:"createWordCommand",name:L.default.CreateWord,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateWordAction,null)),iconProps:T.getCommandIconProps({extension:"docx",size:16})};t.createExcelCommand={key:new s.Facet("createExcel").id,automationId:"createExcelCommand",name:L.default.CreateExcel,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateExcelAction,null)),iconProps:T.getCommandIconProps({extension:"xlsx",size:16})};t.createPowerPointCommand={key:new s.Facet("createPowerPoint").id,automationId:"createPowerPointCommand",name:L.default.CreatePowerPoint,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreatePowerPointAction,null)),iconProps:T.getCommandIconProps({extension:"pptx",size:16})};t.createOneNoteCommand={key:new s.Facet("createOneNote").id,automationId:"createOneNoteCommand",name:L.default.CreateOneNote,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateOneNoteAction,null)),iconProps:T.getCommandIconProps({extension:"onetoc",size:16})};t.createExcelSurveyCommand={key:new s.Facet("createExcelSurvey").id,automationId:"createExcelSurveyCommand",name:L.default.CreateExcelSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateExcelSurveyAction,null)),iconProps:T.getCommandIconProps({extension:"xlsx",size:16})};t.createTextFileCommand={key:new s.Facet("createTextFile").id,name:i.default.CreateText,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateTextFileAction,null)),iconProps:T.getCommandIconProps({extension:"txt",size:16})};t.shareSurveyCommand={key:new s.Facet("shareSurvey").id,name:i.default.shareSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(m.ShareSurveyAction,null)),iconProps:se};t.viewSurveyCommand={key:new s.Facet("viewSurvey").id,name:i.default.viewSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(m.ViewSurveyAction,null)),iconProps:se};t.editSurveyCommand={key:new s.Facet("editSurvey").id,name:i.default.editSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(m.EditSurveyAction,null)),iconProps:se};t.surveyCommand={key:new s.Facet("survey").id,name:"Survey",subMenuProps:{items:[t.shareSurveyCommand,t.viewSurveyCommand,t.editSurveyCommand]},iconProps:se};t.OpenInPowerBICommand=Q.openInPowerBICommand;t.AddToQuickLaunchCommand={key:new s.Facet("AddToQuickLaunch").id,name:i.default.AddToQuickLaunch,action:r.createElement(a.AddToQuickLaunch,null),iconProps:{iconName:"Pin"}};t.OpenInTextEditorCommand=G.openInTextEditorCommand;t.OpenInExplorerCommand=Y.openInExplorerCommand;t.OpenInSharePointCommand=Z.openInSharePointCommand;t.openInOfficeOnlineCommand={key:new s.Facet("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",name:"##Localized_OpenInOfficeOnline##",action:r.createElement(f.OpenInOfficeOnlineAction,null),facets:n.__assign({},A.isReadonlyFacet.pack(!0))};t.openInOfficeClientCommand={key:new s.Facet("openInOfficeClient").id,automationId:"openInOfficeClientCommand",name:"##Localized_OpenInOfficeClient##",action:r.createElement(l.OpenInOfficeClientAction,null),facets:n.__assign({},A.isReadonlyFacet.pack(!0))};t.openFileCommand={key:O.openCommand.key,automationId:O.openCommand.automationId,name:"##Localized_Open##",subMenuProps:{items:[t.openInOfficeOnlineCommand,t.openInOfficeClientCommand]},facets:n.__assign({},A.isReadonlyFacet.pack(!0))};t.launchFormatViewPaneCommand={key:new s.Facet("LaunchFormatViewPane").id,name:i.default.FormatView,action:r.createElement(o.HideWithSelection,null,r.createElement(E.LaunchFormatViewPaneAction,null)),iconProps:se,automationId:"launchFormatViewPaneCommand"};t.EditNewMenuCommand={key:x.editNewMenuKey,name:i.default.editNewMenu,action:r.createElement(o.HideWithSelection,null,r.createElement(u.EditNewMenuAction,null)),iconProps:{iconName:"Edit"}};t.TeamChannelCommand=ee.teamChannelCommand;t.UploadFileCommand=te.uploadFileCommand;t.UploadFolderCommand=ne.uploadFolderCommand;t.FileRequestCommand=re.fileRequestCommand;t.ManageAccessCommand=ie.manageAccessCommand;t.NavigateToSharedWithMeCommand={key:new s.Facet("NavigateToSharedWithMe").id,name:k.isShareByWithYouEnabled()?i.default.SharedWithYou:i.default.SharedWithMe,action:r.createElement(N.NavigateToQueryRootAction,{queryType:C.default.SharedWithMe}),isPermanent:!0};t.NavigateToSharedByMeCommand={key:new s.Facet("NavigateToSharedByMe").id,name:k.isShareByWithYouEnabled()?i.default.SharedByYou:i.default.SharedByMe,action:r.createElement(N.NavigateToQueryRootAction,{queryType:C.default.SharedByMe}),isPermanent:!0}});
define("aUw",["require","exports","mU","cx","fl","aS","cw","i1","aR","Kt","ex","iU","i1","an"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditNewMenuAction=i.withCurrentItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRU"],t,n)})];case 1:return[2,t.sent().EditNewMenuAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(c.spItemKeyFacet,n),i=r&&e.demandItemFacet(h.listFacet,c.spListKeyFacet.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl})),d=l.getPageContextFromItemCache(e,n),v=e.demandItemFacet(u.permissionsFacet,n),m=o.default.hasItemPermission({permissions:v},o.default.editListItems),g=s.getItemsScope(e).itemsScopeItemKey,y=e.demandItemFacet(a.currentViewParamsFacet,g);return f.isFeatureEnabled(f.NewDocumentTemplates)&&!!d&&!d.isAnonymousGuestUser&&!(y&&y.q)&&m&&!(i&&i.templateType===p.ListTemplateType.webPageLibrary)}return!1}))});
define("aUv",["require","exports","mU","cx","fl","bv","i1","iU"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddToQuickLaunch=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRE"],t,n)})];case 1:return[2,t.sent().AddToQuickLaunchAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(s.fileNameFacet,n),i=e.demandItemFacet(o.officeAppFacet,n),a=e.demandItemFacet(u.spItemKeyFacet,n);return!!r&&".aspx"===r.extension&&!i&&!!a&&-1!==a.listFullUrl.toLowerCase().indexOf("sitepages")}return!1})))});
define("aUu",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInOfficeOnlineAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInOfficeOnlineAction))})});
define("aUt",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInOfficeClientAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInOfficeClientAction))})});
define("aUs",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ReportAbuseAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ReportAbuseAction))})});
define("aUr",["require","exports","mU","cx","bv","fl","i1","an","cw","iU"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MakeHomePageAction=s.withSelectedItems()(s.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRQ"],t,n)})];case 1:return[2,t.sent().MakeHomePageAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(f.spItemKeyFacet,n),s=r&&e.demandItemFacet(o.listFacet,f.spListKeyFacet.serialize(r)),l=e.demandItem({permissions:o.permissionsFacet,isCheckedOut:i.isCheckedOutFacet},n),c=l.permissions,h=l.isCheckedOut,p=a.default.hasItemPermission({permissions:c},a.default.manageWeb);return!!s&&s.templateType===u.default.webPageLibrary&&p&&!!h&&!h.byYou}return!1})))});
define("aUq",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RotateAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.RotateAction))})});
define("aUp",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OrderPrintsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OrderPrintsAction))})});
define("aUo",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EmbedAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EmbedAction))})});
define("aUn",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShareSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:1})});t.ViewSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:2})});t.EditSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:3})})});
define("aUm",["require","exports","cV","aRF","x6"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){return function(t){var r=t.consume(n.actionMap);return new(t.injected(r.CreateDocumentAction))({docType:e})}};t.CreateWordAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Word));t.CreateExcelAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Excel));t.CreatePowerPointAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.PowerPoint));t.CreateOneNoteAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.OneNote));t.CreateExcelSurveyAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.ExcelSurvey));t.CreateTextFileAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Text))});
define("aUl",["require","exports","mU","cV","aRF","fl","cx","ex","an","iU","i1","Kt","cw"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CopyFieldAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.CopyFieldAction))});function p(e,t){var n=u.getPageContextFromItemCache(e,t),r=e.demandItemFacet(f.spItemKeyFacet,t),i=r&&f.spListKeyFacet.serialize(r),s=i&&e.demandItemFacet(l.listFacet,i),o=s&&s.templateType===a.default.mySiteDocumentLibrary;return{isAvailable:!!n&&!n.isAnonymousGuestUser&&!o,pageContext:n,listContext:s}}t.EditItemAction=s.withSelectedItems()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRI"],t,n)})];case 1:return[2,t.sent().EditItemAction]}})})},function(e,t){var n=t.itemKeys;if(!n||n.length<1||!c.isFeatureEnabled(c.SPBulkEditItemCommand)&&n.length>1)return!1;var r=p(e,n[0]),i=r.isAvailable,s=r.listContext;if(!i)return!1;if(c.isFeatureEnabled(c.SPBulkEditItemCommand)&&s&&s.isDocumentLibrary&&n.length<=1)return!1;for(var o=0,u=n;o<u.length;o++){var a=u[o],f=e.demandItemFacet(l.permissionsFacet,a);if(!(i=h.default.hasItemPermission({permissions:f},h.default.editListItems)))break}return!!i}));t.ViewItemAction=s.withSelectedItems()(s.withExactlyOneItem()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRH"],t,n)})];case 1:return[2,t.sent().ViewItemAction]}})})},function(e,t){var n=t.itemKey;return!!n&&p(e,n).isAvailable})))});
define("aUj",["require","exports","mU","cV","aRF","aUk"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(s,t);t.WorkflowAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.WorkflowAction))});t.EditRenditionsAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.EditRenditionsAction))});t.PublishAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.PublishAction))});t.UnPublishAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.UnPublishAction))({unPublishType:0})});t.CancelApprovalAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.UnPublishAction))({unPublishType:1})})});
define("aUk",["require","exports","mU","cx","fl","bv","i1","cw","iU","i1","an"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ComplianceDetailsAction=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRW"],t,n)})];case 1:return[2,t.sent().ComplianceDetailsAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItem({isFolder:s.folderFacet,permissions:o.permissionsFacet,spItem:a.spItemKeyFacet},n),i=r.isFolder,c=r.permissions,h=r.spItem,p=h&&a.spListKeyFacet.serialize(h),d=e.demandItemFacet(f.listFacet,p);if(!!d&&d.templateType===l.ListTemplateType.mySiteDocumentLibrary)return!1;var v=u.default.hasItemPermission({permissions:c},u.default.viewVersions);return!i&&v}return!1})))});
define("aUi",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateMountPointAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CreateMountPointAction))});t.RemoveMountPointAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.RemoveMountPointAction))})});
define("aUh",["require","exports","mU","cx","fl","i1","iU","i1","an"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchFormatViewPaneAction=i.withCurrentItemSet()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRP"],t,n)})];case 1:return[2,t.sent().LaunchFormatViewPaneAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(o.spFolderItemSetKeyFacet,n),i=r&&o.spListKeyFacet.serialize(r),f=e.demandItemFacet(u.listFacet,i);if(!!f&&f.templateType===a.ListTemplateType.mySiteDocumentLibrary)return!1;if(r&&r.viewKey){var l=o.spViewKeyFacet.serialize(r.viewKey);if(e.demandItemFacet(s.currentDerivedViewFacet,l))return!0}}return!1}))});
define("aUg",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ApproveRejectAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ApproveRejectAction))})});
define("aUf",["require","exports","cV","aRF","aM","Vv"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NavigateToQueryRootAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap),o=e.consume(s.resourceKey),u=e.consume(i.url);return new(e.injected(r.OpenAction))({item:o.getItemSync({parentKey:u.getRootItemKey(t.queryType)}).item,openRelation:2})})});
define("aT5",["require","exports","aUe","aUc","aUa","aT8","aS3","aT6"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.alertMeCommand=n.alertMeCommand;t.manageAlertCommand=r.manageAlertCommand;t.versionHistoryCommand=i.versionHistoryCommand;t.powerAppsCommand=s.powerAppsCommand;t.aibuilderCommand=o.aibuilderCommand;t.powerBICommand=u.powerBICommand});
define("aUe",["require","exports","f","H","aUd","uU"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.alertMeCommand={key:new r.Facet("AlertMe").id,name:s.default.Alert,action:n.createElement(i.AlertMeAction,null),iconProps:{iconName:"Ringer"},automationId:"alertMe"}});
define("aUd",["require","exports","mU","f","fl","ex","d0","i1","cw","bv","cx","bw"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=l.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRY"],t,n)})];case 1:return[2,t.sent().AlertAction]}})})},function(e,t){var n=t.itemKey,r=t.resources;if(!n)return!1;var i=s.getPageContextFromItemCache(e,n),l=e.demandItemFacet(u.permissionsFacet,n);if(!(!!i&&!i.isEmailAuthenticationGuestUser&&a.PermissionMask.hasItemPermission({permissions:l},a.PermissionMask.createAlerts)))return!1;var c=r&&r.consume(o.resourceKey.optional);if(c){var h=e.demandItemFacet(f.canonicalUrlFacet,n);if(c.getUrlParts({path:h}).isCrossDomain)return!1}return!0}),p=i.withSelectedItems()(i.withCurrentItemAsFallback()(i.withExactlyOneItem()(h)));t.AlertMeAction=function(){var e=c.useResourceScope();return r.createElement(p,{resources:e})};t.ManageAlertAction=function(){var e=c.useResourceScope();return r.createElement(p,{resources:e,manageAlerts:!0})}});
define("aUc",["require","exports","f","H","aUd","uU"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.manageAlertCommand={key:new r.Facet("ManageAlert").id,name:s.default.ManageAlert,action:n.createElement(i.ManageAlertAction,null),iconProps:{iconName:"EditNote"}}});
define("aUa",["require","exports","f","H","aUb","uU"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.versionHistoryCommand={key:new r.Facet("VersionHistory").id,name:s.default.ShowVersionHistory,action:n.createElement(i.VersionHistoryAction,null),iconProps:{iconName:"StackIndicator"}}});
define("aUb",["require","exports","mU","f","fl","ex","d0","i1","hD","cw","bv","cx","bw","iU","mT","gu"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=c.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRK"],t,n)})];case 1:return[2,t.sent().VersionHistoryAction]}})})},function(e,t){var n=t.itemKey,r=t.resources;if(!n)return!1;var i=s.getPageContextFromItemCache(e,n),c=e.demandItemFacet(u.permissionsFacet,n),h=e.demandItemFacet(a.itemComplianceStatusFacet,n),m=e.demandItemFacet(l.malwareDetectedFacet,n),g=!!i&&!i.isEmailAuthenticationGuestUser&&f.PermissionMask.hasItemPermission({permissions:c},f.PermissionMask.viewVersions)&&3!==h&&4!==h;if(m||!g)return!1;var y=e.demandItemFacet(p.spItemKeyFacet,n),b=y&&p.spListKeyFacet.serialize(y),w=e.demandItemFacet(u.listFacet,b),E=!(!w||!w.enableVersions&&!w.isModerated);if(!E)return!1;var S=r&&r.consume(o.resourceKey.optional);if(S){var x=e.demandItemFacet(l.canonicalUrlFacet,n);if(S.getUrlParts({path:x}).isCrossDomain)return!1}var T=e.demandItemFacet(l.folderFacet,n),N=e.demandItemFacet(u.documentSetFacet,n),C=e.demandItemFacet(v.oneNoteFacet,n),k=e.demandItemFacet(u.listItemIdFacet,n),L=d.isFeatureEnabled(d.DocumentSetsModernView)&&d.isFeatureEnabled(d.UseItemsScopeInTeamSites)&&k;return E=!T&&!C||!(!L||!N)}),g=i.withSelectedItems()(i.withExactlyOneItem()(m));t.VersionHistoryAction=function(){var e=h.useResourceScope();return r.createElement(g,{resources:e})}});
define("aT8",["require","exports","f","H","ra","aT9","uU","mT"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={key:new r.Facet("CustomizeListForms").id,name:o.default.CustomizeListForms,engagement:{name:"LaunchCustomizePowerAppForm",isIntentional:!0},action:n.createElement(i.HideWithSelection,null,n.createElement(s.CustomizeFormsNavigationAction,null))},f={key:new r.Facet("CreateAppView").id,name:o.default.CreateAppView,engagement:{name:"LaunchCreatePowerAppPanel",isIntentional:!0},action:n.createElement(i.HideWithSelection,null,n.createElement(s.LaunchCreateAppViewPanelAction,null))},l={key:new r.Facet("SeeAllApps").id,name:o.default.SeeAllAppsLabel,engagement:{name:"LaunchSeeAllPowerApps",isIntentional:!0},action:n.createElement(i.HideWithSelection,null,n.createElement(s.SeeAllAppsAction,null))};t.powerAppsCommand={key:new r.Facet("PowerApps").id,name:u.isFeatureEnabled(u.PowerAppsIncludeSpace)?o.default.AppViewsCommandLabel_WithSpace:o.default.AppViewsCommandLabel,iconProps:{iconName:"PowerApps2Logo"},engagement:{name:"PowerAppsMainMenu",isIntentional:!0},subMenuProps:{items:[f,l,a]}}});
define("aT9",["require","exports","mU","fl","ex","mT","iU","i1","an","cx"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function l(e,t){var n=t.itemKey;if(!n)return!1;var r=i.getPageContextFromItemCache(e,n);return!!r&&!!n&&s.isFeatureEnabled(s.PowerApps)&&!r.disableAppViews}t.CustomizeFormsNavigationAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRM"],t,n)})];case 1:return[2,t.sent().CustomizeFormsNavigationAction]}})})},function(e,t){var n=t.itemKey,r=s.isFeatureEnabled(s.PowerAppListForms)&&s.isFeatureEnabled(s.PowerApps),i=!!n&&r;if(!i)return!1;var f=e.demandItemFacet(o.spItemKeyFacet,n),l=f&&o.spListKeyFacet.serialize(f),c=e.demandItemFacet(u.listFacet,l);if(!c||!c.id)return!1;var h=!(!c.permissions||!c.permissions.manageLists),p=c.isDocumentLibrary,d=Number(c.templateType)===a.ListTemplateType.genericList;return i=s.isFeatureEnabled(s.PowerappsCustomizationOnDocLibs)?(p||d)&&h:!p&&d&&h}));t.LaunchCreateAppViewPanelAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRM"],t,n)})];case 1:return[2,t.sent().LaunchCreateAppViewPanelAction]}})})},function(e,t){var n=t.itemKey,r=!!n&&l(e,t);if(r){var i=e.demandItemFacet(o.spItemKeyFacet,n),s=i&&o.spListKeyFacet.serialize(i),a=e.demandItemFacet(u.listFacet,s);r=!(!(a&&a.permissions&&a.permissions.manageLists)||a.isDocumentLibrary)}return r}));t.SeeAllAppsAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRM"],t,n)})];case 1:return[2,t.sent().SeeAllAppsAction]}})})},l))});
define("aS3",["require","exports","f","H","ra","aS4","uU"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={key:new r.Facet("CreateAIBuilderModel").id,name:o.default.CreateAIBuilderModel,action:n.createElement(i.HideWithSelection,null,n.createElement(s.CreateAIBuilderModelAction,null))},a={key:new r.Facet("ViewAIBuilderModelDetails").id,name:o.default.ViewAIBuilderModelDetails,action:n.createElement(i.HideWithSelection,null,n.createElement(s.ViewAIBuilderModelDetailsAction,null))},f={key:new r.Facet("GotoAIBuilder").id,name:o.default.GotoAIBuilder,action:n.createElement(i.HideWithSelection,null,n.createElement(s.ViewAIBuilderModelsAction,null))};t.aibuilderCommand={key:new r.Facet("AIBuilder").id,name:o.default.AIBuilderCommandLabel,iconProps:{iconName:"HomeGroup"},subMenuProps:{items:[u,a,f]}}});
define("aS4",["require","exports","mU","f","fa","cQ","cL","i1","an","iU","aS6","aS5"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.isAvailable,s="https://"+l.getAIBuilderRunTimeHost()+"/aibuilder/default-environment/models?template=SharePointFormProcessing";return r.createElement(i.Action,{isAvailable:t,onExecute:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){window.open(s,"_blank");return[2]})})}})};return t})(r.PureComponent),p=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=!this.props.isModelApplied;return r.createElement(r.Fragment,null,e&&r.createElement(c.LaunchCreateAIBModelPanelAction,null))};return t})(r.PureComponent),d=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.isModelApplied;return r.createElement(r.Fragment,null,e&&r.createElement(c.LaunchCreateAIBModelPanelAction,null))};return t})(r.PureComponent);function v(e){var t,n=s.getCurrentItemSetKey(e),r=e.demandItemFacet(f.spFolderItemSetKeyFacet,n),i=r&&f.spListKeyFacet.serialize(r),o=e.demandItemFacet(u.listFacet,i),a=r?r.webAbsoluteUrl:"",l=null===(t=r)||void 0===t?void 0:t.listFullUrl;return{viewId:r&&r.viewKey?r.viewKey.viewId:void 0,webAbsoluteUrl:a,list:o,listFullUrl:l,isPredictionModelApplied:!!o&&!!o.flags2&&8192==(8192&o.flags2)}}t.ViewAIBuilderModelsAction=o.connectToItemCache(function(e){var t=v(e).list;return{isAvailable:!!t&&!!t.isDocumentLibrary&&t.templateType!==a.ListTemplateType.webPageLibrary&&t.templateType!==a.ListTemplateType.mySiteDocumentLibrary}})(h);t.CreateAIBuilderModelAction=o.connectToItemCache(function(e){return{isModelApplied:v(e).isPredictionModelApplied}})(p);t.ViewAIBuilderModelDetailsAction=o.connectToItemCache(function(e){return{isModelApplied:v(e).isPredictionModelApplied}})(d)});
define("aS6",["require","exports","Kt"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getAIBuilderRunTimeHost=function(){var e="make.powerapps.com";n.isFeatureEnabled(n.PreviewAIBuilder)?e="make.preview.powerapps.com":n.isFeatureEnabled(n.PowerAppsAndAndProcessSimpleTestEnvironment)&&(e="make.test.powerapps.com");return e}});
define("aS5",["require","exports","mU","f","cL","v8","cm","bw","bp","cQ","iU","i1","an"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=a.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aVi"],t,n)})];case 1:return[2,t.sent().default]}})})});t.LaunchCreateAIBModelPanelAction=i.createItemCacheComponent(function(e){var t,n,i=f.getCurrentItemSetKey(e),a=e.demandItemFacet(l.spFolderItemSetKeyFacet,i),d=a&&l.spListKeyFacet.serialize(a),v=e.demandItemFacet(c.listFacet,d),m=a?a.webAbsoluteUrl:"",g=(null===(t=a)||void 0===t?void 0:t.listFullUrl)?a.listFullUrl:"",y=a&&a.viewKey?a.viewKey.viewId:"",b=(null===(n=v)||void 0===n?void 0:n.id)?v.id:"",w=!!(g&&m&&y&&b&&v&&v.isDocumentLibrary&&v.templateType!==h.ListTemplateType.webPageLibrary&&v.templateType!==h.ListTemplateType.mySiteDocumentLibrary),E=!!v&&!!v.flags2&&8192==(8192&v.flags2);return r.createElement(s.WizardAction,{isAvailable:w},u.withResources()(function(e){var t=e.reject,n=e.resolve;return r.createElement(p,{resources:e.resources,onDismiss:function(){t(new o.CancelError)},onComplete:function(e){e&&n()},createModelContext:{webAbsoluteUrl:m,viewId:y,listId:b,listFullUrl:g,isPredictionModelApplied:E}})}))})});
define("aT6",["require","exports","f","H","ra","aT7","uU"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.powerBICommand={key:new r.Facet("PowerBI").id,name:o.default.PowerBICommandLabel,iconProps:{iconName:"PowerBILogo16"},action:n.createElement(i.HideWithSelection,null,n.createElement(s.PowerBIAction,null))}});
define("aT7",["require","exports","mU","f","cL","fa","cy","cm","bo","ex","fl","ff"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=a.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../components/powerBI/PowerBIPanel"],t,n)})];case 1:return[2,t.sent().PowerBIPanel]}})})});t.PowerBIAction=l.withCurrentItemSet()(i.createItemCacheComponent(function(e,t){var i=t.itemKey,a=f.getPageContextFromItemCache(e,i);if(!a)return null;var l=c.getItemActionEngagement(e,{itemKey:i,engagement:{name:"LaunchPowerBIPanel",isIntentional:!0}}),p=o.renderComponentOnExecute(function(e){return r.createElement(h,{pageContext:a,onDismiss:function(){e.reject(new u.CancelError)}})});return r.createElement(s.Action,n.__assign({onExecute:p},l))}))});
define("aT3",["require","exports","f","H","aT4","MH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.captureVersionCommand={key:new r.Facet("CaptureVersion").id,name:s.default.CaptureVersion,action:n.createElement(i.CaptureVersionAction,null),iconProps:{iconName:"StackIndicator"}}});
define("aT4",["require","exports","mU","f","fa","fl","cy","ex","MH","d0","hc","Im","dF","i1","hD","cw","bv","cL","ff","bw","iU","Kt"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=g.createItemCacheComponent(function(e,t){var s=t.itemKey,l=t.resources,g=e.demandItemFacet(p.listItemIdFacet,s),b=u.getPageContextFromItemCache(e,s),S=b?b.layoutsUrl:"",T=b&&b.listId||"",N=(b?b.webAbsoluteUrl:"")+"/"+S+"/CreateDocSetVersion.aspx?"+h.serializeQuery({list:T,ID:g||"",IsDlg:1}),C=(function(e,t){var n=t.itemKey,r=t.resources;if(!n||!r)return!1;var i=u.getPageContextFromItemCache(e,n),s=e.demandItemFacet(p.permissionsFacet,n),o=e.demandItemFacet(d.itemComplianceStatusFacet,n);if(!i||i.isEmailAuthenticationGuestUser||!v.PermissionMask.hasItemPermission({permissions:s},v.PermissionMask.editListItems)||3===o||4===o)return!1;var a=e.demandItemFacet(w.spItemKeyFacet,n),l=a&&w.spListKeyFacet.serialize(a),c=e.demandItemFacet(p.listFacet,l),h=!!c&&!!c.enableVersions;if(!h)return!1;var g=r.consume(f.resourceKey.optional);if(g){var y=e.demandItemFacet(m.canonicalUrlFacet,n);if(g.getUrlParts({path:y}).isCrossDomain)return!1}var b=e.demandItemFacet(p.documentSetFacet,n),S=e.demandItemFacet(p.listItemIdFacet,n),x=E.isFeatureEnabled(E.DocumentSetsModernView)&&E.isFeatureEnabled(E.UseItemsScopeInTeamSites)&&S;return h=!(!x||!b)})(e,{itemKey:s,resources:l}),k=o.renderComponentOnExecute(function(e){return r.createElement(c.IFrameDialog,{url:N,heightOffset:.7,dialogContentProps:{title:a.default.CaptureVersion},onDismiss:function(){e&&e.resolve&&e.resolve()},onLoad:x})});return r.createElement(i.Action,n.__assign({isAvailable:C,onExecute:k},y.getItemActionEngagement(e,{itemKey:s,engagement:{name:"CaptureVersion",isIntentional:!0}})))});function x(e){new l.Async(void 0).setTimeout(function(){if(e&&e.contentDocument){var t=e.contentDocument.body.clientHeight;t>0&&(e.style.height=t+"px")}},10)}var T=s.withSelectedItems()(s.withExactlyOneItem()(S));t.CaptureVersionAction=function(){var e=b.useResourceScope();return r.createElement(T,{resources:e})}});
define("aT2",["require","exports","mU","f","aSx","sV","xb"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailsCommand=n.__assign(n.__assign({},o.detailsCommandBaseWithoutAction),{action:r.createElement(s.WithKnockoutResourceScope,null,r.createElement(i.ToggleInfoPaneAction,null))})});
define("aT0",["require","exports","f","H","aT1","MH","uU"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailsMenuCommand={key:new r.Facet("Details").id,name:s.default.Details,ariaLabel:o.default.DetailsPane,action:n.createElement(i.ShowInfoPaneAction,null)}});
define("aT1",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowInfoPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowPropertiesAction))({useToggleBehavior:!1})},{isToggleable:!1})});
define("aTX",["require","exports","mU","f","aTZ","aTY"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filtersPaneCommand=n.__assign(n.__assign({},s.filtersPaneCommandBaseWithoutAction),{action:r.createElement(i.ToggleFiltersPaneAction,null)})});
define("aTZ",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ToggleFiltersPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowFiltersAction))},{isToggleable:!0})});
define("aTY",["require","exports","mU","f","H","uU"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filtersPaneCommandBaseWithoutAction={key:new i.Facet("FiltersPane").id,automationId:"filtersPane",title:s.default.FiltersPane,ariaLabel:s.default.FiltersPane,iconProps:{iconName:"Filter"},commandBarButtonAs:function(e){var t=e.actionState&&e.actionState.isToggled,i=e.defaultRender;return i?r.createElement(i,n.__assign({},e,{"aria-expanded":!!t})):null}}});
define("aTW",["require","exports","f","H","ra","aSt","MH"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.moveToCommand={key:new r.Facet("MoveTo").id,name:o.default.Move,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.LaunchMoveCopyPanelAction,{isMove:!0})),iconProps:{iconName:"FabricMoveToFolder"}}});
define("aTV",["require","exports","f","H","ra","aSt","MH"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.copyToCommand={key:new r.Facet("CopyTo").id,name:o.default.Copy,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.LaunchMoveCopyPanelAction,{isMove:!1})),iconProps:{iconName:"Copy"}}});
define("aTT",["require","exports","f","H","ra","aTU","MH"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.runModelCommand={key:new r.Facet("AutoClassify").id,name:o.default.RunModelText,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.RunModelAction,null)),iconProps:{iconName:"Play"}}});
define("aTU",["require","exports","mU","f","fl","bw","cL","fa","bv","iP","aSI","Kt","an","QE","QL","QM","QJ","Mz","Ff","eG","bc","iU","fl","i1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=o.createItemCacheComponent(function(e,t){var i,s,o=t.resources;if(!o)return null;var T=t.itemKeys;T=T.filter(function(t){return!e.demandItemFacet(a.folderFacet,t)});var N=o&&o.consume(f.listContext)||{},C=N.listUrl,k=N.listTemplateType,L=S.getCurrentItemSetKey(e),A=e.demandItemFacet(E.spFolderItemSetKeyFacet,L),O=A&&E.spListKeyFacet.serialize(A),M=e.demandItemFacet(x.listFacet,O),_=o&&o.consume(l.resourceKey),D=o&&o.consume(f.pageContext)||{},P=D.webAbsoluteUrl,H=D.webServerRelativeUrl,B=T.map(function(t){var n,r,i=new g.default(t),s=e.demandItem({fileName:a.fileNameFacet,openUrl:a.openUrlFacet},t),o=s.fileName,u=s.openUrl;i.name=(null===(n=o)||void 0===n?void 0:n.name)||"";i.extension=(null===(r=o)||void 0===r?void 0:r.extension)||"";i.displayName=""+i.name+i.extension;i.openUrl=u||"";return i}),j=T&&T.length>0&&k!==h.default.contentCenterSampleLibrary&&c.isFeatureEnabled(c.HighPrioritySchedulingFeature)&&!!M&&!!M.flags2&&4096==(4096&M.flags2)&&!!(null===(s=null===(i=M)||void 0===i?void 0:i.permissions)||void 0===s?void 0:s.manageLists);return r.createElement(u.Action,{isAvailable:j,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t,r;return n.__generator(this,function(n){switch(n.label){case 0:e=(function(){var e=new m.default,t=o.consume(p.resourceKey),n=B.map(function(n){var r=t.register({name:n.displayName||"",iconName:y.getIconNameFromItem({type:b.default.File,extension:n.extension}),type:d.default.runModelOnItems,payloads:{runModelOnItems:{item:n}},batch:e});r.progress.maximum(1);r.progress.current(0);return r});n.forEach(function(e){e.state(v.default.started)});return n})();t=(function(){var e=[];B.forEach(function(t){var n,r={__metadata:{type:"Microsoft.Office.Server.ContentCenter.SPMachineLearningWorkItemEntityData"},Type:"AE9D4F24-EE84-4C0C-A972-A74CFFE939A1",TargetSiteUrl:P,TargetWebServerRelativeUrl:H,TargetServerRelativeUrl:((null===(n=A)||void 0===n?void 0:n.rootFolder)||C)+"/"+t.displayName};e.push(r)});return e})();return[4,null===(r=_)||void 0===r?void 0:r.runModel(t).then(function(t){e.forEach(function(e){t.has(e.name)?e.state(v.default.completed):e.state(v.default.failed)})}).catch(function(t){var n,r;w.default.log("[ccui] fetching content type failed "+(null===(r=null===(n=t)||void 0===n?void 0:n.message)||void 0===r?void 0:r.value));e.forEach(function(e){e.state(v.default.failed)})})];case 1:n.sent();return[2]}})})}})}),N=i.withSelectedItems()(T);t.RunModelAction=function(){var e=s.useResourceScope();return r.createElement(N,{resources:e})}});
define("aTJ",["require","exports","mU","f","H","uU","aTK"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fullscreenCommand={action:o.FullscreenAction,automationId:"expandCollapseList",key:new i.Facet("FullscreenMode").id,commandBarButtonAs:function(e){var t=e.defaultRender,i=e.actionState&&e.actionState.isToggled;return t?r.createElement(t,n.__assign({},e,{iconProps:{iconName:i?"BackToWindow":"FullScreen"},title:i?s.default.collapseContent:s.default.expandContent})):null}}});
define("aTK",["require","exports","mU","f","fa","aTM","iP","aTL"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FullscreenAction=s.createComponentWithSPOAppContext([s.ContextKeys.pageControls,s.ContextKeys.resources])(function(e){var t=e.pageControls,a=e.resources,f=t.isFullscreen,l=a.consume(u.resourceKey);return r.createElement(i.Action,{isToggled:f,engagement:{isIntentional:!0,name:f?"FullscreenListOff":"FullscreenListOn"},onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){t=a.consume(o.pageContext);(r=t&&t.listUrl)&&l.setFullscreenToStorage(!f,r);e.handleContextDataChange(((i={})[s.ContextKeys.pageControls]={isFullscreen:!f},i));return[2]})})}})})});
define("aTM",["require","exports","mU","ay","Q","f","aTR","aTQ","aTO","aTN"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContextKeys=u;var l=s.createContext({}),c=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._isDisposed=!1;r._handleContextChange=function(e){if(!r._isDisposed){var t=r.state,i=t.contextData,s=t.handleContextDataChange,o=p(i,e);if(!o)return null;r.setState({contextData:o,handleContextDataChange:s},function(){r._contextHandler.notifyUpdate(n.__assign({},o))})}};r._contextHandler=t.resources.consume(f.resourceKey);r._setContextInitState();return r}t.prototype.componentDidMount=function(){this._contextHandler.registerContextChangeHandler(this._handleContextChange);this._contextHandler.notifyUpdate(n.__assign({},this.state.contextData))};t.prototype.componentWillUnmount=function(){this._isDisposed=!0;this._stopListener&&this._stopListener()};t.prototype.render=function(){return s.createElement(l.Provider,{value:this.state},this.props.children)};t.prototype._setContextInitState=function(){var e=this,t=this.props.resources,r=t.consume(o.resourceKey);this._stopListener=r.listen(function(t){var r;e._handleContextChange(((r={})[u.responsiveUIMetrics]=n.__assign({},t),r))});this.state={contextData:a.createSPOAppContextData(t),handleContextDataChange:this._handleContextChange}};return t})(s.PureComponent);t.SPOAppContextProvider=c;function h(e,t){for(var n=t.contextData,r={handleContextDataChange:t.handleContextDataChange},i=[],s=0,o=e;s<o.length;s++){var u=o[s],a=n[u].data;r[u]=a;i.push(a)}return{pickedContext:r,contextDeps:i}}t.pickContextItems=h;t.createComponentWithSPOAppContext=function(e){return function(t){return function(r){var i=s.useContext(l),o=h(e,i),u=o.pickedContext,a=o.contextDeps,f=t;return s.useMemo(function(){return s.createElement(f,n.__assign({},u,r))},n.__spreadArrays(a,[r]))}}};function p(e,t){var n={},s=!1;for(var o in t){var u=e[o],f=u.data,l=t[o],c=void 0;switch(u.updateMethod){case a.ContextItemUpdateMethod.READONLY:throw'Read-only SPOAppContextItem "'+o+'" cannot be updated';case a.ContextItemUpdateMethod.REPLACE:c=l;break;case a.ContextItemUpdateMethod.PATCH:default:c=r.graft(f,l)}if(i.areShallowDifferent(f,c)){s=!0;n[o]={data:new r.ReplacePatch(c)};u.onChange&&u.onChange(f,c)}}return s?r.graft(e,n):null}t.createNewContextData=p});
define("aTR",["require","exports","mU","df","aTS","hT"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},u={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0};t.breakpointsResourceKey=new s.ResourceKey({name:e("module").id+".breakpoints",factory:new s.ConstantResourceFactory(u)});var a=(function(e){n.__extends(i,e);function i(t,n){var i=e.call(this)||this;i._onContainerResize=function(e){var t=i._containerElement,n=document.body,r=document.documentElement,s=t.clientWidth||r.clientWidth||t.innerWidth||n.clientWidth,o=t.clientHeight||r.clientHeight||t.innerHeight||n.clientHeight,a=i._computeFormFactorSize(i._breakpoints,s),f=i._computeCssClass(a),l=i._computeShowLabels(a),c=i._computeIsHamburgerVisible(s),h={DEFAULT_BREAKPOINTS:u,MAC_SCROLL_BAR_WIDTH:8,windowWidth:s,windowHeight:o,formFactorSize:a,showLabels:l,isHamburgerVisible:c,cssClass:f};i.setData(h)};var s=t.containerElement,o=void 0===s?window:s,a=n.breakpoints;i._containerElement=o;i._breakpoints=a;i._event=new r.default(i);i._event.on(i._containerElement,"resize, orientationchange",i._onContainerResize);i._onContainerResize();return i}Object.defineProperty(i.prototype,"metrics",{get:function(){return this.readData()},enumerable:!0,configurable:!0});i.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};i.determineWindowSize=function(e,t){void 0===t&&(t=u);if(0===e)return"Medium";for(var n in u)if(e<t[n])return n};i.determineCssClass=function(e){return o[e]};i.getScrollbarWidth=function(){var e=document.createElement("div"),t=e.style;t.visibility="hidden";t.width="100px";t.msOverflowStyle="scrollbar";document.body.appendChild(e);var n=e.offsetWidth;t.overflow="scroll";var r=document.createElement("div");r.style.width="100%";e.appendChild(r);var i=r.offsetWidth;e.parentNode.removeChild(e);var s=n-i;this.getScrollbarWidth=function(){return s};return s};i.prototype.compareSize=function(e,t){var n=this._breakpoints;return n[e]-n[t]};i.prototype._computeFormFactorSize=function(e,t){return this._containerElement===window?i.determineWindowSize(t,e):"Medium"};i.prototype._computeCssClass=function(e){return i.determineCssClass(e)};i.prototype._computeShowLabels=function(e){return this.compareSize(e,"Medium")>0};i.prototype._computeIsHamburgerVisible=function(e){return e<u.Large};i.dependencies={breakpoints:t.breakpointsResourceKey};return i})(i.Listenable);t.ResponsiveUI=a;t.resourceKey=s.createResolvedResourceKey(e("module").id,a)});
define("aTS",["require","exports","ay"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){this._listeners=[]}e.prototype.readData=function(){return this._data};e.prototype.listen=function(e){var t=this;this._listeners.indexOf(e)<0&&this._listeners.push(e);return function(){var n=t._listeners.indexOf(e);n>=0&&t._listeners.splice(n,1)}};e.prototype.setData=function(e){this._data=this._data||{};var t=n.graft(this._data,e);this._data=t;for(var r=0,i=this._listeners;r<i.length;r++){(0,i[r])(this._data)}};e.prototype.refresh=function(){};return e})();t.Listenable=r});
define("aTQ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.legacyMode="legacyMode";t.viewParams="viewParams";t.responsiveUIMetrics="responsiveUIMetrics";t.itemsScopeCurrentItemKey="itemsScopeCurrentItemKey";t.resources="resources";t.paneControls="paneControls";t.pageControls="pageControls";t.hotMainComponent="hotMainComponent"});
define("aTO",["require","exports","aC","H8","cV","cV","aTP","ax7","aTR","aTQ","aTL","mx"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h;(function(e){e[e.READONLY=0]="READONLY";e[e.REPLACE=1]="REPLACE";e[e.PATCH=2]="PATCH"})(h=t.ContextItemUpdateMethod||(t.ContextItemUpdateMethod={}));t.createSPOAppContextData=function(e){var t=e.consume(o.resourceKey),p=e.consume(n.navigation),d={name:f.legacyMode,updateMethod:h.REPLACE,data:!1},v={name:f.viewParams,data:p.viewParams,updateMethod:h.REPLACE,onChange:function(n,o){e.consume(i.originalViewParams)&&r.default(e.consume(i.originalViewParams),o);var u=e.consume(s.viewParams.optional);u&&u(o);t.updateViewParams(o)}};!c.default.isActivated("755D4075-3A26-4A5E-82ED-51702CAA4E54","05/05/20","initialize currentViewParamsFacet when create createSPOAppContextData")&&v.data&&t.updateViewParams(v.data);var m=e.consume(a.resourceKey),g={name:f.responsiveUIMetrics,updateMethod:h.PATCH,data:m.metrics},y={name:f.resources,updateMethod:h.READONLY,data:e},b={name:f.itemsScopeCurrentItemKey,data:e.consume(u.resourceKey).currentItemKey,updateMethod:h.REPLACE,onChange:function(n,r){if(r!==n){e.consume(u.resourceKey).currentItemKey=r;t.openItem(r)}}},w={name:f.paneControls,updateMethod:h.PATCH,data:{isLeftNavExpanded:!1,isRightPaneExpanded:!1,isInfoPaneExpanded:!1,isFiltersPaneExpanded:!1,isColumnCustomizationPaneExpanded:!1,isO365FlexPaneVisible:!1,isTipsNTricksPaneVisible:!1}},E=e.consume(l.resourceKey.optional),S=!c.default.isActivated("E6C29515-A1B5-472F-9759-B19A2BE8C623","02/11/20","Get fullscreen list setting from local storage")&&E&&E.getFullscreenFromStorage();return{legacyMode:d,viewParams:v,responsiveUIMetrics:g,resources:y,itemsScopeCurrentItemKey:b,paneControls:w,pageControls:{name:f.pageControls,updateMethod:h.PATCH,data:{canUserSelect:!0,isSuiteNavHamburgerVisible:m.metrics.isHamburgerVisible,isFullscreen:!!S}},hotMainComponent:{name:f.hotMainComponent,updateMethod:h.REPLACE,data:void 0}}}});
define("aTP",["require","exports","mU","hT","ax8","cv","iW","hA","aR","ay","H","dD","bn","ax7","eo"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=new h.default,m=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.openActionControlHandler=function(e,t){throw new Error("Not Implemented")};r._itemsScopeItemKey=n.itemsScopeKeys.itemKey;r._itemCacheStore=n.itemCacheStore;r._itemCacheStore.dispatch(u.blockItemPage());return r}t.prototype.unblockItemPageRender=function(){var e=this;this._itemCacheStore.dispatch(s.readItems(function(e){return u.itemPageIsBlocked(e)}))&&v.setTimeout(function(){return e._itemCacheStore.dispatch(u.unblockItemPage())},0)};t.prototype.updateViewParams=function(e){var t;(0,this._itemCacheStore.dispatch)(o.resolveItems({items:(t={},t[this._itemsScopeItemKey]=l.pack({viewParams:a.currentViewParamsFacet},{viewParams:new f.MirrorPatch(e)}),t)}))};t.prototype.openItem=function(e){var t=this._itemCacheStore.dispatch,n=this._nextOpenItem;if(n){this._nextOpenItem=void 0;t(n)}else t(d.openItemWithAddon({itemsScopeItemKey:this._itemsScopeItemKey,currentItemKey:e}))};t.dependencies=n.__assign(n.__assign({},c.default.dependencies),{itemsScopeKeys:p.resourceKey,itemCacheStore:i.resourceKey});return t})(c.default);t.ItemsScopeHelper=m;t.resourceKey=r.createResolvedResourceKey(e("module").id,m)});
define("aTL",["require","exports","hT","iP"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._pageContext=t.pageContext}e.prototype.setFullscreenToStorage=function(e,t){if(window&&window.localStorage)try{var n=localStorage&&localStorage.getItem("sp-fullscreen-list");if(n){var r=JSON.parse(n);e?r[t]=!0:delete r[t];localStorage.setItem("sp-fullscreen-list",JSON.stringify(r))}else this._setInitialFullscreenToStorage(e,t)}catch(n){this._setInitialFullscreenToStorage(e,t)}};e.prototype.getFullscreenFromStorage=function(){var e=this._pageContext&&this._pageContext.listUrl,t=localStorage&&localStorage.getItem("sp-fullscreen-list"),n=!1;if(t&&e)try{n=!!JSON.parse(t)[e]}catch(e){}return n};e.prototype._setInitialFullscreenToStorage=function(e,t){var n,r=((n={})[t]=e,n);localStorage.setItem("sp-fullscreen-list",JSON.stringify(r))};e.dependencies={pageContext:r.pageContext};return e})();t.default=i;t.resourceKey=n.createResolvedResourceKey(e("module").id,i)});
define("aTN",["require","exports","mU","df","hT","aTQ"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContextKeys=s;var o=(function(){function e(){this._events=new r.default(this);this._events.declare("contextUpdated")}e.prototype.registerContextChangeHandler=function(e){this._handleContextDataChange=e};e.prototype.update=function(e){this._handleContextDataChange&&this._handleContextDataChange(e)};e.prototype.onUpdated=function(e){this._events.on(this,"contextUpdated",e)};e.prototype.offUpdated=function(e){this._events.off(this,"contextUpdated",e)};e.prototype.notifyUpdate=function(e){this._contextData=e;this._events.raise("contextUpdated",e)};e.prototype.getContext=function(){return n.__assign({},this._contextData)};e.prototype.dispose=function(){this._events.dispose()};return e})();t.SPOAppContextHandler=o;t.resourceKey=new i.ResourceKey({name:e("module").id+"s",factory:new i.SimpleResourceFactory(o)})});
define("aTH",["require","exports","f","H","ji","ra","aTI","MH"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveCommand={key:new r.Facet("AddToOneDrive").id,name:u.default.CreateMountPoint,action:n.createElement(s.ShowOnlyWithSelection,null,n.createElement(o.AddToOneDriveAction,null)),iconProps:{iconType:i.IconType.Image,imageProps:{src:window.require.toUrl("odsp-media/images/addtoonedrive/a2od.svg"),width:"16px",height:"16px"}}}});
define("aTI",["require","exports","mU","f","fl","bv","cx","bw"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/AddToOneDriveAction"],t,n)})];case 1:return[2,t.sent().AddToOneDriveAction]}})})},function(e,t){var n=t.itemKey;return!!n&&!!e.demandItemFacet(s.folderFacet,n)}),f=i.withSelectedItems()(i.withExactlyOneItem()(a));t.AddToOneDriveAction=function(){var e=u.useResourceScope();return r.createElement(f,{resources:e})}});
define("aTF",["require","exports","f","H","aTG","MH","ra"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quickEditCommand={key:new r.Facet("QuickEdit").id,name:s.default.EditAll,action:n.createElement(o.HideWithSelection,null,n.createElement(i.LaunchQuickEditAtion,null)),iconProps:{iconName:"Edit"}}});
define("aTG",["require","exports","mU","f","cx","aS","fl","i1","cw","iU","ds","cu","an","iP","Kt","WL","bw","d1","r","aR","eV"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=new l.PlatformDetection;var S=i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRN"],t,n)})];case 1:return[2,t.sent().LaunchQuickEditAction]}})})},function(e,t){if(d.isFeatureEnabled(d.showQuickEditFeature)&&d.isFeatureEnabled(d.UseItemsScopeInTeamSites))return!1;if(E.isMobile)return!1;var n=t.itemKey;if(n){var r=e.demandItemFacet(f.spFolderItemSetKeyFacet,n);if(r){var i=f.spListKeyFacet.serialize({listFullUrl:r.listFullUrl,webAbsoluteUrl:r.webAbsoluteUrl}),o=e.demandItemFacet(u.listFacet,i);if((function(e,t,n){if(n&&n.isDocumentLibrary){var r=e.demandItemFacet(c.schemaFacet,t),i=[];if(r&&r.columnKeys)for(var s=0,o=r.columnKeys;s<o.length;s++){var a=o[s],f=e.demandItemFacet(u.internalNameFacet,a);f&&i.push({internalName:f})}return v.isOutOfTheBoxList(i,!0)}return!1})(e,n,o))return!1;var l=f.spPageContextKeyFacet.serialize({listFullUrl:r.listFullUrl,webAbsoluteUrl:r.webAbsoluteUrl}),m=e.demandItemFacet(u.spPageContextFacet,l);if(m&&m.isAnonymousGuestUser)return!1;if(o&&o.templateType===h.default.mySiteDocumentLibrary)return!1;var S=void 0;if(!t.resources)return!1;if(!(S=t.resources.isExposed(p.inplaceEditorUrl)?t.resources.consume(p.inplaceEditorUrl):null))return!1;var x=e.demandItemFacet(f.spFolderItemSetKeyFacet,n),T=void 0,N=void 0;if(x&&x.viewKey){var C=f.spViewKeyFacet.serialize(x.viewKey);if((N=e.demandItemFacet(u.currentDerivedViewFacet,C))&&N.baseViewXml){T=(new DOMParser).parseFromString(N.baseViewXml,"text/xml").getElementsByTagName("ViewStyle")}}var k=s.getItemsScope(e).itemsScopeItemKey,L=e.demandItemFacet(b.currentViewParamsFacet,k),A=e.demandItemFacet(u.permissionsFacet,f.spItemKeyFacet.serialize({listFullUrl:r.listFullUrl,webAbsoluteUrl:r.webAbsoluteUrl})),O=a.default.hasItemPermission({permissions:A},a.default.editListItems),M=g.getQueryType(e,n),_=e.demandItemFacet(c.childItemsFacet,n),D=!1;if(_&&_.itemKeys)for(var P=0,H=_.itemKeys;P<H.length;P++){var B=H[P];f.spItemGroupKeyFacet.matches(B)&&(D=!0)}return M===y.default.Files&&!D&&!!o&&!!o.allowGridMode&&!!N&&!!N.id&&!!T&&0===T.length&&!(L&&L.needsAttentionView)&&O&&(!S||!S())&&!(function(e,t){if(e&&e.listBaseTemplate&&h.isPromotedLinksList(e.listBaseTemplate))try{if(t&&t.baseViewXml){var n=w.xmlToDom(t.baseViewXml);if("1"===w.getAttr(n.childNodes[0],"BaseViewID"))return!0}}catch(e){}return!1})(m,N)}}return!1}),x=o.withCurrentItemSet()(S);t.LaunchQuickEditAtion=function(){var e=m.useResourceScope();return r.createElement(x,{resources:e})}});
define("aTD",["require","exports","f","H","aTE","MH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cancelEditCommand={key:new r.Facet("CancelEdit").id,name:s.default.cancelEdit,action:n.createElement(i.LaunchCancelEditAtion,null),iconProps:{iconName:"CheckMark"}}});
define("aTE",["require","exports","mU","f","cx","iP","bw"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRX"],t,n)})];case 1:return[2,t.sent().CancelEditAtion]}})})},function(e,t){var n=t.resources;if(n){var r=n.consume(s.inplaceEditorUrl.optional);return!(!r||!r())}return!1});t.LaunchCancelEditAtion=function(){var e=o.useResourceScope();return r.createElement(u,{resources:e})}});
define("aTC",["require","exports","f","H","aSv","MH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.previewCommand={key:new r.Facet("Preview").id,name:s.default.Preview,automationId:"Preview",action:n.createElement(i.PreviewAction,null)}});
define("aTB",["require","exports","f","H","aUj","MH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.workflowCommand={key:new r.Facet("Workflow").id,name:s.default.Workflow,action:n.createElement(i.WorkflowAction,null),automationId:"workflow"}});
define("aTA",["require","exports","f","H","aUj","MH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.complianceDetailsCommand={key:new r.Facet("ComplianceDetails").id,name:s.default.ComplianceDetails,action:n.createElement(i.ComplianceDetailsAction,null),automationId:"complianceDetails"}});
define("aTz",["require","exports","f","H","aUj","MH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.publishCommand={key:new r.Facet("Publish").id,name:s.default.Publish,action:n.createElement(i.PublishAction,null)}});
define("aTy",["require","exports","f","H","aUj","MH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.unPublishCommand={key:new r.Facet("UnPublish").id,name:s.default.UnPublish,action:n.createElement(i.UnPublishAction,null)}});
define("aTx",["require","exports","f","H","aUj","MH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cancelPublishCommand={key:new r.Facet("CancelApproval").id,name:s.default.CancelApproval,action:n.createElement(i.CancelApprovalAction,null)}});
define("aTv",["require","exports","mU","f","H","aTw","ra","MH"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createShortcutCommand={key:new i.Facet("Link").id,name:u.default.CreateShortcut,action:r.createElement(o.HideWithSelection,null,r.createElement(s.CreateShortcutAction,null)),iconProps:{iconName:"Globe"}};t.createPersistentShortcutCommand=n.__assign(n.__assign({},t.createShortcutCommand),{action:r.createElement(s.CreatePersistentShortcutAction,null)})});
define("aTw",["require","exports","mU","f","cx","fl","aS","cw","i1","iU","Kt","d1","r","bw","Xv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRV"],t,n)})];case 1:return[2,t.sent().CreateShortcutAction]}})})},function(e,t){var n=t.itemKey,r=t.resources;if(!r||!n)return!1;var i=e.demandItemFacet(f.spItemKeyFacet,n);if(i){if(r.consume(d.resourceKey.optional)){var p=f.spPageContextKeyFacet.serialize({listFullUrl:i.listFullUrl,webAbsoluteUrl:i.webAbsoluteUrl}),v=e.demandItemFacet(a.permissionsFacet,n),m=u.default.hasItemPermission({permissions:v},u.default.insertListItems),g=e.demandItemFacet(a.spPageContextFacet,p),y=o.getItemsScope(e).itemsScopeItemKey,b=s.getCurrentItemSetKey(e,y);if(b){var w=c.getQueryType(e,b);return!!g&&!g.isAnonymousGuestUser&&!g.isEmailAuthenticationGuestUser&&l.isFeatureEnabled(l.ShortcutLink)&&l.isFeatureEnabled(l.SpListNext)&&m&&w===h.default.Files}}}return!1}),m=s.withOnlyCurrentItem()(v),g=s.withCurrentItem()(v);t.CreateShortcutAction=function(){var e=p.useResourceScope();return r.createElement(m,{resources:e})};t.CreatePersistentShortcutAction=function(){var e=p.useResourceScope();return r.createElement(g,{resources:e})}});
define("aTt",["require","exports","f","H","aTu","MH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInPowerBICommand={key:new r.Facet("OpenInPowerBI").id,name:s.default.OpenInPowerBI,action:n.createElement(i.OpenInPowerBIAction,null),iconProps:{iconName:"PowerBILogo16"}}});
define("aTu",["require","exports","mU","cx","x6","bv","fl","hD","aS","cw","i1","Kt","d1","Wa","q"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInPowerBIAction=o.withSelectedItems()(o.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRO"],t,n)})];case 1:return[2,t.sent().OpenInPowerBIAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItem({fileName:s.fileNameFacet,itemStatus:u.itemComplianceStatusFacet,openUrl:s.openUrlFacet,permissions:l.permissionsFacet},n),v=r.fileName,m=r.itemStatus,g=r.openUrl,y=r.permissions,b=f.default.hasItemPermission({permissions:y},f.default.openItems),w=a.getItemsScope(e).itemsScopeItemKey,E=o.getCurrentItemSetKey(e,w);if(E){var S=h.getQueryType(e,E);return c.isFeatureEnabled(c.EnablePowerBIIngegration)&&!!v&&!!v.extension&&!!g&&(p.GetDocumentTypeFromExtension(v.extension)===i.DocumentType.Excel||".csv"===v.extension.toLowerCase())&&4!==m&&3!==m&&b&&!d.isRecycleBin(S)}}return!1})))});
define("aTr",["require","exports","f","H","aTs","MH","sV"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInTextEditorCommand={key:new r.Facet("OpenInTextEditor").id,name:s.default.OpenInTextEditor,action:n.createElement(o.WithKnockoutResourceScope,null,n.createElement(i.OpenInTextEditorAction,null)),iconProps:{iconName:"Edit"}}});
define("aTs",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInTextEditorAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInTextEditorAction))})});
define("aTp",["require","exports","f","H","aTq","MH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={iconName:void 0,styles:{root:{display:"none!important"}}};t.openInExplorerCommand={key:new r.Facet("OpenInExplorer").id,name:s.default.OpenInExplorer,action:n.createElement(i.OpenInExplorerAction,null),iconProps:o}});
define("aTq",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInExplorerAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInExplorerAction))})});
define("aTn",["require","exports","f","H","ra","aTo","uU"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInSharePointCommand={key:new r.Facet("OpenInSharePoint").id,name:o.default.OpenInSharePoint,action:n.createElement(i.HideWithSelection,null,n.createElement(s.OpenInSharePointAction,null)),iconProps:{iconName:"SharepointLogo"}}});
define("aTo",["require","exports","mU","cx","bU","w5"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInSharePointAction=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRJ"],t,n)})];case 1:return[2,t.sent().OpenInSharePointAction]}})})},function(e,t){var n=i.isTeamsWebView(),r=s.isCrossOrigin();return n||r})});
define("aTl",["require","exports","f","H","aTm","MH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.teamChannelCommand={key:new r.Facet("TeamChannel").id,name:s.default.Channel,action:n.createElement(i.TeamChannelAction,null),iconProps:{iconName:"TeamsLogo"}}});
define("aTm",["require","exports","mU","cx","fl","aS","i1","iU","aAq"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TeamChannelAction=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRL"],t,n)})];case 1:return[2,t.sent().TeamChannelAction]}})})},function(e,t){var n=t.itemKey,r=s.getItemsScope(e).itemsScopeItemKey,f=i.getCurrentItemSetKey(e,r),l=e.demandItemFacet(u.spFolderItemSetKeyFacet,f),c=e.demandItemFacet(u.spItemKeyFacet,n);if(!l)return!1;var h=u.spItemKeyFacet.serialize({itemId:c?c.itemId:"",listFullUrl:l.listFullUrl,rootFolder:l.rootFolder,webAbsoluteUrl:l.webAbsoluteUrl}),p=e.demandItemFacet(o.progIdFacet,h)||"";return a.isTeamChannelBannerEnabled()&&a.isProgIdTeamChannelFolder(p)})))});
define("aTk",["require","exports","f","H","ra","aTj","MH"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadFileCommand={key:new r.Facet("UploadFile").id,name:o.default.UploadFile,action:n.createElement(i.HideWithSelection,null,n.createElement(s.UploadFileAction,null))}});
define("aTj",["require","exports","mU","bZ","fl","cx","ds"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=new o.PlatformDetection;t.UploadFileAction=i.withOnlyCurrentItem()(s.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aR0"],t,n)})];case 1:return[2,t.sent().UploadFileAction]}})})},function(e,t){return u.isHtml5FileUploadSupported&&r.getIsUploadItemsActionAvailable(e,t)}));t.UploadFolderAction=i.withOnlyCurrentItem()(s.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aR0"],t,n)})];case 1:return[2,t.sent().UploadFolderAction]}})})},function(e,t){return u.isFolderUploadSupported&&r.getIsUploadItemsActionAvailable(e,t)}))});
define("aTi",["require","exports","f","H","ra","aTj","MH"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadFolderCommand={key:new r.Facet("UploadFolder").id,name:o.default.UploadFolder,action:n.createElement(i.HideWithSelection,null,n.createElement(s.UploadFolderAction,null))}});
define("aTg",["require","exports","f","H","aTh","MH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileRequestCommand={key:new r.Facet("FileRequest").id,name:s.default.CreateFileRequest,action:n.createElement(i.FileRequestAction,null),iconProps:{iconName:"FileRequest"}}});
define("aTh",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileRequestAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CreateFileRequestAction))})});
define("aTe",["require","exports","f","H","ra","aTf","MH"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.manageAccessCommand={key:new r.Facet("ManageAccess").id,name:o.default.ManageAccess,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.ManageAccessAction,null)),iconProps:{iconName:"PlayerSettings"}}});
define("aTf",["require","exports","cV","aRF"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ManageAccessAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowPermissionsAction))})});
define("aS2",["require","exports","mU","f","H","bX","an","aTc","iU","i1","aS7","mT","uU","w4","vD","vy","aS3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=new i.Facet("addFlow").id,y=new i.Facet("configureFlows").id,b=new i.Facet("existingFlows").id,w=new i.Facet("setUpApprovalFlow").id;t.getFlowCommand=function(e,t){var E,S=p.getFlowMetaData(e,t),x=S.canShow,T=S.pageContext,N=S.listKey,C=S.isDocumentLibrary;if(x&&T&&N){var k=e.demandItemFacet(d.flowProcessorControl,d.flowProcessorKey),L=d.flowProcessorControl.evaluate(k)(e,{}),A=L.flowProcessor,O=L.loadAllFlows,M=L.getFlowCommandSubMenuProps,_=!1,D=e.demandItemFacet(a.spItemKeyFacet,t);if(D){var P={webAbsoluteUrl:D.webAbsoluteUrl,listFullUrl:D.listFullUrl},H=a.spListKeyFacet.serialize(P),B=e.demandItemFacet(f.listFacet,H),j=!!B&&!!B.aiBuilderEnabled;_=(!c.isFeatureEnabled(c.PowerAIBuilderEnabledByTenantSettingOnly)&&c.isFeatureEnabled(c.PowerAIBuilderEnabled)||j)&&!!(null===(E=B)||void 0===E?void 0:E.isDocumentLibrary)&&B.templateType!==o.default.webPageLibrary}var F=(function(e,t){var s=[],a=(function(e){var t=[{key:g,automationId:"AddFlowCommand",name:h.default.AddFlow,action:r.createElement(l.AddFlowAction,null)},{key:b,automationId:"ExistingFlowsCommand",name:h.default.ExistingFlows,action:r.createElement(l.ShowExistingFlowsAction,null)},{key:w,automationId:"SetUpApprovalFlowCommand",name:h.default.setUpApprovalFlow,action:r.createElement(l.SetUpApprovalFlowAction,null)}];c.isFeatureEnabled(c.RequestSignOffSwitch)&&e&&e.listBaseTemplate!==o.default.webPageLibrary&&t.push({key:y,automationId:"ConfigureFlowsCommand",name:h.default.ConfigureFlows,action:r.createElement(l.LaunchConfigureFlowsPanelAction,null)});return t})(e);if(c.isFeatureEnabled(c.RulesPanel)&&e&&e.listBaseTemplate===o.default.genericList){var f={key:new i.Facet("manageRulesCommand").id,automationId:"ManageRulesCommand",name:h.default.ManageRulesCommandLabel,action:r.createElement(u.LaunchManageRulesAction,null)};s.push(f)}if(c.isFeatureEnabled(c.AutomateMenuNewLayout)&&c.isFeatureEnabled(c.ChangeFlowToAutomate)){var p={key:new i.Facet("powerAutomateCommand").id,name:h.default.PowerAutomateCommandLabel,iconProps:{iconName:"Flow"},subMenuProps:{items:a}};s.push(p);t&&s.push(m.aibuilderCommand)}else s=n.__spreadArrays(s,a);return s})(T,_),I=n.__spreadArrays(F),q=v.flowSetKeyFacet.serialize(N),R=Number(T.webTemplate)===s.default.mySite,U=M&&M(e,{key:N,flowSetKey:q,isODB:R,pageContext:T}),z=p.getFlowCommandTemplate();z.subMenuProps={items:(function(){if(!c.isFeatureEnabled(c.ProcessSimple))return[];if(!e.demandItemFacet(v.allowLoadAllFlowsFacet,q))return I;O&&(I=O(e,{key:N,isDocumentLibrary:!!C,pageContext:T,flowProcessor:A,staticFlowCommands:F}));return I})(),onMenuOpened:U&&U.onMenuOpened,onMenuDismissed:U&&U.onMenuDismissed};return z}}});
define("aTc",["require","exports","mU","f","fa","cy","cm","bo","cL","fl","bv","ex","yj","i1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=u.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../components/RulesPanel/RulesPanel"],t,n)})];case 1:return[2,t.sent().RulesPanel]}})})});t.LaunchManageRulesAction=f.withCurrentItemSet()(a.createItemCacheComponent(function(e,t){var n=t.itemKey,u=c.getPageContextFromItemCache(e,n),a=h.readItemSetSchemaFromItemCache(e,{mapping:{internalName:p.internalNameFacet,displayName:l.displayNameFacet,columnFieldType:p.mappedColumnFieldTypeFacet},itemSetKey:n||""});if(!u)return null;var f=s.renderComponentOnExecute(function(e){return r.createElement(d,{onDismiss:function(){e.reject(new o.CancelError)},pageContext:u,itemKey:n,columnData:a})});return r.createElement(i.Action,{onExecute:f,engagement:{name:"LaunchRulesPanel",isIntentional:!0}})}))});
define("aS7",["require","exports","mU","fl","cx","aTb","aTa","aS9","aS8"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddFlowAction=r.withCurrentItem()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRR"],t,n)})];case 1:return[2,t.sent().AddFlowAction]}})})},s.checkBaseAvailability));t.LaunchConfigureFlowsPanelAction=r.withCurrentItem()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRR"],t,n)})];case 1:return[2,t.sent().LaunchConfigureFlowsPanelAction]}})})},s.checkBaseAvailability));t.ShowExistingFlowsAction=r.withCurrentItem()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRR"],t,n)})];case 1:return[2,t.sent().ShowExistingFlowsAction]}})})},s.checkBaseAvailability));t.SetUpApprovalFlowAction=o.SetUpApprovalFlowAction;t.SetUpReminderFlowAction=u.SetUpReminderFlowAction;t.TriggerFlowAction=a.TriggerFlowAction;t.TriggerFlowItemAction=a.TriggerFlowItemAction});
define("aTb",["require","exports","ex","mT","al"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.checkBaseAvailability=function(e,t){var s=t.itemKey;if(!s)return!1;var o=n.getPageContextFromItemCache(e,s),u=o&&o.webTemplate,a=Number(u)===i.default.mySite,f=!!a&&!!o&&(!1===o.isSiteOwner||void 0===o.isSiteOwner&&!o.isSiteAdmin);return!!o&&!o.isAnonymousGuestUser&&!o.isEmailAuthenticationGuestUser&&!o.disableFlows&&r.isFeatureEnabled(r.ProcessSimple)&&(!a||r.isFeatureEnabled(r.ODBFlow))&&!f}});
define("aTa",["require","exports","mU","cx","fl","aTb","ex","mT","an"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SetUpApprovalFlowAction=i.withCurrentItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRR"],t,n)})];case 1:return[2,t.sent().SetUpApprovalFlowAction]}})})},function(e,t){var n=t.itemKey,r=o.getPageContextFromItemCache(e,n);return!!r&&!!n&&s.checkBaseAvailability(e,{itemKey:n})&&r.hasManageWebPermissions&&u.isFeatureEnabled(u.WexSitePagesContentApproval)&&r.listBaseTemplate===a.ListTemplateType.webPageLibrary&&!r.disableFlows}))});
define("aS9",["require","exports","mU","cx","fl","aTb","mT"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRR"],t,n)})];case 1:return[2,t.sent().SetUpReminderFlowAction]}})})},function(e,t){var n=t.itemKey;return!!n&&o.isFeatureEnabled(o.DynamicFlowDates)&&s.checkBaseAvailability(e,{itemKey:n})});t.SetUpReminderFlowAction=i.withCurrentItem()(u)});
define("aS8",["require","exports","mU","cx","fl","aTb","ex","mT","iU","i1","bv","T5","T1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function p(e,t){var n=t.flow,r=t.itemKey,i=t.defaultToTriggerById;if(!r)return!1;var p=o.getPageContextFromItemCache(e,r),d=e.demandItemFacet(a.spItemKeyFacet,r),v=d&&a.spListKeyFacet.serialize(d),m=e.demandItemFacet(f.listFacet,v),g=!0;if(!i){if(!(g=!!p&&s.checkBaseAvailability(e,{itemKey:r})))return!1;var y=!!m&&!!m.isDocumentLibrary;if(!(g=u.isFeatureEnabled(u.SPOFlowIntegration)||y))return!1}if(n&&n.categoryNames)if(n.categoryNames.indexOf(c.EnvironmentAppropriateRequestSignoffTemplateCategory)>-1){var b=e.demandItemFacet(f.rowDataFacet,r);g=!!p&&!!m&&!!b&&h.isTriggerSignoffFlowActionAvailable(p,m,{properties:{CheckedOutUserId:b.CheckedOutUserId}})}else if(n.categoryNames.indexOf("ODB_CONVERT_TO_PDF")>-1){var w=e.demandItemFacet(l.fileNameFacet,r);g=!!w&&!!w.extension&&h.isTriggerODBConvertToPdfFlowActionAvailable({extension:w.extension})}return g}var d=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRR"],t,n)})];case 1:return[2,t.sent().TriggerFlowAction]}})})},function(e,t){return p(e,t)});t.TriggerFlowAction=i.withSelectedItems()(i.withExactlyOneItem()(d));t.TriggerFlowItemAction=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aRR"],t,n)})];case 1:return[2,t.sent().TriggerFlowItemAction]}})})},function(e,t){return p(e,n.__assign(n.__assign({},t),{defaultToTriggerById:!0}))})});
define("aS1",["require","exports","qH","Kt"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.divider=function(e){return{name:"-",key:"breakBefore"+e.toString(),itemType:n.ContextualMenuItemType.Divider}};t.isManageAccessItemsScopeOn=function(){return r.isFeatureEnabled(r.EnableManageAccessItemsScope)}});
define("aUx",["require","exports","ex","iU","i1","hD","cw","an"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.launchMoveCopyPanelActionControlHandler=function(e,t){for(var n=t.isMove,r=0,i=t.itemKeys;r<i.length;r++){if(!a(e,{itemKey:i[r],isMove:n}))return{isAvailable:!1}}return{isAvailable:!0}};function a(e,t){var a=t.itemKey,f=t.isMove,l=e.demandItem({spItem:r.spItemKeyFacet,mountPoint:i.mountPointFacet,permissions:i.permissionsFacet,itemComplianceStatus:s.itemComplianceStatusFacet},a),c=l.spItem,h=l.mountPoint,p=l.permissions,d=l.itemComplianceStatus,v=n.getPageContextFromItemCache(e,a);if(!v||!c||v.isAnonymousGuestUser)return!1;if(3===d||4===d||h||!o.PermissionMask.hasItemPermission({permissions:p},o.PermissionMask.openItems))return!1;if(f){var m=r.spListKeyFacet.serialize(c),g=e.demandItemFacet(i.listFacet,m);if(g){if(g.templateType===u.default.webPageLibrary)return!1;if(!g.isDocumentLibrary&&!g.allowCreateFolder)return!1}return o.PermissionMask.hasItemPermission({permissions:p},o.PermissionMask.editListItems)&&o.PermissionMask.hasItemPermission({permissions:p},o.PermissionMask.deleteListItems)}return!0}});
define("aUy",["require","exports","e3","hT","T4","Y3","aUA","aUz"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,factory:{dependencies:{resources:r.resourceScopeKey,flowProcessorType:i.typeResourceKey,flowWidgetProvider:s.resourceKey},create:function(e){var t=new e.flowProcessorType({resources:e.resources}),r=e.flowWidgetProvider;return{instance:n.createControlHandler()(function(){return function(e){return function(e,n){return{flowProcessor:t,flowWidgetProvider:r,loadAllFlows:o.loadAllFlows,getFlowCommandSubMenuProps:u.getFlowCommandSubMenuProps}}}})}}}})});
define("aUA",["require","exports","mU","f","ra","qH","H","aS7","cQ","cu","Kt","MH","vy","aUB","bv","i1","fO","a2","al","mx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w={name:"-",key:"divider_1",itemType:s.ContextualMenuItemType.Divider},E={name:"-",key:"divider_2",itemType:s.ContextualMenuItemType.Divider},S=function(e){return{key:new o.Facet("flowInstance").id,automationId:"FlowInstanceCommand",name:e.displayName,action:r.createElement(i.ShowOnlyWithSelection,null,r.createElement(u.TriggerFlowAction,{flow:e}))}};t.loadAllFlows=function(e,t){var i=t.staticFlowCommands,s=t.isDocumentLibrary,o=a.getCurrentItemSetKey(e),k=e.demandItemFacet(f.schemaFacet,o),L=(function(e,t){var n=[];if(l.isFeatureEnabled(l.DynamicFlowDates)&&t){for(var i=[],s=0,o=t.columnKeys;s<o.length;s++){var a=o[s],f=e.demandItemFacet(v.mappedColumnFieldTypeFacet,a),h=e.demandItemFacet(d.displayNameFacet,a)||"",p=e.demandItemFacet(v.isCalculatedFacet,a),y=e.demandItemFacet(v.internalNameFacet,a)||"";b.default.isActivated("139A31DA-23EF-4A4B-846D-3B8B4D284AC4","9/4/2019","Hide Remind Me Flow for Calculated DateTime fields")?f===m.ColumnFieldType.DateTime&&"Modified"!==y&&"Created"!==y&&i.push({key:N+"_"+y,automationId:"RemindMeColumnCommand_"+y,name:h,action:r.createElement(u.SetUpReminderFlowAction,{columnName:y,columnDisplayName:h})}):f!==m.ColumnFieldType.DateTime||p||"Modified"===y||"Created"===y||i.push({key:N+"_"+y,automationId:"RemindMeColumnCommand_"+y,name:h,action:r.createElement(u.SetUpReminderFlowAction,{columnName:y,columnDisplayName:h})})}if(i.length>0){var w={key:T,automationId:"RemindMeCommand",name:c.default.remindMeCommandName,subMenuProps:{items:i,onMenuOpened:function(){g.Engagement.logData({name:"FlowSetAReminder.Expanded"})}}};n.push(w)}}return n})(e,k);if(l.isFeatureEnabled(l.FlowForLibraries)&&s||!s&&l.isFeatureEnabled(l.SPOFlowIntegration)){var A=[],O=(function(e,t){var r=t.key,i=t.flowProcessor,s=h.flowSetKeyFacet.serialize(r),o=C(e,t,p.flowItemFacet,s),u=h.flowTemplateSetKeyFacet.serialize(r),a=C(e,t,p.flowTemplateItemFacet,u);b.default.isActivated("29CCAC02-CEE8-4CA1-8D95-6D47D6E1BD10","8/12/2019","Use copy of FlowInstances in computeFlowMenuList")||(o=o.map(function(e){return n.__assign({},e)}));var f=Number(t.pageContext.webTemplate)===y.default.mySite;return i.buildDisplayedFlowsInstances(o,a,f)})(e,t);if(l.isFeatureEnabled(l.AutomateMenuCreateSubsections)){var M=n.__spreadArrays(L),_=[];O.forEach(function(e){!(function(e){var t,n=null===(t=e.categoryNames)||void 0===t?void 0:t.indexOf("OOB_CURRENT");n=n||-1;return"FromTemplate"===e.provisioningMethod||n>=0})(e)?_.push(S(e)):M.push(S(e))});x(M);x(_);A=M.concat(w,_,E,i)}else{for(var D=0,P=n.__spreadArrays(L);D<O.length;D++)P.push(S(O[D]));x(P);P.push(w);A=P.concat(i)}return A}return i};function x(e){e.sort(function(e,t){var n=e.name?e.name.toLowerCase():"",r=t.name?t.name.toLowerCase():"";return n===r?0:n>r?1:-1})}var T=new o.Facet("remindMe").id,N=new o.Facet("remindMeColumn").id;function C(e,t,n,r){var i=[],s=e.demandItemFacet(f.childItemsFacet,r);s&&s.itemKeys&&s.itemKeys.forEach(function(t){var r=e.demandItemFacet(n,t);i.push(r)});return i}});
define("aUB",["require","exports","H"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.flowItemFacet=new n.Facet("flow");t.flowTemplateItemFacet=new n.Facet("flowTemplate")});
define("aUz",["require","exports","mU","cu","b1","Zf","hS","vy","mx","Y3"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFlowCommandSubMenuProps=function(e,t){var l=e.dispatch,c=t.key,h=t.flowSetKey,p=t.isODB,d=t.pageContext;return{onMenuOpened:function(){var e,t;a.default.isActivated("DA7EB25D-BA31-4B7B-AA46-9D263BD88561","08/02/2019","Use Flow hostname from pageContext")?s.FlowWidgetProvider2.preloadSdk(p?f.HostId.ODB:f.HostId.SPO):s.FlowWidgetProvider2.preloadSdk(p?f.HostId.ODB:f.HostId.SPO,d);var i=new o.ItemResolver;i.resolveItems({items:(e={},e[h]=n.__assign({},u.allowLoadAllFlowsFacet.pack(!0)),e)});if(!a.default.isActivated("BC5D7ACA-4324-429A-AD49-DA59CBE8514B","08/05/2019","Invalidate flowInstanceSet and flowTemplateSet when menu is dismissed")){var v=u.flowTemplateSetKeyFacet.serialize({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl});i.invalidateItems({items:(t={},t[h]=[r.childItemsFacet],t[v]=[r.childItemsFacet],t)})}l(i.execute())},onMenuDismissed:function(){var e;l(i.resolveItems({items:(e={},e[h]=n.__assign({},u.allowLoadAllFlowsFacet.pack(!1)),e)}))}}}});
define("aUC",["require","exports","mU","f","cV","fl","aAq","cL","i1","aaP","bw"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.progId,n=e.resources,s=n.consume(i.actionMap);return o.isProgIdTeamChannelFolder(t)?r.createElement(f.default,{actionMap:s,resources:n}):null};return t})(r.PureComponent);t.TeamChannelHeaderBase=c;t.TeamChannelHeader=s.withCurrentItem()(u.connectToItemCache(function(e,t){return{progId:e.demandItemFacet(a.progIdFacet,t.itemKey)}})(l.withResources()(c)))});
define("aUD",["require","exports","mU","d0","iU","iP","hT","mJ","cu","es","WT","cv","iU","i1","cu","Es","gv","cd","iW","fR"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(){function e(e,t){void 0===e&&(e={});var n=t.itemUrlHelper,r=t.pageContext,i=t.itemCacheStore;this._itemCacheStore=i;this._pageContext=r;this._itemUrlHelper=n;this._itemsScopeCurrentItemKey=t.itemsScopeCurrentItemKey}e.prototype.invalidateItemSet=function(e){var t;this._itemCacheStore.dispatch(f.invalidateItems({items:(t={},t[e]=[d.childItemsFacet],t)}))};e.prototype.invalidateCurrentItemSet=function(){var e=this._itemsScopeCurrentItemKey.peek();if(e){var t=this._itemCacheStore.dispatch(c.readItems(function(t){return t.demandItemFacet(h.remoteItemKeyFacet,e)}));t?this.invalidateItemSet(t.remoteItemKey):this.invalidateItemSet(e)}};e.prototype.invalidateItems=function(e){var t,n=this._getItemKeyFromKOKey(e);this._itemCacheStore.dispatch(f.invalidateItems({items:(t={},t[n]=[a.defaultChildItemSetFacet],t)}))};e.prototype.invalidateCurrentView=function(){var e,t=this._itemsScopeCurrentItemKey.peek(),n=t&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,t)})),r=n&&n.viewKey&&h.spViewKeyFacet.serialize(n.viewKey);r&&this._itemCacheStore.dispatch(f.invalidateItems({items:(e={},e[r]=[p.serverViewFacet,p.currentDerivedViewFacet],e)}))};e.prototype.invalidateAvailableViews=function(){var e,t=this._itemsScopeCurrentItemKey.peek(),n=t&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,t)})),r=n&&i.spListViewsSetKeyFacet.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl});r&&this._itemCacheStore.dispatch(f.invalidateItems({items:(e={},e[r]=[d.childItemsFacet],e)}))};e.prototype.notifySpfxLoaded=function(e){var t,r=this._itemsScopeCurrentItemKey.peek(),i=r&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,r)})),s=i&&h.spListKeyFacet.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl});if(s){var o=void 0;try{if(e&&e.context&&e.context.preloadedData){var u=e,a=u.context.preloadedData;!a.spPageContextInfo&&u.context.pageContext&&u.context.pageContext.legacyPageContext&&(a.spPageContextInfo=u.context.pageContext.legacyPageContext);o=JSON.stringify(a)}}catch(e){console.log("Failed to get spfx application preloaded data to cache: "+e)}this._itemCacheStore.dispatch(y.resolveItems({items:(t={},t[s]=n.__assign(n.__assign({},b.isSpfxLoadedFacet.pack(!0)),o?b.spClientSideFrameworkContextFacet.pack(o):{}),t)}))}};e.prototype.invalidateListContentTypes=function(){var e,t=this._itemsScopeCurrentItemKey.peek(),n=t&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,t)})),r=n&&h.spListKeyFacet.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl});r&&this._itemCacheStore.dispatch(f.invalidateItems({items:(e={},e[r]=[p.contentTypeKeysFacet],e)}))};e.prototype.refreshItemsInCurrentItemSet=function(e){var t,n=this._itemsScopeCurrentItemKey.peek(),r=this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,n)}));if(n&&r){for(var s=r.webAbsoluteUrl,o=r.listFullUrl,u={},a=0,f=e;a<f.length;a++){var l=f[a];u[i.spItemKeyFacet.serialize({webAbsoluteUrl:s,listFullUrl:o,itemId:l})]={}}this._itemCacheStore.dispatch(v.refreshItemsInSet({items:(t={},t[n]=u,t)}))}};e.prototype.invalidateGroups=function(e){var t=e||[],n=this._itemsScopeCurrentItemKey.peek();if(n&&h.spFolderItemSetKeyFacet.matches(n)){if(0===t.length){var r=n&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(d.childItemsFacet,n)}));t=(r&&r.itemKeys||[]).filter(function(e){return i.spItemGroupKeyFacet.matches(e)})}if(t.length>0){this.invalidateItemSet(n);if(this._itemCacheStore.dispatch(g.readItem({defaultCollapsed:m.defaultCollapsedFacet},t[0])).defaultCollapsed){var s={};t.forEach(function(e){s[e]=[d.childItemsFacet]});this._itemCacheStore.dispatch(f.invalidateItems({items:s}))}}}};e.prototype._getItemKeyFromKOKey=function(e){var t=this._itemUrlHelper.getItemUrlParts(e);return i.spItemKeyFacet.serialize({webAbsoluteUrl:t.isCrossList?"":this._pageContext.webAbsoluteUrl,listFullUrl:t.fullListUrl,rootFolder:t.serverRelativeItemUrl!==t.serverRelativeListUrl?t.serverRelativeItemUrl:""})};e.dependencies={itemUrlHelper:r.resourceKey,pageContext:s.pageContext,itemCacheStore:u.resourceKey,itemsScopeCurrentItemKey:l.resourceKey};return e})();t.ItemInvalidator=w;t.resourceKey=o.createResolvedResourceKey(e("module").id,w)});
define("aUE",["require","exports","mU","d0","iU","iP","hT","mJ","cv","i1","hS","rc","MA","WT","h7","cu"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(){function e(e,t){void 0===e&&(e={});var n=t.itemUrlHelper,r=t.pageContext,i=t.itemCacheStore,s=t.itemsScopeCurrentItemKey,o=t.itemsScopeItemKey;this._itemCacheStore=i;this._pageContext=r;this._itemUrlHelper=n;this._itemsScopeCurrentItemKey=s;this._itemsScopeItemKey=o}e.prototype.updateItemShortcutValues=function(e,t,r){var s,o=this._getItemKeyFromKOKey(e,t),u=this._itemCacheStore.dispatch(a.readItems(function(e){return e.demandItem({key:i.spItemKeyFacet,rowData:f.rowDataFacet},o)})),c=u.key,h=u.rowData;if(c&&h){var p=n.__assign({},h);p._ShortcutUrl=r.url;p._ShortcutSiteId=r.siteId;p._ShortcutWebId=r.webId;p._ShortcutUniqueId=r.uniqueId;var d=new l.ItemResolver;d.resolveItems({items:(s={},s[o]=n.__assign({},f.rowDataFacet.pack(p)),s)});this._itemCacheStore.dispatch(d.execute())}};e.prototype.selectItems=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,s,o,u,f,l,h;return n.__generator(this,function(n){switch(n.label){case 0:t=[];r=this._itemsScopeCurrentItemKey.peek();if(!(s=r&&this._itemCacheStore.dispatch(a.readItems(function(e){return e.demandItemFacet(i.spFolderItemSetKeyFacet,r)})))||!r)return[2];for(o=0,u=e;o<u.length;o++){f=u[o];l={webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl,itemId:f};h=i.spItemKeyFacet.serialize(l);t.push(h)}return[4,this._itemCacheStore.dispatch(d.demandItems(function(e){e.demandItemFacet(v.childItemsFacet,r)}))];case 1:n.sent();this._itemCacheStore.dispatch(c.selectItems({itemsScopeItemKey:this._itemsScopeItemKey,selectedItemKeys:t,currentSelectionKey:void 0}));return[2]}})})};e.prototype._getItemKeyFromKOKey=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e);return i.spItemKeyFacet.serialize({webAbsoluteUrl:n.isCrossList?"":this._pageContext.webAbsoluteUrl,listFullUrl:n.fullListUrl,itemId:t||"",rootFolder:t||n.serverRelativeItemUrl===n.serverRelativeListUrl?"":n.serverRelativeItemUrl})};e.dependencies={itemUrlHelper:r.resourceKey,pageContext:s.pageContext,itemCacheStore:u.resourceKey,itemsScopeCurrentItemKey:p.resourceKey,itemsScopeItemKey:h.resourceKey};return e})();t.ItemUpdator=m;t.resourceKey=o.createResolvedResourceKey(e("module").id,m)});
define("aUF",["require","exports","mU","iX","iW","vy","cu","av"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.flowAddon=r.createAddon(function(){return function(t){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(a){t(u.asBatch(function(){t(r.registerOperationHandler(s.flowSetKeyFacet,i.getItemsOperation)(r.createDeferredOperationHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aUH"],t,n)})];case 1:return[2,t.sent().getFlowSetOperationHandler]}})})})));t(r.registerOperationHandler(s.flowTemplateSetKeyFacet,i.getItemsOperation)(r.createDeferredOperationHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aUH"],t,n)})];case 1:return[2,t.sent().getFlowTemplateSetOperationHandler]}})})})));t(i.supportFacets({keyFacet:s.flowSetKeyFacet,facets:[o.childItemsFacet]}));t(i.supportFacets({keyFacet:s.flowTemplateSetKeyFacet,facets:[o.childItemsFacet]}))}));return[2]})})}})});
define("aUG",["require","exports","ft","hH","T4"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFlowInstancesData=function(e,t){var o=r.getListApiUrl({webAbsoluteUrl:e,listFullUrl:t}).segment("SyncFlowInstances").toString();return function(r){return r(n.getData({webAbsoluteUrl:e,listFullUrl:t,method:"POST",url:o,qosName:"SyncFlowInstances",noRedirect:!0})).then(function(e){var t=s(e);return i.default.processFlowInstances(t,"Request")})}};t.getFlowTemplatesData=function(e,t,o){var u=r.getListApiUrl({webAbsoluteUrl:e,listFullUrl:t}).segment("SyncFlowTemplates").toString(),a=o?JSON.stringify({category:o}):"";return function(t){return t(n.getData({webAbsoluteUrl:e,listFullUrl:"",method:"POST",url:u,body:a,qosName:"SyncFlowTemplates",noRedirect:!0})).then(function(e){var t=s(e);return i.default.processTrustedTemplates(t,"OOB_CURRENT")})}};function s(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=JSON.stringify(e);var n=e;t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t}});
define("aUH",["require","exports","mU","cu","vy","iU","i1","iX","iW","cd","an","aUG","T5","aUB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFlowSetOperationHandler=u.createSingleItemOperationHandler()(function(e){var t=this,s=e.itemKey,o=i.flowSetKeyFacet.deserialize(s),u=o.webAbsoluteUrl,f=o.listFullUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,l;return n.__generator(this,function(h){switch(h.label){case 0:t={};return[4,e(c.getFlowInstancesData(u,f))];case 1:l=h.sent();(function(e,t,s,o){var u=[];o.forEach(function(t){var r=i.flowItemKeyFacet.serialize(n.__assign(n.__assign({},s),{id:t.id}));e[r]=n.__assign({},p.flowItemFacet.pack(t));u.push(r)});e[t]=n.__assign({},r.childItemsFacet.pack({itemKeys:u}))})(t,s,o,l);e(a.resolveItems({items:t}));return[2]}})})}});t.getFlowTemplateSetOperationHandler=u.createSingleItemOperationHandler()(function(e){var t=this,u=e.itemKey,d=i.flowTemplateSetKeyFacet.deserialize(u),v=d.webAbsoluteUrl,m=d.listFullUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:t={};g=e(f.readItem({list:o.listFacet},s.spListKeyFacet.serialize({webAbsoluteUrl:v,listFullUrl:m})));(y=g.list&&g.list.templateType)===l.default.mySiteDocumentLibrary?b=h.EnvironmentAppropriateODBTemplateCategory:l.isDocumentLibrary(y)?b="OOB_SHAREPOINT_LIBRARY":l.isGenericList(y)&&(b="OOB_SHAREPOINT_LIST");return[4,e(c.getFlowTemplatesData(v,m,b))];case 1:w=E.sent();(function(e,t,s,o){var u=[];o.forEach(function(t){var r=i.flowTemplateItemKeyFacet.serialize(n.__assign(n.__assign({},s),{id:t.templateId}));e[r]=n.__assign({},p.flowTemplateItemFacet.pack(t));u.push(r)});e[t]=n.__assign({},r.childItemsFacet.pack({itemKeys:u}))})(t,u,d,w);e(a.resolveItems({items:t}));return[2]}})})}})});
define("aUI",["require","exports","mU","mG","hT","iX","cg","Qo","aM","hS","h7","cv","eQ","iN","Mw","es","bv","gV","ci"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:{urlDataSource:a.url,itemTaskObserverType:u.resourceKey},create:function(e){var t=e.urlDataSource,i=e.itemTaskObserverType;return{instance:s.createSingleItemOperationHandler({maxParallelOperationCount:16,mergeForSameItemKey:!0})(function(e){var s=this,a=r.odspNextStoreKeyFacet.deserialize(e.itemKey).itemKey;return function(b){return n.__awaiter(s,void 0,void 0,function(){var s,w,E,S,x,T,N,C,k,L,A,O,M;return n.__generator(this,function(_){switch(_.label){case 0:if(!(s=b(c.readItems(function(e){var t=e.demandItemFacet(h.itemKeyToStoreKeyControl,p.odspNextAppItemKey);return h.itemKeyToStoreKeyControl.evaluate(t)(e,{itemKey:a,viewParams:{}})})).storeKey))return[3,5];w=s.key;E=t.getKeyParams(w);S=t.getQueryType(E);(x=new i).update([new u.Task(w).succeed({item:{key:w,queryType:S}})]);_.label=1;case 1:_.trys.push([1,3,,4]);return[4,b(l.demandItems(function(e){return e.demandItemFacet(d.oneDriveItemFacet,a)}))];case 2:T=_.sent();x.update([new u.Task(w).succeed({item:T})]);return[3,4];case 3:N=_.sent();C=0;k="";L="";N instanceof Error&&(L=N.message);N instanceof y.ApiError&&(k=N.code);N instanceof o.ItemOperationError&&(g.itemNotFoundErrorFacet.unpack(N.facets)||g.accessDeniedErrorFacet.unpack(N.facets)?C=2:g.authFailureErrorFacet.unpack(N.facets)&&(C=1));x.update([new u.Task(w).succeed({item:{error:{type:C,data:{errorCode:k,errorTitle:L}}}})]);return[3,4];case 4:x.flush();_.label=5;case 5:(A=new f.ItemResolver).resolveItems({items:n.__assign(n.__assign({},a?(O={},O[a]=n.__assign({},v.getInvalidationFacet().forFacet(m.displayNameFacet).thenInvalidate(e.itemKey,r.createdStoreItemFacet).pack()),O):{}),(M={},M[e.itemKey]=n.__assign({},r.createdStoreItemFacet.pack(void 0)),M))});b(A.execute());return[2]}})})}})}}}})});
define("aUJ",["require","exports","mU","hT","Kl","cV","PY","aUL","Qq","Qo","r","Vv","iP","auV","an","Qp","auW","mx","Qd","aUK","v","M9","Kt","VA","mJ","cv","eQ","iN","aR","i1","iU","WU","cT","cU","cu","gv","aV","mD","Zo","eG","aN8","bu","fR","V2"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var W=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._listItemBuilder=n.listItemBuilder;r._listItemResultProcessor=n.listItemResultProcessor;r._store=n.itemsStore;r._itemTaskObserverType=n.itemTaskObserverType;r._itemsScopeItemKeyToKOItemKeyMap={};r._itemProvider=n.itemProvider;r._resources=n.resources;r._listContext=n.listContext;r._pageContext=n.pageContext;r._microServiceDataSource=n.microServiceDataSource;r._smartFiltersStore=n.smartFiltersStore;r._onePageContext=n.onePageContext;r._itemCacheStore=n.itemCacheStore;r._getItemsScopeCurrentViewKey=n.getItemsScopeCurrentViewKey;r._getItemsScopeCurrentDerivedView=n.getItemsScopeCurrentServerView;r._bundleLoaderProvider=n.bundleLoaderProvider;r._itemsScopeManager=n.itemsScopeManager;r._useItemsScope=n.useItemsScope;r._clientSideExtensionHelper=n.clientSideExtensionHelper;r.koItem=r._currentKOItem=n.currentKOItem;r.koItemSet=r._currentKOItemSet=n.currentKOItemSet;r.selectedKOItemKeys=r._selectedKOItemKeys=r.observables.create([]);r._initializeStateSubscription();return r}t.prototype._initializeStateSubscription=function(){var e=this,t=this._itemCacheStore,n={},r={currentItemKey:void 0,currentItemSetKey:void 0,selectedItemKeys:[],parentItemKey:void 0,childItems:void 0,getItemResponse:void 0,spFolderItemSet:void 0},i={},s=function(){var t;t=e._onStoreUpdate(r,n,i),r=t.itemsScopeInfo,n=t.keyMap};s();t.subscribe(s);this.observables.backgroundCompute(function(){e._bundleLoaderProvider.isPageLoaded.peek()?s():e._bundleLoaderProvider.isPageLoaded()})};t.prototype._onStoreUpdate=function(e,t,n){if(!this._bundleLoaderProvider.isPageLoaded.peek())return{itemsScopeInfo:e,keyMap:t};var r=this._itemCacheStore,i=this._itemsScopeManager.itemsScopeItemKey,s=r.dispatch(X({itemsScopeItemKey:i}));if(!this._useItemsScope.peek())return{itemsScopeInfo:s,keyMap:t};if(s.currentItemKey){var o=s.childItems,u=o&&o.itemKeys&&o.itemKeys.length>0&&V(r,o.itemKeys[0]);if(u||e.childItems!==s.childItems||e.parentItemKey!==s.parentItemKey||e.getItemResponse!==s.getItemResponse){var a=s.parentItemKey,f=s.getItemResponse;if(o&&a){var l={},c=!1,h=!1,p=o.itemKeys;if(!n[a]||n[a].getItemResponse!==f){n[a]={getItemResponse:f};c=!0}u&&(p=(function(e,t){for(var n=!1,r=!1,i=[],s=0;s<t.itemKeys.length;s++){var o=$(e,t.itemKeys[s]),u=o&&o.itemKeys;if(u){if(!n){r=u.length>0&&V(e,u[0]);n=!0}if(r)for(var a=0;a<u.length;a++){var f=$(e,u[a]),l=f&&f.itemKeys;l&&(i=i.concat(l))}else i=i.concat(u)}}return i})(r,o));for(var d=function(e){var i=r.dispatch(N.readItems(function(t){return{rowData:t.demandItemFacet(A.rowDataFacet,e)}})).rowData;if(n[e]&&n[e].rowData===i)l[e]={item:{rowData:i},mappedKOItemKey:t[e]};else{h=!0;n[e]={rowData:i};l[e]={item:{rowData:i}}}},v=0,m=p;v<m.length;v++){d(m[v])}(h||c||e.currentItemKey!==s.currentItemKey)&&(t=this._updateKOCurrentItemSet({itemsScopeItemKey:i,allChildItems:l,childItemsChanged:h,shouldSkipProcessParentItem:!c}).itemsScopeItemKeyToKOItemKeyMap)}}}if((function(e,t){if(e.length!==t.length)return!0;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(e.indexOf(i)<0)return!0}return!1})(e.selectedItemKeys,s.selectedItemKeys)){var g=s.selectedItemKeys.map(function(e){return t[e]});this._selectedKOItemKeys(g)}return{itemsScopeInfo:s,keyMap:t}};t.prototype._updateKOCurrentItemSet=function(e){var t=this,r=e.itemsScopeItemKey,i=e.childItemsChanged,o=e.allChildItems,u=e.shouldSkipProcessParentItem,a=this._itemCacheStore,f=a.dispatch(X({itemsScopeItemKey:r})),c=f.parentItemKey,y=f.getItemResponse,x=f.spFolderItemSet,T={itemKey:c},M=x||{},_=M.webAbsoluteUrl,D=void 0===_?void 0:_,P=M.listFullUrl,H=void 0===P?void 0:P,B=a.dispatch(N.readItems(function(e){return{folderPath:e.demandItemFacet(A.folderPathFacet,c),permissions:e.demandItemFacet(A.permissionsFacet,c)}})),j={id:B.folderPath,permissions:B.permissions},F=this._getItemsScopeCurrentViewKey(),U=this._getItemsScopeCurrentDerivedView(F),z=O.spListKeyFacet.serialize({webAbsoluteUrl:D,listFullUrl:H}),W=a.dispatch(N.readItems(function(e){var t=e.demandItemFacet(A.contentTypeKeysFacet,z)||[],n=e.demandItemFacet(A.contentTypeKeysFacet,c)||[];return{contentTypes:t.map(function(t){return e.demandItemFacet(A.spListContentTypeFacet,t)}),folderContentTypeOrder:n.map(function(t){return e.demandItemFacet(A.spFolderContentTypeFacet,t)})}})),V=W.contentTypes,$=W.folderContentTypeOrder,J=this._itemCacheStore.dispatch(N.readItems(function(e){return e.demandItemFacet(A.spPageContextFacet,O.spPageContextKeyFacet.serialize({webAbsoluteUrl:D,listFullUrl:H}))}));y&&m.ListItemBuilderHelpers.updateListContext(y,this._listContext);var K=this.resources.consume(q.resourceKey);K&&g.default.isActivated("975DFDE1-C9F7-44A9-A628-D9DD6F9BB63D","09/05/2019","Make power app pre-loading more robust")&&K.ensureListContextUpdateSignal().complete();if(J&&(J.listId!==this._pageContext.listId||(g.default.isActivated("014E6872-FBDF-42B0-9BAE-1737B6B830DA","12/16/2019","updatePageContext when current pageContext has no listUrl")?!J.listUrl&&!this._pageContext.listUrl&&this._listContext.listUrl:!this._pageContext.listUrl)||(g.default.isActivated("0DF86B3C-ACA4-472B-85E0-639FD555D129","10/03/2019","Compare listId without guid casing")?this._listContext.listId!==this._pageContext.listId:R.default.normalizeLower(this._listContext.listId)!==R.default.normalizeLower(this._pageContext.listId)))){var Q=this._onePageContext;if(Q){this._listContext.refreshClientForm=!0;if(J.listUrl&&this._listContext.listId.toUpperCase()===J.listId.toUpperCase())w.extend(this._pageContext,J);else{this._pageContext.listUrl=this._listContext.listUrl;this._pageContext.listId=this._listContext.listId;this._pageContext.listTitle=this._listContext.listTitle;this._pageContext.listBaseTemplate=this._listContext.listTemplateType}this._pageContext.serverRequestPath=void 0;var G=this.resources.consume(E.resourceKey.optional);if(G){G.clearCachedPromise();S.isFeatureEnabled(S.UnifiedSuiteNavComponent)&&G.updateWorkloadSettingsLinks()}!g.default.isActivated("F15472FB-A9F0-4CCA-A09B-03D069E05542","10/07/2019","Update SPFX context during navigation")&&this._useItemsScope.peek()&&this._updateSpfxContext(z);Q.onePageNavigationDataFetch(!0);Q.onePageNavigationDataFetch(!1)}}var Y=(0,this._itemCacheStore.dispatch)(N.readItems(function(e){var t=e.demandItemFacet(C.itemKeyToStoreKeyControl,k.odspNextAppItemKey),n=e.demandItemFacet(L.currentViewParamsFacet,r),i=C.itemKeyToStoreKeyControl.evaluate(t)(e,{itemKey:T.itemKey,viewParams:n||{}}).storeKey;return i&&i.key}));g.default.isActivated("52ED4F2F-FCC0-471E-9ED1-8B40BF0D8F21","10/22/2019","invalidate smartfilters info only when new item is added or updated")&&i&&Y&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(Y);var Z=new this._itemTaskObserverType,ee=[];if(y&&T&&!u){var te=y.ListSchema;te&&!S.isFeatureEnabled(S.SkipSettingMicroserviceBaseInfo)&&this._microServiceDataSource.setBaseInfo({data:te,allowCookies:!1});this._listItemResultProcessor.processResponse({response:y,requestKey:Y,observer:Z});g.default.isActivated("AA918EC4-B203-49D2-9EF6-0DB64E830D56","1/09/2018","Disable list token update automatically")||this.resources.consumeAsync(b.resourceKey).then(function(e){e.trackListToken(Y)});this._itemsScopeItemKeyToKOItemKeyMap[T.itemKey]=Y}j&&Z.update([new v.default(Y).succeed({item:n.__assign(n.__assign({},j),{folder:{},type:I.default.Folder,isDropEnabled:!0,isPlaceholder:!1})})]);var ne=this.resources.consume(s.currentView);U&&ne&&ne(U.clone());var re=this.resources.consume(h.contentTypes.optional);re&&re(V);for(var ie in o){var se=o[ie],oe=se.item,ue=se.mappedKOItemKey;if(ue){this._itemsScopeItemKeyToKOItemKeyMap[ie]=ue;ee.push(ue)}else{var ae=oe.rowData;if(ae){var fe=this._listItemBuilder.getItemResult({itemFromServer:n.__assign({},ae),parentItemKey:Y,requestKey:Y,queryType:l.default.Files,supportsNestedGroups:!1,isItemDataOnly:!0,observer:Z});this._itemsScopeItemKeyToKOItemKeyMap[ie]=fe.item.key;ee.push(fe.item.key)}}}var le=void 0;y&&y.ListSchema&&(le=p.getListSchema({listSchema:y.ListSchema,resources:this._resources,groupSchema:{},hasFixedSchema:this._listContext.listTemplateType===d.ListTemplateType.mySiteDocumentLibrary,listContext:this._listContext,getItemContext:void 0,sortFallback:{sortField:y.ListData.SortField,sortDirection:y.ListData.SortDir}}));if(Y||ee.length){Z.flush();var ce=this._store.getItem(Y),he=ee.map(function(e){return t._store.getItem(e)}),pe=this._itemProvider.getItemSync({parentKey:Y});pe.isPlaceholder=!1;pe.content({items:he,groupings:[]});le&&pe.schema(le);ce&&this._currentKOItem(ce.peek());$&&pe.contentTypes($);this._currentKOItemSet(pe)}return{itemsScopeItemKeyToKOItemKeyMap:this._itemsScopeItemKeyToKOItemKeyMap}};t.prototype._updateSpfxContext=function(e){if(this._itemCacheStore&&this._listContext&&e&&this._clientSideExtensionHelper)try{var t=(0,this._itemCacheStore.dispatch)(N.readItems(function(t){return{cachedSpfxPageContext:t.demandItemFacet(U.spClientSideFrameworkContextFacet,e)}})).cachedSpfxPageContext,n=this._clientSideExtensionHelper.getApplication();if(n&&"function"==typeof n.navigateToPreloadedData&&t){var r=n&&n.context&&n.context.pageContext&&n.context.pageContext.list&&n.context.pageContext.list.id&&n.context.pageContext.list.id.toString();R.default.normalizeLower(r)!==R.default.normalizeLower(this._listContext.listId)&&n.navigateToPreloadedData(JSON.parse(t))}}catch(e){console.log("Error updating SpfxContext, error "+e)}};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{itemsStore:o.resourceKey,listItemBuilder:u.resourceKey,listItemResultProcessor:a.resourceKey,currentKOItem:s.currentItem,currentKOItemSet:s.currentItemSet,itemTaskObserverType:f.resourceKey,itemProvider:c.resourceKey,listContext:h.listContext,microServiceDataSource:y.resourceKey,pageContext:h.pageContext,smartFiltersStore:x.smartFiltersStore.optional,onePageContext:h.onePageContext.optional,itemCacheStore:T.resourceKey,getItemsScopeCurrentViewKey:M.getItemsScopeCurrentViewKeyResourceKey,getItemsScopeCurrentServerView:M.getItemsScopeCurrentDerivedViewResourceKey,bundleLoaderProvider:B.bundleLoader,itemsScopeManager:j.resourceKey,useItemsScope:F.resourceKey,clientSideExtensionHelper:z.clientSideExtensionHelper.optional});return t})(i.default);t.default=W;function X(e){var t=e.itemsScopeItemKey;return function(e){return e(N.readItems(function(e){var n=e.demandItemFacet(D.currentItemFacet,t),r=n&&n.itemKey,i=e.demandItemFacet(D.selectedItemsFacet,t),s=i&&i.itemKeys||[],o=_.getItemSetKey(e,{itemKey:r}),u=e.demandItemFacet(O.spFolderItemSetKeyFacet,o),a=e.demandItemFacet(P.childItemsFacet,o),f=e.demandItemFacet(P.parentItemFacet,o);return{currentItemKey:r,selectedItemKeys:s,spFolderItemSet:u,childItems:a,parentItemKey:f&&f.itemKey,getItemResponse:e.demandItemFacet(A.getItemResponseFacet,o),currentItemSetKey:o}}))}}function V(e,t){return!!e.dispatch(N.readItems(function(e){return e.demandItemFacet(H.isGroupFacet,t)}))}function $(e,t){return e.dispatch(N.readItems(function(e){return e.demandItemFacet(P.childItemsFacet,t)}))}t.resourceKey=r.createResolvedResourceKey(e("module").id,W)});
define("aUL",["require","exports","mU","Kl","eF","XV","r","dg","aUQ","Ff","eD","Vj","aUP","aUO","eG","f8","aIv","H9","Qu","Kt","XB","au6","A","bu","an","aM","au5","iP","aUN","aC","Qp","H8","d0","Qt","Qd","v","auW","hT","mx","bc","arT","arS","aBn","aUM","cw","arR"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var V=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageContext=n.pageContext;r._urlDataSource=n.urlDataSource;r._listContext=n.listContext;r._navigation=n.navigation;r._microServiceDataSource=n.microServiceDataSource;r._vroomUrlHelper=n.vroomUrlHelper;r._itemUrlHelper=n.itemUrlHelper;r._vroomDataContext=n.vroomDataContext;r._shortcutLinkDataSource=n.shortcutLinkDataSource;r._isActivityFeatureEnabled=n.isActivityFeatureEnabled;r._allowWrsExcel=!F.default.isActivated("4F4F63D5-6B0D-4B6E-B98F-93975947DEED","6/13/2019","Use OneUpWrs instead of OneUpWAC for Excel");r._allowWrsVisio=!1;r._htmlDecodeDiv=document.createElement("textarea");return r}t.prototype.getItemResult=function(e){try{return this._getItemResult(e)}catch(e){I.default.log(e,"ListItemBuilder.getItemResult");throw e}};t.prototype._getItemResult=function(e){var t,r,a,m,N=e.itemFromServer;if(!N)return null;var k,L=e.microServiceDataSource||this._microServiceDataSource,A=this._urlDataSource,_=e.requestKey,D=e.parentItemKey,P=e.queryType,j=void 0===P?A.getQueryType():P,I=e.groupBy,q=e.itemGroups,U=e.contentTypes,X=e.supportsNestedGroups,V=e.isItemDataOnly,J=e.listTemplateType,K=void 0===J?this._listContext.listTemplateType:J,Q=e.observer,G=A.getKeyParams(_),Y=this._itemUrlHelper.getUrlParts({path:N.id||N.FileRef||N.ServerRelativeUrl,listUrl:G.listurl});k=((t={}).id=Y.serverRelativeItemUrl,t.listurl=Y.normalizedListUrl,t);var Z=N.File_x0020_Type,ee=Z?"."+Z:"",te=this._parseMediaServiceMetadata(N.MediaServiceFastMetadata),ne=this._parseMediaServiceMetadata(N.MediaServiceMetadata),re=this._getItemType({itemFromServer:N,listTemplateType:K,microServiceDataSource:L,mediaServiceFastMetadata:te});if(re===d.default.Folder){var ie=G.id===k.id,se=A.getItemTypeFilter(G),oe={};if(ie)oe=((r={}).view=G.view,r.q=G.q,r.typeFilters=G.typeFilters,r);else{j!==o.default.Search&&(oe=((a={}).view=j,a));se&&H.extend(oe,A.saveItemTypeFilter(se))}H.extend(k,oe)}var ue=A.getKey(k),ae={key:ue,extension:ee},fe=N.id||N.FileRef;ae.id=fe;var le,ce,he=y.default.fromHexString(N.PermMask),pe=W.PermissionMask.hasPermission(he,W.PermissionMask.openItems),de=this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled||!pe,ve=N[".spItemUrl"];if(ve){var me=this._vroomUrlHelper.getUrlParts(ve);le=me.itemId;ce=me.driveId}else le=N["name.FileSystemItemId"]||(N.isRootFolder?"root":void 0);this._vroomDataContext&&le&&this._vroomDataContext.setFileSystemIdMapping(le,fe);var ge=N[".etag"];ge&&(ae.eTag=ge);ae.itemId=M.optional(le);var ye=K===T.ListTemplateType.mySiteDocumentLibrary;ae.graph=M.optional(le&&{itemId:le,driveId:ce,driveType:K?ye?"business":"documentLibrary":void 0});var be=Number(N._ip_UnifiedCompliancePolicyUIAction)||0;"1"===this._navigation.viewParams.showpolicytips&&(be=Number(N.ID)%6);ae.policyTip=M.optional(be);var we=C.isDicomFile(ee);(we||".ai"===ee||".eps"===ee||".psd"===ee)&&L.getThumbnail({fileExtension:ee,item:N,itemKey:ue,mediaServiceMetadata:te})&&(re=d.default.Media);if(R.canRenderNative(ee))ae.htmlConversion={};else if(R.canConvert(ee)){if(Ee=L.getHtmlConversionUrl({fileExtension:ee,item:N,mediaServiceMetadata:te})){re=d.default.Media;ae.htmlConversion={url:Ee+"&inlineImages=true"}}}if(b.isFeatureEnabled(b.EnableZipFilePreviewing)&&(".zip"===ee||".rar"===ee)){var Ee=L.getZipMetaDataUrl({fileExtension:ee,item:N,mediaServiceMetadata:te}),Se=L.getDownloadZipContentsUrl(N);if(Ee&&Se){re=d.default.Media;ae.zip={zipMetaDataUrl:Ee,downloadZipContentsUrl:Se}}}var xe,Te,Ne,Ce,ke,Le,Ae={},Oe=L.getDownloadAsZipUrl(N);Oe&&(Ae[i.default.downloadAsZip]=Oe);ve&&(Ae[i.default.itemUrl]=ve);var Me=this._listContext,_e=Number(N.File_x0020_Size)||Number(N.FileSizeDisplay)||void 0,De=te&&te.video,Pe=".ts"===ee&&_e<1<<19&&!De;Pe&&(re=d.default.File);var He=te&&te.media,Be=F.default.isActivated("AE18621B-70BE-46AB-B681-F87FE63EBAA4","12/10/2019","Obtain item openUrl from full item path")?this._itemUrlHelper.getUrlParts({path:N.FileRef,listUrl:Y.normalizedListUrl}).normalizedItemUrl:Y.fullItemUrl,je=Be?l.canonicalizeDecodedUrl(Be):void 0;if(re===d.default.Folder)xe=N.ProgId&&"sharepoint.documentset"===N.ProgId.toLowerCase();else if(re!==d.default.Media&&!te||T.isPromotedLinksList(K))re===d.default.File&&Me&&void 0!==Me.isDocLib&&!Me.isDocLib&&(Te={});else{var Fe=f.getIconNameFromExtension(ee),Ie=te&&te.photo||(we||"photo"===Fe?{}:void 0),qe=De||("video"===Fe?{}:void 0),Re=te&&te.audio||("audio"===Fe?{}:void 0);if(Ie){Ne={originalUrl:M.optional("photo"===Fe?je:void 0),width:Ie.width||0,height:Ie.height||0};b.isFeatureEnabled(b.Image360Viewer)&&le&&(Ce=this._getImage360(N,te,Ie,ne))}qe&&(ke={fourCC:M.optional(qe.fourCC||(".mp4"===ee.toLowerCase()?"H264":void 0)),bitrate:M.optional(qe.encodingBitrate),width:qe.frameWidth||0,height:qe.frameHeight||0,duration:$(He&&He.duration),audioFormat:M.optional(Re&&Re.format),manifestMetadata:qe.manifestMetadata,altManifestMetadata:qe.altManifestMetadata});Re&&(Le={duration:$(He&&He.duration)})}var Ue=He&&He.title;ae.caption=M.optional(Ue);ae.photo=M.optional(Ne);ae.image360=M.optional(Ce);ae.video=M.optional(ke);ae.audio=M.optional(Le);ae.listItem=M.optional(Te);D&&(ae.parentKey=D);ae.isDocSet=M.optional(xe);Y.serverRelativeItemUrl===Y.serverRelativeListUrl&&(ae.isRootFolder=!0);var ze,We=B.ListItemBuilderHelpers.getItemName(N,re,Me);ae.name=M.optional(We);ae.displayName=M.optional(We);var Xe,Ve=!0;if(N.Modified&&"21"===this._pageContext.webTemplate&&b.isFeatureEnabled(b.RequestDatesInUtc))try{var $e=new Date(N.Modified);ae.dateModifiedTime=$e;ae.dateModifiedValue=$e.getTime();ze=v.getShortDisplayDate($e);Ve=!1}catch(e){}if(Ve){ae.dateModifiedValue=M.optional(N.Modified);ze=N["Modified.FriendlyDisplay"]?v.getRelativeDateTimeStringForLists(N["Modified.FriendlyDisplay"]):N.Modified?""+N.Modified:""}ae.dateModified=M.optional(ze||void 0);ae.permissions=M.optional(he);if(q&&I&&I.length>0)if(X){q[0]||(q[0]=[]);var Je=q[0]&&q[0].length>0?q[0][q[0].length-1]:null,Ke=I[0],Qe=I[1];if(Ke&&"1"===N[Ke+".newgroup"]){var Ge=Je?Je.startIndex+Je.count:0,Ye=B.GroupBuilder.buildGroup(Me,N,Ke,0,!1,Ge),Ze=this._convertToODNGroup(Ye);q[0].push(Ze);Je=Ze}if(Qe&&"1"===N[Qe+".newgroup"]){var et=Je&&Je.children&&Je.children.length>0?Je.children[Je.children.length-1]:null;Ge=et?et.startIndex+et.count:Je?Je.startIndex:0;B.GroupBuilder.buildGroup(Me,N,Qe,1,!1,Ge,Je);var tt=Je.children.pop();Je.children.push(this._convertToODNGroup(tt))}}else for(var nt=0;nt<I.length;nt++){var rt=I[nt];if(rt){var it=q[nt]&&q[nt].length>0?q[nt][q[nt].length-1]:null;if("1"===N[rt+".newgroup"]){Ge=it?it.startIndex+it.count:0,Ze=B.GroupBuilder.buildGroup(Me,N,rt,nt,!1,Ge);q[nt]||(q[nt]=[]);q[nt].push(this._convertToODNGroup(Ze))}}}if(U&&U.length>0&&N.ContentTypeId)for(var st=0,ot=U;st<ot.length;st++){var ut=ot[st];if(N.ContentTypeId===ut.contentTypeId){Xe=!1;if(ut.requiredFields)for(var at=0,ft=ut.requiredFields.split(",");at<ft.length;at++){var lt=N[ft[at]];if(!lt||Array.isArray(lt)&&0===lt.length){Xe=!0;break}}}}ae.hasMissingMetadata=M.optional(Xe);ae.contentTypeId=M.optional(N.ContentTypeId);var ct,ht,pt,dt,vt,mt=N.folder,gt=[];if(mt){ae.folder={};ae.isDropEnabled=!0;ct=[];if(mt.children){for(var yt=0,bt=mt.children,wt=bt.length,Et=0,St=0;St<wt;St++){var xt=this.getItemResult({requestKey:_,queryType:j,itemFromServer:bt[St],groupBy:I,itemGroups:gt,contentTypes:U,listTemplateType:K,supportsNestedGroups:X,isItemDataOnly:V,observer:Q});if(xt){ct[St]=xt.item;Et<10&&xt.itemType===d.default.Media&&yt++;Et++}}wt>0&&(yt>=10||yt>=wt)&&(ae.displayType=o.default.Photos)}}else{pt=(pt=N["serverurl.progid"])?pt.substring(1):je;Ae[i.default.original]=pt;if(b.isFeatureEnabled(b.ShortcutLink)&&g.default.isShortcutItem({key:ue,extension:ee})){re=d.default.Shortcut;if(N._ShortcutUrl){ae.shortcutInfo={shortcutLinkRewritten:!0};Ae[i.default.shortcutTarget]=this._shortcutLinkDataSource.generateShortcutsOpenUrl(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl,N._ShortcutUrl,N._ShortcutSiteId,N._ShortcutWebId,N._ShortcutUniqueId);N._ShortcutUniqueId&&(ht=s.previewImageUrl({url:N._ShortcutUrl,siteId:N._ShortcutSiteId,webId:N._ShortcutWebId,uniqueId:N._ShortcutUniqueId},this._pageContext.webAbsoluteUrl,this._pageContext))}else{ae.shortcutInfo=M.backup({shortcutLinkRewritten:!1});this._shortcutLinkDataSource.enqueueParseShortcut(ue,e.itemFromServer.ID);Ae[i.default.shortcutTarget]=u.default.concatenate(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl)+"/ShortcutLink.aspx?shortcut="+S.default.encodeURIComponent(N.FileRef)}}Ae[i.default.open]=pt;dt=N["File_x0020_Type.mapapp"]||N["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];if(Y.isCrossDomain&&Y.isCrossList){var Tt=w.getOfficeFileType(N[".fileType"]);dt=void 0===Tt?dt:Tt;"OneNote.Notebook"===N.HTML_x0020_File_x0020_Type&&(dt="onenote|UsePlain");"pdf"===N.File_x0020_Type&&(dt=void 0)}ae.size=M.optional(_e);ae.totalSize=M.optional(Number(N.SMTotalSize)||void 0);ht||(ht=this._getThumbnail({itemFromServer:N,listTemplateType:K,extension:ee,key:ue,type:re,mediaServiceFastMetadata:te,microServiceDataSource:L}));ae.openUrl=pt;var Nt=N["IconOverlay.mapoly"];Nt&&(ae.overlayUrl="/"+this._pageContext.layoutsUrl+"/images/"+Nt);ae.thumbnail=ht;var Ct=this._getPdfConversionFacet({extension:ee,blockDownload:de,itemFromServer:N,microServiceDataSource:L,mediaServiceFastMetadata:te});Ct&&(ae.pdfConversion=Ct);var kt=this._get3dFacet({extension:ee,itemFromServer:N,microServiceDataSource:L,mediaServiceFastMetadata:te});kt&&(ae.model3d=kt);if(re===d.default.Folder){var Lt=Number(N.ItemChildCount)+Number(N.FolderChildCount);ae.childCount=Lt;var At=Number(N.SMTotalFileCount);ae.folder={totalCount:At>0?At:Lt,childCount:Lt};ae.isDropEnabled=!0}var Ot=N.ServerRedirectedEmbedUrl;Ot&&(this._itemUrlHelper.getUrlParts({path:Ot}).isCrossDomain||(vt=Ot))}ae.previewIFrameUrl=vt;ae.type=re;ae.appMap=M.optional(dt);this._pageContext.blockDownloadsExperienceEnabled&&(ae.type===d.default.Media||pt&&dt)?ae.itemStatus=4:this._pageContext.blockDownloadsExperienceEnabled&&re!==d.default.Folder?ae.itemStatus=3:this._pageContext.viewOnlyExperienceEnabled&&(ae.itemStatus=4);var Mt={};for(var _t in N)N.hasOwnProperty(_t)&&(Mt[_t]=N[_t]);var Dt=x.default.normalizeLower(N.UniqueId)||void 0;Dt&&(Mt.uniqueId=Dt);var Pt=N.RemoteItem;ae.remoteItem=Pt&&JSON.parse(Pt);ae.reputationProperties=this.getReputationProperties(N);var Ht,Bt=We;ee&&(Bt=We.substring(0,We.toLowerCase().lastIndexOf(ee.toLowerCase())));ae.sharingRole=0;Ht=Number(N.PrincipalCount)>0?c.default.Shared:void 0===N.PrincipalCount?b.isOneDrive?void 0:c.default.Unknown:c.default.Private;ae.sharingType=M.optional(Ht);Mt.FileName=Bt;var jt=f.getIconNameFromItem({extension:ee,isDocSet:xe,listItem:Te,sharingType:Ht,type:re,textEditorMimeType:Pe?"text/typescript":void 0,panorama:Ce});ae.iconName=jt;var Ft="ms-excel"===dt,It="ms-powerpoint"===dt,qt="ms-visio"===dt,Rt="ms-word"===dt;if(pt&&(Rt||Ft||It||qt)){var Ut=this._getOfficeBundleFacet({isWord:Rt,extension:ee,itemUrlParts:Y,isPowerPoint:It,itemFromServer:N,microServiceDataSource:L,mediaServiceFastMetadata:te});!Ut||Ft&&!this._allowWrsExcel||qt&&!this._allowWrsVisio||(ae.officeBundle=Ut);Ut&&(Rt||It)&&(Ae[i.default.viewInBrowser]=L.getPdfConversionUrl({fileExtension:ee,item:N,mediaServiceMetadata:te},!0));ae.wopiFrameUrl=pt}ae.defaultSubText=E.getGridSubTitleTextFromModifiedBy(E.getModifiedByFromObject(N.Editor));ae.isPlaceholder=!N.PermMask;ae.queryType=j;ae.displayType=M.backup(ae.queryType);ae.isDraggable=ae.queryType===o.default.Files;N.folder||(Mt.modifiedByUser=E.getModifiedByUserFromObject(N.Editor));Mt.MediaServiceOCR=E.getOcrFromHtmlString(N.MediaServiceOCR);ae.properties=Mt;ae.lifeCycleStatus=M.optional(this._getItemLifeCycleStatus(N));var zt=N._CommentFlags;b.isFeatureEnabled(b.EnableCommentsForSPCustomList)&&this._listContext.listTemplateType===T.ListTemplateType.genericList&&(zt=2);ae.comments={settings:z.getCommentFlags(zt)};ae.urls=n.__assign(n.__assign(n.__assign({},Ae),this._getVideoUrl({extension:ee,itemFromServer:N,microServiceDataSource:L,mediaServiceFastMetadata:te})),((m={})[i.default.mediaBaseUrl]=L.getMediaBaseUrl({fileExtension:ee,item:N,mediaServiceMetadata:te}),m));Q.update([new O.default(ue).succeed({item:ae})]);b.isFeatureEnabled(b.ItemAnalytics)&&b.isFeatureEnabled(b.EnableTrendingSignalInListView)&&ue&&this.resources.consumeAsync(h.resourceKey).then(function(e){e.queueNewItem(ue)});var Wt=this._isActivityFeatureEnabled;F.default.isActivated("5FB0B159-1F05-4A77-99C9-AF50F3EC8435","4/2/2020","Use ItemsScope activity column")&&Wt&&!V&&Dt&&le&&!this._pageContext.isAnonymousGuestUser&&!this._pageContext.isEmailAuthenticationGuestUser&&!this._pageContext.isExternalGuestUser&&this.resources.consumeAsync(p.resourceKey).then(function(e){e.enqueue(ue)});var Xt=this._getGroupings({itemFromServer:N,supportsNestedGroups:X,groupBy:I,groups:gt}),Vt=Xt.groupings,$t=Xt.totalChildren;return{item:{key:ue},itemType:re,children:ct,groupings:Vt,totalChildren:$t,nextRequestToken:N.nextRequestToken}};t.prototype._getItemLifeCycleStatus=function(e){var t={};1===Number(e["Created_x0020_Date.ifnew"])&&(t.isNew=!0);var n=Number(e._VirusStatus)||0;b.isFeatureEnabled(b.EnableATPFilesListView)&&0!==n&&3!==n&&(t.isMalwareDetected=!0);return t};t.prototype._getGroupings=function(e){var t=this,n=e.itemFromServer,r=e.supportsNestedGroups,i=e.groupBy,s=e.groups,o=null,u=this._listContext.groupLevel,a=n.folder?n.folder.childCount:0;if(n.folder&&n.folder.children&&i&&"__ItemType"===i[0])o=this._getItemTypeGroupings({itemFromServer:n});else if(-1!==u)if(n.groups){var f=[],l=0;if(r){var c=B.GroupBuilder.buildCollapsedGroups(n.groups,this._listContext,i),h=c.groups,p=c.totalCount;f=h.map(function(e){return t._convertToODNGroup(e)});l=p}else for(var d=0,v=n.groups;d<v.length;d++){var m=v[d],g=i[u];if(m[g+".newgroup"]){var y=B.GroupBuilder.buildGroup(this._listContext,m,g,u,!0,l);f.push(this._convertToODNGroup(y));l+=y.count}}if(f&&f.length>0){o=[{name:void 0,itemGroups:f,isAllCollapsed:this.createObservable(!0)}];a=l}}else s&&s.length>0&&s[u]&&s[u].length>0&&(o=[{name:void 0,itemGroups:s[u],isAllCollapsed:this.createObservable(!1)}]);return{groupings:o,totalChildren:a}};t.prototype._getItemTypeGroupings=function(e){for(var t,n=e.itemFromServer,r=[],i=n.folder.children,s=n.nextRequestToken?2:0,o=i.length+s,u=0;u<o;u++){var a=i[u];if(a){if(!(this._getItemTypeOneNoteOrFolder(a)===d.default.Folder)){t=u;break}}}(void 0===t&&o>0||t>0)&&r.push({count:void 0!==t?t:o,groupingId:"folder",startIndex:0,state:this.createObservable({isCollapsed:!1})});void 0!==t&&r.push({count:o-t,startIndex:t,groupingId:"document",state:this.createObservable({isCollapsed:!1})});return r.length?[{name:"FoldersDocumentsPhotos",itemGroups:r,isAllCollapsed:this.createObservable(!1)}]:void 0};t.prototype._getImage360=function(e,t,n,r){var i,s=t&&t.panorama,o=!1;if(s&&"equirectangular"===s.projectionType){i={projectionType:s.projectionType};o=!0}else e.FileLeafRef&&-1!==e.FileLeafRef.indexOf(".360")?i={projectionType:"equirectangular"}:n.width>0&&n.height>0&&n.width/n.height==2&&(o=!0);if(o&&r){var u=r.panorama;if(u)i={projectionType:M.optional(s.projectionType||void 0),croppedAreaImageHeightPixels:M.optional(u.croppedAreaImageHeightPixels||void 0),croppedAreaImageWidthPixels:M.optional(u.croppedAreaImageWidthPixels||void 0),croppedAreaLeftPixels:M.optional(u.croppedAreaLeftPixels||void 0),croppedAreaTopPixels:M.optional(u.croppedAreaTopPixels||void 0),fullPanoHeightPixels:M.optional(u.fullPanoHeightPixels||void 0),fullPanoWidthPixels:M.optional(u.fullPanoWidthPixels||void 0),initialHorizontalFOVDegrees:M.optional(u.initialHorizontalFOVDegrees||void 0),initialVerticalFOVDegrees:M.optional(u.initialVerticalFOVDegrees||void 0),initialViewHeadingDegrees:M.optional(u.initialViewHeadingDegrees||void 0),initialViewPitchDegrees:M.optional(u.initialViewPitchDegrees||void 0),initialViewRollDegrees:M.optional(u.initialViewRollDegrees||void 0),poseHeadingDegrees:M.optional(u.poseHeadingDegrees||void 0),posePitchDegrees:M.optional(u.posePitchDegrees||void 0),poseRollDegrees:M.optional(u.poseRollDegrees||void 0)};else{var a=r.photo;if(a&&a.cameraModel){var f=a.cameraModel.toLowerCase();["gopro fusion 360","kodak pixpro – 360","ricoh theta","ricoh theta s","ricoh theta sc","ricoh theta v"].indexOf(f)>=0&&(i={projectionType:"equirectangular"})}}}return i};t.prototype.getReputationProperties=function(e){for(var t={},n=0,r=a.default;n<r.length;n++){var i=r[n];t[i]=M.optional(e[i])}return t};t.prototype._getPdfConversionFacet=function(e){var t,n={fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata};if(t=e.blockDownload&&X.canRenderNative(e.extension)?e.microServiceDataSource.getPassthroughUrl(n):e.microServiceDataSource.getPdfConversionUrl(n))return{url:t}};t.prototype._get3dFacet=function(e){if(this._pageContext.isSPO){var t=e.microServiceDataSource.getFbxConversionUrl({fileExtension:e.extension,item:e.itemFromServer}),n=q.canRenderNative(e.extension);if(t||n)return{canConvert:!0,canRenderNative:n,conversionUrl:t&&t.replace("/bxf?","/glb?")}}};t.prototype._getOfficeBundleFacet=function(e){var t=e.isWord,n=e.extension,r=e.itemUrlParts,i=e.isPowerPoint,s=e.itemFromServer,o=e.microServiceDataSource,u=e.mediaServiceFastMetadata,a=r.isCrossDomain;if(!a&&("21"===this._pageContext.webTemplate||b.isFeatureEnabled(b.EnableWrsPreviewOutsideODB))){var f,l,c,h=!a&&(t&&b.isFeatureEnabled(b.EnableWordWrsPreview)||i&&b.isFeatureEnabled(b.EnablePowerPointWrsPreview)),p=t||i?o.getOfficeBundleGenerateUrl({fileExtension:n,item:s,mediaServiceMetadata:u}):"",d=o.getOfficeBundleGetFragmentUrl({fileExtension:n,item:s,mediaServiceMetadata:u}),v=!1,m="",g=s[".ctag"],y=u&&u.officeBundle;if(y){f=y.ctag;c=y.version;v=y.fatalError||!1;y.generationTime&&(l=new Date(y.generationTime));m=y.errorInfo||""}return{officeBundleGenerateUrl:p,officeBundleGetFragmentUrl:d,bundleCTag:f,bundleVersion:c,hasBundleGenerationFailed:v,bundleErrorInfo:m,generationTime:l,cTag:g,enableDefaultClick:h}}};t.prototype._getThumbnail=function(e){var t=e.itemFromServer;if(e.type!==d.default.Folder){if(T.isPromotedLinksList(e.listTemplateType))return{url:t.BackgroundImageLocation,width:0,height:0};var n=e.microServiceDataSource.getThumbnail({fileExtension:e.extension,allowCookieAuth:e.listTemplateType===T.ListTemplateType.mySiteDocumentLibrary,itemKey:e.key,item:t,mediaServiceMetadata:e.mediaServiceFastMetadata});if(n)return n;if(C.fileTypeSupportsPreview(e.extension)){if(this._listContext.remoteParentWeb){var r=new u.default(this._listContext.remoteParentWeb.serverRelativeUrl).getLeftPart(u.UriPartial.authority),i=encodeURI(t.FileRef);return s.previewImageUrlFromUrl(S.default.encodeURIComponent(r+i),this._pageContext.webAbsoluteUrl,this._pageContext)}return s.previewImageUrl(t,this._pageContext.webAbsoluteUrl,this._pageContext)}}};t.prototype._getVideoUrl=function(e){var t=e.microServiceDataSource.getVideoUrl({fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata}),n={};t&&(n[i.default.video]=t);return n};t.prototype._getItemType=function(e){var t=e.itemFromServer,n=e.listTemplateType,r=e.microServiceDataSource,i=e.mediaServiceFastMetadata,s=this._getItemTypeOneNoteOrFolder(t);if(s===d.default.Unknown){var o=t.File_x0020_Type,u=o?"."+o:"";if(b.isFeatureEnabled(b.ShortcutLink)&&g.default.isShortcutFileType(o))return d.default.Shortcut;if(b.isFeatureEnabled(b.UseWebPdfViewer)&&("pdf"===o||this._getPdfConversionFacet({itemFromServer:t,extension:u,mediaServiceFastMetadata:i,blockDownload:!0,microServiceDataSource:r})))return d.default.Media;if(this._get3dFacet({itemFromServer:t,extension:u,microServiceDataSource:r,mediaServiceFastMetadata:i}))return d.default.Media;if("audio"===f.getIconNameFromExtension(u))return d.default.Media;if(i)return d.default.Media;if((s=f.getItemTypeFromExtension(u))===d.default.Unknown)return T.isGenericList(n)?d.default.File:T.isPromotedLinksList(n)?d.default.Media:s}return s||d.default.File};t.prototype._getItemTypeOneNoteOrFolder=function(e){var t;if(e.folder)t=d.default.Folder;else if("1"===e.FSObjType){var n=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],r=e["File_x0020_Type.mapapp"];t=r&&"onenote"===r.substring(0,7)||n&&-1!==n.indexOf("onenote")?d.default.OneNote:d.default.Folder}else t=d.default.Unknown;return t};t.prototype._convertToODNGroup=function(e){var t=this,n=e;n.state=this.createObservable({isCollapsed:e.isCollapsed});n.children&&n.children.length>0&&(n.children=e.children.map(function(e){return t._convertToODNGroup(e)}));return n};t.prototype._parseMediaServiceMetadata=function(e){if(e&&"{}"!==e)try{var t=e;if("&"===e[1]){this._htmlDecodeDiv.innerHTML=e;t=this._htmlDecodeDiv.innerText}return JSON.parse(t)}catch(e){}finally{this._htmlDecodeDiv.innerHTML=""}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{pageContext:k.pageContext,urlDataSource:N.url,listContext:k.listContext,navigation:A.navigation,microServiceDataSource:P.resourceKey,vroomUrlHelper:D.resourceKey,itemUrlHelper:_.resourceKey,vroomDataContext:L.dataContext.optional,shortcutLinkDataSource:m.resourceKey,isActivityFeatureEnabled:U.isActivityFieldEnabledResourceKey});return t})(r.default);t.default=V;function $(e){return"number"!=typeof e||F.default.isActivated("7F572FB6-3D81-4762-8499-379671FD5F86","9/20/2017","Convert 100ns video durations to ms")?e:e/1e4}t.resourceKey=j.createResolvedResourceKey(e("module").id,V)});
define("aUQ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=["AverageRating","RatedBy","Ratings","LikesCount","LikedBy"]});
define("aUP",["require","exports","hT"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["as7"],t,n)}).then(function(e){return e.resourceKey})})})});
define("aUO",["require","exports","hT"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["as4"],t,n)}).then(function(e){return e.resourceKey})})})});
define("aUN",["require","exports","hT"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dataContext=new n.ResourceKey("vroom.dataContext")});
define("aUM",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getCommentFlags=function(e){var t={};t.isCommentDisabled=n(e);return t};function n(e){return void 0===e||null==e||(1&e)>0}t.isCommentDisabled=n});
define("aUK",["require","exports","hT"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["awR"],t,n)}).then(function(e){return e.resourceKey})})})});
define("aUR",["require","exports","mU","hT","Kl","aUL","Qq","Qo","r","cv","eQ","iN","bu","mx","aAq","aM","aUS","iP","auW"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=!p.default.isActivated("B2674AC0-2974-4648-A267-F071B5046467","2/26/2020","Create a new MicroServiceDataSource per list response."),w=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._listItemBuilder=n.listItemBuilder;r._listItemResultProcessor=n.listItemResultProcessor;r._itemTaskObserverType=n.itemTaskObserverType;r._urlDataSource=n.urlDataSource;r._microServiceDataSourceType=n.microServiceDataSourceType;r._listContext=n.listContext;return r}t.prototype.updateFromResponse=function(e){var t=this;return function(r){var i=new t._itemTaskObserverType,s=e.itemSetKey,o=e.serverData,u=e.isItemSetRequest,h=r(f.readItems(function(e){var t=e.demandItemFacet(l.itemKeyToStoreKeyControl,c.odspNextAppItemKey);return l.itemKeyToStoreKeyControl.evaluate(t)(e,{itemKey:s,viewParams:{}})})).storeKey;if(void 0!==h){var p=h.key;t._listItemResultProcessor.processResponse({response:o,requestKey:p,observer:i});if(u){t._processRootFolder({response:o,requestKey:p,observer:i,isItemSetRequest:u});o&&y.ListItemBuilderHelpers.updateListContext(o,t._listContext)}var d,v=o.ListData&&o.ListData.Row||[];b&&o.ListSchema&&(d=new t._microServiceDataSourceType).setBaseInfo({data:o.ListSchema,allowCookies:!1});for(var m=0,g=v;m<g.length;m++){var w=g[m];t._listItemBuilder.getItemResult({microServiceDataSource:d,itemFromServer:n.__assign({},w),requestKey:p,queryType:a.default.Files,supportsNestedGroups:!1,isItemDataOnly:!u,observer:i})}i.flush()}}};t.prototype._processRootFolder=function(e){var t=e.response,n=e.requestKey,r=e.observer,i=e.isItemSetRequest,s=t.ListData,o=t.ListSchema,u=(void 0===o?{}:o).Collapse,a=void 0===u?"FALSE":u;if(s){var f=s&&s.Row,l="";s.NextHref&&(l=(l=s.NextHref).replace("&View="+h.default.Empty,""));var c="TRUE"===a,p=!c&&f?f.slice(0):[],v=this._urlDataSource.getKeyParams(n),m={id:v.id,folder:{childCount:p.length,children:p},nextRequestToken:l,PermMask:s.FolderPermissions,groups:c?f:null,isRootFolder:!1};if(d.isTeamChannelBannerEnabled()){var g=s&&s.CurrentFolderProgId;m.ProgId=g}this._listItemBuilder.getItemResult({requestKey:n,queryType:this._urlDataSource.getQueryType(v),itemFromServer:m,supportsNestedGroups:!1,isItemDataOnly:!i,observer:r})}};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{listItemBuilder:s.resourceKey,listItemResultProcessor:o.resourceKey,itemTaskObserverType:u.resourceKey,urlDataSource:v.url,microServiceDataSourceType:m.typeResourceKey,listContext:g.listContext});return t})(i.default);t.default=w;t.resourceKey=r.createResolvedResourceKey(e("module").id,w)});
define("aUS",["require","exports","mU","hT","aU1","iP","aUZ","aUX","aUV","aUT","Qn"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=new r.ResolvedResourceFactory(i.default,{pageContext:s.pageContext,thumbnailHelper:o.resourceKey,metaDataProcessor:u.resourceKey,authCookieHelper:a.resourceKey,authTokenStore:f.resourceKey,authTokenDataSource:l.resourceKey});t.typeResourceKey=new r.ResourceKey({name:e("module").id+".type",factory:{dependencies:{resources:r.resourceScopeKey},create:function(e){return{instance:(function(t){n.__extends(i,t);function i(){var n=this,i=new r.ResourceScope(e.resources);i.bind(u.resourceKey);(n=t.call(this,{},i.resolve(c.dependencies))||this)._resources=i;return n}i.prototype.dispose=function(){this._resources.dispose()};return i})(i.default)}}}});t.resourceKey=new r.ResourceKey({name:e("module").id,factory:c})});
define("aU1",["require","exports","mU","bk","aU2"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this;i._baseInfoSetCallbacks=[];i._authDataSignalCompleted=!1;i._authDataSignal=new r.default;i._authTokenDataSource=n.authTokenDataSource;i._baseInfoSet=!1;return i}t.prototype.getAuthData=function(){var e=this;return this._authTokenDataSource&&this.hasAuthDataExpired()?this._authTokenDataSource.getAuthToken({}).then(function(t){e.setBaseInfo(t);return e._authDataSignal.getPromise()}):this._authDataSignal.getPromise()};t.prototype.hasAuthData=function(){return!!this._processor.getCommonAuthData()};t.prototype.hasAuthDataExpired=function(){var e=new Date;e.setMinutes(e.getMinutes()+5);var t=this._processor.getCommonAuthData();return!!t&&t.expirationTime<=e};t.prototype.setBaseInfo=function(e){this._baseInfoSet=!0;var t=this._processor.parseCommonData(e);if(t.authData)if(this._authDataSignalCompleted){this._authDataSignal=new r.default;this._authDataSignal.complete(t.authData)}else{this._authDataSignalCompleted=!0;this._authDataSignal.complete(t.authData)}this._cookieHelper.checkCookies(t.mediaUrl,t.authData);for(var n=0,i=this._baseInfoSetCallbacks;n<i.length;n++){(0,i[n])()}};t.prototype.hasSetBaseInfo=function(){return this._baseInfoSet};t.prototype.registerSetBaseInfoCallback=function(e){this._baseInfoSetCallbacks.push(e)};return t})(i.default);t.default=s});
define("aU2",["require","exports","dj","Ff","dJ","arT","g1","arR","gZ","g0"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={ODC:"EnableAudioPlayer",ODB:841,OneDrive:!0},c={"ar-SA":!0,"he-IL":!0,"ja-JP":!0,"ko-KR":!0,"zh-CN":!0},h=/&(?:access_|proof)token=[^&]*/g,p=(function(){function e(e,t){this._processor=t.metaDataProcessor;this._cookieHelper=t.authCookieHelper;this._thumbnailHelper=t.thumbnailHelper;this._pageContext=t.pageContext;this._authTokenStore=t.authTokenStore}e.prototype.getVideoUrl=function(e){if("False"!==e.item[".hasVideoManifest"]||e.item[".videoManifestUrl"]||"audio"===r.getIconNameFromExtension(e.fileExtension)||i.default.isFeatureEnabled(l)){var t=this._processor.generateUrl(".videoManifestUrl",e.item);if(t){var n=e.item[".ctag"];n&&(t+="&cTag="+encodeURIComponent(n));t+="&action=Access"}return t}};e.prototype.getThumbnail=function(e){if(("False"!==e.item[".hasThumbnail"]||e.item[".thumbnailUrl"])&&this._thumbnailHelper.canProvideThumbnail(e.fileExtension)){var t=this._processor.generateUrl(".thumbnailUrl",e.item);t&&(t+="&encodeFailures=1");var n=e.allowCookieAuth,r=void 0===n||n,s=e.itemKey,o=e.fileExtension,u=e.mediaServiceMetadata;if(t&&r&&this._cookieHelper.canUseCookies()){t=t.replace(h,"");e.item[".ctag"]&&(t+="&ctag="+encodeURIComponent(e.item[".ctag"]));this._cookieHelper.trackItem({itemKey:s,thumbnailUrl:t,fileExtension:o,mediaServiceMetadata:u})}else if(t){var f=this._processor.getCommonAuthData();if(f){var l=i.default.isFeatureEnabled(a.MediaTAUseVroomV21),c={authToken:l?f.authTokenV21:f.authToken,proofToken:l?f.proofTokenV21:f.proofToken},p=this._authTokenStore.getToken(this._processor.getUniqueKey(),c);p&&p!==c&&(t=t.replace(h,"&access_token="+p.authToken+(p.proofToken?"&prooftoken="+p.proofToken:"")))}}return t?this._thumbnailHelper.getThumbnail({itemKey:s,fileExtension:o,baseUrl:t,mediaServiceMetadata:u}):void 0}};e.prototype.getDownloadAsZipUrl=function(e){var t=this._processor.getNormalUrl(".zipUrl",e);if(!t){e[".zipUrl"]=o.ZIP_URL;t=this._processor.getFallbackUrl(".zipUrl",e)}return t};e.prototype.getPassthroughUrl=function(e){return this._processor.generateUrl(".transformUrl",e.item,"passthrough")};e.prototype.getPdfConversionUrl=function(e,t){var r=e.fileExtension;if((this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled)&&u.canRenderNative(r))return this.getPassthroughUrl(e);if(!c[n.default.language]){var s=i.default.isFeatureEnabled({ODB:1225});return u.canConvert(r,s)||t?this._processor.generateUrl(".pdfConversionUrl",e.item):void 0}};e.prototype.getFbxConversionUrl=function(e){return"True"===e.item[".hasBxf"]&&s.canConvert(e.fileExtension)?this._processor.generateUrl(".transformUrl",e.item,"bxf"):""};e.prototype.getHtmlConversionUrl=function(e){return this._processor.generateUrl(".transformUrl",e.item,"html")};e.prototype.getZipMetaDataUrl=function(e){return this._processor.generateUrl(".transformUrl",e.item,"zipmetadata")};e.prototype.getDownloadZipContentsUrl=function(e){return this._processor.generateUrl(".transformUrl",e,"zipcontent")};e.prototype.getOfficeBundleGenerateUrl=function(e){if("False"!==e.item[".hasOfficePreview"]||e.item[".officeBundleGenerate"]){var t=this._processor.generateUrl(".officeBundleGenerate",e.item),n=encodeURIComponent(e.item[".ctag"]);return t&&t.replace("Generate","")+"&minVersion={{minVersion}}&cTag="+n}};e.prototype.getOfficeBundleGetFragmentUrl=function(e){if("False"!==e.item[".hasOfficePreview"]||e.item[".officeBundleGetFragment"]){var t=this._processor.generateUrl(".officeBundleGetFragment",e.item);return t&&t.replace("Get","")+"&fragment={0}"}};e.prototype.getitemUrlWithToken=function(e){var t=this._processor.getCommonProperty(".driveAccessToken");return t&&f.getItemUrlWithToken(e,t)};e.prototype.getPushChannelUrl=function(){return this._processor.getCommonProperty(".pushChannelBaseUrl")};e.prototype.getGenerateTranscriptUrl=function(e){return this._processor.getAnalyzeUrl("transcriptinit",e.item)};e.prototype.getMediaBaseUrl=function(e){return this._processor.generateUrl(".mediaBaseUrl",e.item)};return e})();t.default=p});
define("aUZ",["require","exports","hT","PZ","d0","aU0"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={crossDomainImageHelper:n.createResolvedResourceKey(e("module").id+".crossDomainImageHelper",s.CrossDomainImageHelper,{apiUrlHelper:r.resourceKey}),itemUrlHelper:i.resourceKey};t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:o,create:function(e){var t=new s.default(e);return{instance:t,disposable:t}}}})});
define("aU0",["require","exports","mU","XX","B","dL"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UseThumbnailService={ODB:816,OneDrive:!0};t.ExpandThumbnailSupport={ODB:820};var o={".xls":!0,".xlsx":!0},u={".jpg":!0,".jpeg":!0,".png":!0,".gif":!0,".doc":!0,".docx":!0,".ppt":!0,".pptx":!0},a=(function(){function e(e,t){this._apiUrlHelper=t.apiUrlHelper}e.prototype.getImageUrl=function(e){if(e.isCrossDomain){var t=this._apiUrlHelper.build().webByItemUrl(e);return(t=(t=t.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:e.serverRelativeItemUrl})).segment("OpenBinaryStream")).toString()}return e.fullItemUrl};return e})();t.CrossDomainImageHelper=a;var f=(function(){function e(e){this._itemUrlHelper=e.itemUrlHelper;this._crossDomainImageHelper=e.crossDomainImageHelper}e.prototype.getThumbnail=function(e){var t,r,i=this,s=e.fileExtension,o=void 0===s?"":s,u=e.itemKey,a=e.baseUrl,f=e.mediaServiceMetadata,l=f&&f.photo,c=f&&f.video;if(l){t=l.width;r=l.height}else if(c){t=c.frameWidth;r=c.frameHeight}var h={width:t||0,height:r||0};if(".gif"===o.toLowerCase()){var p=this._itemUrlHelper.getItemUrlParts(u),d=this._crossDomainImageHelper.getImageUrl(p),v=n.__assign({url:d},h);return n.__assign(n.__assign({},v),{getAligned:function(){return v}})}if(a){var m=f&&f.lenses;m&&m.officeLens&&(a+="&lenses=OfficeLens");return n.__assign(n.__assign({url:this._getUrl({baseUrl:a})},h),{getAligned:function(e,s){return n.__assign({url:i._getUrl({baseUrl:a,desiredSize:e,alignment:s,width:t,height:r})},h)}})}};e.prototype.canProvideThumbnail=function(e){if(!e)return!1;"."===(e=e.toLowerCase())[0]&&(e=e.substring(1));return!o[e]&&(!!s.default.isFeatureEnabled(t.UseThumbnailService)||!!s.default.isFeatureEnabled(t.ExpandThumbnailSupport)&&(!!e&&!u[e]))};e.prototype._getUrl=function(e){var t,n=e.desiredSize,s=void 0===n?{width:1024,height:1024}:n,o=e.alignment,u=e.width,a=e.height;o&&(o.name===r.coverCenter.name?t="fill":o.name===r.fitWidth.name+"-"+r.top.name&&(t="dochead"));var f={width:Math.ceil(s.width),height:Math.ceil(s.height),srcWidth:u||"",srcHeight:a||""};t&&(f.cropMode=t);return e.baseUrl+"&"+i.serializeQuery(f)};return e})();t.default=f});
define("aUX",["require","exports","hT","aUY","dQ","iP"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,r.default,{pageContext:s.pageContext,platformDetection:i.platformDetection})});
define("aUY",["require","exports","mU","C","g1","gZ","g0","dJ"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e,t){this._properties={};this._authData=void 0;this._allowCookies=!t.platformDetection.isSafari;var n=t.pageContext,r=n.env,i=n.userEmail,s=n.viewOnlyExperienceEnabled;this._env=r;this._isViewOnly=!!s;this._userID=i}e.prototype.getCommonAuthData=function(){return this._authData};e.prototype.getCommonProperty=function(e){return this._properties[e]};e.prototype.parseCommonData=function(e){o.setMicroServiceProperties(this._properties,e.data,this._env);this._authData=this._getCurrentAuthData(e.allowCookies&&this._allowCookies);return{authData:this._authData,mediaUrl:this._properties[".mediaBaseUrl"]}};e.prototype.getUniqueKey=function(){var e=this._properties[".driveUrl"]||this._properties[".driveUrlV21"],t=this._userID;return t&&e?t+"-"+e:""};e.prototype.generateUrl=function(e,t,n){return this.getNormalUrl(e,t,n)||this.getFallbackUrl(e,t,n)};e.prototype.getAnalyzeUrl=function(e,t){return o.getNormalUrl(n.__assign({".analyzeUrl":"{.mediaBaseUrl}/analyze?provider=spo&profile="+e+"&extension={.fileType}&docid={.spItemUrl}&{.driveAccessToken"+(u.default.isFeatureEnabled(s.MediaTAUseVroomV21)?"V21":"")+"}"},this._properties),".analyzeUrl",t)};e.prototype.getNormalUrl=function(e,t,n){return o.getNormalUrl(this._properties,e,t,n,this._isViewOnly,this._authData&&this._authData.supportsCookies)};e.prototype.getFallbackUrl=function(e,t,n){var r=t[e];if(r){r=r.replace("{.method}",n);for(var s=0,u=i.FALLBACK_PROPERTIES;s<u.length;s++){var a=u[s],f=t[a];".mediaBaseUrl"===a&&(f=o.fixMediaBaseUrl(f,this._env));if(!f){if(".correlationId"===a){r=r.replace("&correlationId={.correlationId}","");continue}return}".spResourceUrl"===a&&(f=encodeURIComponent(f));r=r.replace("{"+a+"}",f)}this._isViewOnly&&(r+="&nocache=true");return r}};e.prototype._getCurrentAuthData=function(e){var t=f(this._properties[".driveAccessToken"]),n=f(this._properties[".driveAccessTokenV21"]);if(n&&t){var r=new Date;return{authToken:t.authToken,proofToken:t.proofToken,tokenUrl:this._properties[".driveUrl"],authTokenV21:n.authToken,proofTokenV21:n.proofToken,tokenUrlV21:this._properties[".driveUrlV21"],timeReceived:r,expirationTime:new Date(r.getTime()+216e5),supportsCookies:e}}};return e})();t.default=a;function f(e){if(e){var t=r.deserializeQuery(e);return t&&t.access_token?{authToken:t.access_token,proofToken:t.prooftoken}:void 0}}});
define("aUV",["require","exports","H8","hT","dQ","aUW","aUZ","Kt","Qo"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=new r.ResourceKey({name:"updateThumbnailUrlCallback",factory:{dependencies:{itemTaskObserverType:a.resourceKey},create:function(e){return{instance:function(t,r){var i=new e.itemTaskObserverType;i.update(t.itemsWaitingForCookies.map(function(e){var i=e.itemKey,s=u.isFeatureEnabled(u.MediaTAUseVroomV21),o=s?r.authTokenV21:r.authToken,f=s?r.proofTokenV21:r.proofToken,l=e.thumbnailUrl+"&access_token="+o+"&prooftoken="+f,c=t.thumbnailHelper.getThumbnail({baseUrl:l,itemKey:i,fileExtension:e.fileExtension,mediaServiceMetadata:e.mediaServiceMetadata});return new a.Task(i).succeed({item:{key:i,thumbnail:n.replace(c)}})}));t.itemsWaitingForCookies.length=0;i.flush()}}}}});t.resourceKey=r.createResolvedResourceKey(e("module").id,s.default,{thumbnailHelper:o.resourceKey,platformDetection:i.platformDetection,updateThumbnailUrlCallback:f})});
define("aUW",["require","exports","mU","bk","bl","DJ","dL","aIF","UE","gZ"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l;(function(e){e[e.Failed=-1]="Failed";e[e.None=0]="None";e[e.Pending=1]="Pending";e[e.Success=2]="Success"})(l||(l={}));var c=(function(){function e(e,t){var n=this;this._platform=t.platformDetection;this.thumbnailHelper=t.thumbnailHelper;this._updateThumbnailUrlCallback=t.updateThumbnailUrlCallback;this._cookieState=0;this._haveCookies=new r.default;this.itemsWaitingForCookies=[];this._cookieAuthData={};a.default.registerCookieChecker({isApplicable:function(e){return!(e.indexOf("access_token")>0||e.indexOf(".svc.ms/transform/thumbnail")<0)},check:function(e){var t=new r.default;n._haveCookies.getPromise().done(function(e){return t.complete(e)},function(e){return t.error(e)});return t.getPromise()}})}e.prototype.canUseCookies=function(){return!(!this._cookieAuthData.active&&1!==this._cookieState)};e.prototype.trackItem=function(e){this._cookieAuthData.active||this.itemsWaitingForCookies.push(n.__assign({},e))};e.prototype.checkCookies=function(e,t){if(-1!==this._cookieState&&t&&t.supportsCookies){this._cookieAuthData.mostRecent=t;if(1!==this._cookieState)if(this._cookieAuthData.active){if(this._cookieAuthData.active!==t){var n=Date.now()-this._cookieAuthData.active.timeReceived.getTime();if(n>432e5){this._haveCookies=new r.default;this._cookieAuthData.active=void 0}n>72e5&&this._updateCookies(e,t)}}else this._updateCookies(e,t)}};e.prototype._updateCookies=function(e,t){var n=this,r=0===this._cookieState;this._cookieState=1;this._makeImageRequest(e,t,r).then(function(){n._cookieAuthData.active=t;n._cookieState=2;n.itemsWaitingForCookies.length=0;n._haveCookies.complete(!0)},function(){n._cookieState=-1;n._updateThumbnailUrls(t);n._haveCookies.error(!1)})};e.prototype._makeCorsRequest=function(e,t){var n,r=this;e+="/Auth/SetCookies?provider=spo";var s=o.default.isFeatureEnabled(f.MediaTAUseVroomV21),u=s?t.authTokenV21:t.authToken,a=s?t.proofTokenV21:t.proofToken;if(this._platform.isIE&&this._platform.browserMajor<=10){e+="&access_token="+u;e+="&prooftoken="+a}else n={spo_access_token:u,spo_prooftoken:a};return this.sendCorsRequest(e,n).then(function(t){if(!t.isOldCookiePresent)return r.sendCorsRequest(e,n).then(function(e){if(!e.isOldCookiePresent)return i.default.wrapError("Cookie request succeeded, but the cookies are not actually being set")})})};e.prototype.sendCorsRequest=function(e,t){return s.default.start({withCredentials:!0,url:e,headers:t,method:"POST"}).then(function(e){var t;try{t=JSON.parse(e.responseText)}catch(e){}return t||i.default.reject("Expected response object but received nothing")})};e.prototype._makeImageRequest=function(e,t,n){var r=o.default.isFeatureEnabled(f.MediaTAUseVroomV21),i=r?t.authTokenV21:t.authToken,s=r?t.proofTokenV21:t.proofToken;e+="/Auth/SetCookiesImg?provider=spo";e+="&access_token="+i;e+="&prooftoken="+s;return u.request(e).then(function(){if(n)return u.request(e+"&throwOnMissingCookies=true")})};e.prototype._updateThumbnailUrls=function(e){this.itemsWaitingForCookies.length&&this._updateThumbnailUrlCallback(this,e)};return e})();t.default=c});
define("aUT",["require","exports","hT","aUU"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,r.default,{})});
define("aUU",["require","exports","dz","dy","Qr"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=t.dataStoreType,s=void 0===i?n.default:i;this._dataStore=new s("MediaAuthStore",r.default.session)}e.prototype.getToken=function(e,t){if(e){var n=this._dataStore.getValue(e);if(n&&!i.isTokenExpired(n,36e5))return n;this._dataStore.setValue(e,t)}return t};return e})();t.default=s});
define("aU3",["require","exports","mU","hT","iU","x1","aEF","aEO","cv","mG","Bu","i0","cq","Kl","cm","b1","bv","ct","Dk","Dj","gV","H","Dl","i1","bl","aL","Di"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,factory:{dependencies:{singleFileUploaderType:o.typeResourceKey,html5FileUploadType:u.typeResourceKey,observablesFactoryType:p.observablesFactoryTypeResourceKey},create:function(e){var t=e.singleFileUploaderType,r=e.html5FileUploadType,o=e.observablesFactoryType;return{instance:function(e){var u=this,p=e.itemKey,L=e.options.sourceEntries,A=i.spItemKeyFacet.deserialize(p),O=A.webAbsoluteUrl,M=A.listFullUrl,_=A.rootFolder,D=Object.keys(L)[0],P=L[D],H=P.progressItemKey,B=P.conflictResolution;return function(L){return n.__awaiter(u,void 0,void 0,function(){var u,A,P,j=this;return n.__generator(this,function(F){switch(F.label){case 0:u=L(a.readItems(function(e){return{folderPath:e.demandItemFacet(x.folderPathFacet,p)}})).folderPath,A=void 0===u?_:u;P=new N.SimpleUri(M).path+"/Forms";return!!A&&A.slice(0,P.length)===P?[4,L(C.uploadListItem(e))]:[3,2];case 1:return[2,F.sent()];case 2:return[4,c.withScope(function(e){return n.__awaiter(j,void 0,void 0,function(){var u,c,N,C,A,_,P,j,F,I,q,R,U,z,W,X,V;return n.__generator(this,function($){switch($.label){case 0:u=L(a.readItems(function(e){return{storeItem:e.demandItemFacet(f.knockoutStoreItemFacet,p),sourceFile:e.demandItemFacet(l.sourceFileFacet,D)}})),c=u.storeItem,N=u.sourceFile;if(!(C=c&&c.peek()))throw new y.UploadError({message:"No parent item available for upload.",errorType:b.UploadErrorType.general,code:"ClientMissingParentItem"});if(!N)throw new y.UploadError({message:"No source file for upload.",errorType:b.UploadErrorType.general,code:"ClientMissingSourceFile"});A=e.attach(new r({file:N}));(_=e.attach(new t({fileUpload:A,parentItem:C,metadata:{},qosContext:{scenario:"ItemsScope.Upload",folderUpload:!0,wasDraggedAndDropped:!1}}))).nameConflictBehavior("replace"===B?1:0);H&&L(v.resolveItems({items:(X={},X[H]=n.__assign({},g.progressSizeFacet.pack({total:N.size,current:0})),X)}));P=e.attach(new o);j=new h.Signal;P.backgroundCompute(function(){var e,t=_.uploadedBytes();H&&L(v.resolveItems({items:(e={},e[H]=E.pack({progressSize:g.progressSizeFacet},{progressSize:{current:t}}),e)}))}).extend({rateLimit:{timeout:300}});P.backgroundCompute(function(){var e=_.state.peek();2===e?j.resolve():4===e?j.reject(_.error.peek()||new y.UploadError({message:"Unknown upload error.",errorType:b.UploadErrorType.general,code:"ClientUnknown"})):3===e?j.reject(new d.CancelError):_.state()});_.start().catch();(F=L(a.readItems(function(e){return e.demandItemFacet(g.cancelSourceFacet,H)})))&&e.attach({dispose:F.token.subscribe(function(){_.abort()})});$.label=1;case 1:$.trys.push([1,3,,4]);return[4,j.promise];case 2:$.sent();return[3,4];case 3:if((I=$.sent())instanceof d.CancelError)throw I;if(T.default.isCanceled(I))throw new d.CancelError;if(I instanceof y.UploadError)throw new s.UploadItemOperationError({facets:k(I),innerError:I});if(S.isErrorData(I))throw new s.UploadItemOperationError({facets:n.__assign(n.__assign({},"-2130575257"===I.code?n.__assign({},w.conflictErrorFacet.pack({supportsRename:!1})):n.__assign({},w.retryErrorFacet.pack({}))),x.spErrorDataFacet.pack(I)),message:S.getErrorMessage(I)});throw I;case 4:if(!(q=_.item.peek()))throw new y.UploadError({message:"No item created during upload.",errorType:b.UploadErrorType.general,code:"ClientNoCreatedItem"});R=q.properties;U=R&&R.ID;z=R&&R.uniqueId;if(!U)throw new y.UploadError({message:"No item id determined after upload.",errorType:b.UploadErrorType.general,code:"ClientNoAssignedItemId"});W=i.spItemKeyFacet.serialize({webAbsoluteUrl:O,listFullUrl:M,itemId:U});L(v.resolveItems({items:(V={},V[W]=n.__assign(n.__assign(n.__assign({},m.displayNameFacet.pack(q.displayName)),z?x.uniqueIdFacet.pack(z):{}),m.parentFolderItemFacet.pack({itemKey:p})),V)}));return[2,{itemKey:W}]}})})})];case 3:return[2,F.sent()]}})})}}}}}});function k(e){switch(e.errorType){case b.UploadErrorType.conflict:return n.__assign({},w.conflictErrorFacet.pack({supportsRename:!1}));case b.UploadErrorType.accessDenied:return n.__assign({},w.accessDeniedErrorFacet.pack({}));case b.UploadErrorType.disconnected:return n.__assign({},w.offlineErrorFacet.pack({}));case b.UploadErrorType.emptyFileOrFolder:case b.UploadErrorType.emptyFileOrFolderForDocLib:return n.__assign({},w.emptyFolderUnsupportedFacet.pack({}));case b.UploadErrorType.folderUploadNotSupported:return n.__assign({},w.folderUploadUnsupportedFacet.pack({}));case b.UploadErrorType.invalidName:return n.__assign({},w.invalidNameErrorFacet.pack({}));case b.UploadErrorType.lockMismatch:return n.__assign({},w.lockMismatchErrorFacet.pack({}));case b.UploadErrorType.malwareDetected:return n.__assign({},w.malwareErrorFacet.pack({}));case b.UploadErrorType.overQuota:return n.__assign({},w.overQuotaErrorFacet.pack({}));case b.UploadErrorType.targetFolderMissing:return n.__assign({},w.targetFolderErrorFacet.pack({}));case b.UploadErrorType.throttled:return n.__assign({},w.throttleErrorFacet.pack({}));case b.UploadErrorType.versionMismatch:return n.__assign({},w.versionMismatchFacet.pack({}))}return n.__assign({},w.retryErrorFacet.pack({}))}});
define("aU4",["require","exports","mU","f","CD","Ox","aAx","wP","fA","cO"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function l(e,t){return{addMetadataAction:null,checkInAction:null,policyTipAction:null,publishNowAction:null,showDetailsPane:null,showFeedbackPane:null,showFileAnalytics:null,showKeyPointsPane:null,undoCheckOutAction:null}}function c(e,t){return{isAvailable:!1}}var h=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(f.ControlHandlerProvider,{controlHandlers:n.__assign(n.__assign({},u.hoverCardCommandsControl.pack(l)),a.shareActionControl.pack(c))},r.createElement(i.ItemsPicker,n.__assign({},this.props)))};t.contextTypes=n.__assign({},s.RESOLVED_COMPONENT_CONTEXT_TYPES);return t})(r.PureComponent);t.ItemsPicker=h;t.resourceKey=s.createResolvedComponentTypeResourceKey(e("module").id,h,{});t.knockoutResourceKey=o.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-picker",name:e("module").id+".knockout"})});
define("aU5",["require","exports","hT","z0","V6"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{resources:n.resourceScopeKey,isInfoPaneExpanded:i.resourceKey},create:function(e){return{instance:function(t,n){return{onSwitchLayout:function(t){return function(n){var i=e.isInfoPaneExpanded;t.layoutType===r.quickEditLayoutType&&i&&i.peek()&&i(!1)}}}}}}}})});
define("aU6",["require","exports","mU","cu","aU7","iU","i1","cv","rc","h7"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.onUploadCompletedHelper=function(e,t,l){var c=this;return function(h){return n.__awaiter(c,void 0,void 0,function(){var c,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:return t?[4,h(f.demandItems(function(e){e.demandItemFacet(r.childItemsFacet,t)}))]:[3,2];case 1:n.sent();v=h(u.readItems(function(e){var n=[];c=e.demandItemFacet(s.spFolderItemSetKeyFacet,t);p=s.spProjectedUploadedItemSetKeyFacet.serialize({itemSetKey:c});d=e.demandItemFacet(r.childItemsFacet,p);if(l&&l.itemsScopeItemKey&&d&&d.itemKeys)for(var i=0,u=d.itemKeys;i<u.length;i++){var a=u[i],f=e.demandItemFacet(o.missingMetadataFieldsFacet,a);for(var h in f)if(f.hasOwnProperty(h)){n.push(a);break}}return n}));if(l&&l.itemsScopeItemKey&&d&&d.itemKeys&&v&&v.length>0){h(a.selectItems({itemsScopeItemKey:l.itemsScopeItemKey,selectedItemKeys:v,currentSelectionKey:void 0}));e.resources.consumeAsync(i.resourceKey).then(function(e){e(!0)})}n.label=2;case 2:return[2]}})})}}});
define("aU7",["require","exports","wK","hT"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,loader:new r.AliasResourceLoader(function(){return n.loadModuleExport({path:"V6",getModule:function(){return new Promise(function(t,n){e(["V6"],t,n)})},getExport:function(e){return e.resourceKey}})})})});
define("aU8",["require","exports","f","M6","cy","oD","akQ","hT","fA","cO","lD","aSM","a2","cL","mG","bw","MC","My"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=p.connectToItemCache(function(e,t){return{item:e.demandItemFacet(d.knockoutStoreItemFacet,t.itemKey)}})(r.withKnockoutComputed(function(e){var t=e.item;return{item:t&&t()}})(o.default));t.ItemHoverCardLauncher=v.withChildResources(function(e){e.exposeFactory(m.typeResourceKey,new u.AliasResourceFactory(g.typeResourceKey))},{owner:e("module").id})(function(e){var t=e.root,r=e.itemKey,o=v.useResourceScope(),u=function(e){return n.createElement(f.ControlHandlerProvider,{controlHandlers:a.shareActionControl.pack(function(t,n){return{defaultRecipients:e}})},n.createElement(i.WithAction,{action:n.createElement(s.ItemShareAction,{itemKey:r})},function(e){var r=e.isAvailable,i=e.execute,s=r?function(e){h.Engagement.logData({name:"FileHoverCard.RecommendedActions.ShareWith",isIntentional:!0});e.target=t;e.persist();i({event:e})}:void 0;return n.createElement(l.Link,{className:"ms-FileHoverCard-ShareWithLink",onClick:s},c.default.ShareWithThem)}))};return t&&r?n.createElement(i.WithAction,{action:n.createElement(s.ItemShareAction,{itemKey:r})},function(e){var i=e.isAvailable,s=e.execute,a=i?function(e){h.Engagement.logData({name:"FileHoverCard.CommandBar.ShareClick"});e.target=t;e.persist();s({event:e})}:void 0;return n.createElement(y,{itemKey:r,target:t,onClickShare:a,resources:o,onRenderShareWithPeople:u})}):n.createElement(n.Fragment,null)})});
define("aU9",["require","exports","mU","f","n4","cy","oD","e2","cL","iN","Ox","aAE","mJ","aMR","aAx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props.itemKey,t=p.default.shareActionText,n=e&&r.createElement(s.WithAction,{action:r.createElement(o.ItemShareAction,{itemKey:e})},function(e){var n=e.isAvailable,s=e.execute;return r.createElement(i.PrimaryButton,{disabled:!n,className:"od-Button od-Button--primary od-operationMonitor-ShareLinkButton",text:t,onClick:function(){s()}})});return r.createElement("div",{className:"od-operationMonitor-ShareLink"},n)};return t})(r.Component);t.ShareAfterUploadBase=v;t.ShareAfterUpload=a.connectToItemCache(function(e,t){var n=e.demandItemFacet(u.viewParamsToItemKeyControl,f.odspNextAppItemKey);return{itemKey:u.viewParamsToItemKeyControl.evaluate(n)(e,{viewParams:t.urlDataSource.getKeyParams(t.storeKey)}).itemKey}})(v);var m=(function(e){n.__extends(i,e);function i(){return null!==e&&e.apply(this,arguments)||this}i.prototype.render=function(){var e=this.context.dependencies.currentItemsScope;return r.createElement(e,null,r.createElement(t.ShareAfterUpload,n.__assign({},this.props)))};i.contextTypes=l.RESOLVED_COMPONENT_CONTEXT_TYPES;return i})(r.PureComponent);t.ShareAfterUploadContainer=m;t.resourceKey=l.createResolvedComponentTypeResourceKey(e("module").id,m,{itemCacheStore:h.resourceKey,currentItemsScope:c.resourceKey.local});t.knockoutResourceKey=d.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-scope-share-after-upload",name:e("module").id+".knockout"})});
define("aVa",["require","exports","hT","eG","i1","iU"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{},create:function(e){return{instance:function(e,t){var n=t.itemKey;if(!t.item)return{};var o={},u=e.demandItemFacet(i.permissionsFacet,n);o.permissions=u;var a=e.demandItemFacet(s.spWebKeyFacet,n),f=e.demandItemFacet(s.spLibrariesItemSetKeyFacet,n),l=e.demandItemFacet(s.spAllSitesKeyFacet,n),c=e.demandItemFacet(s.spOneDriveDocumentLibraryKeyFacet,n);if(a||f||l||c){o.folder={};o.type=r.default.Folder}return{item:o}}}}}})});
define("aVb",["require","exports","f","fl","cL","aPE"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(e){var t=e.subscribe;n.useLayoutEffect(function(){return t()},[t]);return null}t.ItemAutoRefresh=i.createItemCacheComponent(function(e,t){var r=t.itemKey,i=e.demandItemFacet(s.itemAutoRefreshControl,r),u=s.itemAutoRefreshControl.evaluate(i)(e,{itemKey:r,itemSubscriber:null}),a=u.isAvailable,f=u.itemSubscriber,l=u.subscribe;return a?f||(l?n.createElement(o,{subscribe:l}):null):null});t.CurrentItemAutoRefresh=r.withCurrentItemSet()(t.ItemAutoRefresh)});
define("aVc",["require","exports","mU","f","dh","a2","k9","n4","Jy","Zy","zf","lD","BU","BO","oJ","bt","adg","aVh","aVg","aVf","aVe","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._showTenantSiteDesigns=function(){s.Engagement.logData({name:"SiteScripts.ShowTenantSiteDesigns.Click"});i._siteScriptProgressStateManager.showTenantSiteDesigns()};i._hideTenantSiteDesigns=function(){s.Engagement.logData({name:"SiteScripts.HideTenantSiteDesigns.Click"});i._siteScriptProgressStateManager.hideTenantSiteDesigns()};i._renderChoiceGroupOption=function(e){return{key:e.runId,text:"",onRenderField:function(t,n){return r.createElement(y.SiteDesignRunChooser,{describedById:i._runChooserDescribedById,onSelected:i._onSiteDesignRunSelected,radioButtonProps:t,renderRadioButton:n,run:e})}}};i._onRadioChanged=function(e,t){i._siteScriptProgressStateManager.showSiteDesignRun(t.key)};i._onSiteDesignRunSelected=function(e){e&&e.runId&&i._siteScriptProgressStateManager.showSiteDesignRun(e.runId)};i._applySelectedTenantSiteDesign=function(){s.Engagement.logData({name:"SiteScripts.ApplyTenantSiteDesign.Click"});i.state.selectedTenantSiteDesign&&i._siteScriptProgressStateManager.applySiteDesign(i.state.selectedTenantSiteDesign)};i._onTenantSiteDesignSelected=function(e,t){i._siteScriptProgressStateManager.showTenantSiteDesign(e.key)};i._convertTenantSiteDesignToDropdownOption=function(e,t){return{key:e.id,text:e.title}};i._dismissAndRefresh=function(){s.Engagement.logData({name:"SiteScripts.DismissAndRefreshButton.Click"});i._onPanelDismissedInternal();window.location.reload(!0)};i._onClickNavigationCloseButton=function(){s.Engagement.logData({name:"SiteScripts.ClosePanelNavigation.Click"});i._onPanelDismissedInternal()};i._onPanelDismissed=function(){s.Engagement.logData({name:"SiteScripts.ClosePanel"});i._onPanelDismissedInternal()};i._onNewDataReceived=function(e){i.setState(e)};i.state={stagesRetrieved:!1,stageOutcomesKnown:0,stageOutcomesKnownButIncomplete:0};i._siteScriptProgressStateManager=i.props.siteScriptProgressStateManager;i.state=n.__assign({},i._siteScriptProgressStateManager.getState());i._runChooserDescribedById="SiteDesignRunChooserDescription"+Math.random().toString();i._designChooserDescribedById="SiteDesignChooserDescription"+Math.random().toString();return i}t.prototype.componentDidMount=function(){this._siteScriptProgressManagerKey="SiteScriptProgressPanel"+Math.random().toString();this._siteScriptProgressStateManager.registerCallback(this._siteScriptProgressManagerKey,m.SiteScriptProgressCallbackType.newProgressData,this._onNewDataReceived);this._siteScriptProgressStateManager.registerCallback(this._siteScriptProgressManagerKey,m.SiteScriptProgressCallbackType.newNonProgressData,this._onNewDataReceived);this.props.firstRunPanelExperience||this._siteScriptProgressStateManager.retrieveTenantSiteDesignsAndSiteDesignRuns()};t.prototype.componentWillUnmount=function(){this._siteScriptProgressStateManager.unregisterCallback(this._siteScriptProgressManagerKey,m.SiteScriptProgressCallbackType.newProgressData);this._siteScriptProgressStateManager.unregisterCallback(this._siteScriptProgressManagerKey,m.SiteScriptProgressCallbackType.newNonProgressData)};t.prototype.render=function(){var e=void 0;this.props.isOpen&&(e=r.createElement("div",{className:w.styles.siteScriptProgressPanelRoot},this._renderLeftColumn(),this._renderRightColumn()));return r.createElement(h.Panel,{isOpen:this.props.isOpen,className:w.styles.siteScriptProgressPanel,hasCloseButton:!1,isLightDismiss:!0,onDismiss:this._onPanelDismissed,type:h.PanelType.custom,customWidth:"900px"},e)};t.prototype._renderNavigation=function(){return r.createElement("div",{className:w.styles.navigation},r.createElement(u.IconButton,{className:w.styles.xButton,onClick:this._onClickNavigationCloseButton,"data-is-visible":!0,"data-is-focusable":!0,iconProps:{iconName:"Cancel"},ariaLabel:b.default.progressPanelDismissButtonText}))};t.prototype._renderLeftColumn=function(){var e;e=this.props.firstRunPanelExperience?this._renderSiteDesignWorkingImage():this._shouldShowTenantSiteDesigns()?this._renderTenantSiteDesignMetadata():this._renderSiteDesignRuns();return r.createElement("div",{className:o.css(w.styles.darker,w.styles.column,w.styles.leftColumn)},r.createElement("div",{className:w.styles.columnHeader},this._renderPanelTitle(),this._renderPanelSubtitle()),e,r.createElement("div",{className:o.css(w.styles.columnFooter)},this.props.firstRunPanelExperience?this._renderGearMenuHint():this._renderTenantSiteDesignsLink()))};t.prototype._renderSiteDesignWorkingImage=function(){if(this.props.imageUrls){var e=window.devicePixelRatio<2?this.props.imageUrls.workingSiteDesign:this.props.imageUrls.workingSiteDesign2x;if(e)return r.createElement(l.Image,{className:w.styles.workingImage,imageFit:l.ImageFit.contain,alt:"",role:"presentation",src:e})}};t.prototype._renderTenantSiteDesignMetadata=function(){var e;if(this.state.selectedTenantSiteDesign){var t=void 0,n="";if((e=this._siteScriptProgressStateManager.getTenantSiteDesign(this.state.selectedTenantSiteDesign)).imageUrl){t=e.imageUrl;n=e.imageAltText?e.imageAltText:""}else t=this.props.imageUrls?"68"===this._siteScriptProgressStateManager.getWebTemplate()?this.props.imageUrls.commSiteCustomizedLogo:this.props.imageUrls.teamSiteCustomizedLogo:"";if(e)return r.createElement("div",{className:w.styles.columnBody},r.createElement("div",{className:w.styles.siteDesignDescription},e.description),r.createElement("div",null,r.createElement(l.Image,{src:t,alt:n,className:w.styles.siteDesignLogoImage})))}return r.createElement("div",{className:w.styles.columnBody})};t.prototype._renderPanelSubtitle=function(){return!this.props.firstRunPanelExperience&&this._shouldShowTenantSiteDesigns()?this._renderTenantSiteDesignChooser():r.createElement("div",{className:w.styles.progressPanelSubtitle},this.props.firstRunPanelExperience?b.default.progressPanelSubtitle:b.default.progressPanelReopenedSubtitle)};t.prototype._renderPanelTitle=function(){var e=void 0,t=b.default.progressPanelTitle;if(!this.props.firstRunPanelExperience){this.state.showingTenantSiteDesigns&&(e=r.createElement(u.IconButton,{iconProps:{iconName:"Back"},onClick:this._hideTenantSiteDesigns,ariaLabel:b.default.backButtonAriaLabel}));t=this._shouldShowTenantSiteDesigns()?b.default.progressPanelOtherSiteDesignsTitle:b.default.progressPanelReopenedTitle}return r.createElement("div",{className:o.css(w.styles.progressPanelTitle,this.props.firstRunPanelExperience?w.styles.bigTitle:"")},e,t)};t.prototype._shouldShowTenantSiteDesigns=function(){return this.state.showingTenantSiteDesigns||this.state.siteDesignRuns&&0===this.state.siteDesignRuns.length};t.prototype._renderTenantSiteDesignsLink=function(){if(!this._shouldShowTenantSiteDesigns())return r.createElement(c.Link,{className:w.styles.tenantSiteDesigns,onClick:this._showTenantSiteDesigns},b.default.progressPanelSeeOtherDesignsLink)};t.prototype._renderGearMenuHint=function(){};t.prototype._renderSiteDesignRuns=function(){var e=this.state.siteDesignRuns;return e&&e.length?r.createElement("div",{className:o.css(w.styles.columnBody,w.styles.scrollable)},r.createElement(a.ChoiceGroup,{selectedKey:this.state.displayedRunKey,onChange:this._onRadioChanged,options:e.map(this._renderChoiceGroupOption)}),r.createElement("div",{id:this._runChooserDescribedById,className:w.styles.accessible},b.default.runChooserDescription)):r.createElement("div",{className:o.css(w.styles.columnBody,w.styles.scrollable)})};t.prototype._renderTenantSiteDesignChooser=function(){var e=this.state.tenantSiteDesigns;if(e){var t=n.__spreadArrays([{key:"",text:b.default.siteDesignChooserNone}],e.map(this._convertTenantSiteDesignToDropdownOption));return r.createElement("div",null,r.createElement("div",{className:w.styles.siteDesignChooserTitle},b.default.siteDesignChooserTitle),r.createElement(f.Dropdown,{placeHolder:b.default.siteDesignChooserNone,onChanged:this._onTenantSiteDesignSelected,options:t,selectedKey:this.state.selectedTenantSiteDesign}),r.createElement("div",{className:w.styles.accessible,id:this._designChooserDescribedById},b.default.tenantSiteDesignChooserDescription))}return r.createElement("div",null,r.createElement(d.Spinner,null))};t.prototype._renderRightColumn=function(){return r.createElement("div",{className:o.css(w.styles.column,w.styles.rightColumn)},this._renderNavigation(),r.createElement("div",{className:w.styles.columnInternal},this._renderRightColumnHeader(),this._renderRightColumnBody(),r.createElement("div",{className:w.styles.columnFooter},this._renderDismissButtonIfNecessary())))};t.prototype._renderRightColumnHeader=function(){if(this._shouldShowTenantSiteDesigns()){if(this.state.selectedTenantSiteDesign&&this.state.selectedTenantSiteDesignSchema)return r.createElement("div",{className:w.styles.columnHeader},this._renderTenantSiteDesignTitle(this.state.selectedTenantSiteDesignSchema.siteDesignTitle))}else{var e=this._siteScriptProgressStateManager.getData(this.state.displayedRunKey);if(e&&this.state.stagesRetrieved&&this.state.age!==m.SiteScriptRunAge.unknown)return r.createElement("div",{className:w.styles.columnHeader},this._renderProgressIndicator(e))}};t.prototype._renderRightColumnBody=function(){if(this._shouldShowTenantSiteDesigns()){if(!this.state.selectedTenantSiteDesign){var e=void 0;e=v.Killswitch.isActivated("c699dc3e-812b-49c7-9845-ba97f7d064e8","06/27/2019","SITE_DESIGN_OVERVIEW_URL_Localizable")?"http://aka.ms/spsitedesigns/":i.format("https://docs.microsoft.com/{0}/sharepoint/dev/declarative-customization/site-design-overview?branch=sitedesign",this.props.pageContext.currentUICultureName);return r.createElement("div",{className:o.css(w.styles.columnBody)},r.createElement("div",{className:w.styles.explainerTitle},b.default.progressPanelExplainerTitle),r.createElement("div",null,b.default.progressPanelExplainerText),r.createElement("div",{className:w.styles.explainerLink},r.createElement(c.Link,{href:e,target:"_blank"},b.default.progressPanelExplainerLink)))}if(this.state.selectedTenantSiteDesignSchema)return r.createElement("div",{className:o.css(w.styles.columnBody,w.styles.scrollable,w.styles.schemaArea)},this._renderPanelContents(this.state.selectedTenantSiteDesignSchema,void 0,!0))}else{var t=this._siteScriptProgressStateManager.getData(this.state.displayedRunKey);if(t&&this.state.stagesRetrieved&&this.state.age!==m.SiteScriptRunAge.unknown)return r.createElement("div",{className:o.css(w.styles.columnBody,w.styles.scrollable,w.styles.schemaArea)},this._renderPanelContents(t.siteScriptData,t.stageResultData,!1))}return r.createElement("div",{className:w.styles.columnBody},this._renderEmptyState())};t.prototype._renderEmptyState=function(){return r.createElement("div",null,r.createElement(d.Spinner,{label:b.default.emptyStateText}))};t.prototype._renderProgressIndicator=function(e){if(this.state.age===m.SiteScriptRunAge.old){var t=this.props.siteScriptProgressStateManager.getSiteDesignRun(this.state.displayedRunKey);if(t)return r.createElement("div",{className:w.styles.progressIndicatorContainer},r.createElement("div",{className:w.styles.noProgressIndicator},e.siteScriptData.siteDesignTitle),r.createElement("div",{className:w.styles.siteScriptProgressSubtext},i.format(b.default.progressPanelVersionAndDateRanText,t.version,t.runDate)))}var n=void 0;this._siteScriptProgressStateManager.isRunComplete(this.state.displayedRunKey)||this.props.firstRunPanelExperience||(n=r.createElement("div",{className:w.styles.siteScriptLongRunningText},b.default.longRunningSiteDesignText));var s=this._siteScriptProgressStateManager.getCompletionRatio(this.state.displayedRunKey),o=this._getCompletionPercentage(s);return r.createElement("div",{className:w.styles.progressIndicatorContainer},r.createElement(p.ProgressIndicator,{label:e.siteScriptData.siteDesignTitle,percentComplete:s}),r.createElement("span",{className:w.styles.siteScriptProgressSubtext,role:"alert"},o),n)};t.prototype._renderTenantSiteDesignTitle=function(e){return r.createElement("div",{className:w.styles.progressIndicatorContainer},r.createElement("div",{className:w.styles.tenantSiteDesignTitle},e),r.createElement(u.PrimaryButton,{ariaLabel:b.default.applySiteDesignButtonText,disabled:!1,onClick:this._applySelectedTenantSiteDesign,text:b.default.applySiteDesignButtonText}))};t.prototype._renderPanelContents=function(e,t,n){var i=[],s=0;if(e&&e.siteScripts)for(var o=0;o<e.siteScripts.length;o++)for(var u=0;u<e.siteScripts[o].actions.length;u++){i.push(r.createElement(g.SiteScriptActionLabel,{key:"scriptAction_"+o.toString()+"_"+u.toString(),stageNames:e.siteScripts[o].actions[u].stages,stageResultData:t,stageOutcomesKnown:this.state.stageOutcomesKnown,stageStartIndex:s,demoMode:n}));s+=e.siteScripts[o].actions[u].stages.length}return i};t.prototype._renderDismissButtonIfNecessary=function(){return this.state.hasARunCompleted||this.props.firstRunPanelExperience&&this._siteScriptProgressStateManager.isRunComplete(this.state.displayedRunKey)?r.createElement(u.PrimaryButton,{ariaLabel:b.default.progressPanelDismissAndRefreshButtonText,"data-automationid":"SiteScriptProgressCloseButton",disabled:!1,onClick:this._dismissAndRefresh,text:b.default.progressPanelDismissAndRefreshButtonText}):void 0};t.prototype._onPanelDismissedInternal=function(){this.props.onDismissed&&this.props.onDismissed();this._siteScriptProgressStateManager.hideTenantSiteDesigns()};t.prototype._getCompletionPercentage=function(e){if(e>=1)return b.default.progressPanelCompleteStatus;if(e<=0)e=0;else{e*=100;e=Math.floor(e)}return i.format(b.default.progressPanelPercentComplete,e)};return t})(r.Component);t.SiteScriptProgressPanel=E});
define("aVh",["require","exports","mU","f","dh","bt","ji","oJ","k9","aVf","aVe"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._renderStage=function(e,n){return 0===n?null:r.createElement("div",{key:t._getStageKey(n),className:l.styles.stageTitle,"data-automationid":"SiteScriptProgressStageTitle"},e)};return t}t.prototype.render=function(){var e,t=void 0,n=void 0,c=l.styles.activeActionTitle,h=void 0,p=this.props.stageNames[0];e=s.Killswitch.isActivated("402D171D-93E7-49F4-8E32-4231EFA41B9D","5/10/2019","Show stages for long site designs")?!!this.props.stageResultData:!!this.props.stageNames;if(!this.props.demoMode&&e){for(var d=Math.min(this.props.stageNames.length,Math.max(0,this.props.stageOutcomesKnown-this.props.stageStartIndex)),v=!1,m=!1,g=0;g<d;g++){var y=this.props.stageResultData[g+this.props.stageStartIndex];if(1===y.outcomeCode){v=!0;t=r.createElement("div",{className:l.styles.errorText},y.outcomeText||f.default.defaultFailureOutcomeText);break}4===y.outcomeCode&&(m=!0)}if(v){h=i.format(f.default.actionErrorAriaLabel,p);n=r.createElement(o.Icon,{ariaLabel:h,className:a.css(l.styles.actionIcon,l.styles.errorIcon),iconName:"Error",role:"img"})}else if(m){h=i.format(f.default.actionIncompleteAriaLabel,p);n=r.createElement(u.Spinner,{ariaLabel:h,className:l.styles.inProgressSpinner,role:"img",size:u.SpinnerSize.small})}else if(d>=this.props.stageNames.length){h=i.format(f.default.actionCompleteAriaLabel,p);n=r.createElement(o.Icon,{ariaLabel:h,className:a.css(l.styles.actionIcon,l.styles.successIcon),"data-automationid":"SiteScriptProgressSuccessIcon",iconName:"CheckMark",role:"img"})}else if(this.props.stageOutcomesKnown>=this.props.stageStartIndex){h=i.format(f.default.actionIncompleteAriaLabel,p);n=r.createElement(u.Spinner,{ariaLabel:h,className:l.styles.inProgressSpinner,role:"img",size:u.SpinnerSize.small})}else{h=i.format(f.default.actionIncompleteAriaLabel,p);n=r.createElement(o.Icon,{ariaLabel:h,className:a.css(l.styles.actionIcon,l.styles.incompleteIcon),iconName:"CheckMark",role:"img"});c=l.styles.inactiveActionTitle}}else n=r.createElement(o.Icon,{"aria-hidden":"true",iconName:"CheckMark",className:a.css(l.styles.actionIcon,l.styles.incompleteIcon)});return r.createElement("div",{role:"heading",className:l.styles.actionContainer,"data-automationid":"SiteScriptProgressActionContainer","aria-label":h},r.createElement("div",{className:l.styles.actionHeader},n,r.createElement("div",{className:a.css(l.styles.actionTitle,c,n?"":l.styles.actionTitleNoIcon),"data-automationid":"SiteScriptProgressActionTitle"},this.props.stageNames[0]||"")),t,r.createElement("div",{className:l.styles.stageContainer},this.props.stageNames.map(this._renderStage)))};t.prototype._getStageKey=function(e){return"scriptProgress_"+this.props.stageStartIndex.toString+"_"+e.toString()};return t})(r.Component);t.SiteScriptActionLabel=c});
define("aVe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.styles={accessible:"ms-siteScriptProgress-accessible",siteScriptLongRunningText:"ms-siteScriptProgress-siteScriptLongRunningText",schemaArea:"ms-siteScriptProgress-schemaArea",workingImage:"ms-siteScriptProgress-workingImage",columnInternal:"ms-siteScriptProgress-columnInternal",siteDesignLogoImage:"ms-siteScriptProgress-siteDesignLogoImage",darker:"ms-siteScriptProgress-darker",xButton:"ms-siteScriptProgress-xButton",navigation:"ms-siteScriptProgress-navigation",siteDesignDescription:"ms-siteScriptProgress-siteDesignDescription",explainerLink:"ms-siteScriptProgress-explainerLink",explainerTitle:"ms-siteScriptProgress-explainerTitle",scrollable:"ms-siteScriptProgress-scrollable",siteDesignChooserTitle:"ms-siteScriptProgress-siteDesignChooserTitle",tenantSiteDesignTitle:"ms-siteScriptProgress-tenantSiteDesignTitle",gear:"ms-siteScriptProgress-gear",noProgressIndicator:"ms-siteScriptProgress-noProgressIndicator",bigTitle:"ms-siteScriptProgress-panelBigTitle",runChoiceChecked:"ms-siteScriptProgress-runChoiceChecked",runChoiceRoot:"ms-siteScriptProgress-runChoiceRoot",runChoiceRadio:"ms-siteScriptProgress-runChoiceRadio",runChoiceText:"ms-siteScriptProgress-runChoiceText",runChoicePrimaryText:"ms-siteScriptProgress-runChoicePrimaryText",runChoiceSecondaryText:"ms-siteScriptProgress-runChoiceSecondayText",runChoiceArrow:"ms-siteScriptProgress-runChoiceArrow",tenantSiteDesigns:"ms-siteScriptProgress-tenantSiteDesignsLink",column:"ms-siteScriptProgress-column",leftColumn:"ms-siteScriptProgress-leftColumn",rightColumn:"ms-siteScriptProgress-rightColumn",columnFooter:"ms-siteScriptProgress-columnFooter",columnBody:"ms-siteScriptProgress-columnBody",columnHeader:"ms-siteScriptProgress-columnHeader",panelBottomTextBold:"ms-siteScriptProgress-panelBottomTextBold",siteScriptProgressPanelRoot:"ms-siteScriptProgress-panelRoot",siteScriptProgressPanel:"ms-siteScriptProgress-panel",emptyStageContainer:"ms-siteScriptProgress-emptyStageContainer",errorIcon:"ms-siteScriptProgress-errorIcon",errorText:"ms-siteScriptProgress-errorText",inProgressSpinner:"ms-siteScriptProgress-inProgressSpinner",actionIcon:"ms-siteScriptProgress-actionIcon",successIcon:"ms-siteScriptProgress-successIcon",activeActionTitle:"ms-siteScriptProgress-activeActionTitle",actionTitle:"ms-siteScriptProgress-actionTitle",actionTitleNoIcon:"ms-siteScriptProgress-actionTitleNoIcon",incompleteIcon:"ms-siteScriptProgress-incompleteIcon",inactiveActionTitle:"ms-siteScriptProgress-inactiveActionTitle",stageTitle:"ms-siteScriptProgress-stageTitle",siteScriptProgressSubtext:"ms-siteScriptProgress-siteScriptProgressSubtext",progressIndicatorContainer:"ms-siteScriptProgress-progressIndicatorContainer",progressPanelTitle:"ms-siteScriptProgress-panelTitle",progressPanelSubtitle:"ms-siteScriptProgress-panelSubtitle",titleContainer:"ms-siteScriptProgress-titleContainer",actionContainer:"ms-siteScriptProgress-actionContainer",emptyStageProgressIndicator:"ms-siteScriptProgress-emptyStageProgressIndicator",stageContainer:"ms-siteScriptProgress-stageContainer",actionHeader:"ms-siteScriptProgress-actionHeader"}});
define("aVg",["require","exports","mU","f","dh","k9","aVe","ji","aVf"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderLabel=function(e){return r.createElement("div",{id:e.labelId,className:o.styles.accessible},i.format(a.default.siteDesignRunChooserAriaLabel,t.props.run.siteDesignTitle,t.props.run.runDate))};t._onSelected=function(){t.props.onSelected(t.props.run)};return t}t.prototype.render=function(){var e={};e[o.styles.runChoiceChecked]=this.props.radioButtonProps.checked;return r.createElement("div",{className:s.css(o.styles.runChoiceRoot,e),onClick:this._onSelected},r.createElement("div",{className:o.styles.runChoiceRadio},this.props.renderRadioButton(n.__assign(n.__assign({},this.props.radioButtonProps),{"aria-describedby":this.props.describedById,onRenderLabel:this._onRenderLabel}))),r.createElement("div",{className:o.styles.runChoiceText},r.createElement("div",{className:o.styles.runChoicePrimaryText},this.props.run.siteDesignTitle),r.createElement("div",{className:o.styles.runChoiceSecondaryText},i.format(a.default.progressPanelDateRanText,this.props.run.runDate))),r.createElement("div",{className:o.styles.runChoiceArrow},r.createElement(u.Icon,{iconName:"ChevronRight",className:"ms-Icon--m"})))};return t})(r.Component);t.SiteDesignRunChooser=f});
define("aVi",["require","exports","mU","f","acc","BU","Cs","oJ","n4","aVu","bc","aVt","aVs","aVr","aVn","aVk","iP","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._createModelPanelContent=r.createRef();i.onRenderFooterContent=function(){return r.createElement(r.Fragment,null,r.createElement(a.PrimaryButton,{onClick:i.onCreateClick,style:{marginRight:"8px"},disabled:i.state.isWorking||i.state.isLoading},f.default.NextText),r.createElement(a.DefaultButton,{onClick:i.props.onDismiss},f.default.CancelText))};i.onCreateClick=function(){return n.__awaiter(i,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:if(!this._createModelPanelContent.current)return[2];this.setState({isWorking:!0});return[4,this._createModelPanelContent.current.onCreate()];case 1:e=t.sent();this.setState({isWorking:!1});this.props.onComplete(!!e);return[2]}})})};i.state={loadingError:"",isLoading:!0,isWorking:!1};i._listAIModelDataSource=i.props.resources.consume(c.resourceKey);i._contentTypeDataSource=i.props.resources.consume(h.resourceKey);i._peopleDataSource=i.props.resources.consume(p.resourceKey);return i}t.prototype.componentDidMount=function(){var e,t;return n.__awaiter(this,void 0,void 0,function(){var r,i,s,o,u,a,f,c,h,p,d,v,g;return n.__generator(this,function(n){switch(n.label){case 0:r=this.props.createModelContext,i=r.webAbsoluteUrl,s=r.listId;n.label=1;case 1:n.trys.push([1,9,,10]);return[4,this._listAIModelDataSource.getListAIModel(i,s)];case 2:o=n.sent();if(!(u=null===(e=o)||void 0===e?void 0:e.predictionModel)){this.setState({isLoading:!1,loadingError:"",viewModelContext:void 0});return[2]}if(u.modifiedBy)return[3,3];f=void 0;return[3,5];case 3:return[4,this._peopleDataSource.getPeopleByLoginName(i,u.modifiedBy)];case 4:f=n.sent();n.label=5;case 5:a=f;if(u.contentTypeId)return[3,6];h=void 0;return[3,8];case 6:return[4,this._contentTypeDataSource.getContentTypeById(i,s,u.contentTypeId)];case 7:h=n.sent();n.label=8;case 8:c=h;this.setState({isLoading:!1,loadingError:"",viewModelContext:{model:u,people:a,contentType:c}});return[3,10];case 9:p=n.sent();d=null===(t=this.props.resources.consume(m.pageContext))||void 0===t?void 0:t.CorrelationId;v="";if(p&&p.message&&p.message.value){v=p.message.value;g=p.correlationiId||d||"";v=v+" correlationId: "+g}else v=JSON.stringify(p);l.default.log("[CreateAIBModelPanel] Error "+v);this.setState({isLoading:!1,loadingError:v||"Please try again later. CorrelationId: "+d,viewModelContext:void 0});return[3,10];case 10:return[2]}})})};t.prototype.render=function(){var e=this.state,t=e.isLoading,n=e.loadingError,a=e.viewModelContext,l=t,c=!t&&!n,h=!!(a&&a.contentType&&a.model&&a.model.id&&a.model.environment),p=!t&&h,m=!t&&!h||!this.props.createModelContext.isPredictionModelApplied&&!h;return r.createElement(s.Panel,{closeButtonAriaLabel:f.default.CloseText,headerText:m?f.default.CreateModelHeader:p?f.default.ViewModelHeader:"",isOpen:!0,isFooterAtBottom:!0,isLightDismiss:!0,onDismiss:this.props.onDismiss,onRenderFooterContent:m?this.onRenderFooterContent:void 0,type:s.PanelType.smallFixedFar},p&&r.createElement(v.ViewModelPanelContent,{resources:this.props.resources,viewModelContext:a}),m&&r.createElement(d.CreateModelPanelContent,{ref:this._createModelPanelContent,createModelContext:this.props.createModelContext,resources:this.props.resources}),l&&r.createElement(i.Stack,null,r.createElement(u.Spinner,{size:u.SpinnerSize.small,className:"CreateAIBModelPanel-separator",ariaLive:"assertive",labelPosition:"right",label:f.default.LoadingText})),c&&r.createElement(i.Stack,null,r.createElement(o.Label,{className:"ErrorTextStyle"},n)))};return t})(r.Component);t.default=g});
define("aVt",["require","exports","mU","Uh","hT","iP","bc"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(){}e.Online="Online";e.Offline="Offline";return e})();t.ModelState=u;var a=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,n.pageContext)||this}t.prototype.getListAIModel=function(e,t){var n=e+"/_api/web/Lists('"+t+"')/rootfolder/properties?$select=vti_x005f_modellibrary,vti_x005f_predictionmodelid,vti_x005f_predictionmodel";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t;return null===(t=JSON.parse(e))||void 0===t?void 0:t.d},qosName:"getListModelProperty",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}}).then(function(e){var t=e.vti_x005f_modellibrary||"",n=t?{driveId:t}:void 0,r=e.vti_x005f_predictionmodelid||"",i=e.vti_x005f_predictionmodel||"",s=[];if(i)try{s=JSON.parse(i)}catch(e){o.default.logError("JSON parse failed for vti_x005f_predictionmodel propety value: "+i)}var u=r&&s&&s.length>0?s.find(function(e){return e.id===r}):void 0;return{machineTeachingModel:n,predictionModel:u||(!u&&r?{id:r}:void 0)}})};t.dependencies={pageContext:s.pageContext};return t})(r.default);t.default=a;t.resourceKey=i.createResolvedResourceKey(e("module").id,a)});
define("aVs",["require","exports","mU","Uh","hT","iP"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,n.pageContext)||this}t.prototype.getMachineTeachingContentTypes=function(e,t,n,r){return this.getContentTypes(e,t,"$select=Name,Discription,Group,StringId,SchemaXml","$filter=substringof('http://schemas.microsoft.com/sharepoint/v3/machinelearning/modelid', SchemaXml) eq true",n,r)};t.prototype.getFormProcessingContentTypes=function(e,t,n,r){return this.getContentTypes(e,t,"$select=Name,Discription,Group,StringId,SchemaXml","$filter=substringof('http://schemas.microsoft.com/sharepoint/v3/formprocessing/models', SchemaXml) eq true",n,r)};t.prototype.getSiteContentTypes=function(e,t,n,r){var i=t?"$filter=Group eq '"+t+"'":void 0;return this.getContentTypes(e,void 0,"$select=Name,Discription,Group,StringId",i,n,r)};t.prototype.addContentTypeToList=function(e,t,n){var r={contentTypeId:n},i=e+"/_api/web/Lists('"+t+"')/contenttypes/AddAvailableContentType";return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){var t=JSON.parse(e);return{id:t.StringId,name:t.Name,discription:t.Discription,group:t.Group}},qosName:"addContentTypeToList",additionalPostData:JSON.stringify(r),method:"POST"})};t.prototype.createSiteContentType=function(e,t,n){var r={parameters:{__metadata:{type:"SP.ContentTypeEntityData"},Name:t.name,Description:t.discription,Group:t.group,ParentContentTypeId:n}},i=e+"/_api/web/contenttypes/create";return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){var t,n,r,i,s,o,u,a,f=JSON.parse(e);return{id:null===(n=null===(t=f)||void 0===t?void 0:t.d)||void 0===n?void 0:n.StringId,name:null===(i=null===(r=f)||void 0===r?void 0:r.d)||void 0===i?void 0:i.Name,discription:null===(o=null===(s=f)||void 0===s?void 0:s.d)||void 0===o?void 0:o.Discription,group:null===(a=null===(u=f)||void 0===u?void 0:u.d)||void 0===a?void 0:a.Group}},qosName:"createSiteContentType",additionalPostData:JSON.stringify(r),method:"POST"})};t.prototype.createSiteContentTypeLegacy=function(e,t){var n={__metadata:{type:"SP.ContentType"},Name:t.name,Description:t.discription,Group:t.group},r=e+"/_api/web/contenttypes";return this.dataRequestor.getData({url:r.toString(),parseResponse:function(e){var t,n,r,i,s,o,u,a,f=JSON.parse(e);return{id:null===(n=null===(t=f)||void 0===t?void 0:t.d)||void 0===n?void 0:n.StringId,name:null===(i=null===(r=f)||void 0===r?void 0:r.d)||void 0===i?void 0:i.Name,discription:null===(o=null===(s=f)||void 0===s?void 0:s.d)||void 0===o?void 0:o.Discription,group:null===(a=null===(u=f)||void 0===u?void 0:u.d)||void 0===a?void 0:a.Group}},qosName:"createSiteContentType",additionalPostData:JSON.stringify(n),method:"POST"})};t.prototype.getContentTypeById=function(e,t,n){var r=t?e+"/_api/web/Lists('"+t+"')/contenttypes/getbyid('"+n+"')":e+"/_api/web/contenttypes/getbyid('"+n+"')";return this.dataRequestor.getData({url:r.toString(),parseResponse:function(e){var t,n=null===(t=JSON.parse(e))||void 0===t?void 0:t.d;return n?{id:n.StringId,name:n.Name,discription:n.Discription,group:n.Group}:void 0},qosName:t?"getListContentTypeById":"getSiteContentTypeById",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})};t.prototype.getContentTypes=function(e,t,n,r,i,s){var o=n;o+=o&&r?"&":"";o+=r||"";o+=o&&i?"&":"";o+=i?"$top="+i:"";o+=o&&s?"&":"";o=(o+=s?"$skip="+s:"")?"?"+o:"";var u=t?e+"/_api/web/Lists('"+t+"')/contenttypes"+o:e+"/_api/web/contenttypes"+o;return this.dataRequestor.getData({url:u.toString(),parseResponse:function(e){var t,n,r,i,s=JSON.parse(e);return((null===(n=null===(t=s)||void 0===t?void 0:t.d)||void 0===n?void 0:n.results)?null===(i=null===(r=s)||void 0===r?void 0:r.d)||void 0===i?void 0:i.results:[]).map(function(e){return{id:e.StringId,name:e.Name,discription:e.Discription,group:e.Group}})},qosName:t?"getListContentTypes":"getSiteContentTypes",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})};t.dependencies={pageContext:s.pageContext};return t})(r.default);t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});
define("aVr",["require","exports","mU","Uh","hT","iP"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,n.pageContext)||this}t.prototype.getPeopleByLoginName=function(e,t){var n=e+"/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(AccountName=@v)?@v='"+encodeURIComponent(t)+"'&$select=AccountName,DisplayName,Email,Title";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t,n=null===(t=JSON.parse(e))||void 0===t?void 0:t.d;return n?{accountName:n.AccountName,displayName:n.DisplayName,email:n.Email,title:n.Title}:void 0},qosName:"getPeopleProperties",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})};t.dependencies={pageContext:s.pageContext};return t})(r.default);t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});
define("aVn",["require","exports","mU","f","Jy","oJ","Zy","Cs","ji","sx","acc","ab0","aiZ","CO","aVq","bc","aS6","aVs","aVp","n6","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){n.__extends(t,e);function t(t){var p=e.call(this,t)||this;p._renderAdvancedSettings=function(){var e=p.state.showAdvancedSettings;return r.createElement("div",null,p._renderAdvancedSettingsHeader(),e&&p._renderAdvancedSettingsContent())};p._toggleAdvancedSettings=function(){p.setState({showAdvancedSettings:!p.state.showAdvancedSettings})};p._renderAdvancedSettingsHeader=function(){var e=p.state.showAdvancedSettings;return r.createElement("div",{onClick:p._toggleAdvancedSettings,className:"CreateAIBModelPanel-AdvancedSettingsHeader"},r.createElement("div",{className:"CreateAIBModelPanel-AdvancedSettingsHeaderText"},d.default.AdvancedSettingsText),r.createElement(b.IconButton,{style:{fontSize:"13px",color:"black"},iconProps:{iconName:e?"ChevronUp":"ChevronDown"},title:d.default.AdvancedSettingsText,ariaLabel:d.default.AdvancedSettingsText}))};p._renderAdvancedSettingsContent=function(){return r.createElement("div",{className:"CreateAIBModelPanel-AdvancedSettingsExpandedMargin"},p._renderAssociatedContentTypeHeader(),p._renderChoiceGroup(),p._renderContentTypesDropdown(),p._renderViewSetting())};p._renderAssociatedContentTypeHeader=function(){return r.createElement(u.Label,{className:"CreateAIBModelPanel-AssociatedContentTypeLabel"},r.createElement(l.Stack,{horizontal:!0,verticalAlign:"center"},r.createElement("span",null,d.default.ContentTypeHeader," "),r.createElement(f.TooltipHost,{content:d.default.ContentTypeDescription,directionalHint:f.DirectionalHint.topCenter,styles:{root:{position:"relative",top:"-4px",left:"12px"}},componentRef:p._tooltipRef}),r.createElement("span",{className:"CreateAIBModelPanel-TooltipIcon"},r.createElement(a.Icon,{iconName:"info","aria-label":d.default.ContentTypeDescription,tabIndex:0,onClick:function(){var e;null===(e=p._tooltipRef.current)||void 0===e||e.show()},onFocus:function(){var e;null===(e=p._tooltipRef.current)||void 0===e||e.show()}}))))};p._renderChoiceGroup=function(){var e=[{key:"create",text:d.default.createContentType},{key:"select",text:d.default.selectContentType}];return r.createElement(i.ChoiceGroup,{options:e,onChange:p.onChoiceGroupSelectedChange,selectedKey:p.state.contentTypeOperationSelected})};p._renderContentTypesDropdown=function(){var e=p.state,t=e.contentTypeOperationSelected,n=e.errorMessage,i=e.contentTypeOptions,u=e.loadingCompleted;return r.createElement(r.Fragment,null,"select"===t&&r.createElement(r.Fragment,null,r.createElement(o.Dropdown,{ariaLabel:d.default.selectContentTypeIndicator,className:"CreateAIBModelPanel-Dropdown",errorMessage:n,onChange:p.onDropdownSelectionChange(),options:i}),!u&&r.createElement(l.Stack.Item,null,r.createElement(s.Spinner,{size:s.SpinnerSize.small,className:"CreateAIBModelPanel-Spinner",ariaLive:"assertive",labelPosition:"right",label:d.default.LoadingText}))))};p._renderViewSetting=function(){return r.createElement("div",{className:"CreateAIBModelPanel-ViewContainer"},r.createElement(l.Stack,{gap:4},r.createElement(h.Text,null,d.default.LibraryViewCreateDiscrptionText),r.createElement(c.Toggle,{label:"",defaultChecked:!0,onText:d.default.LibraryViewSetDefaultToggleText,offText:d.default.LibraryViewSetDefaultToggleText,onChange:p.onToggleChange})))};p.onTextFieldChange=function(e,t){p.setState({contentTypeName:t||"",errorMessage:""})};p.onChoiceGroupSelectedChange=function(e,t){p.setState({contentTypeOperationSelected:t.key,contentTypeSelected:"select"===t.key?{key:"",value:""}:p.state.contentTypeSelected,errorMessage:""})};p.onDropdownSelectionChange=function(){return function(e,t,n,r){var i=t&&t.key||"",s=t&&t.text||r;p.setState({contentTypeSelected:{key:i,value:s},contentTypeName:s,errorMessage:""})}};p.onToggleChange=function(e,t){p.setState({isSetDefaultViewRequired:t})};p.onCreateClick=function(){return n.__awaiter(p,void 0,void 0,function(){var e,t,r,i,s,o,u,a,f,l,c,h,p,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B;return n.__generator(this,function(n){switch(n.label){case 0:e=this.state,t=e.contentTypeOperationSelected,r=e.contentTypeSelected,i=e.isSetDefaultViewRequired,s=e.contentTypeName;o=this.props.createModelContext,u=o.webAbsoluteUrl,a=o.listId,f=o.listFullUrl;l=r.key;c=r.value;this.setState({isCreating:!0});if("select"===t&&!c){this.setState({isCreating:!1,errorMessage:d.default.ContentTypeNameInvalidText});return[2,!1]}if("create"!==t)return[3,4];if(!s){this.setState({isCreating:!1,errorMessage:d.default.ContentTypeNameInvalidText});return[2,!1]}n.label=1;case 1:n.trys.push([1,3,,4]);h={name:s,group:"Intelligent Document Content Types",discription:"",id:""};return[4,this._contentTypeDataSource.createSiteContentType(u,h,"0x0101")];case 2:p=n.sent();l=p.id;c=p.name;return[3,4];case 3:g=n.sent();T=null===(A=null===(L=g)||void 0===L?void 0:L.message)||void 0===A?void 0:A.value;"183, Microsoft.SharePoint.SPException"===(null===(O=g)||void 0===O?void 0:O.code)&&(T=d.default.ContentTypeNameAlreadyUsed);this.setState({isCreating:!1,errorMessage:T});v.default.log("[CreateModelPanelContent] create content type api call failed: "+(null===(_=null===(M=g)||void 0===M?void 0:M.message)||void 0===_?void 0:_.value));return[2,!1];case 4:y="";n.label=5;case 5:n.trys.push([5,12,,13]);return[4,this._viewDataSource.getViews(u,a)];case 6:b=n.sent();w=b.filter(function(e){return e.title===c});E=w.filter(function(e){return!e.isHidden});return 0!==w.length?[3,8]:[4,this._viewDataSource.createView(u,a,c)];case 7:S=n.sent();y=S.id;return[3,11];case 8:if(!(E.length>0))return[3,9];y=E[0].id;return[3,11];case 9:return[4,this._viewDataSource.createView(u,a,c)];case 10:S=n.sent();y=S.id;n.label=11;case 11:return[3,13];case 12:x=n.sent();T=null===(P=null===(D=x)||void 0===D?void 0:D.message)||void 0===P?void 0:P.value;this.setState({isCreating:!1,errorMessage:T});v.default.log("[CreateModelPanelContent] create view api call failed: "+(null===(B=null===(H=x)||void 0===H?void 0:H.message)||void 0===B?void 0:B.value));return[2,!1];case 13:N=m.getAIBuilderRunTimeHost();C={contentTypeId:l,setViewAsDefault:i};k=("modelNameSeed="+encodeURIComponent(c)).concat("&templateName=SharePointFormProcessing","&context.sharepoint.site="+encodeURIComponent(u),"&context.sharepoint.list="+encodeURIComponent(a),"&context.sharepoint.listfullurl="+encodeURIComponent(f),"&context.sharepoint.view="+encodeURIComponent(y),"&context.sharepoint.context="+encodeURIComponent(JSON.stringify(C)));window.open("https://"+N+"/aibuilder/createModel?"+k,"_blank");this.setState({isCreating:!1});return[2,!0]}})})};p.state={contentTypeOperationSelected:"create",errorMessage:"",contentTypeDropdownOptions:[],contentTypeOptions:[],contentTypeSelected:{key:"",value:""},loadingCompleted:!1,isCreating:!1,isSetDefaultViewRequired:!0,contentTypeName:"",showAdvancedSettings:!1};p._contentTypeDataSource=p.props.resources.consume(g.resourceKey);p._viewDataSource=p.props.resources.consume(y.resourceKey);p._tooltipRef=r.createRef();return p}t.prototype.onCreate=function(){return this.onCreateClick()};t.prototype.componentDidMount=function(){var e=this,t=this.props.createModelContext.webAbsoluteUrl;this._contentTypeDataSource.getSiteContentTypes(t,"Intelligent Document Content Types").then(function(t){var n=[];(t=t.filter(function(e){return e.id.startsWith("0x0101")})).sort(function(e,t){return e.name.toUpperCase()>t.name.toUpperCase()?1:-1});t.forEach(function(e){n.push({key:e.id,text:e.name})});e.setState({contentTypeOptions:n,loadingCompleted:!0})}).catch(function(t){var n,r;e.setState({loadingCompleted:!0});v.default.log("[CreateModelPanelContent] fetching content types failed "+(null===(r=null===(n=t)||void 0===n?void 0:n.message)||void 0===r?void 0:r.value))})};t.prototype.render=function(){var e=this.state,t=e.contentTypeOperationSelected,n=e.contentTypeName,i=e.isCreating;return r.createElement(r.Fragment,null,r.createElement(l.Stack,{gap:20},r.createElement(l.Stack.Item,null,r.createElement(h.Text,null,d.default.CreateModelInstructionText)),r.createElement(l.Stack.Item,{styles:{root:{marginBottom:"20px"}}},r.createElement(p.TextField,{ariaLabel:d.default.PlacerholderInput,errorMessage:"select"===t?"":this.state.errorMessage,value:n,disabled:"select"===t,label:d.default.ModelInputTextFieldLabel,onChange:this.onTextFieldChange})),r.createElement(l.Stack.Item,{className:"CreateAIBModelPanel-AdvancedSettingsContainer"},this._renderAdvancedSettings()),r.createElement(l.Stack.Item,null,i&&r.createElement(s.Spinner,{size:s.SpinnerSize.small,ariaLive:"assertive",labelPosition:"right",label:""}))))};return t})(r.Component);t.CreateModelPanelContent=w});
define("aVp",["require","exports","mU","Uh","hT","iP"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,n.pageContext)||this}t.prototype.getViews=function(e,t){var n=e+"/_api/web/Lists('"+t+"')/Views?$select=Id,Title,DefaultView,Hidden";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t,n,r,i,s=JSON.parse(e);return((null===(n=null===(t=s)||void 0===t?void 0:t.d)||void 0===n?void 0:n.results)?null===(i=null===(r=s)||void 0===r?void 0:r.d)||void 0===i?void 0:i.results:[]).map(function(e){return{id:e.Id,title:e.Title,isHidden:e.Hidden,isDefault:e.DefaultView}})},qosName:"getViews",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})};t.prototype.createView=function(e,t,n){var r={parameters:{__metadata:{type:"SP.ViewCreationInformation"},Title:n,Query:'"<OrderBy><FieldRef Name="FileLeafRef"/></OrderBy>"',Paged:!0,PersonalView:!1,RowLimit:30,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:["DocIcon","LinkFilename","Modified","Editor","ContentType"]}}},i=e+"/_api/web/Lists('"+t+"')/Views/Add";return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){var t,n,r,i,s,o,u,a,f=JSON.parse(e);return{id:null===(n=null===(t=f)||void 0===t?void 0:t.d)||void 0===n?void 0:n.Id,title:null===(i=null===(r=f)||void 0===r?void 0:r.d)||void 0===i?void 0:i.Title,isHidden:null===(o=null===(s=f)||void 0===s?void 0:s.d)||void 0===o?void 0:o.Hidden,isDefault:null===(a=null===(u=f)||void 0===u?void 0:u.d)||void 0===a?void 0:a.DefaultView}},qosName:"createView",additionalPostData:JSON.stringify(r),method:"POST"})};t.dependencies={pageContext:s.pageContext};return t})(r.default);t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});
define("aVk",["require","exports","mU","f","Cs","acc","aVm","aS6","lD","iP","wF","IB","wJ","wJ","aX","aVt","f8","OneDriveLightspeedItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._aiBuilderHost=u.getAIBuilderRunTimeHost();n.state={isMessageBarHidden:!1};n._pageContext=n.props.resources.consume(f.pageContext);return n}t.prototype.render=function(){var e,t=this.props.viewModelContext,n=t.people?{name:t.people.displayName,email:t.people.email,title:t.people.title,imageUrl:"/_layouts/15/userphoto.aspx?accountname="+encodeURIComponent(t.people.accountName)+"&size=S"}:void 0,u=null===(e=t.contentType)||void 0===e?void 0:e.name,f=t.model,l=f.id,c=f.environment,h=f.modifiedTimestamp&&parseInt(f.modifiedTimestamp,10)||void 0,p=f.state,d=h?new Date(h):void 0,g=d?m.getRelativeDateTimeStringPast(d):void 0,y=t.people?this._getUserUpn(t.people):void 0,b=this._pageContext.userPrincipalName,w=!(!y||!b)&&0===y.toUpperCase().localeCompare(b.toUpperCase());return r.createElement(s.Stack,{gap:25},r.createElement("div",null,r.createElement("span",null," ",o.default.ModelPublishedText),r.createElement("span",null," "," "),!!c&&w&&r.createElement(r.Fragment,null,r.createElement(a.Link,{href:"https://"+this._aiBuilderHost+"/environment/"+c+"/aibuilder/models/"+l,target:"_about"},o.default.ManageModelLinkText),r.createElement("span",null," "," "),r.createElement("span",null," ",o.default.ManageModelInAIBuilderText))),u&&r.createElement("div",null,r.createElement(i.Label,null,o.default.ModelLabelText),r.createElement("div",null,r.createElement("span",null,u))),(p===v.ModelState.Online||p===v.ModelState.Offline)&&r.createElement("div",null,r.createElement(i.Label,null,o.default.StatusLabelText),r.createElement("div",null,r.createElement("span",null,p===v.ModelState.Online?o.default.ModelPublishedStatusText:o.default.ModelUnpublishedStatusText)),g&&r.createElement("div",null,r.createElement("span",{className:"item-timeStamp"},g))),n&&r.createElement("div",null,r.createElement(i.Label,null,o.default.ModelOwnerLabelText),r.createElement("div",null,this._getPersonaControl(n))))};t.prototype._makeDeferredLpcProps=function(e){var t=this.props.resources.consume(d.resourceKey),n=p.waitForPageLoadWithTimeout(t);return{personaType:"User",identifier:e&&e.email,pageContext:this._pageContext,moduleLoader:h.getReactDeferredComponentModuleLoader(),customWaiter:n,addGroupMembersCallback:void 0,lpcHoverTargetProps:{upn:e&&e.email,hostAppPersonaInfo:{PersonaDisplayName:e&&e.name}}}};t.prototype._wrapPersona=function(e){var t=this;return function(n,i){var s=t._makeDeferredLpcProps(e);return l.wrapWithDeferredSpLivePersonaCard(s,r.createElement("div",null,i(n)))}};t.prototype._getPersonaControl=function(e){return r.createElement(c.Persona,{imageUrl:e.imageUrl,primaryText:e.name,secondaryText:e.title,size:c.PersonaSize.small,hidePersonaDetails:!1,onRenderCoin:this._wrapPersona(e),onRenderPrimaryText:this._wrapPersona(e),"data-automationid":"ModelPersona"})};t.prototype._getUserUpn=function(e){return e.accountName?e.accountName.slice(e.accountName.lastIndexOf("|")+1):e.email};return t})(r.Component);t.ViewModelPanelContent=g});
define("aVv",["require","exports","mU","e3","iN","aT5","aTd","aVG","i1","Gg","iU","en","sa","r8","rV","rX","rd","rL","q4","rE","rx","al","an","aS2","aVC","xB","Kt","mT","bU","w5","Fl","Gu","qH","mx","c3","cZ","aN8","aVA","F7","em","w6","aVy","hZ","aTg","aVx","aVw","sj","bU"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.extendedItemsCommandBarControlHandler=r.createControlHandler()(function(){return function(e){return J}});function J(e,t){var r=t.itemKey,i=t.commands,u=t.farCommands,f=t.overflowCommands,h=L.isTeamsWebView(),p=A.isCrossOrigin(),d=h||p,v=e.demandItemFacet(l.spItemKeyFacet,r),m=e.demandItemFacet(c.savedForLaterRootItemKeyFacet,r),g=e.demandItemFacet(P.sharedWithMeRootItemKeyFacet,r),y=e.demandItemFacet(H.SharedByMeRootItemKeyFacet,r),b=e.demandItemFacet(I.recentRootItemKeyFacet,r),w={commands:i,hostedInTeamsDesktop:h,hostedCrossOrigin:p,itemCache:e,overflowCommands:f};if(v){var T=e.demandItemFacet(a.spPageContextFacet,l.spPageContextKeyFacet.serialize({webAbsoluteUrl:v.webAbsoluteUrl,listFullUrl:v.listFullUrl})),N=T&&T.webTemplate,k=T&&T.listBaseTemplate,O=Number(N)===E.WebTemplateType.mySite,_=C.isFeatureEnabled(C.ContentCenterEnabled)&&Number(k)===S.ListTemplateType.contentCenterModelLibrary,B={webAbsoluteUrl:v.webAbsoluteUrl,listFullUrl:v.listFullUrl},R=l.spListKeyFacet.serialize(B),U=e.demandItemFacet(a.listFacet,R),z=!!U&&!!U.isDocumentLibrary,X=!!U&&U.allowCreateFolder,V=!!U&&U.permissions,$=x.getFlowCommand(e,r);if(i&&i.length>0&&i[0].key===M.exitQuickEditCommand.key){if(D.default.isActivated("86CDDB78-0503-4987-9214-48BC92A7E039","8/1/2019","Allow more commands in command bar in quick edit"))return{farCommands:[o.filtersPaneCommand]};var J=Y(F.openFileCommand);return j.getQuickEditCommands(e,{itemKey:r,listKey:B,pageContext:T,isDocumentLibrary:z,extraCommands:{flowCommand:$,openCommand:J}})}var G=i?Q(e,{defaultCommands:i||[],isODB:O,isDocumentLibrary:z,isContentCenterModelLibrary:_,allowCreateFolder:X,hosted:d,hostedCrossOrigin:p,hostedInTeamsDesktop:h}):[];$&&!_&&G.push($);var ne=Z(e,{farCommands:u,isDocumentLibrary:z,canModifySchema:!!(V&&!(!V.manageLists&&!V.managePersonalViews)),hosted:d,isOdb:O}),re=(function(e,t){var r=t.overflowCommands,i=void 0===r?[]:r,u=t.isODB,a=t.isDocumentLibrary,f=t.hostedCrossOrigin,l=t.hostedInTeamsDesktop;if(!i)return[];var c=[];if(u||f&&l)c=n.__spreadArrays([s.versionHistoryCommand],i);else{c=f&&!l?[s.versionHistoryCommand,s.manageAlertCommand]:l&&!f?[s.versionHistoryCommand,s.alertMeCommand]:[s.versionHistoryCommand,s.alertMeCommand,s.manageAlertCommand];a&&c.push(o.makeHomePageCommand);c=c.concat(i)}return c})(0,{overflowCommands:f,isODB:O,isDocumentLibrary:z,hostedCrossOrigin:p,hostedInTeamsDesktop:h});if(O){var ie=q.buildSortCommand(e,{itemKey:r});ne.unshift(ie)}return C.isFeatureEnabled(C.SPListPltCommands)?{commands:te(G),farCommands:te(ne),overflowCommands:te(re)}:{commands:G,farCommands:ne,overflowCommands:re}}if(m)return ee(e,n.__assign({endpoint:m.endpoint},w));if(g){var se=[];se=K(e,{endpoint:g.endpoint,payload:{defaultCommands:i||[],isODB:!0,isSharedTab:!0,isDocumentLibrary:!0,isContentCenterModelLibrary:!1,allowCreateFolder:!1,hosted:h||p,hostedCrossOrigin:p,hostedInTeamsDesktop:h,isSavedForLaterPivot:!1},itemKey:r});var oe=W.getSharedNavigationCommands(e,r);return{commands:n.__spreadArrays(oe,se),farCommands:ne=Z(e,{farCommands:u,isDocumentLibrary:!0,canModifySchema:!1,hosted:d,isOdb:!0}),overflowCommands:[]}}if(y){se=[];se=K(e,{endpoint:y.tenantRootUrl,payload:{defaultCommands:i||[],isODB:!0,isSharedTab:!0,isDocumentLibrary:!0,isContentCenterModelLibrary:!1,allowCreateFolder:!1,hosted:h||p,hostedCrossOrigin:p,hostedInTeamsDesktop:h,isSavedForLaterPivot:!1},itemKey:r});ne=Z(e,{farCommands:u,isDocumentLibrary:!1,canModifySchema:!0,hosted:d,isOdb:!0}),oe=W.getSharedNavigationCommands(e,r);return{commands:n.__spreadArrays(oe,se),farCommands:ne,overflowCommands:[]}}if(b){var ue=b.endpoint;return ee(e,n.__assign({endpoint:ue},w))}return{}}function K(e,t){var n,r=t.endpoint,i=t.payload;n=i.defaultCommands?Q(e,i):[];return X.getExtendedCommandsWithFileHandlers(e,r,n)}function Q(e,t){var r=[],i=t.isODB,u=t.isSharedTab,a=t.isDocumentLibrary,l=t.isContentCenterModelLibrary,c=t.hostedCrossOrigin,m=t.defaultCommands,E=t.hosted,S=t.hostedInTeamsDesktop,x=t.allowCreateFolder,k=t.isSavedForLaterPivot;i||(a?c||r.push(o.cancelEditCommand):c?r.push(o.EditItemCommand):r.push(o.cancelEditCommand,o.EditItemCommand));for(var L=0,A=m;L<A.length;L++){var M=A[L];if(M.key===h.newCommand.key)r.push(G(M,!!a,!!l,!!x,i));else if(M.key===d.copyLinkCommand.key){r.push(d.copyLinkCommand);i&&r.push(o.FileRequestCommand)}else if(M.key===p.openCommand.key)r.push(Y(M));else if(M.key===g.downloadCommand.key&&C.isFeatureEnabled(C.TeamChannelFolder)){r.push(M);r.push(o.TeamChannelCommand);r.push(o.runModelCommand)}else if(M.key!==g.downloadCommand.key||C.isFeatureEnabled(C.TeamChannelFolder))if(M.key===y.followCommand.key&&U.isSavedForLaterEnabled())r.push(T.saveForLaterCommand);else if(M.key===f.exportListCommand.key)S||r.push(M);else if(M.key===v.uploadCommand.key){var _=M;C.isFeatureEnabled(C.ShimSharePointUploader)||D.default.isActivated("3E9F1325-3BE2-478A-85EE-E05F0292761F","4/15/2019","Shim old Upload action in ItemsScope")||(_=n.__assign(n.__assign({},_),{subMenuProps:n.__assign(n.__assign({},_.subMenuProps),{items:[o.UploadFileCommand,o.UploadFolderCommand]})}));_.subMenuProps&&_.subMenuProps.items&&_.subMenuProps.items.length>0&&_.subMenuProps.items[_.subMenuProps.items.length-1].key!==O.UploadTemplateCommand.key&&!i&&a&&(_=n.__assign(n.__assign({},_),{subMenuProps:n.__assign(n.__assign({},_.subMenuProps),{items:n.__spreadArrays(_.subMenuProps.items,[O.UploadTemplateCommand])})}));r.push(_)}else if(k&&U.isSavedForLaterEnabled()){var P=M.key===b.renameCommand.key,H=M.key===w.deleteCommand.key,j=M.key===z.fileRequestCommand.key;P||H||j||r.push(M)}else r.push(M);else r.push(o.runModelCommand)}if(i)u?r.push(o.addToOneDriveCommand):r.push(o.quickEditCommand,o.moveToCommand,o.copyToCommand);else if(a){if(!c){r.push(o.quickEditCommand);C.isFeatureEnabled(C.PowerappsCustomizationOnDocLibs)&&B.default.arePowerAppsFormsEnabled()&&r.push(s.powerAppsCommand)}r.push(o.moveToCommand,o.copyToCommand,o.AddToQuickLaunchCommand);C.isFeatureEnabled(C.WexSitePagesScheduling)&&r.push(R.scheduleCommand)}else{c||r.push(o.quickEditCommand,s.powerAppsCommand);r.push(o.moveToCommand);E&&r.push(o.OpenInSharePointCommand)}l&&(r=r.filter(function(e){return e.key!==N.syncCommand.key&&e.key!==o.quickEditCommand.key&&e.name!==o.quickEditCommand.name&&e.key!==s.powerAppsCommand.key&&e.key!==f.exportListCommand.key&&e.key!==s.aibuilderCommand.key}));return r}function G(e,t,r,i,s){if(e.key!==h.newCommand.key)return e;if(t){if(r)return u.contentCenterCreateModelCommand;if($.isOneDriveWinApp()&&C.isFeatureEnabled(k.UseItemsScopeInODApp)&&e.subMenuProps)return n.__assign(n.__assign({},e),{subMenuProps:n.__assign(n.__assign({},e.subMenuProps),{items:[V.createFolderCommand]})});if(e.subMenuProps&&e.subMenuProps.items&&e.subMenuProps.items.length>0&&e.subMenuProps.items[e.subMenuProps.items.length-1].key!==O.AddTemplateCommand.key)return n.__assign(n.__assign({},e),{subMenuProps:n.__assign(n.__assign({},e.subMenuProps),{items:n.__spreadArrays(e.subMenuProps.items,[o.CreateShortcutCommand],s?[]:[{name:"-",key:"divider_2",itemType:_.ContextualMenuItemType.Divider},o.EditNewMenuCommand,O.AddTemplateCommand])})})}else if(e.subMenuProps&&e.subMenuProps.items&&e.subMenuProps.items.length>0&&e.subMenuProps.items[e.subMenuProps.items.length-1].key===f.createListItemCommand.key&&e.subMenuProps.items.length<=2&&!i)return{key:e.key,action:f.createListItemCommand.action,iconProps:e.iconProps,name:e.name};return e}function Y(e){return e.key!==p.openCommand.key?e:e.subMenuProps&&e.subMenuProps.items&&e.subMenuProps.items.length>0&&e.subMenuProps.items[e.subMenuProps.items.length-1].key!==o.OpenInPowerBICommand.key&&n.__assign(n.__assign({},e),{subMenuProps:n.__assign(n.__assign({},e.subMenuProps),{items:n.__spreadArrays(e.subMenuProps.items,[o.OpenInTextEditorCommand,o.OpenInPowerBICommand])})})||e}function Z(e,t){for(var r=t.farCommands,s=void 0===r?[]:r,u=t.isDocumentLibrary,a=t.canModifySchema,f=t.hosted,l=t.isOdb,c=[],h=0,p=s;h<p.length;h++){var d=p[h];if(d.key===m.switchLayoutCommand.key){var v=d.subMenuProps?n.__spreadArrays(d.subMenuProps.items):[];if(u&&d.subMenuProps&&d.subMenuProps.items)for(var g=0,y=0,b=v;y<b.length;y++){if("tilesListCommand"===b[y].automationId&&(!v[g+1]||v[g+1].key!==o.OpenInExplorerCommand.key)){v.splice(g+1,0,o.OpenInExplorerCommand);break}g++}c.push(n.__assign(n.__assign({},d),{subMenuProps:n.__assign(n.__assign({},d.subMenuProps),{items:d.subMenuProps&&(a?n.__spreadArrays(v,[o.launchFormatViewPaneCommand]):n.__spreadArrays(v))||[o.launchFormatViewPaneCommand]})}))}else c.push(d)}c.push(o.filtersPaneCommand,o.detailsCommand);C.isFeatureEnabled(C.SPListLightSpeed)&&C.isFeatureEnabled(C.FullscreenList)&&e.demandItemFacet(i.isLightspeedAppFacet,i.odspNextAppItemKey)&&!f&&!l&&c.push(o.fullscreenCommand);return c}function ee(e,t){var r=t.endpoint,i=t.commands,o=t.hostedInTeamsDesktop,u=t.hostedCrossOrigin,a=t.overflowCommands,f=[],l=[];f=i?Q(0,{defaultCommands:i||[],isODB:!0,isDocumentLibrary:!0,allowCreateFolder:!1,hosted:o||u,hostedCrossOrigin:u,hostedInTeamsDesktop:o,isSavedForLaterPivot:!0}):[];f=X.getExtendedCommandsWithFileHandlers(e,r,f);u&&o&&(l=a?n.__spreadArrays([s.versionHistoryCommand],a):[s.versionHistoryCommand]);return{commands:f,farCommands:[],overflowCommands:l}}function te(e){if(!e||!e.length)return e;for(var t=[],n={},r=0,i=e;r<i.length;r++){var s=i[r];if(!n[s.key]){t.push(s);n[s.key]=!0}}return t}});
define("aVG",["require","exports","f","H","aVH","MH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.contentCenterCreateModelCommand={key:new r.Facet("CreateModel").id,name:s.default.CreateModel,action:n.createElement(i.LaunchCreateModelPanelAction,null),iconProps:{iconName:"Add"}}});
define("aVH",["require","exports","mU","f","v8","cm","bw","bp","vk"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=a.afterPageLoad()(u.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aSG"],t,n)})];case 1:return[2,t.sent().default]}})})}));t.LaunchCreateModelPanelAction=function(){return r.createElement(i.WizardAction,{isAvailable:!0},o.withResources()(function(e){var t=e.reject,n=e.resolve;return r.createElement(f,{resources:e.resources,onDismiss:function(){t(new s.CancelError)},onComplete:function(e){e&&n()}})}))}});
define("aVC",["require","exports","mU","aVD","TS","q4","hn","aSV"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SaveForLaterCoachmarkCommand=r.createCoachmarkCommand(i.SAVE_FOR_LATER_COMMAND,function(e){return u.hasNoSavedItemsForLater(e)});t.saveForLaterCommand=n.__assign(n.__assign({},s.followCommand),{commandBarButtonAs:o.defaultRenderComponentOption().merge(t.SaveForLaterCoachmarkCommand,s.followCommand.commandBarButtonAs)})});
define("aVD",["require","exports","mU","f","a6","Kl","aV","Zj","aVF","bw","QE","a2","TS","cL","aVE"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._hideCoachmark=function(){var e=n.state.teachingBubble;e&&n._observables.wrap(e.isVisible)(!1)};n._onDismissTeachingBubble=function(){var e=n.state.teachingBubble;if(e){n._hideCoachmark();n._isReminderFlowCoachmark&&c.Engagement.logData({name:"ReminderFlowCoachmark.Close"});n._teachingBubbleProvider.markBubbleAsDismissed(e.campaign())}};n._getCurrentTeachingBubble=function(){return n._observables.unwrap(n._coachmarkProvider.getCurrentTeachingBubble())};n._hideToastNotifications=function(){var e=n.props.resources.consume(l.resourceKey.optional);e&&e.cleanup(!0)};n._onTeachingBubbleSeen=function(){n._isReminderFlowCoachmark()&&c.Engagement.logData({name:"ReminderFlowCoachmark.Rendered"})};n._isReminderFlowCoachmark=function(){var e=n.state.teachingBubble;if(!e)return!1;var t=e.campaign();return t&&t.campaignGuid===h.FLOW_REMIND_ME.campaignGuid};var r=t.resources;n._scope=new i.default;n._coachmarkProvider=r.consume(u.resourceKey.optional);n._observables=n._scope.attach(new(r.consume(s.observablesFactoryTypeResourceKey))({owner:n}));n.state={isCoachmarkVisible:!1,teachingBubble:n._getCurrentTeachingBubble()};return n}t.prototype.render=function(){var e=this.state,t=e.isCoachmarkVisible,i=e.teachingBubble;return r.createElement(a.ItemScopeCoachmarkCommand,n.__assign({isCoachmarkVisible:t,teachingBubbleCampaign:i&&i.campaign(),hideCoachmark:this._hideCoachmark,onCoachmarkAnimationOpen:this._hideToastNotifications,onDismissTeachingBubble:this._onDismissTeachingBubble,onTeachingBubbleSeen:this._onTeachingBubbleSeen},this.props))};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.componentDidMount=function(){var e=this;this._observables.compute(function(){e._computeShowCoachmark()})};t.prototype._computeShowCoachmark=function(){var e=this,t=this._getCurrentTeachingBubble();if(t){var n=this._observables.unwrap(t.isVisible),r=t.campaign(),i=this.state.isCoachmarkVisible;if(this._isCampaignCompatible(r)){this._teachingBubbleProvider||(this._teachingBubbleProvider=this.props.resources.consume(o.teachingBubble.optional));this._teachingBubbleProvider&&this._teachingBubbleProvider.shouldBubbleBeAdded(r,!1).then(function(r){e.setState({isCoachmarkVisible:r&&n,teachingBubble:t})})}else i&&this.setState({isCoachmarkVisible:!1})}};t.prototype._isCampaignCompatible=function(e){var t=this.props.coachmarkCampaign;return t===e||t===(e&&e.compatibleCampaign)};return t})(r.Component);t.CoachmarkCommand=f.withResources()(v);t.createCoachmarkCommand=function(e,i){var s=(function(i){n.__extends(s,i);function s(){var t=null!==i&&i.apply(this,arguments)||this;t._update=function(n,r){if(n.doesCoachmarkApply!==r.doesCoachmarkApply){var i=t.props.coachmarkProvider;n.doesCoachmarkApply?i.isVisible.peek()||i.setCampaign(e):i.isVisible.peek()&&e===i.currentCampaign.peek()&&i.hideCampaign()}};return t}s.prototype.componentDidMount=function(){this._update(this.props,{doesCoachmarkApply:!1})};s.prototype.render=function(){return r.createElement(t.CoachmarkCommand,n.__assign({},this.props))};s.prototype.componentDidUpdate=function(e){this._update(this.props,e)};return s})(r.PureComponent);return p.connectToItemCache(function(e){return{doesCoachmarkApply:i(e,{})}})(d.withCoachmarkProvider(e)(s))}});
define("aVF",["require","exports","mU","f","f","n4","aso","aV","bw"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._target=i.createRef();t._onMenuClicked=function(e,n){var r=t.props,i=r.hideCoachmark,s=r.onMenuClick;s&&s(e,n);i&&i()};t._onClick=function(e,n){var r,i=t.props,s=i.hideCoachmark,o=i.onClick;o&&(r=o(e,n));s&&s();return r};t._getCoachmark=function(){var e=t.props,n=e.isCoachmarkVisible,i=e.teachingBubbleCampaign,s=e.onCoachmarkAnimationOpen,u=e.onDismissTeachingBubble;if(n)return r.createElement(o.ItemScopeTeachingBubbleCoachmarkContainer,{target:t._target.current,teachingBubbleCampaign:i,onDismiss:u,onAnimationOpenStart:s,onTeachingBubbleSeen:t._onTeachingBubbleSeen})};t._onTeachingBubbleSeen=function(){var e=t.props.resources.consume(u.teachingBubble.optional);e&&e.markBubbleAsSeen(t.props.teachingBubbleCampaign);var n=t.props.onTeachingBubbleSeen;n&&n()};return t}t.prototype.render=function(){var e=this.props,t=e.defaultRender,i=void 0===t?s.CommandBarButton:t,o=n.__rest(e,["defaultRender"]),u=i;return r.createElement(r.Fragment,null,r.createElement("div",{ref:this._target},r.createElement(u,n.__assign({},o,{onClick:this._onClick,onMenuClick:this._onMenuClicked}))),this._getCoachmark())};return t})(r.PureComponent);t.ItemScopeCoachmarkCommand=a.withResources()(f)});
define("aVE",["require","exports","nM","Zj","bw"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withCoachmarkProvider=function(e){return function(t){return i.withResources()(n.injectInitialProps(function(t){return{coachmarkCampaign:e,coachmarkProvider:t.resources.consume(r.resourceKey.optional)}})(t))}}});
define("aVA",["require","exports","mU","aTd","Gg","iU","rV","rL","Gu","xB","cu","Gx","cQ","bu","rx","rj","Kt","aVB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=n.__spreadArrays(m.isFeatureEnabled(m.QuickEditNewItem)?[g.quickEditNewItemCommand]:[],[a.exitQuickEditCommand],m.isFeatureEnabled(m.QuickEditNewItem)?[r.EditItemCommand]:[],[o.shareCommand,o.copyLinkCommand,i.exportListCommand,r.powerAppsCommand],m.isFeatureEnabled(m.QuickEditDeleteCommand)?[d.deleteCommand]:[]),b=n.__spreadArrays([a.exitQuickEditCommand,o.shareCommand,o.copyLinkCommand,f.syncCommand,u.downloadCommand,i.exportListCommand],m.isFeatureEnabled(m.QuickEditDeleteCommand)?[d.deleteCommand]:[],m.isFeatureEnabled(m.QuickEditNewItem)?[r.bulkEditDocumentPropertyCommand]:[]),w=[r.alertMeCommand,r.manageAlertCommand],E=n.__spreadArrays(m.isFeatureEnabled(m.QuickEditNewItem)?[r.ViewDocumentPropertyCommand]:[],[r.versionHistoryCommand,r.alertMeCommand,r.manageAlertCommand]),S=[v.showProgressCommand,r.filtersPaneCommand],x=[v.showProgressCommand,r.filtersPaneCommand];t.getQuickEditCommands=function(e,t){var r,i,o=t.itemKey,u=t.listKey,a=t.pageContext,f=t.isDocumentLibrary,d=t.extraCommands,v=h.getCurrentItemSetKey(e),m=e.demandItemFacet(s.spItemKeyFacet,o),g=e.demandItemFacet(s.spFolderItemSetKeyFacet,v),T={webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl},N=s.spListViewsSetKeyFacet.serialize(T),C=e.demandItemFacet(l.childItemsFacet,N),k="";g&&g.viewKey&&(k=g.viewKey.viewId);!k&&a&&a.viewId&&(k=p.default.normalizeLower(a.viewId,!1));if(C&&m){var L=[];if((r=c.getViewsCommands(e,{viewKeys:C.itemKeys,webAbsoluteUrl:m.webAbsoluteUrl,listViewSetKey:T,itemSetKey:v,currentViewKey:s.spViewKeyFacet.serialize({viewId:k})}))&&r.subMenuProps&&r.subMenuProps.items){for(var A=r.subMenuProps.items,O=-1,M=0;M<A.length;M++){var _=A[M].automationId;if(_&&(0===_.indexOf("switchToFixedGridLayoutCommand")||0===_.indexOf("switchViewCommand_")||0===_.indexOf("saveCommand"))){O=M;break}}-1!==O&&(L=A.slice(O))}r=n.__assign(n.__assign({},r),{subMenuProps:n.__assign(n.__assign({},r.subMenuProps),{items:L})})}i=f?{commands:b,overflowCommands:E,farCommands:x}:{commands:y,overflowCommands:w,farCommands:S};d&&d.flowCommand&&(i.commands=n.__spreadArrays(i.commands,[d.flowCommand]));d&&d.openCommand&&f&&(i.commands=n.__spreadArrays([d.openCommand],i.commands));r&&(i.farCommands=n.__spreadArrays([r],i.farCommands));d&&d.fullscreenCommand&&(i.farCommands=n.__spreadArrays(i.farCommands,[d.fullscreenCommand]));return i}});
define("aVB",["require","exports","Gi","sa"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quickEditNewItemCommand={key:r.newCommand.key,action:n.createListItemCommand.action,iconProps:r.newCommand.iconProps,name:r.newCommand.name}});
define("aVy",["require","exports","f","H","ra","aVz"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.scheduleCommand={key:new r.Facet("SchedulingCommand").id,automationId:"schedulingCommand",name:"Scheduling",action:n.createElement(i.HideWithSelection,null,n.createElement(s.SchedulingAction,null)),iconProps:{iconName:"DateTime2"}}});
define("aVz",["require","exports","mU","f","cy","fa","Ot","bo","bw","iP","dB","mx"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=u.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aSK"],t,n)})];case 1:return[2,t.sent().SchedulingComponent]}})})}),p=c.default.isActivated("ffb3f710-f091-499b-880a-4dc902d3404b","4/27/2020","hide scheduling option on subwebs");t.SchedulingAction=function(){var e=a.useResourceScope(),t=e.consume(f.pageContext),n=t&&t.listBaseTemplate===o.ListTemplateType.webPageLibrary&&l.PermissionMask.hasPermission(t.webPermMasks,l.PermissionMask.manageWeb)&&(p||(function(e){return e.siteAbsoluteUrl===e.webAbsoluteUrl})(t)),u=i.renderComponentOnExecute(function(n){var i=n.resolve;n.reject;return r.createElement(h,{pageContext:t,resources:e,resolve:i})});return r.createElement(s.Action,{isAvailable:n,onExecute:u})}});
define("aVx",["require","exports","mU","aTd","c3","cZ","fn"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSharedNavigationCommands=function(e,t){var u=e.demandItemFacet(s.sharedByMeRootItemKeyFacet,t),a=e.demandItemFacet(i.sharedWithMeRootItemKeyFacet,t);if(!u&&!a)return[];var f=n.__assign(n.__assign({},r.NavigateToSharedByMeCommand),{className:u?"is-pivot is-current-view":"is-pivot"}),l=n.__assign(n.__assign({},r.NavigateToSharedWithMeCommand),{className:a?"is-pivot is-current-view":"is-pivot"}),c=o.getSelectedItemKeys(e);return c&&0!==c.length?[]:[l,f]}});
define("aVw",["require","exports","aL","hR","D8","r8","Gm","mx","F7"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=!u.default.isActivated(o.SHOW_FILEHANDLER_COMMANDS_FIRST,"7/5/2019","Show file handler commands before OOB commands");function l(e,t){var s=new n.SimpleUri(t).authority,o=r.driveAppsKeyFacet.serialize({endpoint:s});return i.getFileHandlerCommands(e,{itemKey:o})}t.getExtendedCommandsWithFileHandlers=function(e,t,n){return(function(e,t){return e.map(function(e){return e.key===s.openCommand.key?o.getOpenFileCommandWithHandler(t,f):e})})(n,l(e,t))};t.extendContextMenuOpenFileCommand=function(e,t,n){var r=n.key,s=l(e,t);if(r===a.openFileCommand.key){var o=s&&s.open||[];o.length>0&&a.openFileCommandForContextMenu.subMenuProps&&(a.openFileCommandForContextMenu.subMenuProps.items=i.mergeFileHandlerCommands(a.openFileCommandForContextMenu.subMenuProps.items,o,f));return a.openFileCommandForContextMenu}return n}});
define('OneDriveLightspeedItemsScopeDeferred_mini_css',["jh","Aa"],function(e){"use strict";e.loadStyles([{"rawString":".syncDialog_5fe6e913{-webkit-box-shadow:rgba(0,0,0,0.22) 0px 25.6px 57.6px;box-shadow:rgba(0,0,0,0.22) 0px 25.6px 57.6px;text-align:center}.syncDialogContent_5fe6e913{margin:0 -8px;overflow-x:hidden}.syncDialogContent_5fe6e913 .syncImg_5fe6e913{width:100%;max-width:100%;-webkit-transform:scale(1.2, 1.2);transform:scale(1.2, 1.2);margin-bottom:20px;margin-top:10px;height:278px}.copyLibraryId_5fe6e913{height:10px;color:#0000EE;padding:9px 0;font-size:14px;font-weight:600}.pointerText_5fe6e913{text-decoration:none}.footNote_5fe6e913{font-size:12px}.syncTitle_5fe6e913{font-weight:600;font-size:20px}.contentContainer_5fe6e913{margin:10px 0px;padding:0 10px}.adminContentContainer_5fe6e913{margin:2.5px -2.5px}.separator_5fe6e913{margin:-5px}\n"},{"rawString":".peopleEditor_f6f00c2d.increaseZIndex_f6f00c2d{position:relative;z-index:20;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.peopleEditor_f6f00c2d .ms-Button{min-width:0px;margin-left:0px}.peopleEditor_f6f00c2d .ms-BasePicker-input{border:none;padding:0 6px 0px}.peopleEditor_f6f00c2d.stickyEditor_f6f00c2d{z-index:70}\n"},{"rawString":".personDisplayPill_16752b23{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";height:24px;border-radius:12px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.personDisplayCoin_16752b23{border-radius:12px;display:inline-block;width:24px;height:24px;text-align:center;font-size:10px;font-weight:600;line-height:24px;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.personDisplayName_16752b23{padding:0 4px}\n"},{"rawString":".pill_33412976,.pillNoHoverStyle_33412976{min-height:inherit;padding:8px 0px 8px 8px}[dir='rtl'] .pill_33412976,[dir='rtl'] .pillNoHoverStyle_33412976{padding:8px 8px 8px 0px}.pill_33412976 div:first-child,.pillNoHoverStyle_33412976 div:first-child{margin:0px}.pill_33412976:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.wellInput_33412976{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.fontIcon_33412976{display:block;position:absolute;bottom:0;right:0;-webkit-box-sizing:border-box;box-sizing:border-box;width:32px;height:46px;padding-top:17px;text-align:center}.fontIcon_33412976:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}\n"},{"rawString":".calloutButtonsContainer_74e34ef3{margin-top:12px;padding-top:8px;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}\n"},{"rawString":".locationEditor_39f90a79{position:relative;z-index:20;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.locationEditor_39f90a79.stickyEditor_39f90a79{z-index:70}\n"},{"rawString":".taxonomyEditorSpan_362d1c5d{display:-webkit-box;display:-ms-flexbox;display:flex}.taxonomyEditorSpan_362d1c5d.increaseZIndex_362d1c5d{position:relative;z-index:20;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.taxonomyEditorSpan_362d1c5d.increaseZIndex_362d1c5d.stickyEditor_362d1c5d{z-index:70}\n"},{"rawString":".spGridTableHead_2950b163{display:none}.spGridPagingFooter_2950b163{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.spGridCustomFormatField_2950b163{min-height:inherit;margin:-11px 0;white-space:normal}.wrapperTable_2950b163{border-spacing:0px}.wrapperTd_2950b163{padding:0}.spGridRoot_2950b163 iframe{border:none}.spGridRoot_2950b163 input[type='radio']{vertical-align:middle;margin:3px 3px 0px 5px}[dir='rtl'] .spGridRoot_2950b163 input[type='radio']{margin:3px 5px 0px 3px}.spGridRoot_2950b163 label{vertical-align:middle}.spGridRoot_2950b163 .ms-accessible,.spGridRoot_2950b163 .ms-hidden{position:absolute;top:-2000px;overflow:hidden;height:1px;width:1px;display:block}.spGridRoot_2950b163 .ms-accessible-quickedit,.spGridRoot_2950b163 .ms-hidden{position:absolute;top:-2000px;overflow:hidden;height:1px;width:1px;display:block}.spGridRoot_2950b163 .ms-spGrid-HeaderContentStyle-Rename{padding:3px 5px 0px 5px}.spGridRoot_2950b163 .ms-spGrid-HeaderContentStyle-Rename input{padding:2px 5px}.spGridErrorIcon_2950b163{color:"},{"theme":"errorText","defaultValue":"#a4262c"},{"rawString":";background-color:"},{"theme":"errorBackground","defaultValue":"rgba(245, 135, 145, .2)"},{"rawString":";border-radius:8px}.dropHintStyle_2950b163{display:inline-block;position:absolute}.dropHintStyle_2950b163.containerRefreshed_2950b163{height:42px}.dropHintCaretStyle_2950b163{display:none;position:absolute;top:22px;left:-7.5px;color:#004e8c;overflow:visible;z-index:10}.dropHintCaretStyle_2950b163.caretRefreshed_2950b163{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";left:-6.5px;top:unset;bottom:0}.dropHintLineStyle_2950b163{display:none;position:absolute;bottom:0px;top:-3px;overflow:hidden;height:37px;width:1px;background-color:#004e8c}.dropHintLineStyle_2950b163.lineRefreshed_2950b163{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";height:28px;top:7px}.jsgrid-control-multiline-quickedit{background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.jsgrid-control-rte-quickedit{background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.jsgrid-widget-hyperlink-quickedit{background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";border:1px solid "},{"theme":"inputBorder","defaultValue":"#8a8886"},{"rawString":"}.jsgrid-widget-hyperlink-buttonarea-quickedit{background-color:"},{"theme":"buttonBackground","defaultValue":"#ffffff"},{"rawString":"}.jsgrid-changehighlight{background-color:"},{"theme":"bodyStandoutBackground","defaultValue":"#faf9f8"},{"rawString":"}.ms-vb a:link,.ms-vb2 a:link,.ms-vb-user a:link{text-decoration:none}.ms-vb a.ms-listlink,.ms-vb2 a.ms-listlink,.ms-vb-user a.ms-listlink,.ms-vb a.ms-listlink:visited,.ms-vb a.ms-listlink:visited:hover{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";text-decoration:none}.listLink_2950b163{font-weight:600}.ms-vb-title .isTitleOrNameFieldVisualRefresh_2950b163{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";font-weight:600}.ms-vb-title .isTitleOrNameField_2950b163{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";font-weight:400}.cellHiddenOverflow_2950b163,.cellBreakWordOverflow_2950b163{display:inline-block;width:100%;position:relative;z-index:15}.cellHiddenOverflow_2950b163{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;vertical-align:middle}.cellBreakWordOverflow_2950b163{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.customFormatField_2950b163{margin:0}.msGridWidgetDock_2950b163{border:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";background-color:#fdfdfd;height:20px;position:absolute;cursor:pointer;z-index:20}.stickyEditor_2950b163{z-index:70}.msGridWidgetDockHover_2950b163{border-color:#92c0e0;background-color:#e6f2fa}.msGridWidgetDockPressed_2950b163{border-color:#2a8dd4;background-color:#92b7d1}.msGridWidgetCell_2950b163{overflow:hidden;padding:2px;height:16px;width:16px;top:0px;position:absolute}[dir='ltr'] .msGridWidgetCell_2950b163{float:left}[dir='rtl'] .msGridWidgetCell_2950b163{float:right}.msGridCellSelectedEditable_2950b163{cursor:text}.msGridCellSelectedEditable_2950b163 a:hover{cursor:text}.msGridCellSelectedEditable_2950b163 [ms-jsgrid-click-passthrough='true']{cursor:auto}.spGridErrorNotification_2950b163{color:#bf0000;text-align:left}.msGrid_2950b163{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-right-style:solid;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-bottom-style:solid;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridLink_2950b163{color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":";background-color:#663399}.msGridSelection_2950b163{border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";color:#9ccef0}[dir='ltr'] .msGridSelection_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridSelection_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridSelection_2950b163{border-right-color:rgba(0,0,0,0)}[dir='rtl'] .msGridSelection_2950b163{border-left-color:rgba(0,0,0,0)}.msGridSelectionReadonly_2950b163{border-bottom-color:#e1e1e1}.msGridEdit_2950b163{background-color:#cde6f7;border-top-color:#bf0000}[dir='ltr'] .msGridEdit_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridEdit_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridTimescale_2950b163{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-bottom-style:solid;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridTimescale_2950b163{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridTimescale_2950b163{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridTimescale_2950b163{border-right-style:solid}[dir='rtl'] .msGridTimescale_2950b163{border-left-style:solid}[dir='ltr'] .msGridTimescale_2950b163{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridTimescale_2950b163{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.msGridColHeaderNormal_2950b163{font-size:1em;font-weight:normal;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";background-color:transparent;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-top-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='ltr'] .msGridColHeaderNormal_2950b163{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderNormal_2950b163{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderNormal_2950b163{border-left-color:rgba(0,0,0,0)}[dir='rtl'] .msGridColHeaderNormal_2950b163{border-right-color:rgba(0,0,0,0)}.msGridColHeaderElemBgColorsNormal_2950b163{background-color:transparent;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsNormal_2950b163{border-left-color:rgba(0,0,0,0)}[dir='rtl'] .msGridColHeaderElemBgColorsNormal_2950b163{border-right-color:rgba(0,0,0,0)}[dir='ltr'] .msGridColHeaderElemBgColorsNormal_2950b163{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsNormal_2950b163{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.msGridColHeaderElemHoverBgColorsNormal_2950b163{color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsNormal_2950b163{border-right-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsNormal_2950b163{border-left-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}.ms-core-needIEFilter .msGridColHeaderElemHoverBgColorsNormal_2950b163{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridColElemColorsClickNormal_2950b163{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickNormal_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickNormal_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderNormalHover_2950b163{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemBgColorsNormalHover_2950b163{background-color:transparent;border-bottom-color:transparent}[dir='ltr'] .msGridColHeaderElemBgColorsNormalHover_2950b163{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsNormalHover_2950b163{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsNormalHover_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsNormalHover_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemHoverBgColorsNormalHover_2950b163{background-color:transparent;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsNormalHover_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsNormalHover_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColElemColorsClickNormalHover_2950b163{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickNormalHover_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickNormalHover_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderPartSelected_2950b163{font-size:1em;font-weight:normal;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";background-color:transparent;border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderPartSelected_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderPartSelected_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderPartSelected_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderPartSelected_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemBgColorsPartSelected_2950b163{background-color:transparent;border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsPartSelected_2950b163{border-left-color:rgba(0,0,0,0)}[dir='rtl'] .msGridColHeaderElemBgColorsPartSelected_2950b163{border-right-color:rgba(0,0,0,0)}[dir='ltr'] .msGridColHeaderElemBgColorsPartSelected_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsPartSelected_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemHoverBgColorsPartSelected_2950b163{color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsPartSelected_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsPartSelected_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColElemColorsClickPartSelected_2950b163{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickPartSelected_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickPartSelected_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderPartSelectedHover_2950b163{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemBgColorsPartSelectedHover_2950b163{background-color:transparent;border-bottom-color:transparent}[dir='ltr'] .msGridColHeaderElemBgColorsPartSelectedHover_2950b163{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsPartSelectedHover_2950b163{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsPartSelectedHover_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsPartSelectedHover_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemHoverBgColorsPartSelectedHover_2950b163{background-color:transparent;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsPartSelectedHover_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsPartSelectedHover_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColElemColorsClickPartSelectedHover_2950b163{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickPartSelectedHover_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickPartSelectedHover_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderAllSelected_2950b163{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderAllSelected_2950b163{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderAllSelected_2950b163{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderAllSelected_2950b163{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderAllSelected_2950b163{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.msGridColHeaderElemBgColorsAllSelected_2950b163{background-color:transparent;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsAllSelected_2950b163{border-left-color:rgba(0,0,0,0)}[dir='rtl'] .msGridColHeaderElemBgColorsAllSelected_2950b163{border-right-color:rgba(0,0,0,0)}.msGridColHeaderElemHoverBgColorsAllSelected_2950b163{color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsAllSelected_2950b163{border-right-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsAllSelected_2950b163{border-left-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}.msGridColElemColorsClickAllSelected_2950b163{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickAllSelected_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickAllSelected_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderAllSelectedHover_2950b163{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemBgColorsAllSelectedHover_2950b163{background-color:transparent;border-bottom-color:transparent}[dir='ltr'] .msGridColHeaderElemBgColorsAllSelectedHover_2950b163{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsAllSelectedHover_2950b163{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsAllSelectedHover_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsAllSelectedHover_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemHoverBgColorsAllSelectedHover_2950b163{background-color:transparent;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsAllSelectedHover_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsAllSelectedHover_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColElemColorsClickAllSelectedHover_2950b163{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickAllSelectedHover_2950b163{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickAllSelectedHover_2950b163{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridRowHeaderNormal_2950b163{border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.msGridRowHeaderNormalHover_2950b163,.msGridRowHeaderPartSelected_2950b163,.msGridRowHeaderPartSelectedHover_2950b163,.msGridRowHeaderAllSelected_2950b163,.msGridRowHeaderAllSelectedHover_2950b163{border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.msGridSplitter_2950b163{border-top-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='ltr'] .msGridSplitter_2950b163{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridSplitter_2950b163{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.ms-core-needIEFilter .msGridSplitter_2950b163{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterHandle_2950b163{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}[dir='ltr'] .msGridSplitterHandle_2950b163{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridSplitterHandle_2950b163{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridSplitterHandle_2950b163{border-right-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='rtl'] .msGridSplitterHandle_2950b163{border-left-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.ms-core-needIEFilter .msGridSplitterHandle_2950b163{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterHover_2950b163{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='ltr'] .msGridSplitterHover_2950b163{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridSplitterHover_2950b163{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.ms-core-needIEFilter .msGridSplitterHover_2950b163{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterHandleHover_2950b163{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}[dir='ltr'] .msGridSplitterHandleHover_2950b163{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridSplitterHandleHover_2950b163{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='ltr'] .msGridSplitterHandleHover_2950b163{border-right-color:rgba(0,0,0,0)}[dir='rtl'] .msGridSplitterHandleHover_2950b163{border-left-color:rgba(0,0,0,0)}.ms-core-needIEFilter .msGridSplitterHandleHover_2950b163{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterDrag_2950b163{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='ltr'] .msGridSplitterDrag_2950b163{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridSplitterDrag_2950b163{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.ms-core-needIEFilter .msGridSplitterDrag_2950b163{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterHandleDrag_2950b163{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}[dir='ltr'] .msGridSplitterHandleDrag_2950b163{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridSplitterHandleDrag_2950b163{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='ltr'] .msGridSplitterHandleDrag_2950b163{border-right-color:rgba(0,0,0,0)}[dir='rtl'] .msGridSplitterHandleDrag_2950b163{border-left-color:rgba(0,0,0,0)}.ms-core-needIEFilter .msGridSplitterHandleDrag_2950b163{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.spGridControlFocusElement_2950b163:focus{outline:none}input[type='text'].spGridControlEditbox_2950b163,.spGridControlEditbox_2950b163,.spGridControlFocusElement_2950b163{font-family:inherit;font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-sizing:border-box;box-sizing:border-box;border:0px;padding:2px 6px 0;z-index:30;overflow:hidden;outline:none}[dir='ltr'] input[type='text'].spGridControlEditbox_2950b163.inputIsNumber_2950b163,[dir='ltr'] .spGridControlEditbox_2950b163.inputIsNumber_2950b163,[dir='ltr'] .spGridControlFocusElement_2950b163.inputIsNumber_2950b163{text-align:right}[dir='rtl'] input[type='text'].spGridControlEditbox_2950b163.inputIsNumber_2950b163,[dir='rtl'] .spGridControlEditbox_2950b163.inputIsNumber_2950b163,[dir='rtl'] .spGridControlFocusElement_2950b163.inputIsNumber_2950b163{text-align:left}input[type='text'].spGridControlEditbox_2950b163.inputIsTitle_2950b163,.spGridControlEditbox_2950b163.inputIsTitle_2950b163,.spGridControlFocusElement_2950b163.inputIsTitle_2950b163{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:600}input[type='text'].spGridControlEditbox_2950b163.spGridControlEditboxDynamicHeight_2950b163,.spGridControlEditbox_2950b163.spGridControlEditboxDynamicHeight_2950b163,.spGridControlFocusElement_2950b163.spGridControlEditboxDynamicHeight_2950b163{padding-top:0}input[type='text'].spGridControlEditbox_2950b163.stickyEditor_2950b163,.spGridControlEditbox_2950b163.stickyEditor_2950b163,.spGridControlFocusElement_2950b163.stickyEditor_2950b163{z-index:70}input[type='text'].spGridControlEditbox_2950b163::-ms-clear{display:none}.jsgridControlMultilineTextarea_2950b163{font-family:inherit;font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-sizing:border-box;box-sizing:border-box;border:0px;padding:2px 6px 0;z-index:30;outline:none;padding-bottom:2px}.jsgridControlRteContainer_2950b163{z-index:30;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.jsgridControlRteContainer_2950b163 .ms-shadow{-webkit-box-shadow:0px 0px 7px 0px rgba(0,0,0,0.47);box-shadow:0px 0px 7px 0px rgba(0,0,0,0.47)}.msRteStateField_2950b163{padding:1px 0}.msRteStateField_2950b163 div:first-child{padding:1px 0}.ms-grid-group1{background-color:#0072c6}.ms-grid-group2{background-color:#00485b}.ms-grid-group3{background-color:#288054}.ms-grid-group4{background-color:#767956}.ms-grid-group5{background-color:#ed0033}.ms-grid-group6{background-color:#682a7a}.ms-grid-group7{background-color:#0072c6}.ms-grid-group8{background-color:#00485b}.ms-grid-group9{background-color:#288054}.outer-scroll-bar{position:relative;background-color:#e6e8eb;top:0px}[dir='ltr'] .outer-scroll-bar{left:0px}[dir='rtl'] .outer-scroll-bar{right:0px}.inner-scroll-bar{border-top:1px solid #f5f6f7;border-bottom:1px solid #f5f6f7;background-color:#f0f0f0;position:relative;top:1px}[dir='ltr'] .inner-scroll-bar{border-right:1px solid #f8f9f9}[dir='rtl'] .inner-scroll-bar{border-left:1px solid #f8f9f9}[dir='ltr'] .inner-scroll-bar{border-left:1px solid #f5f6f7}[dir='rtl'] .inner-scroll-bar{border-right:1px solid #f5f6f7}[dir='ltr'] .inner-scroll-bar{left:1px}[dir='rtl'] .inner-scroll-bar{right:1px}.scroll-bar-cell{border:1px solid #f6f6f6;background-color:#d5dded}.scroll-bar-inner-arrow-cell{border:1px solid transparent}.scroll-bar-arrow-cell{border:1px solid transparent;position:absolute;top:0px}[dir='ltr'] .scroll-bar-arrow-cell{left:0px}[dir='rtl'] .scroll-bar-arrow-cell{right:0px}.scroll-bar-outer-box{border:1px solid #a3a6ab;background-color:#eeeff2;position:absolute;top:0px}[dir='ltr'] .scroll-bar-outer-box{left:0px}[dir='rtl'] .scroll-bar-outer-box{right:0px}.scroll-bar-background-main{background-color:#f2f3f5}.scroll-bar-background-shade{background-color:#edeef0}.scroll-bar-inner-box-main{background-color:#dbdfe5}.scroll-bar-inner-box-shade{background-color:#e5e8ec}.scroll-bar-arrow{border:0px;padding:0px;text-align:center;vertical-align:top}.scroll-bar-grip{position:absolute;top:0px;border-color:#a7aaaf;background-color:#fefefe}[dir='ltr'] .scroll-bar-grip{left:0px}[dir='rtl'] .scroll-bar-grip{right:0px}.horiz-scroll-bar-bg-block{height:100%}[dir='ltr'] .horiz-scroll-bar-bg-block{float:left}[dir='rtl'] .horiz-scroll-bar-bg-block{float:right}.horiz-scroll-bar-arrow-cell{top:-2px}.horiz-scroll-bar-outer-box{top:-1px}.horiz-scroll-bar-grip{height:5px;width:1px}[dir='ltr'] .horiz-scroll-bar-grip{border-left-style:solid}[dir='rtl'] .horiz-scroll-bar-grip{border-right-style:solid}[dir='ltr'] .horiz-scroll-bar-grip{border-left-width:1px}[dir='rtl'] .horiz-scroll-bar-grip{border-right-width:1px}[dir='ltr'] .vert-scroll-bar-inner-box-main{float:right}[dir='rtl'] .vert-scroll-bar-inner-box-main{float:left}[dir='ltr'] .vert-scroll-bar-inner-box-shade{float:left}[dir='rtl'] .vert-scroll-bar-inner-box-shade{float:right}[dir='ltr'] .vert-scroll-bar-background-main{float:right}[dir='rtl'] .vert-scroll-bar-background-main{float:left}[dir='ltr'] .vert-scroll-bar-background-shade{float:left}[dir='rtl'] .vert-scroll-bar-background-shade{float:right}[dir='ltr'] .vert-scroll-bar-arrow-cell{left:-2px}[dir='rtl'] .vert-scroll-bar-arrow-cell{right:-2px}[dir='ltr'] .vert-scroll-bar-outer-box{left:-1px}[dir='rtl'] .vert-scroll-bar-outer-box{right:-1px}.vert-scroll-bar-grip{border-top:1px solid;height:1px;width:5px}.clip6x9,.clip9x6,.clip11x11,.clip13x13,.clip16x16{position:relative;overflow:hidden}.clip6x9{width:6px;height:9px}.clip9x6{width:9px;height:6px}.clip11x11{width:11px;height:11px}.clip13x13{width:13px;height:13px}.clip16x16{width:16px;height:16px}.clip6x9 img,.clip6x9 input,.clip9x6 img,.clip9x6 input,.clip11x11 img,.clip11x11 input,.clip13x13 img,.clip13x13 input,.clip16x16 img,.clip16x16 input{position:absolute;margin:0;padding:0;width:auto;height:auto}.jsgridcluster_editheader{top:0}[dir='ltr'] .jsgridcluster_editheader{left:0}[dir='rtl'] .jsgridcluster_editheader{right:0}.jsgridcluster_newrowheader{top:0}[dir='ltr'] .jsgridcluster_newrowheader{left:-16px}[dir='rtl'] .jsgridcluster_newrowheader{right:-16px}.jsgridcluster_conflictheader{top:-16px}[dir='ltr'] .jsgridcluster_conflictheader{left:0}[dir='rtl'] .jsgridcluster_conflictheader{right:0}.jsgridcluster_transferheader{top:-16px}[dir='ltr'] .jsgridcluster_transferheader{left:-16px}[dir='rtl'] .jsgridcluster_transferheader{right:-16px}.jsgridcluster_cell-error{top:0}[dir='ltr'] .jsgridcluster_cell-error{left:-32px}[dir='rtl'] .jsgridcluster_cell-error{right:-32px}.jsgridcluster_jsgrid-header-filter-icon{top:-16px}[dir='ltr'] .jsgridcluster_jsgrid-header-filter-icon{left:-32px}[dir='rtl'] .jsgridcluster_jsgrid-header-filter-icon{right:-32px}.jsgridcluster_scrollbar-mousein-rightarrow{top:-32px}[dir='ltr'] .jsgridcluster_scrollbar-mousein-rightarrow{left:0}[dir='rtl'] .jsgridcluster_scrollbar-mousein-rightarrow{right:0}.jsgridcluster_scrollbar-mousein-downarrow{top:-32px}[dir='ltr'] .jsgridcluster_scrollbar-mousein-downarrow{left:-6px}[dir='rtl'] .jsgridcluster_scrollbar-mousein-downarrow{right:-6px}.jsgridcluster_scrollbar-mousein-uparrow{top:-32px}[dir='ltr'] .jsgridcluster_scrollbar-mousein-uparrow{left:-15px}[dir='rtl'] .jsgridcluster_scrollbar-mousein-uparrow{right:-15px}.jsgridcluster_scrollbar-mousein-leftarrow{top:-32px}[dir='ltr'] .jsgridcluster_scrollbar-mousein-leftarrow{left:-24px}[dir='rtl'] .jsgridcluster_scrollbar-mousein-leftarrow{right:-24px}.jsgridcluster_scrollbar-mouseout-rightarrow{top:-27px}[dir='ltr'] .jsgridcluster_scrollbar-mouseout-rightarrow{left:-32px}[dir='rtl'] .jsgridcluster_scrollbar-mouseout-rightarrow{right:-32px}.jsgridcluster_scrollbar-mouseout-uparrow{top:-27px}[dir='ltr'] .jsgridcluster_scrollbar-mouseout-uparrow{left:-38px}[dir='rtl'] .jsgridcluster_scrollbar-mouseout-uparrow{right:-38px}.jsgridcluster_scrollbar-mouseout-downarrow{top:-33px}[dir='ltr'] .jsgridcluster_scrollbar-mouseout-downarrow{left:-38px}[dir='rtl'] .jsgridcluster_scrollbar-mouseout-downarrow{right:-38px}.jsgridcluster_scrollbar-mouseout-leftarrow{top:-41px}[dir='ltr'] .jsgridcluster_scrollbar-mouseout-leftarrow{left:0}[dir='rtl'] .jsgridcluster_scrollbar-mouseout-leftarrow{right:0}.jsgridcluster_jsgrid-up-arrow{top:-38px}[dir='ltr'] .jsgridcluster_jsgrid-up-arrow{left:-6px}[dir='rtl'] .jsgridcluster_jsgrid-up-arrow{right:-6px}.jsgridcluster_jsgrid-down-arrow{top:-44px}[dir='ltr'] .jsgridcluster_jsgrid-down-arrow{left:-6px}[dir='rtl'] .jsgridcluster_jsgrid-down-arrow{right:-6px}\n"},{"rawString":".spGridSelectAllIconContainer_bbc56945{text-align:center;vertical-align:middle;min-height:25px;width:25px}.spGridSelectAllIcon_bbc56945{font-size:16px}.spGridCell_bbc56945{padding-top:11px;padding-bottom:11px;-webkit-box-sizing:border-box;box-sizing:border-box;min-height:42px}[dir='ltr'] .spGridCell_bbc56945{padding-left:12px}[dir='rtl'] .spGridCell_bbc56945{padding-right:12px}[dir='ltr'] .spGridCell_bbc56945{padding-right:8px}[dir='rtl'] .spGridCell_bbc56945{padding-left:8px}.tableColumnHeadersRow_bbc56945 th{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridSelectAllIconContainer_bbc56945{padding:0;text-align:center;vertical-align:middle;min-height:25px;width:58px;border-bottom:2px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.gridSelectAllIconContainer_bbc56945.selectAllCheckMarkCell_bbc56945{-webkit-box-sizing:border-box;box-sizing:border-box}[dir='ltr'] .gridSelectAllIconContainer_bbc56945.selectAllCheckMarkCell_bbc56945{padding-left:30px}[dir='rtl'] .gridSelectAllIconContainer_bbc56945.selectAllCheckMarkCell_bbc56945{padding-right:30px}.gridSelectAllIconContainer_bbc56945.selectAllCheckMarkCell_bbc56945 .selectionCheckIconsWrapper_bbc56945{visibility:visible}.gridSelectAllIconContainer_bbc56945.allRowsSelected_bbc56945 .selectionCheckIconsWrapper_bbc56945:before{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.gridSelectAllIconContainer_bbc56945.allRowsSelected_bbc56945 .selectionCheckIcon_bbc56945,.gridSelectAllIconContainer_bbc56945.allRowsSelected_bbc56945 .selectionCircleIcon_bbc56945{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridSelectAllIconContainer_bbc56945.allRowsSelected_bbc56945 .selectionCheckIcon_bbc56945{visibility:visible;font-weight:900}.headerStateContainer_bbc56945{-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;width:20px;height:100%}.headerStateContainer_bbc56945.hasStateElements_bbc56945{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.headerStateContainer_bbc56945.hasStateElements_bbc56945 .headerStateBar_bbc56945{display:none}.headerStateBar_bbc56945{width:4px;border-radius:2px;background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.selectionCheckMark_bbc56945,.inlineNewItemAddIconContainer_bbc56945{-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;vertical-align:bottom;width:36px;height:100%}.selectionCheckIconsWrapper_bbc56945{width:18px;height:18px;line-height:1;position:relative;visibility:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.selectionCheckIconsWrapper_bbc56945:before{content:'';position:absolute;top:1px;right:1px;bottom:1px;left:1px;border-radius:50%;opacity:1;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.selectionCheckIconsWrapper_bbc56945:hover .selectionCheckIcon_bbc56945{visibility:visible}.selectionCircleIcon_bbc56945,.selectionCheckIcon_bbc56945{display:inline-block;position:absolute;left:0;top:0;width:18px;height:18px;text-align:center;vertical-align:middle;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.selectionCircleIcon_bbc56945{font-size:18px}.selectionCheckIcon_bbc56945{font-size:16px;visibility:hidden;left:0.5px}.stickyEditor_bbc56945.selectedEditor_bbc56945:before{z-index:60}.selectedEditor_bbc56945:after{pointer-events:none;content:\"\";position:absolute;left:0px;top:0px;bottom:0px;right:0px;border-radius:2px;border-width:2px;border-style:solid;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";-o-border-image:initial;border-image:initial;z-index:10}.inlineNewItemAddIcon_bbc56945{font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.inlineNewItemAddIcon_bbc56945:hover{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.inlineNewItemAddIconContainer_bbc56945{display:none}.inlineNewItemPlaceHolder_bbc56945{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:600;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";display:none}:not(.rowIsActive_bbc56945).inLineNewItemRow_bbc56945 .gridCell_bbc56945{border-bottom:0px}:not(.rowIsActive_bbc56945).inLineNewItemRow_bbc56945 .gridCell_bbc56945:after{content:none}:not(.rowIsActive_bbc56945).inLineNewItemRow_bbc56945 .inlineNewItemAddIconContainer_bbc56945{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}:not(.rowIsActive_bbc56945).inLineNewItemRow_bbc56945 :not(.cellIsFocusedAndSelected_bbc56945) .inlineNewItemPlaceHolder_bbc56945{display:inline-block}:not(.rowIsActive_bbc56945).inLineNewItemRow_bbc56945 .selectionCheckMark_bbc56945,:not(.rowIsActive_bbc56945).inLineNewItemRow_bbc56945 .headerStateBar_bbc56945{display:none}:not(.rowIsActive_bbc56945).inLineNewItemRow_bbc56945:hover .inlineNewItemPlaceHolder_bbc56945{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.gridCell_bbc56945{padding:8px;min-height:28px;height:28px;vertical-align:middle;color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";font-size:12px;border-bottom:2px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";position:relative}[dir='ltr'] .gridCell_bbc56945{text-align:left}[dir='rtl'] .gridCell_bbc56945{text-align:right}.gridCell_bbc56945:after{content:'';position:absolute;width:1px;right:0;top:0;bottom:0;margin:8px 0;border-radius:1px;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='rtl'] .gridCell_bbc56945:after{right:unset;left:0}.gridCell_bbc56945.cellHasCopyBorder_bbc56945.cellIsSticky_bbc56945:before{z-index:60}.gridCell_bbc56945.cellHasCopyBorder_bbc56945:before{content:'';position:absolute;z-index:10;top:0;left:0;right:0;bottom:0;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;border-width:0px}.gridCell_bbc56945.cellHasCopyBorder_bbc56945.cellLeftBorder_bbc56945:before{border-left-width:2px;border-left-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-left-style:dashed}.gridCell_bbc56945.cellHasCopyBorder_bbc56945.cellRightBorder_bbc56945:before{border-right-width:2px;border-right-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-right-style:dashed;width:100% !important}.gridCell_bbc56945.cellHasCopyBorder_bbc56945.cellTopBorder_bbc56945:before{border-top-width:2px;border-top-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-top-style:dashed}.gridCell_bbc56945.cellHasCopyBorder_bbc56945.cellBottomBorder_bbc56945:before{border-bottom-width:2px;border-bottom-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-bottom-style:dashed;height:100% !important}.gridCell_bbc56945.cellHasCopyBorder_bbc56945.cellLeftBorder_bbc56945.cellTopBorder_bbc56945:before{border-top-left-radius:2px}.gridCell_bbc56945.cellHasCopyBorder_bbc56945.cellLeftBorder_bbc56945.cellBottomBorder_bbc56945:before{border-bottom-left-radius:2px}.gridCell_bbc56945.cellHasCopyBorder_bbc56945.cellRightBorder_bbc56945.cellTopBorder_bbc56945:before{border-top-right-radius:2px}.gridCell_bbc56945.cellHasCopyBorder_bbc56945.cellRightBorder_bbc56945.cellBottomBorder_bbc56945:before{border-bottom-right-radius:2px}.gridCell_bbc56945.cellHasCopyBorder_bbc56945:not(.firstCell_bbc56945):hover:not(.cellLeftBorder_bbc56945){border-left-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-left-style:solid;border-left-width:2px}.gridCell_bbc56945.cellHasCopyBorder_bbc56945:not(.firstCell_bbc56945):hover:not(.cellTopBorder_bbc56945){border-top-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-top-style:solid;border-top-width:2px}.gridCell_bbc56945.cellHasCopyBorder_bbc56945:not(.firstCell_bbc56945):hover:not(.cellBottomBorder_bbc56945){border-bottom-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-bottom-style:solid;border-bottom-width:2px}.gridCell_bbc56945.cellHasCopyBorder_bbc56945:not(.firstCell_bbc56945):hover:not(.cellRightBorder_bbc56945){border-right-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-right-style:solid;border-right-width:2px}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945.cellIsSticky_bbc56945:before{z-index:60}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945.readOnlySelectionFrame_bbc56945:before{border-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":" !important}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945:before{content:'';position:absolute;z-index:10;top:0;left:0;right:0;bottom:0;width:100%;height:110%;-webkit-box-sizing:border-box;box-sizing:border-box;border-width:0px}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945.cellLeftBorder_bbc56945:before{border-left-width:2px;border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-left-style:solid}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945.cellRightBorder_bbc56945:before{border-right-width:2px;border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-right-style:solid;width:100% !important}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945.cellTopBorder_bbc56945:before{border-top-width:2px;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-top-style:solid}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945.cellBottomBorder_bbc56945:before{border-bottom-width:2px;border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-style:solid;height:100% !important}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945.cellLeftBorder_bbc56945.cellTopBorder_bbc56945:before{border-top-left-radius:2px}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945.cellLeftBorder_bbc56945.cellBottomBorder_bbc56945:before{border-bottom-left-radius:2px}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945.cellRightBorder_bbc56945.cellTopBorder_bbc56945:before{border-top-right-radius:2px}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945.cellRightBorder_bbc56945.cellBottomBorder_bbc56945:before{border-bottom-right-radius:2px}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945:not(.firstCell_bbc56945):hover:not(.cellLeftBorder_bbc56945){border-left-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-left-style:solid;border-left-width:2px}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945:not(.firstCell_bbc56945):hover:not(.cellTopBorder_bbc56945){border-top-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-top-style:solid;border-top-width:2px}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945:not(.firstCell_bbc56945):hover:not(.cellBottomBorder_bbc56945){border-bottom-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-bottom-style:solid;border-bottom-width:2px}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945:not(.firstCell_bbc56945):hover:not(.cellRightBorder_bbc56945){border-right-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-right-style:solid;border-right-width:2px}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945.cellHasCopyBorder_bbc56945.cellBottomBorder_bbc56945:before{border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-style:dashed}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945.cellHasCopyBorder_bbc56945.cellTopBorder_bbc56945:before{border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-top-style:dashed}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945.cellHasCopyBorder_bbc56945.cellLeftBorder_bbc56945:before{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-left-style:dashed}.gridCell_bbc56945.cellHasSelectionBorder_bbc56945.cellHasCopyBorder_bbc56945.cellRightBorder_bbc56945:before{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-right-style:dashed}:not(.tableHasMouseDown_bbc56945) .gridCell_bbc56945:not(.cellHasSelectionBorder_bbc56945):not(.cellHasCopyBorder_bbc56945):not(.firstCell_bbc56945):hover:not(.cellIsSelected_bbc56945){background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridCell_bbc56945:not(.cellHasSelectionBorder_bbc56945):not(.cellHasCopyBorder_bbc56945):not(.firstCell_bbc56945):hover:before{content:'';position:absolute;z-index:10;top:0;left:0;right:0;bottom:0;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;border-width:2px;border-style:solid;border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-radius:2px}.gridCell_bbc56945:not(.cellHasSelectionBorder_bbc56945):not(.cellHasCopyBorder_bbc56945):not(.firstCell_bbc56945):hover:after{content:none}.gridCell_bbc56945:not(.cellHasSelectionBorder_bbc56945):not(.cellHasCopyBorder_bbc56945).cellIsFocusedAndSelected_bbc56945:not(.firstCell_bbc56945){background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.gridCell_bbc56945:not(.cellHasSelectionBorder_bbc56945):not(.cellHasCopyBorder_bbc56945).cellIsFocusedAndSelected_bbc56945:not(.firstCell_bbc56945):after{content:none}.gridCell_bbc56945.lastCell_bbc56945{visibility:hidden}.gridCell_bbc56945.firstCell_bbc56945{padding:8px 0;font-size:0px}.gridCell_bbc56945.firstCell_bbc56945:after{content:none}.gridCell_bbc56945.cellHasError_bbc56945:after{background-color:transparent;margin:0;left:0;width:unset;border-style:solid;border-width:1px;border-color:"},{"theme":"errorText","defaultValue":"#a4262c"},{"rawString":"}.gridCell_bbc56945.imageTypeCell_bbc56945{padding:4px;font-size:0 !important}.gridCell_bbc56945.customFormatterCell_bbc56945{padding:4px;min-height:36px}.gridRow_bbc56945.rowIsSelected_bbc56945{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.gridRow_bbc56945.rowIsSelected_bbc56945 .gridCell_bbc56945:after{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.gridRow_bbc56945.rowIsSelected_bbc56945 .selectionCheckIconsWrapper_bbc56945{visibility:visible}.gridRow_bbc56945.rowIsSelected_bbc56945 .selectionCheckIconsWrapper_bbc56945:before{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.gridRow_bbc56945.rowIsSelected_bbc56945 .selectionCheckIcon_bbc56945,.gridRow_bbc56945.rowIsSelected_bbc56945 .selectionCircleIcon_bbc56945{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridRow_bbc56945.rowIsSelected_bbc56945 .selectionCheckIcon_bbc56945{visibility:visible;font-weight:900}.gridRow_bbc56945.rowIsSelected_bbc56945 .gridCell_bbc56945.firstCell_bbc56945.cellIsFocusedAndSelected_bbc56945{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridRow_bbc56945:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.gridRow_bbc56945:hover .gridCell_bbc56945:not(.cellHasError_bbc56945):after{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.gridRow_bbc56945:hover .gridCell_bbc56945{border-bottom-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.gridRow_bbc56945:hover .selectionCheckIconsWrapper_bbc56945{visibility:visible}.gridRow_bbc56945:hover.rowIsSelected_bbc56945{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.gridRow_bbc56945:hover.rowIsSelected_bbc56945 .gridCell_bbc56945:not(.cellHasError_bbc56945):after{background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.gridRow_bbc56945:not(.rowIsSelected_bbc56945) .cellIsSelected_bbc56945{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.gridRow_bbc56945:not(.rowIsSelected_bbc56945) .cellIsSelected_bbc56945:after{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.gridRow_bbc56945+.gridRow_bbc56945:hover .gridCell_bbc56945:not(.cellHasSelectionBorder_bbc56945):not(.cellHasCopyBorder_bbc56945):before{content:'';position:absolute;top:-2px;left:0;right:0;height:2px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridRow_bbc56945+.gridRow_bbc56945:hover .gridCell_bbc56945:not(.cellHasSelectionBorder_bbc56945):not(.cellHasCopyBorder_bbc56945):not(.firstCell_bbc56945):hover:before{top:0;left:0;right:0;bottom:0;width:100%;height:100%;background-color:transparent;-webkit-box-shadow:0px -2px 0px "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";box-shadow:0px -2px 0px "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.tableHasMouseDown_bbc56945 .gridRow_bbc56945:hover .gridCell_bbc56945.gridCell_bbc56945:not(.cellHasSelectionBorder_bbc56945):not(.cellHasCopyBorder_bbc56945):hover:before{content:none}.gridStickyCheckColumn_bbc56945,.gridStickyCheckColumnHeader_bbc56945{position:-webkit-sticky;position:sticky;will-change:transform;left:0px;z-index:65;background-color:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":"}.gridStickyCheckColumn_bbc56945.gridStickyCheckColumnHeader_bbc56945{z-index:85 !important}.gridStickyDataColumn_bbc56945,.gridStickyDataColumnHeader_bbc56945{position:-webkit-sticky;position:sticky;left:58px;will-change:transform;z-index:65;background-color:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-transition:-webkit-box-shadow 500ms;transition:-webkit-box-shadow 500ms;transition:box-shadow 500ms;transition:box-shadow 500ms, -webkit-box-shadow 500ms}.gridStickyDataColumn_bbc56945.gridStickyDataColumnHeader_bbc56945{z-index:85 !important}\n"},{"rawString":".msGridBaseStyle_f7411be2{font-size:12px;font-family:\"Segoe UI\",\"Segoe UI Web (West European)\",\"Segoe UI\",-apple-system,BlinkMacSystemFont,\"Roboto\",\"Helvetica Neue\",sans-serif}.msGridCell_f7411be2{font-style:normal;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.msGridCellReadonly_f7411be2{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.msGridCellReadonlyFocused_f7411be2{color:"},{"theme":"disabledText","defaultValue":"#a19f9d"},{"rawString":";background-color:"},{"theme":"buttonBackgroundDisabled","defaultValue":"#f3f2f1"},{"rawString":"}.ms-spgrid-col-header-normal{border-bottom-color:"},{"theme":"menuDivider","defaultValue":"#c8c6c4"},{"rawString":"}.ms-spgrid-col-header-part-selected{border-bottom-color:"},{"theme":"themeSecondary","defaultValue":"#2b88d8"},{"rawString":"}.ms-spgrid-col-header-all-selected{border-bottom-color:"},{"theme":"themeSecondary","defaultValue":"#2b88d8"},{"rawString":"}.ms-newdocument-iconouter{display:inline-block;height:16px;width:16px;position:relative;overflow:hidden;text-align:center;top:4px}.ms-newdocument-icon{left:-91px;top:-196px;position:absolute}.ms-inputBox{border:1px solid "},{"theme":"inputBorder","defaultValue":"#8a8886"},{"rawString":";background-color:"},{"theme":"inputBackground","defaultValue":"#ffffff"},{"rawString":";color:"},{"theme":"inputText","defaultValue":"#323130"},{"rawString":"}.ms-inputBoxActive,.ms-inputBox.ms-inputBoxActive:hover{border-color:"},{"theme":"focusBorder","defaultValue":"#605e5c"},{"rawString":"}.ms-dlgOverlay{position:absolute;top:0px;width:100%;height:100%;opacity:0.4;background-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";display:none}[dir='ltr'] .ms-dlgOverlay{left:0px}[dir='rtl'] .ms-dlgOverlay{right:0px}.ms-dlgFrameContainer{padding:0px 19px 10px;overflow:auto}.ms-dlgTitle{padding:13px 19px 15px;white-space:nowrap;cursor:move;overflow:hidden}.ms-dlgFrameContainerNoPadding{padding:0px;overflow:auto}.ms-dlgTitleNoPadding{padding:0px;white-space:nowrap;cursor:move;overflow:hidden}.ms-dlgFrame{width:100%;height:100%;border:none}.ms-dlgContent{border:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";position:absolute;background-color:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-shadow:0px 0px 30px 0px rgba(0,0,0,0.47);box-shadow:0px 0px 30px 0px rgba(0,0,0,0.47)}.ms-dlgContent h1{margin:auto;color:"},{"theme":"bodySubtext","defaultValue":"#605e5c"},{"rawString":";font-weight:200}.ms-dlgContent .ms-accessible,.ms-dlgContent .ms-hidden{position:absolute;top:-2000px;overflow:hidden;height:1px;width:1px;display:block}.ms-dlgContent .ms-accessible-quickedit,.ms-dlgContent .ms-hidden{position:absolute;top:-2000px;overflow:hidden;height:1px;width:1px;display:block}.ms-dlgContentNoBorder{border:0px;position:absolute;background-color:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-shadow:0px 0px 30px 0px rgba(0,0,0,0.47);box-shadow:0px 0px 30px 0px rgba(0,0,0,0.47)}.ms-dlg-heading{font-family:\"Segoe UI Semilight\",\"Segoe UI\",\"Segoe\",Tahoma,Helvetica,Arial,sans-serif;font-size:1.46em;color:#444}.ms-dlgTitleText{float:left;overflow:hidden;text-overflow:ellipsis}.ms-dlgContent>.ms-dlgBorder>.ms-dlgTitle>.ms-dlgCloseBtn>.s4-clust{height:16px !important;width:16px !important}.ms-dlgTitleBtns{margin-top:-10px;height:30px;float:right}[dir='ltr'] .ms-dlgTitleBtns{margin-right:-18px}[dir='rtl'] .ms-dlgTitleBtns{margin-left:-18px}.ms-dlgCloseBtn>span{cursor:pointer;border:1px solid transparent}.ms-dlgErrItem{display:inline}[dir='ltr'] .ms-dlgErrItem{padding-right:10px}[dir='rtl'] .ms-dlgErrItem{padding-left:10px}.ms-dlgLoadingTextDiv{padding:0px 0px 16px;white-space:nowrap}.ms-dlgLoadingText{text-align:left;width:100%}[dir='ltr'] .ms-dlgLoadingText{padding-left:3px}[dir='rtl'] .ms-dlgLoadingText{padding-right:3px}.ms-accentText{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.ms-core-pageTitle{font-family:\"Segoe UI Light\",\"Segoe UI\",\"Segoe\",Tahoma,Helvetica,Arial,sans-serif;font-size:2.77em;white-space:nowrap}.ms-alignCenter{text-align:center}.ms-vb-icon{white-space:nowrap}img.ms-vb-icon-overlay{height:9px;width:9px}.ms-vb-icon-overlay{border:0px;position:relative;bottom:-2px;height:9px;width:9px}[dir='ltr'] .ms-vb-icon-overlay{left:-7px}[dir='rtl'] .ms-vb-icon-overlay{right:-7px}.ms-jsgrid-rowheader-partselected{border-bottom-color:"},{"theme":"inputFocusBorderAlt","defaultValue":"#0078d4"},{"rawString":";border-right-color:#c6c6c6}.jsgrid-control-focuselement:focus{outline:none}\n"},{"rawString":".errorIcon_73a93584{color:"},{"theme":"errorText","defaultValue":"#a4262c"},{"rawString":";font-size:14px}\n"},{"rawString":".topFrameElement_8e925c53{border-top:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:2px 2px 0 0;z-index:25}.topFrameElement_8e925c53.dashedBorder_8e925c53{border-top-style:dashed;border-radius:0}.topFrameElement_8e925c53.dashedBorderUnfocused_8e925c53{border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.bottomFrameElement_8e925c53{border-bottom:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:0 0 2px 2px;z-index:25}.bottomFrameElement_8e925c53.dashedBorder_8e925c53{border-bottom-style:dashed;border-radius:0}.bottomFrameElement_8e925c53.dashedBorderUnfocused_8e925c53{border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.leftFrameElement_8e925c53{border-left:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:2px 0 0 2px;z-index:25}.leftFrameElement_8e925c53.dashedBorder_8e925c53{border-left-style:dashed;border-radius:0}.leftFrameElement_8e925c53.dashedBorderUnfocused_8e925c53{border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.rightFrameElement_8e925c53{border-right:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:0 2px 2px 0;z-index:25}.rightFrameElement_8e925c53.dashedBorder_8e925c53{border-right-style:dashed;border-radius:0}.rightFrameElement_8e925c53.dashedBorderUnfocused_8e925c53{border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.topFrameElement_8e925c53.stickyFrame_8e925c53,.bottomFrameElement_8e925c53.stickyFrame_8e925c53,.leftFrameElement_8e925c53.stickyFrame_8e925c53,.rightFrameElement_8e925c53.stickyFrame_8e925c53{z-index:75}.solidBorder_8e925c53{border-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.copyFrame_8e925c53{z-index:9}.selectionDragHandle_8e925c53{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-radius:2px;border-width:1px;border-style:solid;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";-webkit-box-sizing:border-box;box-sizing:border-box;z-index:26;cursor:crosshair}.selectionDragHandle_8e925c53:after{content:'';position:absolute;width:8px;height:8px;bottom:0}[dir='ltr'] .selectionDragHandle_8e925c53:after{right:0}[dir='rtl'] .selectionDragHandle_8e925c53:after{left:0}[dir='ltr'] .selectionDragHandle_8e925c53.rowSelectionHandle_8e925c53:after{left:0}[dir='rtl'] .selectionDragHandle_8e925c53.rowSelectionHandle_8e925c53:after{right:0}.selectionDragHandle_8e925c53.editorIsActive_8e925c53{display:none}.selectionDragHandle_8e925c53.stickyHandle_8e925c53{z-index:76}.readonlySelectionRect_8e925c53{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";border-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.dragToFillFrame_8e925c53{border:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:2px}\n"},{"rawString":".spGridHeaderIconSpan_369001bf{font-size:16px}.spGridHeaderCoreContent_369001bf{overflow:hidden;text-overflow:none;white-space:nowrap;color:#2E4F69}.gridHeaderCell_369001bf{border-bottom:2px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";background-color:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":"}[dir='ltr'] .gridHeaderCell_369001bf{border-right-width:0px}[dir='rtl'] .gridHeaderCell_369001bf{border-left-width:0px}.gridHeaderCell_369001bf:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";outline-offset:-1px}.gridHeaderCell_369001bf:active{outline:none}.gridHeaderCell_369001bf.columnIsActive_369001bf{border-bottom-color:"},{"theme":"inputFocusBorderAlt","defaultValue":"#0078d4"},{"rawString":"}.resizeContainer_369001bf{-webkit-transition:opacity 0.3s linear 0s;transition:opacity 0.3s linear 0s}.resizeContainer_369001bf:after{content:'';position:absolute;left:8px;top:7px;display:block;width:1px;height:28px;background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.resizeContainer_369001bf:active:after{-webkit-box-shadow:rgba(0,0,0,0.4) 0px 0px 5px 0px;box-shadow:rgba(0,0,0,0.4) 0px 0px 5px 0px}.renameInputContainer_369001bf{height:42px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.renameInputContainer_369001bf input{border:1px solid transparent;border-radius:2px;height:32px;font-size:14px;outline:none}[dir='ltr'] .renameInputContainer_369001bf input{padding-left:12px}[dir='rtl'] .renameInputContainer_369001bf input{padding-right:12px}[dir='ltr'] .renameInputContainer_369001bf input{padding-right:8px}[dir='rtl'] .renameInputContainer_369001bf input{padding-left:8px}.renameInputContainer_369001bf input:focus{border-color:"},{"theme":"inputFocusBorderAlt","defaultValue":"#0078d4"},{"rawString":"}\n"},{"rawString":".folderCover_c8a8cebc{margin:3px}.blankFolderCover_c8a8cebc{background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";display:inline-block}\n"},{"rawString":".root_11a7d214{margin-top:15px;margin-bottom:15px;font-size:17px}[dir='ltr'] .root_11a7d214{margin-left:96px}[dir='rtl'] .root_11a7d214{margin-right:96px}\n"},{"rawString":".ms-ContentTypeManagementPanel{display:-webkit-box;display:-ms-flexbox;display:flex;height:100vh}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel{-webkit-box-flex:1;-ms-flex:1;flex:1;background:#ffffff;padding:0px 10px 10px 10px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel{padding:0px 10px 10px 10px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Title{font-size:20px;font-family:'Segoe UI';margin:40px 0px 0px 0px;text-align:left}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Title{margin:40px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Dropdown{width:100%;margin:24px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Dropdown{margin:24px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-ContentTypes-Container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:70vh;overflow-y:auto;margin:12px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-ContentTypes-Container{margin:12px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes-Label{margin:31px 0px 6px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes-Label{margin:31px 0px 6px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-container,.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container{display:-webkit-box;display:-ms-flexbox;display:flex;padding:10px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-container:hover,.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container:hover{cursor:pointer}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-container-selected,.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container-selected{background:#f3f2f1}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-row-checkbox{-webkit-box-flex:1;-ms-flex:1;flex:1}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-row-text{-webkit-box-flex:100;-ms-flex:100;flex:100}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel{-webkit-box-flex:2;-ms-flex:2;flex:2}html[dir='ltr'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel{margin-left:20px}html[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel{margin-right:20px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Content{margin:97px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Content{margin:97px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-createNewViewToggle{margin:20px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-createNewViewToggle{margin:20px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-container-column{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-container-row{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:1;-ms-flex:1;flex:1;margin:10px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-container-row{margin:10px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-row{-webkit-box-flex:1;-ms-flex:1;flex:1;margin:8px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-row{margin:8px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-addColumnsToCurrentView{margin:25px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-addColumnsToCurrentView{margin:25px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Columns{margin:25px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Columns{margin:25px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable{width:100%;margin-top:8px}[dir='ltr'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable{text-align:left}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable{text-align:right}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content thead{display:table;width:100%;table-layout:fixed}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content tbody{height:calc(100vh - 420px);overflow-y:auto;display:block;overflow-wrap:break-word}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content tbody tr{table-layout:fixed;display:table;width:100%}.ms-ContentTypeManagementPanel-Button{margin:10px 10px 10px 10px}[dir='rtl'] .ms-ContentTypeManagementPanel-Button{margin:10px 10px 10px 10px}.ms-ContentTypeManagementPanel-CancelButton{background-color:#f3f2f1}.ms-ContentTypeManagementPanel-PrimaryPanel-Buttons,.ms-ContentTypeManagementPanel-SecondaryPanel-Buttons{position:absolute;bottom:0}\n"},{"rawString":".ContentCenterCreateModelPanel-bottomMargin{margin-bottom:10px}.ContentCenterCreateModelPanel-dropdown{margin-top:15px}.spinner-topMargin{margin-top:5px}.advancedSettingsContainer{border-color:#edebe9;border-style:solid;border-width:1px 0 1px 0;padding:20px 0 20px 0}.advancedSettingsHeader{display:flex;justify-content:space-between;cursor:pointer}.advancedSettingsHeaderText{display:flex;justify-content:center;align-items:center}.advancedSettingsExpandedMargin{margin-top:10px}.warningMassage{position:absolute;top:0;left:0;z-index:1}.infoIcon{top:4px;left:5px;position:relative;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}"},{"rawString":".SchedulingComponentToggle-topPadding{padding-top:20px;padding-bottom:10px}"},{"rawString":".isFluent .od-TopBar-commandBar .ms-Button--commandBar .ms-Button-menuIcon{background-color:inherit}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot{position:relative;border-bottom:2px solid transparent;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot .ms-Button-label:after{transition:all .1s ease-in-out}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";border-bottom:2px solid transparent}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot:active{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";border-bottom:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled{border-bottom:2px solid transparent}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view:hover,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";border-bottom:2px solid transparent}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view:hover .ms-Button-label:after,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled:hover .ms-Button-label:after{width:100%;left:0}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view .ms-Button-label,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled .ms-Button-label{font-weight:600}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view .ms-Button-label:after,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled .ms-Button-label:after{content:'';display:block;position:absolute;left:8px;border-bottom:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";bottom:-2px;width:calc(100% - (8px + 8px))}.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view,.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled,.od-TopBar-commandBar .ms-CommandBar button.is-pivot:active,.od-TopBar-commandBar .ms-CommandBar button.is-pivot:hover{border-bottom:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view,.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled{font-weight:600}[dir=ltr] .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-last-pivot{margin-right:24px}[dir=rtl] .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-last-pivot{margin-left:24px}.od-TopBar-commandBar .ms-CommandBar button.is-toggled{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":";color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.od-TopBar.od--hasSelection .ms-CommandBar{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";transition:background-color 467ms cubic-bezier(.1,.9,.2,1)}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";transition:none}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";transition:background-color 467ms cubic-bezier(.1,.9,.2,1)}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";background-color:inherit;transition:none}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:hover{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:hover{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-toggled{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-toggled:hover{background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:active{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-expanded:hover{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}"},{"rawString":".ms-siteScriptProgress-accessible{position:absolute;top:-9001px;left:-9001px;height:1px;width:1px}.ms-siteScriptProgress-panel .ms-Panel-navigation{display:none}.ms-siteScriptProgress-panel .ms-Panel-scrollableContent{height:100%}html[dir='ltr'] .ms-siteScriptProgress-schemaArea{padding-right:20px}html[dir='rtl'] .ms-siteScriptProgress-schemaArea{padding-left:20px}.ms-siteScriptProgress-siteDesignLogoImage img{max-width:370px}.ms-siteScriptProgress-workingImage{margin-top:64px;max-height:227px;-webkit-box-flex:1;-ms-flex:1 1;flex:1 1}.ms-siteScriptProgress-darker{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.ms-siteScriptProgress-xButton{width:40px;height:40px}html[dir='ltr'] .ms-siteScriptProgress-xButton{float:right}html[dir='rtl'] .ms-siteScriptProgress-xButton{float:left}.ms-siteScriptProgress-navigation{-webkit-box-flex:0;-ms-flex:0 0 40px;flex:0 0 40px;height:40px;padding-bottom:32px}.ms-siteScriptProgress-siteDesignDescription{padding:10px 0 20px}.ms-siteScriptProgress-explainerTitle{font-weight:600;padding:0 0 10px}.ms-siteScriptProgress-explainerLink{padding:10px 0 0}.ms-siteScriptProgress-runChoiceChecked{background:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.ms-siteScriptProgress-runChoiceChecked .ms-siteScriptProgress-runChoiceArrow{visibility:visible}.ms-ChoiceField:hover .ms-siteScriptProgress-runChoiceRoot{background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.ms-ChoiceField:hover .ms-siteScriptProgress-runChoiceRoot.ms-siteScriptProgress-runChoiceChecked{background:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.ms-ChoiceField:hover .ms-siteScriptProgress-runChoiceRoot .ms-siteScriptProgress-runChoiceArrow{visibility:visible}.ms-siteScriptProgress-runChoiceRoot{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;border-bottom:1px solid "},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":";padding:16px 0;cursor:pointer}.ms-siteScriptProgress-runChoiceRadio{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;visibility:hidden}html[dir='ltr'] .ms-siteScriptProgress-runChoiceRadio{padding-right:5px}html[dir='rtl'] .ms-siteScriptProgress-runChoiceRadio{padding-left:5px}html[dir='ltr'] .ms-siteScriptProgress-runChoiceRadio{padding-left:25px}html[dir='rtl'] .ms-siteScriptProgress-runChoiceRadio{padding-right:25px}.ms-siteScriptProgress-runChoiceText{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}.ms-siteScriptProgress-runChoicePrimaryText{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;font-weight:600;padding:0 0 2px 0}.ms-siteScriptProgress-runChoiceSecondaryText{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}.ms-siteScriptProgress-runChoiceArrow{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;visibility:hidden}html[dir='ltr'] .ms-siteScriptProgress-runChoiceArrow{padding-right:20px}html[dir='rtl'] .ms-siteScriptProgress-runChoiceArrow{padding-left:20px}.ms-siteScriptProgress-columnHeader{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}.ms-siteScriptProgress-columnBody{-webkit-box-flex:1;-ms-flex:1 1 0px;flex:1 1 0;margin:0 0 32px}.ms-siteScriptProgress-scrollable{overflow-y:auto}.ms-siteScriptProgress-columnFooter{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}.ms-siteScriptProgress-leftColumn .ms-siteScriptProgress-columnFooter{padding:0 0 60px}.ms-siteScriptProgress-leftColumn .ms-ChoiceField-wrapper{width:100%}.ms-siteScriptProgress-leftColumn .ms-ChoiceField{margin:0}.ms-siteScriptProgress-columnInternal{width:370px;-webkit-box-flex:1;-ms-flex:1 1;flex:1 1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}[dir='ltr'] .ms-siteScriptProgress-columnInternal{padding-right:40px}[dir='rtl'] .ms-siteScriptProgress-columnInternal{padding-left:40px}.ms-siteScriptProgress-rightColumn .ms-siteScriptProgress-columnFooter{padding:20px 0;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.ms-siteScriptProgress-tenantSiteDesignsLink{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:400}.ms-siteScriptProgress-panelBottomTextBold{font-weight:800}.ms-siteScriptProgress-panelRoot{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%}.ms-siteScriptProgress-column{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:72px 40px 0;-webkit-box-flex:1;-ms-flex:1 1;flex:1 1}.ms-siteScriptProgress-column.ms-siteScriptProgress-rightColumn{padding-top:0px}[dir='ltr'] .ms-siteScriptProgress-column.ms-siteScriptProgress-rightColumn{padding-right:0px}[dir='rtl'] .ms-siteScriptProgress-column.ms-siteScriptProgress-rightColumn{padding-left:0px}.ms-siteScriptProgress-noProgressIndicator{margin:0 0 21px;font-weight:600}.ms-siteScriptProgress-tenantSiteDesignTitle{margin:0 0 10px;font-weight:600}.ms-siteScriptProgress-panel .ms-Panel-contentInner{height:100%}.ms-siteScriptProgress-panel.ms-siteScriptProgress-panel{margin-top:50px}[dir='ltr'] .ms-siteScriptProgress-panel.ms-siteScriptProgress-panel .ms-Panel-main{left:auto}[dir='rtl'] .ms-siteScriptProgress-panel.ms-siteScriptProgress-panel .ms-Panel-main{right:auto}.ms-siteScriptProgress-panel.ms-siteScriptProgress-panel .ms-Panel-content{height:100%;padding:0}.ms-siteScriptProgress-emptyStageContainer{margin:auto}.ms-siteScriptProgress-errorIcon,.ms-siteScriptProgress-errorText{color:"},{"theme":"errorText","defaultValue":"#a4262c"},{"rawString":"}.ms-siteScriptProgress-inProgressSpinner{vertical-align:middle;display:inline-block}[dir='ltr'] .ms-siteScriptProgress-inProgressSpinner{margin-right:8px}[dir='rtl'] .ms-siteScriptProgress-inProgressSpinner{margin-left:8px}.ms-siteScriptProgress-actionIcon{-ms-flex-negative:0;flex-shrink:0}[dir='ltr'] .ms-siteScriptProgress-actionIcon{margin-right:8px}[dir='rtl'] .ms-siteScriptProgress-actionIcon{margin-left:8px}.ms-siteScriptProgress-successIcon{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.ms-siteScriptProgress-gear{position:relative;top:3px}.ms-siteScriptProgress-activeActionTitle{color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":"}.ms-siteScriptProgress-actionIcon,.ms-siteScriptProgress-errorIcon{font-size:16px;line-height:16px}.ms-siteScriptProgress-errorText{font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";font-weight:400;margin-top:4px}[dir='ltr'] .ms-siteScriptProgress-errorText{margin-left:24px}[dir='rtl'] .ms-siteScriptProgress-errorText{margin-right:24px}.ms-siteScriptProgress-actionTitle{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:400;-ms-flex-negative:1;flex-shrink:1;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;min-width:0px;overflow-wrap:break-word;word-wrap:break-word;line-height:16px}[dir='ltr'] .ms-siteScriptProgress-actionTitleNoIcon{margin-left:24px}[dir='rtl'] .ms-siteScriptProgress-actionTitleNoIcon{margin-right:24px}.ms-siteScriptProgress-incompleteIcon{color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.ms-siteScriptProgress-inactiveActionTitle{color:"},{"theme":"disabledText","defaultValue":"#a19f9d"},{"rawString":"}.ms-siteScriptProgress-stageTitle{font-size:"},{"theme":"xSmallFontSize","defaultValue":"10px"},{"rawString":";font-weight:400}[dir='ltr'] .ms-siteScriptProgress-stageTitle{margin-left:24px}[dir='rtl'] .ms-siteScriptProgress-stageTitle{margin-right:24px}.ms-siteScriptProgress-stageTitle{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.ms-siteScriptProgress-siteScriptProgressSubtext,.ms-siteScriptProgress-siteScriptLongRunningText{font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";font-weight:400;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.ms-siteScriptProgress-siteScriptLongRunningText{margin:12px 0 0}.ms-siteScriptProgress-progressIndicatorContainer{margin:12px 0 20px}.ms-siteScriptProgress-progressIndicatorContainer .ms-ProgressIndicator-itemName{font-weight:600;padding:0}.ms-siteScriptProgress-siteDesignChooserTitle{font-weight:600;margin:0 0 8px}.ms-siteScriptProgress-panelTitle{font-size:"},{"theme":"xLargeFontSize","defaultValue":"20px"},{"rawString":";font-weight:100;font-weight:400;margin-bottom:20px}.ms-siteScriptProgress-panelBigTitle.ms-siteScriptProgress-panelTitle{font-size:"},{"theme":"xxLargeFontSize","defaultValue":"28px"},{"rawString":";font-weight:100}.ms-siteScriptProgress-panelSubtitle{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:400;margin-bottom:20px}.ms-siteScriptProgress-titleContainer{margin:32px 0 28px}.ms-siteScriptProgress-actionContainer{margin-bottom:20px}.ms-siteScriptProgress-emptyStageProgressIndicator{margin-bottom:22px}.ms-siteScriptProgress-stageContainer{margin-top:8px}.ms-siteScriptProgress-actionHeader{display:-webkit-box;display:-ms-flexbox;display:flex}\n"},{"rawString":".CreateAIBModelPanel-Spinner{margin-top:5px}.CreateAIBModelPanel-Dropdown{margin-top:15px}.CreateAIBModelPanel-AdvancedSettingsContainer{border-color:#edebe9;border-style:solid;border-width:1px 0 1px 0;padding:20px 0 20px 0}.CreateAIBModelPanel-AdvancedSettingsHeader{display:flex;justify-content:space-between;cursor:pointer}.CreateAIBModelPanel-AdvancedSettingsHeaderText{display:flex;justify-content:center;align-items:center}.CreateAIBModelPanel-AdvancedSettingsExpandedMargin{margin-top:10px}.CreateAIBModelPanel-AssociatedContentTypeLabel{padding-bottom:0}.CreateAIBModelPanel-ViewContainer{margin-top:20px}.CreateAIBModelPanel-TooltipIcon{top:4px;left:5px;position:relative;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}"},{"rawString":".option-container{border-color:#edebe9;border-style:solid;border-width:1px 0 1px 0;padding:20px 0 20px 0}.item-timeStamp{color:#605e5c;font-size:12px}"},{"rawString":".CreateAIBModelPanel-separator{margin-top:5px}.ErrorTextStyle{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}"}]);return {SocialBar_2:{commandLink:'commandLink_9b88b4c7',link:'link_9b88b4c7',pageUsageChartContainer:'pageUsageChartContainer_9b88b4c7',root:'root_9b88b4c7',socialBarList:'socialBarList_9b88b4c7',socialBarPanel:'socialBarPanel_9b88b4c7',socialBarPanelContent:'socialBarPanelContent_9b88b4c7',spSocialPanelPivotContent:'spSocialPanelPivotContent_9b88b4c7',socialBarPanelHeader:'socialBarPanelHeader_9b88b4c7',socialBarPanelHeaderText:'socialBarPanelHeaderText_9b88b4c7',socialBarPanelPersona:'socialBarPanelPersona_9b88b4c7',socialBarPanelPersonaDescription:'socialBarPanelPersonaDescription_9b88b4c7',viewsIcon:'viewsIcon_9b88b4c7',analyticsStatsLink:'analyticsStatsLink_9b88b4c7'},SyncDialog_6:{syncDialog:'syncDialog_5fe6e913',syncDialogContent:'syncDialogContent_5fe6e913',syncImg:'syncImg_5fe6e913',copyLibraryId:'copyLibraryId_5fe6e913',pointerText:'pointerText_5fe6e913',footNote:'footNote_5fe6e913',syncTitle:'syncTitle_5fe6e913',contentContainer:'contentContainer_5fe6e913',adminContentContainer:'adminContentContainer_5fe6e913',separator:'separator_5fe6e913'},SPGrid_6:{spGridTableHead:'spGridTableHead_2950b163',spGridPagingFooter:'spGridPagingFooter_2950b163',spGridCustomFormatField:'spGridCustomFormatField_2950b163',wrapperTable:'wrapperTable_2950b163',wrapperTd:'wrapperTd_2950b163',spGridRoot:'spGridRoot_2950b163',spGridErrorIcon:'spGridErrorIcon_2950b163',dropHintStyle:'dropHintStyle_2950b163',containerRefreshed:'containerRefreshed_2950b163',dropHintCaretStyle:'dropHintCaretStyle_2950b163',caretRefreshed:'caretRefreshed_2950b163',dropHintLineStyle:'dropHintLineStyle_2950b163',lineRefreshed:'lineRefreshed_2950b163',listLink:'listLink_2950b163',isTitleOrNameFieldVisualRefresh:'isTitleOrNameFieldVisualRefresh_2950b163',isTitleOrNameField:'isTitleOrNameField_2950b163',cellHiddenOverflow:'cellHiddenOverflow_2950b163',cellBreakWordOverflow:'cellBreakWordOverflow_2950b163',customFormatField:'customFormatField_2950b163',msGridWidgetDock:'msGridWidgetDock_2950b163',stickyEditor:'stickyEditor_2950b163',msGridWidgetDockHover:'msGridWidgetDockHover_2950b163',msGridWidgetDockPressed:'msGridWidgetDockPressed_2950b163',msGridWidgetCell:'msGridWidgetCell_2950b163',msGridCellSelectedEditable:'msGridCellSelectedEditable_2950b163',spGridErrorNotification:'spGridErrorNotification_2950b163',msGrid:'msGrid_2950b163',msGridLink:'msGridLink_2950b163',msGridSelection:'msGridSelection_2950b163',msGridSelectionReadonly:'msGridSelectionReadonly_2950b163',msGridEdit:'msGridEdit_2950b163',msGridTimescale:'msGridTimescale_2950b163',msGridColHeaderNormal:'msGridColHeaderNormal_2950b163',msGridColHeaderElemBgColorsNormal:'msGridColHeaderElemBgColorsNormal_2950b163',msGridColHeaderElemHoverBgColorsNormal:'msGridColHeaderElemHoverBgColorsNormal_2950b163',msGridColElemColorsClickNormal:'msGridColElemColorsClickNormal_2950b163',msGridColHeaderNormalHover:'msGridColHeaderNormalHover_2950b163',msGridColHeaderElemBgColorsNormalHover:'msGridColHeaderElemBgColorsNormalHover_2950b163',msGridColHeaderElemHoverBgColorsNormalHover:'msGridColHeaderElemHoverBgColorsNormalHover_2950b163',msGridColElemColorsClickNormalHover:'msGridColElemColorsClickNormalHover_2950b163',msGridColHeaderPartSelected:'msGridColHeaderPartSelected_2950b163',msGridColHeaderElemBgColorsPartSelected:'msGridColHeaderElemBgColorsPartSelected_2950b163',msGridColHeaderElemHoverBgColorsPartSelected:'msGridColHeaderElemHoverBgColorsPartSelected_2950b163',msGridColElemColorsClickPartSelected:'msGridColElemColorsClickPartSelected_2950b163',msGridColHeaderPartSelectedHover:'msGridColHeaderPartSelectedHover_2950b163',msGridColHeaderElemBgColorsPartSelectedHover:'msGridColHeaderElemBgColorsPartSelectedHover_2950b163',msGridColHeaderElemHoverBgColorsPartSelectedHover:'msGridColHeaderElemHoverBgColorsPartSelectedHover_2950b163',msGridColElemColorsClickPartSelectedHover:'msGridColElemColorsClickPartSelectedHover_2950b163',msGridColHeaderAllSelected:'msGridColHeaderAllSelected_2950b163',msGridColHeaderElemBgColorsAllSelected:'msGridColHeaderElemBgColorsAllSelected_2950b163',msGridColHeaderElemHoverBgColorsAllSelected:'msGridColHeaderElemHoverBgColorsAllSelected_2950b163',msGridColElemColorsClickAllSelected:'msGridColElemColorsClickAllSelected_2950b163',msGridColHeaderAllSelectedHover:'msGridColHeaderAllSelectedHover_2950b163',msGridColHeaderElemBgColorsAllSelectedHover:'msGridColHeaderElemBgColorsAllSelectedHover_2950b163',msGridColHeaderElemHoverBgColorsAllSelectedHover:'msGridColHeaderElemHoverBgColorsAllSelectedHover_2950b163',msGridColElemColorsClickAllSelectedHover:'msGridColElemColorsClickAllSelectedHover_2950b163',msGridRowHeaderNormal:'msGridRowHeaderNormal_2950b163',msGridRowHeaderNormalHover:'msGridRowHeaderNormalHover_2950b163',msGridRowHeaderPartSelected:'msGridRowHeaderPartSelected_2950b163',msGridRowHeaderPartSelectedHover:'msGridRowHeaderPartSelectedHover_2950b163',msGridRowHeaderAllSelected:'msGridRowHeaderAllSelected_2950b163',msGridRowHeaderAllSelectedHover:'msGridRowHeaderAllSelectedHover_2950b163',msGridSplitter:'msGridSplitter_2950b163',msGridSplitterHandle:'msGridSplitterHandle_2950b163',msGridSplitterHover:'msGridSplitterHover_2950b163',msGridSplitterHandleHover:'msGridSplitterHandleHover_2950b163',msGridSplitterDrag:'msGridSplitterDrag_2950b163',msGridSplitterHandleDrag:'msGridSplitterHandleDrag_2950b163',spGridControlFocusElement:'spGridControlFocusElement_2950b163',spGridControlEditbox:'spGridControlEditbox_2950b163',inputIsNumber:'inputIsNumber_2950b163',inputIsTitle:'inputIsTitle_2950b163',spGridControlEditboxDynamicHeight:'spGridControlEditboxDynamicHeight_2950b163',jsgridControlMultilineTextarea:'jsgridControlMultilineTextarea_2950b163',jsgridControlRteContainer:'jsgridControlRteContainer_2950b163',msRteStateField:'msRteStateField_2950b163'},tablemgr_9:{spGridSelectAllIconContainer:'spGridSelectAllIconContainer_bbc56945',spGridSelectAllIcon:'spGridSelectAllIcon_bbc56945',spGridCell:'spGridCell_bbc56945',tableColumnHeadersRow:'tableColumnHeadersRow_bbc56945',gridSelectAllIconContainer:'gridSelectAllIconContainer_bbc56945',selectAllCheckMarkCell:'selectAllCheckMarkCell_bbc56945',selectionCheckIconsWrapper:'selectionCheckIconsWrapper_bbc56945',allRowsSelected:'allRowsSelected_bbc56945',selectionCheckIcon:'selectionCheckIcon_bbc56945',selectionCircleIcon:'selectionCircleIcon_bbc56945',headerStateContainer:'headerStateContainer_bbc56945',hasStateElements:'hasStateElements_bbc56945',headerStateBar:'headerStateBar_bbc56945',selectionCheckMark:'selectionCheckMark_bbc56945',inlineNewItemAddIconContainer:'inlineNewItemAddIconContainer_bbc56945',stickyEditor:'stickyEditor_bbc56945',selectedEditor:'selectedEditor_bbc56945',inlineNewItemAddIcon:'inlineNewItemAddIcon_bbc56945',inlineNewItemPlaceHolder:'inlineNewItemPlaceHolder_bbc56945',rowIsActive:'rowIsActive_bbc56945',inLineNewItemRow:'inLineNewItemRow_bbc56945',gridCell:'gridCell_bbc56945',cellIsFocusedAndSelected:'cellIsFocusedAndSelected_bbc56945',cellHasCopyBorder:'cellHasCopyBorder_bbc56945',cellIsSticky:'cellIsSticky_bbc56945',cellLeftBorder:'cellLeftBorder_bbc56945',cellRightBorder:'cellRightBorder_bbc56945',cellTopBorder:'cellTopBorder_bbc56945',cellBottomBorder:'cellBottomBorder_bbc56945',firstCell:'firstCell_bbc56945',cellHasSelectionBorder:'cellHasSelectionBorder_bbc56945',readOnlySelectionFrame:'readOnlySelectionFrame_bbc56945',tableHasMouseDown:'tableHasMouseDown_bbc56945',cellIsSelected:'cellIsSelected_bbc56945',lastCell:'lastCell_bbc56945',cellHasError:'cellHasError_bbc56945',imageTypeCell:'imageTypeCell_bbc56945',customFormatterCell:'customFormatterCell_bbc56945',gridRow:'gridRow_bbc56945',rowIsSelected:'rowIsSelected_bbc56945',gridStickyCheckColumn:'gridStickyCheckColumn_bbc56945',gridStickyCheckColumnHeader:'gridStickyCheckColumnHeader_bbc56945',gridStickyDataColumn:'gridStickyDataColumn_bbc56945',gridStickyDataColumnHeader:'gridStickyDataColumnHeader_bbc56945'},PeopleEditor_7:{peopleEditor:'peopleEditor_f6f00c2d',increaseZIndex:'increaseZIndex_f6f00c2d',stickyEditor:'stickyEditor_f6f00c2d'},PersonDisplay_7:{personDisplayPill:'personDisplayPill_16752b23',personDisplayCoin:'personDisplayCoin_16752b23',personDisplayName:'personDisplayName_16752b23'},ChoicePill_6:{pill:'pill_33412976',pillNoHoverStyle:'pillNoHoverStyle_33412976',wellInput:'wellInput_33412976',fontIcon:'fontIcon_33412976'},CommonEditorCallout_4:{calloutButtonsContainer:'calloutButtonsContainer_74e34ef3'},LocationEditor_1:{locationEditor:'locationEditor_39f90a79',stickyEditor:'stickyEditor_39f90a79'},TaxonomyEditor_2:{taxonomyEditorSpan:'taxonomyEditorSpan_362d1c5d',increaseZIndex:'increaseZIndex_362d1c5d',stickyEditor:'stickyEditor_362d1c5d'},styles_9:{msGridBaseStyle:'msGridBaseStyle_f7411be2',msGridCell:'msGridCell_f7411be2',msGridCellReadonly:'msGridCellReadonly_f7411be2',msGridCellReadonlyFocused:'msGridCellReadonlyFocused_f7411be2'},RowHeaderState_3:{errorIcon:'errorIcon_73a93584'},panemgr_9:{topFrameElement:'topFrameElement_8e925c53',dashedBorder:'dashedBorder_8e925c53',dashedBorderUnfocused:'dashedBorderUnfocused_8e925c53',bottomFrameElement:'bottomFrameElement_8e925c53',leftFrameElement:'leftFrameElement_8e925c53',rightFrameElement:'rightFrameElement_8e925c53',stickyFrame:'stickyFrame_8e925c53',solidBorder:'solidBorder_8e925c53',copyFrame:'copyFrame_8e925c53',selectionDragHandle:'selectionDragHandle_8e925c53',rowSelectionHandle:'rowSelectionHandle_8e925c53',editorIsActive:'editorIsActive_8e925c53',stickyHandle:'stickyHandle_8e925c53',readonlySelectionRect:'readonlySelectionRect_8e925c53',dragToFillFrame:'dragToFillFrame_8e925c53'},headermgr_6:{spGridHeaderIconSpan:'spGridHeaderIconSpan_369001bf',spGridHeaderCoreContent:'spGridHeaderCoreContent_369001bf',gridHeaderCell:'gridHeaderCell_369001bf',columnIsActive:'columnIsActive_369001bf',resizeContainer:'resizeContainer_369001bf',renameInputContainer:'renameInputContainer_369001bf'},PinnedItemsCardRenderer_0:{folderCover:'folderCover_c8a8cebc',blankFolderCover:'blankFolderCover_c8a8cebc'},RecentGroupItemDetailsHeader_9:{root:'root_11a7d214'}}});