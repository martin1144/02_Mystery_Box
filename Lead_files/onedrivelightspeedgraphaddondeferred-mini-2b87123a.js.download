define("QN",["require","exports","mU","iX","wx","c0","er","e3","Sl","td","l1","vg","Si","Sg","R9","Q8","tm","Q6","Q5","Q3","c2","pk","wO","e6","Q0","wy","QZ","ua","QW","hi","QV","QU","nQ","QS","vf","QR","av","QQ","QO","iW"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var q=A.asModuleWithRetries(function(){return new Promise(function(t,n){e(["Sn"],t,n)})},{chunkName:"graphaddondeferred"});t.graphAddon=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,A;return n.__generator(this,function(n){switch(n.label){case 0:e(B.asBatch(function(){e(v.graphAddonDataOnly);e(u.registerControlHandler(C.driveItemSetKeyFacet,c.itemSetColumnsControl)(O.driveItemSetColumnsControlHandler));e(u.registerControlHandler(C.driveItemSetKeyFacet,_.sortedItemSetControl)(D.driveItemSortedItemSetControlHandler));e(u.registerControlHandler(i.savedForLaterItemSetKeyFacet,f.itemSetDetailsListControl)(h.savedForLaterRootItemSetDetailsListControlHandler));e(u.registerControlHandler(i.savedForLaterItemSetKeyFacet,l.itemSetTilesListControl)(p.savedForLaterRootItemSetTilesListControlHandler));e(u.registerControlHandler(i.savedForLaterItemSetKeyFacet,c.itemSetColumnsControl)(a.savedForLaterRootItemSetColumnsControlHandler));e(u.registerControlHandler(i.savedForLaterItemSetKeyFacet,m.emptyFolderControl)(g.emptyFolderControlHandler));e(u.registerControlHandler(N.recentItemSetKeyFacet,c.itemSetColumnsControl)(T.recentItemSetColumnsControlHandler));e(u.registerControlHandler(s.sharedWithMeItemSetKeyFacet,c.itemSetColumnsControl)(d.sharedWithMeRootItemSetColumnsControlHandler));e(u.registerControlHandler(w.driveItemKeyFacet,E.itemHoverCardControl)(y.driveItemHoverCardControlHandler));e(u.registerControlHandler(C.driveItemSetKeyFacet,k.itemSetPagingControl)(L.driveItemSetPagingControlHandler));e(u.registerControlHandler(w.driveItemKeyFacet,P.moveCopyActionControl)(H.driveItemMoveCopyActionControlHandler));e(r.registerOperationHandler(j.thumbnailTokenKeyFacet,I.getItemsOperation)(F.thumbnailUrlTokenOperationHandler));e(u.registerControlHandler(w.driveItemKeyFacet,S.itemThumbnailControl)(b.driveItemThumbnailControlHandler));e(M.graphItemActivityAddon)}));return[4,e(o.waitForPageLoad({waitIndefinitely:!0}))];case 1:n.sent();n.label=2;case 2:n.trys.push([2,4,,5]);return[4,q()];case 3:if(!(t=n.sent().graphAddonDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:A=n.sent();e(x.handleError({error:A}));return[3,5];case 5:return[2]}})})}})});
define("Sl",["require","exports","e3","Q2","D4","Sm","vG"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return a}});var u=[r.fileTypeIconColumn,i.nameAndPathColumn,s.dateFollowedColumn,o.itemActivityColumn];function a(e,t){return{columns:u}}});
define("Q2",["require","exports","mU","pB","eO"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileTypeIconColumn=n.__assign(n.__assign({},r.fileTypeIconColumn),{key:i.FILE_TYPE_ICON_COLUMN_KEY,minWidth:32,maxWidth:32})});
define("Sm",["require","exports","nV","gx","H","yR","bv","iV","gd"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateFollowedColumn=n.createColumn({key:new i.Facet("dateFollowedColumn").id,name:r.default.SavedDate,fieldName:"",minWidth:n.ColumnWidth.regularMin,maxWidth:n.ColumnWidth.regularMax,isCollapsable:!0},s.DateField)(function(e,t){var n=e.demandItemFacet(o.dateFollowedFacet,t),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(u.localeFacet,u.configurationItemKey),s=i&&i.language||window.navigator.language;return s?{text:a.getRelativeDateTimeStringPast(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(o.dateFollowedFacet,t)})});
define("Si",["require","exports","mU","f","Sj","pE","e3","cO","pq","Sh"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemSetDetailsListControlHandler=o.createControlHandler()(function(){return function(e){return c}});var l=function(e){var t=e.defaultRender,i=n.__assign({},a.itemLifeCycleSignalsControl.pack(f.itemLifeCycleSignalsControlHandler));return t?r.createElement(u.ControlHandlerProvider,{controlHandlers:i},r.createElement(t,n.__assign({},e))):null};function c(){return{groupHeaderRenderer:i.GroupItemDetailsHeader,rowRenderer:l,groupProps:{collapseAllVisibility:s.CollapseAllVisibility.hidden}}}});
define("Sj",["require","exports","mU","f","OneDriveLightspeedGraphAddonDeferred_mini_css"],function(e,t,n,r,i){"use strict";i=i.GroupItemDetailsHeader_0;Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?r.createElement("div",{className:i.root},this.props.group.name):null};return t})(r.PureComponent);t.GroupItemDetailsHeader=s});
define("Sh",["require","exports","mU","q6","po"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemLifeCycleSignalsControlHandler=function(e,t){var s=t.signals;if(s){var o=r.findMatch(s,function(e){return e.key===i.followedSignalKey});if(o&&o.index>-1){var u=o.index;return{signals:n.__spreadArrays(s.slice(0,u),s.slice(u+1))}}}return{}}});
define("Sg",["require","exports","mU","f","cO","Sh","pq","e3","l0","bv","iV","gd","yR"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemSetTilesListControlHandler=u.createControlHandler()(function(){return function(e){return v}});function p(e,t){var n=t.itemKey,i=e.demandItemFacet(f.dateFollowedFacet,n,{suppressGetItems:!0}),s=i&&new Date(i).getTime();if("number"==typeof s&&!isNaN(s)){var o=e.demandItemFacet(l.localeFacet,l.configurationItemKey),u=o&&o.language||window.navigator.language,a=c.getRelativeDateTimeStringPast(new Date(s),u);return{itemActivity:a&&r.createElement(h.DateField,{text:a})||null}}return{}}var d=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,u=n.__rest(e,["defaultRender"]),f=n.__assign(n.__assign({},o.itemLifeCycleSignalsControl.pack(s.itemLifeCycleSignalsControlHandler)),a.itemTileControl.pack(p));return t?r.createElement(i.ControlHandlerProvider,{controlHandlers:f},r.createElement(t,n.__assign({},u))):null};return t})(r.PureComponent);function v(){return{tileRenderer:d}}});
define("R9",["require","exports","e3","Q2","D4","Sf","Sa"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeRootItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return a}});var u=[r.fileTypeIconColumn,i.nameAndPathColumn,s.dateSharedColumn,o.sharedByColumn];function a(e,t){return{columns:u}}});
define("Sf",["require","exports","f8","vH","nV","Rn","yR","iV","eO"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateSharedColumn=i.createColumn({name:r.default.dateSharedColumnHeaderText,key:a.DATE_SHARED_COLUMN_KEY,fieldName:"",minWidth:i.ColumnWidth.regularMin,maxWidth:i.ColumnWidth.regularMax,isCollapsable:!0,sortProps:i.DATE_COLUMN_SORT_PROPS},o.DateField)(function(e,t){var r=e.demandItemFacet(s.sharedFacet,t),i=r&&new Date(r.sharedDateTime).getTime();if("number"!=typeof i||isNaN(i))return{text:""};var o=e.demandItemFacet(u.localeFacet,u.configurationItemKey);return o&&o.language||window.navigator.language?{text:n.getRelativeDateTimeStringPast(new Date(i),!1)}:{dateValue:i}})});
define("Rn",["require","exports","H"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedFacet=new n.Facet("shared")});
define("Sa",["require","exports","vH","nV","yM","eO","gs","Rh","Rg","Se","f","Sc","OneDriveLightspeedGraphAddonDeferred_mini_css","cu"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";h=h.TopCollaborator_8;Object.defineProperty(t,"__esModule",{value:!0});t.sharedByColumn=r.createColumn({name:n.default.sharedByColumnHeaderText,key:s.SHARED_BY_COLUMN_KEY,fieldName:"",minWidth:r.ColumnWidth.regularMin,maxWidth:r.ColumnWidth.regularMax,isCollapsable:!0,sortProps:r.TEXT_COLUMN_SORT_PROPS},i.UserFieldRenderer)(function(e,t){var n=e.demandItem({shareByPerson:u.sharedByPersonFacet},t).shareByPerson,r=n&&n.itemKey,i=!1;if(r&&a.userByEmailKeyFacet.matches(r)){var s=a.userByEmailKeyFacet.deserialize(r).email,d=e.demandItemFacet(p.childItemsFacet,f.topCollaboratorSetKeyFacet.serialize({endpoint:"https://graph.microsoft.com/beta"}));d&&(i=d.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(o.emailFacet,t);return!!n&&n===s}))}return r?{people:[{itemKey:r}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),r=e.user;return l.createElement("div",{className:h.userWithTopCollaborator},l.createElement(c.TopCollaborator,{userName:r.title,isPlaceholder:!i}),n)}}:{people:[]}},function(e,t){return""+e.demandItemFacet(o.emailFacet,t)})});
define("Rh",["require","exports","H"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByPersonFacet=new n.Facet("sharedBy")});
define("Rg",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.userByEmailKeyFacet=new n.KeyFacet("userByEmail",{email:n.stringPart(),endpoint:n.stringPart()})});
define("Se",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.topCollaboratorSetKeyFacet=new n.KeyFacet("topCollaboratorSetKeyFacet",{endpoint:n.stringPart()})});
define("Sc",["require","exports","mU","f","k9","ji","dh","sx","Sd","OneDriveLightspeedGraphAddonDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";f=f.TopCollaborator_8;Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,i=r.createElement(s.Icon,{className:f.topCollaboratorIcon,iconName:"TeamFavorite"}),l=r.createElement("span",{className:f.topCollaboratorUserName},t),c=r.createElement("div",{className:f.topCollaboratorTooltip},o.formatToArray(a.default.topCollaboratorWith,l));return r.createElement("div",{className:f.topCollaPlaceHolder},n?null:t?r.createElement(u.TooltipHost,{content:c},i):i)};return t})(i.BaseComponent);t.TopCollaborator=l});
define("Q8",["require","exports","mU","iX","cu","bv","R8","iW","R7","R3","R2","R1","R0","RS","RR","RQ","RP","RO","RL","RK","RJ","RI","RF","c2","gz","RD","RC","c3","c0","RB","RA","em","wy","Rz","en","wx","Ry","el","gy","Rx","Rw","hs","e3","Rv","er","gR","Ru","lw","Rt","Rs","e6","Rr","Rq","hQ","QY","Q9","hi","av"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var ie=ne.asModuleWithRetries(function(){return new Promise(function(t,n){e(["SE"],t,n)})},{chunkName:"graphaddondeferred"});t.graphAddonDataOnly=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,ne;return n.__generator(this,function(n){switch(n.label){case 0:e(re.asBatch(function(){e(u.supportFacets({keyFacet:x.driveItemKeyFacet,facets:[x.driveItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,s.canonicalUrlFacet,s.eTagFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:C.driveItemPageKeyFacet,facets:[C.driveItemPageKeyFacet,i.childItemsFacet,i.pageFacet]}));e(u.supportFacets({keyFacet:k.sharedWithMeRootItemKeyFacet,facets:[k.sharedWithMeRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.canonicalUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:L.sharedWithMeItemSetKeyFacet,facets:[L.sharedWithMeItemSetKeyFacet,i.childItemsFacet]}));e(u.supportFacets({keyFacet:A.sharedByMeRootItemKeyFacet,facets:[A.sharedByMeRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.canonicalUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:O.sharedByMeItemSetKeyFacet,facets:[O.sharedByMeItemSetKeyFacet,i.childItemsFacet]}));e(u.supportFacets({keyFacet:M.recentRootItemKeyFacet,facets:[M.recentRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:_.recentItemSetKeyFacet,facets:[_.recentItemSetKeyFacet,i.childItemsFacet]}));e(u.supportFacets({keyFacet:P.savedForLaterRootItemKeyFacet,facets:[P.savedForLaterRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet]}));e(u.supportFacets({keyFacet:K.commandsItemKeyFacet,facets:[z.addToOneDriveFacet,z.createFolderFacet,z.createLinkFacet,z.deleteFacet,z.downloadFacet,z.inviteFacet,z.moveFacet,z.officeLensFacet,z.renameFacet,z.uploadFacet]}));e(N.graphAddonDriveItemSet);e(r.registerOperationHandler(x.driveItemKeyFacet,u.getItemsOperation)(a.driveItemGetItemsOperationHandler));e(r.registerOperationHandler(ee.driveItemVirtualizedPageKeyFacet,u.getItemsOperation)(te.driveItemVirtualizedPageGetItemsOperationHandler));e(r.registerOperationHandler(T.driveAnalyticsItemKeyFacet,u.getItemsOperation)(f.driveAnalyticsItemGetItemsOperationHandler));e(r.registerOperationHandler(D.specialDriveItemKeyFacet,u.getItemsOperation)(l.specialDriveItemGetItemsOperationHandler));e(r.registerOperationHandler(G.sharesItemKeyFacet,u.getItemsOperation)(Y.sharesItemGetItemsOperationHandler));e(r.registerOperationHandler(C.driveItemPageKeyFacet,u.getItemsOperation)(c.driveItemPageGetItemsOperationHandler));e(r.registerOperationHandler(k.sharedWithMeRootItemKeyFacet,u.getItemsOperation)(h.sharedWithMeRootItemGetItemsOperationHandler));e(r.registerOperationHandler(L.sharedWithMeItemSetKeyFacet,u.getItemsOperation)(p.sharedWithMeItemSetGetItemsOperationHandler));e(r.registerOperationHandler(A.sharedByMeRootItemKeyFacet,u.getItemsOperation)(d.sharedByMeRootItemGetItemsOperationHandler));e(r.registerOperationHandler(O.sharedByMeItemSetKeyFacet,u.getItemsOperation)(v.sharedByMeItemSetGetItemsOperationHandler));e(r.registerOperationHandler(M.recentRootItemKeyFacet,u.getItemsOperation)(m.recentRootItemGetItemsOperationHandler));e(r.registerOperationHandler(P.savedForLaterRootItemKeyFacet,u.getItemsOperation)(g.savedForLaterRootItemGetItemsOperationHandler));e(r.registerOperationHandler(_.recentItemSetKeyFacet,u.getItemsOperation)(y.recentItemSetGetItemsOperationHandler));e(r.registerOperationHandler(H.savedForLaterItemSetKeyFacet,u.getItemsOperation)(b.savedForLaterItemSetGetItemsOperationHandler));e(r.registerOperationHandler(B.searchItemSetKeyFacet,u.getItemsOperation)(S.searchItemSetGetItemsOperationHandler));e(u.supportFacets({keyFacet:j.driveFollowedItemKeyFacet,facets:[s.isFollowedFacet]}));e(r.registerOperationHandler(j.driveFollowedItemKeyFacet,u.getItemsOperation)(E.driveFollowItemGetItemsOperationHandler));e(r.registerOperationHandler(F.driveActivityItemKeyFacet,u.getItemsOperation)(w.driveActivityItemGetItemsOperationHandler));e(r.registerOperationHandler(K.commandsItemKeyFacet,u.getItemsOperation)(I.commandsGetItemsOperationHandler));e(U.registerControlHandler(x.driveItemKeyFacet,R.openActionControl)(q.openActionControlHandler));e(U.registerControlHandler(_.recentItemSetKeyFacet,X.filteredItemSetControl)(V.recentRootItemSetFilteredItemSetControlHandler));e(U.registerControlHandler(_.recentItemSetKeyFacet,$.itemsViewControl)(J.itemsViewControlHandler));e(Z.graphFileHandlerAddon)}));return[4,e(W.waitForPageLoad({waitIndefinitely:!0}))];case 1:n.sent();n.label=2;case 2:n.trys.push([2,4,,5]);return[4,ie()];case 3:if(!(t=n.sent().graphAddonDataOnlyDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:ne=n.sent();e(Q.handleError({error:ne}));return[3,5];case 5:return[2]}})})}})});
define("R8",["require","exports","H"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mimeTypeFacet=new n.Facet("mimeType");t.systemFilePathFacet=new n.Facet("systemFilePath")});
define("R7",["require","exports","mU","iX","c2","DE","DE","Rd","ce"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,f=i.driveItemKeyFacet.deserialize(r),l=f.endpoint;return function(c){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d,v,m;return n.__generator(this,function(g){switch(g.label){case 0:return[4,c(o.getRawDataWithCache({url:s.getDriveItemUrl(f),qosName:"getItem",endpoint:l}))];case 1:t=g.sent();h=u.processLocalOrRemoteDriveItem({driveItemResponse:t,endpoint:l}),p=h.itemResolver,d=h.actualItemKey;p.resolveItems({items:(v={},v[e.itemKey]=n.__assign({},a.resolvedAsKeyFacetFacet.pack(i.driveItemKeyFacet)),v)});p.mapKeys({mappings:(m={},m[d]=r,m)});c(p.execute());return[2]}})})}})});
define("Rd",["require","exports","mU","Rj","c2","Rf","QX","Re","gH","bv"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processLocalOrRemoteDriveItem=function(e){var t,l,c,h,p=e.driveItemResponse,d=e.endpoint,v=p.remoteItem,m=v&&v.parentReference,g=p.parentReference,y=g||m,b=y&&y.driveId,w=y&&y.id,E="personal"===(y&&y.driveType),S=!!p.root;if(v){h=v.id;m&&(b=m.driveId)}else h=E&&p.root?o.ROOT_ITEM_ID:p.id;var x={endpoint:d,driveId:b,itemId:h},T=i.driveItemKeyFacet.serialize(x),N=p&&(p.webDavUrl||p.webUrl),C=E&&y&&y.path===o.CONSUMER_ROOT_ITEM_PATH?o.ROOT_ITEM_ID:w||void 0,k=y&&C?i.driveItemKeyFacet.serialize({endpoint:d,driveId:y.driveId||b,itemId:C}):void 0,L=[],A="";if(N){var O=new a.SimpleUri(N);L.push.apply(L,O.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)}));L.unshift(O.authority);A=L.join("/")}y&&!S&&!C&&A&&(k=u.driveItemByCanonicalUrlKeyFacet.serialize({endpoint:d,driveId:y.driveId,canonicalUrl:A}));var M=s.processDriveItem(n.__assign(n.__assign({},e),{itemKey:T,driveItemKey:x,parentFolderItemKey:k})).itemResolver;M.resolveItems({items:n.__assign({},k&&(t={},t[k]=n.__assign({},A?f.openUrlFacet.pack(A):{}),t))});if(v&&m){var _=i.driveItemKeyFacet.serialize({endpoint:d,driveId:g&&g.driveId,itemId:p.id}),D=i.driveItemKeyFacet.serialize({endpoint:d,driveId:m.driveId,itemId:v.id});M.mapKeys({mappings:(l={},l[_]=D,l)});M.resolveItems({items:(c={},c[D]=n.__assign({},r.getDriveItemFacets({driveItem:p,endpoint:d})),c)})}return{itemResolver:M,actualDriveItemKey:x,actualItemKey:T}}});
define("Rj",["require","exports","mU","gu","bv","cu","c2","QZ","Q4","Ro","gz","Rn","jc","gt","gv","QT","Rm","R8","Rl","Rk","DL","QQ","Q3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDriveItemFacets=function(e){var t,N=e.driveItemKey,C=e.driveItem,k=e.endpoint,L=e.parentFolderItemKey,A=e.shouldReturnShareFacets,O=void 0===A||A,M=C.file,_=C.fileSystemInfo,D=C.name,P=C.parentReference,H=C.remoteItem,B=C.root,j=C.size,F=C.thumbnails,I=C.image,q=C.video,R=C.eTag,U=C.lastModifiedDateTime,z=void 0===U?_&&_.lastModifiedDateTime||H&&H.lastModifiedDateTime:U,W=P&&P.driveId,X=P&&P.driveType,V="personal"===X,$=_&&_.lastAccessedDateTime||H&&H.fileSystemInfo&&H.fileSystemInfo.lastAccessedDateTime,J=C.package||H&&H.package,K=F||H&&H.thumbnails,Q=I||H&&H.image,G=q||H&&H.video,Y=C.shared||H&&H.shared,Z={itemId:C.id,driveId:W,endpoint:k},ee=_&&_.systemPath,te=N||H&&H.parentReference&&{itemId:H.id,driveId:H.parentReference.driveId,endpoint:k}||Z,ne=N||H&&H.parentReference&&{driveId:H.parentReference.driveId,endpoint:k},re=C.webDavUrl||H&&H.webDavUrl;t="business"!==X&&"documentLibrary"!==X&&"personal"!==X||!B?D||H&&H.name||"":h.default.files;var ie=C.folder||H&&H.folder,se=j||H&&H.size,oe=ie&&ie.childCount,ue=T(t,!!ie),ae=ue.extension&&b.getOfficeAppFromExtension(ue.extension),fe=C.sharepointIds||H&&H.sharepointIds,le=K&&S.isArray(K)?K.length>0&&K[0]:K,ce=!ie&&(C.webUrl||H&&H.webUrl);return n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},o.driveItemKeyFacet.pack(te)),i.displayNameFacet.pack(t)),void 0!==se?i.fileSizeFacet.pack(se):{}),_||C.folder||M||H&&H.folder?n.__assign({},i.folderFacet.pack(ie?{}:void 0)):{}),ce?i.openUrlFacet.pack(ce):{}),g.systemFilePathFacet.pack(ee)),re?i.canonicalUrlFacet.pack(re):{}),i.dateModifiedFacet.pack(z?new Date(z).getTime():void 0)),$?n.__assign({},i.dateAccessedFacet.pack(new Date($).getTime())):{}),r.oneNoteFacet.pack(J&&"oneNote"===J.type?{}:void 0)),a.graphThumbnailSetFacet.pack(K)),ne?E.thumbnailTokenKeyFacet.pack(ne):{}),le?p.thumbnailFacet.pack({width:le.large.width,height:le.large.height,url:le.large.url}):{}),f.driveItemResponseFacet.pack(C)),R?i.eTagFacet.pack(R):{}),Q&&Q.width&&Q.height?p.dimensionsFacet.pack({width:Q.width,height:Q.height}):{}),Q&&!G?p.photoFacet.pack({}):{}),G?p.videoFacet.pack({}):{}),s.defaultChildItemSetFacet.pack({itemKey:u.driveItemSetKeyFacet.serialize({driveItemKey:te,sortBy:"",isAscending:!0})})),i.analyticsItemFacet.pack({itemKey:l.driveAnalyticsItemKeyFacet.serialize({driveItemKey:te})})),i.parentFolderItemFacet.pack(L?{itemKey:L}:void 0)),!V&&re?n.__assign({},i.parentFolderItemNameFacet.pack(x(re))):{}),v.driveTypeFacet.pack(X)),V?n.__assign({},m.vaultFacet.pack(C.vault)):{}),i.fileNameFacet.pack(ue)),O?n.__assign(n.__assign({},i.isSharedFacet.pack(!!Y)),c.sharedFacet.pack(Y)):{}),"number"==typeof oe?d.countFacet.pack(oe):{}),g.mimeTypeFacet.pack(M&&M.mimeType)),ae?y.officeAppFacet.pack(ae):{}),fe?w.sharepointIdsFacet.pack(fe):{})};function x(e){var t=e.split("/");return t.length>2?decodeURI(t[t.length-2]):void 0}t.getParentFolder=x;function T(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}t.getFileName=T});
define("QZ",["require","exports","F","c2","c1"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetKeyFacet=new n.KeyFacet("driveItemSet",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet),sortBy:n.stringPart(),isAscending:n.booleanPart(),extFilters:n.arrayPart(n.stringPart()),filters:n.arrayPart(n.subKeyPart(i.driveFilterKeyFacet)),groupBy:n.stringPart()})});
define("Q4",["require","exports","H"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphThumbnailSetFacet=new n.Facet("graphThumbnailSet")});
define("Ro",["require","exports","H"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemResponseFacet=new n.Facet("driveItemResponse")});
define("QT",["require","exports","H"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveTypeFacet=new n.Facet("driveType")});
define("Rm",["require","exports","H"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.vaultFacet=new n.Facet("vault")});
define("Rl",["require","exports","H"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.officeAppFacet=new n.Facet("officeApp")});
define("Rk",["require","exports","FA"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getOfficeAppFromExtension=function(e){for(var t=e.replace(".",""),r=0,i=Object.keys(n.OfficeAppToExtensionsMap);r<i.length;r++){var s=i[r];if(n.OfficeAppToExtensionsMap.hasOwnProperty(s)){if(n.OfficeAppToExtensionsMap[s].indexOf(t)>-1)return s}}}});
define("QQ",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.thumbnailTokenKeyFacet=new n.KeyFacet("thumbnailToken",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0})})});
define("Q3",["require","exports","e3","c2","Q4","QQ","QP"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemThumbnailControlHandler=n.createControlHandler()(function(){return function(e){return u}});function u(e,t){var n=t.itemKey,u=t.desiredSize,f=e.demandItemFacet(r.driveItemKeyFacet,n),l=(function(e){return e&&a(e)?e[0]:e})(e.demandItemFacet(i.graphThumbnailSetFacet,n));if(f&&l&&l.large){if(l.large.url.indexOf("access_token")>-1)return{thumbnail:{url:c(l.large.url,u),width:0,height:0}};var h,p=e.demandItemFacet(s.thumbnailTokenKeyFacet,n),d=p&&s.thumbnailTokenKeyFacet.serialize(p);return{thumbnail:void 0!==(h=e.demandItemFacet(o.thumbnailAccessTokenFacet,d))?{url:c(l.large.url,u,h),width:0,height:0}:void 0}}return{}}function a(e){return e&&"number"==typeof e.length}t.isArray=a;var f=/width=[0-9]*/,l=/height=[0-9]*/;function c(e,t,n){var r=""+(t.width||"");f.test(e)?e=e.replace(f,"width="+r):e+=(e.indexOf("?")>-1?"&":"?")+"width="+r;var i=""+(t.height||"");l.test(e)?e=e.replace(l,"height="+i):e+=(e.indexOf("?")>-1?"&":"?")+"height="+i;return e=n?e+="&access_token="+n:e}});
define("QP",["require","exports","H"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.thumbnailAccessTokenFacet=new n.Facet("thumbnailAccessToken")});
define("Rf",["require","exports","mU","Rj","es","bv","cu","hS","gy","Ri","gs","Rh","Rg"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processDriveItem=function(e){var t,l=e.itemKey,d=e.driveItemKey,v=e.parentFolderItemKey,m=e.setItemKey,g=e.driveItemResponse,y=e.endpoint,b=e.getDriveItemFacets,w=void 0===b?r.getDriveItemFacets:b,E=new u.ItemResolver,S=a.driveActivityItemKeyFacet.serialize({driveItemKey:d}),x=m?i.getInvalidationFacet().forFacet(s.displayNameFacet).thenInvalidate(m,o.childItemsFacet).forFacet(s.deletedFacet).thenInvalidate(m,o.childItemsFacet).forFacet(s.parentFolderItemFacet).thenInvalidate(m,o.childItemsFacet).pack():void 0,T=n.__assign(n.__assign(n.__assign({},w({driveItemKey:d,driveItem:g,endpoint:y,parentFolderItemKey:v})),s.activityItemFacet.pack({itemKey:S})),x);E.resolveItems({items:(t={},t[l]=T,t)});if(g.lastModifiedBy){if(k=g.lastModifiedBy.user){var N=k.id&&f.userByIdKeyFacet.serialize({id:k.id,endpoint:y});if(N=k.email&&h.userByEmailKeyFacet.serialize({email:k.email,endpoint:y})){var C=p({itemKey:l,personFacet:s.modifiedByPersonFacet,userKey:N,user:k}).itemResolver;E.merge(C)}}}if(g.remoteItem&&g.remoteItem.shared&&g.remoteItem.shared.sharedBy&&g.remoteItem.shared.sharedBy.user){var k,L=void 0;if((k=g.remoteItem.shared.sharedBy.user).email){L=h.userByEmailKeyFacet.serialize({email:k.email,endpoint:y});C=p({itemKey:l,personFacet:c.sharedByPersonFacet,userKey:L,user:k}).itemResolver;E.merge(C)}}return{itemResolver:E}};function p(e){var t,r,i=e.itemKey,o=e.personFacet,a=e.userKey,f=e.user,c=new u.ItemResolver;c.resolveItems({items:n.__assign((t={},t[a]=n.__assign(n.__assign(n.__assign({},s.displayNameFacet.pack(f.displayName)),l.emailFacet.pack(f.email)),l.sipFacet.pack(f.id)),t),o&&(r={},r[i]=n.__assign({},o.pack({itemKey:a,displayValue:f.displayName})),r))});return{itemResolver:c}}t.resolveUserItems=p});
define("Ri",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.userByIdKeyFacet=new n.KeyFacet("userById",{id:n.stringPart(),endpoint:n.stringPart()})});
define("QX",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ROOT_ITEM_ID="root";t.CONSUMER_ROOT_ITEM_PATH="/drive/root:";t.DEFAULT_PAGE_SIZE=30});
define("Re",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemByCanonicalUrlKeyFacet=new n.KeyFacet("driveItem",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0}),canonicalUrl:n.stringPart()})});
define("R3",["require","exports","mU","iX","gz","pw","R4","DE","K0","bt","iW","cl","KG","bv","gs","Rg"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveAnalyticsItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,a=i.driveAnalyticsItemKeyFacet.deserialize(r).driveItemKey,f=a.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,E,S,x,T,N,C,k,L=this;return n.__generator(this,function(A){t={Caller:"HoverCard"};i="GetItemAnalytics_addon-graph";E=n.__awaiter(L,void 0,void 0,function(){var c,h,m,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:return[4,e(u.getRawDataWithCache({url:(S=u.getDriveItemUrl(a),x=g(S),T="$expand=analytics($expand=allTime($expand=activities))",N="$select=*,id,reactions,trending",C=N+"&"+T+",insights($expand=keyPoints)",k=x+"?"+C,k),qosName:i+"_GetAnalyticsSections",endpoint:f,timeout:6e3,headers:t,driveUrl:g(u.getDriveUrl(a))}))];case 1:c=E.sent();h=o.parseResponseOfAnalyticsSections(c);if(m=h.createdBy){y=v.userByEmailKeyFacet.serialize({email:m.email,endpoint:f});e(l.resolveItems({items:(b={},b[y]=n.__assign(n.__assign(n.__assign(n.__assign({},p.displayNameFacet.pack(m.displayName)),d.emailFacet.pack(m.email)),d.pictureFacet.pack(m.image)),d.sipFacet.pack(m.id)),b[r]=n.__assign({},s.createdByPersonFacet.pack({itemKey:y,displayValue:m.displayName})),b)}))}e(l.resolveItems({items:(w={},w[r]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},s.viewCountFacet.pack(h.viewCount)),s.viewerCountFacet.pack(h.viewerCount)),s.isTrendingFacet.pack(h.isTrending)),s.activitiesFacet.pack(h.activities)),s.likeCountFacet.pack(h.likeCount)),s.commentCountFacet.pack(h.commentCount)),s.lifeCycleStatusFacet.pack(h.lifeCycleStatus)),s.keyPointsFacet.pack(h.keyPointsData)),s.incompleteDataFacet.pack(h.incompleteData)),s.createdDateTimeFacet.pack(h.createdDateTime)),w)}));return[2]}var S,x,T,N,C,k})});S=[E];if(h.isCombinedRecoAndConvoApiCallEnabled()){x=n.__awaiter(L,void 0,void 0,function(){var o,c,h,p;return n.__generator(this,function(d){switch(d.label){case 0:return[4,e(u.getRawDataWithCache({url:m(u.getDriveItemUrl(a)),qosName:i+"_GetRecommendedActionsAndConversations",endpoint:f,timeout:6e3,headers:t,driveUrl:g(u.getDriveUrl(a))}))];case 1:o=d.sent();c=y(o);h=b(o);e(l.resolveItems({items:(p={},p[r]=n.__assign(n.__assign({},s.recommendedActionsFacet.pack(c)),s.conversationsFacet.pack(h)),p)}));return[2]}})});S.push(x)}else{T=n.__awaiter(L,void 0,void 0,function(){var o,c,h;return n.__generator(this,function(p){switch(p.label){case 0:return[4,e(u.getRawDataWithCache({url:(d=u.getDriveItemUrl(a),v=g(d),v+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities))"),qosName:i+"_GetRecommendedActions",endpoint:f,timeout:6e3,headers:t,driveUrl:g(u.getDriveUrl(a))}))];case 1:o=p.sent();c=y(o);e(l.resolveItems({items:(h={},h[r]=n.__assign({},s.recommendedActionsFacet.pack(c)),h)}));return[2]}var d,v})});S.push(T);if(!w()){N=n.__awaiter(L,void 0,void 0,function(){var o,c,h;return n.__generator(this,function(p){switch(p.label){case 0:return[4,e(u.getRawDataWithCache({url:(d=u.getDriveItemUrl(a),v=g(d),v+"?$expand=conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))"),qosName:i+"_GetConversations",endpoint:f,timeout:6e3,headers:t,driveUrl:g(u.getDriveUrl(a))}))];case 1:o=p.sent();c=b(o);e(l.resolveItems({items:(h={},h[r]=n.__assign({},s.conversationsFacet.pack(c)),h)}));return[2]}var d,v})});S.push(N)}}if(h.isLowActivityTidbitEnabled()){C=n.__awaiter(L,void 0,void 0,function(){var o,c;return n.__generator(this,function(h){switch(h.label){case 0:return[4,e(u.getRawDataWithCache({url:(p=u.getDriveItemUrl(a),d=g(p),d+"/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'"),qosName:i+"_GetShareWithPeople",endpoint:f,timeout:6e3,headers:t}))];case 1:o=h.sent();e(l.resolveItems({items:(c={},c[r]=n.__assign({},s.recommendedPeopleFacet.pack(o.value)),c)}));return[2]}var p,d})});S.push(C)}else e(l.resolveItems({items:(k={},k[r]=n.__assign({},s.recommendedPeopleFacet.pack([])),k)}));return[2,c.waitForAll(S)]})})}});function m(e){var t=g(e),n="?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),";w()||(n=n.concat("conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))"));return""+t+n}function g(e){return e.replace("2.0","2.1")}function y(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction));return n}function b(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),r={},i=[];n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;if(!r.hasOwnProperty(t)){r[t]=!0;i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:a.ConversationType[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants})}});return i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})}function w(){return f.Killswitch.isActivated("c0189bf0-b5ab-40e7-b523-42ca8f2d4b11","11/11/2019","shadow call for conversations")}});
define("R4",["require","exports","mU","bl","R6","W","DK","f8","R5","bt"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IMAGE_LINK="/_layouts/15/userphoto.aspx?size=S&accountname=";var l=f.Killswitch.isActivated("1B23F399-20D5-4D78-9FE5-7FAC542E706E","1/30/2018","ItemAnalytics API transfer to vroom 2.1")?"v2.0":"v2.1",c=(function(){function e(e,n){this._eTagMap={};this._dataRequestor=n.vroomDataRequestor;var r=n.getProfileImageUrl,i=void 0===r?function(e){return""+t.IMAGE_LINK+e}:r,s=n.caller,o=void 0===s?"hovercard":s,u=n.useSharePointApi,a=void 0!==u&&u;this._getProfileImageUrl=i;this._caller=o;this._useSharePointApi=a}e.prototype.getItemAnalytics=function(e,t){void 0===t&&(t={});var n=t.apiVersion,i=void 0===n?l:n,s=t.skipToken,o=void 0===s?"":s,u=t.headers,a=void 0===u?{Caller:this._caller}:u,f=o?";$skiptoken="+o:"",c="GetItemAnalytics"+i+(e.queryType?"_"+e.queryType:"")+"_WithGuestUser",h=this._getBaseUrl(e);if(!h)return r.default.resolve();var p=h+"/analytics/allTime?$expand=activities"+"($filter=access%20ne%20null)"+f;return this._getAnalytics(c,p,!1,e,a)};e.prototype.getAnalyticsSections=function(e,t){void 0===t&&(t={});if(!this._useSharePointApi){var n=t.headers,i=void 0===n?{Caller:this._caller}:n,s=this._getBaseUrl(e);if(!s)return r.default.resolve();",id,reactions";"$expand=insights($expand=keyPoints)";",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention";var o="$select=*,id,reactions,malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention",u=o+"&$expand=insights($expand=keyPoints)",a=this._useSharePointApi?s+"/driveItem?"+u:s+"?"+u;return this._getAnalytics("GetAnalyticsSections_WithReaction_WithKeyPoints_WithLifeCycle",a,!0,e,i)}};e.prototype.getItemAnalyticsSections=function(e,t){void 0===t&&(t={});var n="$expand=analytics($expand=allTime($expand=activities($filter=access%20ne%20null)))",i=this._getBaseUrl(e);if(!i)return r.default.resolve();var s=t.apiVersion,o=void 0===s?l:s,u=t.headers,a=void 0===u?{Caller:this._caller}:u,f=e.queryType?"_"+e.queryType:"";if(this._useSharePointApi){var c="GetItemAnalyticsSharePoint"+o+f,h=i+"/driveItem?"+n;return this._getAnalytics(c,h,!0,e,a)}var p="GetItemAnalyticsSections"+o+f+"_WithGuestUser_WithReaction_WithKeyPoints_WithLifeCycle",d=i+"?$select=*,id,reactions,malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention&$expand=analytics($expand=allTime($expand=activities($filter=access%20ne%20null))),insights($expand=keyPoints)";return this._getAnalytics(p,d,!0,e,a)};e.prototype.getLastSevenDaysItemAnalytics=function(e){var t=this._getBaseUrl(e),n={Caller:this._caller};if(!t)return r.default.resolve();var i=t+"/analytics/lastSevenDays?$expand=activities($filter=ActivityType%20eq%20%27Access%27)";return this._getAnalytics("GetLastSevenDaysItemAnalytics",i,!1,e,n)};e.prototype.getItemAnalyticsByInterval=function(e,t,n,r){var i=l,s=t.toISOString(),o=n.toISOString(),u=this._getBaseUrl(e),a=this._getAnalyticsByIntervalPath(u,i,s,o,r);return this._getAnalyticsByInterval("GetDailyItemAnalytics",a,e.getAccessToken&&e.getAccessToken(),i)};e.prototype._getAnalytics=function(e,t,n,r,i,s){var o=this;return this._dataRequestor.send({apiName:e,path:t,accessToken:r.getAccessToken&&r.getAccessToken(),headers:i,timeout:6e3,qosExtraData:{Caller:this._caller}}).then(function(e){"string"==typeof e.isTrending&&"True"===e.isTrending||"boolean"==typeof e.isTrending&&!0===e.isTrending?e.isTrending=!0:e.isTrending=!1;e.eTag&&(o._eTagMap[r.itemId]=e.eTag);return n?h(e,o._getProfileImageUrl):p(e,o._getProfileImageUrl)})};e.prototype.updateItemKeyPoints=function(e,t){var n=this,r=this._getBaseUrl(e)+"/insights/keyPoints";return this._dataRequestor.send({path:r,apiName:"UpdateKeyPoints",requestType:"POST",headers:{Caller:this._caller,"if-Match":this._eTagMap[e.itemId]},postData:JSON.stringify({value:t}),accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,qosExtraData:{Caller:this._caller},parseResponse:function(t){n._eTagMap[e.itemId]=t.getResponseHeader("eTag");return JSON.parse(t.responseText)}}).then(function(e){return e.value})};e.prototype._getAnalyticsByInterval=function(e,t,n,r){return this._dataRequestor.send({apiName:e,path:t,accessToken:n,useAuthorizationHeaders:this._useSharePointApi,timeout:6e3,qosExtraData:{Caller:this._caller}}).then(function(e){var t;"v2.1"===r?(e=e)&&e.value&&(t=e.value.map(m)):t=(e=e).Items;return t})};e.prototype._getBaseUrl=function(e){return e&&e.graphItemUrl?""+e.graphItemUrl:null};e.prototype._getAnalyticsByIntervalPath=function(e,t,n,r,i){var s;i=i||"day";var o="v2.1"===t?"oneDrive.getActivitiesByInterval":"getanalyticsbyinterval";s=this._useSharePointApi?"interval='"+i+"',startDateTime='"+n+"',endDateTime='"+r+"'":"v2.1"===t?"startDateTime="+n+"&endDateTime="+r+"&interval="+i:"startDateTime='"+n+"'&endDateTime='"+r+"'&interval='"+i+"'";return this._useSharePointApi?e+"/oneDrive.getActivitiesByInterval("+s+")":e+"/"+o+"?"+s};e.prototype.getFilesAnalytics=function(e,t,n){var i=this;return e&&t?this._dataRequestor.send({apiName:"getFilesAnalytics.byItems",useAuthorizationHeaders:!0,accessToken:n,apiVersion:"v2.1",path:t+"/items?$expand=analytics($expand=lastSevenDays)&$filter=sharepointIds/listItemUniqueId eq '"+e.join("' or sharepointIds/listItemUniqueId eq '")+"'",postProcessQos:this._overrideFilesAnalyticsExpectedFailure}).then(function(e){return i._parseFilesAnalyticsResponse(e)}):r.default.resolve()};e.prototype.getRecommendedActions=function(e){var t=this._getBaseUrl(e)+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities))";return this._dataRequestor.send({apiName:"RecommendedActions",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,parseResponse:function(e){return JSON.parse(e.responseText).recommendedActionSet},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})};e.prototype.getShareWith=function(e){var t=this._getBaseUrl(e)+"/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'";return this._dataRequestor.send({apiName:"ShareWith",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,parseResponse:function(e){return JSON.parse(e.responseText).value},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})};e.prototype._overrideFilesAnalyticsExpectedFailure=function(e,t){var r=o.getErrorResolution(t,function(e){switch(e){case"notSupported":return{resultType:s.ResultTypeEnum.ExpectedFailure}}});return n.__assign(n.__assign({},e),r||{})};e.prototype._parseFilesAnalyticsResponse=function(e){var t=this,r=(e.value,n.__rest(e,["value"])),i=e.value.map(function(e){var r=e.analytics,i=n.__rest(e,["analytics"]);return n.__assign(n.__assign({},i),{analytics:{lastSevenDays:d(r.lastSevenDays,t._getProfileImageUrl)}})});return n.__assign(n.__assign({},r),{value:i})};return e})();t.ItemAnalyticsService=c;function h(e,t){var n=e&&e.analytics&&e.analytics.allTime,r=n&&n.access,s=n&&n.endDateTime,o=v(n&&n.activities,t),f=(function(e){var t=[];e.malware&&t.push({status:i.AnalyticsLifeCycleStatus.MalwareDetected});e.publication&&e.publication.level.indexOf("checkout")>-1&&t.push({status:i.AnalyticsLifeCycleStatus.ThisFileIsCheckedOut,userCheckedOutThis:e.publication.checkedOutBy&&e.publication.checkedOutBy.user});e.dataLossPrevention&&(e.dataLossPrevention.block?t.push({status:i.AnalyticsLifeCycleStatus.DLPBlocked}):e.dataLossPrevention.notify&&t.push({status:i.AnalyticsLifeCycleStatus.DLPWarning}));e.metadataMissing&&t.push({status:i.AnalyticsLifeCycleStatus.MissingMetaData});e.awaitingApproval&&t.push({status:i.AnalyticsLifeCycleStatus.AwaitingApproval});e.trending&&t.push({status:i.AnalyticsLifeCycleStatus.Trending});if(e.createdDateTime){var n=new Date(e.createdDateTime);a.isItemLifeCycleStatusNew(n)&&t.push({status:i.AnalyticsLifeCycleStatus.New,createdRelativeTime:u.getFriendlyDateTimeStringPast(u.iso8601DateTimeToJsDate(e.createdDateTime)),creator:e.createdBy&&e.createdBy.user})}return t})(e),l=(function(e){var t=e&&e.insights,n=t&&t.keyPoints;return t&&{readTime:t.readTime,keyPoints:n}})(e),c=e&&e.reactions;return{activities:o||[],incompleteData:n&&n.incompleteData,startDateTime:n&&n.startDateTime,skipToken:n&&n.skipToken,isTrending:n&&n.isTrending,viewCount:r&&r.actionCount,viewerCount:r&&r.actorCount,commentCount:c&&c.commentCount,likeCount:c&&c.likeCount,lifeCycleStatus:f,keyPointsData:l,lastActivityDateTime:s,createdBy:e.createdBy&&e.createdBy.user,createdDateTime:e.createdDateTime}}t.parseResponseOfAnalyticsSections=h;function p(e,t){var r=e.activities,i=e.access,s=e.endDateTime,o=n.__rest(e,["activities","access","endDateTime"]);return{activities:v(r,t),incompleteData:o.incompleteData,startDateTime:o.startDateTime,skipToken:o.skipToken,isTrending:o.isTrending,viewCount:i&&i.actionCount,viewerCount:i&&i.actorCount,lastActivityDateTime:s}}t.parseResponseV21=p;function d(e,r){e.activities;var i=n.__rest(e,["activities"]),s=e.activities&&e.activities.map(function(e){var i=n.__rest(e,[]),s=i.actor&&i.actor.user&&i.actor.user.email;i.activityDateTime=u.getFriendlyDateTimeStringPast(u.iso8601DateTimeToJsDate(i.activityDateTime));i.actor.user.image=r&&r(i.actor.user.email)||""+t.IMAGE_LINK+s;return i});return n.__assign(n.__assign({},i),{activities:s})}t.parseResponse=d;function v(e,r){return e&&e.map(function(e){var i=n.__rest(e,[]),s=i.actor&&i.actor.user&&i.actor.user.email,o=n.__assign(n.__assign({},i.actor.user),{image:r?r(s):""+t.IMAGE_LINK+s,userType:i.actor.user.userType});return n.__assign(n.__assign({},i),{activityDateTime:u.getFriendlyDateTimeStringPast(u.iso8601DateTimeToJsDate(i.activityDateTime)),actor:n.__assign(n.__assign({},i.actor),{location:i.location,user:o}),activityType:i.access?"Access":"Edit"})})}function m(e){return e&&{activity:{},incompleteData:{missingDataBeforeDateTime:e.endDateTime,wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},interval:void 0,isTrending:e.isTrending,startDateTime:e.startDateTime,viewCount:e.access&&e.access.actionCount,viewerCount:e.access&&e.access.actorCount}}});
define("R6",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(t.AnalyticsLifeCycleStatus||(t.AnalyticsLifeCycleStatus={}))});
define("R5",["require","exports","dL"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={ODB:1146};t.isLifeCycleEnabled=function(){return n.default.isFeatureEnabled(r)};t.isItemLifeCycleStatusNew=function(e){var t=(new Date).getTime(),n=e&&e.valueOf();return!isNaN(n)&&t-n<1728e5}});
define("R2",["require","exports","mU","iX","Rz","DE","c2","Rj","cu","QZ","hS","N"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.specialDriveItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,h=i.specialDriveItemKeyFacet.deserialize(r),p=h.driveId,d=h.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,v,m,g,y,b,w,E;return n.__generator(this,function(S){switch(S.label){case 0:return[4,e(s.getRawData({url:s.getSpecialDriveItemUrl(h),qosName:"getItem",endpoint:d}))];case 1:t=S.sent();i=new l.ItemResolver;v=t&&t.parentReference;m=v&&v.driveId;g={endpoint:d,driveId:m||p,itemId:t.id};y=o.driveItemKeyFacet.serialize(g);b=v&&v.id?o.driveItemKeyFacet.serialize({endpoint:d,driveId:m,itemId:v.id}):void 0;i.resolveItems({items:(w={},w[y]=n.__assign(n.__assign(n.__assign({},u.getDriveItemFacets({driveItem:t,endpoint:d,parentFolderItemKey:b})),c.preferredKeyFacetFacet.pack(o.driveItemKeyFacet)),a.defaultChildItemSetFacet.pack({itemKey:f.driveItemSetKeyFacet.serialize({driveItemKey:g,sortBy:"",isAscending:!0})})),w)});i.mapKeys({mappings:(E={},E[y]=r,E)});e(i.execute());return[2]}})})}})});
define("Rz",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.specialDriveItemKeyFacet=new n.KeyFacet("specialDriveItem",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0}),name:n.stringPart()})});
define("R1",["require","exports","mU","iX","cu","bv","RC","DE","c2","Rj","es","hS","fQ","cc","c4","Rb","F"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemPageGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,g=o.driveItemPageKeyFacet.deserialize(r),y=g.setItemKey,b=g.endpoint,w=g.token,E=m.KeyFacet.get(y).deserialize(y).extFilters;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,m,g,S,x,T,N,C,k,L,A,O,M,_,D,P;return n.__generator(this,function(H){switch(H.label){case 0:return[4,e(u.getRawData({endpoint:b,url:w,qosName:"getChildrenPage"}))];case 1:t=H.sent();m=E&&E.length>0?v.getChildrenItemFilter(E):void 0;g=new c.ItemResolver;S=[];x=0,T=t.value;H.label=2;case 2:if(!(x<T.length))return[3,5];N=T[x];if(!!m&&m(N))return[3,4];C=N&&(N.parentReference||N.remoteItem&&N.remoteItem.parentReference);k=C&&C.driveId;L=a.driveItemKeyFacet.serialize({itemId:N.id,driveId:k,endpoint:b});A=C?a.driveItemKeyFacet.serialize({itemId:C.id,driveId:k,endpoint:b}):void 0;S.push(L);g.resolveItems({items:(P={},P[L]=n.__assign(n.__assign({},f.getDriveItemFacets({driveItem:N,endpoint:b,parentFolderItemKey:A})),l.getInvalidationFacet().forFacet(s.displayNameFacet).thenInvalidate(r,i.childItemsFacet).forFacet(s.deletedFacet).thenInvalidate(r,i.childItemsFacet).pack()),P)});return(O=e(p.readConfiguration({processDriveItemFromSharePoint:d.processDriveItemFromSharePointFacet})).processDriveItemFromSharePoint)?[4,e(O.process({itemKey:L,driveItem:N}))]:[3,4];case 3:M=H.sent().itemResolver;g.merge(M);H.label=4;case 4:x++;return[3,2];case 5:if(_=t["@odata.nextLink"]){D=o.driveItemPageKeyFacet.serialize({setItemKey:y,endpoint:b,token:_});g.merge(h.resolveNewPage({itemKey:D}).itemResolver);S.push(D)}g.merge(h.resolveExistingPage({itemKey:r,itemSetKey:y,childItemKeys:S}).itemResolver);e(g.execute());return[2]}})})}})});
define("RC",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemPageKeyFacet=new n.KeyFacet("driveItemPage",{endpoint:n.stringPart(),setItemKey:n.stringPart(),token:n.stringPart()})});
define("Rb",["require","exports","mU"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return e.reduce(function(e,t){return e&&t?"("+e+" or "+t+")":t||e})}t.anyOf=r;function i(e){return e.reduce(function(e,t){return e&&t?"("+e+" and "+t+")":t||e})}t.allOf=i;t.getExtFiltersParams=function(e){if(!e||0===e.length)return"";for(var t=[],s=[],o=0;o<e.length;o++){var u=e[o],a=!1,f=u;if("!"===u[0]){f=u.slice(1);a=!0}if("folder"===f)!a&&t.push("folder ne null");else if("."!==f[0]);else{t=[];s=[]}}return t.length>0||s.length>0?"&$filter="+(0===s.length?r(t):0===t.length?i(s):i(n.__spreadArrays([r(t)],s))):""};t.getChildrenItemFilter=function(e){return function(t){for(var n=void 0,r=void 0,i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("."===u[0])if(t.name){var a=new RegExp(u.toLocaleLowerCase()+"$"),f=t.name.toLocaleLowerCase().split(a),l=2===f.length&&""===f[1]||!1;o?n=void 0!==n?n&&!l:l:r=r||l}else{n=!1;r=!1}else if("folder"===u){var c=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!c:c:r=r||c}else if("onenote"===u){var h=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!h:h:r=r||h}}return void 0===r?void 0!==n&&n:(void 0===n||n)&&!r}}});
define("R0",["require","exports","mU","iX","c3","cu","c0","bv","hS","jc"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=i.sharedWithMeRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i;return n.__generator(this,function(c){(t=new a.ItemResolver).resolveItems({items:(i={},i[r]=n.__assign(n.__assign(n.__assign(n.__assign({},s.defaultChildItemSetFacet.pack({itemKey:o.sharedWithMeItemSetKeyFacet.serialize({driveItemKey:l,sortBy:"",isAscending:!0})})),u.displayNameFacet.pack(f.default.sharedWithMe)),u.folderFacet.pack({})),u.parentFolderItemFacet.pack(void 0)),i)});e(t.execute());return[2]})})}})});
define("RS",["require","exports","mU","iX","c0","RH","c3","DE","RZ","RY","c4","cc","RT"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=i.sharedWithMeItemSetKeyFacet.deserialize(e.itemKey),p=r.filters,d=r.sortBy,v=r.isAscending;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,m,g,y,b,w,E,S;return n.__generator(this,function(x){switch(x.label){case 0:t=h.getSharedGroup(e.itemKey),m=t.onProcessResponse,g=t.groupChildItems;y=i.sharedWithMeItemSetKeyFacet.deserialize(e.itemKey);b=y.driveItemKey.endpoint;w=r(c.readConfiguration({graphSharedWithMeEndpoint:l.graphSharedWithMeEndpointConfigurationFacet})).graphSharedWithMeEndpoint;b=w||b;return[4,r(u.isConsumerDirectEndpoint(b))];case 1:E=x.sent();return[4,r(s.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{qosName:"sharedWithMe",itemSetKeyFacet:i.sharedWithMeItemSetKeyFacet,parentItemKeyFacet:o.sharedWithMeRootItemKeyFacet,getUrl:function(e){return E?b+"/drive/view.sharedWithMe?allowExternal=true":b+"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"},filterChildItems:function(e){return!a.filterItem(e,p)},sortChildItems:function(e){return f.sortItems(e,d,v,!0)},onProcessResponse:m,groupChildItems:g})))];case 2:S=x.sent().itemResolver;r(S.execute());return[2]}})})}})});
define("RH",["require","exports","mU","DE","Rc"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getAndProcessDriveItemSetData=function(e){var t=this,s=e.itemKey,o=e.itemSetKeyFacet,u=e.getUrl,a=e.sortChildItems,f=e.qosName,l=e.preprocessResponse,c=e.expectedErrors,h=o.deserialize(s),p=h.driveItemKey.endpoint;return function(s){return n.__awaiter(t,void 0,void 0,function(){var t,o,d,v;return n.__generator(this,function(m){switch(m.label){case 0:return[4,s(r.getRawDataWithCache({url:u(h),qosName:"getChildren"+(f?"."+f:""),endpoint:p,headers:e.additionalHeaders,expectedErrors:c}))];case 1:t=m.sent();o=n.__spreadArrays(t.value);d=l?l(o):t.value;v=a?a(d):d;return[4,s(i.processDriveItemSet(n.__assign(n.__assign({},e),{childItemsResponse:n.__assign(n.__assign({},t),{value:v})})))];case 2:return[2,{itemResolver:m.sent().itemResolver}]}})})}}});
define("Rc",["require","exports","mU","Rp","es","cu","Rd"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processDriveItemSet=function(e){var t=e.itemKey,u=e.itemSetKeyFacet,a=e.parentItemKeyFacet,f=e.childItemsResponse,l=e.parentItemResponse,c=e.mapItemSetKey,h=u.deserialize(t),p=a.serialize(h.driveItemKey),d=h.driveItemKey.endpoint;return function(u){var a,h=u(r.processDriveItemSetChildren(n.__assign(n.__assign({},e),{response:f,parentItemKey:p}))).itemResolver;if(c){var v=c().itemResolver;h.merge(v)}if(l){var m=o.processLocalOrRemoteDriveItem({setItemKey:t,driveItemResponse:l,endpoint:d}).itemResolver;h.merge(m)}h.resolveItems({items:(a={},a[p]=n.__assign({},i.getInvalidationFacet().forFacet(s.defaultChildItemSetFacet).thenInvalidate(e.itemKey,s.childItemsFacet).pack()),a)});return{itemResolver:h}}}});
define("Rp",["require","exports","mU","es","cu","RC","hS","fQ","fw","cc","c4","fv","W","gH","Rd","cv","gv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processDriveItemSetChildren=function(e){return function(t){var g,y,b,w,E=e.itemKey,S=e.parentItemKey,x=e.itemSetKeyFacet,T=e.filterChildItems,N=e.onProcessResponse,C=e.groupChildItems,k=e.response,L=e.skip,A=void 0===L?0:L,O=e.enableRandomAccess,M=void 0!==O&&O,_=e.totalChildCount,D=e.getDriveItemFacets,P=x.deserialize(E),H=P.driveItemKey.endpoint,B=new o.ItemResolver,j=t(c.logQoS({name:"remoteItemsMissingParentRef"})),F="number"==typeof k["@odata.count"]?k["@odata.count"]:_||k.value.length,I=k["@odata.nextLink"],q=!!I,R=t(v.readItems(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(i.childItemsFacet,E),prevChildKeys:e.demandItemFacet(i.childItemsFacet,E)}})),U=R.childItemsFacetResolved,z=R.prevChildKeys,W=z&&z.itemKeys;M&&(U&&W?w=W.slice(0):"number"==typeof F&&(w=new Array(F+(q&&F<=k.value.length?1:0))));w||(w=new Array(k.value.length+(q?1:0)));for(var X=A,V=0,$=0,J=k.value;$<J.length;$++){var K=J[$],Q=T&&T(K),G=K.remoteItem,Y=!(K.remoteItem&&K.remoteItem.parentReference&&K.remoteItem.parentReference.driveId),Z=G&&Y;Z&&V++;if(Q||Z){w.splice(X,1);F--}else{var ee=K.webDavUrl||K.remoteItem&&K.remoteItem.webDavUrl||K.webUrl,te=t(f.readConfiguration({graphEndpoint:l.graphEndpointConfigurationFacet,graphRecentEndpoint:l.graphRecentEndpointConfigurationFacet})),ne=te.graphEndpoint,re=te.graphRecentEndpoint,ie=H.indexOf("/_api/v2.0")>-1||H.indexOf("/_api/v2.1")>-1,se=ne||re;if(ee&&(ie||se)){var oe=ee&&decodeURIComponent(ee);H=se?new p.SimpleUri(oe).authority+"/_api/v2.0":""+new p.SimpleUri(oe).authority+new p.SimpleUri(H).path}var ue=d.processLocalOrRemoteDriveItem({setItemKey:E,driveItemResponse:K,endpoint:H,getDriveItemFacets:D}),ae=ue.itemResolver,fe=ue.actualItemKey,le=ue.actualDriveItemKey;w[X]=fe;B.merge(ae);if(N){var ce=N({itemKey:E,driveItemKey:le,item:K});ce&&B.merge(ce.itemResolver)}var he=t(f.readConfiguration({processDriveItemFromSharePoint:l.processDriveItemFromSharePointFacet})).processDriveItemFromSharePoint;if(he&&(ie||se)){var pe=t(he.process({itemKey:fe,driveItem:K})).itemResolver;B.merge(pe)}X++}}t(j(n.__assign({resultType:V<1?h.ResultTypeEnum.Success:h.ResultTypeEnum.Failure},V>0?{extraData:{count:V}}:{})));if(q){var de=s.driveItemPageKeyFacet.serialize({setItemKey:E,endpoint:H,token:I});B.merge(u.resolveNewPage({itemKey:de}).itemResolver);w[X]=de}if(C){var ve=C(P);ve&&B.merge(ve.itemResolver)}else B.resolveItems({items:(g={},g[E]=n.__assign({},i.childItemsFacet.pack({itemKeys:w})),g)});F!==_&&B.resolveItems({items:(y={},y[S]=n.__assign({},m.countFacet.pack(F)),y)});B.resolveItems({items:(b={},b[E]=n.__assign(n.__assign({},i.parentItemFacet.pack({itemKey:S})),r.getInvalidationFacet().forFacet(i.childItemsFacet).thenInvalidate(a.clearCacheIfNotOffline).pack()),b)});return{itemResolver:B}}}});
define("RZ",["require","exports","aJ","eE","Ff","aI","aJ"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=new Map([["code",n.ItemTypeFilter.text],["csv",n.ItemTypeFilter.excel],["docx",n.ItemTypeFilter.word],["dotx",n.ItemTypeFilter.word],["one",n.ItemTypeFilter.onenote],["onepkg",n.ItemTypeFilter.onenote],["onetoc",n.ItemTypeFilter.onenote],["pdf",n.ItemTypeFilter.pdf],["photo",n.ItemTypeFilter.media],["potx",n.ItemTypeFilter.powerpoint],["ppsx",n.ItemTypeFilter.powerpoint],["pptx",n.ItemTypeFilter.powerpoint],["rtf",n.ItemTypeFilter.text],["txt",n.ItemTypeFilter.text],["video",n.ItemTypeFilter.media],["xlsx",n.ItemTypeFilter.excel],["xltx",n.ItemTypeFilter.excel],["zip",n.ItemTypeFilter.zip]]);function a(e,t){var n,s,a=(n=e,s=r.getFileExtension(n,!0),i.getIconNameFromExtension(s)),f=u.get(a);return!!f&&o.containsItemTypeFilter(t.filters,f)}function f(e,t){var n=new Date(e.valueOf());n.setDate(n.getDate()-t);return n}t.filterItem=function(e,t){void 0===t&&(t=[]);return t.every(function(t){return(!("sharedByName"===t.type)||(function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName;return!!n&&t.indexOf(n)>-1})(e,t.values))&&(!("fileName"===t.type)||(function(e,t){return!!e.name&&a(e.name,t)})(e,s.getIItemTypeFilter(t.values)))&&(!("dateShared"===t.type)||(function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime||"today";return(n&&new Date(n))>=t})(e,(function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case"today":return n;case"yesterday":return f(n,1);case"last7Days":return f(n,7);case"last30Days":return f(n,30);case"last90Days":return f(n,90);default:return new Date(0)}})(t.values[0])))})}});
define("RY",["require","exports","mU","eO","eN"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t,n){var r=e.lastModifiedDateTime,i=t.lastModifiedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function o(e,t,n){var r=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function u(e,t,n){var r=e.name,i=t.name,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function a(e,t,n){var r=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName,i=t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedBy&&t.remoteItem.shared.sharedBy.user&&t.remoteItem.shared.sharedBy.user.displayName,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function f(e,t,r,i){return(function(e,t){return n.__spreadArrays(e).sort(t)})(e,function(e,n){var s=e.folder,o=n.folder;return r&&s&&!o?-1:r&&!s&&o?1:i(e,n,t)})}t.sortItems=function(e,t,n,l){void 0===l&&(l=!1);var c=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[r.DATE_SHARED_COLUMN_KEY],h=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[r.SHARED_BY_COLUMN_KEY],p=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[i.DISPLAY_NAME_COLUMN_KEY],d=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[r.ITEM_ACTIVITY_COLUMN_KEY],v=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[i.NAME_AND_PATH_COLUMN_KEY];switch(t){case c:return f(e,n,l,o);case h:return f(e,n,l,a);case p:case v:return f(e,n,l,u);case d:return f(e,n,l,s);default:return e}}});
define("RT",["require","exports","mU","c2","RX","c0","hS","bv","gv","cu","RW","gg","dh","eO","cU","RU"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSharedGroup=function(e){if(s.sharedWithMeItemSetKeyFacet.matches(e)){var t=s.sharedWithMeItemSetKeyFacet.deserialize(e).groupBy;if(t===p.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[p.SHARED_BY_COLUMN_KEY])return m(e);if(t===p.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[p.DATE_SHARED_COLUMN_KEY])return g(e)}return{onProcessResponse:void 0,groupChildItems:void 0}};function m(e){var t={};return{onProcessResponse:function(e){var n,s=e.driveItemKey,o=e.item;if(o&&s){var u=o.remoteItem,a=u&&u.shared&&u.shared.sharedBy,f=a&&a.user,l=r.driveItemKeyFacet.serialize(s);if(f&&f.email){var c=i.groupBySharedByKeyFacet.serialize({displayName:f.displayName,email:f.email});if(n=c,t.hasOwnProperty(n))t[c].push(l);else{t[c]=[];t[c].push(l)}}}},groupChildItems:function(r){for(var s,l,c=new o.ItemResolver,h=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var s=r[n];if(!i.groupBySharedByKeyFacet.matches(s))return e;var o=i.groupBySharedByKeyFacet.deserialize(s);t.push(o)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return i.groupBySharedByKeyFacet.serialize(e)})})(Object.keys(t)),p=[],v=0,m=h;v<m.length;v++){var g=m[v];if(i.groupBySharedByKeyFacet.matches(g)){var y=i.groupBySharedByKeyFacet.deserialize(g);c.resolveItems({items:(s={},s[g]=n.__assign(n.__assign(n.__assign({},u.displayNameFacet.pack(y.displayName)),a.isGroupFacet.pack(!0)),f.childItemsFacet.pack({itemKeys:t[g]})),s)});p.push(g)}}c.resolveItems({items:(l={},l[e]=n.__assign(n.__assign({},f.childItemsFacet.pack({itemKeys:p})),d.allGroupsCollapsedFacet.pack(!0)),l)});return{itemResolver:c}}}}t.getSharedByGroup=m;function g(e){var t={};return{onProcessResponse:function(e){var n,s=e.driveItemKey,o=e.item;if(o&&s){var u=o.remoteItem,a=u&&u.shared&&u.shared.sharedDateTime,f=r.driveItemKeyFacet.serialize(s);if(a){var l=y(new Date(a),new Date),c=i.groupByDateSharedKeyFacet.serialize({relativeTime:l,sharedDateTime:a});if(n=c,t.hasOwnProperty(n))t[c].push(f);else{t[c]=[];t[c].push(f)}}}},groupChildItems:function(r){for(var s,l,c=new o.ItemResolver,h=(function(e){for(var t={},n=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var s=r[n];if(!i.groupByDateSharedKeyFacet.matches(s))return e;var o=i.groupByDateSharedKeyFacet.deserialize(s);t.push(o)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return i.groupByDateSharedKeyFacet.serialize(e)})})(Object.keys(e)),r=function(e){return t.hasOwnProperty(e)},s=0,o=n;s<o.length;s++){var u=o[s];if(i.groupByDateSharedKeyFacet.matches(u)){var a=i.groupByDateSharedKeyFacet.deserialize(u).relativeTime,f=i.groupByRelativeTimeKeyFacet.serialize({relativeTime:a});if(r(f))for(var l=e[u],c=0,h=l;c<h.length;c++){var p=h[c];t[f].push(p)}else{t[f]=[];l=e[u];for(var d=0,v=l;d<v.length;d++){p=v[d];t[f].push(p)}}}}return t})(t),p=[],v=0,m=Object.keys(h);v<m.length;v++){var g=m[v];if(i.groupByRelativeTimeKeyFacet.matches(g)){var y=i.groupByRelativeTimeKeyFacet.deserialize(g).relativeTime;c.resolveItems({items:(s={},s[g]=n.__assign(n.__assign(n.__assign({},u.displayNameFacet.pack(y)),a.isGroupFacet.pack(!0)),f.childItemsFacet.pack({itemKeys:h[g]})),s)});p.push(g)}}c.resolveItems({items:(l={},l[e]=n.__assign(n.__assign({},f.childItemsFacet.pack({itemKeys:p})),d.allGroupsCollapsedFacet.pack(!0)),l)});return{itemResolver:c}}}}t.getDateGroup=g;function y(e,t){if(!e)return l.default.older;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return c.default.today;n.setDate(n.getDate()-1);if(e>=n)return c.default.yesterday;n.setDate(t.getDate()-t.getDay());if(e>=n)return l.default.thisWeek;n.setDate(n.getDate()-7);if(e>n)return l.default.lastWeek;var r=new Date(t.getFullYear(),t.getMonth(),1);if(e>=new Date(t.getFullYear(),t.getMonth()-1,1)&&e<r)return l.default.lastMonth;n.setDate(n.getDate()-7);if(e>n)return l.default.twoWeeksAgo;n.setDate(n.getDate()-7);if(e>n)return l.default.threeWeeksAgo;if(e>=r)return l.default.thisMonth;var i=t.getFullYear()===e.getFullYear(),s=v.months[e.getMonth()];return i?s:h.format(c.default.MonthAndYear,s,e.getFullYear())}t.getDateGroupName=y});
define("RX",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupBySharedByKeyFacet=new n.KeyFacet("SharedByPersonKeyFacet",{displayName:n.stringPart(),email:n.stringPart()});t.groupByDateSharedKeyFacet=new n.KeyFacet("dateSharedGroupKeyFacet",{relativeTime:n.stringPart(),sharedDateTime:n.stringPart()});t.groupByRelativeTimeKeyFacet=new n.KeyFacet("relativeTimeGroupKeyFacet",{relativeTime:n.stringPart()})});
define("RU",["require","exports","RV"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.days=[n.default.sunday,n.default.monday,n.default.tuesday,n.default.wednesday,n.default.thursday,n.default.friday,n.default.saturday];t.shortDays=[n.default.shortSunday,n.default.shortMonday,n.default.shortTuesday,n.default.shortWednesday,n.default.shortThursday,n.default.shortFriday,n.default.shortSaturday];t.shortMonths=[n.default.shortJanuary,n.default.shortFebruary,n.default.shortMarch,n.default.shortApril,n.default.shortMay,n.default.shortJune,n.default.shortJuly,n.default.shortAugust,n.default.shortSeptember,n.default.shortOctober,n.default.shortNovember,n.default.shortDecember];t.months=[n.default.january,n.default.february,n.default.march,n.default.april,n.default.may,n.default.june,n.default.july,n.default.august,n.default.september,n.default.october,n.default.november,n.default.december]});
define("RR",["require","exports","mU","iX","RB","cu","RA","bv","hS","jc"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=i.sharedByMeRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i;return n.__generator(this,function(c){(t=new a.ItemResolver).resolveItems({items:(i={},i[r]=n.__assign(n.__assign(n.__assign(n.__assign({},s.defaultChildItemSetFacet.pack({itemKey:o.sharedByMeItemSetKeyFacet.serialize({driveItemKey:l})})),u.displayNameFacet.pack(f.default.sharedByMe)),u.folderFacet.pack({})),u.parentFolderItemFacet.pack(void 0)),i)});e(t.execute());return[2]})})}})});
define("RB",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeRootItemKeyFacet=new n.KeyFacet("sharedByMeRootItem",{endpoint:n.stringPart()})});
define("RA",["require","exports","F","c2"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeItemSetKeyFacet=new n.KeyFacet("sharedByMeItemSet",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet)})});
define("RQ",["require","exports","mU","iX","RA","RH","RB"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(u){switch(u.label){case 0:return[4,r(s.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{qosName:"sharedByMe",itemSetKeyFacet:i.sharedByMeItemSetKeyFacet,parentItemKeyFacet:o.sharedByMeRootItemKeyFacet,getUrl:function(e){return e.driveItemKey.endpoint+"/drive/shared"}})))];case 1:t=u.sent().itemResolver;r(t.execute());return[2]}})})}})});
define("RP",["require","exports","mU","iX","cu","wy","em","bv","hS","jc","c4","cc"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,h=o.recentRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o,p;return n.__generator(this,function(d){t=e(c.readConfiguration({groupBy:l.recentItemsGroupByFacet})).groupBy;(o=new a.ItemResolver).resolveItems({items:(p={},p[r]=n.__assign(n.__assign(n.__assign(n.__assign({},i.defaultChildItemSetFacet.pack({itemKey:s.recentItemSetKeyFacet.serialize({driveItemKey:h,sortBy:"",isAscending:!0,groupBy:t||""})})),u.displayNameFacet.pack(f.default.recentTitle)),u.folderFacet.pack({})),u.parentFolderItemFacet.pack(void 0)),p)});e(o.execute());return[2]})})}})});
define("RO",["require","exports","mU","iX","cu","wx","en","bv","hS","jc"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=o.savedForLaterRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o;return n.__generator(this,function(c){(t=new a.ItemResolver).resolveItems({items:(o={},o[r]=n.__assign(n.__assign(n.__assign(n.__assign({},i.defaultChildItemSetFacet.pack({itemKey:s.savedForLaterItemSetKeyFacet.serialize({driveItemKey:l,sortBy:"",isAscending:!0})})),u.displayNameFacet.pack(f.default.saved)),u.folderFacet.pack({})),u.parentFolderItemFacet.pack(void 0)),o)});e(t.execute());return[2]})})}})});
define("RL",["require","exports","mU","iX","wy","RH","em","gv","aI","aJ","aF","hS","RN","RM","bv","cu","c2","DE","c4","cc","Rb"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filterMediaContent=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})};t.recentItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var r=this,E=i.recentItemSetKeyFacet.deserialize(e.itemKey),S=E.filters,x=void 0===S?[]:S,T=E.groupBy,N=void 0===T?"":T,C=E.driveItemKey.endpoint,k=a.doExtFiltersHaveMediaTypesOnly({extFilters:a.getIItemTypeFilter(x),allowedMediaTypes:[f.ItemTypeFilter.photo,f.ItemTypeFilter.video],fileTypeIconMap:l.FileTypeIconMap}),L=a.doExtFiltersHaveMediaTypesOnly({extFilters:a.getIItemTypeFilter(x),allowedMediaTypes:[f.ItemTypeFilter.photo],fileTypeIconMap:l.FileTypeIconMap}),A=a.doExtFiltersHaveMediaTypesOnly({extFilters:a.getIItemTypeFilter(x),allowedMediaTypes:[f.ItemTypeFilter.video],fileTypeIconMap:l.FileTypeIconMap});return function(a){return n.__awaiter(r,void 0,void 0,function(){var r,f,l,S,T,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G;return n.__generator(this,function(Y){switch(Y.label){case 0:r=a(b.readConfiguration({graphRecentEndpoint:y.graphRecentEndpointConfigurationFacet})).graphRecentEndpoint;C=r||C;f=i.recentItemSetKeyFacet.serialize(n.__assign(n.__assign({},E),{driveItemKey:{endpoint:C}}));l=h.recentGroupKeyFacet.serialize({relativeTime:"today"});S=h.recentGroupKeyFacet.serialize({relativeTime:"yesterday"});T=h.recentGroupKeyFacet.serialize({relativeTime:"thisWeek"});O=h.recentGroupKeyFacet.serialize({relativeTime:"lastWeek"});M=h.recentGroupKeyFacet.serialize({relativeTime:"twoWeeksAgo"});_=h.recentGroupKeyFacet.serialize({relativeTime:"threeWeeksAgo"});D=h.recentGroupKeyFacet.serialize({relativeTime:"lastMonth"});P=h.recentGroupKeyFacet.serialize({relativeTime:"twoMonthsAgo"});H=[];B=[];j=[];F=[];I=[];q=[];R=[];U=[];z="";W="date"===N;X=function(e){var t,r=e.driveItemKey,i=e.item,s=new c.ItemResolver;if(i&&r){var o=i.remoteItem,u=o&&o.fileSystemInfo,a=u&&u.lastAccessedDateTime,f=m.driveItemKeyFacet.serialize(r);if(W&&a){var l=new Date(a);switch(p.getRelativeDateBucketByDate(l)){case p.RelativeDateGroups.today:H.push(f);break;case p.RelativeDateGroups.yesterday:B.push(f);break;case p.RelativeDateGroups.thisWeek:j.push(f);break;case p.RelativeDateGroups.lastWeek:F.push(f);break;case p.RelativeDateGroups.twoWeeksAgo:I.push(f);break;case p.RelativeDateGroups.threeWeeksAgo:q.push(f);break;case p.RelativeDateGroups.lastMonth:R.push(f);break;case p.RelativeDateGroups.twoMonthsAgo:U.push(f);z=p.getMonthString[l.getMonth()]}}s.resolveItems({items:(t={},t[f]=n.__assign({},d.folderFacet.pack(void 0)),t)});return{itemResolver:s}}};V=!k&&W?function(t){var r,i,s=new c.ItemResolver;s.resolveItems({items:(r={},r[l]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Today")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:H})),r[S]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Yesterday")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:B})),r[T]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("This Week")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:j})),r[O]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Last Week")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:F})),r[M]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Two Weeks Ago")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:I})),r[_]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Three Weeks Ago")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:q})),r[D]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Last Month")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:R})),r[P]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack(z)),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:U})),r)});var o=[];H.length>0&&o.push(l);S.length>0&&o.push(S);j.length>0&&o.push(T);F.length>0&&o.push(O);I.length>0&&o.push(M);q.length>0&&o.push(_);R.length>0&&o.push(D);U.length>0&&o.push(P);s.resolveItems({items:(i={},i[e.itemKey]=n.__assign({},v.childItemsFacet.pack({itemKeys:o})),i)});return{itemResolver:s}}:void 0;return[4,a(g.isConsumerDirectEndpoint(C))];case 1:$=Y.sent();J=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,a(s.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{qosName:k?"recentMedia":$?"ODC-recent":"recent",itemKey:f,itemSetKeyFacet:i.recentItemSetKeyFacet,parentItemKeyFacet:o.recentRootItemKeyFacet,getUrl:function(e){var t=C+"/me/drive/recent?";if($)t=C+"/drive/view.recent?";else if(k){return t+="$filter=(remoteItem/image ne null or remoteItem/video ne null)&$expand=thumbnails"}return""+t+(function(e){if(!e||0===e.length)return"";for(var t=[],r=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}"folder"===u?!o&&t.push("folder ne null"):"onenote"===u?o?r.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==u[0]||!o&&t.push("(endsWith(name, '"+u.toLowerCase()+"') or endsWith(remoteItem/name, '"+u.toLowerCase()+"'))")}return t.length>0||r.length>0?"&$filter="+(0===r.length?w.anyOf(t):0===t.length?w.allOf(r):w.allOf(n.__spreadArrays([w.anyOf(t)],r))):""})(x)},expectedErrors:J,preprocessResponse:function(e){L?e=t.filterMediaContent(e,"image"):A&&(e=t.filterMediaContent(e,"video"));return(function(e){if(!e)return e;return e.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t})})(e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,r=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||r?n?r?n>r?-1:1:-1:1:0}))},additionalHeaders:k?{Prefer:"ApiVersion=2.1,NoPreAuthThumbnailUrls"}:{Prefer:"ApiVersion=2.1;ODC,returnparentresource,returnowner"},onProcessResponse:X,groupChildItems:V})))];case 2:K=Y.sent().itemResolver;k&&K.resolveItems({items:(Q={},Q[e.itemKey]=n.__assign({},u.mediaGroupFacet.pack({})),Q)});K.mapKeys({mappings:(G={},G[f]=e.itemKey,G)});a(K.execute());return[2]}})})}})});
define("RN",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentGroupKeyFacet=new n.KeyFacet("recentGroup",{relativeTime:n.stringPart()})});
define("RM",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.twoMonthsAgo="Two months ago";e.older="Older"})(n=t.RelativeDateGroups||(t.RelativeDateGroups={}));t.getRelativeDateBucketByDate=function(e){var t=new Date;return(function(e,t){return r(t,e)})(e,t)?n.today:(function(e,t){return r(new Date(t.getTime()-864e5),e)})(e,t)?n.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*t.getDay();return e.getTime()>n})(e,t)?n.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*(t.getDay()+7);return e.getTime()>n})(e,t)?n.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n})(e,t)?n.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n})(e,t)?n.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?n.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?n.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?n.twoMonthsAgo:""};function r(e,t){return e.toDateString()===t.toDateString()}t.getMonthString=["January","February","March","April","May","June","July","August","September","October","November","December"]});
define("RK",["require","exports","mU","iX","RH","wx","en","c2","el","hS","bv","cu","es","Rj","cc","jc","c4","c4","gH"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function b(e){var t,n,r=e.name&&(t=e.name,n=".aspx",t.substr(t.length-n.length)===n),i=e.package||e.remoteItem&&e.remoteItem.package,s=i&&"oneNote"===i.type;return r||s||!1}t.savedForLaterItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,w,E,S,x,T,N,C,k,L,A,O;return n.__generator(this,function(M){switch(M.label){case 0:t=r(d.readConfiguration({saveForLaterGraphEndpoint:g.savedForLaterGraphEndpointConfigurationFacet})).saveForLaterGraphEndpoint;w=e.itemKey;E=s.savedForLaterItemSetKeyFacet.deserialize(w);S=E.driveItemKey.endpoint;x=r(d.readConfiguration({getUserOneDriveEndpoint:m.getUserOneDriveEndpointFacet})).getUserOneDriveEndpoint;T=new y.SimpleUri(S).authority;if(N=t)return[3,3];if(!(C=x))return[3,2];k=y.SimpleUri.bind;return[4,r(x.getUserOneDriveEndpoint(T))];case 1:C=(new(k.apply(y.SimpleUri,[void 0,M.sent()]))).authority+"/_api/v2.0";M.label=2;case 2:N=C;M.label=3;case 3:S=N||"";L=s.savedForLaterItemSetKeyFacet.serialize({driveItemKey:{endpoint:S},sortBy:"",isAscending:!0});A=[{code:"provisioningNotAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Unable to retrieve user's mysite URL."},{code:"InvalidAuthenticationToken",message:"Access token has expired."},{code:"resourceBeingProvisioned",message:"The requested resource is being automatically provisioned. Please try again in a few minutes."}];return[4,r(i.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{itemKey:L,qosName:"savedForLater",itemSetKeyFacet:s.savedForLaterItemSetKeyFacet,parentItemKeyFacet:o.savedForLaterRootItemKeyFacet,getUrl:function(e){if(t){return S+"/me/drive/following?top=5000&select="+["followed","name","parentReference","webDavUrl","webUrl","id","size","lastModifiedBy","lastModifiedDateTime","sharepointIds"].join(",")}return S+"/drives/me/followed?top=5000&select=*,webDavUrl"},onProcessResponse:function(e){var t,r,i=e.itemKey,s=e.driveItemKey,o=e.item,p=new f.ItemResolver;if(s&&o){var d=u.driveItemKeyFacet.serialize(s),v=a.driveFollowedItemKeyFacet.serialize({driveItemKey:s}),m=o&&(o.webDavUrl||o.webUrl);p.resolveItems({items:(t={},t[d]=n.__assign(n.__assign(n.__assign({},l.followedItemFacet.pack({itemKey:v})),l.canonicalUrlFacet.pack(m)),l.fileSizeFacet.pack(o.size)),t[v]=n.__assign(n.__assign({},l.isFollowedFacet.pack(!0)),h.getInvalidationFacet().forFacet(l.isFollowedFacet).thenInvalidate(i,c.childItemsFacet).pack()),t)});p.invalidateItems({items:(r={},r[i]=[c.childItemsFacet],r)})}return{itemResolver:p}},filterChildItems:b,getDriveItemFacets:function(e){var t=e.driveItem,r=t.root,i=t.remoteItem,s=t.name,o=r?v.default.files:s||i&&i.name||"",u=!t.webDavUrl,a=t.followed&&t.followed.followedDateTime;return n.__assign(n.__assign(n.__assign(n.__assign({},p.getDriveItemFacets(n.__assign(n.__assign({},e),{shouldReturnShareFacets:!1}))),l.fileNameFacet.pack(p.getFileName(o,u))),a?l.dateFollowedFacet.pack(new Date(a).getTime()):{}),l.folderFacet.pack(u?{}:void 0))},mapItemSetKey:function(){var t,n=new f.ItemResolver;n.mapKeys({mappings:(t={},t[e.itemKey]=L,t)});return{itemResolver:n}},expectedErrors:A})))];case 4:O=M.sent().itemResolver;r(O.execute());return[2]}})})}})});
define("RJ",["require","exports","mU","iX","hS","gy","DE","Qf","vL","fM","es","Rf","Rg","c2","bv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveActivityItemGetItemsOperationHandler=r.createBatchedItemsOperationHandler({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=s.driveActivityItemKeyFacet.deserialize(e.itemKey).driveItemKey,r=n.endpoint,i=n.driveId,o=s.driveActivityItemKeyFacet.deserialize(t.itemKey).driveItemKey,u=o.endpoint,a=o.driveId;return!!i&&!!a&&i===a&&r===u}})(g);function v(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function m(e){var t=e[0],r={};if(t)for(var i=0,s=t.actors;i<s.length;i++){(l=s[i]).id&&(r[l.id]=!0)}for(var o=n.__assign(n.__assign({},t),{actors:n.__spreadArrays(t.actors||[])}),u=1;u<e.length;u++)for(var a=0,f=e[u].actors;a<f.length;a++){var l;if("string"==typeof(l=f[a]).id&&!r[l.id]){o.actors.push(l);r[l.id]=!0}}return o||t}function g(e){var t=this,r=e.items;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,c,h,g,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X;return n.__generator(this,function(V){switch(V.label){case 0:t=Object.keys(r);c=t[0];h=s.driveActivityItemKeyFacet.deserialize(c);g=h.driveItemKey,b=g.endpoint,w=g.driveId;if(!b)throw new Error("No endpoint to determine activity items.");E=t.map(function(e){return s.driveActivityItemKeyFacet.deserialize(e).driveItemKey.itemId});S=o.getDriveUrl({endpoint:($=b,$.replace("2.1","2.0")),driveId:w});x=S+"/ExtendedActivitiesForItems";T={driveItems:E,badgeOnly:!0};return[4,e(o.getRawData({url:x,method:"POST",body:T,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:b}))];case 1:if((N=V.sent()).value){C=(function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],s=i.driveItemId;if(s){(t[s]||(t[s]=[])).push(i)}}return t})(N.value);k=0;L=0;A=0;O=0;M=new i.ItemResolver;for(_=0,D=t;_<D.length;_++){P=D[_];k++;H=s.driveActivityItemKeyFacet.deserialize(P);B=H.driveItemKey.itemId;j=B&&C[B];F=p.driveItemKeyFacet.serialize(H.driveItemKey);I=void 0;if(j){q=new u.default;R=q.processResponse({item:{name:B||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:x},response:{value:j,"@odata.nextLink":""}}).activities;U=v(R);if(z=m(R)){A++;L++;if(!U){O++;W=y(z,P).itemResolver;M.merge(W);I=z}}}M.resolveItems({items:(X={},X[P]=n.__assign({},a.itemActivityFacet.pack(I)),X[F]=n.__assign({},l.getInvalidationFacet().forFacet(d.activityItemFacet).thenInvalidate(P,a.itemActivityFacet).pack()),X)})}e(M.execute());e(f.logEngagement({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:k,activityFieldEligibleItemCount:L,activityFieldActiveItemCount:A,activityFieldBadgedItemCount:O,activityFieldBadgedPercent:k?Math.round(O/k*100):0},isIntentional:!1}))}return[2]}var $})})}}t.getActivityItems=g;function y(e,t){var r=new i.ItemResolver,o=s.driveActivityItemKeyFacet.deserialize(t).driveItemKey,u=(function(e){var t=e.actors,r=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],s=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=n.__spreadArrays(t,r,i);s&&o.push(s);return o})(e);if(u.length>0){var a=(function(e,t){for(var n=new i.ItemResolver,r=0,s=e;r<s.length;r++){var o=b(s[r],t).itemResolver;n.merge(o)}return{itemResolver:n}})(u,o).itemResolver;r.merge(a)}return{itemResolver:r}}function b(e,t){var n=new i.ItemResolver,r={itemKey:p.driveItemKeyFacet.serialize(t),userKey:h.userByEmailKeyFacet.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}},s=c.resolveUserItems(r).itemResolver;n.merge(s);return{itemResolver:n}}});
define("RI",["require","exports","mU","iX","h7","cv","hS","wx","el","cu","bv","iV","es","c2"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveFollowItemGetItemsOperationHandler=r.createBatchedItemsOperationHandler()(d);function d(e){var t=this,r=e.items;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(O){switch(O.label){case 0:return[4,e(s.readItems(function(e){return e.demandItemFacet(c.enableFollowItemConfigurationFacet,c.configurationItemKey)}))];case 1:if(!O.sent())return[2];t=Object.keys(r);d=t[0];v=a.driveFollowedItemKeyFacet.deserialize(d);if(!(m=v.driveItemKey.endpoint))throw new Error("No endpoint to determine followed items.");g=u.savedForLaterItemSetKeyFacet.serialize({driveItemKey:{endpoint:m},sortBy:"",isAscending:!0});return[4,e(i.demandItems(function(e){return e.demandItemFacet(f.childItemsFacet,g)}))];case 2:y=O.sent();b=y&&y.itemKeys||[];w=new o.ItemResolver;E={};for(S=0,x=b;S<x.length;S++){k=x[S];E[k]=!0}for(T=0,N=t;T<N.length;T++){C=N[T];k=a.driveFollowedItemKeyFacet.deserialize(C).driveItemKey;L=!!E[p.driveItemKeyFacet.serialize(k)];w.resolveItems({items:(A={},A[C]=n.__assign(n.__assign({},l.isFollowedFacet.pack(L||void 0)),h.getInvalidationFacet().forFacet(l.isFollowedFacet).thenInvalidate(g,f.childItemsFacet).pack()),A)})}e(w.execute());return[2]}})})}}t.getFollowedItems=d});
define("RF",["require","exports","mU","iX","Ry","RH","DE","RG"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a;return n.__generator(this,function(f){switch(f.label){case 0:t=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,r(s.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{qosName:"search",itemSetKeyFacet:i.searchItemSetKeyFacet,parentItemKeyFacet:u.searchRootItemKeyFacet,getUrl:function(e){var t,n=e.driveItemKey,r=e.searchTerm;r&&(t=encodeURIComponent(r));return o.getDriveItemUrl(n)+"/search(q='"+t+"')?$expand=thumbnails&select=*,webDavUrl"},expectedErrors:t})))];case 1:a=f.sent().itemResolver;r(a.execute());return[2]}})})}})});
define("Ry",["require","exports","F","c2"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchItemSetKeyFacet=new n.KeyFacet("searchItemSet",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet),searchTerm:n.stringPart()})});
define("RG",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchRootItemKeyFacet=new n.KeyFacet("searchRootItem",{endpoint:n.stringPart()})});
define("RD",["require","exports","mU","iX","cu","iW","RE","QZ","av"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphAddonDriveItemSet=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(a.asBatch(function(){e(s.supportFacets({keyFacet:u.driveItemSetKeyFacet,facets:[u.driveItemSetKeyFacet,i.childItemsFacet]}));e(r.registerOperationHandler(u.driveItemSetKeyFacet,s.getItemsOperation)(o.driveItemSetGetItemsOperationHandler))}));return[2]})})}})});
define("RE",["require","exports","mU","iX","Ra","cc","c4","QX"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a;return n.__generator(this,function(f){switch(f.label){case 0:t=r(s.readConfiguration({pageSize:o.driveItemSetPageSizeFacet})).pageSize;return[4,r(i.loadAndProcessPagedDriveItemSet(n.__assign(n.__assign({},e),{skip:0,top:t||u.DEFAULT_PAGE_SIZE})))];case 1:a=f.sent();r(a.execute());return[2]}})})}})});
define("Ra",["require","exports","mU","QZ","c2","hS","cv","DE","gv","Rc","Rb","QT","ce"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.loadAndProcessPagedDriveItemSet=function(e){var t=this;return function(p){return n.__awaiter(t,void 0,void 0,function(){var t,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F;return n.__generator(this,function(I){switch(I.label){case 0:t=e.itemKey,d=e.top,v=e.skip;m=r.driveItemSetKeyFacet.deserialize(t);g=m.driveItemKey,y=m.extFilters;b=i.driveItemKeyFacet.serialize(m.driveItemKey);w=m.driveItemKey.endpoint,E=m.sortBy,S=m.isAscending;return[4,p(o.readItems(function(e){return{isParentItemResolved:e.isItemFacetResolved(i.driveItemKeyFacet,b),totalChildCount:e.isItemFacetResolved(a.countFacet,b)?e.demandItemFacet(a.countFacet,b):void 0,driveType:e.isItemFacetResolved(c.driveTypeFacet,b)?e.demandItemFacet(c.driveTypeFacet,b):void 0}}))];case 1:x=I.sent(),T=x.isParentItemResolved,N=x.totalChildCount,C=x.driveType;k=Promise.resolve(void 0);T||(k=p(u.getRawDataWithCache({url:u.getDriveItemUrl(g),qosName:"getItem",endpoint:w})));L=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"}];A=u.getDriveItemUrl(g);O=v?"&skiptoken="+(v+1)+"/"+N+"&skip="+v:"";M=E&&void 0!==S?u.getOrderByQueryParamString(E,S):"";_=l.getExtFiltersParams(y);D=p(u.getRawDataWithCache({url:A+"/children?$top="+d+O+M+"&$expand=thumbnails&select=*,webDavUrl"+_,qosName:"getChildren.folder",endpoint:w,expectedErrors:L}));P=[D,k];return[4,Promise.all(P)];case 2:H=I.sent(),B=H[0];if(j=H[1]){j.folder&&(N=j.folder.childCount);j.parentReference&&j.parentReference.driveType&&(C=j.parentReference.driveType)}F=p(u.supportsDriveItemSetRandomAccess(w,C));return[4,p(f.processDriveItemSet({itemKey:t,itemSetKeyFacet:r.driveItemSetKeyFacet,parentItemKeyFacet:i.driveItemKeyFacet,parentItemResponse:j,childItemsResponse:B,filterChildItems:y&&y.length>0?l.getChildrenItemFilter(y):void 0,skip:v,enableRandomAccess:F,totalChildCount:N,onProcessResponse:function(e){var t,r=new s.ItemResolver;r.resolveItems({items:(t={},t[e.itemKey]=n.__assign({},h.resolvedAsKeyFacetFacet.pack(i.driveItemKeyFacet)),t)});return{itemResolver:r}}}))];case 3:return[2,I.sent().itemResolver]}})})}}});
define("Rx",["require","exports","mU","iX","hS","Rv","Rs","DE"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.commandsGetItemsOperationHandler=r.createSingleItemOperationHandler()(a);function a(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,l,c,h,p;return n.__generator(this,function(d){switch(d.label){case 0:t=e.itemKey;a=o.commandsItemKeyFacet.deserialize(t);l=a.endpoint;return[4,r(f({url:u.getCommandsUrlFromDriveItem(a),qosName:"commands",endpoint:l}))];case 1:c=d.sent();(h=new i.ItemResolver).resolveItems({items:(p={},p[t]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},s.addToOneDriveFacet.pack(c.addToOneDrive)),s.createFolderFacet.pack(c.createFolder)),s.createLinkFacet.pack(c.createLink)),s.deleteFacet.pack(c.delete)),s.downloadFacet.pack(c.download)),s.inviteFacet.pack(c.invite)),s.moveFacet.pack(c.move)),s.officeLensFacet.pack(c.officeLens)),s.renameFacet.pack(c.rename)),s.uploadFacet.pack(c.upload)),p)});r(h.execute());return[2]}})})}}t.getCommands=a;function f(e){var t=this;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2,{addToOneDrive:{roles:["write"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}});
define("Rv",["require","exports","H"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveFacet=new n.Facet("addToOneDrive");t.createFolderFacet=new n.Facet("createFolder");t.createLinkFacet=new n.Facet("createLink");t.deleteFacet=new n.Facet("delete");t.downloadFacet=new n.Facet("download");t.inviteFacet=new n.Facet("invite");t.moveFacet=new n.Facet("move");t.officeLensFacet=new n.Facet("officeLens");t.renameFacet=new n.Facet("rename");t.uploadFacet=new n.Facet("upload")});
define("Rs",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.commandsItemKeyFacet=new n.KeyFacet("commands",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0})})});
define("Rw",["require","exports","mU","e3","cQ","aB","c2","QZ","cu","iW"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openActionControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=i.getCurrentItemSetKey(e),s=c(e,{folderItemKey:t.itemKey,currentItemSetKey:r}),a=s&&l(e,{parentItemKey:o.driveItemKeyFacet.serialize(s.driveItemKey),stageItem:t.stageItem});return n.__assign(n.__assign({},s?{itemKey:u.driveItemSetKeyFacet.serialize(s)}:{}),a?{stageItem:a}:{})}}});function l(e,t){var r=this,i=t.parentItemKey,o=t.stageItem;if(i)return o?s.createAsyncActionCreator(function(e){var t=e.itemsScopeItemKey,s=e.currentItemKey;return function(e){return n.__awaiter(r,void 0,void 0,function(){var r;return n.__generator(this,function(u){switch(u.label){case 0:e(f.resolveItems({items:(r={},r[s]=n.__assign({},a.parentItemFacet.pack({itemKey:i})),r)}));return[4,e(o({currentItemKey:s,itemsScopeItemKey:t}))];case 1:u.sent();return[2]}})})}}):void 0}t.getStageItemOverride=l;function c(e,t){var r=t.folderItemKey,i=t.currentItemSetKey;if(i&&r){var s=e.demandItemFacet(u.driveItemSetKeyFacet,i),a=e.demandItemFacet(o.driveItemKeyFacet,r);if(s&&a){var f=a.endpoint,l=a.driveId,c=a.itemId;return n.__assign(n.__assign({},s),{driveItemKey:{endpoint:f,driveId:l,itemId:c}})}}}t.getOverrideItemSetKeyForFolder=c});
define("Ru",["require","exports","mU","wy","e3","gP","gQ"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetFilteredItemSetControlHandler=i.createControlHandler()(function(){return function(e){return u}});function u(e,t){var i=t.handlers,u=t.itemKey,a=e.demandItemFacet(r.recentItemSetKeyFacet,u);if(i&&a){for(var f=[],l=0,c=i;l<c.length;l++){var h=c[l];if(h.key===o.itemPhotoTypeFilterHandler.key)f.push("photo");else if(h.key===o.itemVideoTypeFilterHandler.key)f.push("video");else if(h.key===o.itemFolderTypeFilterHandler.key)f.push("folder");else if(h.key===o.itemOneNoteFilterHandler.key)f.push("onenote");else if(h.key===o.itemNonPhotoTypeFilterHandler.key)f.push("!photo");else if(h.key===o.itemNonVideoTypeFilterHandler.key)f.push("!video");else if(h.key===o.itemNonFolderTypeFilterHandler.key)f.push("!folder");else if(h.key===o.itemNonOneNoteFilterHandler.key)f.push("!onenote");else{var p=s.getExtensionFilterFromFilterHandler(h);p&&f.push(p)}}return{itemKey:r.recentItemSetKeyFacet.serialize(n.__assign(n.__assign({},a),{filters:f}))}}return{}}});
define("Rt",["require","exports","e3","at","wy","aI","aJ","aF"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsViewControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey;if(n){var a=e.demandItemFacet(i.recentItemSetKeyFacet,n);if(a&&a.filters&&s.doExtFiltersHaveMediaTypesOnly({extFilters:s.getIItemTypeFilter(a.filters),allowedMediaTypes:[o.ItemTypeFilter.photo,o.ItemTypeFilter.video],fileTypeIconMap:u.FileTypeIconMap}))return{defaultLayout:r.tilesLayoutType,isLayoutResolved:!0}}return{}}}})});
define("Rr",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharesItemKeyFacet=new n.KeyFacet("sharesItem",{endpoint:n.stringPart(),shareId:n.stringPart()})});
define("Rq",["require","exports","mU","iX","Rr","DE","c2","Rj","cu","QZ","hS","N"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharesItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,h=i.sharesItemKeyFacet.deserialize(r),p=h.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,d,v,m,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:return[4,e(s.getRawData({url:s.getSharesItemUrl(h)+"?$expand=thumbnails&select=*,webDavUrl",qosName:"getSharesItem",endpoint:p,headers:{Prefer:"redeemSharingLinkIfNecessary"}}))];case 1:t=E.sent();i=new l.ItemResolver;d=t&&t.parentReference;v=d&&d.driveId;m={endpoint:p,driveId:v,itemId:t.id};g=o.driveItemKeyFacet.serialize(m);y=d&&d.id?o.driveItemKeyFacet.serialize({endpoint:p,driveId:v,itemId:d.id}):void 0;i.resolveItems({items:(b={},b[g]=n.__assign(n.__assign(n.__assign({},u.getDriveItemFacets({driveItem:t,endpoint:p,parentFolderItemKey:y})),c.preferredKeyFacetFacet.pack(o.driveItemKeyFacet)),a.defaultChildItemSetFacet.pack({itemKey:f.driveItemSetKeyFacet.serialize({driveItemKey:m,sortBy:"",isAscending:!0})})),b)});i.mapKeys({mappings:(w={},w[g]=r,w)});e(i.execute());return[2]}})})}})});
define("QY",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemVirtualizedPageKeyFacet=new n.KeyFacet("driveItemVirtualizedPage",{endpoint:n.stringPart(),setItemKey:n.stringPart(),skip:n.numberPart(),top:n.numberPart()})});
define("Q9",["require","exports","mU","iX","QY","Ra"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemVirtualizedPageGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,o=i.driveItemVirtualizedPageKeyFacet.deserialize(r),u=o.setItemKey,a=o.top,f=o.skip;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(i){switch(i.label){case 0:return[4,r(s.loadAndProcessPagedDriveItemSet(n.__assign(n.__assign({},e),{itemKey:u,skip:f,top:a})))];case 1:t=i.sent();r(t.execute());return[2]}})})}})});
define("Q6",["require","exports","e3","Q7"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.emptyFolderControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{emptyFolderIconUrl:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/empty_state_sfl.svg",emptyFolderTitle:r.default.savedForLaterEmptyStateTitle}}}})});
define("Q5",["require","exports","e3","zr","QT"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemHoverCardControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey;return"personal"!==e.demandItemFacet(i.driveTypeFacet,n)?{hoverCard:r.FileHoverCardZone}:{}}}})});
define("Q0",["require","exports","e3","Q2","Q1","D4"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return u}});var o=[r.fileTypeIconColumn,s.nameAndPathColumn,i.dateAccessedColumn];function u(e,t){return{columns:o}}});
define("Q1",["require","exports","nV","gx","H","yR","bv","iV","gd"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateAccessedColumn=n.createColumn({key:new i.Facet("dateAccessedColumn").id,name:r.default.AccessedDate,fieldName:"",minWidth:n.ColumnWidth.regularMin,maxWidth:n.ColumnWidth.regularMax,isCollapsable:!0},s.DateField)(function(e,t){var n=e.demandItemFacet(o.dateAccessedFacet,t,{suppressGetItems:!0}),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(u.localeFacet,u.configurationItemKey),s=i&&i.language||window.navigator.language;return s?{text:a.getRelativeDateTimeStringPast(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(o.dateAccessedFacet,t)})});
define("QW",["require","exports","e3","QZ","gv","QY","c2","iV","c4","QX","QT"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetPagingControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.setItemKey,c=e.demandItemFacet(r.driveItemSetKeyFacet,n);if(!n||!c)return{};var h=c.driveItemKey.endpoint,p=o.driveItemKeyFacet.serialize(c.driveItemKey),d=e.demandItemFacet(l.driveTypeFacet,p),v=e.demandItemFacet(a.driveItemSetPageSizeFacet,u.configurationItemKey)||f.DEFAULT_PAGE_SIZE,m=e.demandItemFacet(a.supportsDriveItemSetRandomAccessFacet,u.configurationItemKey);if(m&&m(h,d)){return{totalItemCount:e.demandItemFacet(i.countFacet,p),getPageKey:function(e,t){return s.driveItemVirtualizedPageKeyFacet.serialize({setItemKey:n,endpoint:c.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:v}}return{}}}})});
define("QV",["require","exports","e3","nU","yP","pB","yJ","yF","yL"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return l}});var f=[s.fileTypeIconColumn,r.displayNameColumn,i.dateModifiedColumn,a.modifiedByColumn,o.fileSizeColumn,u.sharedColumn];function l(e,t){return{columns:f}}});
define("QU",["require","exports","mU","iX","e3","c2","vK","er"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphItemActivityAddon=r.createAddon(function(){return function(t){t(i.registerControlHandler(s.driveItemKeyFacet,o.itemActivityFieldControl)(i.createDeferredControlHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,t(u.waitForPageLoad())];case 1:n.sent();return[4,new Promise(function(t,n){e(["aRa"],t,n)})];case 2:return[2,n.sent().driveItemActivityFieldControlHandler]}})})})))}})});
define("QS",["require","exports","mU","e3","cs","nU","QZ","c4","eO","QT","c2","eO"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES=c.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES;t.driveItemSortedItemSetControlHandler=r.createControlHandler()(function(){return function(e){return h}});function h(e,t){return p(e,o.driveItemSetKeyFacet,t)}function p(e,t,r){var o=r.itemSetKey,c=r.handler,h=c.columnKey,p=c.isAscending,d=e.demandItemFacet(t,o);if(!d)return{};var v=e.demandItemFacet(f.driveTypeFacet,l.driveItemKeyFacet.serialize(n.__assign({},d.driveItemKey)));if(!v||"business"===v||"documentLibrary"===v)return{};if(!d.sortBy&&h===s.displayNameColumn.key&&!0===p)return{newItemSetKey:o};var m=i.getConfiguration(e,{customColumnKeysToFieldNamesConfiguration:u.customColumnKeysToFieldNamesConfigurationFacet}).customColumnKeysToFieldNamesConfiguration,g=n.__assign(n.__assign({},a.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES),m),y=g?g[h]:void 0;return y?{newItemSetKey:t.serialize(n.__assign(n.__assign({},d),{sortBy:y,isAscending:p}))}:{}}t.getSortedItemSetKey=p});
define("QR",["require","exports","e3"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemMoveCopyActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{isAvailable:!0}}}})});
define("QO",["require","exports","mU","DH","hS","iX","QP","QQ","DE"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.thumbnailUrlTokenOperationHandler=s.createSingleItemOperationHandler()(function(e){var t=this,s=e.itemKey,f=u.thumbnailTokenKeyFacet.deserialize(s),l=f.endpoint,c=f.driveId;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,f,h,p;return n.__generator(this,function(d){switch(d.label){case 0:t=a.getDriveUrl({endpoint:l,driveId:c});return[4,e(r.getSessionToken(l,t))];case 1:u=d.sent();f=u&&u.accessToken;(h=new i.ItemResolver).resolveItems({items:(p={},p[s]=n.__assign({},o.thumbnailAccessTokenFacet.pack(f)),p)});e(h.execute());return[2]}})})}})});
define("Sn",["require","exports","iX","sn","tc","e3","S3","SE","c3","Sw","c0","nQ","Sv","hs","nS","Su","St","Ss","RX","Sr","Sq","av","Se","cf","So"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphAddonDeferred=n.createAddon(function(){return function(e){e(E.asBatch(function(){e(u.graphAddonDataOnlyDeferred);e(s.registerControlHandler(a.sharedWithMeRootItemKeyFacet,r.itemsCommandBarControl)(f.sharedWithMeCommandBarControlHandler));e(s.registerControlHandler(a.sharedWithMeRootItemKeyFacet,i.itemsContextMenuControl)(o.sharedWithMeContextMenuControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,c.sortedItemSetControl)(h.sharedWithMeSortedItemSetControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,p.openActionControl)(v.sharedWithMeItemSetOpenActionControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,d.groupedItemSetControl)(m.sharedWithMeGroupedItemSetControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,d.unGroupedItemSetControl)(g.sharedWithMeUngroupedItemSetControlHandler));e(s.registerControlHandler(y.groupBySharedByKeyFacet,p.openActionControl)(b.groupBySharedByOpenActionControlHandler));e(s.registerControlHandler(y.groupByRelativeTimeKeyFacet,p.openActionControl)(w.groupByRelativeTimeOpenActionControlHandler));e(n.registerOperationHandler(S.topCollaboratorSetKeyFacet,x.getItemsOperation)(T.peopleGetItemsOperationHandler))}))}})});
define("S3",["require","exports","e3","r8","rV","SD","Sx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeContextMenuControlHandler=n.createControlHandler()(function(){return function(e){return a}});var u=[r.openCommand,i.shareCommand,i.copyLinkCommand,s.addShortcutFromSharedWithMeCommand,o.removeFromSharedListCommand];function a(e,t){return{commands:u}}});
define("SD",["require","exports","H","f","xO","xQ"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addShortcutFromSharedWithMeCommand={action:r.createElement(s.AddToOneDriveAction,null),automationId:"addShortcutFromSharedWithMeCommand",iconProps:{iconName:"OneDriveAdd"},key:new n.Facet("AddShortcutFromSharedWithMe").id,name:i.default.AddShortcutFromSharedWithMe}});
define("Sx",["require","exports","f","H","ra","Sy","xO"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromSharedListCommand={key:new r.Facet("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:o.default.removeFromSharedList,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.RemoveFromSharedListAction,null)),iconProps:{iconName:"Cancel"}}});
define("Sy",["require","exports","mU","f","cn","nB","C1","i6","nM","GT","bv","SC","SB","SA","Sz"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,u=t.resolve,a=t.reject,f=t.onItemRemoved,l=t.itemKeys,c=function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:u();return[4,f()];case 1:e.sent();return[2]}})})},d=function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){a(new i.CancelError);return[2]})})};return r.createElement(s.WithItemCache,null,function(e){var t=e.itemCache,n=m(t,l),i=n.title,s=n.prompt;return r.createElement(o.ConfirmationDialog,{onCancel:d,onConfirm:c,yesText:p.default.removeFromSharedListConfirmButtonText,noText:h.default.removeFromSharedListCancelButtonText,defaultToYes:!0,title:i,prompt:s})})};return t})(r.PureComponent),m=function(e,t){if(t.length>1)return{title:h.default.itemsTitleWithAccess,prompt:h.default.itemsSubTextWithAccess};if(1===t.length){var n=e.demandItemFacet(l.folderFacet,t[0]);return{title:n?h.default.folderTitleWithAccess:h.default.fileTitleWithAccess,prompt:n?h.default.folderSubTextWithAccess:h.default.fileSubTextWithAccess}}return{title:"",prompt:""}},g=u.implementOperationWithProgress({operationTypeFacet:f.removeItemsFromSharedListOperation,progressKeyFacet:f.removeFromSharedListProgressKeyFacet,initializeBatch:function(){return d.removeFromSharedListProgressAddon}});t.RemoveFromSharedListAction=a.injectInitialProps(function(){return{removeFromSharedListWizard:v,removeItemsFromSharedList:g}})(c.RemoveFromSharedListBaseAction)});
define("SC",["require","exports","mU","f","cL","cQ","P","cy","fa","fl","DO","GT","ff"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemRemoveFromSharedAction=i.createItemCacheComponent(function(e,t){var i=t.itemKeys,f=t.removeFromSharedListWizard,p=t.removeItemsFromSharedList,d=void 0===p?c.removeItemsFromSharedList:p,v=s.getCurrentItemSetKey(e)||"";if(0===i.length)return null;for(var m=i.length<=200,g=f,y=0,b=i;y<b.length;y++){var w=b[y],E=e.demandItemFacet(l.removeFromSharedActionListControl,w);l.removeFromSharedActionListControl.evaluate(E)(e,{itemKey:w,isAvailable:!1}).isAvailable||(m=!1)}var S=e.dispatch,x=function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:e={itemSetKey:v};t=o.makeObject(i,function(){return e});return[4,S(d({items:t}))];case 1:n.sent();return[2]}})})},T=u.renderComponentOnExecute(function(e){return r.createElement(g,n.__assign({},e,{onItemRemoved:x,itemKeys:i}))});return r.createElement(a.Action,n.__assign({isAvailable:m,onExecute:T},h.getItemActionEngagement(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:i.length}}})))});t.RemoveFromSharedListBaseAction=f.withSelectedItems()(t.ItemRemoveFromSharedAction)});
define("Sz",["require","exports","mU","di","ct","oC","i6","SA","iX","e3","GT"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0});var h=((c={})[i.ProgressPhase.started]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeStartedItemsTitle,u.default.removeCompletedItemsTitleIntervals,e)||"",e)},c[i.ProgressPhase.completed]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeCompletedItemsTitle,u.default.removeCompletedItemsTitleIntervals,e)||"",e)},c[i.ProgressPhase.failed]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeFailedItemsTitle,u.default.removeFailedItemsTitleIntervals,e)||"",e)},c[i.ProgressPhase.canceled]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeFailedItemsTitle,u.default.removeFailedItemsTitleIntervals,e)||"",e)},c);t.removeFromSharedListProgressAddon=a.createAddon(function(){return function(e){e(f.registerControlHandler(l.removeFromSharedListProgressKeyFacet,s.progressControl)(f.createControlHandler()(p)))}});function p(){return function(e){return d}}function d(e,t){var r,i=o.getOverallSimpleProgressBreakdown(e,t),s=i.phase,u=i.count;r=h[s](u);return n.__assign({},r&&"item"!==t.format?{title:r}:{})}});
define("SE",["require","exports","mU","iX","e3","c2","x3","rC","rK","x1","sm","rJ","rB","ve","vc","ow","S2","S1","S0","SU","ST","SS","SR","SQ","SO","SN","SM","SL","G7","G2","el","SK","oy","hh","SJ","QZ","Ry","gR","SI","i5","SH","xY","SG","cc","c4","er","hi","gy","cf","RJ","av","xS","SF"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var Z=V.asModuleWithRetries(function(){return new Promise(function(t,n){e(["./handlers/operations/driveItem/deleteItemsBatchedOperationHandler"],t,n)})},{chunkName:"addon-graph-deferredoperations"});t.graphAddonDataOnlyDeferred=r.createAddon(function(){return function(e){var t=e(z.readConfiguration({useBatchedDeleteConfiguration:W.useBatchedDeleteConfigurationFacet})).useBatchedDeleteConfiguration;e(Q.asBatch(function(){e(i.registerControlHandler(H.driveItemSetKeyFacet,D.itemsViewSearchControl)(P.driveItemSearchControlHandler));e(i.registerControlHandler(B.searchItemSetKeyFacet,D.itemsViewSearchControl)(P.searchItemSearchControlHandler));e(i.registerControlHandler(H.driveItemSetKeyFacet,j.filteredItemSetControl)(F.driveItemSetFilteredItemSetControlHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,o.createFolderOperation)(m.driveItemCreateFolderOperationHandler));e(t?r.registerOperationHandler(s.driveItemKeyFacet,u.deleteItemsOperation)(r.createDeferredOperationHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e(X.waitForPageLoad())];case 1:t.sent();return[4,Z()];case 2:return[2,t.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):r.registerOperationHandler(s.driveItemKeyFacet,u.deleteItemsOperation)(g.driveItemDeleteItemsOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,a.renameItemOperation)(y.driveItemRenameItemOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,f.uploadItemsOperation)(b.driveItemUploadItemsOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,I.moveCopyItemsOperation)(q.driveItemMoveCopyItemsOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,G.addToOneDriveOperation)(Y.addToOneDriveOperationHandler));e(i.registerControlHandler(s.driveItemKeyFacet,l.createFolderActionControl)(w.driveItemCreateFolderActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,R.createFolderDialogControl)(U.driveItemCreateFolderDialogControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,c.renameActionControl)(E.driveItemRenameItemActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,h.deleteActionControler)(S.driveItemDeleteItemsActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,p.uploadItemsActionControl)(x.driveItemUploadItemsActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,L.shareLinkActionControl)(N.driveItemDefaultShareLinkControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,A.permissionInviteActionControl)(k.driveItemPermissionGrantControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,d.downloadItemsActionControlFacet)(T.driveItemDownloadItemsActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,v.followItemActionControl)(C.driveItemfollowItemActionControlHandler));e(r.registerOperationHandler(O.driveFollowedItemKeyFacet,_.followItemOperation)(M.driveItemFollowItemOperationHandler));e(r.registerOperationHandler($.driveActivityItemKeyFacet,J.getItemsOperation)(K.driveActivityItemGetItemsOperationHandler))}))}})});
define("S2",["require","exports","mU","c2","iX","DE","ct","cu","Rj","hS"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemCreateFolderOperationHandler=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options.folders,l=r.driveItemKeyFacet.deserialize(t),c=l.endpoint,h=l.driveId,p=l.itemId,d=Object.keys(i)[0],v=i[d].progressItemKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var i,m,g,y,b,w,E,S;return n.__generator(this,function(x){switch(x.label){case 0:i=s.getDriveItemUrl(l)+"/children";m={name:d,folder:{},"@microsoft.graph.conflictBehavior":"rename"};h&&p&&(m.parentReference={driveId:h,id:p});return[4,e(s.getRawData({url:i,method:"POST",body:m,qosName:"createFolder",endpoint:c}))];case 1:g=x.sent();y=r.driveItemKeyFacet.serialize({endpoint:c,driveId:h,itemId:g.id});b=new f.ItemResolver;v&&b.resolveItems({items:(w={},w[v]=n.__assign({},o.createdItemFacet.pack({itemKey:y})),w)});b.invalidateItems({items:(E={},E[t]=[u.defaultChildItemSetFacet],E)});b.resolveItems({items:(S={},S[y]=n.__assign({},a.getDriveItemFacets({driveItem:g,parentFolderItemKey:t,endpoint:c})),S)});e(b.execute());return[2]}})})}})});
define("S1",["require","exports","mU","c2","iX","DE","es","bv"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDeleteItemsOperationHandler=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=r.driveItemKeyFacet.deserialize(t);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,a;return n.__generator(this,function(n){switch(n.label){case 0:r=s.getDriveItemUrl(i);return[4,e(s.getRawData({url:r,method:"DELETE",qosName:"deleteItem",endpoint:i.endpoint}))];case 1:n.sent();e(o.invalidateItems({items:(a={},a[t]=[u.deletedFacet],a)}));return[2]}})})}})});
define("S0",["require","exports","mU","cg","c2","iX","DE","bv","gV","Rj","cd","hS","DK"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemRenameItemOperationHandler=s.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,s=e.options.names,p=i.driveItemKeyFacet.deserialize(t);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var i,d,v,m,g,y,b;return n.__generator(this,function(w){switch(w.label){case 0:i=Object.keys(s)[0];d=s[i],v=d.newName,m=d.newExtension;g=o.getDriveItemUrl(p);y=e(l.readItem({fileName:u.fileNameFacet},t)).fileName;b="string"==typeof m?m:y&&y.extension||"";return[4,e(o.getRawData({url:g,method:"PATCH",body:{name:""+v+b},qosName:"renameItem",endpoint:p.endpoint})).then(function(r){var i,s,o=new c.ItemResolver;o.invalidateItems({items:(i={},i[t]=[u.displayNameFacet],i)});o.resolveItems({items:(s={},s[t]=n.__assign(n.__assign({},u.displayNameFacet.pack(r.name)),u.fileNameFacet.pack(f.getFileName(r.name||"",!!r.folder))),s)});e(o.execute())}).catch(function(e){if(e instanceof h.GraphError&&e.status===r.STATUS_CODE_ZERO)throw new r.ItemOperationError({facets:n.__assign({},a.offlineErrorFacet.pack({})),innerError:e});throw e})];case 1:w.sent();return[2]}})})}})});
define("SU",["require","exports","mU","SZ","SY","SX","SW","SV","DE","DH","Rj","hc","ev","c2","iX","cd","cv","Bu","iW","ct","H","cu","bl","cm","hS"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=h.asOnceOnly(function(){return new s.UploadWaiter({},{})}),C=h.asOnceOnly(function(e){var t=e(a.getDataRequestor).dataRequestor,s=(function(e){n.__extends(t,e);function t(t){return e.call(this,t,{performanceNow:u.performanceNow})||this}return t})(u.ActivityBandwidthVerifier),f=new i.UploadService({},{dataRequestor:t}),l=new o.UploadStateMachine({},{activityBandwidthVerifierType:s,uploadService:f});return new r.Uploader({},{uploadService:f,uploadStateMachine:l})}),k=0;t.driveItemUploadItemsOperationHandler=d.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,r=e.itemKey,i=e.options.sourceEntries,s=p.driveItemKeyFacet.deserialize(r),o=s.endpoint,u=s.driveId,f=Object.keys(i)[0],c=i[f].progressItemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,h,d,m,S,x,N,C;return n.__generator(this,function(k){switch(k.label){case 0:if(!(t=e(v.readItem({sourceFile:g.sourceFileFacet},f)).sourceFile))throw new Error("No source file for Graph upload.");i=a.getDriveItemUrl(s)+":";c&&e(y.resolveItems({items:(S={},S[c]=n.__assign({},b.progressSizeFacet.pack({total:t.size,current:0})),S)}));return[4,e(L({progressItemKey:c,sourceFile:t,itemUrl:i,endpoint:o}))];case 1:h=k.sent();d=p.driveItemKeyFacet.serialize({endpoint:o,driveId:u,itemId:h.id});m=new T.ItemResolver;c&&m.resolveItems({items:(x={},x[c]=n.__assign(n.__assign({},b.createdItemFacet.pack({itemKey:d})),w.pack({progressSize:b.progressSizeFacet},{progressSize:{current:t.size}})),x)});m.invalidateItems({items:(N={},N[r]=[E.defaultChildItemSetFacet],N)});m.resolveItems({items:(C={},C[d]=n.__assign({},l.getDriveItemFacets({driveItem:h,parentFolderItemKey:r,endpoint:o})),C)});e(m.execute());return[2]}})})}});function L(e){var t=this,r=e.progressItemKey,i=e.sourceFile,s=e.itemUrl,o=e.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,a,l,h,p,d,v,g,E;return n.__generator(this,function(n){switch(n.label){case 0:t=e(C);u=e(N);return[4,e(f.getSessionToken(o))];case 1:a=n.sent();l=new c.Async;h=0;p=l.debounce(function(t){var n;if(t>h){r&&e(y.resolveItems({items:(n={},n[r]=w.pack({progressSize:b.progressSizeFacet},{progressSize:{current:t}}),n)}));h=t}},300,{leading:!1});d=e(m.readItems(function(e){return e.demandItemFacet(b.cancelSourceFacet,r)}));v=t.upload({conflictBehavior:"fail",qosData:{uploadId:""+ ++k},accessToken:a,fileName:i.name,content:i,itemUrl:s,onProgress:p,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return u.wait(e)}});g=d?d.token.subscribe(function(){v.cancel()}):void 0;n.label=2;case 2:n.trys.push([2,4,5,6]);return[4,v];case 3:return[2,n.sent()];case 4:E=n.sent();if(S.default.isCanceled(E))throw new x.CancelError;throw E;case 5:g&&g();l.dispose();return[7];case 6:return[2]}})})}}});
define("SZ",["require","exports","mU","bl","DK","W"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){var n=t.uploadService,r=t.uploadStateMachine,i=t.useStreamingUpload,s=void 0!==i&&i;this._uploadService=n;this._uploadStateMachine=r;this._useStreamingUpload=s}e.prototype.upload=function(e){var t=e.conflictBehavior,o=n.__rest(e,["conflictBehavior"]),u=o.qosData,a=new s.Qos({name:"VroomUploader.upload",extraData:u});return this._uploadState(o,{conflictBehavior:t,allowStreaming:this._useStreamingUpload}).then(function(e){a.end({resultType:s.ResultTypeEnum.Success});return e},function(e){a.end({resultType:r.default.isCanceled(e)?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure,error:e.message,resultCode:i.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},u),i.getQosExtraDataFromError(e))});return r.default.reject(e)})};e.prototype._uploadState=function(e,t){var n=this,i=t.sessionUrl,s=t.item,o=t.error;if(s)return r.default.resolve(s);if(o){var u=void 0;i&&(u=this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:i}).then(function(){},function(){}));return r.default.resolve(u).then(function(){return r.default.reject(o)})}return this._uploadStateMachine.advanceState(e,t).then(function(t){return n._uploadState(e,t)})};return e})();t.Uploader=o;t.default=o});
define("SY",["require","exports","mU","bk"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.createSession=function(e){var t=e.qosData,r=e.itemUrl,i=e.headers,o=e.allowCookies,u=e.accessToken,a=e.fileName,f=e.fileSize,l=e.lastModifiedDate,c=e.eTag,h=e.conflictBehavior,p=e.ignoreCookieAuth,d={item:n.__assign(n.__assign({},s(r)?{"@microsoft.graph.conflictBehavior":h}:{"@name.conflictBehavior":h}),l?{fileSystemInfo:{lastModifiedDateTime:l.toISOString()}}:{})},v=n.__assign(n.__assign(n.__assign(n.__assign({},c?{"If-Match":c}:{}),p?{IgnoreCookieAuthentication:"t"}:{}),{Prefer:"synchronousmetadata"}),i);return this._dataRequestor.send({path:r+"/"+encodeURIComponent(a)+":/"+(s(r)?"createUploadSession":"oneDrive.createUploadSession"),requestType:"POST",apiName:"CreateSession",headers:v,allowCookies:o,accessToken:u,useAuthorizationHeaders:!0,postData:JSON.stringify(d),qosExtraData:n.__assign({conflictBehavior:h,fileSize:f},t)})};e.prototype.cancelSession=function(e){var t=e.qosData,n=e.sessionUrl;return this._dataRequestor.send({requestType:"DELETE",apiName:"CancelSession",path:n,needsAuthorization:!1,qosExtraData:t})};e.prototype.uploadFragment=function(e){var t=e.qosData,i=e.headers,s=e.sessionUrl,o=e.startByte,u=e.endByte,a=e.fileSize,f=e.content,l=e.timeout,c=e.onProgress,h=n.__assign({"Content-Range":"bytes "+o+"-"+Math.max(u-1,o)+"/"+a},i),p=!0,d=this._dataRequestor.send({path:s,needsAuthorization:!1,requestType:"PUT",apiName:"UploadFragment",headers:h,postData:f,timeout:l,hasContentType:!1,onUploadProgress:function(e){e.lengthComputable&&p&&c(o+e.loaded)},qosExtraData:n.__assign(n.__assign({},t),{startByte:o,endByte:u,fileSize:a})}),v=new r.default(function(){p=!1;d.cancel()});d.done(function(e){p=!1;v.complete(e)},function(e){p=!1;v.error(e)});return v.getPromise()};e.prototype.commit=function(e){var t=e.qosData,r=e.itemUrl,i=e.accessToken,o=e.fileName,u=(e.description,e.eTag),a=e.conflictBehavior,f=e.sessionUrl,l={"If-Match":u},c=s(r)?{"@microsoft.graph.conflictBehavior":a,"@microsoft.graph.sourceUrl":f}:{"@name.conflictBehavior":a,"@content.sourceUrl":f};return this._dataRequestor.send({path:r+"/"+encodeURIComponent(o),requestType:"PUT",apiName:"CommitSession",headers:l,accessToken:i,useAuthorizationHeaders:!0,postData:JSON.stringify(c),qosExtraData:n.__assign({conflictBehavior:a},t)})};e.prototype.getStatus=function(e){var t=e.qosData,n=e.sessionUrl;return this._dataRequestor.send({requestType:"GET",apiName:"GetStatus",path:n,needsAuthorization:!1,qosExtraData:t})};e.prototype.getItem=function(e){var t=e.qosData,r=e.itemUrl,i=e.accessToken,s=e.fileName;return this._dataRequestor.send({requestType:"GET",apiName:"GetItem",path:r+"/"+encodeURIComponent(s),useAuthorizationHeaders:!0,accessToken:i,qosExtraData:n.__assign({},t)})};return e})();t.UploadService=i;function s(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}});
define("SX",["require","exports","bn","df","a6","bl","bk"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){var s=t.asyncType,o=void 0===s?n.default:s,u=t.eventGroupType,a=void 0===u?r.default:u,f=t.targetWindow,l=void 0===f?window:f,c=this._scope=new i.default;this._async=c.attach(new o(this));this._events=c.attach(new a(this));this._targetWindow=l}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.wait=function(e){var t,n=e.duration,r=e.allowWakeWhenOnline,i=void 0!==r&&r,u=this._async,a=this._events,f=this._targetWindow,l=new o.default(function(){u.clearTimeout(t)}),c=function(){i&&l.complete()};t=u.setTimeout(function(){l.complete()},n);a.on(f,"online",c);return l.getPromise().then(function(){a.off(f,"online",c)},function(e){a.off(f,"online",c);return s.default.reject(e)})};return e})();t.UploadWaiter=u});
define("SW",["require","exports","mU","DK","W","bl","bk"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=Math.pow(2,1/4),a=(function(){function e(e,t){this._uploadService=t.uploadService;this._activityBandwidthVerifierType=t.activityBandwidthVerifierType;var n=t.useCommitForUpload,r=void 0!==n&&n,i=t.checkForCompletedUploadOnSessionTermination,s=void 0===i||i,o=t.shouldCancelOnCompleteFailure,u=void 0===o||o,a=t.maximumFragmentSize,f=void 0===a?62914560:a;this._shouldCancelOnCompleteFailure=u;this._useCommitForUpload=r;this._checkForCompletedUploadOnSessionTermination=s;this._maximumFragmentSize=f}e.prototype.advanceState=function(e,t){var n=this,r=t.sessionUrl,i=t.nextExpectedRanges;return(r?i?this._uploadItemState(e,t):this._getStatusState(e,t):this._createSessionState(e,t)).then(function(t){return t.error?n._handleGeneralErrorState(e,t):n._getState(t,{waitDuration:void 0,attemptsRemaining:void 0})})};e.prototype._createSessionState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.createSession",extraData:o});return this._uploadService.createSession({qosData:o,itemUrl:e.itemUrl,headers:e.headers,allowCookies:e.allowCookies,accessToken:e.accessToken,fileName:e.fileName,fileSize:e.content.size,eTag:e.eTag,lastModifiedDate:e.lastModifiedDate,conflictBehavior:t.conflictBehavior,ignoreCookieAuth:e.ignoreCookieAuth}).then(function(e){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{nextExpectedRanges:e.nextExpectedRanges,sessionUrl:e.uploadUrl})},function(a){return s._handleCreateSessionErrorState(e,s._getState(t,{error:a})).then(function(e){e.error?u.end({resultType:i.ResultTypeEnum.Failure,error:a.message,resultCode:r.getResultCodeFromError(a),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(a))}):u.end({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"});return e})})};e.prototype._handleCreateSessionErrorState=function(e,t){var n=this;return this._handleErrorState(t,function(r,i){switch(r){case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return n._promptForConflictBehaviorState(i,e,t)}})};e.prototype._getStatusState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.getStatus",extraData:o});return this._uploadService.getStatus({qosData:o,sessionUrl:t.sessionUrl}).then(function(e){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{nextExpectedRanges:e.nextExpectedRanges})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return s._getState(t,{error:e})})};e.prototype._uploadItemState=function(e,t){var s=this,o=e.qosData,u=e.content.size,a=this._getNextRange({fileSize:u,nextExpectedRanges:t.nextExpectedRanges}),f=new i.Qos({name:"VroomUploader.uploadItem",extraData:e.qosData});return(a&&a.start<u?t.allowStreaming?this._uploadStreamState({nextRange:a},e,t):this._uploadFragmentState({nextRange:a},e,t):this._useCommitForUpload?this._commitState(e,t):this._shouldCancelOnCompleteFailure?this._cancelSessionState(e,t):this._terminateUploadOnCompleteFailure(t)).then(function(t){if(t.error)return s._handleUploadItemErrorState(e,t).then(function(e){var t=e.error;t?f.end({resultType:i.ResultTypeEnum.Failure,error:t.message,resultCode:r.getResultCodeFromError(t),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(t))}):f.end({resultType:i.ResultTypeEnum.Success});return e});f.end({resultType:i.ResultTypeEnum.Success});return t})};e.prototype._terminateUploadOnCompleteFailure=function(e){return s.default.resolve(this._getState(e,{error:new Error("The upload session is still open but there are no more bytes to upload.")}))};e.prototype._uploadFragmentState=function(e,t,s){var a=this,f=e.nextRange,l=t.onProgress,c=t.headers,h=t.content,p=t.content.size,d=t.qosData,v=s.sessionUrl,m=s.speed,g=void 0===m?1/8:m,y=f.start,b=f.end;l&&l(y);var w,E,S=this._getFragmentSize(g),x=Math.min(y+S,b),T=new o.default(function(){w&&w.cancel()}),N=g>1/1920?6e4:3e5,C=new this._activityBandwidthVerifierType({timeout:N,totalBytes:x-y}),k=new i.Qos({name:"VroomUploader.uploadFragment",extraData:n.__assign(n.__assign({},d),{startByte:y,endByte:x,fileSize:p,speed:g,fragmentSize:S})});(w=this._uploadService.uploadFragment({qosData:d,headers:c,sessionUrl:v,startByte:y,endByte:x,fileSize:p,content:h.slice(y,x),timeout:N,onProgress:function(e){E=e;if(g>1/1920&&!C.doesActivityHaveRemainingCapacity(e-y)){k.end({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted",extraData:n.__assign(n.__assign({},d),{lastByte:e})});T.complete(a._getState(s,{speed:Math.max(.5*g,1/1920),nextExpectedRanges:void 0}));w&&w.cancel()}l&&l(e)}}).then(function(e){l&&l(x);k.end({resultType:i.ResultTypeEnum.Success});return s=a._isItem(e)?a._getState(s,{item:e}):a._getState(s,{nextExpectedRanges:e.nextExpectedRanges,speed:Math.min(C.didActivityHaveExtraCapacity()?g*u:g,1)})},function(e){k.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign(n.__assign({},d),r.getQosExtraDataFromError(e)),{lastByte:E})});return a._getState(s,{error:e})})).done(function(e){T.complete(e)});return T.getPromise()};e.prototype._uploadStreamState=function(e,t,s){var u=this,a=e.nextRange,f=t.headers,l=t.onProgress,c=t.content,h=t.content.size,p=t.qosData,d=s.sessionUrl,v=a.start,m=a.end,g=Math.min(m-v,this._maximumFragmentSize),y=v+g;l&&l(v);var b,w=new o.default(function(){b&&b.cancel()}),E=new i.Qos({name:"VroomUploader.uploadStream",extraData:n.__assign(n.__assign({},p),{startByte:v,endByte:y,fileSize:h,fragmentSize:g})});(b=this._uploadService.uploadFragment({qosData:p,headers:f,sessionUrl:d,startByte:v,endByte:y,fileSize:h,content:c.slice(v,y),timeout:864e5,onProgress:function(e){l&&l(e)}}).then(function(e){l&&l(y);E.end({resultType:i.ResultTypeEnum.Success});return s=u._isItem(e)?u._getState(s,{item:e}):u._getState(s,{nextExpectedRanges:e.nextExpectedRanges})},function(e){E.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign(n.__assign({},p),r.getQosExtraDataFromError(e)),{lastByte:void 0})});return u._handleUploadStreamErrorState({nextRange:a},t,u._getState(s,{error:e}))})).done(function(e){w.complete(e)});return w.getPromise()};e.prototype._handleUploadStreamErrorState=function(e,t,n){var r=this,i=e.nextRange;return this._handleErrorState(n,function(e){switch(e){case 0:return r._wait({duration:1e3},t).then(function(){return r._getStatusState(t,n).then(function(e){return r._getNextRange({fileSize:t.content.size,nextExpectedRanges:e.nextExpectedRanges}).start>i.start?e:r._getState(n,{allowStreaming:!1})})})}})};e.prototype._commitState=function(e,t){var s=this,o=e.qosData,u=e.onProgress;u&&u(e.content.size);var a=new i.Qos({name:"VroomUploader.commit",extraData:o});return this._uploadService.commit({qosData:o,itemUrl:e.itemUrl,accessToken:e.accessToken,fileName:e.fileName,sessionUrl:t.sessionUrl,conflictBehavior:t.conflictBehavior}).then(function(e){a.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{item:e})},function(e){return s._handleCommitErrorState(s._getState(t,{error:e})).then(function(t){a.end({resultType:t.error?i.ResultTypeEnum.Failure:i.ResultTypeEnum.ExpectedFailure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return t})})};e.prototype._handleCommitErrorState=function(e){var t=this;return this._handleErrorState(e,function(n){switch(n){case"uploadSessionFailed":case"uploadSessionNotFound":case 410:return s.default.resolve(t._getState(e,{error:void 0,sessionUrl:void 0}))}})};e.prototype._cancelSessionState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.cancelSession",extraData:o});return this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:t.sessionUrl}).then(function(){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{sessionUrl:void 0})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return s._getState(t,{sessionUrl:void 0})})};e.prototype._handleUploadItemErrorState=function(e,t){var n=this,r=t.speed,i=void 0===r?1:r;t=this._getState(t,{nextExpectedRanges:void 0});return this._handleErrorState(t,function(r,o){switch(r){case 0:return window.navigator.onLine?t.allowStreaming?s.default.resolve(n._getState(t,{allowStreaming:!1})):s.default.resolve(n._getState(t,{speed:Math.max(i*(1/8),1/1920)})):void 0;case"uploadSessionFailed":case"uploadSessionNotFound":case 404:return s.default.resolve(n._getState(t,{error:void 0,sessionUrl:void 0}));case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return n._promptForConflictBehaviorState(o,e,t);case"invalidRange":case 416:return n._wait({duration:1e3},e).then(function(){return n._getState(t,{error:void 0})})}})};e.prototype._getItemIfCompletedState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.getItemIfCompleted",extraData:o});return this._uploadService.getItem({qosData:o,fileName:e.fileName,itemUrl:e.itemUrl,accessToken:e.accessToken}).then(function(n){u.end({resultType:i.ResultTypeEnum.Success});return e.lastModifiedDate&&n.fileSystemInfo&&n.fileSystemInfo.lastModifiedDateTime===e.lastModifiedDate.toISOString()&&n.size===e.content.size&&"rename"!==t.conflictBehavior?s._getState(t,{item:n,error:void 0}):s._getState(t,{error:new Error("The upload session has terminated but the existing item does not match the input.")})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return s._getState(t,{error:e})})};e.prototype._handleGeneralErrorState=function(e,t){var n=this,r=t.waitDuration,i=void 0===r?500:r,s=t.attemptsRemaining,o=void 0===s?10:s;return this._handleErrorState(t,function(r){switch(r){case"uploadSessionNotFound":return n._checkForCompletedUploadOnSessionTermination?n._getItemIfCompletedState(e,t):void 0;case"authFailure":case"unauthenticated":case 401:case"lockMismatch":case 423:case 501:case"quotaLimitReached":case 507:return}if("number"==typeof r){if(r>=400&&r<500)return;if(0===r||r>=500&&r<600)return n._wait({duration:i,allowWakeWhenOnline:!0},e).then(function(){return n._getState(t,{error:void 0,waitDuration:Math.min(2*i,3e4),attemptsRemaining:void 0})});if(!o)return;return n._wait({duration:1e3},e).then(function(){return n._getState(t,{error:void 0,waitDuration:void 0,attemptsRemaining:Math.max(o-1,0)})})}})};e.prototype._handleErrorState=function(e,t){var n=e.error,i=r.getErrorResolution(n,t);void 0===i&&(i=s.default.resolve(e));return i};e.prototype._promptForConflictBehaviorState=function(e,t,o){var u=this,a=t.onPromptForConfictBehavior,f=t.qosData,l=new i.Qos({name:"VroomUploader.promptForConflictBehavior",extraData:f});return s.default.resolve().then(function(){return a(e)}).then(function(e){l.end({resultType:i.ResultTypeEnum.Success,extraData:f});return u._getState(o,{error:void 0,conflictBehavior:e})},function(t){l.end({resultType:i.ResultTypeEnum.Failure,error:t.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},f),r.getQosExtraDataFromError(t))});return u._getState(o,{error:t})})};e.prototype._wait=function(e,t){var n=e.duration,o=e.allowWakeWhenOnline,u=t.onWait,a=t.qosData,f=new i.Qos({name:"VroomUploader.wait",extraData:a});return s.default.resolve(u({duration:n,allowWakeWhenOnline:o})).then(function(){f.end({resultType:i.ResultTypeEnum.Success})},function(e){f.end({resultType:s.default.isCanceled(e)?i.ResultTypeEnum.Success:i.ResultTypeEnum.Failure,error:e&&e.message,resultCode:r.getResultCodeFromError(e)});return s.default.reject(e)})};e.prototype._getState=function(e,t){return n.__assign(n.__assign({},e),t)};e.prototype._getNextRange=function(e){var t=e.fileSize,n=e.nextExpectedRanges;return(void 0===n?[]:n).reduce(function(e,n){var r,i=n.split("-",2),s=i[0],o=i[1],u=parseInt(s,10);if(!e||u<e.start&&u<t){r={start:u,end:""===o?t:Math.min(parseInt(o,10)+1,t)}}else r=e;return r},void 0)};e.prototype._isItem=function(e){return!!e.id};e.prototype._getFragmentSize=function(e){var t,n=62914560*e;t=n>327680?n-n%327680:n-n%32768;return Math.min(Math.max(t,32768),this._maximumFragmentSize)};return e})();t.UploadStateMachine=a});
define("SV",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.performanceNow=window.performance?function(){return window.performance.now()}:function(){return Date.now()};var n=(function(){function e(e,t){this._performanceNow=t.performanceNow;this._startTime=this._performanceNow();this._expirationTime=this._startTime+e.timeout;this._totalBytes=e.totalBytes;this._progressPoints=0}e.prototype.doesActivityHaveRemainingCapacity=function(e){var t=this._getRateRatio(e);return void 0===t||t<=1};e.prototype.didActivityHaveExtraCapacity=function(){return this._getRateRatio(this._totalBytes)<=.5};e.prototype._getRateRatio=function(e){this._progressPoints++;var t,n=this._performanceNow(),r=n-this._startTime,i=this._expirationTime-n,s=this._totalBytes-e;(this._progressPoints>=4&&r>=4e3||this._progressPoints>0&&0===s)&&i>0&&(t=s/i/(e/r));return t};return e})();t.ActivityBandwidthVerifier=n});
define("ST",["require","exports","e3","SP"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemCreateFolderActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(r.canCreateFolderFacet,n)}}}})});
define("SP",["require","exports","mU","Rn","Rv","Rs","c2","ca","gu"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.canAddToOneDriveFacet=new u.ComputedItemFacet("addToOneDrive",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.addToOneDriveFacet}))});t.canCreateFolderFacet=new u.ComputedItemFacet("canCreateFolder",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.createFolderFacet}))});t.canCreateLinkFacet=new u.ComputedItemFacet("canCreateLink",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.createLinkFacet}))});t.canDeleteFacet=new u.ComputedItemFacet("canDelete",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.deleteFacet}))});t.canDownloadFacet=new u.ComputedItemFacet("canDownload",function(e,t){return!e.demandItemFacet(a.oneNoteFacet,t.itemKey)&&f(e,n.__assign(n.__assign({},t),{commandFacet:i.downloadFacet}))});t.canInviteFacet=new u.ComputedItemFacet("canInvite",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.inviteFacet}))});t.canMoveFacet=new u.ComputedItemFacet("canMove",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.moveFacet}))});t.canUseOfficeLensFacet=new u.ComputedItemFacet("canUseOfficeLens",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.officeLensFacet}))});t.canRenameFacet=new u.ComputedItemFacet("canRename",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.renameFacet}))});t.canUploadFacet=new u.ComputedItemFacet("canUpload",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.uploadFacet}))});function f(e,t){var n=t.itemKey,r=t.commandFacet,i=e.demandItemFacet(o.driveItemKeyFacet,n);if(!i)return!1;var u=i.endpoint,a=i.driveId,f=e.demandItemFacet(r,s.commandsItemKeyFacet.serialize({endpoint:u,driveId:a}));return!!f&&!!f.roles&&l(e,{itemKey:n,oneOfRequiredRoles:f.roles})}t.hasPermission=f;function l(e,t){var n=t.itemKey;return c(e,{oneOfRequiredRoles:t.oneOfRequiredRoles,effectiveRoles:p(e,n)})}t.hasRequiredItemRole=l;function c(e,t){var n=t.oneOfRequiredRoles,r=t.effectiveRoles;for(var i in r)if(i in n)return!0;return!1}t.hasRequiredRole=c;function h(e,t){var n=e.demandItemFacet(r.sharedFacet,t);return!n||!n.effectiveRoles||!n.owner}t.isOwner=h;function p(e,t){if(h(e,t))return["read","write","owner"];var n=e.demandItemFacet(r.sharedFacet,t);return n&&n.effectiveRoles?n.effectiveRoles:[]}t.getEffectiveItemRoles=p});
define("SS",["require","exports","e3","GJ","SP"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemRenameItemActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(i.canRenameFacet,n),validator:r.nameValidator}}}})});
define("SR",["require","exports","e3","SP"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDeleteItemsActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(r.canDeleteFacet,n)}}}})});
define("SQ",["require","exports","e3","SP"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemUploadItemsActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(r.canUploadFacet,n)}}}})});
define("SO",["require","exports","mU","e3","c2","DE","bv","SP","DK","cg","gV","DK"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDownloadItemsActionControlHandler=r.createControlHandler()(h);function h(){return function(e){return p}}t.getDownloadItemActionControlHandler=h;function p(e,t){if(1!==t.itemKeys.length)return{};var r=t.itemKeys[0];if(e.demandItemFacet(o.folderFacet,r))return{};var h=e.demandItemFacet(i.driveItemKeyFacet,r),p=h?s.getDriveItemUrl(h):void 0,d=h&&h.endpoint||"";return{isAvailable:e.demandItemFacet(u.canDownloadFacet,r),getDownloadData:p?function(){return(function(e){var t=this,r=e.itemUrl,i=e.endpoint;return function(o){return n.__awaiter(t,void 0,void 0,function(){var t,u,h,p;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,o(s.getRawData({url:e.itemUrl,method:"GET",qosName:"getItemDownloadUrl",endpoint:i}))];case 1:t=n.sent();if(!(u=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(r)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:u}];case 2:if((h=n.sent())instanceof a.GraphError){p=c.getErrorResolution(h,function(e,t){switch(e){case"unauthenticated":case 401:return l.authFailureErrorFacet.pack({});case"itemNotFound":case 404:return l.fileNotFoundErrorFacet.pack({});case"accessDenied":case 403:return l.accessDeniedErrorFacet.pack({});default:return l.offlineErrorFacet.pack({})}});throw new f.ItemOperationError({innerError:h,facets:p})}throw h;case 3:return[2]}})})}})({itemUrl:p,endpoint:d})}:void 0}}});
define("SN",["require","exports","mU","e3","c2","DE"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDefaultShareLinkControlHandler=r.createControlHandler()(o);function o(){return function(e){return u}}t.getDefaultShareLinkActionControlHandler=o;function u(e,t){var r=t.itemKey,o=e.demandItemFacet(i.driveItemKeyFacet,r);return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o;return n.__generator(this,function(n){switch(n.label){case 0:if(!(t=e.driveItem))return[3,2];i=s.getDriveItemUrl(t)+"/invite";return[4,r(s.getRawDataWithCache({url:i,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))];case 1:if(!(o=n.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:o.value[0].link.webUrl,scope:o.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}})({driveItem:o})}}}});
define("SM",["require","exports","e3"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemfollowItemActionControlHandler=n.createControlHandler()(function(){return function(){return function(){return{}}}})});
define("SL",["require","exports","mU","e3","c2","DE"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemPermissionGrantControlHandler=r.createControlHandler()(o);function o(){return function(e){return u}}t.getPermissionGrantActionControlHandler=o;function u(e,t){var r=t.itemKey,o=t.link,u=t.recipients,a=e.demandItemFacet(i.driveItemKeyFacet,r);return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,u,a,f,l,c,h,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:t=e.driveItem,i=e.link,o=e.recipients;if(!t||!i)throw new Error("Unable to obtain default share URL");u=t.endpoint;f=btoa(i);a="u!"+f.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");l=o.map(function(e){return{email:e}});c={recipients:l,roles:["read"]};h=u.replace("v1.0","beta");p=h+"/shares/"+a+"/permission/grant";return[4,r(s.getRawDataWithCache({url:p,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:c}))];case 1:d=n.sent();v=d.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:v}]}})})}})({driveItem:a,link:o,recipients:u})}}}});
define("SK",["require","exports","mU","iX","DE","bv","hS","el","c4","cc","iW","c2","ct"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemFollowItemOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,p=r.isFollowed,d=r.progressItemKey,v=u.driveFollowedItemKeyFacet.deserialize(t),m=v.driveItemKey,g=m.itemId,y=void 0===g?"":g;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,g,b,w,E,S,x,T;return n.__generator(this,function(N){switch(N.label){case 0:t=e(f.readConfiguration({saveForLaterGraphEndpoint:a.savedForLaterGraphEndpointConfigurationFacet})).saveForLaterGraphEndpoint;r=new o.ItemResolver;g=u.driveFollowedItemKeyFacet.serialize(v);b=t||m.endpoint;d&&e(l.resolveItems({items:(S={},S[d]=n.__assign({},h.sourceItemFacet.pack({itemKey:c.driveItemKeyFacet.serialize(m)})),S)}));w=p?{url:b+"/drives/"+m.driveId+"/items/"+y+"/follow",method:"POST",qosName:"followItem"}:{url:b+"/drives/"+m.driveId+"/following/"+y,method:"DELETE",qosName:"unfollowItem"};N.label=1;case 1:N.trys.push([1,3,,4]);return[4,e(i.getRawData({url:w.url,method:w.method,qosName:w.qosName,endpoint:b}))];case 2:N.sent();r.invalidateItems({items:(x={},x[g]=[s.isFollowedFacet],x)});r.resolveItems({items:(T={},T[g]=n.__assign({},s.isFollowedFacet.pack(p||void 0)),T)});e(r.execute());return[3,4];case 3:E=N.sent();throw new Error(E.message);case 4:return[2]}})})}})});
define("SJ",["require","exports","mU","e3","QZ","Ry"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(e,t){return s.searchItemSetKeyFacet.serialize(n.__assign(n.__assign({},{driveItemKey:e.driveItemKey}),t?{searchTerm:t}:{searchTerm:void 0}))}t.driveItemSearchControlHandler=r.createControlHandler()(u);t.searchItemSearchControlHandler=r.createControlHandler()(u);function u(){return function(e){return function(e,t){var n,r=t.itemKey,u=e.demandItemFacet(i.driveItemSetKeyFacet,r);if(u)n=function(e){return u?o(u,e):void 0};else{var a=e.demandItemFacet(s.searchItemSetKeyFacet,r);n=function(e){return a?o(a,e):void 0}}return{isAvailable:!0,getSearchItemKey:n}}}}});
define("SI",["require","exports","mU","QZ","Ry","e3","gP","gQ"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetFilteredItemSetControlHandler=s.createControlHandler()(function(){return function(e){return a}});function a(e,t){var s=t.handlers,a=t.itemKey,f=e.demandItemFacet(r.driveItemSetKeyFacet,a),l=e.demandItemFacet(i.searchItemSetKeyFacet,a);if(s&&(f||l)){for(var c=[],h=0,p=s;h<p.length;h++){var d=p[h];if(d.key===u.itemPhotoTypeFilterHandler.key)c.push("photo");else if(d.key===u.itemVideoTypeFilterHandler.key)c.push("video");else if(d.key===u.itemFolderTypeFilterHandler.key)c.push("folder");else if(d.key===u.itemOneNoteFilterHandler.key)c.push("onenote");else if(d.key===u.itemNonPhotoTypeFilterHandler.key)c.push("!photo");else if(d.key===u.itemNonVideoTypeFilterHandler.key)c.push("!video");else if(d.key===u.itemNonFolderTypeFilterHandler.key)c.push("!folder");else if(d.key===u.itemNonOneNoteFilterHandler.key)c.push("!onenote");else{var v=o.getExtensionFilterFromFilterHandler(d);v&&c.push(v)}}if(f)return{itemKey:r.driveItemSetKeyFacet.serialize(n.__assign(n.__assign({},f),{extFilters:c}))}}return{}}});
define("SH",["require","exports","mU","iX","cg","h7","i5","gV","bv","hS","c2","DE","cv","DK","cu","QX"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemMoveCopyItemsOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,m=Object.keys(r)[0];return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var g,y,b,w,E,S,x,T,N,C,k,L;return n.__generator(this,function(A){switch(A.label){case 0:if(!e(h.readItems(function(e){return e.demandItemFacet(l.driveItemKeyFacet,m)})))throw new Error("Source item does not have a driveItem key");g=r[m],y=g.isMove,b=g.conflictBehavior,w=g.progressItemKey;E=l.driveItemKeyFacet.deserialize(t);return[4,e(s.demandItems(function(e){return e.demandItemFacet(l.driveItemKeyFacet,m)}))];case 1:if(!(S=A.sent()))throw new Error("Unable to get metadata for destination item.");x=c.getDriveItemUrl(S);A.label=2;case 2:A.trys.push([2,4,,5]);return[4,e(c.getRawData({url:x+(y?"":"/copy"),method:y?"PATCH":"POST",body:{parentReference:{id:E.itemId||v.ROOT_ITEM_ID,driveId:E.driveId||""},"@microsoft.graph.conflictBehavior":b},qosName:y?"moveItem":"copyItem",endpoint:E.endpoint}))];case 3:T=A.sent();(N=new f.ItemResolver).invalidateItems({items:(k={},k[m]=y?[a.parentFolderItemFacet,a.deletedFacet]:[],k[t]=[d.defaultChildItemSetFacet],k)});w&&!y&&T.name&&N.resolveItems({items:(L={},L[w]=n.__assign({},a.displayNameFacet.pack(T.name)),L)});e(N.execute());return[3,5];case 4:if((C=A.sent())instanceof p.GraphError&&C.status===i.STATUS_CODE_ZERO)throw new o.MoveCopyItemOperationError({innerError:C,facets:n.__assign({},u.httpStatusErrorFacet.pack(C.status))});throw C;case 5:return[2]}})})}})});
define("SG",["require","exports","e3","GJ"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemCreateFolderDialogControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){return{validator:r.nameValidator}}}})});
define("SF",["require","exports","mU","cg","cv","bv","iX","c2","DL","DK","c0","DD"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveOperationHandler=o.createSingleItemOperationHandler()(function(e){var t=e.itemKey,o=e.options.itemSetKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var h,p,d,v,m,g;return n.__generator(this,function(n){switch(n.label){case 0:if(!l.sharedWithMeItemSetKeyFacet.matches(o))throw new r.ItemOperationError({code:"invalidItemSetForAddToOneDrive"});h=l.sharedWithMeItemSetKeyFacet.deserialize(o).driveItemKey.endpoint;p=e(i.readItems(function(e){return e.demandItemFacet(s.fileNameFacet,t)}));d=e(i.readItems(function(e){return e.demandItemFacet(a.sharepointIdsFacet,t)}));v=e(i.readItems(function(e){return e.demandItemFacet(u.driveItemKeyFacet,t)}));if(!(h&&p&&v&&d))throw new r.ItemOperationError({code:"missingItemInfoForAddToOneDrive"});return[4,e(c.getDriveResponse("GetDriveInfo",h))];case 1:m=n.sent();n.label=2;case 2:n.trys.push([2,4,,5]);return[4,e(c.getAddToOneDriveResponse(p.name,m.id,d,"AddToOneDrive_SWM",h))];case 3:n.sent();return[3,5];case 4:if(!((g=n.sent())instanceof f.GraphError))throw g;c.addToOneDriveErrorHandle(g);return[3,5];case 5:return[2]}})})}})});
define("Sw",["require","exports","e3","r8","rV","SD","Sx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeCommandBarControlHandler=n.createControlHandler()(function(){return function(e){return a}});t.default=t.sharedWithMeCommandBarControlHandler;var u=[r.openCommand,i.shareCommand,i.copyLinkCommand,s.addShortcutFromSharedWithMeCommand,o.removeFromSharedListCommand];function a(e,t){return{commands:u}}});
define("Sv",["require","exports","mU","e3","c0","eO","eN"],function(e,t,n,r,i,s,o){"use strict";var u;Object.defineProperty(t,"__esModule",{value:!0});var a=((u={})[o.DISPLAY_NAME_COLUMN_KEY]=!0,u[o.NAME_AND_PATH_COLUMN_KEY]=!0,u[s.SHARED_BY_COLUMN_KEY]=!0,u[s.DATE_SHARED_COLUMN_KEY]=!0,u[s.ITEM_ACTIVITY_COLUMN_KEY]=!0,u);t.sharedWithMeSortedItemSetControlHandler=r.createControlHandler()(function(){return function(e){return f}});function f(e,t){var r=t.itemSetKey,o=t.handler,u=o.columnKey,f=o.isAscending;if(!a[u])return{};var l=e.demandItemFacet(i.sharedWithMeItemSetKeyFacet,r);if(!l)return{};var c=s.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[u];return c?{newItemSetKey:i.sharedWithMeItemSetKeyFacet.serialize(n.__assign(n.__assign({},l),{sortBy:c,isAscending:f}))}:{}}});
define("Su",["require","exports","mU","c0","e3","Rw","c3"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeItemSetOpenActionControlHandler=i.createControlHandler()(function(){return function(e){return function(e,t){var i=t.itemKey,u=e.demandItemFacet(r.sharedWithMeItemSetKeyFacet,i),a=u&&u.driveItemKey.endpoint,f=a&&s.getStageItemOverride(e,{parentItemKey:o.sharedWithMeRootItemKeyFacet.serialize({endpoint:a}),stageItem:t.stageItem});return n.__assign({},f?{stageItem:f}:{})}}})});
define("St",["require","exports","mU","c0","e3","eO"],function(e,t,n,r,i,s){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0});var u=((o={})[s.SHARED_BY_COLUMN_KEY]=!0,o[s.DATE_SHARED_COLUMN_KEY]=!0,o);t.sharedWithMeGroupedItemSetControlHandler=i.createControlHandler()(function(){return function(e){return a}});function a(e,t){var i=t.itemSetKey,o=t.handler.columnKey;if(!u[o])return{};var a=e.demandItemFacet(r.sharedWithMeItemSetKeyFacet,i);if(!a)return{};var f=s.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[o];return f?{newItemSetKey:r.sharedWithMeItemSetKeyFacet.serialize(n.__assign(n.__assign({},a),{groupBy:f}))}:{}}});
define("Ss",["require","exports","mU","c0","e3"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeUngroupedItemSetControlHandler=i.createControlHandler()(function(){return function(e){return s}});function s(e,t){var i=t.itemSetKey,s=e.demandItemFacet(r.sharedWithMeItemSetKeyFacet,i);return s?{newItemSetKey:r.sharedWithMeItemSetKeyFacet.serialize(n.__assign(n.__assign({},s),{groupBy:void 0}))}:{}}});
define("Sr",["require","exports","e3"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupBySharedByOpenActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}})});
define("Sq",["require","exports","e3"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupByRelativeTimeOpenActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}})});
define("So",["require","exports","mU","hS","iX","Se","cc","c4","DE","Sp","b1","bv","gs","cu"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.peopleGetItemsOperationHandler=i.createSingleItemOperationHandler()(function(e){var t=this,i=e.itemKey;return function(d){return n.__awaiter(t,void 0,void 0,function(){var t,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(O){switch(O.label){case 0:t=new r.ItemResolver;v=d(o.readConfiguration({graphEndpoint:u.graphEndpointConfigurationFacet})).graphEndpoint;m=s.topCollaboratorSetKeyFacet.deserialize(i);g=v||m.endpoint;y=g+"/me/people/";return[4,d(a.getRawData({url:y,qosName:"getTopCollaborator",endpoint:g}))];case 1:b=O.sent();w=[];for(E=0,S=b.value;E<S.length;E++){x=S[E];T=x.id,N=x.displayName,C=x.userPrincipalName;k=f.topCollaboratorItemKeyFacet.serialize({id:T});d(l.resolveItems({items:(L={},L[k]=n.__assign(n.__assign({},c.displayNameFacet.pack(N)),h.emailFacet.pack(C)),L)}));w.push(k)}t.resolveItems({items:(A={},A[e.itemKey]=n.__assign({},p.childItemsFacet.pack({itemKeys:w})),A)});d(t.execute());return[2]}})})}})});
define("Sp",["require","exports","F"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.topCollaboratorItemKeyFacet=new n.KeyFacet("topCollaboratorItemKeyFacet",{id:n.stringPart()})});
define("S4",["require","exports","mU","iX","iW","iV","c4","hS","iU","N","ay","H","GD","bv","DZ","hH","ft","i1","cc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function b(e){var t=e.itemKey,r=e.driveItem;return function(e){var i,s;e(h.sharePointItemByFullUrlAddon);var o=e(y.readConfiguration({enableSharePointItemMapping:g.enableSharePointItemMappingConfigurationFacet})).enableSharePointItemMapping,v=void 0===o||o,m=new u.ItemResolver,b=r.webDavUrl||r.remoteItem&&r.remoteItem.webDavUrl||r.webUrl,w=b&&decodeURIComponent(b);if(w){var E={itemFullUrl:w},S=d.getParentItemUrl(w),x={itemFullUrl:S},T=a.spItemFullUrlKeyFacet.serialize(E),N=a.spItemFullUrlKeyFacet.serialize(x);m.mapKeys({mappings:(i={},i[T]=t,i)});m.resolveItems({items:(s={},s[T]=n.__assign(n.__assign({},v?n.__assign({},c.pack({preferredKeyFacet:f.preferredKeyFacetFacet},{preferredKeyFacet:new l.IfNotMatchPatch(a.spItemFullUrlKeyFacet,function(e){return e===a.spItemKeyFacet})})):{}),p.parentFolderItemFacet.pack({itemKey:N})),s[N]=n.__assign(n.__assign(n.__assign({},p.folderFacet.pack({})),p.canonicalUrlFacet.pack(S)),p.openUrlFacet.pack(encodeURI(S))),s)})}return{itemResolver:m}}}function w(e){var t=this,r=v.getStaticApiUrl({webAbsoluteUrl:e}).segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");return function(i){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,i(m.getData({url:r.toString(),qosName:"GetMyOneDriveUrl",method:"POST",webAbsoluteUrl:e,noRedirect:!0}))];case 1:return[2,t.sent().d.mySite.replace(/\/$/,"")||""]}})})}}t.sharePointGraphAddon=r.createAddon(function(){return function(e){var t;e(i.resolveItems({items:(t={},t[s.configurationItemKey]=n.__assign(n.__assign({},o.processDriveItemFromSharePointFacet.pack({process:b})),o.getUserOneDriveEndpointFacet.pack({getUserOneDriveEndpoint:w})),t)}))}})});
define("S5",["require","exports","mU","iX","hS","h7","bv","cu","bc","S6","DE","DH","hR","xr","c4","cc","gH","fv","W"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileHandlerGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,s=h.driveAppsKeyFacet.deserialize(r),o=s.endpoint,u=s.driveId;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,s,E,S,x,T,N,C,k,L;return n.__generator(this,function(A){switch(A.label){case 0:t=e(g.logQoS({name:"getFileHandlersOperation"}));s={endpoint:o};E=e(v.readConfiguration({getUserOneDriveEndpoint:d.getUserOneDriveEndpointFacet,useOneDriveEndpoint:d.userOneDriveEndpointForFileHandlerConfigurationFacet})),S=E.getUserOneDriveEndpoint,x=E.useOneDriveEndpoint;T=o;if(!S||!x)return[3,2];N=new m.SimpleUri(o).authority;C=m.SimpleUri.bind;return[4,e(S.getUserOneDriveEndpoint(N))];case 1:T=(new(C.apply(m.SimpleUri,[void 0,A.sent()]))).authority+"/_api/v2.0";A.label=2;case 2:k=new f.default({},{dataRequestor:e(l.getDataRequestor).dataRequestor});s.fileHandlerRequestEndpoint=T;return[4,e(c.getSessionToken(T))];case 3:L=A.sent();s.accessTokenObtained=!0;return[2,k.getFileHandlerData({accessToken:L,endpoint:T,includePromotedApp:!0,driveId:u}).done(function(u){var a;if(u){var f=u.actions,l=u.preferences,c=u.version,d=new i.ItemResolver,v=(function(e,t){var n={};["custom","create","open","preview"].forEach(function(r){var i=b(e,t[r],r);n[r]=i});return n})(d,f),m=(function(e,t){for(var r,s=new i.ItemResolver,o=0,u=Object.keys(e);o<u.length;o++){var a=u[o],f=e[a],l={};l.open=b(s,f.open,"open",a);l.preview=b(s,f.preview,"preview",a);for(var c=(f.open||[]).concat(f.preview||[]),d=void 0,v=0;v<c.length;v++){var m=c[v],g=m.handler,y=m&&w(m.icon)||g&&w(g.fileTypeIcon),E=g.fileTypeDisplayName||g.displayName;if(y){d={displayName:E,url:y};break}}var S=h.driveAppsExtensionKeyFacet.serialize({endpoint:t,extension:a});s.resolveItems({items:(r={},r[S]=n.__assign(n.__assign({},p.fileHandlerActionsFacet.pack(l)),p.fileHandlerFileTypeIconFacet.pack(d)),r)})}return{preferencesItemResolver:s}})(l,o).preferencesItemResolver;d.merge(m);d.resolveItems({items:(a={},a[r]=n.__assign(n.__assign({},p.fileHandlerActionsFacet.pack(v)),p.fileHandlerVersionFacet.pack(c)),a)});e(d.execute());e(t({resultType:y.ResultTypeEnum.Success,extraData:s}))}},function(n){a.default.logError(n);e(t({resultType:y.ResultTypeEnum.Failure,extraData:s}))})]}})})}});t.filehandlerPerExtensionGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,i=h.driveAppsExtensionKeyFacet.deserialize(r).endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:t=h.driveAppsKeyFacet.serialize({endpoint:i});return[4,e(s.demandItems(function(e){return e.demandItemFacet(p.fileHandlerActionsFacet,t)}))];case 1:n.sent();return[2]}})})}});function b(e,t,r,i){var s,a=[];t.forEach(function(t){var r,i=t.handler,s=h.fileHandlerKeyFacet.serialize({id:i.id,appId:i.appId}),u=h.fileHandlerActionKeyFacet.serialize({handlerId:i.id,appId:i.appId,id:t.id||0}),f={displayName:i.actionMenuDisplayName,url:w(i.appIcon)},l={displayName:i.fileTypeDisplayName||i.displayName,url:w(t.icon||i.fileTypeIcon)};e.resolveItems({items:(r={},r[s]=n.__assign(n.__assign({},o.displayNameFacet.pack(i.actionMenuDisplayName||i.displayName)),p.fileHandlerAppIconFacet.pack(f)),r[u]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},o.displayNameFacet.pack(t.displayName||i.displayName)),o.openUrlFacet.pack(t.url)),p.fileHandlerActionAvailableOnFacet.pack(t.availableOn)),p.fileHandlerKeyFacetFacet.pack(s)),p.fileHandlerFileTypeIconFacet.pack(l)),p.fileHandlerAppIdFacet.pack(i.appId)),void 0!==i.isPromoted?n.__assign({},p.fileHandlerIsPromotedFacet.pack(i.isPromoted)):{}),r)});-1===a.indexOf(u)&&a.push(u)});var f=h.fileHandlerActionSetKeyFacet.serialize({type:r,extension:i});e.resolveItems({items:(s={},s[f]=n.__assign({},u.childItemsFacet.pack({itemKeys:a})),s)});return f}function w(e){var t=window.devicePixelRatio||1;return e&&(e.svg||t>=1.75&&e.png2x||t>=1.25&&e.png1_5x||e.png1x)}});
define("S6",["require","exports","dj"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return!!e.fileHandler}function i(e){return r(e)&&!!e.promoted}var s=/^(?:data|blob|javascript):/i,o=/^(?:data|http|https):/i;function u(e){return!s.test(e)}var a={svg:!0,png1x:!0,png1_5x:!0,png2x:!0};function f(e){var t,n;if(e)for(var r in e)if(a.hasOwnProperty(r)){var i=(n=e[r])&&o.test(n)?n:void 0;if(i){t||(t={});t[r]=i}}return t}function l(e){return{file:e.file,folder:e.folder,allowMultiSelect:e.allowMultiSelect}}var c=(function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.getFileHandlerData=function(e){var t=e||{},s=t.language,o=void 0===s?n.default.language:s,a=t.accessToken,c=void 0===a?void 0:a,h=t.endpoint,p=void 0===h?"":h,d=t.includePromotedApp,v=void 0!==d&&d,m=t.driveId,g=void 0===m?void 0:m,y=p+"/drive";g&&(y="me"===g?p+"/me/drive":p+"/drives/"+g);return this._dataRequestor.send({path:y+"/apps?"+(v?"select=*,promoted&":"")+"$expand=actions",apiName:"GetDriveApps",headers:{"Accept-Language":o},accessToken:c,useAuthorizationHeaders:!!c}).then(function(e){for(var t={custom:[],create:[],open:[],preview:[]},n={},s=0,o=e.value;s<o.length;s++){var a=o[s];if(r(a)){var c=v?i(a):void 0,h=a.application,p=a.id,d=a.actions,m=a.fileHandler;if(d){var g=m.fileTypeDisplayName,y=m.fileTypeIconUrl,b=m.version;if(b)for(var w={id:p,appId:h.id,actionMenuDisplayName:m.actionMenuDisplayName,displayName:h.displayName,appIcon:f(m.appIcon),version:b,fileTypeDisplayName:g,fileTypeIcon:f(m.fileTypeIcon||{png1x:y}),isPromoted:c},E=0,S=0,x=d;S<x.length;S++){var T=x[S],N=T.url;if(N&&u(N)){var C=T.displayName,k=T.shortDisplayName,L=T.icon,A=T.availableOn;if(A){var O="newFile"===T.type?"create":T.type,M={type:O,url:N,displayName:C,icon:f(L),availableOn:l(A),handler:w,id:E},_=A.file,D=_&&_.extensions;switch(O){case"custom":if(!C)continue;M.shortDisplayName=k;if(!_&&!A.folder)continue;break;case"create":if(!D||!D[0])continue;break;case"open":case"preview":if(!_)continue;if(D&&!c)for(var P=0,H=D;P<H.length;P++){var B=H[P];(n[B]||(n[B]={open:[],preview:[]}))[O].push(M)}break;default:continue}t[O].push(M);E++}}}}}}return{actions:t,preferences:n,version:4}})};return e})();t.default=c});
define("S7",["require","exports","mU","c2","mG","cv","Qm","Qt","hT","aM"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new a.ResourceKey({name:e("module").id,factory:{dependencies:{vroomUrlHelper:u.resourceKey,authTokenFetcher:o.resourceKey,graphDataSource:f.graph},create:function(e){var t=e.vroomUrlHelper,o=e.authTokenFetcher,u=e.graphDataSource;return{instance:function(e,a,f){var l=this;return function(e){return n.__awaiter(l,void 0,void 0,function(){var l,c,h,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:l=f&&t.getUrlParts(f);c=r.driveItemKeyFacet.serialize({endpoint:a,driveId:l&&l.driveId,itemId:"root"});h=e(s.readItems(function(e){return e.demandItemFacet(i.knockoutStoreItemFacet,c)}));return(p=h&&h.peek())?[4,o.ensureAuthToken(p.key)]:[3,3];case 1:n.sent();d=f&&f.indexOf("/v2.1")>-1;return[4,u.getAccessToken(p,{apiVersion:d?"v2.1":"V2.0"})];case 2:if(v=n.sent())return[2,v.accessToken];n.label=3;case 3:return[2]}})})}}}}}})});
define('OneDriveLightspeedGraphAddonDeferred_mini_css',["jh","Aa"],function(e){"use strict";e.loadStyles([{"rawString":".root_3c8ca8be{margin-top:15px;margin-bottom:15px;font-size:17px}[dir='ltr'] .root_3c8ca8be{margin-left:96px}[dir='rtl'] .root_3c8ca8be{margin-right:96px}\n"},{"rawString":".topCollaPlaceHolder_daf3bef4{display:-webkit-box;display:-ms-flexbox;display:flex;min-width:13px;height:21px;padding-right:10px}.topCollaboratorIcon_daf3bef4{color:#0078d4;font-size:13px;line-height:21px;text-align:center}.topCollaboratorUserName_daf3bef4{font-weight:700}.topCollaboratorTooltip_daf3bef4{padding:0 2px}.userWithTopCollaborator_daf3bef4{display:-webkit-box;display:-ms-flexbox;display:flex}.userWithTopCollaborator_daf3bef4 .topCollaPlaceHolder_daf3bef4{padding-right:7px;min-width:13px}\n"}]);return {GroupItemDetailsHeader_0:{root:'root_3c8ca8be'},TopCollaborator_8:{topCollaPlaceHolder:'topCollaPlaceHolder_daf3bef4',topCollaboratorIcon:'topCollaboratorIcon_daf3bef4',topCollaboratorUserName:'topCollaboratorUserName_daf3bef4',topCollaboratorTooltip:'topCollaboratorTooltip_daf3bef4',userWithTopCollaborator:'userWithTopCollaborator_daf3bef4'}}});