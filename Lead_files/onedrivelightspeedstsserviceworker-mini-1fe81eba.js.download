define("a2e",["require","exports","Kt","mx","dg","W","co"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=new o.Signal;t.registerServiceWorker=function(e){var t=e&&e.isSafari;if("serviceWorker"in navigator&&!t){var o=(function(){var e,t=new i.default("/_layouts/15/odspserviceworkerproxy.aspx"),r=("dev"===window._spModuleLink.buildNumber||(function(){var e=!1;if(window._spModuleLink.libraries){var t=window._spModuleLink.libraries;e=t.some(function(e){if("dev"===e.buildNumber)return!0})}return e})()||document.cookie.indexOf("srr=")>=0||document.cookie.indexOf("devmode=true")>=0)&&!(function(){try{if("sessionStorage"in window){var e=window.sessionStorage.enableServiceWorkerDebugging;return e&&"true"===e.toLowerCase()}}catch(e){}return!1})();e=n.isFeatureEnabled(n.ServiceWorkerListController)?{swManifestName:"spserviceworker",applications:JSON.stringify([{id:"STS",swPrefetchManifestName:"stsserviceworkerprefetch"}]),bypass:r}:{swManifestName:"stsserviceworker",swPrefetchManifestName:"stsserviceworkerprefetch",bypass:r};t.setQueryFromObject(e);return t.toString()})(),f=r.default.isActivated("68B7BD4C-257E-41AA-8905-2BF4927174F8","02/12/2020","page and script service worker");if(n.isFeatureEnabled(n.ODSPServiceWorker)&&!f){var l=new s.Qos({name:"STSServiceWorker.register"});return navigator.serviceWorker.register(o,{updateViaCache:"none",scope:"/"}).then(function(e){console.log(Math.round(performance.now())+" Registration successful, scope is: ",e.scope);l.end({resultType:s.ResultTypeEnum.Success});if(navigator.serviceWorker.controller&&["activating","activated","redundant"].indexOf(navigator.serviceWorker.controller.state)>=0)return Promise.resolve();navigator.serviceWorker.addEventListener("controllerchange",function(){var e=navigator.serviceWorker.controller;console.log(Math.round(performance.now())+" in controllerchange: ",e&&e.state);e&&"activating"===e.state&&u.resolve()});return u.promise}).catch(function(e){console.log("Registration failed, err is:",e);l.end({resultType:s.ResultTypeEnum.Failure,error:e})})}return a({shouldUnregister:function(e){var t=e&&e.active;return t&&t.scriptURL===o&&"activated"===t.state},qosName:"STSServiceWorker.unregister"})}return Promise.resolve()};function a(e){if("serviceWorker"in navigator){var t=e.shouldUnregister,n=e.qosName;return navigator.serviceWorker.getRegistrations().then(function(e){for(var r=Promise.resolve(),i=function(e){if(t(e)){var i=new s.Qos({name:n});r=e.unregister().then(function(e){console.log("unregister service worker, result: "+e+".");e?i.end({resultType:s.ResultTypeEnum.Success}):i.end({resultType:s.ResultTypeEnum.Failure})});return"break"}},o=0,u=e;o<u.length;o++){if("break"===i(u[o]))break}return r})}return Promise.resolve()}t.unregisterServiceWorker=a});