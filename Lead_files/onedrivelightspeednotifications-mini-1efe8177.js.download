define("a1Y",["require","exports","abb","a0K","a2a","a15","a14","a1Z"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});
define("a2a",["require","exports","mU","a","Kl","dQ","hT","a2b"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var i=e.call(this,t,n)||this;i.handledNotifications={};i._notifications=r.observableArray([]);i._platformDetection=n.platformDetection;i.currentNotification=i.createComputed(function(){var e=i._notifications();return e.length&&e.sort(function(e,t){return e.severity===t.severity?0:e.severity>t.severity?-1:1})[0]||null});return i}t.prototype.requestNotification=function(e){var t=this,n=new u.default(e);if(!this._platformDetection.isIE||this._platformDetection.browserMajor>9){this._notifications.push(n);var r=function(){t._notifications.remove(n)};n.wait().then(r,r)}return n};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{platformDetection:s.platformDetection});return t})(i.default);t.NotificationProvider=a;t.resourceKey=o.createResolvedResourceKey(e("module").id,a)});
define("a2b",["require","exports","mU","bk","Kl"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,{})||this;n.text=t.text||"";n.severity=t.severity||1;n.dismissalType=t.dismissalType||2;n.timeout=t.timeout||0;n.action=t.action;n.actionText=t.actionText||"";n.isOpen=n.createObservable(!0);n.state=n.createObservable(1);n.canImplicitDismiss=2===n.dismissalType||3===n.dismissalType;n.showCloseButton=4!==n.dismissalType;var i=new r.default;n.createComputed(function(){var e=n.state();1!==e&&(2===e?i.complete(2):i.cancel())});n._promise=i.getPromise();return n}t.prototype.complete=function(){this.isOpen(!1);this.state(2)};t.prototype.dismiss=function(){this.isOpen(!1);this.state(3)};t.prototype.wait=function(){return this._promise};return t})(i.default);t.default=s});
define("a15",["require","exports","hT","a19","a18","a17","a16"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){}e.prototype.loadGlobalHandlers=function(e){e(r.default);e(i.default);e(s.default);e(o.default)};e.prototype.loadPageHandlers=function(e){};return e})();t.default=u;t.resourceKey=n.createResolvedResourceKey(e("module").id,u,{})});
define("a19",["require","exports","mU","Kl","aV","Ya"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.types=[201];n._notifications=n.resources.consume(i.notification);n._siteProvider=n.resources.consume(i.site);n.createComputed(n._computeShowNotification);return n}t.prototype.handleNotification=function(e){e&&this.showNotification()};t.prototype.showNotification=function(e){return void 0===e||0===e?this._notifications.requestNotification({text:s.default.oneDriveIsReadOnly,severity:2,dismissalType:4}):1===e?this._notifications.requestNotification({text:s.default.siteIsMoving,severity:2,dismissalType:4}):2===e?this._notifications.requestNotification({text:s.default.siteMoveComplete,severity:2,dismissalType:4}):void 0};t.prototype._computeShowNotification=function(){this._siteProvider.isReadOnly()&&(-2===this._siteProvider.readOnlyState()?this.showNotification():this.showNotification(this._siteProvider.readOnlyState()))};return t})(r.default);t.default=o});
define("a18",["require","exports","mU","Kl","aV","TD","Ya","dh","Kt","iP"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.types=[204];if(a.isFeatureEnabled(a.UserExpirationPanel)){n._pageContext=n.resources.consume(f.pageContext);if(n._pageContext.isSiteAdmin){n._notifications=n.resources.consume(i.notification);n._userExpirationProvider=n.resources.consume(i.userExpiration);n.createComputed(n._computeShowNotification)}}return n}t.prototype.handleNotification=function(e){e&&this.showNotification()};t.prototype.showNotification=function(e){void 0===e&&(e=1);var t=new(this.managed(s.default))({});return this._notifications.requestNotification({text:u.formatWithLocalizedCountValue(o.default.expiringUser,o.default.expiringUserIntervals,e),severity:2,dismissalType:1,action:t,actionText:o.default.manageUserExpiration})};t.prototype._computeShowNotification=function(){this._userExpirationProvider.expiringUserCount()>0&&this.showNotification(this._userExpirationProvider.expiringUserCount())};return t})(r.default);t.default=l});
define("a17",["require","exports","mU","Kl","cV","aV","iP","Ya"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.types=[202];n._notifications=n.resources.consume(s.notification);n._pageContext=n.resources.consume(o.pageContext);(n._pageContext.viewOnlyExperienceEnabled||n._pageContext.blockDownloadsExperienceEnabled)&&n.showNotification();return n}t.prototype.handleNotification=function(e){e&&this.showNotification()};t.prototype.showNotification=function(){var e=this.resources.consume(i.actionMap),t=new(this.managed(e.NavigationAction))({url:"https://go.microsoft.com/fwlink/p/?LinkId=823640",target:"_blank"});return this._notifications.requestNotification({text:u.default.authenticationPolicyActive,severity:2,dismissalType:4,action:t,actionText:u.default.authenticationPolicyMoreInfo})};return t})(r.default);t.default=a});
define("a16",["require","exports","mU","Kl","cV","Kt","aV","iP","Ya"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.types=[203];if(s.isFeatureEnabled(s.UnauthorizedTenantBannerFeature)){n._notifications=n.resources.consume(o.notification);n._pageContext=n.resources.consume(u.pageContext);n._pageContext.isUnauthorizedTenant&&n.showNotification()}return n}t.prototype.handleNotification=function(e){e&&this.showNotification()};t.prototype.showNotification=function(){var e=this.resources.consume(i.actionMap),t=new(this.managed(e.NavigationAction))({url:"https://go.microsoft.com/fwlink/?linkid=2092321",target:"_blank"});return this._notifications.requestNotification({text:a.default.unauthorizedTenantActive,severity:3,dismissalType:4,action:t,actionText:a.default.unauthorizedTenantMoreInfo})};return t})(r.default);t.default=f});
define("a14",["require","exports","mU","a","Kl","dQ","hT","VA","aV","aM"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});0;var l=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._isFirstProcess=!0;if(!n.userInfoProvider.isAuthenticated())return r;if(n.platformDetection.isMobile)return r;var i=n.userInfoStore;r._userInfo=i.getUserInfo();r._handlers={};r._notifications=n.notifications;r._notificationProvider=n.notificationProvider;r._notifications.loadGlobalHandlers(r._getLoader());r.createComputed(r._computeProcessNotifications);r.createComputed(r._computeProcessTriggeredNotifications);return r}t.triggerNotification=function(e){this._triggeredNotifications.push(e)};t.prototype.createNotificationHandlers=function(e){this._notifications.loadPageHandlers(this._getLoader(e))};t.prototype._getLoader=function(e){var t=this;return function(n){for(var r=e?e(n):new(t.managed(n)),i=0,s=r.types;i<s.length;i++){var o=s[i];t._handlers[o]=r}t._isFirstProcess||t._processHandler(r)}};t.prototype._processHandler=function(e){var t=this._userInfo();if(t){for(var n={},r=0,i=e.types;r<i.length;r++){n[i[r]]=!0}if(t&&t.notifications)for(var s=0,o=t.notifications;s<o.length;s++){var u=o[s];n[u.type]&&this._shouldShowNotification(u,!1)&&this._handleNotification(u)}}};t.prototype._computeProcessNotifications=function(){var e=this._userInfo();if(e&&e.notifications){for(var t=0,n=e.notifications;t<n.length;t++){var r=n[t];this._shouldShowNotification(r,this._isFirstProcess)&&this._handleNotification(r)}this._isFirstProcess=!1}};t.prototype._computeProcessTriggeredNotifications=function(){for(var e=t._triggeredNotifications(),n=0;n<e.length;n++){var r=this._handlers[e[n]];if(r){r.showNotification();e.splice(n--,1)}}t._triggeredNotifications(e)};t.prototype._shouldShowNotification=function(e,t){return!(!e||!e.id&&t)&&(!this._notificationProvider.handledNotifications[e.id]&&!this._isExpired(e))};t.prototype._isExpired=function(e){if(e.id&&e.expiryDateTime){var t=new Date(e.expiryDateTime);if((new Date).getTime()>t.getTime()){this._notificationProvider.handledNotifications[e.id]=!0;return!0}}if(e.id&&e.expiryDate){t=new Date(e.expiryDate);if((new Date).getTime()>t.getTime()+864e5){this._notificationProvider.handledNotifications[e.id]=!0;return!0}}return!1};t.prototype._handleNotification=function(e){var t=this._handlers[e.type];if(!t)return!1;t.handleNotification(e);e.id&&(this._notificationProvider.handledNotifications[e.id]=!0);return!0};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{platformDetection:s.platformDetection,userInfoStore:u.userInfoStore,userInfoProvider:a.userInfo,notifications:f.notifications,notificationProvider:a.notification});t._triggeredNotifications=r.observableArray();return t})(i.default);t.default=l;t.resourceKey=o.createResolvedResourceKey(e("module").id,l)});
define("a1Z",["require","exports","a12","MY","a11","OneDriveLightspeedNotifications_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-notification-host",name:e("module").id,template:i.default,viewModelType:n.default})});
define("a12",["require","exports","mU","jm","ML","a13","Pw","aV"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.addBindingHandlers({dismiss:o.default});r.closeText=s.default.Close;r.notification=n.notificationProvider.currentNotification;r.severityClass=r.createComputed(r._computeSeverityClass);r.iconClass=r.createComputed(r._computeIconClass);return r}t.prototype.dismiss=function(){var e=this.notification.peek();if(e&&e.canImplicitDismiss){e.dismiss();return!1}return!0};t.prototype.close=function(){var e=this.notification.peek();if(e&&e.showCloseButton){e.complete();return!1}return!0};t.prototype.onButtonClick=function(e,t){if(e&&e.action){e.action.execute(t);e.dismiss()}};t.prototype._computeSeverityClass=function(){var e=this.notification();switch(e?e.severity:1){default:case 1:return"od-MessageBar--info";case 5:return"od-MessageBar--remove";case 4:return"od-MessageBar--error";case 3:return"od-MessageBar--severeWarning";case 2:return"od-MessageBar--warning";case 0:return"od-MessageBar--success"}};t.prototype._computeIconClass=function(){var e=this.notification();switch(e?e.severity:1){default:case 1:case 2:return r.getIconClassName("Info");case 5:return r.getIconClassName("Blocked2");case 4:return r.getIconClassName("ErrorBadge");case 3:return r.getIconClassName("Warning");case 0:return r.getIconClassName("Success")}};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{notificationProvider:u.notification,notificationManager:u.notificationManager});return t})(i.default);t.default=a});
define("a11",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="NotificationHost">\x3c!--ko with:notification--\x3e<div class="od-Notification" role="alert" data-bind="css:{\'od-Notification--canClose\':showCloseButton},dismiss:{isAutomatic:!!timeout,timeout:timeout,isOpen:isOpen,close:$component.dismiss.bind($component)}"><div class="od-Notification-content"><div class="od-MessageBar" data-bind="class:$component.severityClass"><div class="od-MessageBar-content"><div class="od-MessageBar-icon"><i class="ms-Icon" data-bind="class:$component.iconClass"></i></div><div class="od-MessageBar-text"><span data-bind="text:text"></span>\x3c!--ko if:action--\x3e<a class="od-Notification-link od-Link" href="javascript:;" data-bind="text:actionText,click:$component.onButtonClick.bind($component)"></a>\x3c!--/ko--\x3e</div></div></div></div>\x3c!--ko if:showCloseButton--\x3e<button class="od-Notification-close" data-bind="attr:{\'aria-label\':$parent.closeText,title:$parent.closeText},click:$component.close.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});
define("a2c",["require","exports","f","M3","MY","a1Z","sV"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.KnockoutNotificationHost=function(e){var t=n.useState(function(){return i.toSpecification(s.resourceKey,{})})[0];return n.createElement(o.WithKnockoutResourceScope,null,n.createElement(r.default,{specification:t}))}});
define('OneDriveLightspeedNotifications_mini_css',["jh","Aa"],function(e){"use strict";e.loadStyles([{"rawString":".od-MessageBar{padding:8px;display:table;background-color:"},{"theme":"infoBackground","defaultValue":"#f4f4f4"},{"rawString":"}.od-MessageBar-icon,.od-MessageBar-text{display:table-cell;vertical-align:top}.od-MessageBar-icon{padding-right:8px;font-size:16px;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}.od-MessageBar-text{font-size:12px;font-weight:400}.od-MessageBar.od-MessageBar--warning{background-color:"},{"theme":"warningBackground","defaultValue":"#fff4ce"},{"rawString":"}.od-MessageBar.od-MessageBar--severeWarning{background-color:"},{"theme":"severeWarningBackground","defaultValue":"#fed9cc"},{"rawString":"}.od-MessageBar.od-MessageBar--severeWarning .od-MessageBar-icon{color:"},{"theme":"severeWarning","defaultValue":"#a80000"},{"rawString":"}.od-MessageBar.od-MessageBar--error{background-color:"},{"theme":"errorBackground","defaultValue":"rgba(232,17,35,.2)"},{"rawString":"}.od-MessageBar.od-MessageBar--error .od-MessageBar-icon{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":"}.od-MessageBar.od-MessageBar--remove{background-color:"},{"theme":"errorBackground","defaultValue":"rgba(232,17,35,.2)"},{"rawString":"}.od-MessageBar.od-MessageBar--remove .od-MessageBar-icon{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":"}.od-MessageBar.od-MessageBar--remove .ms-Icon{font-size:8px;margin-left:3px}.od-MessageBar.od-MessageBar--success{background-color:"},{"theme":"successBackground","defaultValue":"#dff6dd"},{"rawString":"}.od-MessageBar.od-MessageBar--success .od-MessageBar-icon{color:"},{"theme":"green","defaultValue":"#107c10"},{"rawString":"}.od-MessageBar.od-MessageBar--success .ms-Icon{font-size:12px;top:3px}.od-MessageBar.od-MessageBar--success .ms-Icon:before{margin-left:1px}.od-MessageBar.od-MessageBar--success .ms-Icon:after{font-size:8px;margin-left:3px;top:1px}.NotificationHost{position:relative}.od-Notification-close{font-size:12px;width:40px;cursor:pointer;border:none;background-color:transparent;position:absolute;top:0;bottom:0;padding-top:4px}[dir=ltr] .od-Notification-close{right:0}[dir=rtl] .od-Notification-close{left:0}.od-Notification{width:100%}.od-Notification .od-MessageBar{width:100%;padding:0}.od-Notification .od-MessageBar-content{padding:8px}.od-Notification .od-MessageBar-text{vertical-align:middle;cursor:default}.od-Notification .od-MessageBar-icon .ms-Icon--Info{display:block}[dir=ltr] .od-Notification--canClose .od-MessageBar .od-MessageBar-content{padding-right:40px}[dir=rtl] .od-Notification--canClose .od-MessageBar .od-MessageBar-content{padding-left:40px}.od-Notification .od-MessageBar--info{background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-Notification-link{white-space:nowrap}[dir=ltr] .od-Notification-link{padding-left:4px}[dir=rtl] .od-Notification-link{padding-right:4px}"}]);});