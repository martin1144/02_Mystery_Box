define("P8",["require","exports","mU","Qh","Qe","P9"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.itemActivitiesResultProcessorKey=i.resourceKey;t.ItemActivitiesService=s.ItemActivitiesService;t.itemActivitiesServiceKey=s.resourceKey});
define("Qh",["require","exports","Qj","Qf","Qi"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemActivityType=n.ItemActivityType;t.matchActivity=n.matchActivity;t.ItemActivitiesResultProcessor=r.default;t.ItemActivitiesService=i.default});
define("Qj",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.edit=0]="edit";e[e.move=1]="move";e[e.comment=2]="comment";e[e.commentResponse=3]="commentResponse";e[e.mention=4]="mention";e[e.version=5]="version";e[e.restore=6]="restore";e[e.restoreVersion=7]="restoreVersion";e[e.pointInTimeRestore=8]="pointInTimeRestore";e[e.rename=9]="rename";e[e.delete=10]="delete";e[e.create=11]="create";e[e.share=12]="share";e[e.copy=13]="copy";e[e.unknown=14]="unknown"})(t.ItemActivityType||(t.ItemActivityType={}));(function(e){e[e.getComments=0]="getComments";e[e.addComment=1]="addComment"})(t.ItemCommentsOperation||(t.ItemCommentsOperation={}));t.matchActivity=function(e){return function(t){return 2===t.type?e.Comment(t):3===t.type?e.CommentResponse(t):11===t.type?e.Create(t):10===t.type?e.Delete(t):0===t.type?e.Edit(t):4===t.type?e.Mention(t):1===t.type?e.Move(t):8===t.type?e.PointInTimeRestore(t):9===t.type?e.Rename(t):6===t.type?e.Restore(t):7===t.type?e.RestoreVersion(t):12===t.type?e.Share(t):5===t.type?e.Version(t):13===t.type?e.Copy(t):e.Unknown(t)}}});
define("Qf",["require","exports","Qg","dg"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}e.prototype.processResponse=function(e){var t=this,r=e.item,i=e.response;return{isPlaceholder:!1,activities:i.value.map(function(e){if(n.isOdcActivity(e)&&(n.isCommentActivity(e)||n.isCommentResponseActivity(e))){var i=n.getAction(e).comment;(i.contentId||i.navigationId)&&(e.docDetails={contentId:i.contentId,navigationId:i.navigationId})}return t._processActivityResponse(r,e)}),nextRequestToken:this._getNextRequestToken(i),success:!0}};e.prototype.processActivitiesByIntervalResponse=function(e){var t=this;return{activitiesByInterval:e.value.map(function(e){return t._processActivitySummaryResponse(e)}),success:!0}};e.prototype._processActivitySummaryResponse=function(e){return{totalCount:(void 0!==e.create?e.create.actionCount:0)+(void 0!==e.delete?e.delete.actionCount:0)+(void 0!==e.edit?e.edit.actionCount:0)+(void 0!==e.move?e.move.actionCount:0)+(void 0!==e.rename?e.rename.actionCount:0)+(void 0!==e.restore?e.restore.actionCount:0)+(void 0!==e.copy?e.copy.actionCount:0),startDateTime:new Date(e.startDateTime),endDateTime:new Date(e.endDateTime)}};e.prototype._getNextRequestToken=function(e){if(e.value&&!(e.value.length<1)){var t=e["@odata.nextLink"],n=t&&t.match(/skiptoken=([^&]+)/i);return n?n[1]:void 0}};e.prototype._processActivityResponse=function(e,t){var r=this._getItem(e,t),i=this._getParentItem(t),s=this._getAction(e,r,i,t);if(n.isOdcActivity(t)){var o=t.actor&&t.actor.user,u=o&&{displayName:o.displayName,id:o.id,email:o.email,self:o.self};return{id:t.id,type:this._getActivityType(t),actors:u?[u]:[],item:r,parentItem:i,time:new Date(t.activityDateTime),action:s}}var a=t.actor&&t.actor.user,f=a&&{displayName:a.displayName,email:a.email,self:a.self,userPrincipalName:a.userPrincipalName};return{id:t.id,type:this._getActivityType(t),actors:[f],item:r,parentItem:i,time:t.times.recordedTime?new Date(t.times.recordedTime):new Date(t.times.recordedDateTime),friendlyDisplayTime:t["@sharePoint.localizedRelativeTime"],action:s}};e.prototype._getActivityType=function(e){return n.matchActivity({Comment:function(){return 2},CommentResponse:function(){return 3},Create:function(){return 11},Delete:function(){return 10},Edit:function(){return 0},Mention:function(){return 4},Move:function(){return 1},Rename:function(){return 9},Restore:function(){return 6},RestoreVersion:function(){return 7},PointInTimeRestore:function(){return 8},Share:function(){return 12},Version:function(){return 5},Copy:function(){return 13}})(e)};e.prototype._getItem=function(e,t){var r=n.getItem(t);if(n.isMoveActivity(t)){if(n.isOdbActivity(t)){var i=n.getAction(t).move;if(i&&i.to)return{name:this._getFileNameFromPath(i.to),isRoot:this._isRootItem(i.to),graphItemUrl:void 0,relativePath:void 0,absolutePath:i.to}}}else if(n.isDeleteActivity(t)&&n.isOdbActivity(t)){var s=n.getAction(t).delete;if(s&&s.name){var o=(a=(u=r&&r.parentReference)&&this._getRelativePathFromVroomPath(u.path))&&r&&a+"/"+r.name+"/"+s.name;return{name:s.name,isRoot:this._isRootItem(s.name),graphItemUrl:void 0,relativePath:o,absolutePath:void 0,isFolder:"Folder"===s.objectType}}}if(r){t.docDetails&&(r.webUrl=this._getNavLink(r,t.docDetails));var u,a;o=(a=(u=r&&(r.parentReference||r.remoteItem&&r.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(u.path))&&a+"/"+r.name;return n.isDeleteActivity(t)?{name:r.name,isRoot:this._isRootItem(r.name),graphItemUrl:void 0,relativePath:o,absolutePath:void 0}:{name:r.name,isRoot:this._isRootItem(r.name),graphItemUrl:u&&"/drives/"+u.driveId+"/items/"+r.id,relativePath:o,absolutePath:void 0,driveItem:r}}if(!n.isOdcActivity(t))return e};e.prototype._getParentItem=function(e){var t=n.getItem(e);if(n.isMoveActivity(e)){var r=n.getAction(e).move;if(r&&r.to){var i=this._getDirNameFromPath(r.to),s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference);return{name:this._getFileNameFromPath(i),isRoot:this._isRootItem(i),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+s.id,relativePath:void 0,absolutePath:this._getDirNameFromPath(i),isFolder:!0,driveItem:s&&{id:s.id}}}}else if(n.isDeleteActivity(e)&&t){if(n.isOdbActivity(e)){var o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(s=t&&t.parentReference){o=this._getRelativePathFromVroomPath(s.path);var u=s.name?s.name:o&&this._getFileNameFromPath(o);if(void 0===o||void 0===u||void 0===s.id)return;return{name:u,isRoot:this._isRootItem(u),graphItemUrl:"/drives/"+s.driveId+"/items/"+s.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:s.id}}}}else{if(n.isRestoreVersionActivity(e)&&t){o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!1,driveItem:t}}if(n.isPointInTimeRestoreActivity(e)&&t){var a;o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(t){if(s=t.parentReference&&t.parentReference){o=this._getRelativePathFromVroomPath(s.path);var f=s.name?s.name:o&&this._getFileNameFromPath(o);return{name:f,isRoot:this._isRootItem(f),graphItemUrl:"/drives/"+s.driveId+"/items/"+s.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:s.id}}}}}};e.prototype._getNavLink=function(e,t){var n=e.webUrl,i=n&&new r.default(n),s=t.navigationId;i&&s&&i.setQueryParameter("nav",s);return i.toString()||n};e.prototype._getAction=function(e,t,r,i){var s={};n.isVersionActivity(i)&&(s.version={newVersion:n.getAction(i).version.newVersion});if(n.isMoveActivity(i)){var o=n.getAction(i).move;if(n.isOdcActivity(i)){var u=void 0,a=void 0;o.from&&(u=this._getDirNameFromPath(o.from));o.to&&(a=this._getDirNameFromPath(o.to));s.move={from:{name:this._getFileNameFromPath(u),isRoot:this._isRootItem(u),graphItemUrl:void 0,absolutePath:u},to:{name:this._getFileNameFromPath(a),isRoot:this._isRootItem(a),graphItemUrl:void 0,absolutePath:a}}}else if(o.From){var f=this._getDirNameFromPath(o.From);s.move={from:{name:this._getFileNameFromPath(f),isRoot:this._isRootItem(f),graphItemUrl:void 0,absolutePath:f},to:void 0}}else if(o.to){var l=this._getDirNameFromPath(o.to);s.move={from:void 0,to:{name:this._getFileNameFromPath(l),isRoot:this._isRootItem(l),graphItemUrl:void 0,absolutePath:l}}}}if(n.isRenameActivity(i)){var c=n.getAction(i).rename;s.rename={newItem:{name:c.newName,isRoot:this._isRootItem(c.newName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0},oldItem:{name:c.oldName,isRoot:this._isRootItem(c.oldName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0}}}if(n.isCommentResponseActivity(i)){(h=n.getAction(i).comment).isReply&&(s.commentResponse={commentAuthor:h.parentAuthor&&h.parentAuthor.user})}if(n.isCommentActivity(i)){var h;(h=n.getAction(i).comment).isReply||(s.comment={commentId:h.commentId})}if(n.isMentionActivity(i)){var p=n.getAction(i).mention;s.mention={mentionees:p.mentionees&&p.mentionees.map(function(e){return e.user})||[]}}if(n.isShareActivity(i)){var d=n.getAction(i).share;s.share={recipients:d.recipients&&d.recipients.map(function(e){return e.user})||[]}}return s};e.prototype._getRelativePathFromVroomPath=function(e){if(e){return e.split(":",2)[1]}};e.prototype._getDirNameFromPath=function(e){return e&&e.substring(0,e.lastIndexOf("/"))};e.prototype._getFileNameFromPath=function(e){return e&&e.substring(e.lastIndexOf("/")+1)};e.prototype._isRootItem=function(e){return e&&"/LiveFolders"===e};return e})();t.default=i});
define("Qg",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e){return void 0!==e.action}t.isOdbActivity=n;t.isOdcActivity=function(e){return void 0!==e.activityDateTime};function r(e){var t=g(e).comment;return void 0!==t&&!t.isReply}t.isCommentActivity=r;function i(e){var t=g(e).comment;return void 0!==t&&t.isReply}t.isCommentResponseActivity=i;function s(e){return void 0!==g(e).mention}t.isMentionActivity=s;function o(e){return void 0!==g(e).edit}t.isEditActivity=o;function u(e){return void 0!==g(e).version}t.isVersionActivity=u;function a(e){return void 0!==g(e).pointInTimeRestore}t.isPointInTimeRestoreActivity=a;function f(e){return void 0!==g(e).restore}t.isRestoreActivity=f;function l(e){return void 0!==g(e).restoreVersion}t.isRestoreVersionActivity=l;function c(e){return void 0!==g(e).move}t.isMoveActivity=c;function h(e){return void 0!==g(e).rename}t.isRenameActivity=h;function p(e){return void 0!==g(e).delete}t.isDeleteActivity=p;function d(e){return void 0!==g(e).create}t.isCreateActivity=d;function v(e){return void 0!==g(e).share}t.isShareActivity=v;function m(e){return void 0!==g(e).copy}t.isCopyActivity=m;t.matchActivity=function(e){return function(t){return r(t)?e.Comment(t):i(t)?e.CommentResponse(t):d(t)?e.Create(t):p(t)?e.Delete(t):o(t)?e.Edit(t):s(t)?e.Mention(t):c(t)?e.Move(t):h(t)?e.Rename(t):f(t)?e.Restore(t):l(t)?e.RestoreVersion(t):v(t)?e.Share(t):u(t)?e.Version(t):m(t)?e.Copy(t):a(t)?e.PointInTimeRestore(t):void 0}};function g(e){return n(e)?e.action:e}t.getAction=g;t.getItem=function(e){return e.driveItem}});
define("Qi",["require","exports","bl"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_PAGE_SIZE=25;var r={folderDoesNotExist:!0,itemNotFound:!0,accessDenied:!0,unauthenticated:!0},i=(function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor;this._itemActivitiesResultProcessor=t.itemActivitiesResultProcessor}e.prototype.getItemActivities=function(e){var t=this;e.environment=e.environment||"sharePoint";if(e.mockData)return n.default.resolve({activities:e.mockData,isPlaceholder:!1,success:!0});var i=this._getRequestUrl(e);return this._dataRequestor.send({apiName:e.qosPrefix?e.qosPrefix+".GetItemActivities":"GetItemActivities",path:i,headers:e.headers,accessToken:e.item.accessToken,apiVersion:e.apiVersion,expectedErrorCodes:r}).then(function(n){return t._itemActivitiesResultProcessor.processResponse({item:e.item,response:n})},function(e){return{error:e,isPlaceholder:!1,activities:[],success:!1}})};e.prototype.getActivitiesByDate=function(e){e.environment=e.environment||"sharePoint";return e.mockData?n.default.resolve({activitiesByDate:e.mockData,success:!0}):this.getActivitiesByInterval({item:e.item,headers:e.headers,interval:"day",startDateTime:e.startDateTime,endDateTime:e.endDateTime}).then(function(e){return{error:e.error,success:e.success,activitiesByDate:e.activitiesByInterval.map(function(e){var t=e.startDateTime;return{createCount:e.createCount,deleteCount:e.deleteCount,editCount:e.editCount,moveCount:e.moveCount,restoreCount:e.restoreCount,copyCount:e.copyCount,totalCount:e.totalCount,date:s(t)}})}},function(e){return n.default.resolve({activitiesByDate:[],error:new Error("Not implemented"),success:!1})})};e.prototype.getActivitiesByInterval=function(e){var t=this,n=e.endDateTime?"&endDateTime="+e.endDateTime.toISOString():"",r=e.item.graphItemUrl+"/action.getActivitiesByInterval?startDateTime="+e.startDateTime.toISOString()+"&interval=day"+n;return this._dataRequestor.send({apiName:"GetActivitiesByInterval",headers:e.headers,path:r}).then(function(e){return t._itemActivitiesResultProcessor.processActivitiesByIntervalResponse(e)},function(e){return{error:e,activitiesByInterval:[],success:!1}})};e.prototype._getRequestUrl=function(e){var n=e.pageSize?e.pageSize:t.DEFAULT_PAGE_SIZE,r=e.item.graphItemUrl+"/activities?$expand=driveItem($select=id,name,webUrl,parentReference,file,folder)";r+="&$top="+n;e.filter&&(r+="&$filter="+e.filter);e.orderBy&&(r+="&$orderby="+e.orderBy);e.nextRequestToken&&(r+="&$skiptoken="+e.nextRequestToken);return r};return e})();t.default=i;function s(e){function t(e){return e<10?"0"+e:e}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())}});
define("Qe",["require","exports","hT","Qf"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,r.default,{})});
define("P9",["require","exports","hT","Qa","Qh","Qe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemActivitiesService=i.ItemActivitiesService;t.resourceKey=n.createResolvedResourceKey(e("module").id,i.ItemActivitiesService,{vroomDataRequestor:r.resourceKey,itemActivitiesResultProcessor:s.resourceKey})});
define("Qa",["require","exports","hT","aM","Qc","Qb"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new n.ResourceKey({name:"cookieOrigin",factory:new n.ConstantResourceFactory(window.location.origin)});t.resourceKey=n.createResolvedResourceKey(e("module").id,s.DataRequestor,{sessionManagementProvider:i.resourceKey,urlDataSource:r.url,cookieOrigin:o})});
define("Qc",["require","exports","dB","Qd","bl","aM","hT","ci","Kt","aL"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(){function e(e,t){this._identityDataSource=t.identityDataSource;this._microServiceDataSource=t.microServiceDataSource}e.prototype.getToken=function(e,t){var r=this._identityDataSource.getIdentity().type;if(r===n.IdentityType.aad){var s=new f.default(t).authority,o=t&&t.indexOf("$expand=notificationPreferences")>0;if(a.isFeatureEnabled(a.UseIdentityDataSourceAuthToken)&&s&&o)return this._identityDataSource.getSharePointToken(s);if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return i.default.resolve()})}else if(r===n.IdentityType.msa)return this._identityDataSource.getSessionToken();return i.default.reject(new u.ApiError({code:"unauthUser",isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))};e.prototype.getFormDigest=function(e){return this._identityDataSource.getFormDigest(e)};e.dependencies={identityDataSource:s.identity,microServiceDataSource:r.resourceKey.optional};return e})();t.default=l;t.resourceKey=o.createResolvedResourceKey(e("module").id,l)});
define("Qd",["require","exports","hT"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey(e("module").id)});
define("Qb",["require","exports","mU","DI","gB"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("Qk",["require","exports","Qx","bl","hT","PY","aM","Qa","Qm","Ql"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(){function e(e,t){this._authTokenFetcher=t.authTokenFetcher;this._dataRequestor=t.vroomDataRequestor;this._graphDataSource=t.graphDataSource;this._restoreActivitiesDataSource=t.restoreActivitiesDataSource;this._itemsStore=t.itemsStore;this._urlDataSource=t.urlDataSource}e.prototype.getOngoingRestoreOperation=function(e){var t=this,i=e&&e.url;return(i?r.default.resolve(i):this._getRootDriveItemUrl("v2.1").then(function(i){return t._dataRequestor.send({apiName:t._restoreActivitiesDataSource.getQosPrefix()+".Operations",apiVersion:"v2.1",headers:e&&e.headers,path:i+"/operations"}).then(function(e){return e.value.filter(function(e){return"DocumentLibraryRestore"===e.type})},function(e){return n.isGraphError(e)&&404===e.status?[]:r.default.reject(e)}).then(function(e){return 0===e.length?null:i+"/operations/"+e[0].id})})).then(function(e){return e?t._getRestoreOperation(e):null})};e.prototype.submitRestore=function(e){var t=this;return this._getRootDriveItemUrl("v2.1").then(function(n){return t._dataRequestor.send({apiName:t._restoreActivitiesDataSource.getQosPrefix()+".RestoreToDate",apiVersion:"v2.1",requestType:"POST",headers:e.headers,path:n+"/oneDrive.restoreToDate",postData:JSON.stringify({restoreTo:e.dateTime,mostRecentActivityId:e.mostRecentActivityId})})})};e.prototype._getRestoreOperation=function(e,t){return this._dataRequestor.send({apiName:this._restoreActivitiesDataSource.getQosPrefix()+".RestoreStatus",apiVersion:"v2.1",path:e}).then(function(t){return{percentComplete:t.percentComplete,status:{cancelled:f.RestoreStatus.Cancelled,cancelpending:f.RestoreStatus.CancelPending,completed:f.RestoreStatus.Completed,failed:f.RestoreStatus.Failed,notstarted:f.RestoreStatus.NotStarted,inprogress:f.RestoreStatus.InProgress,aborted:f.RestoreStatus.Cancelled,aborting:f.RestoreStatus.CancelPending,running:f.RestoreStatus.InProgress,unknown:f.RestoreStatus.Unknown}[t.status.toLowerCase()],url:e}})};e.prototype._getRootDriveItemUrl=function(e){var t=this,n=this._urlDataSource.getRootItemKey();return this._authTokenFetcher.ensureAuthToken(n).then(function(){return t._itemsStore.getItem(n)()}).then(function(n){return t._graphDataSource.getDriveUrl(n,{apiVersion:e,useDirectEndpoint:!0})})};e.dependencies={authTokenFetcher:a.resourceKey,graphDataSource:o.graph,restoreActivitiesDataSource:o.restoreActivities,itemsStore:s.resourceKey,urlDataSource:o.url,vroomDataRequestor:u.resourceKey};return e})();t.RestoreOperationDataSource=l;t.resourceKey=i.createResolvedResourceKey(e("module").id,l)});
define("Qx",["require","exports","mU","DK"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("Qm",["require","exports","mU","bl","Kl","hT","Qd","Qn","iP","d0"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t)||this;r._authTokenDataSource=n.authTokenDataSource;r.itemUrlHelper=n.itemUrlHelper;r._pageContext=n.pageContext;r._microServiceDataSource=n.microServiceDataSource;return r}t.prototype.ensureAuthToken=function(e){var t=this;return this._microServiceDataSource.hasAuthData()&&!this._microServiceDataSource.hasAuthDataExpired()?r.default.wrap(void 0):this._pageContext.isSPO?this.getAuthToken(e).then(function(e){if(!e)return r.default.wrapError("The list response did not contain a list schema value.");t._microServiceDataSource.setBaseInfo(e)}):r.default.resolve()};t.prototype.getAuthToken=function(e){return this._pageContext.isSPO?this._authTokenDataSource.getAuthToken({key:e}):r.default.reject(new Error("getAuthToken is not supported OnPrem"))};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{authTokenDataSource:u.resourceKey,itemUrlHelper:f.resourceKey,pageContext:a.pageContext,microServiceDataSource:o.resourceKey});return t})(i.default);t.default=l;t.resourceKey=s.createResolvedResourceKey(e("module").id,l)});
define("Qn",["require","exports","mU","bl","W","Qv","Kl","hT","gj","Qq","Qo","iP","aM","d0"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t)||this;r._itemTaskObserverType=n.itemTaskObserverType;r._itemUrlHelper=n.itemUrlHelper;r._listItemResultProcessor=n.listItemResultProcessor;r._pageContext=n.pageContext;r._urlDataSource=n.urlDataSource;return r}t.prototype.getAuthToken=function(e){var t=this;if(!this._pageContext.isSPO)return r.default.reject(new Error("getAuthToken is not supported OnPrem"));var o=new s.SPListItemRetriever({pageContext:this._pageContext}),u=e&&e.key||this._urlDataSource.getRootItemKey(),f=this._itemUrlHelper.getItemUrlParts(u),l=this._itemUrlHelper.getUrlParts({path:f.serverRelativeListUrl,listUrl:f.fullListUrl}),c=a.getViewXml({pageSize:1}),h={parentKey:u,postDataContext:{viewXml:c,needsSchema:!0,isListDataRenderOptionChangeFeatureEnabled:!0},skipServiceWorkerCache:!0},p={urlParts:l},d={qosEvent:new i.Qos({name:"FetchAuthToken"}),qosName:"AuthToken.GetData"};return o.getItem(h,p,d).then(function(e){var r=new t._itemTaskObserverType;t._listItemResultProcessor.processResponse({response:n.__assign(n.__assign({},e),{ListData:n.__assign(n.__assign({},e.ListData),{Row:[]})}),requestKey:u,observer:r});r.flush();if(e&&e.ListSchema)return{data:e.ListSchema,allowCookies:!1}})};t.dependencies=n.__assign(n.__assign({},o.default.dependencies),{itemTaskObserverType:l.resourceKey,itemUrlHelper:p.resourceKey,listItemResultProcessor:f.resourceKey,pageContext:c.pageContext,urlDataSource:h.url});return t})(o.default);t.default=d;t.resourceKey=u.createResolvedResourceKey(e("module").id,d)});
define("Qv",["require","exports","mU","Qw"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("Qw",["require","exports","mU","eX","gj","EI","bl","W","a2","bu","W"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GROUPINGID_NEXT="__next__";var c=(function(e){n.__extends(s,e);function s(t){return e.call(this,{dataSourceName:"ListItemDataSource"},{pageContext:t.pageContext})||this}s.prototype.getItem=function(t,n,r,i){var s=this;t.postDataContext.isOnePage=!!t.newTargetListUrl||!!t.isOnePageNavigation;return e.prototype.getData.call(this,function(){return s.getUrl(n,t)},function(e,t){return s._parseResponse(e,r.qosEvent,t)},r.qosName,function(){return s.getAdditionalPostData(t.postDataContext,n)},"POST",this._getListRequestHeaders(t,n),void 0,void 0,void 0,void 0,function(e){var t=s._telemetryHandler(e);i&&i(t.eventData);return t},void 0).then(function(e){return e},function(e){s._errorHandler(r.qosName,e);return o.default.reject(e)})};s.prototype.getUrl=function(e,t){var n=t&&t.postDataContext,i={webUrl:this._pageContext.webAbsoluteUrl,listId:e.listId,urlParts:e.urlParts||{},searchTerm:e.searchTerm,rootFolder:e.folderPath,isOnePageNavigation:t.isOnePageNavigation};if(this._isSpecifiedItemRequest(e))i.viewId=e.viewIdForRequest;else{(!e.viewXmlForRequest||n&&n.isOnePage)&&e.viewIdForRequest!==f.default.Empty&&(i.view=e.viewIdForRequest);!i.view&&e.viewPathForRequest&&(i.viewPath=e.viewPathForRequest);t&&t.ignoreFilterParams||(i.filterParams=e.filterParams);if(e.sortField){i.sortField=e.sortField;i.sortDir="false"===e.isAscending?"Desc":"Asc"}n&&n.groupReplace?i.requestToken=this._isExpandingGroup(i)?void 0:e.requestToken:i.requestToken=e.group?void 0:e.requestToken;!this._isExpandingGroup(e)||n&&n.groupReplace||(i.groupString=e.group.groupString);n&&n.webId&&(i.webId=n.webId)}return r.getListDataUrl(i)};s.prototype.getAdditionalPostData=function(e,t){return i.getAdditionalPostData(e,t)};s.prototype._getListRequestHeaders=function(e,t){var n=r.getListRequestHeaders(t,e.postDataContext);n["X-ServiceWorker-Strategy"]=e.skipServiceWorkerCache?"SkipCache":"CacheFirst";return n};s.prototype._isSpecifiedItemRequest=function(e){return e.itemIds&&e.itemIds.length>0};s.prototype._isExpandingGroup=function(e){return e.group&&e.group.groupingId!==t.GROUPINGID_NEXT};s.prototype._parseResponse=function(e,t,n){var r=n.getServiceWorkerDataSourceHeader();try{if(void 0!==e)return this._getListItemResponse(e,r)}catch(n){if("{}"!==e.substring(0,2)){t.end({resultType:u.ResultTypeEnum.Failure,resultCode:"BadJSON"});throw n}return this._getListItemResponse(e.substring(2),r)}};s.prototype._getListItemResponse=function(e,t){var n;n=JSON.parse(e);"ServiceWorker-FromCache"===t&&(n.isFromServiceWorkerCache=!0);return n};s.prototype._telemetryHandler=function(e){var t=e.errorData,r=n.__assign({},e.eventData);if(t){var i=void 0,s=t.code?t.code:"";if(s.indexOf("2147024860")>-1)s="ListViewTreshold";else if(s.indexOf("2147024749")>-1)s="LookupColumnTreshold";else if(s.indexOf("2147024809")>-1&&s.indexOf("requestUrl")>-1)s="RequestURLFailure";else if(s.indexOf("2147024809")>-1&&s.indexOf("range")>-1)s="RangeError";else if(s.indexOf("2147024809")>-1&&s.indexOf("view")>-1)s="InvalidView";else if(s.indexOf("2130575340")>-1&&s.indexOf("field")>-1)s="FieldTypesNotInstalledProperly";else if(s.indexOf("2146232832")>-1){s="DefaultDoclibNotFound";if(500===t.status){i=!1;r.resultType=l.ResultTypeEnum.ExpectedFailure}}else if(s.indexOf("2147024895")>-1){s="PrefetchWebMismatch";if(500===t.status){i=!1;r.resultType=l.ResultTypeEnum.ExpectedFailure}}else s=r.resultCode;r.resultCode=s;return{canRetry:i,eventData:r}}return{eventData:r}};s.prototype._errorHandler=function(e,t){var n=t&&t.code?t.code:"";n.indexOf("2147024860")>-1?a.default.logData({name:e+".ListViewTreshold"}):n.indexOf("2147024749")>-1&&a.default.logData({name:e+".LookupColumnTreshold"})};return s})(s.default);t.SPListItemRetriever=c;t.default=c});
define("Qq",["require","exports","a2","r","aM","Qp","M5","iP","v","eG","Qu","an","H8","d0","Qt","eD","dF","hT","Qr","mx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=!1;var E=(function(){function e(e,t){this._urlDataSource=t.urlDataSource;this._pageContext=t.pageContext;this._itemUrlHelper=t.itemUrlHelper;this._vroomUrlHelper=t.vroomUrlHelper}e.prototype.processResponse=function(e){var t=e.response,n=e.response,r=n.WebUrl,i=n.HttpRoot,s=n.ListData,u=n.rootFolder,a=n.ListSchema,f=(void 0===a?{}:a).Collapse,c=void 0===f?"FALSE":f,h=e.requestKey,p=e.observer,d=this._urlDataSource.getKeyParams(h),v="TRUE"===c,m=this._itemUrlHelper.getItemUrlParts(h),g=this._itemUrlHelper.getUrlParts({path:m.serverRelativeListUrl,listUrl:m.fullListUrl});(r||i)&&this._processWeb({list:t,requestKeyParts:d,observer:p});this._processList({list:t,listUrlParts:g,requestKeyParts:d,observer:p});var y=[];if(u){var b=this._processRootFolder({list:t,listUrlParts:g,requestKeyParts:d,observer:p});y.push.apply(y,b.parentItemUrls)}if(s&&!v){b=this._processListData({listData:s,listUrlParts:g,parentKey:h,requestKeyParts:d,observer:p});y.push.apply(y,b.parentItemUrls)}var w={};if(t.ParentInfo)for(var E=0,S=t.ParentInfo.ParentFolderInfo;E<S.length;E++){var x=S[E];w[x.ServerRelativeUrl]=l.default.fromHexString(x.Permissions)}for(var T=0,N=o.removeDuplicates(y);T<N.length;T++){var C=N[T];this._processParentItem({itemUrl:C,listUrlParts:g,parentInfo:w,requestKeyParts:d,observer:p})}};e.prototype._processListData=function(e){for(var t=e.listData.Row,n=e.parentKey,r=e.requestKeyParts,i=e.listUrlParts,o=e.observer,u=[],a="",f=0,l=t;f<l.length;f++){var c=l[f],h=c.FileRef,p=this._processRow({row:c,observer:o,requestKeyParts:r,listUrlParts:i}).key;u.push.apply(u,this._getParentItemUrls({listUrlParts:i,itemUrl:h}));o.update([new s.default(p).succeed({set:{parent:{key:n},after:{key:a}}})]);a=p}return{parentItemUrls:u}};e.prototype._processRow=function(e){var t,n,i=e.row,o=e.row.FileRef,u=e.listUrlParts,f=e.requestKeyParts,l=e.observer,c=this._itemUrlHelper.getUrlParts({path:o,listUrl:u.fullListUrl});n=((t={}).id=c.serverRelativeItemUrl,t.listurl=c.normalizedListUrl,t);if(this._isFolder(i)){var h={},p=this._urlDataSource.getQueryType(f),d=f.typeFilters;p!==r.default.Search&&(h.view=f.view);d&&(h.typeFilters=d);a.extend(n,h)}var v=this._urlDataSource.getKey(n),m=this._getParentKeyForListItem({listUrlParts:u,itemUrl:o,requestKeyParts:f}),g={key:v};m&&(g.parentKey=m);l.update([new s.default(v).succeed({item:g})]);return{key:v}};e.prototype._processRootFolder=function(e){var t,n,r,i=e.list,o=e.listUrlParts,u=e.requestKeyParts,a=e.observer,l=i.rootFolder,c=this._itemUrlHelper.getUrlParts({path:l,listUrl:o.fullListUrl}),p=this._urlDataSource.getKey(((t={}).id=c.serverRelativeItemUrl,t.listurl=c.normalizedListUrl,t.view=u.view,t.q=u.q,t.typeFilters=u.typeFilters,t)),d=this._getParentKeyForListItem({listUrlParts:o,itemUrl:l,requestKeyParts:u}),v={key:p,type:f.default.Folder,newWOPIDocumentEnabled:h.optional(i.NewWOPIDocumentEnabled)};d&&(v.parentKey=d);var m=!b.default.isActivated("D661752A-9F1F-4AF8-89A9-2C0CA6688A00","03/19/2019","Infer rootFolder content-type");if(i.ListData){n=i.ListData.FolderId;if(m&&"Sharepoint.DocumentSet"===i.ListData.CurrentFolderProgId){v.isDocSet=!0;if(i.AvailableContentTypes)for(var g=0,y=i.AvailableContentTypes;g<y.length;g++){var w=y[g],E=w.contentTypeId;if(E&&0===E.indexOf("0x0120D520")){v.contentTypeId=E;r=w.displayName;break}}}if(i.ListData.CurrentFolderSpItemUrl){var S=this._vroomUrlHelper.getUrlParts(i.ListData.CurrentFolderSpItemUrl);v.itemId=h.optional(S.itemId);v.graph={itemId:h.optional(S.itemId),driveId:h.optional(S.driveId)}}}m&&r&&v.contentTypeId?v.properties={ID:h.optional(n),ContentType:r,ContentTypeId:v.contentTypeId}:v.properties={ID:h.optional(n)};if(!this._isListRoot({itemUrl:l,listUrlParts:o})){var x=l.split("/").slice(-1)[0];v.name=x;v.displayName=x}a.update([new s.default(p).succeed({item:v})]);return{parentItemUrls:this._getParentItemUrls({listUrlParts:o,itemUrl:l})}};e.prototype._processWeb=function(e){var t,n=e.list,i=e.requestKeyParts,o=e.observer,u=n.HttpRoot,a=n.SiteTitle,l=n.WebUrl||u&&v.getSharePointPath(decodeURIComponent(u)),c=this._itemUrlHelper.getUrlParts({path:l,webUrl:l}),h=this._urlDataSource.getKey(((t={}).id=c.normalizedItemUrl,t.view=r.default.DocumentLibraries,t.typeFilters=i.typeFilters,t)),p={},d={key:h,type:f.default.Folder,subsite:p};if(this._pageContext.webAbsoluteUrl===l){d.name=a;d.displayName=a;p.webTemplateId=Number(this._pageContext.webTemplate);p.serverRelativeUrl=this._pageContext.webAbsoluteUrl;p.id=this._pageContext.webId;p.siteCollectionId=this._pageContext.siteId;p.title=this._pageContext.webTitle;p.icon=this._pageContext.webLogoUrl}o.update([new s.default(h).succeed({item:d})])};e.prototype._processList=function(e){var t,i,o,u,a,l=e.list,p=e.listUrlParts,d=e.requestKeyParts,g=e.observer,E=l.ListTitle,S=l.HttpRoot,x=l.ListUrl,T=l.listUrlDir,N=x||T&&decodeURIComponent(T),C=this._urlDataSource.getKey(((t={}).id=p.serverRelativeItemUrl,t.listurl=p.normalizedListUrl,t.view=d.view,t.q=d.q,t.typeFilters=d.typeFilters,t)),k=l.AllowCreateFolder,L=l.EnableMinorVersions,A=l.verEnabled,O=l.AllowGridMode,M=l.DisableGridEditing,_=l.ListTemplateType,D=l.BasePermissions,P=void 0===D?{}:D,H=P.ManageLists,B=void 0===H?void 0:H,j=P.ManagePersonalViews,F=void 0===j?void 0:j,I=P.OpenItems,q=void 0===I?void 0:I,R=P.UseClientIntegration,U=void 0===R?void 0:R,z=l.ListSchema,W=void 0===z?{}:z,X=W.DefaultItemOpen,V=void 0===X?void 0:X,$=W[".driveAccessTokenV21"],J=void 0===$?void 0:$,K=W[".driveAccessToken"],Q=void 0===K?void 0:K,G=l.ExcludeFromOfflineClient,Y=l.WebExcludeFromOfflineClient,Z=l.listBaseType,ee=Q,te=J,ne=!b.default.isActivated("F9C1B78B-355E-411B-95C9-0FAF5DB3E598","03/04/2019","Pick driveAccessToken from page context"),re=this._pageContext.driveInfo;if(ne&&l.isFromServiceWorkerCache&&N===this._pageContext.listUrl&&re){re[".driveAccessToken"]&&(ee=re[".driveAccessToken"]);re[".driveAccessTokenV21"]&&(te=re[".driveAccessTokenV21"])}if(ee){o={accessToken:(ie=m.deserializeQuery(ee)).access_token,proofToken:ie.prooftoken}}if(te){var ie;u={accessToken:(ie=m.deserializeQuery(te)).access_token,proofToken:ie.prooftoken}}var se=l.WebUrl||S&&v.getSharePointPath(decodeURIComponent(S));if(se){var oe=this._itemUrlHelper.getUrlParts({path:se,webUrl:se});a=this._urlDataSource.getKey(((i={}).id=oe.normalizedItemUrl,i.view=r.default.DocumentLibraries,i.typeFilters=d.typeFilters,i))}var ue="string"==typeof V?"0"===V:void 0;ue&&(function(){if(!w){n.Engagement.logData({name:"List.openInClient"});w=!0}})();var ae=l.ListSchema&&l.ListSchema[".driveUrl"];ne&&l.isFromServiceWorkerCache&&N===this._pageContext.listUrl&&re&&re[".driveUrl"]&&(ae=re[".driveUrl"]);var fe=this._vroomUrlHelper.getUrlParts(ae);if(ne){o&&y.isTokenExpired({authToken:o.accessToken,proofToken:o.proofToken})&&(o=void 0);u&&y.isTokenExpired({authToken:u.accessToken,proofToken:u.proofToken})&&(u=void 0)}var le=b.default.isActivated("C4E1F03F-7839-4A1A-8469-C2E3A0819036","07/02/2019","Use new IsDocLib check")?"string"==typeof _?c.isDocumentLibrary(_):void 0:"number"==typeof Z?c.isDocLib(String(Z)):void 0;g.update([new s.default(C).succeed({item:{key:C,parentKey:h.optional(a),itemId:h.backup("root"),graph:{itemId:h.backup("root"),driveId:h.optional(fe.driveId),sessionToken:h.optional(o),sessionTokenV21:h.optional(u)},type:f.default.Folder,name:h.optional(E),displayName:h.optional(E),isRootFolder:!0,isDropEnabled:!0,folder:{},newWOPIDocumentEnabled:h.optional(l.rootFolder?void 0:l.NewWOPIDocumentEnabled),list:{id:h.optional(l.listName),allowGridMode:"boolean"==typeof O?O:h.backup(!0),allowCreateFolder:h.optional(k),disableGridEditing:"boolean"==typeof M?M:h.backup(!1),enableMinorVersions:h.optional(L),enableVersions:h.optional(A),templateType:h.optional("string"==typeof _?Number(_):void 0),isDocumentLibrary:h.optional(le),isPromotedLinks:h.optional("string"==typeof _?c.isPromotedLinksList(_):void 0),isModerated:h.optional(l.isModerated),newWOPIDocumentEnabled:h.optional(l.NewWOPIDocumentEnabled),newWOPIDocumentTypes:h.optional(l.NewWOPIDocumentTypes),permissions:{manageLists:h.optional(B),managePersonalViews:h.optional(F),openItems:h.optional(q),useClientIntegration:h.optional(U)},openInClient:h.optional(ue),excludeFromOfflineClient:h.optional("boolean"==typeof G||"boolean"==typeof Y?G||Y:void 0),contentTypesEnabled:h.optional(l.ContentTypesEnabled),metadataNavFeatureEnabled:h.optional(l.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:h.optional(l.canUserCreateMicrosoftForm),itemCount:h.optional(l.ListSchema&&l.ListSchema.ItemCount),rowLimit:h.optional(l.ListData.RowLimit),listUrlDir:N,createdFromExcel:h.optional(l.CreatedFromExcel),createdFromExisting:h.optional(l.CreatedFromExisting)},properties:{commandsSupported:h.optional(l.CanShareLinkForNewDocument&&{canShareLinkForNewDocument:"1"})}}})])};e.prototype._processParentItem=function(e){var t,n=e.itemUrl,r=e.listUrlParts,i=e.parentInfo,o=e.requestKeyParts,u=e.observer,a=this._itemUrlHelper.getUrlParts({path:n,listUrl:r.fullListUrl}),l=this._urlDataSource.getKey(((t={}).id=a.serverRelativeItemUrl,t.listurl=a.normalizedListUrl,t.view=o.view,t.q=o.q,t.typeFilters=o.typeFilters,t)),c={key:l,parentKey:this._getParentKeyForListItem({listUrlParts:r,itemUrl:n,requestKeyParts:o}),queryType:this._urlDataSource.getQueryType(o)};if(this._isListRoot({itemUrl:n,listUrlParts:r}))c.list={};else{var h=v.getFolderNameFromPath(n);c.name=h;c.displayName=h;c.type=f.default.Folder;c.isDropEnabled=!0;c.folder={};i&&i[n]&&(c.permissions=i[n])}u.update([new s.default(l).succeed({item:c})])};e.prototype._getParentKeyForListItem=function(e){var t,n,r=e.listUrlParts,i=e.itemUrl,s=e.requestKeyParts;if(r.serverRelativeListUrl!==i){var o=i.split("/").slice(0,-1).join("/"),u=this._itemUrlHelper.getUrlParts({path:o,listUrl:r.fullListUrl});n=this._urlDataSource.getKey(((t={}).id=u.serverRelativeItemUrl,t.listurl=u.normalizedListUrl,t.view=s.view,t.q=s.q,t.typeFilters=s.typeFilters,t))}return n};e.prototype._getParentItemUrls=function(e){var t=e.listUrlParts,n=e.itemUrl,r=[],i=t.serverRelativeListUrl;if(0===n.indexOf(i))for(var s="",o=0,u=n.substring(i.length).split("/").slice(1,-1);o<u.length;o++){var a=""+i+(s+="/"+u[o]);r.push(a)}return r};e.prototype._isListRoot=function(e){var t=e.itemUrl;return e.listUrlParts.serverRelativeListUrl===t};e.prototype._isFolder=function(e){var t;if("1"===e.FSObjType){var n=e["File_x0020_Type.mapapp"],r=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];t=!(n&&"onenote"===n.substring(0,7)||r&&-1!==r.indexOf("onenote"))}else t=!1;return t};e.dependencies={urlDataSource:i.url,pageContext:u.pageContext,itemUrlHelper:p.resourceKey,vroomUrlHelper:d.resourceKey,resources:g.resourceScopeKey};return e})();t.default=E;t.resourceKey=g.createResolvedResourceKey(e("module").id,E)});
define("Qp",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t){if((function(e){return!!e&&"object"==typeof e})(e)){this.key=e.key;this.input=e.input;this.output=e.output;this.status=e.status;this.error=e.error}else{this.key=e;this.input=t;this.status=0}}e.prototype.succeed=function(t){var n=new e(this);n.output=t;n.status=1;delete n.error;return n};e.prototype.fail=function(t){var n=new e(this);n.error=t;n.status=2;return n};e.prototype.cancel=function(){var t=new e(this);delete t.error;t.status=3;return t};e.prototype.restart=function(){return new e(this.key,this.input)};e.prototype.changeInput=function(t){var n=t(this.input),r=new e(this.key,n);r.output=this.output;r.status=this.status;r.error=this.error;return r};e.prototype.changeOutput=function(t){var n=t(this.output),r=new e(this.key,this.input);r.output=n;r.status=this.status;r.error=this.error;return r};e.prototype.compare=function(e){return!e||this.input!==e.input||this.output!==e.output||this.error!==e.error||this.status!==e.status?{previous:e,current:this}:null};return e})();t.default=n});
define("Qu",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e.fromHexString=function(e,t){var n=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},r=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(r){var i=void 0,s=void 0;if((e=(e=r[2]||"0").slice(-16)).length<=8){i=0;s=parseInt(e,16)}else{i=parseInt(e.slice(0,-8),16);s=parseInt(e.slice(-8),16)}if(!isNaN(i)&&!isNaN(s)){n.High=i;n.Low=s}}return n};e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})};e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}}})(n=t.Double||(t.Double={}));t.default=n});
define("Qt",["require","exports","mU","Kl","dg","hT"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getUrlParts=function(e){return new u(e)};return t})(r.default);t.default=o;var u=(function(){function e(e){this._url=e}Object.defineProperty(e.prototype,"driveId",{get:function(){return this._getDriveId()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"itemId",{get:function(){return this._getItemId()},enumerable:!0,configurable:!0});e.prototype._getDriveId=function(){var e,t=this._getIndexOfDrivesSegment();if(t>-1){var n=this._getPathSegments();e=n[t+1]}this._getDriveId=function(){return e};return e};e.prototype._getItemId=function(){var e,t=this._getIndexOfItemsSegment();if(t>-1){var n=this._getPathSegments();e=n[t+1]}this._getItemId=function(){return e};return e};e.prototype._getPathSegments=function(){var e,t=this._url;e=t?new i.default(t).getPathSegments():[];this._getPathSegments=function(){return e};return e};e.prototype._getIndexOfDrivesSegment=function(){var e=this._getPathSegments().indexOf("drives");this._getIndexOfDrivesSegment=function(){return e};return e};e.prototype._getIndexOfItemsSegment=function(){var e=this._getPathSegments().indexOf("items");this._getIndexOfItemsSegment=function(){return e};return e};return e})();t.resourceKey=s.createResolvedResourceKey(e("module").id,o)});
define("Qr",["require","exports","Qs"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return n.parseTokenPayload(e)}t.parseToken=r;function i(e){try{return new Date(parseInt(e+"000",10))}catch(e){}}t.getDate=i;t.isTokenExpired=function(e,t){void 0===t&&(t=0);if(!e.expiry){var n=r(e.authToken);e.expiry=n&&i(n.exp)}return(e.expiry?e.expiry.getTime():0)-Date.now()<t}});
define("Qs",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e){if(!e)return{};try{var t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch(e){return{}}}t.parseTokenHeader=function(e){return e?n(decodeURIComponent(e).split(".")[0]):{}};t.parseTokenPayload=function(e){return e?n(decodeURIComponent(e).split(".")[1]):{}};t.isHashedProofToken=function(e){return!!e&&"hashedprooftoken"===e.ver};t.getAppId=function(e){if(e){var t=e.azp||e.appid;if(t)return t;var n=e.nameid;return n&&"true"!==e.isuser&&n.split("@")[0]||void 0}};t.getTenantId=function(e){if(e){if(e.tid)return e.tid;var t=e.nameid;return t&&t.split("@")[1]||void 0}};t.parseTimestamp=function(e){return isNaN(e)?NaN:1e3*e};t.isTokenValid=function(e,t){void 0===t&&(t=Date.now());var n=t/1e3;if(!e)return!1;var r=e.exp,i=e.nbf;return("number"!=typeof i||n>=i)&&("number"!=typeof r||n<r)}});
define("Qo",["require","exports","mU","Kl","Qp","Mz","PY","H8","H8","hT"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Task=i.default;t.Graft=a;var l=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.itemsStore,s=void 0===i?r.resources.consume(o.resourceKey):i;r._itemsStore=s;r._itemUpdatesByKey={};return r}t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,r=e;n<r.length;n++){var i=r[n];this._processTask(i)}};t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,r=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,o=r;i<o.length;i++){var a=o[i],f=t[a],l=new s.default(a),c=this._getStoreItem(a);if(c){c.parent;var h=n.__rest(c,["parent"]);u.default(l,h)}u.default(l,{revision:0});for(var p=0,d=f.item;p<d.length;p++){var v=d[p];u.default(l,v)}e[a]=l}for(var m=0,g=r;m<g.length;m++){var y=(l=e[a=g[m]]).parentKey;if(y){var b=e[y]||this._getStoreItem(y)||new s.default(y);e[y]=b;l.parent=b}else delete l.parent}this._pushItemsToStore(e);for(var w=0,E=r;w<E.length;w++){a=E[w];delete(f=t[a]).item}};t.prototype.reset=function(){this._itemUpdatesByKey={}};t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)};t.prototype.getChildren=function(e){var t,n,r,i=e.parentKey,s=e.startIndex,o=e.endIndex,u=[],a=this._itemUpdatesByKey[i];if(a){var f=a.set;if(f)if(f.childrenByIndex){s=void 0===(n=(t={startIndex:s,endIndex:o}).startIndex)?f.startIndex:n,o=void 0===(r=t.endIndex)?f.endIndex:r;for(var l=s;l<o;l++){var c=f.childrenByIndex[l],h=this._getStoreItem(c);u.push(h)}}else if(f.childrenBySibling)for(var p={},d="";d=f.childrenBySibling[d];){if(p[d])throw new Error("Circular reference encountered enumerating the children of '"+i+"'.");p[d]=!0;h=this._getStoreItem(d);u.push(h)}}return u};t.prototype._processTask=function(e){var t=e.key,n=e.output,r=n.item,i=n.set,s=this._itemUpdatesByKey,o=s[t];o||(o=s[t]={});if(r){o.item||(o.item=[]);o.item.push(r)}if(i){var u=s[i.parent.key];u||(u=s[i.parent.key]={});u.set||(u.set={});var a=u.set;if(void 0!==i.index){a.childrenByIndex||(a.childrenByIndex=[]);void 0===a.startIndex?a.startIndex=i.index:a.startIndex=Math.min(a.startIndex,i.index);var f=a.childrenByIndex.length;a.childrenByIndex[i.index]=t;void 0===a.endIndex?a.endIndex=i.index+1:a.endIndex>i.index+1?a.endIndex+=a.childrenByIndex.length-f:a.endIndex=Math.max(a.endIndex,i.index+1)}else if(i.after){a.childrenBySibling||(a.childrenBySibling={});a.childrenBySibling[i.after.key]=t}}};t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)};t.prototype._pushItemsToStore=function(e){var t={};for(var n in e){(s=t[i=e[(a=e[n]).parentKey]&&a.parentKey||""]||(t[i]=[])).push(n)}for(var r=[""];r.length;){var i,s;if(s=t[i=r.shift()]){for(var o=0,u=s;o<u.length;o++){var a;if(!(a=e[n=u[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(a,n)}r.push.apply(r,s)}}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemsStore:o.resourceKey});return t})(r.default);t.ItemTaskObserver=l;t.resourceKey=new f.ResourceKey({name:e("module").id,factory:new f.ResolvedResourceTypeFactory(l)});t.default=l});
define("Ql",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Cancelled=0]="Cancelled";e[e.CancelPending=1]="CancelPending";e[e.Completed=2]="Completed";e[e.Failed=3]="Failed";e[e.NotStarted=4]="NotStarted";e[e.InProgress=5]="InProgress";e[e.Unknown=6]="Unknown"})(t.RestoreStatus||(t.RestoreStatus={}))});
define("Qy",["require","exports","mU","bl","hT","QC","PY","aM","Qa","P8","Qm","QB","QA","iP","Qz"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(){function e(e,t){void 0===e&&(e={});this._authTokenFetcher=t.authTokenFetcher;this._dataRequestor=t.vroomDataRequestor;this._graphDataSource=t.graphDataSource;this._itemActivitiesService=t.itemActivitiesService;this._itemsStore=t.itemsStore;this._urlDataSource=t.urlDataSource;this._pageContext=t.pageContext}e.prototype.getActivities=function(e){var t=this;return this._getRootDriveItem("v2.0").then(function(n){return t._itemActivitiesService.getItemActivities({environment:"sharePoint",orderBy:"time "+(e.sortAscending?"asc":"desc"),headers:e.headers,item:n,pageSize:25,nextRequestToken:e.nextRequestToken,filter:"showHidden eq 'true'",qosPrefix:t.getQosPrefix()})})};e.prototype.getActivitiesByDate=function(e){var t=this;return this._getRootDriveItem("v2.0").then(function(n){return t._dataRequestor.send({apiName:t.getQosPrefix()+".ActivityCounts",headers:e.headers,path:n.graphItemUrl+"/activityCounts?$filter=starttime eq datetime'"+s.dateNDaysAgo(30).toISOString()+"'"}).then(function(e){return{activitiesByDate:h.groupByDate(e.value),success:!0}})})};e.prototype.getActivityOffsetFromDateTime=function(e){return r.default.resolve(0)};e.prototype.getActivitiesOnSpecificDate=function(e){var t=this;return this._getRootDriveItem("v2.0").then(function(n){return t._itemActivitiesService.getItemActivities({environment:"sharePoint",filter:"showHidden eq 'true' and "+(e.sortAscending?"starttime":"endtime")+" eq datetime'"+e.startDateTime.toISOString()+"'",orderBy:"time "+(e.sortAscending?"asc":"desc"),headers:e.headers,item:n,pageSize:25,qosPrefix:t.getQosPrefix()})})};e.prototype.getPointsOfInterest=function(){return r.default.resolve([])};e.prototype.getLibraryTitle=function(){return this.isOneDrive()?d.default.yourOneDrive:this._pageContext.listTitle};e.prototype.getCombinedSiteLibraryTitle=function(){return this.isOneDrive()?d.default.yourOneDrive:this._pageContext.webTitle+" - "+this._pageContext.listTitle};e.prototype.isOneDrive=function(){return!this._pageContext||"21"===this._pageContext.webTemplate};e.prototype.getQosPrefix=function(){return this.getScenarioName()+".Restore"};e.prototype.getScenarioName=function(){return this.isOneDrive()?"OneDrive":"TeamSiteDocLib"};e.prototype.isPremiumUser=function(){return r.default.resolve(!0)};e.prototype.isEligibleForFreemium=function(){return this.isPremiumUser()};e.prototype.getRestoreEligibility=function(){return r.default.resolve(1)};e.prototype.isRestoreSupported=function(){var e=this;return this.isOneDrive()?r.default.resolve({isRestoreSupported:!0}):this._getRootDriveItem("v2.0").then(function(t){return e._dataRequestor.send({apiName:e.getQosPrefix()+".GetSubscriptions",apiVersion:"v2.0",requestType:"GET",useAuthorizationHeaders:!0,path:t.graphItemUrl+"/commands"})}).then(function(t){if(!t)return{isRestoreSupported:!0};var r;r=t.enableVersioning?t.forceCheckOut?{isRestoreSupported:!1,errorCode:c.RestoreDisabledErrorCode.ForceCheckoutEnabled}:{isRestoreSupported:!0}:t.forceCheckOut?{isRestoreSupported:!1,errorCode:c.RestoreDisabledErrorCode.VersioningDisabledAndForceCheckoutEnabled}:{isRestoreSupported:!1,errorCode:c.RestoreDisabledErrorCode.VersioningDisabled};return n.__assign(n.__assign({},r),{versionSettingsLink:e._getVersionSettingsUrl()})})};e.prototype._getVersionSettingsUrl=function(){return this._pageContext.webAbsoluteUrl+"/_layouts/15/LstSetng.aspx?List="+encodeURIComponent(this._pageContext.listId)};e.prototype._getRootDriveItem=function(e){var t=this,n=this._urlDataSource.getRootItemKey();return this._authTokenFetcher.ensureAuthToken(n).then(function(){return t._itemsStore.getItem(n)()}).then(function(n){return{name:"",graphItemUrl:t._graphDataSource.getDriveUrl(n,{apiVersion:e,useDirectEndpoint:!0})}})};e.dependencies={authTokenFetcher:l.resourceKey,vroomDataRequestor:a.resourceKey,graphDataSource:u.graph,itemActivitiesService:f.itemActivitiesServiceKey,itemsStore:o.resourceKey,urlDataSource:u.url,pageContext:p.pageContext};return e})();t.default=v;t.resourceKey=i.createResolvedResourceKey(e("module").id,v)});
define("QC",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e){return e<10?"0"+e:e}function r(e){return e.getFullYear()+"-"+n(e.getMonth()+1)+"-"+n(e.getDate())}t.localTimezoneDate=r;t.utcDate=function(e){return e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())};t.dateFromLocalTimezoneDate=function(e){var t=new Date(e),n=t.getUTCFullYear(),r=t.getUTCMonth(),i=t.getUTCDate();return new Date(n,r,i)};function i(e){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate()-e)}t.dateNDaysAgo=i;t.datesForLastNDays=function(e){for(var t=[],n=0;n<e;n++)t.push({daysAgo:n,date:r(i(n))});return t};t.countDaysAgo=function(e){var t=r(new Date);return(new Date(t).getTime()-new Date(e).getTime())/864e5};t.countHoursAgo=function(e){var t=(new Date).getTime()-e.getTime();return Math.floor(t/36e5)};t.extname=function(e){return e.replace(/^.*\./,"")}});
define("QB",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.VersioningDisabled=0]="VersioningDisabled";e[e.ForceCheckoutEnabled=1]="ForceCheckoutEnabled";e[e.VersioningDisabledAndForceCheckoutEnabled=2]="VersioningDisabledAndForceCheckoutEnabled"})(t.RestoreDisabledErrorCode||(t.RestoreDisabledErrorCode={}))});
define("QA",["require","exports","G","QC"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupByDate=function(e,t){void 0===t&&(t=r.localTimezoneDate);for(var i=n.createFastMap(),s=[],o=0,u=e;o<u.length;o++){var a=u[o],f=t(new Date(a.startDateTime)),l=i.get(f);if(!l){l={date:f,totalCount:0};i.set(f,l);s.push(l)}l.totalCount+=a.totalCount.actionCount}s.sort(function(e,t){var n=e.date,r=t.date;return n>r?-1:n<r?1:0});return s}});
define("QD",["require","exports","mU","dD","hT","aM","Ql","QM","QL","QE","bn"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0});var h=((c={})[o.RestoreStatus.Cancelled]=u.default.canceled,c[o.RestoreStatus.Completed]=u.default.completed,c[o.RestoreStatus.Failed]=u.default.failed,c[o.RestoreStatus.NotStarted]=u.default.created,c[o.RestoreStatus.InProgress]=u.default.started,c[o.RestoreStatus.Unknown]=u.default.failed,c),p=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._restoreActivitiesDatasource=n.restoreActivities;r._restoreOperations=n.restoreOperations;r._operationProvider=n.operationProvider;r._async=new l.default;return r}t.prototype.monitorRestoreProgress=function(e){var t,n=this;this.pollRestoreProgress(function(e,r,i){if(!e&&r){t||(t=n._operationProvider.register({name:"",type:n._restoreActivitiesDatasource.isOneDrive()?a.default.pointInTimeRestore:a.default.sharepointPointInTimeRestore,iconName:"RevToggleKey",payloads:{},actions:{},progress:{minimum:0,maximum:1,current:0}}));t.progress.current(r.percentComplete/100);t.state(h[r.status]);(function(e){return e.status===o.RestoreStatus.Cancelled||e.status===o.RestoreStatus.Completed||e.status===o.RestoreStatus.Failed})(r)&&i()}else i()},e)};t.prototype.pollRestoreProgress=function(e,t){var n,r=this,i=void 0,s=!1,o=function(){s=!0;n&&r._async.clearInterval(n)},u=function(){r._restoreOperations.getOngoingRestoreOperation({url:i,headers:t}).then(function(t){if(t){i=t.url||void 0;e(null,t,o)}else e(null,null,o)},function(t){e(t,null,o)})};u();s||(n=this._async.setInterval(u,5e3))};t.dependencies={restoreActivities:s.restoreActivities,restoreOperations:s.restore,operationProvider:f.resourceKey};return t})(r.default);t.default=p;t.resourceKey=i.createResolvedResourceKey(e("module").id,p)});
define("QM",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.created=0]="created";e[e.started=1]="started";e[e.completed=2]="completed";e[e.failed=3]="failed";e[e.canceled=4]="canceled";e[e.expired=5]="expired"})(n=t.OperationState||(t.OperationState={}));t.default=n});
define("QL",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.multiple=0]="multiple";e[e.renameItems=1]="renameItems";e[e.deleteItems=2]="deleteItems";e[e.pointInTimeRestore=3]="pointInTimeRestore";e[e.restoreItems=4]="restoreItems";e[e.uploadItems=5]="uploadItems";e[e.moveItems=6]="moveItems";e[e.copyItems=7]="copyItems";e[e.rotateItems=8]="rotateItems";e[e.addItemsToAlbum=9]="addItemsToAlbum";e[e.addCoverPhotos=10]="addCoverPhotos";e[e.removeCoverPhotos=11]="removeCoverPhotos";e[e.createAlbumFromFolder=12]="createAlbumFromFolder";e[e.createColumn=13]="createColumn";e[e.editColumn=14]="editColumn";e[e.deleteColumn=15]="deleteColumn";e[e.checkInItem=16]="checkInItem";e[e.checkOutItem=17]="checkOutItem";e[e.undoCheckOutItem=18]="undoCheckOutItem";e[e.createFolder=19]="createFolder";e[e.updateBundle=20]="updateBundle";e[e.shareItem=21]="shareItem";e[e.reportAbuse=22]="reportAbuse";e[e.requestReview=23]="requestReview";e[e.setAlbumCoverPhoto=24]="setAlbumCoverPhoto";e[e.createAlbum=25]="createAlbum";e[e.uploadVideos=26]="uploadVideos";e[e.saveItem=27]="saveItem";e[e.createItem=28]="createItem";e[e.publishItem=29]="publishItem";e[e.unPublishItem=30]="unPublishItem";e[e.applyOfficeLens=31]="applyOfficeLens";e[e.removeOfficeLens=32]="removeOfficeLens";e[e.updateMetadata=33]="updateMetadata";e[e.makeHomepage=34]="makeHomepage";e[e.triggerFlow=35]="triggerFlow";e[e.downloadAsZip=36]="downloadAsZip";e[e.saveAutoAlbum=37]="saveAutoAlbum";e[e.discardAutoAlbum=38]="discardAutoAlbum";e[e.addToOneDrive=39]="addToOneDrive";e[e.removeFromSharedList=40]="removeFromSharedList";e[e.setupApprovalFlow=41]="setupApprovalFlow";e[e.setupReminderFlow=42]="setupReminderFlow";e[e.sharepointPointInTimeRestore=43]="sharepointPointInTimeRestore";e[e.sharingReport=44]="sharingReport";e[e.editViewColumns=45]="editViewColumns";e[e.runModelOnItems=46]="runModelOnItems"})(n=t.OperationType||(t.OperationType={}));t.default=n});
define("QE",["require","exports","mU","Kl","QK","QM","QJ","QG","QF","hT"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,i=r.observables,s=new o.default;r._observers=i.createArray();var f=r.operations=i.createArray(),l=r.scope.attached(u.default),c=r.groups=r.addDisposable(a.default.group(f,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new l({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));r.overall=new(r.managed(u.default))({batch:s,operations:c});r.isLocked=r.createPureComputed(r._computeIsLocked);r.createBackgroundComputed(r._computeRemoveAllWhenUnlocked).extend({deferred:!0});return r}t.prototype.lock=function(){var e=this,t={};this._observers.push(t);return{dispose:function(){e._observers.remove(t)}}};t.prototype.register=function(e){var t=new i.default(e);2!==t.visibility.peek()&&this.operations.push(t);return t};t.prototype.deleteGroupOperation=function(e){var t=n.__spreadArrays(e.operations.peek());this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype.cleanup=function(e){void 0===e&&(e=!1);for(var t=[],n=0,r=this.groups.peek();n<r.length;n++){var i=r[n],o=i.state.peek();if(o===s.default.completed||!e&&(o===s.default.expired||o===s.default.canceled||o===s.default.failed))for(var u=i.operations.peek(),a=void 0,f=0;f<u.length;f++){a=!0;var l=u[f];if(o===s.default.failed&&l.actions)for(var c=l.actions.peek(),h=Object.keys(c),p=0;p<h.length;p++)if("cancel"!==h[p]&&c[h[p]].isAvailable.peek()){a=!1;break}a&&t.push(u[f])}}this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()};t.prototype._computeIsLocked=function(){return this._observers().length>0};return t})(r.default);t.OperationProvider=l;t.resourceKey=f.createResolvedResourceKey(e("module").id,l);t.default=l});
define("QK",["require","exports","mU","QM","QJ","QL","QI","Kl"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var o=e.call(this,{})||this,u=o.observables;o.name=t.name;o.iconName=t.iconName;o.state=u.create(r.default.created);o.warning=u.create("");o.error=u.create();o.count=u.create(1);var a=n.__assign({minimum:0,maximum:0,current:0},t.progress||{});o.progress={minimum:u.create(a.minimum),maximum:u.create(a.maximum),current:u.create(a.current)};o.type=u.create(t.type||s.default.multiple);o.batch=t.batch||new i.default;o._initializeActions(t.actions);o.payloads=u.create(t.payloads||{});o.visibility=u.create(t.visibility||0);return o}t.prototype.dispose=function(){this.actions({});this.payloads({});e.prototype.dispose.call(this)};t.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var r=e[n];t[n]=this.scope.attach(new o.default({key:n,operation:this,isAvailable:r.isAvailable,onExecute:r.execute}))}this.actions=this.observables.create(t)};return t})(u.default);t.Operation=a;t.default=a});
define("QJ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){this.id=++e._lastBatchId}e._lastBatchId=0;return e})();t.OperationBatch=n;t.default=n});
define("QI",["require","exports","mU","Kl","bl"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.key=t.key;var r=n.observables,i=t.count,s=void 0===i?r.create(1):i,u=t.isAvailable,a=void 0===u?r.create(!0):u,f=t.onExecute,l=void 0===f?o:f;n.count=s;n.isAvailable=a;n._onExecute=l.bind(t.operation);return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._onExecute=o};t.prototype.execute=function(){return this._onExecute()};return t})(r.default);t.OperationAction=s;function o(){return i.default.wrap()}t.default=s});
define("QG",["require","exports","mU","QL","QM","QI","bl","Kl","QH","QF"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.operations=t.operations;n.name="";n.iconName="";n.progress={minimum:n.createObservable(0),maximum:n.createObservable(0),current:n.createObservable(0)};n.batch=t.batch;n.error=n.createObservable();n.count=n.createObservable(0);n._initializeType();n.payloads=n.createPureComputed(n._computePayloads);n.actions=n.createObservable({});n.states=n.createObservable({created:0,started:0,completed:0,failed:0,canceled:0,expired:0});n._initializeOperations();n.state=n.createPureComputed(n._computeState);n.visibility=n.createPureComputed(n._computeVisibility);return n}t.prototype._initializeType=function(){var e=this.addDisposable(f.default.group(this.operations,function(e){return e.type()}));this.type=this.createPureComputed(function(){return 1===e().length&&e()[0].key||r.default.multiple})};t.prototype._computePayloads=function(){var e=this.operations()[0];return e&&e.payloads()||{}};t.prototype._initializeOperations=function(){var e=this;this.addDisposable(this.operations.map({mappingWithDisposeCallback:function(t){var n=e.createPureComputed(function(){return i.default[t.state()]}),r=e.addDisposable(a.includeInSum(t.progress.minimum,e.progress.minimum)),s=e.addDisposable(a.includeInSum(t.progress.maximum,e.progress.maximum)),o=e.addDisposable(a.includeInSum(t.progress.current,e.progress.current)),u=e.addDisposable(a.includeInHistogram(n,e.states)),f=e.addDisposable(a.setFirst(t.error,e.error)),l=e.addDisposable(a.includeInSum(t.count,e.count)),c=e.createComputed(function(){var n=!1,r=e.actions.peek();for(var i in t.actions())if(!(i in r)){r[i]=e._initializeAction(i);n=!0}n&&e.actions.valueHasMutated()});return{mappedValue:t,dispose:function(){n.dispose();r.dispose();s.dispose();o.dispose();u.dispose();c.dispose();f.dispose();l.dispose()}}}}))};t.prototype._computeState=function(){var e=this.states();return e.started||e.created&&(e.failed||e.completed||e.canceled)?i.default.started:e.created?i.default.created:e.failed?i.default.failed:e.completed?i.default.completed:e.canceled?i.default.canceled:i.default.expired};t.prototype._computeVisibility=function(){return this.operations().reduce(function(e,t){var n=t.visibility.peek();return n<e?n:e},2)};t.prototype._initializeAction=function(e){var t=this.addDisposable(this.operations.filter(function(t){var n=t.actions()[e];return n&&n.isAvailable()}));return this.addDisposable(new s.default({count:this.createPureComputed(function(){return t().length}),key:e,operation:this,isAvailable:this.createPureComputed(function(){return!!t().length}),onExecute:function(){return o.default.all(t().slice().map(function(t){var n=t.actions.peek()[e];return n&&n.execute()||o.default.wrap()}))}}))};return t})(u.default);t.GroupOperation=l;t.default=l});
define("QH",["require","exports","a"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.includeInSum=function(e,t){var n,r=function(e){t(t.peek()+e)},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(e.peek()-n)});r(e.peek());return{dispose:function(){i.dispose();s.dispose();r(-e.peek())}}};t.includeInHistogram=function(e,t){var n,r=function(e,n){var r=t.peek();void 0!==e&&r[e]--;void 0!==n&&(r[n]=(r[n]||0)+1);t.valueHasMutated()},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(n,e.peek())});r(void 0,e.peek());return{dispose:function(){i.dispose();s.dispose();r(e.peek(),void 0)}}};t.setFirst=function(e,t){var r=e.peek(),i=e.subscribe(function(){r=e.peek()},null,"beforeChange"),s=n.computed(function(){!t()&&e()&&t(e())}),o=e.subscribe(function(e){!e&&r&&t.peek()===r&&t(void 0)});return{dispose:function(){s.dispose();o.dispose();i.dispose()}}}});
define("QF",["require","exports","hU","a","Ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){var i=this;this._source=e;this._getKey=t;this._groupsByKeyId={};this.groups=r.observableArray();this._initializeGroups();n.hook(this.groups,function(){i._mapping.dispose()})}e.group=function(t,n){return new e(t,n).groups};e.prototype._initializeGroups=function(){var e=this;this._mapping=this._source.map({mappingWithDisposeCallback:function(t){var n=e._getKey(t),i=JSON.stringify(n),s=e._groupsByKeyId[i];if(s)s.values.push(t);else{s={key:n,values:r.observableArray([t])};e._groupsByKeyId[i]=s;e.groups.push(s)}return{mappedValue:i,dispose:function(){if(s.values.peek().length>1)s.values.remove(t);else{delete e._groupsByKeyId[i];e.groups.remove(s)}}}}})};return e})();t.default=i});